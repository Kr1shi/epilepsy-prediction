AI Communications 36 (2023) 57–72 57 DOI 10.3233/AIC-220177 IOS Press
Automatic prediction of epileptic seizure using hybrid deep ResNet-LSTM model
Yajuvendra Pratap Singh ∗ and Daya Krishan Lobiyal School of Computer & Systems Sciences, Jawaharlal Nehru University, New Delhi, India E-mails: yajuve94_scs@jnu.ac.in, dkl@mail.jnu.ac.in
Abstract. Numerous advanced data processing and machine learning techniques for identifying epileptic seizures have been developed in the last two decades. Nonetheless, many of these solutions need massive data sets and intricate computations. Our approach transforms electroencephalogram (EEG) data into the time-frequency domain by utilizing a short-time fourier transform (STFT) and the spectrogram (t-f) images as the input stage of the deep learning model. Using EEG data, we have constructed a hybrid model comprising of a Deep Convolution Network (ResNet50) and a Long Short-Term Memory (LSTM) for predicting epileptic seizures. Spectrogram images are used to train the proposed hybrid model for feature extraction and classification. We analyzed the CHB-MIT scalp EEG dataset. For each preictal period of 5, 15, and 30 minutes, experiments are conducted to evaluate the performance of the proposed model. The experimental results indicate that the proposed model produced the optimum performance with a 5-minute preictal duration. We achieved an average accuracy of 94.5%, the average sensitivity of 93.7%, the f1-score of 0.9376, and the average false positive rate (FPR) of 0.055. Our proposed technique surpassed the random predictor and other current algorithms used for seizure prediction for all patients’ data in the dataset. One can use the effectiveness of our proposed model to help in the early diagnosis of epilepsy and provide early treatment.
Keywords: STFT, ResNet-50, LSTM, deep-learning epilepsy, seizure prediction
1. Introduction
There are numerous central nervous system diseases (CNS), with epilepsy being one of the most prevalent chronic neurological disorders. According to a WHO report [20], epilepsy is caused by unexpected seizures, neuronal injury, or sudden neuronal failure [20,45], and it affects 1% of the world’s population. The variation in the electrical activity of the brain that causes epilepsy is observed with EEG testing. EEG signals are used to diagnose any activity related to an epilepsy seizure. The occurrence of the first variations in brain activity is called the preictal state. Further, this preictal state is essential for the prediction of seizures. Therefore, determining the preictal state is important. A robust seizure prediction system can easily control the epilepsy disease [45]. It could take the required precautions before the seizure started and avoid it quickly. Therefore, determining the preictal state is critical as it provides essential information for seizure prediction. Determining the preictal stage is difficult and time-consuming. Hence, various research works have been carried out to build an adaptive system for detecting epileptic seizures. Epilepsy affects around 50 million people worldwide. Epilepsy is a chronic disease of the brain characterized by a recurrent pattern of seizures [38]. Seizures are caused by aberrant electrical signals generated by the cerebral cortex, which interfere with motor, sensory, cognitive, and behavioral functioning. Approximately 30% of people have incurable epilepsy, meaning their strokes are uncontrollable despite the use of anti-epileptic drugs (AEDs) [37]. An electroencephalogram (EEG) is used to diagnose and analyze seizures that record electrical signals. Depending on the brain region being examined, EEG signals can be divided into intracranial EEG and scalp EEG. The EEG is used to record the electrical activity of the brain during an intracranial bleed. Electrodes are put directly on the
*Corresponding author. E-mail: yajuve94_scs@jnu.ac.in.
0921-7126/$35.00 © 2023 – IOS Press. All rights reserved.
58 Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model
Fig. 1. Interictal, preictal, ictal, and postictal components of epileptic brain states [48].
Fig. 2. Raising an alarm before epileptic seizures ONSET.
exposed cerebral cortex during surgery, and scalp EEG electrodes detect time-series signals from the brain scalp. Although intracranial EEG can record a high signal-to-noise ratio, scalp EEG can be used as the measuring method for frequent patient monitoring and seizure alerts because different electrodes must slice the skull. It has a broader range of applications and is more convenient to use. EEG data can separate seizures into four stages based on a patient’s EEG record. The first stage is the ictal period, in which a seizure occurs. The second stage is the preictal state, which occurs before the beginning of a seizure. The third stage is the postictal form, which occurs after the seizure has ended. And the final stage is the interictal period, which is the interval before the preictal stages and occurs between seizures [48]. These four stages are depicted in Fig. 1.
A method for predicting seizures is based on two distinct strategies. In the first strategy, to divide EEG signals into preictal and interictal stages, a preictal duration is chosen early in the process. A binary classifier differentiates between the two sets. If postictal and ictal segment details are considered independent states, they cannot help in seizure prediction, and therefore, they are eliminated from the study. A seizure prediction system must predict an impending epileptic seizure by generating an alarm prior to the start of the seizure. Since it is impossible to pre-dict precisely when a seizure will begin, therefore this uncertainty must be accounted for. The seizure occurrence period (SOP) should be described as the expected time of the attack. In addition, treatment systems necessitate a minimum interval between the activation of an alarm and the initiation of the SOP. As demonstrated in Fig. 2, the seizure prediction horizon (SPH) is determined by the preictal time interval. Recently, the use of machine learning has enhanced the prediction of epileptic seizures. It is also addressing the complexity of EEG signals [46]. The machine learning tools make it easy to distinguish and evaluate seizure features. Classical machine learning tech-niques were the most often utilized method for automatically recognizing epileptic seizures [5]. The effectiveness of these methods were highly dependent on strategies for extracting hand-engineered features. Choosing appropriate features from EEG signals poses a significant challenge [29]. The convolutional neural network (CNN) is the super-vised learning technique used to distinguish between preictal and interictal stages. The trained classifier detects the preictal period in new EEG data and predicts the probability of seizures. Use of threshold-based techniques form the another approach. During the preictal stage, the focus is on classifying increasing or decreasing trends in the values of particular characteristics. The value of the examined section is checked against the sub-threshold value, and the seizure alarm is given if it exceeds [1]. Predictive seizures indicate a continuous rise or reduction in EEG channel phase-locking and synchronization during the preictal stage [6,24,32]. For the past couple of years, classical machine-learning methodologies have shown huge promises and significant impact on it [26]. There are two stages in the proposed technique. The EEG signal is first used as raw data, and it is then transformed into image files.
Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model 59
Seizures are predicted in stage two using EEG data images to learn the difference between interictal and preictal phases [19]. In this research, we propose a new method for predicting epileptic seizures. The remaining sections of this work are organized as follows: Section 2 discusses earlier research on seizure prediction. In Section 3, using a scalp EEG dataset, preprocessing procedure, and proposed model are explained. The performance evaluation based on preictal and interictal length is defined in Section 4 and compared with earlier research. The final Section 5 concludes the research work with discussion of its results.
2. Related work
Researchers have been actively working on seizure prediction for the past few years. Seizure prediction is based on the imbalanced data between the interictal and preictal periods. Deep learning algorithms such as CNN [3, 7] have recently been studied in detail in the same way as doctors do with careful observation. Authors in [31] proposed a method for collecting the raw intracranial EEG signals to transform them into uni-variate spectrum power, classifying them using SVM, and eliminating occasional and inaccurate data. Recent interest in deep learning has led to new EEG signal evaluation applications [2,25]. Various deep learning applications are used to assess these EEG signals in 1-D signals or 2-D visuals. EEG signals are categorized as normal, or abnormal [49]. After feature extraction, 2-D EEG spectrum analyzer images are categorized to evaluate speech patterns [42,47].
Authors [33] proposed a method for determining phase-locking values of EEG scalp data. This scalp EEG data is categorized into short interictal or preictal segments. This is performed by combining multivariate wavelet transform decomposition with an SVM classifier. The SVM classifier used sixty-five seizures [10] from the CHB-MIT data sets. Authors [45] differentiated preictal and interictal states using information collected from graph theory, time, and the frequency domain. Some authors [39] used the wavelet transform to separate EEG signals into sub-bands, after which the features were retrieved using PCA, LDA, and IDA [23]. EEG data can be used by various signal processing techniques to extract features from the data [21,40].
CNN is the most prominent deep learning algorithm used in seizure prediction research because it typically re-quires image data as input. The authors of [43] divided the raw EEG data by a window size of 30 seconds and then used STFT to extract spectrogram image information, which was then fed into CNN. In the CHB-MIT dataset, this technique found 64 seizures in 13 patients and yielded a sensitivity and an FPR of 81.2% and 0.16, respectively. Con-tinuous Wavelet Transform (CWT) is used to transform signals from various EEG signal bands into time-frequency. The author suggested applying the adjusted data as an input to CNN, which learns the distinction between interictal and preictal states to predict seizures, achieving an average FPR of 0.142 with three unpredictable seizures. Authors [30] predict seizures using a multi-frame 3D CNN model. The model utilized preprocessed features with power spectrum bands, Hjorth parameters, and statistical moments. These features attained a sensitivity and an FPR of 85.71% and 0.096, respectively.
Traditional classification techniques have been widely used to distinguish preictal EEG segments. These EEG segments employed spectrum power analysis to extract initial characteristics via different classical machine learning models. Finally, preictal states and interictal states differentiated these features after loading the characteristics into an SVM classifier. The authors [27] also employed a CNN model with six CNN layers to extract the features. These features were used to divide EEG segments into three groups: ictal, preictal, and interictal states. CNN is fed the result of every EEG channel’s wavelet transform calculated at various scales as input. For the evaluation, the CHB-MIT database is used. The researchers examined 15 participants, who recorded eight seizures and 50 interictal recordings, resulting in an average FPR of 0.142 and three unpredicted seizures. CNN has influenced the most among deep learning techniques in seizure prediction [44]. The wavelet transforms collected the spectral information from the 30-sec signal increments. The average seizure sensitivity and FPR were 81.2% and 0.16 false predictions per hour, respectively. The dense convolutional network (DenseNet) [19] addresses problems like vanishing gradients and parameter increases that appear when the CNN layer gets deeper. DenseNet surpasses CNN when comparing learning information from a limited source of EEG data. Furthermore, the LSTM [34] model addresses the Recurrent Neural Network (RNN) dependence problem. It has been designed to identify time-series data, which makes it ideal for detecting temporal features of the EEG.
60 Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model
In addition, deep multi-layer CNN was used to analyze the application of spatial filters for extracting motor im-agery tasks from linearly combined EEG channels. It improves the power spectrum band features of the EEG signal [41]. LSTM networks have been used in the analysis focused on various research areas to evaluate the automated de-tection of epileptic seizures in scalp EEG data [16]. A recurrent convolutional neural network consisted of a 4-layer CNN with each EEG channel is provided with spectral information as input. Then the LSTM model is employed to perform the complete classification of EEG segments.
3. Materials and methods
3.1. Scalp EEG dataset
We used the open-source Children’s Hospital Boston and Massachusetts Institute of Technology (CHB-MIT scalp) EEG data set [9,15], which can be found in publicly available1 [12]. At Children’s Hospital Boston, EEG signals were gathered from 23 children with uncontrollable attacks. The recordings were made at a sampling rate of 256 and a 16-bit range using a 10-to-20 electrode location system. These electrodes are fixed directly on the scalp of the brain to find out from where the seizure event is coming. The total length of the EEG recordings provided is nearly 983 hours. After visual evaluation of the EEG epochs containing ictal activity, clinical personnel manually recorded the seizure start and offset time intervals, resulting in a total of 198 validated seizures. There are two interictal cases because the time interval between ictal stages varies from patient to patient.
In addition to the preictal length, there is a 5-min delay preceding the ictal period. The duration before the 5-min interval is removed from the preictal size because our model is trained after a 5-min interval. It takes a specific length of time (e.g., 5, 15, and 30 minutes) to assure that the patient controls the seizure, and the particular length of time is given in Fig. 3. This time frame was chosen because it is essential to allow the doctor to intervene before the seizure begins in the patient [35].
3.2. Preprocessing procedure
For seizure prediction to work, the scalp EEG data of epileptic patients must be free of various artifacts and noise, for which it requires explicit filtering. Therefore, the available multichannel EEG signals are filtered through a Butterworth bandpass filter [8] with a lower cut-off frequency of 0.1 Hz and a higher cut-off frequency of 127 Hz. The bandpass method is generally used as the filtering method to obtain a useful frequency range from 0.1 to 60 Hz for studying biomedical signals. The multichannel raw EEG signal is preprocessed to eliminate distortions before being translated into time-interval-based segments. The STFT is used to transform the EEG signals into a two-dimensional matrix as the pre-trained CNN model requires input in an image format. These EEG segments of each patient’s data is transformed into spectrogram images, as shown in Fig. 4.
Fig. 3. Preictal length [35].
1www.PhysioNet.org
Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model 61
Fig. 4. STFT to transform raw EEG signals into time-frequency images.
Fig. 5. EEG signal spectogram (a), preictal (b), interictal.
3.2.1. Segmentation In numerous signal processing applications, such as the automatic analysis of EEG signals, the signal is subdivided
into smaller sections, with model parameters such as amplitude and frequency for each region. This is performed by moving window analysis [18]. Identifying preictal and interictal EEG segments improves the discriminative power of classification algorithms. The number of preictal and interictal EEG segments provided as input ranged from 5 to 50 components during training. Firstly, we generate a sliding window with the size s = n× (t.fs) of the data, where n, t , and fs are the number of channels, time length of the window, and sampling frequency for each patient’s data, respectively. A sampling frequency of fs = 256 Hz and n = 23 channels results in an input matrix of 23 × 2560 for t = 10-sec. The window sliding method keeps preictal and interictal signal data from overlapping. Figure 5 depicts the 10-sec intervals between the preictal and interictal signals.
3.2.2. Spectrogram Due to the low signal-to-noise ratio (SNR), we translate the continuous EEG data into the frequency domain.
A wavelet and Fourier transforms are applied to transform EEG segments into spectral images. A short-time Fourier transform (STFT) converts EEG time-domain data into two-dimensional matrices. STFT is utilized to obtain per-tinent data for seizure prediction. Dimensionality reduction and the development of higher-order feature spaces are made possible via feature extraction. The STFT module segments the time-varying EEG signal into a two-dimensional matrix with frequency and time axes. As a result, the two-dimensional map can provide information about the periods for each time window. Assume there are P domains (patients) in total. The input data of P domains are represented by S̄ = [s̄(1), . . . , s̄(P )]T ∈ RP×d where s̄ ∈ Rd×1. This is the segment with time t as s̄(t) for an arbitrary domain. The equation (1) given below represents STFT.
STFT s(ω, υ) = ∑
t
s̄(t)g(t − υ)ejωt (1)
62 Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model
Fig. 6. The proposed seizure prediction methodology.
Here, we have g(t − υ) as the window function, and w is the chosen frequency band. For P domains, the STFT is evaluated for each case, and module inputs are converted to S = [s(1), . . . , s(P )]T ∈ RP×d . Spectrograms represent the samples for each case. Each spectogram has been defined as the duration, frequency domain, and amplitude of the EEG signal in a specific time interval (pixel color intensity). The spectrogram’s color intensity provides unique information about the frequency amplitude. For seizure prediction, we investigated five different spectral bands of EEG data, each of which had a different frequency range: delta (0.1–4 Hz), theta (4–8 Hz), alpha (8–12 Hz), beta (12–30 Hz), and gamma (>30 Hz). Different EEG signals come from various channels. Then these signals are transformed into spectrograms using STFT. Consequently, the image size (pixels) is 128 × 128 × c, where c is the number of channels. Each spectrogram is tagged with labels, where the labels are called preictal and interictal, which are the images of seizure and non-seizure, respectively. Finally, the spectrum image is resized to 224 × 224, as shown in Fig. 5.
To begin, the STFT technique in a sliding window is being used to obtain the information flow properties of the scalp EEG signals. Second, these characteristics are recreated as channel-frequency feature maps that are then given as inputs into a ResNet-50 model. Lastly, the LSTM model is employed for classification to accurately detect epileptic seizures. Fig. 6 presents a block diagram representation of the model we constructed.
3.3. Proposed deep learning architecture
CNN Model In medical applications, CNN models have demonstrated to perform well in classification and detection [7,26]. A CNN model requires a robust training procedure to achieve a massive range of recognition. The fundamental convolution equation is stated in equation (2).
ol p,q = f
(∑ m
∑ n
ol−1 p+m,q+nwm,n + bl
) (2)
Where ol p,q is the output vector at layer l and ol−1
p+m,q+n is the previous input vector of two-dimensional data, w is the m×n weight matrix with the convolution kernel or filter, b is the bias unit of layer l, and f is the activation function. Some techniques became more prominent during the performance. This research work utilized the ResNet50 model to extract deep features for every 10-sec long EEG segment. Each case is examined in a patient-specific manner [14].
ResNet-50 Pretrained 2D-CNN Model Many medical applications use ResNet-50 [36] as the backbone of the deep neural network. ResNet-50 takes an input image of 224×224 pixels in this experiment. ResNet50 comprises 50 layers that have 16 residual layers and two fully connected layers, where each residual layer has three convolutional layers. The skip connection prevents vanishing gradients in deep learning techniques and adds convolutional kernel input to the output. The model propagates data even when the convolutional kernel’s output is too small. ResNet is a fundamental structure that adds the short-cut connection to the basic network unit of the residual blocks, as shown in equation (3).
ob = f (ib, wb) + ib (3)
Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model 63
Fig. 7. Bottleneck residual-identity block.
Where ib, ob, and f (ib, wb) are the input mapping, the output mapping, and the residual mapping of the blocks, respectively. In the residual bottleneck block, a 1 × 1 CNN layer comes before the Batch Normalization (BN) step, followed by the ReLU activation function. This is then followed by a 3×3 CNN layer, followed by the BN step, and finally, the ReLU activation function after that comes to a 1 × 1 CNN layer and then the Batch Normalization layer. After that, the activation function of the ReLU is performed once it has been connected to the skip connection input. This is the initial implementation of the bottleneck layer, often known as the identity block, as depicted in Fig. 7.
LSTM The LSTM unit is a unique method to predict sequential data, like text or time-series data output. LSTM is a mod-ification of recurrent neural networks (RNN). However, to address potential long-term dependencies [11], several LSTM models were tested and evaluated. After doing so, it was revealed that the traditional LSTM model with the forget gate performed the best across a wide range of tasks [17]. As shown in Fig. 7, LSTM follows a step-by-step process. The input gate (inpt ), in equation (4) determines how much we have to add to our previous cell state (k̄t ) in equation (5). It contains the sigmoid function (σ ), and the tanh function. The work of the layer using sigmoid function is to decide which value to update, and the other process, i.e., tanh, gives weightage to the values between −1 to 1 depending upon the importance of the state.
inpt = σ ( winp.[ht−1, xt ] + bfginp
) (4)
k̄t = tanh ( wk.[ht−1, xt ] + bk
) (5)
Forget gate (fogt ) in equation (6), determines what information is excluded from the cell state. It uses the prior output ht−1 and the current input xt as input for the sigmoid layer, which outputs values between 0 and 1. Where 1 indicates retention of all information and 0 indicates rejection of all information.
fogt = σ ( wfog.[ht−1, xt ] + bfog
) (6)
In the output gate (optt ), the output is determined by the current input and the memory (cell state) in equation (7) of the block equation (8). The output is computed by passing the previous output (ht−1) and the current input (xt )
64 Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model
through the sigmoid layer and multiplying them by the tanh of the cell state. Equation (9) illustrates the current state (kt ) of the cell.
optt = σ ( wopt.[ht−1, xt ] + bopt
) (7)
ht = optt ∗ tanh(kt ) (8)
kt = fogt ∗ kt−1 + iopt ∗ k̄t (9)
Hybrid ResNet-LSTM model The ResNet-LSTM model is formed by merging the ResNet50 and LSTM networks. In the hybrid model, ResNet50 extracts complicated characteristics from images, and LSTM performs the role of a classifier. The proposed network for epilepsy detection is depicted in Fig. 8. The hidden layers of the ResNet-50 model are forwarded to the LSTM unit, as shown in Fig. 9. The size of the LSTM unit needs to be the same as the size of the sequences being fed into it. With the help of global average pooling, GAP can reduce the number of hidden layers to (C × 1 × 1), where C represents the total number of channels. GAP also avoids overfitting and reduces computational requirements by not optimizing any parameters. GAP sums the spatial data unaffected by feature map spatial changes. Furthermore, the GAP layer output is convoluted to produce a 128-channel result, which is then flattened to produce a one-rank and 128-filter, where rank is defined as a dimension of the vector. When the cell state vector receives the final layer activation, it sends hidden layer activations to the LSTM unit to ensure that it remembers and can hold on to the retained essential data from the previously hidden layers. The epilepsy prediction score is computed using all this information, including the crucial information from the preceding levels and the activation of the last layer.
The function map is transmitted to the LSTM layer in the final section of the architecture, which extracts temporal information. The output shape is found after the convolutional block (none, 7, 7, 2048). The input size of the LSTM
Fig. 8. Structure of LSTM cell.
Fig. 9. Hybrid ResNet50-LSTM model for epileptic seizure prediction.
Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model 65
Table 1
Architecture of ResNet50-LSTM model
Stages Features map size Configurations
Cnv1 112 × 112 7 × 7, 64 stride 2
Cnv2 56 × 56 3 × 3 max pool stride 2
1 × 1, 64
3 × 3, 64 × 3
1 × 1, 256
Cnv3 28 × 28 1 × 1, 64
3 × 3, 64 × 3
1 × 1, 512
Cnv4 14 × 14 1 × 1
3 × 3, 256 × 6
1 × 1, 1024
Cnv5 7 × 7 1 × 1, 512
3 × 3, 512 × 3
1 × 1, 2048
Global average pooling
7 × 7 × 2048 Reshape
LSTM 1 × 128
Dense layer (64)
(32)
(16)
(2)
Output Preictal,Interictal Sigmoid
layer has been reduced using the reshape approach (1, 128). After reshaping, the dense layer is divided into 64, 32, 16, and two layers. Table 1 shows a summary of the planned architecture. After analyzing the time features, the architecture organizes them via a fully connected layer to determine one of the groups (preictal or interictal). Finally, the sigmoid function is used to classify the features generated by LSTM into preictal and interictal stages of 5 minutes, 15 minutes, and 30 minutes. Table 1 represents the detailed structure of the hybrid model.
4. Results and discussion
4.1. Performance evaluation
The following statistics are used to evaluate categorization performance: true positive, true negative, false positive, and false negative are defined as trpos, trneg, fapo, and faneg, respectively. trpos is the number of cases in which the predictions are correctly recognized as preictal EEG segments in the number of cases in which they are correctly recognized. fapo is the number of occurrences in which the predictions are incorrectly recognized as preictal, and the person does not have a possibility of seizure. trneg is the number of cases in the predictions that are correctly recognized as interictal. faneg is the total number of incorrectly recognized interictal predictions. Accuracy is the ratio of correctly classified seizure and non-seizure images to the total number of images. Sensitivity is the proportion of accurately identified seizure images to the total number of images. Specificity is the ratio of correctly identified non-seizure images to the total number of images. Precision is the ratio of accurately predicted seizure images to the total number of expected images. The false positive rate (fpr) is the ratio of the number of false alarms to the
66 Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model
total number of false positives in EEG recordings. Accuracy, sensitivity, specificity, precision, and fpr are used to evaluate the model’s capacity to predict seizures.
acc = trpos + trneg
trpos + fapos + trneg + faneg (10)
sens(rec) = trpos
trpos + faneg (11)
spec = trneg
trneg + fapos (12)
prec = trpos
trpos + fapos (13)
fpr = fapo
trneg + fapo (14)
f 1-score = 2 · trpos
2 · trpos + fapo + faneg (15)
4.2. Experimental setup
The datasets for each patient are separated into three subsets: training, validation, and testing, which comprise 60%, 20%, and 20% of the total, respectively. Other trainable parameters are likewise randomly initialized. The ReLU function is often utilized in cases where activation is required. The Adam optimizer [5] technique is used as the basis for the training optimizer, with an initial learning rate of 0.001 and β1, and β2 values of 0.9 and 0.999, respectively. The categorical cross-entropy loss function is used for validation loss, which has finished dropping for 120 epochs with early stopping, and the learning rate has dropped by 0.95. After that, the network is trained and validated using a batch size of 64 on both the training and validation sets, respectively. Python 3.6, Tensorflow 1.14, and Keras 2.2.4 versions were utilized during the software testing on a computer with an Intel(R) Core(TM) i7-2.2 GHz CPU. The proposed model has been tested on the NVIDIA Quadra RTX6000 workstation with a 16 GB GPU and 64 GB of RAM, respectively.
We select the preictal window sizes of 5, 15, and 30 minutes of EEG data, demonstrate the experimental obser-vations, and compare the existing techniques. The model was trained on the concept that a size of 5 minutes gives a higher sensitivity than preictal sizes of 15 and 30 minutes. The model assuming a 5-minute interval learned the preictal interval better than other models, resulting in a preictal frequency characteristic between 0 and 5 minutes. This method suggests that, as compared to other models, the model trained to assume 15 and 30 minute durations separated the interval classes as interictal. According to the preictal duration, the average sensitivity in the model is high when the preictal size is 5 minutes. Still, the sensitivity for patient 4 is lower than 15 and 30 minutes, and the specificity is reasonable. In the case of patient 23, however, the sensitivity of preictal lengths of 15 and 30 minutes is lower than 5 minutes. Therefore, the preictal size of 5 minutes’ characteristics seems more prominent.
Similarly, the total average performance is better when the preictal period is estimated to be 5 minutes than the performance measured during the preictal periods of 15 and 30 minutes. When the preictal period is 5 minutes, the averages for acc, sens, spec, fpr, and f 1-score are 94.50%, 93.70%, 94.13%, 0.0555, and 0.9376, respectively, for all 24 patients’ data. When the preictal period increases from 15 to 30 minutes, the prediction performance of the model degrades for each patient data set. The average acc, sens, spec, fpr, and f 1-score for a preictal period of 15 min are 93.88%, 92.08%, 94.55%, 0.0583, and 0.9216, respectively, for all 24 patients’ data. The average acc, sens, spec, fpr, and f 1-score for a preictal period of 30 min are 91.99%, 91.84%, 94.95%, 0.0550, and 0.9289, respectively, for all 24 patients’ data. Table 2 displays the average acc, sens, spec, fpr, and f1-score for each patient data set.
According to the results, the proposed seizure prediction algorithm can correctly predict all 185 seizures (events) in the CHB-MIT database. Table 2 demonstrates that the suggested ResNet-LSTM model obtained an average fpr of
Y.P.Singh and
D .K
.L obiyal/H
ybrid deep
R esN
et-L ST
M m
odel 67
Table 2
Preictal intervals of 5, 15, and 30 minutes predicted seizures in 24 CHB-MIT scalp EEG patients
Patient # of seizures
Preictal length: 5 min Preictal length: 15 min Preictal length: 30 min
Accuracy Sensitivity Specificity FPR f1-score Accuracy Sensitivity Specificity FPR f1-score Accuracy Sensitivity Specificity FPR f1-score
chb01 7 100% 100% 100% 0 1 100% 100% 100% 0 1 99.79% 99.59% 100% 0 0.999
chb02 3 87.95% 87.97% 85.91% 0.131 0.879 91.89% 80.79% 98.98% 0.01 0.887 93.47% 82.94% 100% 0 0.907
chb03 7 97.82% 96.3% 97.33% 0.024 0.977 87.48% 74.49% 99.23% 0.006 0.818 93.66% 88.33% 98.45% 0.012 0.939
chb04 4 80.36% 65.46% 91.06% 0.091 0.697 90.46% 89.8% 91.11% 0.09 0.9 89.78% 83.16% 97.95% 0.01 0.894
chb05 5 94.52% 97.82% 90.83% 0.092 0.956 98.29% 96.56% 98.02% 0.02 0.972 98.76% 98.54% 98.99% 0.02 0.986
chb06 10 96.20% 88.61% 99.78% 0.002 0.912 96.6% 95.41% 97.79% 0.023 0.973 88.34% 87.90% 87.78% 0.125 0.871
chb07 3 100% 100% 100% 0 1 99.4% 98.81% 100% 0 0.993 100% 100% 100% 0 1
chb08 5 100% 100% 100% 0 1 100% 100% 100% 0 1 100% 100% 100% 0 1
chb09 4 99.58% 99.65% 100% 0 0.992 99.64% 99.28% 100% 0 0.995 95.9% 99.78% 99.36% 0.001 0.999
chb10 7 90.52% 94.11% 86.94% 0.12 0.926 91.58% 90.45% 92.72% 0.062 0.927 91.78% 89.58% 92.09% 0.078 0.914
chb11 3 100% 100% 100% 0 1 100% 100% 100% 0 1 99.58% 99.21% 99.94% 0 0.995
chb12 27 100.00% 100% 100% 0 1 96.19% 94.39% 97.43% 0.021 0.954 87.46% 95.06% 97.86% 0.019 0.965
chb13 12 100.00% 100% 100% 0 1 92.05% 88.19% 93.9% 0.05 0.917 91.62% 86.78% 92.26% 0.071 0.899
chb14 8 91.66% 93.27% 86.06% 0.129 0.911 88.45% 80.66% 90.93% 0.08 0.841 83.52% 81.67% 85.87% 0.121 0.826
chb15 20 89.41% 95.46% 83.36% 0.156 0.902 84.97% 87.12% 82.82% 0.262 0.754 80.54% 81.76% 90.12% 0.207 0.827
chb16 10 82.03% 71.2% 90.86% 0.081 0.788 85.33% 71.4% 91.27% 0.087 0.76 80.16% 86.48% 87.79% 0.121 0.874
chb17 3 100% 100% 100% 0 1 99.8% 100% 99.6% 0.003 0.998 100% 100% 100% 0 1
chb18 6 92.35% 91.06% 93.64% 0.053 0.93 93.23% 95.72% 90.73% 0.091 0.942 86.39% 92.53% 88.24% 0.179 0.887
chb19 3 100% 100% 100% 0 1 100% 100% 100% 0 1 100% 100% 100% 0 1
chb20 8 100% 100% 100% 0 1 99.86% 100% 99.72% 0.002 0.995 90.88% 100% 99.77% 0.001 0.998
chb21 4 96.40% 93.81% 96.99% 0.03 0.962 93.36% 91.87% 94.83% 0.0541 0.935 91.81% 88.8% 92.81% 0.061 0.916
chb22 3 83.61% 93.24% 69.98% 0.3 0.846 83.61% 88.43% 74.79% 0.2542 0.843 87.78% 87.87% 86.69% 0.122 0.876
chb23 7 96.66% 96.01% 97.32% 0.025 0.961 94.01% 99.05% 82.97% 0.16 0.942 93.86% 99.61% 88.1% 0.12 0.955
chb24 16 88.86% 84.76% 88.96% 0.1 0.865 86.93% 87.47% 92.38% 0.066 0.774 82.70% 74.57% 94.83% 0.053 0.768
Average 94.5% 93.7% 94.13% 0.0555 0.9376 93.88% 92.08% 94.55% 0.0583 0.9216 91.99% 91.84% 94.95% 0.0550 0.9289
68 Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model
Fig. 10. (a) acc, (b) sens (c), spec (d), fpr (e), and the f1-score for 5, 15, and 30-minute preictal lengths.
0.055-0.058 in this situation, with false alarms increasing as the preictal duration window rises from 5 to 30 minutes before a seizure. Furthermore, depending on the instance, the ResNet-LSTM classifier gives zero false alarms in 7, 8, 9, 11, 12, 13, 17, 19, and 20 of the 24 cases in the database. Our ResNet-LSTM model shows its accuracy, sensitivity, specificity, fpr, and f-1 score using the bar chart as shown in Fig. 10. The bar chart shows the preictal 5-minute scores, with the best performance in accuracy, sensitivity, and f-1 score, but fpr is among the highest in the 15-minute preictal length. The lowest performance among all three is a 30-minute preictal length.
4.3. Comparisons with state-of-the-art algorithms
We compared our proposed algorithm with existing algorithms to statistically validate its performance. The results of the proposed technique is compared with other classification methods presented in the literature, are given in Table 3. This comparison focuses on research that was also examined using the CHB-MIT EEG database, which is now the only publicly available database. The suggested ResNet-LSTM model predicts seizures better than any
Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model 69
Table 3
5 minutes preictal time is optimal for epileptic seizure prediction on CHB-MIT sclap EEG dataset
Authors Year Features extraction method Classifier Acc (%) Sen (%) Spec (%) FPR (h-1) Preictal duration (min)
Khan et al. [22] 2017 Continuous wavelet transform coefficients
CNN – 87.8 – 0.147 10
Truong et al. [43] 2018 Short-time Fourier transform (STFT) CNN – 81.2 – 0.16 5
Ozcan et al. [30] 2019 Hjorth parameters 3D CNN – 85.71 – 0.096 –
Cho et al. [12] 2019 MIT phase locking value SVM – 82.44 82.76 – 5
Myers et al. [28] 2016 Phase/amplitude locking value – – 77 – 0.17 60
Chu et al. [13] 2017 Fourier transform coefficients PSD – – 83.33 0.483 86
Alotaiby et al. [4] 2017 Common spatial pattern statistics LDA – 81 61 0.47 60
87 57 0.40 90
89 37 0.39 120
Proposed work 2022 Fourier transform spectral power features
ResNet-LSTM 94.50 93.70 94.10 0.0555 5
93.88 92.08 94.50 0.0583 15
91.99 91.84 94.95 0.0550 30
Fig. 11. Comparison of the proposed method with previous studies on (a) sensitivity and (b) false positive rate (fpr).
previous technique and is tested using the same EEG dataset. The majority of the remaining research has only used a smaller fraction of the available recordings, but at this time the entire database of 24 patients is being used [36]. The comparison of the sensitivity and FPR of our proposed technique with the previous studies is shown using a bar chart, as shown in Fig. 11.
5. Conclusion and future work
In this study, a hybrid deep learning method called the ResNet50-LSTM model is proposed. This model achieved better sensitivity and a lower FPR. The primary purpose of epileptic seizure prediction is to classify EEG data as interictal or preictal. The ResNet-50 improves the performance of the existing CNN model. This technique is suitable for large datasets, so that the model will be trained well. Therefore, the performance of the model continues to improve in terms of evaluation metrics. The LSTM was used to classify the seizures in this study, and it proved to be a better performance metric for assessing preictal and interictal EEG signals. The proposed technique produced better seizure prediction results and improved the false alarm rate. It gives a prediction acc of 94.5%, a sens of 93.70%, a spec of 94.10%, an fpr of 0.055, and an f 1-score of 0.9376 of 5-minutes of preictal length. More EEG data is needed to test the proposed technique before it can be validated through a clinical trial. Additional research is needed in this area for the more accurate and faster identification of epileptic seizures. This indicates that a seizure prediction model could reduce the risk of people living with epilepsy diseases.
70 Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model
Acknowledgements
This research is financially supported by the Department of Science and Technology (DST) and the Council of Scientific & Industrial Research (CSIR) (File No: 09/263(1097)/2016-EMR-I).
Declarations
Both the authors have given their consent on the following points:
• There is no conflict of interest among the authors.
• Both the authors made substantial contributions to the conception of the work. The first author did the analysis
and data collection for the research and drafted the manuscript. The second author provided the initial idea, revised the contents, and finalized the version for submission.
• Both the authors have given their consent for the publication in this journal.
• The dataset for this study can be found in publicly available repositories. The CHB-MIT data set can be found
at https://physionet.org/content/chbmit/1.0.0/.
• The manuscript is entirely original, has not been submitted elsewhere for consideration, and proper acknowl-
edgment is given to the pre-existing research and data.
References
[1] A. Aarabi and B. He, Seizure prediction in patients with focal hippocampal epilepsy, Clinical Neurophysiology 128(7) (2017), 1299–1307. doi:10.1016/j.clinph.2017.04.026.
[2] U.R. Acharya, Y. Hagiwara and H. Adeli, Automated seizure prediction, Epilepsy & Behavior 88 (2018), 251–261. doi:10.1016/j.yebeh. 2018.09.030.
[3] R. Akut, Wavelet based deep learning approach for epilepsy detection, Health Information Science and Systems 7(1) (2019), 1–9. [4] T.N. Alotaiby, S.A. Alshebeili, F.M. Alotaibi and S.R. Alrshoud, Epileptic seizure prediction using CSP and LDA for scalp EEG signals,
Computational Intelligence and Neuroscience 2017 (2017), 1240323. [5] A.H. Ansari, P.J. Cherian, A. Caicedo, G. Naulaers, M. De Vos and S. Van Huffel, Neonatal seizure detection using deep convolutional
neural networks, International Journal of Neural Systems 29(04) (2019), 1850011. doi:10.1142/S0129065718500119. [6] W. Bomela, S. Wang, C.-A. Chou and J.-S. Li, Real-time inference and detection of disruptive EEG networks for epileptic seizures,
Scientific Reports 10(1) (2020), 1–10. doi:10.1038/s41598-019-56847-4. [7] P. Boonyakitanont, A. Lek-uthai, K. Chomtho and J. Songsiri, A comparison of deep neural networks for seizure detection in EEG signals,
bioRxiv (2019), 702654. [8] R. Challis and R. Kitney, The design of digital filters for biomedical signal processing part 3: The design of Butterworth and Chebychev
filters, Journal of Biomedical Engineering 5(2) (1983), 91–102. doi:10.1016/0141-5425(83)90026-2. [9] CHB-MIT Scalp EEG Database, https://www.physionet.org/pn6/chbmit.
[10] D. Cho, B. Min, J. Kim and B. Lee, EEG-based prediction of epileptic seizures using phase synchronization elicited from noise-assisted mul-tivariate empirical mode decomposition, IEEE Transactions on Neural Systems and Rehabilitation Engineering 25(8) (2016), 1309–1318. doi:10.1109/TNSRE.2016.2618937.
[11] K. Cho, B. Van Merriënboer, D. Bahdanau and Y. Bengio, On the properties of neural machine translation: Encoder–decoder approaches, arXiv preprint, 2014. arXiv:1409.1259.
[12] G. Choi, C. Park, J. Kim, K. Cho, T.-J. Kim, H. Bae, K. Min, K.-Y. Jung and J. Chong, A novel multi-scale 3D CNN with deep neural network for epileptic seizure detection, in: 2019 IEEE International Conference on Consumer Electronics (ICCE), IEEE, 2019, pp. 1–2.
[13] H. Chu, C.K. Chung, W. Jeong and K.-H. Cho, Predicting epileptic seizures from scalp EEG based on attractor state analysis, Computer Methods and Programs in Biomedicine 143 (2017), 75–87. doi:10.1016/j.cmpb.2017.03.002.
[14] A. Eftekhar, W. Juffali, J. El-Imad, T.G. Constandinou and C. Toumazou, Ngram-derived pattern recognition for the detection and prediction of epileptic seizures, PloS one 9(6) (2014), e96235. doi:10.1371/journal.pone.0096235.
[15] A.L. Goldberger, L.A. Amaral, L. Glass, J.M. Hausdorff, P.C. Ivanov, R.G. Mark, J.E. Mietus, G.B. Moody, C.-K. Peng and H.E. Stanley, PhysioBank, PhysioToolkit, and PhysioNet: Components of a new research resource for complex physiologic signals, Circulation 101(23) (2000), e215–e220. doi:10.1161/01.CIR.101.23.e215.
[16] M. Golmohammadi, S. Ziyabari, V. Shah, S.L. de Diego, I. Obeid and J. Picone, Deep architectures for automated seizure detection in scalp EEGs, arXiv preprint, 2017. arXiv:1712.09776.
[17] K. Greff, R.K. Srivastava and J. Schmidhuber, Highway and residual networks learn unrolled iterative estimation, arXiv preprint, 2016. arXiv:1612.07771.
Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model 71
[18] K. He, X. Zhang, S. Ren and J. Sun, Delving deep into rectifiers: Surpassing human-level performance on ImageNet classification, in: Proceedings of the IEEE International Conference on Computer Vision, 2015, pp. 1026–1034.
[19] K. He, X. Zhang, S. Ren and J. Sun, Deep residual learning for image recognition, in: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, 2016, pp. 770–778.
[20] L. Hussain, Detecting epileptic seizure with different feature extracting strategies using robust machine learning classification techniques by applying advance parameter optimization approach, Cognitive Neurodynamics 12(3) (2018), 271–294. doi:10.1007/s11571-018-9477-1.
[21] S. Ibrahim, R. Djemal and A. Alsuwailem, Electroencephalography (EEG) signal processing for epilepsy and autism spectrum disorder diagnosis, Biocybernetics and Biomedical Engineering 38(1) (2018), 16–26. doi:10.1016/j.bbe.2017.08.006.
[22] H. Khan, L. Marcuse, M. Fields, K. Swann and B. Yener, Focal onset seizure prediction using convolutional networks, IEEE Transactions on Biomedical Engineering 65(9) (2017), 2109–2118. doi:10.1109/TBME.2017.2785401.
[23] A. Krizhevsky, I. Sutskever and G.E. Hinton, ImageNet classification with deep convolutional neural networks, Communications of the ACM 60(6) (2017), 84–90. doi:10.1145/3065386.
[24] Y. Liu, S. Sivathamboo, P. Goodin, P. Bonnington, P. Kwan, L. Kuhlmann, T. O’Brien, P. Perucca and Z. Ge, Epileptic seizure detection using convolutional neural network: A multi-biosignal study, in: Proceedings of the Australasian Computer Science Week Multiconference, 2020, pp. 1–8.
[25] F. Lotte, M. Congedo, A. Lécuyer, F. Lamarche and B. Arnaldi, A review of classification algorithms for EEG-based brain–computer interfaces, Journal of Neural Engineering 4(2) (2007), R1. doi:10.1088/1741-2560/4/2/R01.
[26] S. Min, B. Lee and S. Yoon, Deep learning in bioinformatics, Briefings in Bioinformatics 18(5) (2017), 851–869. [27] P. Mirowski, D. Madhavan, Y. LeCun and R. Kuzniecky, Classification of patterns of EEG synchronization for seizure prediction, Clinical
Neurophysiology 120(11) (2009), 1927–1940. doi:10.1016/j.clinph.2009.09.002. [28] M.H. Myers, A. Padmanabha, G. Hossain, A.L. de Jongh Curry and C.D. Blaha, Seizure prediction and detection via phase and amplitude
lock values, Frontiers in Human Neuroscience 10 (2016), 80. [29] L. Nanni, S. Ghidoni and S. Brahnam, Handcrafted vs. non-handcrafted features for computer vision classification, Pattern Recognition 71
(2017), 158–172. doi:10.1016/j.patcog.2017.05.025. [30] A.R. Ozcan and S. Erturk, Seizure prediction in scalp EEG using 3D convolutional neural networks with an image-based approach, IEEE
Transactions on Neural Systems and Rehabilitation Engineering 27(11) (2019), 2284–2293. doi:10.1109/TNSRE.2019.2943707. [31] Y. Park, L. Luo, K.K. Parhi and T. Netoff, Seizure prediction with spectral power of EEG using cost-sensitive support vector machines,
Epilepsia 52(10) (2011), 1761–1770. doi:10.1111/j.1528-1167.2011.03138.x. [32] S. Ramgopal, S. Thome-Souza, M. Jackson, N.E. Kadish, I.S. Fernández, J. Klehm, W. Bosl, C. Reinsberger, S. Schachter and T. Lod-
denkemper, Seizure detection, seizure prediction, and closed-loop warning systems in epilepsy, Epilepsy & Behavior 37 (2014), 291–307. doi:10.1016/j.yebeh.2014.06.023.
[33] R.T. Schirrmeister, J.T. Springenberg, L.D.J. Fiederer, M. Glasstetter, K. Eggensperger, M. Tangermann, F. Hutter, W. Burgard and T. Ball, Deep learning with convolutional neural networks for EEG decoding and visualization, Human Brain Mapping 38(11) (2017), 5391–5420. doi:10.1002/hbm.23730.
[34] J. Schmidhuber, S. Hochreiter et al., Long short-term memory, Neural Comput. 9(8) (1997), 1735–1780. doi:10.1162/neco.1997.9.8.1735. [35] B. Sharif and A.H. Jafari, Prediction of epileptic seizures from EEG using analysis of ictal rules on Poincaré plane, Computer Methods and
Programs in Biomedicine 145 (2017), 11–22. doi:10.1016/j.cmpb.2017.04.001. [36] A.H. Shoeb, Application of machine learning to epileptic seizure onset detection and treatment, PhD thesis, Massachusetts Institute of
Technology, 2009. [37] K. Singh and J. Malhotra, Cloud based ensemble machine learning approach for smart detection of epileptic seizures using higher order
spectral analysis, Physical and Engineering Sciences in Medicine 44(1) (2021), 313–324. doi:10.1007/s13246-021-00970-y. [38] K. Singh and J. Malhotra, Two-layer LSTM network-based prediction of epileptic seizures using EEG spectral features, Complex & Intel-
ligent Systems (2022), 1–14. [39] A. Subasi and M.I. Gursoy, EEG signal classification using PCA, ICA, LDA and support vector machines, Expert Systems with Applications
37 (2010), 8659–8666. [40] C. Sudalaimani, N. Sivakumaran, T.T. Elizabeth and V.S. Rominus, Automated detection of the preseizure state in EEG signal using neural
networks, Biocybernetics and Biomedical Engineering 39(1) (2019), 160–175. doi:10.1016/j.bbe.2018.11.007. [41] P. Thodoroff, J. Pineau and A. Lim, Learning robust features using deep learning for automatic seizure detection, in: Machine Learning for
Healthcare Conference, PMLR, 2016, pp. 178–190. [42] S. Toraman, S.A. Tuncer and F. Balgetir, Is it possible to detect cerebral dominance via EEG signals by using deep learning?, Medical
Hypotheses 131 (2019), 109315. doi:10.1016/j.mehy.2019.109315. [43] N.D. Truong, A.D. Nguyen, L. Kuhlmann, M.R. Bonyadi, J. Yang, S. Ippolito and O. Kavehei, Convolutional neural networks for seizure
prediction using intracranial and scalp electroencephalogram, Neural Networks 105 (2018), 104–111. doi:10.1016/j.neunet.2018.04.018. [44] N.D. Truong, A.D. Nguyen, L. Kuhlmann, M.R. Bonyadi, J. Yang and O. Kavehei, A generalised seizure prediction with convolutional
neural networks for intracranial and scalp electroencephalogram data analysis, arXiv preprint, 2017. arXiv:1707.01976. [45] K.M. Tsiouris, V.C. Pezoulas, D.D. Koutsouris, M. Zervakis and D.I. Fotiadis, Discrimination of preictal and interictal brain states from
long-term EEG data, in: 2017 IEEE 30th International Symposium on Computer-Based Medical Systems (CBMS), IEEE, 2017, pp. 318–323. doi:10.1109/CBMS.2017.33.
[46] K.M. Tsiouris, V.C. Pezoulas, M. Zervakis, S. Konitsiotis, D.D. Koutsouris and D.I. Fotiadis, A long short-term memory deep learning network for the prediction of epileptic seizures using EEG signals, Computers in Biology and Medicine 99 (2018), 24–37. doi:10.1016/j. compbiomed.2018.05.019.
72 Y.P. Singh and D.K. Lobiyal / Hybrid deep ResNet-LSTM model
[47] I. Ullah, M. Hussain, H. Aboalsamh et al., An automated system for epilepsy detection using EEG brain signals based on deep learning approach, Expert Systems with Applications 107 (2018), 61–71. doi:10.1016/j.eswa.2018.04.021.
[48] S.M. Usman, S. Khalid and M.H. Aslam, Epileptic seizures prediction using deep learning techniques, Ieee Access 8 (2020), 39998–40007. doi:10.1109/ACCESS.2020.2976866.
[49] Ö. Yıldırım, U.B. Baloglu and U.R. Acharya, A deep convolutional neural network model for automated identification of abnormal EEG signals, Neural Computing and Applications 32(20) (2020), 15857–15868. doi:10.1007/s00521-018-3889-z.
Copyright of AI Communications is the property of IOS Press and its content may not be copied or emailed to multiple sites or posted to a listserv without the copyright holder's express written permission. However, users may print, download, or email articles for individual use.