============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb01
============================================================

Configuration:
  - Task mode: PREDICTION (preictal vs interictal)
  - LOOCV Mode: ENABLED
  - Sequence length: 30 segments
  - Sequence duration: 150s (2.5 min)
  - Stride: 5 segments (83% overlap)
  - Segment duration: 5s
  - Preictal window: 10 min
  - Interictal buffer: 120 min
  - Channel validation: ENABLED
  - Target channels: 18 channels
============================================================

Extracting sequences from patient chb01...
Patient chb01: 671 sequences (153 preictal, 518 interictal)

============================================================
PROCESSING FOLD 0/6
============================================================
Output prefix: chb01_fold0
LOOCV Fold 0: Test seizure=0, Train seizures=[1, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 258 total (129 preictal, 129 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 129 preictal, 129 interictal (dropped 0 preictal, 130 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 235 interictal)

Sequences saved to chb01_fold0_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 0 completed successfully!
✅ Sequences saved to chb01_fold0_sequences_prediction.json

============================================================
PROCESSING FOLD 1/6
============================================================
Output prefix: chb01_fold1
LOOCV Fold 1: Test seizure=1, Train seizures=[0, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 260 total (130 preictal, 130 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 130 preictal, 130 interictal (dropped 0 preictal, 129 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 236 interictal)

Sequences saved to chb01_fold1_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 1 completed successfully!
✅ Sequences saved to chb01_fold1_sequences_prediction.json

============================================================
PROCESSING FOLD 2/6
============================================================
Output prefix: chb01_fold2
LOOCV Fold 2: Test seizure=2, Train seizures=[0, 1, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 262 total (131 preictal, 131 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 131 preictal, 131 interictal (dropped 0 preictal, 128 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 237 interictal)

Sequences saved to chb01_fold2_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 2 completed successfully!
✅ Sequences saved to chb01_fold2_sequences_prediction.json

============================================================
PROCESSING FOLD 3/6
============================================================
Output prefix: chb01_fold3
LOOCV Fold 3: Test seizure=3, Train seizures=[0, 1, 2, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 260 total (130 preictal, 130 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 130 preictal, 130 interictal (dropped 0 preictal, 129 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 236 interictal)

Sequences saved to chb01_fold3_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 3 completed successfully!
✅ Sequences saved to chb01_fold3_sequences_prediction.json

============================================================
PROCESSING FOLD 4/6
============================================================
Output prefix: chb01_fold4
LOOCV Fold 4: Test seizure=4, Train seizures=[0, 1, 2, 3, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 264 total (132 preictal, 132 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 132 preictal, 132 interictal (dropped 0 preictal, 127 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 238 interictal)

Sequences saved to chb01_fold4_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 4 completed successfully!
✅ Sequences saved to chb01_fold4_sequences_prediction.json

============================================================
PROCESSING FOLD 5/6
============================================================
Output prefix: chb01_fold5
LOOCV Fold 5: Test seizure=5, Train seizures=[0, 1, 2, 3, 4, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 268 total (134 preictal, 134 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 134 preictal, 134 interictal (dropped 0 preictal, 125 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 240 interictal)

Sequences saved to chb01_fold5_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 5 completed successfully!
✅ Sequences saved to chb01_fold5_sequences_prediction.json

============================================================
PROCESSING FOLD 6/6
============================================================
Output prefix: chb01_fold6
LOOCV Fold 6: Test seizure=6, Train seizures=[0, 1, 2, 3, 4, 5]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 264 total (132 preictal, 132 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 132 preictal, 132 interictal (dropped 0 preictal, 127 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 238 interictal)

Sequences saved to chb01_fold6_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 6 completed successfully!
✅ Sequences saved to chb01_fold6_sequences_prediction.json

============================================================
✅ BATCH PROCESSING COMPLETED!
✅ Processed 7 folds for patient chb01
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb01
============================================================

Configuration:
  - Task mode: PREDICTION (preictal vs interictal)
  - LOOCV Mode: ENABLED
  - Sequence length: 30 segments
  - Sequence duration: 150s (2.5 min)
  - Stride: 5 segments (83% overlap)
  - Segment duration: 5s
  - Preictal window: 10 min
  - Interictal buffer: 120 min
  - Channel validation: ENABLED
  - Target channels: 18 channels
============================================================

Extracting sequences from patient chb01...
Patient chb01: 671 sequences (153 preictal, 518 interictal)

============================================================
PROCESSING FOLD 0/6
============================================================
Output prefix: chb01_fold0
LOOCV Fold 0: Test seizure=0, Train seizures=[1, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 258 total (129 preictal, 129 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 129 preictal, 129 interictal (dropped 0 preictal, 130 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 235 interictal)

Sequences saved to chb01_fold0_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 0 completed successfully!
✅ Sequences saved to chb01_fold0_sequences_prediction.json

============================================================
PROCESSING FOLD 1/6
============================================================
Output prefix: chb01_fold1
LOOCV Fold 1: Test seizure=1, Train seizures=[0, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 260 total (130 preictal, 130 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 130 preictal, 130 interictal (dropped 0 preictal, 129 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 236 interictal)

Sequences saved to chb01_fold1_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 1 completed successfully!
✅ Sequences saved to chb01_fold1_sequences_prediction.json

============================================================
PROCESSING FOLD 2/6
============================================================
Output prefix: chb01_fold2
LOOCV Fold 2: Test seizure=2, Train seizures=[0, 1, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 262 total (131 preictal, 131 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 131 preictal, 131 interictal (dropped 0 preictal, 128 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 237 interictal)

Sequences saved to chb01_fold2_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 2 completed successfully!
✅ Sequences saved to chb01_fold2_sequences_prediction.json

============================================================
PROCESSING FOLD 3/6
============================================================
Output prefix: chb01_fold3
LOOCV Fold 3: Test seizure=3, Train seizures=[0, 1, 2, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 260 total (130 preictal, 130 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 130 preictal, 130 interictal (dropped 0 preictal, 129 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 236 interictal)

Sequences saved to chb01_fold3_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 3 completed successfully!
✅ Sequences saved to chb01_fold3_sequences_prediction.json

============================================================
PROCESSING FOLD 4/6
============================================================
Output prefix: chb01_fold4
LOOCV Fold 4: Test seizure=4, Train seizures=[0, 1, 2, 3, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 264 total (132 preictal, 132 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 132 preictal, 132 interictal (dropped 0 preictal, 127 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 238 interictal)

Sequences saved to chb01_fold4_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 4 completed successfully!
✅ Sequences saved to chb01_fold4_sequences_prediction.json

============================================================
PROCESSING FOLD 5/6
============================================================
Output prefix: chb01_fold5
LOOCV Fold 5: Test seizure=5, Train seizures=[0, 1, 2, 3, 4, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 268 total (134 preictal, 134 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 134 preictal, 134 interictal (dropped 0 preictal, 125 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 240 interictal)

Sequences saved to chb01_fold5_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 5 completed successfully!
✅ Sequences saved to chb01_fold5_sequences_prediction.json

============================================================
PROCESSING FOLD 6/6
============================================================
Output prefix: chb01_fold6
LOOCV Fold 6: Test seizure=6, Train seizures=[0, 1, 2, 3, 4, 5]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 306
  - Preictal sequences: 153
  - Interictal sequences: 153
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb01: 306 total (153 preictal, 153 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 264 total (132 preictal, 132 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 280.3s (4.7 min)
Class balance: 153/153 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 132 preictal, 132 interictal (dropped 0 preictal, 127 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 238 interictal)

Sequences saved to chb01_fold6_sequences_prediction.json
File size: 0.51 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 42
Files with valid channels: 42
Files with invalid channels: 0

✅ Fold 6 completed successfully!
✅ Sequences saved to chb01_fold6_sequences_prediction.json

============================================================
✅ BATCH PROCESSING COMPLETED!
✅ Processed 7 folds for patient chb01
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb01
============================================================

============================================================
PREPROCESSING FOLD 0/6
============================================================
2025-11-12 18:18:01,136 - INFO - ============================================================
2025-11-12 18:18:01,136 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 18:18:01,136 - INFO - ============================================================
2025-11-12 18:18:01,136 - INFO - Output prefix: chb01_fold0
2025-11-12 18:18:01,136 - INFO - EEG Preprocessor initialized
2025-11-12 18:18:01,136 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 18:18:01,136 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 18:18:01,136 - INFO - Segment duration: 5 seconds
2025-11-12 18:18:01,136 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 18:18:01,137 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 18:18:01,137 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 18:18:01,137 - INFO - Loading segments from chb01_fold0_sequences_prediction.json
2025-11-12 18:18:01,149 - INFO - Loaded 306 total sequences
2025-11-12 18:18:01,149 - INFO - Channel validation (from segmentation): 42/42 files valid
2025-11-12 18:18:01,149 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 18:18:01,149 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 18:18:01,149 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 18:18:01,149 - INFO - train: 258 sequences (129 preictal, 129 interictal)
2025-11-12 18:18:01,149 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-12 18:18:01,166 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 18:18:01,166 - INFO - train: kept 129 preictal and 129 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:18:01,166 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:18:01,182 - INFO - ============================================================
2025-11-12 18:18:01,182 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 18:18:01,182 - INFO - ============================================================
2025-11-12 18:18:01,182 - INFO - Processing 258 training samples to compute normalization stats...
2025-11-12 18:18:01,182 - INFO - Processing 258 sequences from 32 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/258 [00:00<?, ?it/s]Processing training data:   0%|8                                                                                                                                                                                                                  | 1/258 [00:02<11:37,  2.71s/it]Processing training data:   3%|#####7                                                                                                                                                                                                             | 7/258 [00:04<02:07,  1.97it/s]Processing training data:   6%|#############                                                                                                                                                                                                     | 16/258 [00:04<00:51,  4.68it/s]Processing training data:  15%|###############################7                                                                                                                                                                                  | 39/258 [00:05<00:16, 13.59it/s]Processing training data:  19%|########################################6                                                                                                                                                                         | 50/258 [00:05<00:12, 16.69it/s]Processing training data:  22%|###############################################2                                                                                                                                                                  | 58/258 [00:05<00:12, 16.17it/s]Processing training data:  31%|#################################################################1                                                                                                                                                | 80/258 [00:06<00:07, 23.12it/s]Processing training data:  39%|#################################################################################8                                                                                                                               | 101/258 [00:07<00:07, 19.70it/s]Processing training data:  41%|#####################################################################################8                                                                                                                           | 106/258 [00:08<00:09, 15.95it/s]Processing training data:  42%|########################################################################################2                                                                                                                        | 109/258 [00:09<00:14, 10.44it/s]Processing training data:  45%|#############################################################################################9                                                                                                                   | 116/258 [00:11<00:18,  7.81it/s]Processing training data:  47%|##################################################################################################8                                                                                                              | 122/258 [00:12<00:21,  6.44it/s]Processing training data:  50%|########################################################################################################5                                                                                                        | 129/258 [00:14<00:22,  5.75it/s]Processing training data:  52%|###########################################################################################################7                                                                                                     | 133/258 [00:15<00:24,  5.03it/s]Processing training data:  54%|#################################################################################################################4                                                                                               | 140/258 [00:16<00:19,  6.09it/s]Processing training data:  63%|####################################################################################################################################                                                                             | 163/258 [00:16<00:07, 12.32it/s]Processing training data:  71%|#####################################################################################################################################################                                                            | 184/258 [00:18<00:05, 12.59it/s]Processing training data:  74%|#########################################################################################################################################################9                                                       | 190/258 [00:19<00:07,  9.71it/s]Processing training data:  76%|###############################################################################################################################################################5                                                 | 197/258 [00:21<00:07,  7.68it/s]Processing training data:  79%|####################################################################################################################################################################4                                            | 203/258 [00:22<00:07,  7.19it/s]Processing training data:  80%|#######################################################################################################################################################################6                                         | 207/258 [00:24<00:09,  5.32it/s]Processing training data:  84%|##############################################################################################################################################################################9                                  | 216/258 [00:25<00:06,  6.71it/s]Processing training data:  84%|################################################################################################################################################################################5                                | 218/258 [00:26<00:08,  4.60it/s]Processing training data:  87%|#####################################################################################################################################################################################4                           | 224/258 [00:28<00:07,  4.27it/s]Processing training data:  89%|##########################################################################################################################################################################################3                      | 230/258 [00:29<00:06,  4.62it/s]Processing training data:  91%|##############################################################################################################################################################################################3                  | 235/258 [00:31<00:05,  3.91it/s]Processing training data:  93%|##################################################################################################################################################################################################4              | 240/258 [00:32<00:04,  3.71it/s]Processing training data:  95%|######################################################################################################################################################################################################4          | 245/258 [00:34<00:03,  3.82it/s]Processing training data:  97%|#########################################################################################################################################################################################################7       | 249/258 [00:36<00:02,  3.16it/s]Processing training data:  98%|#############################################################################################################################################################################################################7   | 254/258 [00:37<00:01,  3.35it/s]Processing training data:  99%|###############################################################################################################################################################################################################3 | 256/258 [00:38<00:00,  3.24it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 258/258 [00:38<00:00,  3.49it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 258/258 [00:38<00:00,  6.71it/s]
2025-11-12 18:18:39,616 - INFO - Computing normalization statistics from training data...
2025-11-12 18:18:40,108 - INFO - Normalization stats computed:
2025-11-12 18:18:40,108 - INFO -   Mean: -0.209846
2025-11-12 18:18:40,109 - INFO -   Std: 2.368122
2025-11-12 18:18:40,109 - INFO -   Saved to: preprocessing\checkpoints\chb01_fold0\normalization_stats.json
2025-11-12 18:18:40,160 - INFO - Applying normalization and saving 258 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/258 [00:00<?, ?it/s]2025-11-12 18:18:40,172 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold0\train_dataset.h5
Normalizing and saving training data:   4%|#######6                                                                                                                                                                                              | 10/258 [00:00<00:16, 14.60it/s]Normalizing and saving training data:   8%|###############3                                                                                                                                                                                      | 20/258 [00:01<00:16, 14.31it/s]Normalizing and saving training data:  12%|#######################                                                                                                                                                                               | 30/258 [00:02<00:15, 14.56it/s]Normalizing and saving training data:  16%|##############################6                                                                                                                                                                       | 40/258 [00:02<00:14, 14.63it/s]Normalizing and saving training data:  19%|######################################3                                                                                                                                                               | 50/258 [00:03<00:14, 14.69it/s]Normalizing and saving training data:  23%|##############################################                                                                                                                                                        | 60/258 [00:04<00:13, 14.83it/s]Normalizing and saving training data:  27%|#####################################################7                                                                                                                                                | 70/258 [00:04<00:12, 14.86it/s]Normalizing and saving training data:  31%|#############################################################3                                                                                                                                        | 80/258 [00:05<00:12, 14.83it/s]Normalizing and saving training data:  35%|#####################################################################                                                                                                                                 | 90/258 [00:06<00:11, 14.92it/s]Normalizing and saving training data:  39%|############################################################################3                                                                                                                        | 100/258 [00:06<00:10, 15.02it/s]Normalizing and saving training data:  43%|###################################################################################9                                                                                                                 | 110/258 [00:07<00:09, 14.98it/s]Normalizing and saving training data:  47%|###########################################################################################6                                                                                                         | 120/258 [00:08<00:09, 14.93it/s]Normalizing and saving training data:  50%|###################################################################################################2                                                                                                 | 130/258 [00:08<00:08, 14.54it/s]Normalizing and saving training data:  54%|##########################################################################################################8                                                                                          | 140/258 [00:09<00:08, 14.72it/s]Normalizing and saving training data:  58%|##################################################################################################################5                                                                                  | 150/258 [00:10<00:07, 14.80it/s]Normalizing and saving training data:  62%|##########################################################################################################################1                                                                          | 160/258 [00:10<00:06, 14.87it/s]Normalizing and saving training data:  66%|#################################################################################################################################8                                                                   | 170/258 [00:11<00:05, 14.82it/s]Normalizing and saving training data:  70%|#########################################################################################################################################4                                                           | 180/258 [00:12<00:05, 14.91it/s]Normalizing and saving training data:  74%|#################################################################################################################################################                                                    | 190/258 [00:12<00:04, 14.84it/s]Normalizing and saving training data:  78%|########################################################################################################################################################7                                            | 200/258 [00:13<00:03, 14.81it/s]Normalizing and saving training data:  81%|################################################################################################################################################################3                                    | 210/258 [00:14<00:03, 14.87it/s]Normalizing and saving training data:  85%|#######################################################################################################################################################################9                             | 220/258 [00:14<00:02, 14.92it/s]Normalizing and saving training data:  89%|###############################################################################################################################################################################6                     | 230/258 [00:15<00:01, 14.95it/s]Normalizing and saving training data:  93%|#######################################################################################################################################################################################2             | 240/258 [00:16<00:01, 14.96it/s]Normalizing and saving training data:  97%|##############################################################################################################################################################################################8      | 250/258 [00:16<00:00, 15.01it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 258/258 [00:16<00:00, 15.31it/s]
2025-11-12 18:18:57,555 - INFO - Training data processing completed during stats computation phase
2025-11-12 18:18:57,556 - INFO - Loaded normalization statistics:
2025-11-12 18:18:57,556 - INFO -   Mean: -0.209846
2025-11-12 18:18:57,556 - INFO -   Std: 2.368122
2025-11-12 18:18:57,556 - INFO - Split train already completed, skipping
2025-11-12 18:18:57,556 - INFO - Processing test split...
2025-11-12 18:18:57,557 - INFO - Need to process 48/48 sequences for test
2025-11-12 18:18:57,557 - INFO - Processing 48 sequences from 17 unique files
2025-11-12 18:18:57,557 - INFO - Average 2.8 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/48 [00:00<?, ?it/s]Processing test:   2%|####6                                                                                                                                                                                                                        | 1/48 [00:00<00:32,  1.43it/s]2025-11-12 18:18:58,259 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold0\test_dataset.h5
2025-11-12 18:18:59,781 - INFO - Progress: 282/306 (92.2%) - ETA: 0.1 minutes
Processing test:  52%|##################################################################################################################5                                                                                                         | 25/48 [00:03<00:03,  7.50it/s]Processing test:  56%|###########################################################################################################################7                                                                                                | 27/48 [00:04<00:03,  5.77it/s]Processing test:  60%|####################################################################################################################################9                                                                                       | 29/48 [00:05<00:03,  5.18it/s]Processing test:  65%|##############################################################################################################################################                                                                              | 31/48 [00:05<00:03,  5.42it/s]Processing test:  67%|##################################################################################################################################################6                                                                         | 32/48 [00:06<00:03,  4.54it/s]Processing test:  71%|###########################################################################################################################################################8                                                                | 34/48 [00:06<00:03,  3.84it/s]2025-11-12 18:19:05,194 - INFO - Progress: 293/306 (95.8%) - ETA: 0.0 minutes
Processing test:  75%|#####################################################################################################################################################################                                                       | 36/48 [00:07<00:03,  3.00it/s]Processing test:  77%|#########################################################################################################################################################################5                                                  | 37/48 [00:09<00:05,  2.20it/s]Processing test:  81%|##################################################################################################################################################################################7                                         | 39/48 [00:09<00:03,  2.74it/s]Processing test:  83%|#######################################################################################################################################################################################3                                    | 40/48 [00:09<00:02,  2.86it/s]Processing test:  85%|###########################################################################################################################################################################################9                                | 41/48 [00:09<00:02,  3.00it/s]Processing test:  88%|################################################################################################################################################################################################5                           | 42/48 [00:11<00:03,  1.78it/s]Processing test:  92%|#########################################################################################################################################################################################################6                  | 44/48 [00:12<00:01,  2.03it/s]2025-11-12 18:19:10,316 - INFO - Progress: 303/306 (99.0%) - ETA: 0.0 minutes
Processing test:  96%|##################################################################################################################################################################################################################8         | 46/48 [00:13<00:00,  2.04it/s]Processing test:  98%|#######################################################################################################################################################################################################################4    | 47/48 [00:13<00:00,  2.23it/s]Processing test: 100%|############################################################################################################################################################################################################################| 48/48 [00:13<00:00,  2.42it/s]Processing test: 100%|############################################################################################################################################################################################################################| 48/48 [00:13<00:00,  3.52it/s]
2025-11-12 18:19:11,429 - INFO - Validating final datasets...
2025-11-12 18:19:11,437 - INFO - train dataset validation:
2025-11-12 18:19:11,437 - INFO -   - Segments: 258
2025-11-12 18:19:11,437 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:19:11,437 - INFO -   - Classes: 129 preictal, 129 interictal
2025-11-12 18:19:11,437 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:19:11,443 - INFO - test dataset validation:
2025-11-12 18:19:11,443 - INFO -   - Segments: 48
2025-11-12 18:19:11,443 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:19:11,443 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-12 18:19:11,443 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:19:11,443 - INFO - ============================================================
2025-11-12 18:19:11,443 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 18:19:11,443 - INFO - Total time: 1.2 minutes
2025-11-12 18:19:11,443 - INFO - Processed segments: 306
2025-11-12 18:19:11,443 - INFO - Average rate: 4.4 segments/second
2025-11-12 18:19:11,443 - INFO - ============================================================
✅ Fold 0 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 1/6
============================================================
2025-11-12 18:19:11,515 - INFO - ============================================================
2025-11-12 18:19:11,515 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 18:19:11,515 - INFO - ============================================================
2025-11-12 18:19:11,515 - INFO - Output prefix: chb01_fold1
2025-11-12 18:19:11,515 - INFO - EEG Preprocessor initialized
2025-11-12 18:19:11,515 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 18:19:11,515 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 18:19:11,515 - INFO - Segment duration: 5 seconds
2025-11-12 18:19:11,515 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 18:19:11,515 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 18:19:11,515 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 18:19:11,516 - INFO - Loading segments from chb01_fold1_sequences_prediction.json
2025-11-12 18:19:11,528 - INFO - Loaded 306 total sequences
2025-11-12 18:19:11,528 - INFO - Channel validation (from segmentation): 42/42 files valid
2025-11-12 18:19:11,528 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 18:19:11,528 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 18:19:11,528 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 18:19:11,528 - INFO - train: 260 sequences (130 preictal, 130 interictal)
2025-11-12 18:19:11,528 - INFO - test: 46 sequences (23 preictal, 23 interictal)
2025-11-12 18:19:11,544 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 18:19:11,544 - INFO - train: kept 130 preictal and 130 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:19:11,544 - INFO - test: kept 23 preictal and 23 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:19:11,560 - INFO - ============================================================
2025-11-12 18:19:11,560 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 18:19:11,560 - INFO - ============================================================
2025-11-12 18:19:11,560 - INFO - Processing 260 training samples to compute normalization stats...
2025-11-12 18:19:11,560 - INFO - Processing 260 sequences from 32 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/260 [00:00<?, ?it/s]Processing training data:   0%|8                                                                                                                                                                                                                  | 1/260 [00:00<02:18,  1.86it/s]Processing training data:   9%|##################5                                                                                                                                                                                               | 23/260 [00:01<00:18, 12.82it/s]Processing training data:  12%|#########################                                                                                                                                                                                         | 31/260 [00:03<00:25,  9.00it/s]Processing training data:  14%|#############################                                                                                                                                                                                     | 36/260 [00:04<00:30,  7.44it/s]Processing training data:  15%|################################3                                                                                                                                                                                 | 40/260 [00:04<00:29,  7.49it/s]Processing training data:  17%|##################################7                                                                                                                                                                               | 43/260 [00:05<00:30,  7.08it/s]Processing training data:  25%|###################################################6                                                                                                                                                              | 64/260 [00:06<00:13, 14.77it/s]Processing training data:  34%|#######################################################################                                                                                                                                           | 88/260 [00:07<00:10, 15.91it/s]Processing training data:  36%|###########################################################################1                                                                                                                                      | 93/260 [00:09<00:17,  9.67it/s]Processing training data:  40%|##################################################################################7                                                                                                                              | 103/260 [00:09<00:13, 11.80it/s]Processing training data:  44%|###########################################################################################6                                                                                                                     | 114/260 [00:11<00:14, 10.08it/s]Processing training data:  47%|#################################################################################################2                                                                                                               | 121/260 [00:12<00:15,  8.80it/s]Processing training data:  50%|#######################################################################################################6                                                                                                         | 129/260 [00:12<00:13,  9.36it/s]Processing training data:  58%|##########################################################################################################################1                                                                                      | 152/260 [00:14<00:08, 12.69it/s]Processing training data:  60%|############################################################################################################################5                                                                                    | 155/260 [00:15<00:10,  9.96it/s]Processing training data:  61%|###############################################################################################################################8                                                                                 | 159/260 [00:16<00:15,  6.57it/s]Processing training data:  63%|####################################################################################################################################6                                                                            | 165/260 [00:17<00:13,  7.15it/s]Processing training data:  72%|#####################################################################################################################################################5                                                           | 186/260 [00:19<00:08,  9.01it/s]Processing training data:  74%|###########################################################################################################################################################1                                                     | 193/260 [00:21<00:09,  6.97it/s]Processing training data:  76%|###############################################################################################################################################################1                                                 | 198/260 [00:22<00:10,  5.82it/s]Processing training data:  78%|###################################################################################################################################################################9                                             | 204/260 [00:24<00:10,  5.50it/s]Processing training data:  80%|#######################################################################################################################################################################2                                         | 208/260 [00:25<00:11,  4.65it/s]Processing training data:  82%|###########################################################################################################################################################################2                                     | 213/260 [00:27<00:11,  4.12it/s]Processing training data:  84%|################################################################################################################################################################################                                 | 219/260 [00:27<00:07,  5.28it/s]Processing training data:  85%|################################################################################################################################################################################8                                | 220/260 [00:28<00:09,  4.06it/s]Processing training data:  87%|####################################################################################################################################################################################8                            | 225/260 [00:30<00:09,  3.61it/s]Processing training data:  90%|############################################################################################################################################################################################1                    | 234/260 [00:31<00:05,  4.49it/s]Processing training data:  93%|#################################################################################################################################################################################################7               | 241/260 [00:32<00:03,  5.88it/s]Processing training data:  96%|########################################################################################################################################################################################################1        | 249/260 [00:32<00:01,  7.36it/s]Processing training data:  97%|#########################################################################################################################################################################################################7       | 251/260 [00:33<00:01,  5.90it/s]Processing training data:  97%|###########################################################################################################################################################################################################3     | 253/260 [00:35<00:01,  3.94it/s]Processing training data:  99%|###############################################################################################################################################################################################################3 | 258/260 [00:36<00:00,  3.58it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 260/260 [00:36<00:00,  7.04it/s]
2025-11-12 18:19:48,479 - INFO - Computing normalization statistics from training data...
2025-11-12 18:19:48,974 - INFO - Normalization stats computed:
2025-11-12 18:19:48,974 - INFO -   Mean: -0.220305
2025-11-12 18:19:48,974 - INFO -   Std: 2.331842
2025-11-12 18:19:48,974 - INFO -   Saved to: preprocessing\checkpoints\chb01_fold1\normalization_stats.json
2025-11-12 18:19:49,027 - INFO - Applying normalization and saving 260 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/260 [00:00<?, ?it/s]2025-11-12 18:19:49,038 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold1\train_dataset.h5
Normalizing and saving training data:   4%|#######6                                                                                                                                                                                              | 10/260 [00:00<00:16, 15.39it/s]Normalizing and saving training data:   8%|###############2                                                                                                                                                                                      | 20/260 [00:01<00:15, 15.13it/s]Normalizing and saving training data:  12%|######################8                                                                                                                                                                               | 30/260 [00:01<00:15, 15.16it/s]Normalizing and saving training data:  15%|##############################4                                                                                                                                                                       | 40/260 [00:02<00:14, 15.06it/s]Normalizing and saving training data:  19%|######################################                                                                                                                                                                | 50/260 [00:03<00:13, 15.07it/s]Normalizing and saving training data:  23%|#############################################6                                                                                                                                                        | 60/260 [00:03<00:13, 15.08it/s]Normalizing and saving training data:  27%|#####################################################3                                                                                                                                                | 70/260 [00:04<00:12, 15.20it/s]Normalizing and saving training data:  31%|############################################################9                                                                                                                                         | 80/260 [00:05<00:11, 15.05it/s]Normalizing and saving training data:  35%|####################################################################5                                                                                                                                 | 90/260 [00:05<00:11, 14.95it/s]Normalizing and saving training data:  38%|###########################################################################7                                                                                                                         | 100/260 [00:06<00:10, 14.84it/s]Normalizing and saving training data:  42%|###################################################################################3                                                                                                                 | 110/260 [00:07<00:10, 14.98it/s]Normalizing and saving training data:  46%|##########################################################################################9                                                                                                          | 120/260 [00:07<00:09, 15.14it/s]Normalizing and saving training data:  50%|##################################################################################################5                                                                                                  | 130/260 [00:08<00:08, 15.23it/s]Normalizing and saving training data:  54%|##########################################################################################################                                                                                           | 140/260 [00:09<00:07, 15.18it/s]Normalizing and saving training data:  58%|#################################################################################################################6                                                                                   | 150/260 [00:09<00:07, 15.00it/s]Normalizing and saving training data:  62%|#########################################################################################################################2                                                                           | 160/260 [00:10<00:06, 14.91it/s]Normalizing and saving training data:  65%|################################################################################################################################8                                                                    | 170/260 [00:11<00:06, 14.81it/s]Normalizing and saving training data:  69%|########################################################################################################################################3                                                            | 180/260 [00:12<00:05, 14.77it/s]Normalizing and saving training data:  73%|###############################################################################################################################################9                                                     | 190/260 [00:12<00:04, 14.82it/s]Normalizing and saving training data:  77%|#######################################################################################################################################################5                                             | 200/260 [00:13<00:04, 14.74it/s]Normalizing and saving training data:  81%|###############################################################################################################################################################1                                     | 210/260 [00:14<00:03, 14.77it/s]Normalizing and saving training data:  85%|######################################################################################################################################################################6                              | 220/260 [00:14<00:02, 14.71it/s]Normalizing and saving training data:  88%|##############################################################################################################################################################################2                      | 230/260 [00:15<00:02, 14.72it/s]Normalizing and saving training data:  92%|#####################################################################################################################################################################################8               | 240/260 [00:16<00:01, 14.81it/s]Normalizing and saving training data:  96%|#############################################################################################################################################################################################4       | 250/260 [00:16<00:00, 14.85it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 260/260 [00:17<00:00, 14.95it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 260/260 [00:17<00:00, 14.95it/s]
2025-11-12 18:20:06,435 - INFO - Training data processing completed during stats computation phase
2025-11-12 18:20:06,436 - INFO - Loaded normalization statistics:
2025-11-12 18:20:06,436 - INFO -   Mean: -0.220305
2025-11-12 18:20:06,436 - INFO -   Std: 2.331842
2025-11-12 18:20:06,436 - INFO - Split train already completed, skipping
2025-11-12 18:20:06,436 - INFO - Processing test split...
2025-11-12 18:20:06,436 - INFO - Need to process 46/46 sequences for test
2025-11-12 18:20:06,436 - INFO - Processing 46 sequences from 18 unique files
2025-11-12 18:20:06,437 - INFO - Average 2.6 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/46 [00:00<?, ?it/s]Processing test:   2%|####8                                                                                                                                                                                                                        | 1/46 [00:00<00:16,  2.70it/s]Processing test:   4%|#########6                                                                                                                                                                                                                   | 2/46 [00:00<00:22,  1.97it/s]2025-11-12 18:20:07,412 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold1\test_dataset.h5
2025-11-12 18:20:08,943 - INFO - Progress: 284/306 (92.8%) - ETA: 0.1 minutes
Processing test:  54%|#######################################################################################################################5                                                                                                    | 25/46 [00:02<00:02, 10.00it/s]Processing test:  57%|############################################################################################################################3                                                                                               | 26/46 [00:03<00:02,  8.00it/s]Processing test:  61%|#####################################################################################################################################9                                                                                      | 28/46 [00:04<00:02,  6.42it/s]Processing test:  65%|###############################################################################################################################################4                                                                            | 30/46 [00:05<00:03,  4.19it/s]Processing test:  70%|#########################################################################################################################################################                                                                   | 32/46 [00:05<00:03,  4.55it/s]Processing test:  72%|#############################################################################################################################################################8                                                              | 33/46 [00:05<00:02,  4.45it/s]Processing test:  74%|##################################################################################################################################################################6                                                         | 34/46 [00:06<00:02,  4.05it/s]2025-11-12 18:20:13,444 - INFO - Progress: 295/306 (96.4%) - ETA: 0.0 minutes
Processing test:  78%|############################################################################################################################################################################1                                               | 36/46 [00:07<00:03,  3.10it/s]Processing test:  80%|################################################################################################################################################################################9                                           | 37/46 [00:07<00:02,  3.20it/s]Processing test:  83%|#####################################################################################################################################################################################7                                      | 38/46 [00:07<00:02,  3.30it/s]Processing test:  85%|##########################################################################################################################################################################################5                                 | 39/46 [00:08<00:02,  3.39it/s]Processing test:  87%|###############################################################################################################################################################################################3                            | 40/46 [00:09<00:02,  2.06it/s]Processing test:  91%|########################################################################################################################################################################################################8                   | 42/46 [00:09<00:01,  2.71it/s]Processing test:  96%|##################################################################################################################################################################################################################4         | 44/46 [00:09<00:00,  3.53it/s]Processing test:  98%|#######################################################################################################################################################################################################################2    | 45/46 [00:10<00:00,  3.61it/s]2025-11-12 18:20:17,175 - INFO - Progress: 305/306 (99.7%) - ETA: 0.0 minutes
Processing test: 100%|############################################################################################################################################################################################################################| 46/46 [00:11<00:00,  2.36it/s]Processing test: 100%|############################################################################################################################################################################################################################| 46/46 [00:11<00:00,  4.18it/s]
2025-11-12 18:20:17,554 - INFO - Validating final datasets...
2025-11-12 18:20:17,562 - INFO - train dataset validation:
2025-11-12 18:20:17,562 - INFO -   - Segments: 260
2025-11-12 18:20:17,562 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:20:17,562 - INFO -   - Classes: 130 preictal, 130 interictal
2025-11-12 18:20:17,562 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:20:17,567 - INFO - test dataset validation:
2025-11-12 18:20:17,567 - INFO -   - Segments: 46
2025-11-12 18:20:17,567 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:20:17,567 - INFO -   - Classes: 23 preictal, 23 interictal
2025-11-12 18:20:17,567 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:20:17,567 - INFO - ============================================================
2025-11-12 18:20:17,567 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 18:20:17,567 - INFO - Total time: 1.1 minutes
2025-11-12 18:20:17,567 - INFO - Processed segments: 306
2025-11-12 18:20:17,567 - INFO - Average rate: 4.6 segments/second
2025-11-12 18:20:17,567 - INFO - ============================================================
✅ Fold 1 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 2/6
============================================================
2025-11-12 18:20:17,641 - INFO - ============================================================
2025-11-12 18:20:17,641 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 18:20:17,641 - INFO - ============================================================
2025-11-12 18:20:17,641 - INFO - Output prefix: chb01_fold2
2025-11-12 18:20:17,641 - INFO - EEG Preprocessor initialized
2025-11-12 18:20:17,641 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 18:20:17,641 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 18:20:17,641 - INFO - Segment duration: 5 seconds
2025-11-12 18:20:17,641 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 18:20:17,641 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 18:20:17,641 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 18:20:17,641 - INFO - Loading segments from chb01_fold2_sequences_prediction.json
2025-11-12 18:20:17,653 - INFO - Loaded 306 total sequences
2025-11-12 18:20:17,653 - INFO - Channel validation (from segmentation): 42/42 files valid
2025-11-12 18:20:17,653 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 18:20:17,653 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 18:20:17,653 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 18:20:17,653 - INFO - train: 262 sequences (131 preictal, 131 interictal)
2025-11-12 18:20:17,653 - INFO - test: 44 sequences (22 preictal, 22 interictal)
2025-11-12 18:20:17,673 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 18:20:17,674 - INFO - train: kept 131 preictal and 131 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:20:17,674 - INFO - test: kept 22 preictal and 22 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:20:17,690 - INFO - ============================================================
2025-11-12 18:20:17,690 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 18:20:17,690 - INFO - ============================================================
2025-11-12 18:20:17,690 - INFO - Processing 262 training samples to compute normalization stats...
2025-11-12 18:20:17,690 - INFO - Processing 262 sequences from 32 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/262 [00:00<?, ?it/s]Processing training data:   0%|8                                                                                                                                                                                                                  | 1/262 [00:00<01:55,  2.26it/s]Processing training data:   8%|#################6                                                                                                                                                                                                | 22/262 [00:01<00:16, 14.31it/s]Processing training data:  11%|######################4                                                                                                                                                                                           | 28/262 [00:03<00:27,  8.61it/s]Processing training data:  13%|##########################4                                                                                                                                                                                       | 33/262 [00:04<00:36,  6.27it/s]Processing training data:  15%|###############################2                                                                                                                                                                                  | 39/262 [00:04<00:28,  7.81it/s]Processing training data:  19%|########################################                                                                                                                                                                          | 50/262 [00:05<00:19, 10.77it/s]Processing training data:  28%|###########################################################3                                                                                                                                                      | 74/262 [00:05<00:09, 19.19it/s]Processing training data:  37%|#############################################################################7                                                                                                                                    | 97/262 [00:07<00:08, 18.58it/s]Processing training data:  39%|##################################################################################1                                                                                                                              | 103/262 [00:08<00:10, 14.71it/s]Processing training data:  40%|####################################################################################5                                                                                                                            | 106/262 [00:08<00:13, 11.73it/s]Processing training data:  42%|########################################################################################5                                                                                                                        | 111/262 [00:09<00:13, 11.18it/s]Processing training data:  50%|#########################################################################################################2                                                                                                       | 132/262 [00:10<00:09, 13.58it/s]Processing training data:  53%|##############################################################################################################                                                                                                   | 138/262 [00:12<00:13,  9.39it/s]Processing training data:  56%|####################################################################################################################4                                                                                            | 146/262 [00:13<00:13,  8.41it/s]Processing training data:  58%|##########################################################################################################################                                                                                       | 153/262 [00:14<00:12,  8.96it/s]Processing training data:  67%|############################################################################################################################################3                                                                    | 176/262 [00:14<00:05, 15.95it/s]Processing training data:  70%|##################################################################################################################################################7                                                              | 184/262 [00:16<00:06, 11.30it/s]Processing training data:  73%|#######################################################################################################################################################5                                                         | 190/262 [00:17<00:08,  8.23it/s]Processing training data:  75%|#############################################################################################################################################################1                                                   | 197/262 [00:18<00:08,  7.60it/s]Processing training data:  77%|################################################################################################################################################################3                                                | 201/262 [00:20<00:10,  5.60it/s]Processing training data:  79%|####################################################################################################################################################################3                                            | 206/262 [00:22<00:12,  4.53it/s]Processing training data:  81%|#########################################################################################################################################################################1                                       | 212/262 [00:22<00:09,  5.34it/s]Processing training data:  82%|###########################################################################################################################################################################5                                     | 215/262 [00:23<00:09,  5.19it/s]Processing training data:  84%|###############################################################################################################################################################################4                                 | 220/262 [00:25<00:09,  4.39it/s]Processing training data:  86%|###################################################################################################################################################################################4                             | 225/262 [00:26<00:09,  3.75it/s]Processing training data:  89%|#########################################################################################################################################################################################                        | 232/262 [00:28<00:07,  3.82it/s]Processing training data:  92%|###############################################################################################################################################################################################4                 | 240/262 [00:29<00:04,  4.57it/s]Processing training data:  93%|##################################################################################################################################################################################################6              | 244/262 [00:31<00:04,  3.90it/s]Processing training data:  95%|#######################################################################################################################################################################################################4         | 250/262 [00:33<00:03,  3.88it/s]Processing training data:  98%|#############################################################################################################################################################################################################    | 257/262 [00:34<00:01,  4.62it/s]Processing training data:  99%|###############################################################################################################################################################################################################4 | 260/262 [00:35<00:00,  4.26it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 262/262 [00:35<00:00,  4.42it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 262/262 [00:35<00:00,  7.41it/s]
2025-11-12 18:20:53,061 - INFO - Computing normalization statistics from training data...
2025-11-12 18:20:53,487 - INFO - Normalization stats computed:
2025-11-12 18:20:53,487 - INFO -   Mean: -0.217328
2025-11-12 18:20:53,487 - INFO -   Std: 2.315153
2025-11-12 18:20:53,487 - INFO -   Saved to: preprocessing\checkpoints\chb01_fold2\normalization_stats.json
2025-11-12 18:20:53,539 - INFO - Applying normalization and saving 262 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/262 [00:00<?, ?it/s]2025-11-12 18:20:53,548 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold2\train_dataset.h5
Normalizing and saving training data:   4%|#######5                                                                                                                                                                                              | 10/262 [00:00<00:16, 15.29it/s]Normalizing and saving training data:   8%|###############1                                                                                                                                                                                      | 20/262 [00:01<00:15, 15.23it/s]Normalizing and saving training data:  11%|######################6                                                                                                                                                                               | 30/262 [00:01<00:15, 15.33it/s]Normalizing and saving training data:  15%|##############################2                                                                                                                                                                       | 40/262 [00:02<00:14, 15.28it/s]Normalizing and saving training data:  19%|#####################################7                                                                                                                                                                | 50/262 [00:03<00:13, 15.35it/s]Normalizing and saving training data:  23%|#############################################3                                                                                                                                                        | 60/262 [00:03<00:13, 15.37it/s]Normalizing and saving training data:  27%|####################################################9                                                                                                                                                 | 70/262 [00:04<00:12, 15.30it/s]Normalizing and saving training data:  31%|############################################################4                                                                                                                                         | 80/262 [00:05<00:11, 15.18it/s]Normalizing and saving training data:  34%|####################################################################                                                                                                                                  | 90/262 [00:05<00:11, 15.20it/s]Normalizing and saving training data:  38%|###########################################################################1                                                                                                                         | 100/262 [00:06<00:10, 15.24it/s]Normalizing and saving training data:  42%|##################################################################################7                                                                                                                  | 110/262 [00:07<00:09, 15.31it/s]Normalizing and saving training data:  46%|##########################################################################################2                                                                                                          | 120/262 [00:07<00:09, 15.20it/s]Normalizing and saving training data:  50%|#################################################################################################7                                                                                                   | 130/262 [00:08<00:08, 15.00it/s]Normalizing and saving training data:  53%|#########################################################################################################2                                                                                           | 140/262 [00:09<00:08, 15.01it/s]Normalizing and saving training data:  57%|################################################################################################################7                                                                                    | 150/262 [00:09<00:07, 14.91it/s]Normalizing and saving training data:  61%|########################################################################################################################3                                                                            | 160/262 [00:10<00:06, 14.99it/s]Normalizing and saving training data:  65%|###############################################################################################################################8                                                                     | 170/262 [00:11<00:06, 14.97it/s]Normalizing and saving training data:  69%|#######################################################################################################################################3                                                             | 180/262 [00:11<00:05, 15.04it/s]Normalizing and saving training data:  73%|##############################################################################################################################################8                                                      | 190/262 [00:12<00:04, 15.08it/s]Normalizing and saving training data:  76%|######################################################################################################################################################3                                              | 200/262 [00:13<00:04, 15.00it/s]Normalizing and saving training data:  80%|#############################################################################################################################################################9                                       | 210/262 [00:13<00:03, 15.04it/s]Normalizing and saving training data:  84%|#####################################################################################################################################################################4                               | 220/262 [00:14<00:02, 15.06it/s]Normalizing and saving training data:  88%|############################################################################################################################################################################9                        | 230/262 [00:15<00:02, 15.06it/s]Normalizing and saving training data:  92%|####################################################################################################################################################################################4                | 240/262 [00:15<00:01, 15.12it/s]Normalizing and saving training data:  95%|###########################################################################################################################################################################################9         | 250/262 [00:16<00:00, 15.09it/s]Normalizing and saving training data:  99%|###################################################################################################################################################################################################4 | 260/262 [00:17<00:00, 15.11it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 262/262 [00:17<00:00, 15.24it/s]
2025-11-12 18:21:10,896 - INFO - Training data processing completed during stats computation phase
2025-11-12 18:21:10,897 - INFO - Loaded normalization statistics:
2025-11-12 18:21:10,897 - INFO -   Mean: -0.217328
2025-11-12 18:21:10,897 - INFO -   Std: 2.315153
2025-11-12 18:21:10,898 - INFO - Split train already completed, skipping
2025-11-12 18:21:10,898 - INFO - Processing test split...
2025-11-12 18:21:10,898 - INFO - Need to process 44/44 sequences for test
2025-11-12 18:21:10,898 - INFO - Processing 44 sequences from 17 unique files
2025-11-12 18:21:10,898 - INFO - Average 2.6 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/44 [00:00<?, ?it/s]Processing test:   2%|#####                                                                                                                                                                                                                        | 1/44 [00:00<00:13,  3.25it/s]Processing test:   5%|##########                                                                                                                                                                                                                   | 2/44 [00:00<00:12,  3.48it/s]Processing test:   7%|###############                                                                                                                                                                                                              | 3/44 [00:01<00:27,  1.48it/s]Processing test:  14%|##############################1                                                                                                                                                                                              | 6/44 [00:03<00:20,  1.84it/s]Processing test:  20%|#############################################2                                                                                                                                                                               | 9/44 [00:03<00:11,  3.10it/s]Processing test:  23%|##################################################                                                                                                                                                                          | 10/44 [00:03<00:12,  2.73it/s]2025-11-12 18:21:14,864 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold2\test_dataset.h5
2025-11-12 18:21:16,782 - INFO - Progress: 293/306 (95.8%) - ETA: 0.0 minutes
Processing test:  73%|################################################################################################################################################################                                                            | 32/44 [00:06<00:01,  7.23it/s]Processing test:  75%|#####################################################################################################################################################################                                                       | 33/44 [00:06<00:01,  6.90it/s]Processing test:  77%|##########################################################################################################################################################################                                                  | 34/44 [00:06<00:01,  5.84it/s]Processing test:  82%|####################################################################################################################################################################################                                        | 36/44 [00:07<00:01,  5.48it/s]Processing test:  86%|##############################################################################################################################################################################################                              | 38/44 [00:07<00:01,  5.75it/s]Processing test:  89%|###################################################################################################################################################################################################                         | 39/44 [00:07<00:00,  5.41it/s]Processing test:  91%|########################################################################################################################################################################################################                    | 40/44 [00:08<00:00,  5.09it/s]Processing test:  93%|#############################################################################################################################################################################################################               | 41/44 [00:08<00:00,  4.76it/s]2025-11-12 18:21:20,062 - INFO - Progress: 303/306 (99.0%) - ETA: 0.0 minutes
Processing test:  95%|##################################################################################################################################################################################################################          | 42/44 [00:09<00:00,  2.83it/s]Processing test:  98%|#######################################################################################################################################################################################################################     | 43/44 [00:09<00:00,  3.00it/s]Processing test: 100%|############################################################################################################################################################################################################################| 44/44 [00:09<00:00,  3.16it/s]Processing test: 100%|############################################################################################################################################################################################################################| 44/44 [00:09<00:00,  4.42it/s]
2025-11-12 18:21:21,086 - INFO - Validating final datasets...
2025-11-12 18:21:21,108 - INFO - train dataset validation:
2025-11-12 18:21:21,108 - INFO -   - Segments: 262
2025-11-12 18:21:21,108 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:21:21,108 - INFO -   - Classes: 131 preictal, 131 interictal
2025-11-12 18:21:21,108 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:21:21,113 - INFO - test dataset validation:
2025-11-12 18:21:21,113 - INFO -   - Segments: 44
2025-11-12 18:21:21,113 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:21:21,113 - INFO -   - Classes: 22 preictal, 22 interictal
2025-11-12 18:21:21,113 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:21:21,113 - INFO - ============================================================
2025-11-12 18:21:21,114 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 18:21:21,114 - INFO - Total time: 1.1 minutes
2025-11-12 18:21:21,114 - INFO - Processed segments: 306
2025-11-12 18:21:21,114 - INFO - Average rate: 4.8 segments/second
2025-11-12 18:21:21,114 - INFO - ============================================================
✅ Fold 2 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 3/6
============================================================
2025-11-12 18:21:21,187 - INFO - ============================================================
2025-11-12 18:21:21,187 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 18:21:21,187 - INFO - ============================================================
2025-11-12 18:21:21,187 - INFO - Output prefix: chb01_fold3
2025-11-12 18:21:21,187 - INFO - EEG Preprocessor initialized
2025-11-12 18:21:21,187 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 18:21:21,187 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 18:21:21,187 - INFO - Segment duration: 5 seconds
2025-11-12 18:21:21,187 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 18:21:21,187 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 18:21:21,187 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 18:21:21,187 - INFO - Loading segments from chb01_fold3_sequences_prediction.json
2025-11-12 18:21:21,199 - INFO - Loaded 306 total sequences
2025-11-12 18:21:21,199 - INFO - Channel validation (from segmentation): 42/42 files valid
2025-11-12 18:21:21,199 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 18:21:21,199 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 18:21:21,199 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 18:21:21,199 - INFO - train: 260 sequences (130 preictal, 130 interictal)
2025-11-12 18:21:21,199 - INFO - test: 46 sequences (23 preictal, 23 interictal)
2025-11-12 18:21:21,215 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 18:21:21,215 - INFO - train: kept 130 preictal and 130 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:21:21,215 - INFO - test: kept 23 preictal and 23 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:21:21,232 - INFO - ============================================================
2025-11-12 18:21:21,232 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 18:21:21,232 - INFO - ============================================================
2025-11-12 18:21:21,232 - INFO - Processing 260 training samples to compute normalization stats...
2025-11-12 18:21:21,232 - INFO - Processing 260 sequences from 32 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/260 [00:00<?, ?it/s]Processing training data:   0%|8                                                                                                                                                                                                                  | 1/260 [00:01<06:51,  1.59s/it]Processing training data:   4%|########                                                                                                                                                                                                          | 10/260 [00:02<00:41,  5.98it/s]Processing training data:  12%|#########################8                                                                                                                                                                                        | 32/260 [00:03<00:19, 11.83it/s]Processing training data:  14%|#############################8                                                                                                                                                                                    | 37/260 [00:03<00:19, 11.42it/s]Processing training data:  22%|##############################################8                                                                                                                                                                   | 58/260 [00:04<00:09, 20.47it/s]Processing training data:  25%|#####################################################3                                                                                                                                                            | 66/260 [00:04<00:10, 18.76it/s]Processing training data:  35%|########################################################################6                                                                                                                                         | 90/260 [00:06<00:09, 18.09it/s]Processing training data:  37%|############################################################################7                                                                                                                                     | 95/260 [00:07<00:14, 11.32it/s]Processing training data:  39%|#################################################################################1                                                                                                                               | 101/260 [00:09<00:18,  8.46it/s]Processing training data:  42%|########################################################################################4                                                                                                                        | 110/260 [00:10<00:20,  7.28it/s]Processing training data:  44%|###########################################################################################6                                                                                                                     | 114/260 [00:12<00:25,  5.72it/s]Processing training data:  48%|###################################################################################################6                                                                                                             | 124/260 [00:13<00:19,  7.08it/s]Processing training data:  48%|#####################################################################################################2                                                                                                           | 126/260 [00:14<00:23,  5.72it/s]Processing training data:  50%|#######################################################################################################6                                                                                                         | 129/260 [00:15<00:28,  4.57it/s]Processing training data:  51%|##########################################################################################################9                                                                                                      | 133/260 [00:17<00:33,  3.81it/s]Processing training data:  54%|################################################################################################################5                                                                                                | 140/260 [00:18<00:29,  4.10it/s]Processing training data:  56%|####################################################################################################################5                                                                                            | 145/260 [00:20<00:29,  3.91it/s]Processing training data:  57%|#######################################################################################################################7                                                                                         | 149/260 [00:21<00:32,  3.42it/s]Processing training data:  60%|##############################################################################################################################2                                                                                  | 157/260 [00:22<00:20,  4.98it/s]Processing training data:  68%|###############################################################################################################################################                                                                  | 178/260 [00:24<00:10,  7.83it/s]Processing training data:  71%|###################################################################################################################################################9                                                             | 184/260 [00:24<00:08,  8.66it/s]Processing training data:  75%|############################################################################################################################################################7                                                    | 195/260 [00:25<00:07,  8.28it/s]Processing training data:  78%|##################################################################################################################################################################3                                              | 202/260 [00:26<00:06,  8.91it/s]Processing training data:  87%|####################################################################################################################################################################################8                            | 225/260 [00:28<00:03, 10.99it/s]Processing training data:  89%|#########################################################################################################################################################################################6                       | 231/260 [00:28<00:02, 11.41it/s]Processing training data:  90%|###########################################################################################################################################################################################2                     | 233/260 [00:29<00:03,  8.05it/s]Processing training data:  91%|#############################################################################################################################################################################################7                   | 236/260 [00:31<00:04,  5.89it/s]Processing training data:  93%|#################################################################################################################################################################################################7               | 241/260 [00:32<00:03,  4.85it/s]Processing training data:  96%|########################################################################################################################################################################################################1        | 249/260 [00:33<00:01,  6.02it/s]Processing training data:  97%|#########################################################################################################################################################################################################7       | 251/260 [00:34<00:01,  4.65it/s]Processing training data:  98%|############################################################################################################################################################################################################9    | 255/260 [00:35<00:01,  4.37it/s]Processing training data:  99%|###############################################################################################################################################################################################################3 | 258/260 [00:36<00:00,  4.15it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 260/260 [00:36<00:00,  7.11it/s]
2025-11-12 18:21:57,814 - INFO - Computing normalization statistics from training data...
2025-11-12 18:21:58,272 - INFO - Normalization stats computed:
2025-11-12 18:21:58,272 - INFO -   Mean: -0.179104
2025-11-12 18:21:58,272 - INFO -   Std: 2.315825
2025-11-12 18:21:58,272 - INFO -   Saved to: preprocessing\checkpoints\chb01_fold3\normalization_stats.json
2025-11-12 18:21:58,324 - INFO - Applying normalization and saving 260 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/260 [00:00<?, ?it/s]2025-11-12 18:21:58,333 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold3\train_dataset.h5
Normalizing and saving training data:   4%|#######6                                                                                                                                                                                              | 10/260 [00:00<00:16, 14.86it/s]Normalizing and saving training data:   8%|###############2                                                                                                                                                                                      | 20/260 [00:01<00:16, 14.86it/s]Normalizing and saving training data:  12%|######################8                                                                                                                                                                               | 30/260 [00:02<00:15, 14.90it/s]Normalizing and saving training data:  15%|##############################4                                                                                                                                                                       | 40/260 [00:02<00:14, 14.99it/s]Normalizing and saving training data:  19%|######################################                                                                                                                                                                | 50/260 [00:03<00:14, 15.00it/s]Normalizing and saving training data:  23%|#############################################6                                                                                                                                                        | 60/260 [00:04<00:13, 15.03it/s]Normalizing and saving training data:  27%|#####################################################3                                                                                                                                                | 70/260 [00:04<00:12, 14.95it/s]Normalizing and saving training data:  31%|############################################################9                                                                                                                                         | 80/260 [00:05<00:11, 15.04it/s]Normalizing and saving training data:  35%|####################################################################5                                                                                                                                 | 90/260 [00:05<00:11, 15.06it/s]Normalizing and saving training data:  38%|###########################################################################7                                                                                                                         | 100/260 [00:06<00:10, 14.80it/s]Normalizing and saving training data:  42%|###################################################################################3                                                                                                                 | 110/260 [00:07<00:10, 14.87it/s]Normalizing and saving training data:  46%|##########################################################################################9                                                                                                          | 120/260 [00:08<00:09, 14.92it/s]Normalizing and saving training data:  50%|##################################################################################################5                                                                                                  | 130/260 [00:08<00:08, 14.93it/s]Normalizing and saving training data:  54%|##########################################################################################################                                                                                           | 140/260 [00:09<00:08, 14.88it/s]Normalizing and saving training data:  58%|#################################################################################################################6                                                                                   | 150/260 [00:10<00:07, 14.74it/s]Normalizing and saving training data:  62%|#########################################################################################################################2                                                                           | 160/260 [00:10<00:06, 14.74it/s]Normalizing and saving training data:  65%|################################################################################################################################8                                                                    | 170/260 [00:11<00:06, 14.68it/s]Normalizing and saving training data:  69%|########################################################################################################################################3                                                            | 180/260 [00:12<00:05, 14.71it/s]Normalizing and saving training data:  73%|###############################################################################################################################################9                                                     | 190/260 [00:12<00:04, 14.85it/s]Normalizing and saving training data:  77%|#######################################################################################################################################################5                                             | 200/260 [00:13<00:04, 15.00it/s]Normalizing and saving training data:  81%|###############################################################################################################################################################1                                     | 210/260 [00:14<00:03, 14.99it/s]Normalizing and saving training data:  85%|######################################################################################################################################################################6                              | 220/260 [00:14<00:02, 14.98it/s]Normalizing and saving training data:  88%|##############################################################################################################################################################################2                      | 230/260 [00:15<00:01, 15.01it/s]Normalizing and saving training data:  92%|#####################################################################################################################################################################################8               | 240/260 [00:16<00:01, 15.08it/s]Normalizing and saving training data:  96%|#############################################################################################################################################################################################4       | 250/260 [00:16<00:00, 15.13it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 260/260 [00:17<00:00, 15.19it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 260/260 [00:17<00:00, 14.95it/s]
2025-11-12 18:22:15,736 - INFO - Training data processing completed during stats computation phase
2025-11-12 18:22:15,737 - INFO - Loaded normalization statistics:
2025-11-12 18:22:15,737 - INFO -   Mean: -0.179104
2025-11-12 18:22:15,737 - INFO -   Std: 2.315825
2025-11-12 18:22:15,737 - INFO - Split train already completed, skipping
2025-11-12 18:22:15,737 - INFO - Processing test split...
2025-11-12 18:22:15,737 - INFO - Need to process 46/46 sequences for test
2025-11-12 18:22:15,737 - INFO - Processing 46 sequences from 15 unique files
2025-11-12 18:22:15,737 - INFO - Average 3.1 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/46 [00:00<?, ?it/s]Processing test:   2%|####8                                                                                                                                                                                                                        | 1/46 [00:00<00:24,  1.85it/s]Processing test:   7%|##############4                                                                                                                                                                                                              | 3/46 [00:00<00:11,  3.79it/s]Processing test:  11%|########################                                                                                                                                                                                                     | 5/46 [00:01<00:11,  3.64it/s]2025-11-12 18:22:17,184 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold3\test_dataset.h5
2025-11-12 18:22:18,902 - INFO - Progress: 287/306 (93.8%) - ETA: 0.1 minutes
Processing test:  61%|#####################################################################################################################################9                                                                                      | 28/46 [00:03<00:01,  9.30it/s]Processing test:  63%|##########################################################################################################################################6                                                                                 | 29/46 [00:04<00:02,  7.11it/s]Processing test:  67%|####################################################################################################################################################2                                                                       | 31/46 [00:05<00:03,  4.56it/s]Processing test:  76%|#######################################################################################################################################################################3                                                    | 35/46 [00:05<00:01,  5.60it/s]Processing test:  78%|############################################################################################################################################################################1                                               | 36/46 [00:07<00:02,  3.84it/s]2025-11-12 18:22:23,463 - INFO - Progress: 297/306 (97.1%) - ETA: 0.0 minutes
Processing test:  83%|#####################################################################################################################################################################################7                                      | 38/46 [00:07<00:02,  3.31it/s]Processing test:  85%|##########################################################################################################################################################################################5                                 | 39/46 [00:08<00:02,  3.37it/s]Processing test:  87%|###############################################################################################################################################################################################3                            | 40/46 [00:08<00:01,  3.43it/s]Processing test:  89%|####################################################################################################################################################################################################                        | 41/46 [00:10<00:02,  1.97it/s]Processing test:  93%|#############################################################################################################################################################################################################6              | 43/46 [00:10<00:01,  2.62it/s]Processing test:  96%|##################################################################################################################################################################################################################4         | 44/46 [00:10<00:00,  2.67it/s]Processing test: 100%|############################################################################################################################################################################################################################| 46/46 [00:10<00:00,  3.48it/s]Processing test: 100%|############################################################################################################################################################################################################################| 46/46 [00:10<00:00,  4.22it/s]
2025-11-12 18:22:27,226 - INFO - Validating final datasets...
2025-11-12 18:22:27,234 - INFO - train dataset validation:
2025-11-12 18:22:27,234 - INFO -   - Segments: 260
2025-11-12 18:22:27,234 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:22:27,234 - INFO -   - Classes: 130 preictal, 130 interictal
2025-11-12 18:22:27,234 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:22:27,239 - INFO - test dataset validation:
2025-11-12 18:22:27,239 - INFO -   - Segments: 46
2025-11-12 18:22:27,239 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:22:27,239 - INFO -   - Classes: 23 preictal, 23 interictal
2025-11-12 18:22:27,239 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:22:27,239 - INFO - ============================================================
2025-11-12 18:22:27,239 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 18:22:27,239 - INFO - Total time: 1.1 minutes
2025-11-12 18:22:27,239 - INFO - Processed segments: 306
2025-11-12 18:22:27,239 - INFO - Average rate: 4.6 segments/second
2025-11-12 18:22:27,239 - INFO - ============================================================
✅ Fold 3 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 4/6
============================================================
2025-11-12 18:22:27,312 - INFO - ============================================================
2025-11-12 18:22:27,312 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 18:22:27,312 - INFO - ============================================================
2025-11-12 18:22:27,312 - INFO - Output prefix: chb01_fold4
2025-11-12 18:22:27,312 - INFO - EEG Preprocessor initialized
2025-11-12 18:22:27,312 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 18:22:27,312 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 18:22:27,312 - INFO - Segment duration: 5 seconds
2025-11-12 18:22:27,312 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 18:22:27,312 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 18:22:27,313 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 18:22:27,313 - INFO - Loading segments from chb01_fold4_sequences_prediction.json
2025-11-12 18:22:27,323 - INFO - Loaded 306 total sequences
2025-11-12 18:22:27,324 - INFO - Channel validation (from segmentation): 42/42 files valid
2025-11-12 18:22:27,324 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 18:22:27,324 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 18:22:27,324 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 18:22:27,324 - INFO - train: 264 sequences (132 preictal, 132 interictal)
2025-11-12 18:22:27,324 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-12 18:22:27,340 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 18:22:27,341 - INFO - train: kept 132 preictal and 132 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:22:27,341 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:22:27,357 - INFO - ============================================================
2025-11-12 18:22:27,357 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 18:22:27,357 - INFO - ============================================================
2025-11-12 18:22:27,357 - INFO - Processing 264 training samples to compute normalization stats...
2025-11-12 18:22:27,357 - INFO - Processing 264 sequences from 32 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/264 [00:00<?, ?it/s]Processing training data:   0%|7                                                                                                                                                                                                                  | 1/264 [00:00<01:59,  2.21it/s]Processing training data:   8%|#################5                                                                                                                                                                                                | 22/264 [00:00<00:09, 25.69it/s]Processing training data:  17%|####################################5                                                                                                                                                                             | 46/264 [00:02<00:12, 17.69it/s]Processing training data:  20%|#########################################3                                                                                                                                                                        | 52/264 [00:03<00:18, 11.69it/s]Processing training data:  23%|###############################################7                                                                                                                                                                  | 60/264 [00:04<00:16, 12.32it/s]Processing training data:  31%|##################################################################                                                                                                                                                | 83/264 [00:05<00:09, 19.32it/s]Processing training data:  40%|###################################################################################9                                                                                                                             | 106/264 [00:05<00:06, 25.37it/s]Processing training data:  48%|#####################################################################################################3                                                                                                           | 128/264 [00:06<00:06, 20.60it/s]Processing training data:  52%|###########################################################################################################6                                                                                                     | 136/264 [00:08<00:08, 15.43it/s]Processing training data:  54%|################################################################################################################4                                                                                                | 142/264 [00:08<00:08, 14.50it/s]Processing training data:  55%|##################################################################################################################7                                                                                              | 145/264 [00:10<00:13,  9.11it/s]Processing training data:  57%|#######################################################################################################################5                                                                                         | 151/264 [00:11<00:13,  8.09it/s]Processing training data:  59%|###########################################################################################################################5                                                                                     | 156/264 [00:12<00:16,  6.70it/s]Processing training data:  61%|###############################################################################################################################4                                                                                 | 161/264 [00:13<00:15,  6.49it/s]Processing training data:  62%|#################################################################################################################################8                                                                               | 164/264 [00:14<00:18,  5.35it/s]Processing training data:  64%|#####################################################################################################################################7                                                                           | 169/264 [00:16<00:22,  4.32it/s]Processing training data:  66%|#########################################################################################################################################7                                                                       | 174/264 [00:17<00:21,  4.21it/s]Processing training data:  67%|############################################################################################################################################9                                                                    | 178/264 [00:19<00:24,  3.45it/s]Processing training data:  71%|####################################################################################################################################################8                                                            | 188/264 [00:20<00:17,  4.31it/s]Processing training data:  72%|#######################################################################################################################################################2                                                         | 191/264 [00:22<00:20,  3.53it/s]Processing training data:  75%|############################################################################################################################################################7                                                    | 198/264 [00:23<00:14,  4.41it/s]Processing training data:  77%|###############################################################################################################################################################9                                                 | 202/264 [00:23<00:12,  5.02it/s]Processing training data:  81%|########################################################################################################################################################################6                                        | 213/264 [00:24<00:07,  6.49it/s]Processing training data:  82%|###########################################################################################################################################################################                                      | 216/264 [00:26<00:10,  4.55it/s]Processing training data:  84%|################################################################################################################################################################################5                                | 223/264 [00:27<00:06,  6.10it/s]Processing training data:  88%|######################################################################################################################################################################################8                          | 231/264 [00:28<00:04,  6.79it/s]Processing training data:  89%|##########################################################################################################################################################################################8                      | 236/264 [00:29<00:05,  5.33it/s]Processing training data:  91%|##############################################################################################################################################################################################7                  | 241/264 [00:31<00:05,  4.53it/s]Processing training data:  94%|###################################################################################################################################################################################################5             | 247/264 [00:32<00:03,  4.39it/s]Processing training data:  96%|########################################################################################################################################################################################################2        | 253/264 [00:34<00:02,  4.38it/s]Processing training data:  98%|############################################################################################################################################################################################################2    | 258/264 [00:35<00:01,  4.49it/s]Processing training data: 100%|################################################################################################################################################################################################################2| 263/264 [00:35<00:00,  5.43it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 264/264 [00:35<00:00,  7.45it/s]
2025-11-12 18:23:02,815 - INFO - Computing normalization statistics from training data...
2025-11-12 18:23:03,282 - INFO - Normalization stats computed:
2025-11-12 18:23:03,282 - INFO -   Mean: -0.187900
2025-11-12 18:23:03,282 - INFO -   Std: 2.351871
2025-11-12 18:23:03,282 - INFO -   Saved to: preprocessing\checkpoints\chb01_fold4\normalization_stats.json
2025-11-12 18:23:03,334 - INFO - Applying normalization and saving 264 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/264 [00:00<?, ?it/s]2025-11-12 18:23:03,342 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold4\train_dataset.h5
Normalizing and saving training data:   4%|#######5                                                                                                                                                                                              | 10/264 [00:00<00:16, 15.84it/s]Normalizing and saving training data:   8%|###############                                                                                                                                                                                       | 20/264 [00:01<00:15, 15.36it/s]Normalizing and saving training data:  11%|######################5                                                                                                                                                                               | 30/264 [00:01<00:15, 15.33it/s]Normalizing and saving training data:  15%|##############################                                                                                                                                                                        | 40/264 [00:02<00:14, 14.95it/s]Normalizing and saving training data:  19%|#####################################5                                                                                                                                                                | 50/264 [00:03<00:14, 15.07it/s]Normalizing and saving training data:  23%|#############################################                                                                                                                                                         | 60/264 [00:03<00:13, 15.18it/s]Normalizing and saving training data:  27%|####################################################5                                                                                                                                                 | 70/264 [00:04<00:12, 15.27it/s]Normalizing and saving training data:  30%|############################################################                                                                                                                                          | 80/264 [00:05<00:11, 15.34it/s]Normalizing and saving training data:  34%|###################################################################5                                                                                                                                  | 90/264 [00:05<00:11, 15.33it/s]Normalizing and saving training data:  38%|##########################################################################6                                                                                                                          | 100/264 [00:06<00:10, 15.29it/s]Normalizing and saving training data:  42%|##################################################################################                                                                                                                   | 110/264 [00:07<00:10, 15.34it/s]Normalizing and saving training data:  45%|#########################################################################################5                                                                                                           | 120/264 [00:07<00:09, 15.36it/s]Normalizing and saving training data:  49%|#################################################################################################                                                                                                    | 130/264 [00:08<00:08, 15.33it/s]Normalizing and saving training data:  53%|########################################################################################################4                                                                                            | 140/264 [00:09<00:08, 15.32it/s]Normalizing and saving training data:  57%|###############################################################################################################9                                                                                     | 150/264 [00:09<00:07, 15.28it/s]Normalizing and saving training data:  61%|#######################################################################################################################3                                                                             | 160/264 [00:10<00:06, 15.27it/s]Normalizing and saving training data:  64%|##############################################################################################################################8                                                                      | 170/264 [00:11<00:06, 15.25it/s]Normalizing and saving training data:  68%|######################################################################################################################################3                                                              | 180/264 [00:11<00:05, 15.29it/s]Normalizing and saving training data:  72%|#############################################################################################################################################7                                                       | 190/264 [00:12<00:04, 15.31it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################2                                               | 200/264 [00:13<00:04, 15.31it/s]Normalizing and saving training data:  80%|############################################################################################################################################################7                                        | 210/264 [00:13<00:03, 15.29it/s]Normalizing and saving training data:  83%|####################################################################################################################################################################1                                | 220/264 [00:14<00:02, 15.33it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################6                         | 230/264 [00:15<00:02, 15.30it/s]Normalizing and saving training data:  91%|###################################################################################################################################################################################                  | 240/264 [00:15<00:01, 15.29it/s]Normalizing and saving training data:  95%|##########################################################################################################################################################################################5          | 250/264 [00:16<00:00, 15.29it/s]Normalizing and saving training data:  98%|##################################################################################################################################################################################################   | 260/264 [00:17<00:00, 15.24it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 264/264 [00:17<00:00, 15.51it/s]
2025-11-12 18:23:20,642 - INFO - Training data processing completed during stats computation phase
2025-11-12 18:23:20,643 - INFO - Loaded normalization statistics:
2025-11-12 18:23:20,644 - INFO -   Mean: -0.187900
2025-11-12 18:23:20,644 - INFO -   Std: 2.351871
2025-11-12 18:23:20,644 - INFO - Split train already completed, skipping
2025-11-12 18:23:20,644 - INFO - Processing test split...
2025-11-12 18:23:20,644 - INFO - Need to process 42/42 sequences for test
2025-11-12 18:23:20,644 - INFO - Processing 42 sequences from 16 unique files
2025-11-12 18:23:20,644 - INFO - Average 2.6 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/42 [00:00<?, ?it/s]Processing test:   2%|#####2                                                                                                                                                                                                                       | 1/42 [00:00<00:26,  1.52it/s]Processing test:   7%|###############7                                                                                                                                                                                                             | 3/42 [00:02<00:29,  1.34it/s]Processing test:  12%|##########################3                                                                                                                                                                                                  | 5/42 [00:02<00:18,  1.96it/s]2025-11-12 18:23:23,437 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold4\test_dataset.h5
2025-11-12 18:23:24,991 - INFO - Progress: 289/306 (94.4%) - ETA: 0.1 minutes
Processing test:  62%|########################################################################################################################################1                                                                                   | 26/42 [00:04<00:02,  6.65it/s]Processing test:  67%|##################################################################################################################################################6                                                                         | 28/42 [00:05<00:02,  5.64it/s]Processing test:  71%|#############################################################################################################################################################1                                                              | 30/42 [00:06<00:02,  4.69it/s]Processing test:  76%|#######################################################################################################################################################################6                                                    | 32/42 [00:06<00:02,  4.90it/s]Processing test:  79%|############################################################################################################################################################################8                                               | 33/42 [00:07<00:02,  4.28it/s]Processing test:  83%|#######################################################################################################################################################################################3                                    | 35/42 [00:07<00:01,  4.57it/s]2025-11-12 18:23:29,090 - INFO - Progress: 299/306 (97.7%) - ETA: 0.0 minutes
Processing test:  86%|############################################################################################################################################################################################5                               | 36/42 [00:08<00:01,  3.17it/s]Processing test:  88%|#################################################################################################################################################################################################8                          | 37/42 [00:08<00:01,  3.24it/s]Processing test:  90%|#######################################################################################################################################################################################################                     | 38/42 [00:09<00:01,  3.32it/s]Processing test:  93%|############################################################################################################################################################################################################2               | 39/42 [00:09<00:00,  3.43it/s]Processing test:  95%|#################################################################################################################################################################################################################5          | 40/42 [00:09<00:00,  3.44it/s]Processing test:  98%|######################################################################################################################################################################################################################7     | 41/42 [00:10<00:00,  3.52it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:10<00:00,  3.56it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:10<00:00,  4.06it/s]
2025-11-12 18:23:31,460 - INFO - Validating final datasets...
2025-11-12 18:23:31,468 - INFO - train dataset validation:
2025-11-12 18:23:31,468 - INFO -   - Segments: 264
2025-11-12 18:23:31,468 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:23:31,468 - INFO -   - Classes: 132 preictal, 132 interictal
2025-11-12 18:23:31,468 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:23:31,474 - INFO - test dataset validation:
2025-11-12 18:23:31,474 - INFO -   - Segments: 42
2025-11-12 18:23:31,474 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:23:31,474 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-12 18:23:31,474 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:23:31,474 - INFO - ============================================================
2025-11-12 18:23:31,474 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 18:23:31,474 - INFO - Total time: 1.1 minutes
2025-11-12 18:23:31,474 - INFO - Processed segments: 306
2025-11-12 18:23:31,474 - INFO - Average rate: 4.8 segments/second
2025-11-12 18:23:31,474 - INFO - ============================================================
✅ Fold 4 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 5/6
============================================================
2025-11-12 18:23:31,541 - INFO - ============================================================
2025-11-12 18:23:31,542 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 18:23:31,542 - INFO - ============================================================
2025-11-12 18:23:31,542 - INFO - Output prefix: chb01_fold5
2025-11-12 18:23:31,542 - INFO - EEG Preprocessor initialized
2025-11-12 18:23:31,542 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 18:23:31,542 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 18:23:31,542 - INFO - Segment duration: 5 seconds
2025-11-12 18:23:31,542 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 18:23:31,542 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 18:23:31,542 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 18:23:31,542 - INFO - Loading segments from chb01_fold5_sequences_prediction.json
2025-11-12 18:23:31,553 - INFO - Loaded 306 total sequences
2025-11-12 18:23:31,553 - INFO - Channel validation (from segmentation): 42/42 files valid
2025-11-12 18:23:31,553 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 18:23:31,553 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 18:23:31,553 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 18:23:31,553 - INFO - train: 268 sequences (134 preictal, 134 interictal)
2025-11-12 18:23:31,553 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-12 18:23:31,570 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 18:23:31,570 - INFO - train: kept 134 preictal and 134 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:23:31,570 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:23:31,586 - INFO - ============================================================
2025-11-12 18:23:31,586 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 18:23:31,586 - INFO - ============================================================
2025-11-12 18:23:31,586 - INFO - Processing 268 training samples to compute normalization stats...
2025-11-12 18:23:31,586 - INFO - Processing 268 sequences from 31 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/268 [00:00<?, ?it/s]Processing training data:   0%|7                                                                                                                                                                                                                  | 1/268 [00:01<05:57,  1.34s/it]Processing training data:   2%|####7                                                                                                                                                                                                              | 6/268 [00:01<01:08,  3.84it/s]Processing training data:  11%|#######################5                                                                                                                                                                                          | 30/268 [00:03<00:20, 11.75it/s]Processing training data:  14%|############################9                                                                                                                                                                                     | 37/268 [00:03<00:18, 12.23it/s]Processing training data:  22%|##############################################2                                                                                                                                                                   | 59/268 [00:04<00:09, 21.40it/s]Processing training data:  23%|################################################5                                                                                                                                                                 | 62/268 [00:04<00:12, 16.72it/s]Processing training data:  32%|##################################################################6                                                                                                                                               | 85/268 [00:06<00:10, 16.84it/s]Processing training data:  35%|########################################################################8                                                                                                                                         | 93/268 [00:07<00:13, 13.30it/s]Processing training data:  35%|##########################################################################4                                                                                                                                       | 95/268 [00:08<00:19,  8.67it/s]Processing training data:  38%|################################################################################3                                                                                                                                | 103/268 [00:09<00:17,  9.43it/s]Processing training data:  40%|##################################################################################6                                                                                                                              | 106/268 [00:09<00:18,  8.61it/s]Processing training data:  48%|####################################################################################################6                                                                                                            | 129/268 [00:11<00:11, 11.75it/s]Processing training data:  51%|##########################################################################################################8                                                                                                      | 137/268 [00:12<00:12, 10.23it/s]Processing training data:  53%|##############################################################################################################7                                                                                                  | 142/268 [00:12<00:12, 10.06it/s]Processing training data:  61%|###############################################################################################################################1                                                                                 | 163/268 [00:14<00:08, 12.20it/s]Processing training data:  62%|#################################################################################################################################4                                                                               | 166/268 [00:15<00:11,  8.75it/s]Processing training data:  64%|#####################################################################################################################################3                                                                           | 171/268 [00:16<00:14,  6.77it/s]Processing training data:  66%|##########################################################################################################################################8                                                                      | 178/268 [00:18<00:13,  6.70it/s]Processing training data:  68%|##############################################################################################################################################7                                                                  | 183/268 [00:19<00:15,  5.48it/s]Processing training data:  71%|###################################################################################################################################################3                                                             | 189/268 [00:20<00:14,  5.29it/s]Processing training data:  73%|########################################################################################################################################################8                                                        | 196/268 [00:21<00:11,  6.45it/s]Processing training data:  81%|#########################################################################################################################################################################2                                       | 217/268 [00:22<00:04, 11.48it/s]Processing training data:  82%|############################################################################################################################################################################3                                    | 221/268 [00:23<00:05,  8.33it/s]Processing training data:  85%|#################################################################################################################################################################################                                | 227/268 [00:25<00:06,  6.40it/s]Processing training data:  88%|########################################################################################################################################################################################                         | 236/268 [00:26<00:05,  6.12it/s]Processing training data:  91%|#############################################################################################################################################################################################5                   | 243/268 [00:27<00:03,  6.83it/s]Processing training data:  92%|###############################################################################################################################################################################################8                 | 246/268 [00:28<00:03,  6.36it/s]Processing training data:  93%|#################################################################################################################################################################################################4               | 248/268 [00:29<00:04,  4.82it/s]Processing training data:  95%|######################################################################################################################################################################################################           | 254/268 [00:30<00:03,  4.47it/s]Processing training data:  97%|##########################################################################################################################################################################################################7      | 260/268 [00:32<00:01,  4.16it/s]Processing training data:  99%|##############################################################################################################################################################################################################6  | 265/268 [00:33<00:00,  3.91it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 268/268 [00:33<00:00,  7.90it/s]
2025-11-12 18:24:05,495 - INFO - Computing normalization statistics from training data...
2025-11-12 18:24:05,996 - INFO - Normalization stats computed:
2025-11-12 18:24:05,997 - INFO -   Mean: -0.194375
2025-11-12 18:24:05,997 - INFO -   Std: 2.349601
2025-11-12 18:24:05,997 - INFO -   Saved to: preprocessing\checkpoints\chb01_fold5\normalization_stats.json
2025-11-12 18:24:06,051 - INFO - Applying normalization and saving 268 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/268 [00:00<?, ?it/s]2025-11-12 18:24:06,062 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold5\train_dataset.h5
Normalizing and saving training data:   4%|#######3                                                                                                                                                                                              | 10/268 [00:00<00:16, 15.41it/s]Normalizing and saving training data:   7%|##############7                                                                                                                                                                                       | 20/268 [00:01<00:16, 15.29it/s]Normalizing and saving training data:  11%|######################1                                                                                                                                                                               | 30/268 [00:01<00:15, 15.36it/s]Normalizing and saving training data:  15%|#############################5                                                                                                                                                                        | 40/268 [00:02<00:14, 15.34it/s]Normalizing and saving training data:  19%|####################################9                                                                                                                                                                 | 50/268 [00:03<00:14, 15.32it/s]Normalizing and saving training data:  22%|############################################3                                                                                                                                                         | 60/268 [00:03<00:13, 15.23it/s]Normalizing and saving training data:  26%|###################################################7                                                                                                                                                  | 70/268 [00:04<00:13, 15.16it/s]Normalizing and saving training data:  30%|###########################################################1                                                                                                                                          | 80/268 [00:05<00:12, 15.26it/s]Normalizing and saving training data:  34%|##################################################################4                                                                                                                                   | 90/268 [00:05<00:11, 15.32it/s]Normalizing and saving training data:  37%|#########################################################################5                                                                                                                           | 100/268 [00:06<00:10, 15.35it/s]Normalizing and saving training data:  41%|################################################################################8                                                                                                                    | 110/268 [00:07<00:10, 15.37it/s]Normalizing and saving training data:  45%|########################################################################################2                                                                                                            | 120/268 [00:07<00:09, 15.29it/s]Normalizing and saving training data:  49%|###############################################################################################5                                                                                                     | 130/268 [00:08<00:09, 15.26it/s]Normalizing and saving training data:  52%|######################################################################################################9                                                                                              | 140/268 [00:09<00:08, 15.12it/s]Normalizing and saving training data:  56%|##############################################################################################################2                                                                                      | 150/268 [00:09<00:07, 14.91it/s]Normalizing and saving training data:  60%|#####################################################################################################################6                                                                               | 160/268 [00:10<00:07, 14.91it/s]Normalizing and saving training data:  63%|############################################################################################################################9                                                                        | 170/268 [00:11<00:06, 14.97it/s]Normalizing and saving training data:  67%|####################################################################################################################################3                                                                | 180/268 [00:11<00:05, 15.06it/s]Normalizing and saving training data:  71%|###########################################################################################################################################6                                                         | 190/268 [00:12<00:05, 15.12it/s]Normalizing and saving training data:  75%|###################################################################################################################################################                                                  | 200/268 [00:13<00:04, 15.04it/s]Normalizing and saving training data:  78%|##########################################################################################################################################################3                                          | 210/268 [00:13<00:03, 14.99it/s]Normalizing and saving training data:  82%|#################################################################################################################################################################7                                   | 220/268 [00:14<00:03, 15.00it/s]Normalizing and saving training data:  86%|#########################################################################################################################################################################                            | 230/268 [00:15<00:02, 14.94it/s]Normalizing and saving training data:  90%|################################################################################################################################################################################4                    | 240/268 [00:15<00:01, 14.81it/s]Normalizing and saving training data:  93%|#######################################################################################################################################################################################7             | 250/268 [00:16<00:01, 14.70it/s]Normalizing and saving training data:  97%|###############################################################################################################################################################################################1     | 260/268 [00:17<00:00, 14.50it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 268/268 [00:17<00:00, 15.49it/s]
2025-11-12 18:24:23,917 - INFO - Training data processing completed during stats computation phase
2025-11-12 18:24:23,918 - INFO - Loaded normalization statistics:
2025-11-12 18:24:23,918 - INFO -   Mean: -0.194375
2025-11-12 18:24:23,918 - INFO -   Std: 2.349601
2025-11-12 18:24:23,918 - INFO - Split train already completed, skipping
2025-11-12 18:24:23,918 - INFO - Processing test split...
2025-11-12 18:24:23,918 - INFO - Need to process 38/38 sequences for test
2025-11-12 18:24:23,918 - INFO - Processing 38 sequences from 15 unique files
2025-11-12 18:24:23,918 - INFO - Average 2.5 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/38 [00:00<?, ?it/s]Processing test:   3%|#####8                                                                                                                                                                                                                       | 1/38 [00:02<01:16,  2.07s/it]Processing test:  13%|#############################                                                                                                                                                                                                | 5/38 [00:02<00:13,  2.51it/s]2025-11-12 18:24:26,411 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold5\test_dataset.h5
2025-11-12 18:24:27,409 - INFO - Progress: 283/306 (92.5%) - ETA: 0.1 minutes
Processing test:  42%|############################################################################################6                                                                                                                               | 16/38 [00:04<00:04,  4.55it/s]Processing test:  47%|########################################################################################################2                                                                                                                   | 18/38 [00:04<00:04,  4.73it/s]Processing test:  50%|##############################################################################################################                                                                                                              | 19/38 [00:05<00:04,  4.22it/s]2025-11-12 18:24:29,809 - INFO - Progress: 294/306 (96.1%) - ETA: 0.0 minutes
Processing test:  71%|############################################################################################################################################################3                                                               | 27/38 [00:06<00:02,  5.48it/s]Processing test:  74%|##################################################################################################################################################################1                                                         | 28/38 [00:06<00:01,  5.07it/s]Processing test:  76%|#######################################################################################################################################################################8                                                    | 29/38 [00:07<00:02,  4.00it/s]Processing test:  82%|###################################################################################################################################################################################4                                        | 31/38 [00:07<00:01,  4.30it/s]Processing test:  84%|#########################################################################################################################################################################################2                                  | 32/38 [00:07<00:01,  3.99it/s]Processing test:  87%|###############################################################################################################################################################################################                             | 33/38 [00:08<00:01,  3.71it/s]Processing test:  89%|####################################################################################################################################################################################################8                       | 34/38 [00:09<00:01,  2.38it/s]Processing test:  95%|################################################################################################################################################################################################################4           | 36/38 [00:09<00:00,  3.04it/s]2025-11-12 18:24:34,240 - INFO - Progress: 304/306 (99.3%) - ETA: 0.0 minutes
Processing test:  97%|######################################################################################################################################################################################################################2     | 37/38 [00:10<00:00,  2.16it/s]Processing test: 100%|############################################################################################################################################################################################################################| 38/38 [00:10<00:00,  2.27it/s]Processing test: 100%|############################################################################################################################################################################################################################| 38/38 [00:10<00:00,  3.46it/s]
2025-11-12 18:24:35,100 - INFO - Validating final datasets...
2025-11-12 18:24:35,108 - INFO - train dataset validation:
2025-11-12 18:24:35,108 - INFO -   - Segments: 268
2025-11-12 18:24:35,108 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:24:35,108 - INFO -   - Classes: 134 preictal, 134 interictal
2025-11-12 18:24:35,108 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:24:35,113 - INFO - test dataset validation:
2025-11-12 18:24:35,113 - INFO -   - Segments: 38
2025-11-12 18:24:35,113 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:24:35,113 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-12 18:24:35,113 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:24:35,113 - INFO - ============================================================
2025-11-12 18:24:35,114 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 18:24:35,114 - INFO - Total time: 1.1 minutes
2025-11-12 18:24:35,114 - INFO - Processed segments: 306
2025-11-12 18:24:35,114 - INFO - Average rate: 4.8 segments/second
2025-11-12 18:24:35,114 - INFO - ============================================================
✅ Fold 5 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 6/6
============================================================
2025-11-12 18:24:35,186 - INFO - ============================================================
2025-11-12 18:24:35,186 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 18:24:35,186 - INFO - ============================================================
2025-11-12 18:24:35,186 - INFO - Output prefix: chb01_fold6
2025-11-12 18:24:35,187 - INFO - EEG Preprocessor initialized
2025-11-12 18:24:35,187 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 18:24:35,187 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 18:24:35,187 - INFO - Segment duration: 5 seconds
2025-11-12 18:24:35,187 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 18:24:35,187 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 18:24:35,187 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 18:24:35,187 - INFO - Loading segments from chb01_fold6_sequences_prediction.json
2025-11-12 18:24:35,199 - INFO - Loaded 306 total sequences
2025-11-12 18:24:35,199 - INFO - Channel validation (from segmentation): 42/42 files valid
2025-11-12 18:24:35,199 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 18:24:35,200 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 18:24:35,200 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 18:24:35,200 - INFO - train: 264 sequences (132 preictal, 132 interictal)
2025-11-12 18:24:35,200 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-12 18:24:35,217 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 18:24:35,217 - INFO - train: kept 132 preictal and 132 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:24:35,217 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 18:24:35,236 - INFO - ============================================================
2025-11-12 18:24:35,236 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 18:24:35,236 - INFO - ============================================================
2025-11-12 18:24:35,236 - INFO - Processing 264 training samples to compute normalization stats...
2025-11-12 18:24:35,236 - INFO - Processing 264 sequences from 32 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/264 [00:00<?, ?it/s]Processing training data:   0%|7                                                                                                                                                                                                                  | 1/264 [00:01<05:20,  1.22s/it]Processing training data:   2%|###9                                                                                                                                                                                                               | 5/264 [00:01<01:04,  4.04it/s]Processing training data:   6%|############7                                                                                                                                                                                                     | 16/264 [00:02<00:36,  6.79it/s]Processing training data:   8%|#################5                                                                                                                                                                                                | 22/264 [00:04<00:40,  5.93it/s]Processing training data:  11%|#######################                                                                                                                                                                                           | 29/264 [00:04<00:33,  7.09it/s]Processing training data:  12%|##########################2                                                                                                                                                                                       | 33/264 [00:05<00:32,  7.20it/s]Processing training data:  21%|############################################5                                                                                                                                                                     | 56/264 [00:06<00:19, 10.51it/s]Processing training data:  24%|##################################################1                                                                                                                                                               | 63/264 [00:07<00:18, 10.76it/s]Processing training data:  25%|####################################################5                                                                                                                                                             | 66/264 [00:08<00:20,  9.66it/s]Processing training data:  34%|######################################################################7                                                                                                                                           | 89/264 [00:09<00:13, 13.10it/s]Processing training data:  36%|###########################################################################5                                                                                                                                      | 95/264 [00:09<00:13, 12.63it/s]Processing training data:  45%|##############################################################################################2                                                                                                                  | 119/264 [00:11<00:10, 13.71it/s]Processing training data:  49%|######################################################################################################9                                                                                                          | 130/264 [00:12<00:11, 11.63it/s]Processing training data:  51%|##########################################################################################################                                                                                                       | 134/264 [00:13<00:12, 10.15it/s]Processing training data:  52%|###########################################################################################################6                                                                                                     | 136/264 [00:14<00:14,  8.95it/s]Processing training data:  60%|#############################################################################################################################                                                                                    | 158/264 [00:14<00:06, 15.53it/s]Processing training data:  68%|#############################################################################################################################################7                                                                   | 179/264 [00:15<00:05, 16.26it/s]Processing training data:  70%|###################################################################################################################################################2                                                             | 186/264 [00:17<00:06, 11.98it/s]Processing training data:  73%|########################################################################################################################################################7                                                        | 193/264 [00:18<00:06, 11.53it/s]Processing training data:  74%|##########################################################################################################################################################3                                                      | 195/264 [00:19<00:09,  7.08it/s]Processing training data:  77%|################################################################################################################################################################7                                                | 203/264 [00:20<00:07,  8.70it/s]Processing training data:  80%|#######################################################################################################################################################################                                          | 211/264 [00:21<00:06,  7.59it/s]Processing training data:  82%|###########################################################################################################################################################################                                      | 216/264 [00:22<00:07,  6.04it/s]Processing training data:  83%|#############################################################################################################################################################################3                                   | 219/264 [00:24<00:10,  4.44it/s]Processing training data:  86%|###################################################################################################################################################################################7                             | 227/264 [00:26<00:08,  4.38it/s]Processing training data:  89%|##########################################################################################################################################################################################                       | 235/264 [00:27<00:05,  5.52it/s]Processing training data:  91%|#############################################################################################################################################################################################2                   | 239/264 [00:28<00:05,  4.43it/s]Processing training data:  92%|#################################################################################################################################################################################################1               | 244/264 [00:30<00:04,  4.12it/s]Processing training data:  95%|#####################################################################################################################################################################################################9           | 250/264 [00:30<00:02,  5.38it/s]Processing training data:  95%|######################################################################################################################################################################################################7          | 251/264 [00:31<00:03,  4.21it/s]Processing training data:  97%|##########################################################################################################################################################################################################6      | 256/264 [00:32<00:01,  4.05it/s]Processing training data:  99%|##############################################################################################################################################################################################################6  | 261/264 [00:33<00:00,  4.66it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 264/264 [00:33<00:00,  7.85it/s]
2025-11-12 18:25:08,869 - INFO - Computing normalization statistics from training data...
2025-11-12 18:25:09,331 - INFO - Normalization stats computed:
2025-11-12 18:25:09,331 - INFO -   Mean: -0.213143
2025-11-12 18:25:09,331 - INFO -   Std: 2.347302
2025-11-12 18:25:09,331 - INFO -   Saved to: preprocessing\checkpoints\chb01_fold6\normalization_stats.json
2025-11-12 18:25:09,387 - INFO - Applying normalization and saving 264 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/264 [00:00<?, ?it/s]2025-11-12 18:25:09,396 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold6\train_dataset.h5
Normalizing and saving training data:   4%|#######5                                                                                                                                                                                              | 10/264 [00:00<00:16, 15.22it/s]Normalizing and saving training data:   8%|###############                                                                                                                                                                                       | 20/264 [00:01<00:16, 15.07it/s]Normalizing and saving training data:  11%|######################5                                                                                                                                                                               | 30/264 [00:01<00:15, 14.97it/s]Normalizing and saving training data:  15%|##############################                                                                                                                                                                        | 40/264 [00:02<00:15, 14.90it/s]Normalizing and saving training data:  19%|#####################################5                                                                                                                                                                | 50/264 [00:03<00:14, 15.00it/s]Normalizing and saving training data:  23%|#############################################                                                                                                                                                         | 60/264 [00:04<00:13, 15.00it/s]Normalizing and saving training data:  27%|####################################################5                                                                                                                                                 | 70/264 [00:04<00:12, 14.98it/s]Normalizing and saving training data:  30%|############################################################                                                                                                                                          | 80/264 [00:05<00:12, 14.95it/s]Normalizing and saving training data:  34%|###################################################################5                                                                                                                                  | 90/264 [00:06<00:11, 14.91it/s]Normalizing and saving training data:  38%|##########################################################################6                                                                                                                          | 100/264 [00:06<00:11, 14.88it/s]Normalizing and saving training data:  42%|##################################################################################                                                                                                                   | 110/264 [00:07<00:10, 14.95it/s]Normalizing and saving training data:  45%|#########################################################################################5                                                                                                           | 120/264 [00:08<00:09, 15.05it/s]Normalizing and saving training data:  49%|#################################################################################################                                                                                                    | 130/264 [00:08<00:08, 15.06it/s]Normalizing and saving training data:  53%|########################################################################################################4                                                                                            | 140/264 [00:09<00:08, 14.86it/s]Normalizing and saving training data:  57%|###############################################################################################################9                                                                                     | 150/264 [00:10<00:07, 14.81it/s]Normalizing and saving training data:  61%|#######################################################################################################################3                                                                             | 160/264 [00:10<00:07, 14.77it/s]Normalizing and saving training data:  64%|##############################################################################################################################8                                                                      | 170/264 [00:11<00:06, 14.78it/s]Normalizing and saving training data:  68%|######################################################################################################################################3                                                              | 180/264 [00:12<00:05, 14.78it/s]Normalizing and saving training data:  72%|#############################################################################################################################################7                                                       | 190/264 [00:12<00:04, 14.82it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################2                                               | 200/264 [00:13<00:04, 14.83it/s]Normalizing and saving training data:  80%|############################################################################################################################################################7                                        | 210/264 [00:14<00:03, 14.82it/s]Normalizing and saving training data:  83%|####################################################################################################################################################################1                                | 220/264 [00:14<00:02, 14.80it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################6                         | 230/264 [00:15<00:02, 14.79it/s]Normalizing and saving training data:  91%|###################################################################################################################################################################################                  | 240/264 [00:16<00:01, 14.69it/s]Normalizing and saving training data:  95%|##########################################################################################################################################################################################5          | 250/264 [00:16<00:00, 14.77it/s]Normalizing and saving training data:  98%|##################################################################################################################################################################################################   | 260/264 [00:17<00:00, 14.83it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 264/264 [00:17<00:00, 15.10it/s]
2025-11-12 18:25:27,179 - INFO - Training data processing completed during stats computation phase
2025-11-12 18:25:27,180 - INFO - Loaded normalization statistics:
2025-11-12 18:25:27,180 - INFO -   Mean: -0.213143
2025-11-12 18:25:27,180 - INFO -   Std: 2.347302
2025-11-12 18:25:27,180 - INFO - Split train already completed, skipping
2025-11-12 18:25:27,180 - INFO - Processing test split...
2025-11-12 18:25:27,180 - INFO - Need to process 42/42 sequences for test
2025-11-12 18:25:27,180 - INFO - Processing 42 sequences from 15 unique files
2025-11-12 18:25:27,180 - INFO - Average 2.8 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/42 [00:00<?, ?it/s]Processing test:   2%|#####2                                                                                                                                                                                                                       | 1/42 [00:00<00:13,  3.09it/s]Processing test:   5%|##########5                                                                                                                                                                                                                  | 2/42 [00:01<00:32,  1.22it/s]Processing test:  14%|###############################5                                                                                                                                                                                             | 6/42 [00:01<00:10,  3.53it/s]2025-11-12 18:25:29,169 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb01_fold6\test_dataset.h5
2025-11-12 18:25:30,962 - INFO - Progress: 290/306 (94.8%) - ETA: 0.1 minutes
Processing test:  64%|#############################################################################################################################################4                                                                              | 27/42 [00:04<00:01,  7.91it/s]Processing test:  67%|##################################################################################################################################################6                                                                         | 28/42 [00:04<00:01,  7.47it/s]Processing test:  69%|#######################################################################################################################################################9                                                                    | 29/42 [00:05<00:02,  5.55it/s]Processing test:  74%|##################################################################################################################################################################3                                                         | 31/42 [00:05<00:01,  5.57it/s]Processing test:  79%|############################################################################################################################################################################8                                               | 33/42 [00:05<00:01,  5.62it/s]Processing test:  83%|#######################################################################################################################################################################################3                                    | 35/42 [00:06<00:01,  5.88it/s]Processing test:  86%|############################################################################################################################################################################################5                               | 36/42 [00:07<00:01,  3.14it/s]2025-11-12 18:25:35,248 - INFO - Progress: 301/306 (98.4%) - ETA: 0.0 minutes
Processing test:  90%|#######################################################################################################################################################################################################                     | 38/42 [00:08<00:01,  2.72it/s]Processing test:  93%|############################################################################################################################################################################################################2               | 39/42 [00:08<00:01,  2.86it/s]Processing test:  95%|#################################################################################################################################################################################################################5          | 40/42 [00:08<00:00,  2.98it/s]Processing test:  98%|######################################################################################################################################################################################################################7     | 41/42 [00:09<00:00,  3.11it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:09<00:00,  3.16it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:09<00:00,  4.45it/s]
2025-11-12 18:25:37,012 - INFO - Validating final datasets...
2025-11-12 18:25:37,023 - INFO - train dataset validation:
2025-11-12 18:25:37,023 - INFO -   - Segments: 264
2025-11-12 18:25:37,023 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:25:37,023 - INFO -   - Classes: 132 preictal, 132 interictal
2025-11-12 18:25:37,023 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:25:37,029 - INFO - test dataset validation:
2025-11-12 18:25:37,029 - INFO -   - Segments: 42
2025-11-12 18:25:37,029 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 18:25:37,029 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-12 18:25:37,029 - INFO -   - Balance: 50.0% preictal
2025-11-12 18:25:37,029 - INFO - ============================================================
2025-11-12 18:25:37,030 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 18:25:37,030 - INFO - Total time: 1.0 minutes
2025-11-12 18:25:37,030 - INFO - Processed segments: 306
2025-11-12 18:25:37,030 - INFO - Average rate: 4.9 segments/second
2025-11-12 18:25:37,030 - INFO - ============================================================
✅ Fold 6 preprocessing completed successfully!

============================================================
✅ BATCH PREPROCESSING COMPLETED!
✅ Processed 7 folds for patient chb01
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb01
============================================================

============================================================
TRAINING FOLD 0/6
============================================================
Using dataset prefix: chb01_fold0
Loading datasets from: preprocessing\data\chb01_fold0
Saving models to: model\chb01_fold0
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.2098, std=2.3681
Loaded train dataset: 258 samples
  - Spectrogram shape: torch.Size([258, 30, 18, 50, 10])
  - Value range: [-4.9787, 3.8747]
  - Class distribution: tensor([129, 129])
LOOCV Mode (Fold 0): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.7004, grad_norm=1.264, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:10,  4.40s/it, loss=0.7004, grad_norm=1.264, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:10,  4.40s/it, loss=0.6833, grad_norm=1.224, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:28,  1.87s/it, loss=0.6833, grad_norm=1.224, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:28,  1.87s/it, loss=0.6947, grad_norm=1.255, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.07s/it, loss=0.6947, grad_norm=1.255, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.07s/it, loss=0.6827, grad_norm=1.059, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.45it/s, loss=0.6827, grad_norm=1.059, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.45it/s, loss=0.6962, grad_norm=1.185, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.08it/s, loss=0.6962, grad_norm=1.185, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.08it/s, loss=0.6938, grad_norm=1.299, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.82it/s, loss=0.6938, grad_norm=1.299, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:05<00:03,  2.82it/s, loss=0.6884, grad_norm=1.018, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.64it/s, loss=0.6884, grad_norm=1.018, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.64it/s, loss=0.6869, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.50it/s, loss=0.6869, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.50it/s, loss=0.6794, grad_norm=1.407, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.35it/s, loss=0.6794, grad_norm=1.407, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.35it/s, loss=0.6778, grad_norm=1.253, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.14it/s, loss=0.6778, grad_norm=1.253, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.14it/s, loss=0.6723, grad_norm=1.188, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.85it/s, loss=0.6723, grad_norm=1.188, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.85it/s, loss=0.6844, grad_norm=1.225, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.46it/s, loss=0.6844, grad_norm=1.225, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.46it/s, loss=0.6750, grad_norm=1.181, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.94it/s, loss=0.6750, grad_norm=1.181, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.94it/s, loss=0.6727, grad_norm=1.276, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.26it/s, loss=0.6727, grad_norm=1.276, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.26it/s, loss=0.6728, grad_norm=1.113, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.54it/s, loss=0.6728, grad_norm=1.113, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:06<00:00,  8.54it/s, loss=0.6714, grad_norm=1.266, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.67it/s, loss=0.6714, grad_norm=1.266, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.67it/s, loss=0.7110, grad_norm=3.634, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.53it/s, loss=0.7110, grad_norm=3.634, lr=0.000010]

Epoch 1/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.6849, Acc: 0.5891, Precision: 0.5525, Recall: 0.9380, F1: 0.6954, AUC: 0.6943
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6775, grad_norm=1.356, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.17s/it, loss=0.6775, grad_norm=1.356, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.17s/it, loss=0.6644, grad_norm=1.450, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.6644, grad_norm=1.450, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.6499, grad_norm=1.542, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6499, grad_norm=1.542, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6492, grad_norm=1.197, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.51it/s, loss=0.6492, grad_norm=1.197, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.51it/s, loss=0.6498, grad_norm=1.390, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.16it/s, loss=0.6498, grad_norm=1.390, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.16it/s, loss=0.6440, grad_norm=1.468, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.90it/s, loss=0.6440, grad_norm=1.468, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.90it/s, loss=0.6456, grad_norm=1.311, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.71it/s, loss=0.6456, grad_norm=1.311, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.71it/s, loss=0.6256, grad_norm=1.324, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:02,  4.48it/s, loss=0.6256, grad_norm=1.324, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.48it/s, loss=0.6412, grad_norm=1.443, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.27it/s, loss=0.6412, grad_norm=1.443, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.27it/s, loss=0.6447, grad_norm=1.255, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.00it/s, loss=0.6447, grad_norm=1.255, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.00it/s, loss=0.6331, grad_norm=1.376, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.61it/s, loss=0.6331, grad_norm=1.376, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.61it/s, loss=0.6243, grad_norm=1.376, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.10it/s, loss=0.6243, grad_norm=1.376, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.10it/s, loss=0.6150, grad_norm=1.483, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.33it/s, loss=0.6150, grad_norm=1.483, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.33it/s, loss=0.6232, grad_norm=1.437, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.66it/s, loss=0.6232, grad_norm=1.437, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.66it/s, loss=0.6089, grad_norm=1.394, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  7.91it/s, loss=0.6089, grad_norm=1.394, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  7.91it/s, loss=0.5924, grad_norm=1.386, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.25it/s, loss=0.5924, grad_norm=1.386, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.25it/s, loss=0.7086, grad_norm=3.788, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.59it/s, loss=0.7086, grad_norm=3.788, lr=0.000010]

Epoch 2/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6410, Acc: 0.8101, Precision: 0.7326, Recall: 0.9767, F1: 0.8372, AUC: 0.9321
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.5440, grad_norm=1.471, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.19s/it, loss=0.5440, grad_norm=1.471, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.19s/it, loss=0.5429, grad_norm=1.358, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.5429, grad_norm=1.358, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.5538, grad_norm=1.781, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.5538, grad_norm=1.781, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.5681, grad_norm=1.418, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.51it/s, loss=0.5681, grad_norm=1.418, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.51it/s, loss=0.6253, grad_norm=1.695, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.16it/s, loss=0.6253, grad_norm=1.695, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.16it/s, loss=0.5315, grad_norm=1.459, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.92it/s, loss=0.5315, grad_norm=1.459, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.92it/s, loss=0.5200, grad_norm=1.291, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.77it/s, loss=0.5200, grad_norm=1.291, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.77it/s, loss=0.5107, grad_norm=1.370, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.63it/s, loss=0.5107, grad_norm=1.370, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.63it/s, loss=0.5303, grad_norm=1.540, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.48it/s, loss=0.5303, grad_norm=1.540, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.48it/s, loss=0.4943, grad_norm=1.212, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.4943, grad_norm=1.212, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.4835, grad_norm=1.624, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.90it/s, loss=0.4835, grad_norm=1.624, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.90it/s, loss=0.4865, grad_norm=1.341, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.48it/s, loss=0.4865, grad_norm=1.341, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.48it/s, loss=0.4710, grad_norm=1.730, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.90it/s, loss=0.4710, grad_norm=1.730, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.90it/s, loss=0.4267, grad_norm=1.190, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.27it/s, loss=0.4267, grad_norm=1.190, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.27it/s, loss=0.4588, grad_norm=1.311, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.54it/s, loss=0.4588, grad_norm=1.311, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.54it/s, loss=0.4296, grad_norm=1.407, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.77it/s, loss=0.4296, grad_norm=1.407, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.77it/s, loss=0.3580, grad_norm=2.064, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.62it/s, loss=0.3580, grad_norm=2.064, lr=0.000010]

Epoch 3/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.5021, Acc: 0.9264, Precision: 0.8716, Recall: 1.0000, F1: 0.9314, AUC: 0.9875
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.4255, grad_norm=1.528, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.28s/it, loss=0.4255, grad_norm=1.528, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.28s/it, loss=0.3515, grad_norm=1.390, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.83s/it, loss=0.3515, grad_norm=1.390, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.83s/it, loss=0.4153, grad_norm=1.780, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.05s/it, loss=0.4153, grad_norm=1.780, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.05s/it, loss=0.3427, grad_norm=1.260, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.48it/s, loss=0.3427, grad_norm=1.260, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.48it/s, loss=0.2967, grad_norm=1.184, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.12it/s, loss=0.2967, grad_norm=1.184, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.12it/s, loss=0.3117, grad_norm=1.112, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.87it/s, loss=0.3117, grad_norm=1.112, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.87it/s, loss=0.3216, grad_norm=1.274, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.70it/s, loss=0.3216, grad_norm=1.274, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.70it/s, loss=0.3140, grad_norm=1.776, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.55it/s, loss=0.3140, grad_norm=1.776, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.55it/s, loss=0.3171, grad_norm=1.707, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.37it/s, loss=0.3171, grad_norm=1.707, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.37it/s, loss=0.2978, grad_norm=1.390, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.12it/s, loss=0.2978, grad_norm=1.390, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.12it/s, loss=0.3651, grad_norm=2.597, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.84it/s, loss=0.3651, grad_norm=2.597, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.84it/s, loss=0.2261, grad_norm=1.301, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.41it/s, loss=0.2261, grad_norm=1.301, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.41it/s, loss=0.2940, grad_norm=1.987, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.81it/s, loss=0.2940, grad_norm=1.987, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.81it/s, loss=0.2436, grad_norm=1.949, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.18it/s, loss=0.2436, grad_norm=1.949, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.18it/s, loss=0.2632, grad_norm=1.158, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.46it/s, loss=0.2632, grad_norm=1.158, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.46it/s, loss=0.1994, grad_norm=0.959, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.57it/s, loss=0.1994, grad_norm=0.959, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.57it/s, loss=0.1518, grad_norm=1.416, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.57it/s, loss=0.1518, grad_norm=1.416, lr=0.000010]

Epoch 4/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.3022, Acc: 0.9651, Precision: 0.9348, Recall: 1.0000, F1: 0.9663, AUC: 0.9975
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.1445, grad_norm=0.790, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.27s/it, loss=0.1445, grad_norm=0.790, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.27s/it, loss=0.1937, grad_norm=1.093, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.84s/it, loss=0.1937, grad_norm=1.093, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.84s/it, loss=0.1743, grad_norm=1.030, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.05s/it, loss=0.1743, grad_norm=1.030, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.05s/it, loss=0.1773, grad_norm=0.847, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.45it/s, loss=0.1773, grad_norm=0.847, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.45it/s, loss=0.1619, grad_norm=0.788, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.06it/s, loss=0.1619, grad_norm=0.788, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.06it/s, loss=0.2005, grad_norm=2.029, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.76it/s, loss=0.2005, grad_norm=2.029, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:05<00:03,  2.76it/s, loss=0.1106, grad_norm=0.627, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.56it/s, loss=0.1106, grad_norm=0.627, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.56it/s, loss=0.1151, grad_norm=0.665, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.43it/s, loss=0.1151, grad_norm=0.665, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.43it/s, loss=0.1436, grad_norm=1.100, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.28it/s, loss=0.1436, grad_norm=1.100, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.28it/s, loss=0.1141, grad_norm=0.668, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.94it/s, loss=0.1141, grad_norm=0.668, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.94it/s, loss=0.0964, grad_norm=0.665, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.49it/s, loss=0.0964, grad_norm=0.665, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.49it/s, loss=0.1897, grad_norm=2.881, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.09it/s, loss=0.1897, grad_norm=2.881, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.09it/s, loss=0.1141, grad_norm=0.623, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.62it/s, loss=0.1141, grad_norm=0.623, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.62it/s, loss=0.0972, grad_norm=0.575, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.01it/s, loss=0.0972, grad_norm=0.575, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.01it/s, loss=0.0837, grad_norm=0.571, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.07it/s, loss=0.0837, grad_norm=0.571, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:06<00:00,  8.07it/s, loss=0.1293, grad_norm=1.893, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.03it/s, loss=0.1293, grad_norm=1.893, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.03it/s, loss=0.8217, grad_norm=6.916, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.52it/s, loss=0.8217, grad_norm=6.916, lr=0.000010]

Epoch 5/5 Complete (7.2s) [LR: 0.000005]
Train - Loss: 0.1805, Acc: 0.9961, Precision: 1.0000, Recall: 0.9922, F1: 0.9961, AUC: 0.9993
------------------------------------------------------------
Training curves saved to model\chb01_fold0\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb01_fold0
============================================================
✅ Fold 0 training completed successfully!

============================================================
TRAINING FOLD 1/6
============================================================
Using dataset prefix: chb01_fold1
Loading datasets from: preprocessing\data\chb01_fold1
Saving models to: model\chb01_fold1
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.2203, std=2.3318
Loaded train dataset: 260 samples
  - Spectrogram shape: torch.Size([260, 30, 18, 50, 10])
  - Value range: [-5.0517, 3.9034]
  - Class distribution: tensor([130, 130])
LOOCV Mode (Fold 1): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.7163, grad_norm=1.282, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:10,  4.43s/it, loss=0.7163, grad_norm=1.282, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:10,  4.43s/it, loss=0.6821, grad_norm=1.329, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:28,  1.89s/it, loss=0.6821, grad_norm=1.329, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:28,  1.89s/it, loss=0.6978, grad_norm=1.160, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:15,  1.08s/it, loss=0.6978, grad_norm=1.160, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:15,  1.08s/it, loss=0.7069, grad_norm=1.372, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:09,  1.44it/s, loss=0.7069, grad_norm=1.372, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:09,  1.44it/s, loss=0.7002, grad_norm=1.179, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.07it/s, loss=0.7002, grad_norm=1.179, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.07it/s, loss=0.6791, grad_norm=1.129, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.80it/s, loss=0.6791, grad_norm=1.129, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:05<00:03,  2.80it/s, loss=0.6690, grad_norm=1.207, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.63it/s, loss=0.6690, grad_norm=1.207, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.63it/s, loss=0.6851, grad_norm=1.145, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.49it/s, loss=0.6851, grad_norm=1.145, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.49it/s, loss=0.6793, grad_norm=1.196, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.35it/s, loss=0.6793, grad_norm=1.196, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.35it/s, loss=0.6816, grad_norm=1.392, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.15it/s, loss=0.6816, grad_norm=1.392, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.15it/s, loss=0.6733, grad_norm=1.201, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.87it/s, loss=0.6733, grad_norm=1.201, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.87it/s, loss=0.6779, grad_norm=1.282, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.44it/s, loss=0.6779, grad_norm=1.282, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.44it/s, loss=0.6703, grad_norm=1.147, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.89it/s, loss=0.6703, grad_norm=1.147, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.89it/s, loss=0.6726, grad_norm=1.176, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.29it/s, loss=0.6726, grad_norm=1.176, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.29it/s, loss=0.6602, grad_norm=1.258, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.54it/s, loss=0.6602, grad_norm=1.258, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:06<00:00,  8.54it/s, loss=0.6668, grad_norm=1.156, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.71it/s, loss=0.6668, grad_norm=1.156, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.71it/s, loss=0.6872, grad_norm=2.528, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.52it/s, loss=0.6872, grad_norm=2.528, lr=0.000010]

Epoch 1/5 Complete (7.2s) [LR: 0.000010]
Train - Loss: 0.6827, Acc: 0.6885, Precision: 0.6310, Recall: 0.9077, F1: 0.7445, AUC: 0.6991
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6497, grad_norm=1.167, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.30s/it, loss=0.6497, grad_norm=1.167, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.30s/it, loss=0.6365, grad_norm=1.457, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.85s/it, loss=0.6365, grad_norm=1.457, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.85s/it, loss=0.6646, grad_norm=1.497, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.05s/it, loss=0.6646, grad_norm=1.497, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.05s/it, loss=0.6569, grad_norm=1.374, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.47it/s, loss=0.6569, grad_norm=1.374, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.47it/s, loss=0.6381, grad_norm=1.160, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.11it/s, loss=0.6381, grad_norm=1.160, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.11it/s, loss=0.6224, grad_norm=1.248, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.86it/s, loss=0.6224, grad_norm=1.248, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.86it/s, loss=0.6342, grad_norm=1.213, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.69it/s, loss=0.6342, grad_norm=1.213, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.69it/s, loss=0.6218, grad_norm=1.317, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.58it/s, loss=0.6218, grad_norm=1.317, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.58it/s, loss=0.5844, grad_norm=1.279, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.44it/s, loss=0.5844, grad_norm=1.279, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.44it/s, loss=0.6339, grad_norm=1.503, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.25it/s, loss=0.6339, grad_norm=1.503, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.25it/s, loss=0.6035, grad_norm=1.263, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.96it/s, loss=0.6035, grad_norm=1.263, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.96it/s, loss=0.5977, grad_norm=1.273, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.51it/s, loss=0.5977, grad_norm=1.273, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.51it/s, loss=0.5963, grad_norm=1.357, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.95it/s, loss=0.5963, grad_norm=1.357, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.95it/s, loss=0.5690, grad_norm=1.533, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.04it/s, loss=0.5690, grad_norm=1.533, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.04it/s, loss=0.5648, grad_norm=1.237, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.38it/s, loss=0.5648, grad_norm=1.237, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.38it/s, loss=0.5453, grad_norm=1.242, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.65it/s, loss=0.5453, grad_norm=1.242, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.65it/s, loss=0.5241, grad_norm=2.816, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.56it/s, loss=0.5241, grad_norm=2.816, lr=0.000010]

Epoch 2/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.6084, Acc: 0.9038, Precision: 0.8387, Recall: 1.0000, F1: 0.9123, AUC: 0.9708
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.5531, grad_norm=1.190, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:13,  4.57s/it, loss=0.5531, grad_norm=1.190, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:13,  4.57s/it, loss=0.5274, grad_norm=1.237, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:29,  1.95s/it, loss=0.5274, grad_norm=1.237, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:29,  1.95s/it, loss=0.5290, grad_norm=1.453, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:15,  1.11s/it, loss=0.5290, grad_norm=1.453, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:15,  1.11s/it, loss=0.5312, grad_norm=1.743, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:09,  1.40it/s, loss=0.5312, grad_norm=1.743, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:05<00:09,  1.40it/s, loss=0.4756, grad_norm=1.124, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:05<00:05,  2.02it/s, loss=0.4756, grad_norm=1.124, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:05<00:05,  2.02it/s, loss=0.4702, grad_norm=1.243, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:05<00:04,  2.75it/s, loss=0.4702, grad_norm=1.243, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:05<00:04,  2.75it/s, loss=0.4233, grad_norm=1.214, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.56it/s, loss=0.4233, grad_norm=1.214, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.56it/s, loss=0.4730, grad_norm=1.536, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.44it/s, loss=0.4730, grad_norm=1.536, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.44it/s, loss=0.4233, grad_norm=1.103, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.28it/s, loss=0.4233, grad_norm=1.103, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.28it/s, loss=0.4529, grad_norm=1.294, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.09it/s, loss=0.4529, grad_norm=1.294, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.09it/s, loss=0.4330, grad_norm=1.411, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.55it/s, loss=0.4330, grad_norm=1.411, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.55it/s, loss=0.3734, grad_norm=1.086, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.05it/s, loss=0.3734, grad_norm=1.086, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.05it/s, loss=0.4630, grad_norm=1.473, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.57it/s, loss=0.4630, grad_norm=1.473, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:06<00:00,  7.57it/s, loss=0.3715, grad_norm=1.235, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:06<00:00,  7.96it/s, loss=0.3715, grad_norm=1.235, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:06<00:00,  7.96it/s, loss=0.3916, grad_norm=1.439, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:06<00:00,  8.27it/s, loss=0.3916, grad_norm=1.439, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:06<00:00,  8.27it/s, loss=0.4423, grad_norm=1.513, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.48it/s, loss=0.4423, grad_norm=1.513, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.48it/s, loss=0.3382, grad_norm=2.182, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.46it/s, loss=0.3382, grad_norm=2.182, lr=0.000010]

Epoch 3/5 Complete (7.3s) [LR: 0.000010]
Train - Loss: 0.4513, Acc: 0.9538, Precision: 0.9155, Recall: 1.0000, F1: 0.9559, AUC: 0.9854
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.3598, grad_norm=1.423, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.21s/it, loss=0.3598, grad_norm=1.423, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.21s/it, loss=0.3208, grad_norm=1.070, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.81s/it, loss=0.3208, grad_norm=1.070, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.81s/it, loss=0.2945, grad_norm=1.068, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.2945, grad_norm=1.068, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.2969, grad_norm=1.013, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.50it/s, loss=0.2969, grad_norm=1.013, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.50it/s, loss=0.3145, grad_norm=1.908, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.15it/s, loss=0.3145, grad_norm=1.908, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.15it/s, loss=0.2980, grad_norm=1.671, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.90it/s, loss=0.2980, grad_norm=1.671, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.90it/s, loss=0.2668, grad_norm=1.221, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.75it/s, loss=0.2668, grad_norm=1.221, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.75it/s, loss=0.2401, grad_norm=1.082, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.61it/s, loss=0.2401, grad_norm=1.082, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.61it/s, loss=0.2663, grad_norm=1.537, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.46it/s, loss=0.2663, grad_norm=1.537, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.46it/s, loss=0.2092, grad_norm=0.848, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.2092, grad_norm=0.848, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.1533, grad_norm=0.737, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.89it/s, loss=0.1533, grad_norm=0.737, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.89it/s, loss=0.2417, grad_norm=1.868, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.43it/s, loss=0.2417, grad_norm=1.868, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.43it/s, loss=0.2000, grad_norm=1.300, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.86it/s, loss=0.2000, grad_norm=1.300, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.86it/s, loss=0.1705, grad_norm=1.050, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.17it/s, loss=0.1705, grad_norm=1.050, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.17it/s, loss=0.1953, grad_norm=0.902, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.36it/s, loss=0.1953, grad_norm=0.902, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.36it/s, loss=0.1454, grad_norm=0.808, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.53it/s, loss=0.1454, grad_norm=0.808, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.53it/s, loss=0.7368, grad_norm=9.755, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.59it/s, loss=0.7368, grad_norm=9.755, lr=0.000010]

Epoch 4/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.2771, Acc: 0.9808, Precision: 0.9630, Recall: 1.0000, F1: 0.9811, AUC: 0.9968
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.1487, grad_norm=0.761, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:05,  4.11s/it, loss=0.1487, grad_norm=0.761, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:05,  4.11s/it, loss=0.1271, grad_norm=0.652, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.76s/it, loss=0.1271, grad_norm=0.652, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.76s/it, loss=0.1497, grad_norm=1.879, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.01s/it, loss=0.1497, grad_norm=1.879, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.01s/it, loss=0.1310, grad_norm=0.633, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.1310, grad_norm=0.633, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.1037, grad_norm=0.630, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.17it/s, loss=0.1037, grad_norm=0.630, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.17it/s, loss=0.1364, grad_norm=1.095, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.91it/s, loss=0.1364, grad_norm=1.095, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.91it/s, loss=0.1075, grad_norm=0.632, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.71it/s, loss=0.1075, grad_norm=0.632, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.71it/s, loss=0.1484, grad_norm=1.728, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.54it/s, loss=0.1484, grad_norm=1.728, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.54it/s, loss=0.1378, grad_norm=1.144, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.32it/s, loss=0.1378, grad_norm=1.144, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.32it/s, loss=0.1757, grad_norm=2.176, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.03it/s, loss=0.1757, grad_norm=2.176, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.03it/s, loss=0.0863, grad_norm=0.506, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.66it/s, loss=0.0863, grad_norm=0.506, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.66it/s, loss=0.0948, grad_norm=0.766, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  6.99it/s, loss=0.0948, grad_norm=0.766, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  6.99it/s, loss=0.0754, grad_norm=0.447, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.51it/s, loss=0.0754, grad_norm=0.447, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.51it/s, loss=0.0633, grad_norm=0.431, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.92it/s, loss=0.0633, grad_norm=0.431, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.92it/s, loss=0.0625, grad_norm=0.385, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.24it/s, loss=0.0625, grad_norm=0.385, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.24it/s, loss=0.0671, grad_norm=0.502, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.48it/s, loss=0.0671, grad_norm=0.502, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.48it/s, loss=0.0374, grad_norm=0.426, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.61it/s, loss=0.0374, grad_norm=0.426, lr=0.000010]

Epoch 5/5 Complete (6.9s) [LR: 0.000005]
Train - Loss: 0.1090, Acc: 1.0000, Precision: 1.0000, Recall: 1.0000, F1: 1.0000, AUC: 1.0000
------------------------------------------------------------
Training curves saved to model\chb01_fold1\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb01_fold1
============================================================
✅ Fold 1 training completed successfully!

============================================================
TRAINING FOLD 2/6
============================================================
Using dataset prefix: chb01_fold2
Loading datasets from: preprocessing\data\chb01_fold2
Saving models to: model\chb01_fold2
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.2173, std=2.3152
Loaded train dataset: 262 samples
  - Spectrogram shape: torch.Size([262, 30, 18, 50, 10])
  - Value range: [-5.0894, 3.9665]
  - Class distribution: tensor([131, 131])
LOOCV Mode (Fold 2): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6780, grad_norm=1.161, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:05,  4.10s/it, loss=0.6780, grad_norm=1.161, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:05,  4.10s/it, loss=0.6962, grad_norm=1.245, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.75s/it, loss=0.6962, grad_norm=1.245, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.75s/it, loss=0.7015, grad_norm=1.205, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.00s/it, loss=0.7015, grad_norm=1.205, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.00s/it, loss=0.7106, grad_norm=1.403, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.54it/s, loss=0.7106, grad_norm=1.403, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.54it/s, loss=0.6843, grad_norm=1.085, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.20it/s, loss=0.6843, grad_norm=1.085, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.20it/s, loss=0.7097, grad_norm=1.293, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.96it/s, loss=0.7097, grad_norm=1.293, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.96it/s, loss=0.6926, grad_norm=1.187, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.71it/s, loss=0.6926, grad_norm=1.187, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.71it/s, loss=0.6947, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:02,  4.43it/s, loss=0.6947, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.43it/s, loss=0.6997, grad_norm=1.030, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.09it/s, loss=0.6997, grad_norm=1.030, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.09it/s, loss=0.7050, grad_norm=1.539, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.86it/s, loss=0.7050, grad_norm=1.539, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.86it/s, loss=0.6599, grad_norm=1.159, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.45it/s, loss=0.6599, grad_norm=1.159, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.45it/s, loss=0.6742, grad_norm=1.280, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.10it/s, loss=0.6742, grad_norm=1.280, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.10it/s, loss=0.6842, grad_norm=1.538, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.63it/s, loss=0.6842, grad_norm=1.538, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.63it/s, loss=0.6640, grad_norm=1.283, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.97it/s, loss=0.6640, grad_norm=1.283, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.97it/s, loss=0.6635, grad_norm=1.213, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.31it/s, loss=0.6635, grad_norm=1.213, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.31it/s, loss=0.6698, grad_norm=1.294, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.46it/s, loss=0.6698, grad_norm=1.294, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.46it/s, loss=0.6989, grad_norm=2.356, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.61it/s, loss=0.6989, grad_norm=2.356, lr=0.000010]

Epoch 1/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6875, Acc: 0.5611, Precision: 0.7105, Recall: 0.2061, F1: 0.3195, AUC: 0.5948
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6724, grad_norm=1.751, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.26s/it, loss=0.6724, grad_norm=1.751, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.26s/it, loss=0.6829, grad_norm=1.677, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.82s/it, loss=0.6829, grad_norm=1.677, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.82s/it, loss=0.6451, grad_norm=1.279, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.6451, grad_norm=1.279, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.6487, grad_norm=1.380, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.6487, grad_norm=1.380, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.6447, grad_norm=1.401, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.6447, grad_norm=1.401, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.6356, grad_norm=1.389, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.88it/s, loss=0.6356, grad_norm=1.389, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.88it/s, loss=0.6253, grad_norm=1.319, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.71it/s, loss=0.6253, grad_norm=1.319, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.71it/s, loss=0.6204, grad_norm=1.330, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.57it/s, loss=0.6204, grad_norm=1.330, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.57it/s, loss=0.6368, grad_norm=1.400, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.42it/s, loss=0.6368, grad_norm=1.400, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.42it/s, loss=0.6110, grad_norm=1.219, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.24it/s, loss=0.6110, grad_norm=1.219, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.24it/s, loss=0.6164, grad_norm=1.385, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.95it/s, loss=0.6164, grad_norm=1.385, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.95it/s, loss=0.6113, grad_norm=1.306, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.52it/s, loss=0.6113, grad_norm=1.306, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.52it/s, loss=0.6059, grad_norm=1.385, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.97it/s, loss=0.6059, grad_norm=1.385, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.97it/s, loss=0.6177, grad_norm=1.268, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.29it/s, loss=0.6177, grad_norm=1.268, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.29it/s, loss=0.5657, grad_norm=1.308, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.55it/s, loss=0.5657, grad_norm=1.308, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.55it/s, loss=0.5793, grad_norm=1.644, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.73it/s, loss=0.5793, grad_norm=1.644, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.73it/s, loss=0.6353, grad_norm=2.233, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.56it/s, loss=0.6353, grad_norm=2.233, lr=0.000010]

Epoch 2/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6267, Acc: 0.8740, Precision: 0.8712, Recall: 0.8779, F1: 0.8745, AUC: 0.9465
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.5288, grad_norm=1.288, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:04,  4.03s/it, loss=0.5288, grad_norm=1.288, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:04,  4.03s/it, loss=0.5330, grad_norm=1.399, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:25,  1.73s/it, loss=0.5330, grad_norm=1.399, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:25,  1.73s/it, loss=0.5451, grad_norm=1.321, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:13,  1.01it/s, loss=0.5451, grad_norm=1.321, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:13,  1.01it/s, loss=0.5440, grad_norm=1.297, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.55it/s, loss=0.5440, grad_norm=1.297, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.55it/s, loss=0.5064, grad_norm=1.353, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.20it/s, loss=0.5064, grad_norm=1.353, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.20it/s, loss=0.4903, grad_norm=1.169, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.97it/s, loss=0.4903, grad_norm=1.169, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.97it/s, loss=0.5065, grad_norm=1.474, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.80it/s, loss=0.5065, grad_norm=1.474, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.80it/s, loss=0.4763, grad_norm=1.085, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.67it/s, loss=0.4763, grad_norm=1.085, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.67it/s, loss=0.4686, grad_norm=1.085, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:04<00:01,  5.48it/s, loss=0.4686, grad_norm=1.085, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.48it/s, loss=0.4569, grad_norm=1.237, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.21it/s, loss=0.4569, grad_norm=1.237, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.21it/s, loss=0.4338, grad_norm=1.277, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.86it/s, loss=0.4338, grad_norm=1.277, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.86it/s, loss=0.4314, grad_norm=1.541, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.38it/s, loss=0.4314, grad_norm=1.541, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.38it/s, loss=0.5077, grad_norm=1.739, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.86it/s, loss=0.5077, grad_norm=1.739, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.86it/s, loss=0.3982, grad_norm=1.461, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.14it/s, loss=0.3982, grad_norm=1.461, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.14it/s, loss=0.4908, grad_norm=1.957, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.41it/s, loss=0.4908, grad_norm=1.957, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.41it/s, loss=0.3753, grad_norm=1.406, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.61it/s, loss=0.3753, grad_norm=1.406, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.61it/s, loss=0.3395, grad_norm=1.188, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.66it/s, loss=0.3395, grad_norm=1.188, lr=0.000010]

Epoch 3/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.4725, Acc: 0.9733, Precision: 0.9493, Recall: 1.0000, F1: 0.9740, AUC: 0.9832
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.3740, grad_norm=1.306, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.21s/it, loss=0.3740, grad_norm=1.306, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.21s/it, loss=0.3353, grad_norm=0.877, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.80s/it, loss=0.3353, grad_norm=0.877, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.80s/it, loss=0.3422, grad_norm=1.175, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.3422, grad_norm=1.175, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.2970, grad_norm=1.047, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.50it/s, loss=0.2970, grad_norm=1.047, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.50it/s, loss=0.2887, grad_norm=0.994, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.15it/s, loss=0.2887, grad_norm=0.994, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.15it/s, loss=0.3071, grad_norm=1.404, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.91it/s, loss=0.3071, grad_norm=1.404, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.91it/s, loss=0.2971, grad_norm=1.183, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.75it/s, loss=0.2971, grad_norm=1.183, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.75it/s, loss=0.2711, grad_norm=0.934, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.61it/s, loss=0.2711, grad_norm=0.934, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.61it/s, loss=0.2873, grad_norm=1.592, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.45it/s, loss=0.2873, grad_norm=1.592, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.45it/s, loss=0.2153, grad_norm=0.926, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.2153, grad_norm=0.926, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.2401, grad_norm=1.361, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.91it/s, loss=0.2401, grad_norm=1.361, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.91it/s, loss=0.2192, grad_norm=1.471, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.49it/s, loss=0.2192, grad_norm=1.471, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.49it/s, loss=0.2162, grad_norm=0.923, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.76it/s, loss=0.2162, grad_norm=0.923, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.76it/s, loss=0.1781, grad_norm=0.726, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.13it/s, loss=0.1781, grad_norm=0.726, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.13it/s, loss=0.2115, grad_norm=0.818, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.43it/s, loss=0.2115, grad_norm=0.818, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.43it/s, loss=0.1489, grad_norm=0.684, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.64it/s, loss=0.1489, grad_norm=0.684, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.64it/s, loss=0.2714, grad_norm=3.732, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.60it/s, loss=0.2714, grad_norm=3.732, lr=0.000010]

Epoch 4/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.2647, Acc: 0.9962, Precision: 0.9924, Recall: 1.0000, F1: 0.9962, AUC: 1.0000
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.1665, grad_norm=0.704, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.25s/it, loss=0.1665, grad_norm=0.704, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.25s/it, loss=0.1764, grad_norm=0.700, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.82s/it, loss=0.1764, grad_norm=0.700, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.82s/it, loss=0.1465, grad_norm=0.685, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.1465, grad_norm=0.685, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.1058, grad_norm=0.540, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.1058, grad_norm=0.540, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.1183, grad_norm=0.662, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.1183, grad_norm=0.662, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.1773, grad_norm=2.001, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.88it/s, loss=0.1773, grad_norm=2.001, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.88it/s, loss=0.3683, grad_norm=5.066, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.73it/s, loss=0.3683, grad_norm=5.066, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.73it/s, loss=0.1417, grad_norm=0.693, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.60it/s, loss=0.1417, grad_norm=0.693, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.60it/s, loss=0.1588, grad_norm=1.077, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.46it/s, loss=0.1588, grad_norm=1.077, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.46it/s, loss=0.1057, grad_norm=0.632, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.25it/s, loss=0.1057, grad_norm=0.632, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.25it/s, loss=0.1052, grad_norm=0.807, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.93it/s, loss=0.1052, grad_norm=0.807, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.93it/s, loss=0.1053, grad_norm=3.633, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.50it/s, loss=0.1053, grad_norm=3.633, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.50it/s, loss=0.1016, grad_norm=0.523, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.93it/s, loss=0.1016, grad_norm=0.523, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.93it/s, loss=0.1120, grad_norm=0.622, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.27it/s, loss=0.1120, grad_norm=0.622, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.27it/s, loss=0.0609, grad_norm=0.388, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.50it/s, loss=0.0609, grad_norm=0.388, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.50it/s, loss=0.0869, grad_norm=1.405, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.72it/s, loss=0.0869, grad_norm=1.405, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.72it/s, loss=0.0475, grad_norm=0.434, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.59it/s, loss=0.0475, grad_norm=0.434, lr=0.000010]

Epoch 5/5 Complete (7.0s) [LR: 0.000005]
Train - Loss: 0.1344, Acc: 0.9885, Precision: 0.9848, Recall: 0.9924, F1: 0.9886, AUC: 0.9992
------------------------------------------------------------
Training curves saved to model\chb01_fold2\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb01_fold2
============================================================
✅ Fold 2 training completed successfully!

============================================================
TRAINING FOLD 3/6
============================================================
Using dataset prefix: chb01_fold3
Loading datasets from: preprocessing\data\chb01_fold3
Saving models to: model\chb01_fold3
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.1791, std=2.3158
Loaded train dataset: 260 samples
  - Spectrogram shape: torch.Size([260, 30, 18, 50, 10])
  - Value range: [-5.1044, 3.9126]
  - Class distribution: tensor([130, 130])
LOOCV Mode (Fold 3): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.7088, grad_norm=1.304, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.18s/it, loss=0.7088, grad_norm=1.304, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.18s/it, loss=0.7007, grad_norm=1.325, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.7007, grad_norm=1.325, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.6846, grad_norm=1.302, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6846, grad_norm=1.302, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6783, grad_norm=1.216, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.51it/s, loss=0.6783, grad_norm=1.216, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.51it/s, loss=0.6783, grad_norm=1.223, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.17it/s, loss=0.6783, grad_norm=1.223, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.17it/s, loss=0.6900, grad_norm=1.361, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.93it/s, loss=0.6900, grad_norm=1.361, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.93it/s, loss=0.6880, grad_norm=1.179, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.77it/s, loss=0.6880, grad_norm=1.179, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.77it/s, loss=0.6858, grad_norm=1.326, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.64it/s, loss=0.6858, grad_norm=1.326, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.64it/s, loss=0.6791, grad_norm=1.293, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.50it/s, loss=0.6791, grad_norm=1.293, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.50it/s, loss=0.6741, grad_norm=1.352, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.27it/s, loss=0.6741, grad_norm=1.352, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.27it/s, loss=0.6722, grad_norm=1.258, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.94it/s, loss=0.6722, grad_norm=1.258, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.94it/s, loss=0.6948, grad_norm=1.313, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.45it/s, loss=0.6948, grad_norm=1.313, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.45it/s, loss=0.6689, grad_norm=1.354, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.90it/s, loss=0.6689, grad_norm=1.354, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.90it/s, loss=0.6792, grad_norm=1.178, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.21it/s, loss=0.6792, grad_norm=1.178, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.21it/s, loss=0.6576, grad_norm=1.310, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.45it/s, loss=0.6576, grad_norm=1.310, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.45it/s, loss=0.6557, grad_norm=1.465, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.67it/s, loss=0.6557, grad_norm=1.465, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.67it/s, loss=0.6651, grad_norm=2.620, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.61it/s, loss=0.6651, grad_norm=2.620, lr=0.000010]

Epoch 1/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6801, Acc: 0.6846, Precision: 0.7353, Recall: 0.5769, F1: 0.6466, AUC: 0.7309
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6443, grad_norm=1.341, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.20s/it, loss=0.6443, grad_norm=1.341, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.20s/it, loss=0.6510, grad_norm=1.301, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.80s/it, loss=0.6510, grad_norm=1.301, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.80s/it, loss=0.6325, grad_norm=1.535, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.6325, grad_norm=1.535, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.6210, grad_norm=1.430, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.50it/s, loss=0.6210, grad_norm=1.430, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.50it/s, loss=0.6275, grad_norm=1.389, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.15it/s, loss=0.6275, grad_norm=1.389, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.15it/s, loss=0.6429, grad_norm=1.516, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.91it/s, loss=0.6429, grad_norm=1.516, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.91it/s, loss=0.6094, grad_norm=1.442, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.73it/s, loss=0.6094, grad_norm=1.442, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.73it/s, loss=0.6236, grad_norm=1.507, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.60it/s, loss=0.6236, grad_norm=1.507, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.60it/s, loss=0.5986, grad_norm=1.443, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.43it/s, loss=0.5986, grad_norm=1.443, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.43it/s, loss=0.6263, grad_norm=1.699, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.6263, grad_norm=1.699, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.6140, grad_norm=1.416, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.88it/s, loss=0.6140, grad_norm=1.416, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.88it/s, loss=0.6014, grad_norm=1.540, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.22it/s, loss=0.6014, grad_norm=1.540, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.22it/s, loss=0.5784, grad_norm=1.479, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.69it/s, loss=0.5784, grad_norm=1.479, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.69it/s, loss=0.5743, grad_norm=1.423, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.05it/s, loss=0.5743, grad_norm=1.423, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.05it/s, loss=0.5298, grad_norm=1.409, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.29it/s, loss=0.5298, grad_norm=1.409, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.29it/s, loss=0.5564, grad_norm=1.637, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.49it/s, loss=0.5564, grad_norm=1.637, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.49it/s, loss=0.5259, grad_norm=2.663, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.60it/s, loss=0.5259, grad_norm=2.663, lr=0.000010]

Epoch 2/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6034, Acc: 0.9269, Precision: 0.9173, Recall: 0.9385, F1: 0.9278, AUC: 0.9618
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.5048, grad_norm=1.277, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.30s/it, loss=0.5048, grad_norm=1.277, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.30s/it, loss=0.5023, grad_norm=1.415, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.85s/it, loss=0.5023, grad_norm=1.415, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.85s/it, loss=0.5239, grad_norm=1.754, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.07s/it, loss=0.5239, grad_norm=1.754, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.07s/it, loss=0.5035, grad_norm=1.432, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:09,  1.44it/s, loss=0.5035, grad_norm=1.432, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:09,  1.44it/s, loss=0.5749, grad_norm=2.145, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.05it/s, loss=0.5749, grad_norm=2.145, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.05it/s, loss=0.4304, grad_norm=1.244, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.79it/s, loss=0.4304, grad_norm=1.244, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:05<00:03,  2.79it/s, loss=0.4639, grad_norm=1.629, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.61it/s, loss=0.4639, grad_norm=1.629, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.61it/s, loss=0.4653, grad_norm=1.459, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.48it/s, loss=0.4653, grad_norm=1.459, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.48it/s, loss=0.4212, grad_norm=1.287, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.32it/s, loss=0.4212, grad_norm=1.287, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.32it/s, loss=0.4266, grad_norm=1.264, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.11it/s, loss=0.4266, grad_norm=1.264, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.11it/s, loss=0.4329, grad_norm=1.466, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.80it/s, loss=0.4329, grad_norm=1.466, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.80it/s, loss=0.3828, grad_norm=1.072, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.40it/s, loss=0.3828, grad_norm=1.072, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.40it/s, loss=0.4151, grad_norm=1.727, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.85it/s, loss=0.4151, grad_norm=1.727, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.85it/s, loss=0.3514, grad_norm=1.014, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.21it/s, loss=0.3514, grad_norm=1.014, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.21it/s, loss=0.3302, grad_norm=1.186, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.46it/s, loss=0.3302, grad_norm=1.186, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:06<00:00,  8.46it/s, loss=0.3495, grad_norm=1.217, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.64it/s, loss=0.3495, grad_norm=1.217, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.64it/s, loss=0.3438, grad_norm=1.931, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.53it/s, loss=0.3438, grad_norm=1.931, lr=0.000010]

Epoch 3/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.4366, Acc: 0.9731, Precision: 0.9624, Recall: 0.9846, F1: 0.9734, AUC: 0.9946
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.3049, grad_norm=1.382, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.13s/it, loss=0.3049, grad_norm=1.382, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.13s/it, loss=0.2776, grad_norm=0.919, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.76s/it, loss=0.2776, grad_norm=0.919, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.76s/it, loss=0.3060, grad_norm=0.920, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.01s/it, loss=0.3060, grad_norm=0.920, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.01s/it, loss=0.2744, grad_norm=1.167, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.53it/s, loss=0.2744, grad_norm=1.167, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.53it/s, loss=0.2717, grad_norm=1.231, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.19it/s, loss=0.2717, grad_norm=1.231, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.19it/s, loss=0.3267, grad_norm=1.781, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.96it/s, loss=0.3267, grad_norm=1.781, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.96it/s, loss=0.2596, grad_norm=0.976, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.79it/s, loss=0.2596, grad_norm=0.976, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.79it/s, loss=0.1993, grad_norm=0.863, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.65it/s, loss=0.1993, grad_norm=0.863, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.65it/s, loss=0.2121, grad_norm=0.800, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.44it/s, loss=0.2121, grad_norm=0.800, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.44it/s, loss=0.2987, grad_norm=1.621, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.14it/s, loss=0.2987, grad_norm=1.621, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.14it/s, loss=0.2651, grad_norm=1.652, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.76it/s, loss=0.2651, grad_norm=1.652, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.76it/s, loss=0.1933, grad_norm=1.236, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.27it/s, loss=0.1933, grad_norm=1.236, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.27it/s, loss=0.1824, grad_norm=0.830, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.66it/s, loss=0.1824, grad_norm=0.830, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.66it/s, loss=0.1784, grad_norm=1.045, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.95it/s, loss=0.1784, grad_norm=1.045, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.95it/s, loss=0.1579, grad_norm=0.818, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.18it/s, loss=0.1579, grad_norm=0.818, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.18it/s, loss=0.1715, grad_norm=0.814, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.31it/s, loss=0.1715, grad_norm=0.814, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.31it/s, loss=0.1671, grad_norm=0.763, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.60it/s, loss=0.1671, grad_norm=0.763, lr=0.000010]

Epoch 4/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.2380, Acc: 1.0000, Precision: 1.0000, Recall: 1.0000, F1: 1.0000, AUC: 1.0000
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.1328, grad_norm=0.627, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.19s/it, loss=0.1328, grad_norm=0.627, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.19s/it, loss=0.1514, grad_norm=0.608, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.1514, grad_norm=0.608, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.1338, grad_norm=0.596, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.1338, grad_norm=0.596, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.1199, grad_norm=0.552, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.51it/s, loss=0.1199, grad_norm=0.552, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.51it/s, loss=0.1586, grad_norm=0.626, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.16it/s, loss=0.1586, grad_norm=0.626, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.16it/s, loss=0.1151, grad_norm=0.971, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.92it/s, loss=0.1151, grad_norm=0.971, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.92it/s, loss=0.1086, grad_norm=0.584, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.76it/s, loss=0.1086, grad_norm=0.584, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.76it/s, loss=0.0813, grad_norm=0.512, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.56it/s, loss=0.0813, grad_norm=0.512, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.56it/s, loss=0.0727, grad_norm=0.437, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.38it/s, loss=0.0727, grad_norm=0.437, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.38it/s, loss=0.0832, grad_norm=0.490, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.13it/s, loss=0.0832, grad_norm=0.490, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.13it/s, loss=0.0593, grad_norm=0.372, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.85it/s, loss=0.0593, grad_norm=0.372, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.85it/s, loss=0.0641, grad_norm=0.466, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.39it/s, loss=0.0641, grad_norm=0.466, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.39it/s, loss=0.0697, grad_norm=0.410, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.80it/s, loss=0.0697, grad_norm=0.410, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.80it/s, loss=0.0873, grad_norm=0.522, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.13it/s, loss=0.0873, grad_norm=0.522, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.13it/s, loss=0.0535, grad_norm=0.642, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.40it/s, loss=0.0535, grad_norm=0.642, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.40it/s, loss=0.0835, grad_norm=0.470, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.63it/s, loss=0.0835, grad_norm=0.470, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.63it/s, loss=0.0604, grad_norm=3.408, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.61it/s, loss=0.0604, grad_norm=3.408, lr=0.000010]

Epoch 5/5 Complete (6.9s) [LR: 0.000005]
Train - Loss: 0.0962, Acc: 1.0000, Precision: 1.0000, Recall: 1.0000, F1: 1.0000, AUC: 1.0000
------------------------------------------------------------
Training curves saved to model\chb01_fold3\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb01_fold3
============================================================
✅ Fold 3 training completed successfully!

============================================================
TRAINING FOLD 4/6
============================================================
Using dataset prefix: chb01_fold4
Loading datasets from: preprocessing\data\chb01_fold4
Saving models to: model\chb01_fold4
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.1879, std=2.3519
Loaded train dataset: 264 samples
  - Spectrogram shape: torch.Size([264, 30, 18, 50, 10])
  - Value range: [-5.0224, 3.8564]
  - Class distribution: tensor([132, 132])
LOOCV Mode (Fold 4): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6968, grad_norm=1.097, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.15s/it, loss=0.6968, grad_norm=1.097, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.15s/it, loss=0.6942, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.6942, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.6923, grad_norm=1.021, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6923, grad_norm=1.021, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6849, grad_norm=1.166, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.6849, grad_norm=1.166, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.6893, grad_norm=1.051, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.18it/s, loss=0.6893, grad_norm=1.051, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.18it/s, loss=0.6751, grad_norm=0.943, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.94it/s, loss=0.6751, grad_norm=0.943, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.94it/s, loss=0.6831, grad_norm=1.046, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.78it/s, loss=0.6831, grad_norm=1.046, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.78it/s, loss=0.6738, grad_norm=1.140, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.66it/s, loss=0.6738, grad_norm=1.140, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.66it/s, loss=0.6913, grad_norm=1.062, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.51it/s, loss=0.6913, grad_norm=1.062, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.51it/s, loss=0.6819, grad_norm=1.154, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.28it/s, loss=0.6819, grad_norm=1.154, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.28it/s, loss=0.6797, grad_norm=1.128, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.97it/s, loss=0.6797, grad_norm=1.128, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.97it/s, loss=0.6683, grad_norm=1.093, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.50it/s, loss=0.6683, grad_norm=1.093, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.50it/s, loss=0.6805, grad_norm=1.033, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.93it/s, loss=0.6805, grad_norm=1.033, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.93it/s, loss=0.6501, grad_norm=1.029, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.33it/s, loss=0.6501, grad_norm=1.029, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.33it/s, loss=0.6743, grad_norm=0.952, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.56it/s, loss=0.6743, grad_norm=0.952, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.56it/s, loss=0.6646, grad_norm=1.021, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.72it/s, loss=0.6646, grad_norm=1.021, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.72it/s, loss=0.6499, grad_norm=1.567, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.62it/s, loss=0.6499, grad_norm=1.567, lr=0.000010]

Epoch 1/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6782, Acc: 0.6553, Precision: 0.6916, Recall: 0.5606, F1: 0.6192, AUC: 0.7163
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6519, grad_norm=1.079, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.15s/it, loss=0.6519, grad_norm=1.079, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.15s/it, loss=0.6479, grad_norm=1.290, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.6479, grad_norm=1.290, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.6499, grad_norm=1.085, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6499, grad_norm=1.085, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6292, grad_norm=1.282, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.48it/s, loss=0.6292, grad_norm=1.282, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.48it/s, loss=0.6231, grad_norm=1.074, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.12it/s, loss=0.6231, grad_norm=1.074, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.12it/s, loss=0.6235, grad_norm=1.147, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.86it/s, loss=0.6235, grad_norm=1.147, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.86it/s, loss=0.6120, grad_norm=1.072, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.68it/s, loss=0.6120, grad_norm=1.072, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.68it/s, loss=0.6001, grad_norm=1.066, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.53it/s, loss=0.6001, grad_norm=1.066, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.53it/s, loss=0.5828, grad_norm=1.182, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.36it/s, loss=0.5828, grad_norm=1.182, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.36it/s, loss=0.6622, grad_norm=1.450, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.15it/s, loss=0.6622, grad_norm=1.450, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.15it/s, loss=0.5789, grad_norm=1.128, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.85it/s, loss=0.5789, grad_norm=1.128, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.85it/s, loss=0.6076, grad_norm=1.125, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.41it/s, loss=0.6076, grad_norm=1.125, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.41it/s, loss=0.6280, grad_norm=1.466, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.85it/s, loss=0.6280, grad_norm=1.466, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.85it/s, loss=0.5891, grad_norm=1.071, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.19it/s, loss=0.5891, grad_norm=1.071, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.19it/s, loss=0.5691, grad_norm=1.155, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.40it/s, loss=0.5691, grad_norm=1.155, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.40it/s, loss=0.5472, grad_norm=1.198, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.63it/s, loss=0.5472, grad_norm=1.198, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.63it/s, loss=0.5897, grad_norm=1.511, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.60it/s, loss=0.5897, grad_norm=1.511, lr=0.000010]

Epoch 2/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6113, Acc: 0.8712, Precision: 0.8182, Recall: 0.9545, F1: 0.8811, AUC: 0.9403
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.5100, grad_norm=1.151, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:05,  4.07s/it, loss=0.5100, grad_norm=1.151, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:05,  4.07s/it, loss=0.5539, grad_norm=1.458, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.74s/it, loss=0.5539, grad_norm=1.458, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.74s/it, loss=0.5203, grad_norm=1.175, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:13,  1.00it/s, loss=0.5203, grad_norm=1.175, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:13,  1.00it/s, loss=0.5224, grad_norm=1.220, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.55it/s, loss=0.5224, grad_norm=1.220, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.55it/s, loss=0.4818, grad_norm=1.245, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.21it/s, loss=0.4818, grad_norm=1.245, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.21it/s, loss=0.4978, grad_norm=1.172, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.98it/s, loss=0.4978, grad_norm=1.172, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.98it/s, loss=0.4552, grad_norm=1.142, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.83it/s, loss=0.4552, grad_norm=1.142, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.83it/s, loss=0.5371, grad_norm=1.751, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.69it/s, loss=0.5371, grad_norm=1.751, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.69it/s, loss=0.4322, grad_norm=1.142, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:04<00:01,  5.54it/s, loss=0.4322, grad_norm=1.142, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.54it/s, loss=0.4728, grad_norm=1.738, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.31it/s, loss=0.4728, grad_norm=1.738, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.31it/s, loss=0.4003, grad_norm=0.971, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.99it/s, loss=0.4003, grad_norm=0.971, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.99it/s, loss=0.4241, grad_norm=1.198, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.56it/s, loss=0.4241, grad_norm=1.198, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.56it/s, loss=0.3818, grad_norm=0.920, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  8.01it/s, loss=0.3818, grad_norm=0.920, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  8.01it/s, loss=0.4280, grad_norm=1.512, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.35it/s, loss=0.4280, grad_norm=1.512, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.35it/s, loss=0.3852, grad_norm=0.914, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.59it/s, loss=0.3852, grad_norm=0.914, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.59it/s, loss=0.3773, grad_norm=1.307, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.75it/s, loss=0.3773, grad_norm=1.307, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.75it/s, loss=0.3386, grad_norm=1.007, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.65it/s, loss=0.3386, grad_norm=1.007, lr=0.000010]

Epoch 3/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.4541, Acc: 0.9659, Precision: 0.9424, Recall: 0.9924, F1: 0.9668, AUC: 0.9940
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.3068, grad_norm=0.957, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.22s/it, loss=0.3068, grad_norm=0.957, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.22s/it, loss=0.3377, grad_norm=0.959, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.80s/it, loss=0.3377, grad_norm=0.959, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.80s/it, loss=0.3016, grad_norm=1.035, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.3016, grad_norm=1.035, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.3392, grad_norm=1.616, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.50it/s, loss=0.3392, grad_norm=1.616, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.50it/s, loss=0.2750, grad_norm=0.936, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.16it/s, loss=0.2750, grad_norm=0.936, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.16it/s, loss=0.3027, grad_norm=1.268, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.92it/s, loss=0.3027, grad_norm=1.268, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.92it/s, loss=0.3049, grad_norm=1.143, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.76it/s, loss=0.3049, grad_norm=1.143, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.76it/s, loss=0.3015, grad_norm=1.393, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.65it/s, loss=0.3015, grad_norm=1.393, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.65it/s, loss=0.2319, grad_norm=0.804, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.51it/s, loss=0.2319, grad_norm=0.804, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.51it/s, loss=0.2218, grad_norm=1.081, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.28it/s, loss=0.2218, grad_norm=1.081, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.28it/s, loss=0.2357, grad_norm=1.035, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.98it/s, loss=0.2357, grad_norm=1.035, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.98it/s, loss=0.1929, grad_norm=0.747, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.54it/s, loss=0.1929, grad_norm=0.747, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.54it/s, loss=0.2049, grad_norm=0.803, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.99it/s, loss=0.2049, grad_norm=0.803, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.99it/s, loss=0.1778, grad_norm=0.687, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.34it/s, loss=0.1778, grad_norm=0.687, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.34it/s, loss=0.1685, grad_norm=0.736, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.54it/s, loss=0.1685, grad_norm=0.736, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.54it/s, loss=0.1795, grad_norm=0.783, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.68it/s, loss=0.1795, grad_norm=0.783, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.68it/s, loss=0.1748, grad_norm=0.712, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.60it/s, loss=0.1748, grad_norm=0.712, lr=0.000010]

Epoch 4/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.2504, Acc: 0.9962, Precision: 0.9925, Recall: 1.0000, F1: 0.9962, AUC: 1.0000
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.2123, grad_norm=0.659, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.24s/it, loss=0.2123, grad_norm=0.659, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.24s/it, loss=0.1259, grad_norm=0.638, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.82s/it, loss=0.1259, grad_norm=0.638, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.82s/it, loss=0.1781, grad_norm=0.669, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.1781, grad_norm=0.669, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.1392, grad_norm=1.280, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.1392, grad_norm=1.280, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.1305, grad_norm=0.595, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.1305, grad_norm=0.595, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.0895, grad_norm=0.453, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.87it/s, loss=0.0895, grad_norm=0.453, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.87it/s, loss=0.1654, grad_norm=3.438, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.70it/s, loss=0.1654, grad_norm=3.438, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.70it/s, loss=0.1488, grad_norm=1.614, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.54it/s, loss=0.1488, grad_norm=1.614, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.54it/s, loss=0.1087, grad_norm=0.784, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.36it/s, loss=0.1087, grad_norm=0.784, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.36it/s, loss=0.1713, grad_norm=1.122, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.11it/s, loss=0.1713, grad_norm=1.122, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.11it/s, loss=0.1690, grad_norm=2.311, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.79it/s, loss=0.1690, grad_norm=2.311, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.79it/s, loss=0.1074, grad_norm=0.626, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.32it/s, loss=0.1074, grad_norm=0.626, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.32it/s, loss=0.0584, grad_norm=0.446, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.75it/s, loss=0.0584, grad_norm=0.446, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.75it/s, loss=0.0864, grad_norm=0.492, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.12it/s, loss=0.0864, grad_norm=0.492, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.12it/s, loss=0.0923, grad_norm=0.655, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.42it/s, loss=0.0923, grad_norm=0.655, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.42it/s, loss=0.0905, grad_norm=0.769, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.61it/s, loss=0.0905, grad_norm=0.769, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.61it/s, loss=0.4917, grad_norm=4.837, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.56it/s, loss=0.4917, grad_norm=4.837, lr=0.000010]

Epoch 5/5 Complete (7.0s) [LR: 0.000005]
Train - Loss: 0.1509, Acc: 0.9962, Precision: 0.9925, Recall: 1.0000, F1: 0.9962, AUC: 0.9947
------------------------------------------------------------
Training curves saved to model\chb01_fold4\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb01_fold4
============================================================
✅ Fold 4 training completed successfully!

============================================================
TRAINING FOLD 5/6
============================================================
Using dataset prefix: chb01_fold5
Loading datasets from: preprocessing\data\chb01_fold5
Saving models to: model\chb01_fold5
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.1944, std=2.3496
Loaded train dataset: 268 samples
  - Spectrogram shape: torch.Size([268, 30, 18, 50, 10])
  - Value range: [-5.0245, 3.8629]
  - Class distribution: tensor([134, 134])
LOOCV Mode (Fold 5): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6926, grad_norm=1.125, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.24s/it, loss=0.6926, grad_norm=1.125, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.24s/it, loss=0.6881, grad_norm=1.095, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.81s/it, loss=0.6881, grad_norm=1.095, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.81s/it, loss=0.6864, grad_norm=1.018, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.6864, grad_norm=1.018, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.6786, grad_norm=1.177, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.6786, grad_norm=1.177, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.6920, grad_norm=1.239, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.14it/s, loss=0.6920, grad_norm=1.239, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.14it/s, loss=0.6846, grad_norm=1.207, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.90it/s, loss=0.6846, grad_norm=1.207, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.90it/s, loss=0.6720, grad_norm=1.036, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.74it/s, loss=0.6720, grad_norm=1.036, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.74it/s, loss=0.6527, grad_norm=1.364, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.60it/s, loss=0.6527, grad_norm=1.364, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.60it/s, loss=0.6991, grad_norm=1.262, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.45it/s, loss=0.6991, grad_norm=1.262, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.45it/s, loss=0.6941, grad_norm=1.422, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.6941, grad_norm=1.422, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.23it/s, loss=0.6879, grad_norm=1.238, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.93it/s, loss=0.6879, grad_norm=1.238, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.93it/s, loss=0.6763, grad_norm=1.411, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.48it/s, loss=0.6763, grad_norm=1.411, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.48it/s, loss=0.6852, grad_norm=1.292, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.77it/s, loss=0.6852, grad_norm=1.292, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.77it/s, loss=0.6788, grad_norm=1.278, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.14it/s, loss=0.6788, grad_norm=1.278, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.14it/s, loss=0.6843, grad_norm=1.216, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.43it/s, loss=0.6843, grad_norm=1.216, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.43it/s, loss=0.6578, grad_norm=1.457, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.67it/s, loss=0.6578, grad_norm=1.457, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.67it/s, loss=0.6436, grad_norm=1.378, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.57it/s, loss=0.6436, grad_norm=1.378, lr=0.000010]

Epoch 1/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6797, Acc: 0.6045, Precision: 0.6750, Recall: 0.4030, F1: 0.5047, AUC: 0.7024
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6589, grad_norm=1.529, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.18s/it, loss=0.6589, grad_norm=1.529, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.18s/it, loss=0.6769, grad_norm=1.648, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.80s/it, loss=0.6769, grad_norm=1.648, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.80s/it, loss=0.6539, grad_norm=1.339, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.6539, grad_norm=1.339, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.6503, grad_norm=1.181, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.47it/s, loss=0.6503, grad_norm=1.181, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.47it/s, loss=0.6262, grad_norm=1.265, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.11it/s, loss=0.6262, grad_norm=1.265, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.11it/s, loss=0.6655, grad_norm=1.253, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.86it/s, loss=0.6655, grad_norm=1.253, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.86it/s, loss=0.6430, grad_norm=1.132, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.68it/s, loss=0.6430, grad_norm=1.132, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.68it/s, loss=0.6282, grad_norm=1.317, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.53it/s, loss=0.6282, grad_norm=1.317, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.53it/s, loss=0.6342, grad_norm=1.318, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.36it/s, loss=0.6342, grad_norm=1.318, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.36it/s, loss=0.6005, grad_norm=1.269, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.13it/s, loss=0.6005, grad_norm=1.269, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.13it/s, loss=0.6236, grad_norm=1.363, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.84it/s, loss=0.6236, grad_norm=1.363, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.84it/s, loss=0.5623, grad_norm=1.289, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.38it/s, loss=0.5623, grad_norm=1.289, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.38it/s, loss=0.5992, grad_norm=1.419, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.81it/s, loss=0.5992, grad_norm=1.419, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.81it/s, loss=0.5677, grad_norm=1.198, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.14it/s, loss=0.5677, grad_norm=1.198, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.14it/s, loss=0.5846, grad_norm=1.239, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.46it/s, loss=0.5846, grad_norm=1.239, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.46it/s, loss=0.6204, grad_norm=1.407, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.61it/s, loss=0.6204, grad_norm=1.407, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.61it/s, loss=0.5833, grad_norm=1.661, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.57it/s, loss=0.5833, grad_norm=1.661, lr=0.000010]

Epoch 2/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6223, Acc: 0.8284, Precision: 0.8056, Recall: 0.8657, F1: 0.8345, AUC: 0.9258
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.5272, grad_norm=1.411, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.18s/it, loss=0.5272, grad_norm=1.411, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.18s/it, loss=0.5360, grad_norm=1.357, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.5360, grad_norm=1.357, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.5708, grad_norm=1.441, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.5708, grad_norm=1.441, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.5312, grad_norm=1.248, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.47it/s, loss=0.5312, grad_norm=1.248, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.47it/s, loss=0.5468, grad_norm=1.394, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.12it/s, loss=0.5468, grad_norm=1.394, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.12it/s, loss=0.5034, grad_norm=1.325, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.87it/s, loss=0.5034, grad_norm=1.325, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.87it/s, loss=0.5291, grad_norm=1.523, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.70it/s, loss=0.5291, grad_norm=1.523, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.70it/s, loss=0.4297, grad_norm=1.128, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.56it/s, loss=0.4297, grad_norm=1.128, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.56it/s, loss=0.5548, grad_norm=1.680, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.43it/s, loss=0.5548, grad_norm=1.680, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.43it/s, loss=0.5321, grad_norm=2.007, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.24it/s, loss=0.5321, grad_norm=2.007, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.24it/s, loss=0.4408, grad_norm=1.231, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.91it/s, loss=0.4408, grad_norm=1.231, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.91it/s, loss=0.4636, grad_norm=1.462, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.49it/s, loss=0.4636, grad_norm=1.462, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.49it/s, loss=0.4248, grad_norm=1.379, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.95it/s, loss=0.4248, grad_norm=1.379, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.95it/s, loss=0.5445, grad_norm=2.411, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.31it/s, loss=0.5445, grad_norm=2.411, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.31it/s, loss=0.4044, grad_norm=1.192, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.58it/s, loss=0.4044, grad_norm=1.192, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.58it/s, loss=0.3332, grad_norm=1.208, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.79it/s, loss=0.3332, grad_norm=1.208, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.79it/s, loss=0.4580, grad_norm=1.926, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.55it/s, loss=0.4580, grad_norm=1.926, lr=0.000010]

Epoch 3/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.4900, Acc: 0.9104, Precision: 0.8929, Recall: 0.9328, F1: 0.9124, AUC: 0.9619
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.3255, grad_norm=0.941, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.29s/it, loss=0.3255, grad_norm=0.941, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:08,  4.29s/it, loss=0.4061, grad_norm=1.610, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.84s/it, loss=0.4061, grad_norm=1.610, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.84s/it, loss=0.3342, grad_norm=1.067, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.05s/it, loss=0.3342, grad_norm=1.067, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.05s/it, loss=0.3296, grad_norm=1.255, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.47it/s, loss=0.3296, grad_norm=1.255, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.47it/s, loss=0.3217, grad_norm=1.185, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.11it/s, loss=0.3217, grad_norm=1.185, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.11it/s, loss=0.3089, grad_norm=1.265, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.86it/s, loss=0.3089, grad_norm=1.265, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.86it/s, loss=0.3204, grad_norm=1.372, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.70it/s, loss=0.3204, grad_norm=1.372, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.70it/s, loss=0.2846, grad_norm=1.032, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.57it/s, loss=0.2846, grad_norm=1.032, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.57it/s, loss=0.2236, grad_norm=0.883, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.43it/s, loss=0.2236, grad_norm=0.883, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.43it/s, loss=0.2594, grad_norm=0.932, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.21it/s, loss=0.2594, grad_norm=0.932, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.21it/s, loss=0.2285, grad_norm=1.023, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.86it/s, loss=0.2285, grad_norm=1.023, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.86it/s, loss=0.1979, grad_norm=0.869, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.44it/s, loss=0.1979, grad_norm=0.869, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.44it/s, loss=0.2184, grad_norm=1.316, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.70it/s, loss=0.2184, grad_norm=1.316, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.70it/s, loss=0.1966, grad_norm=0.856, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.96it/s, loss=0.1966, grad_norm=0.856, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.96it/s, loss=0.1761, grad_norm=0.741, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.23it/s, loss=0.1761, grad_norm=0.741, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.23it/s, loss=0.1710, grad_norm=0.707, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.52it/s, loss=0.1710, grad_norm=0.707, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.52it/s, loss=0.2325, grad_norm=2.042, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.54it/s, loss=0.2325, grad_norm=2.042, lr=0.000010]

Epoch 4/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.2668, Acc: 0.9925, Precision: 0.9853, Recall: 1.0000, F1: 0.9926, AUC: 0.9999
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.2033, grad_norm=1.183, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.17s/it, loss=0.2033, grad_norm=1.183, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.17s/it, loss=0.1740, grad_norm=0.784, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.1740, grad_norm=0.784, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.79s/it, loss=0.1448, grad_norm=0.675, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.1448, grad_norm=0.675, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.1209, grad_norm=0.661, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.48it/s, loss=0.1209, grad_norm=0.661, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.48it/s, loss=0.2786, grad_norm=5.585, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.10it/s, loss=0.2786, grad_norm=5.585, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.10it/s, loss=0.1283, grad_norm=1.060, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.81it/s, loss=0.1283, grad_norm=1.060, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.81it/s, loss=0.1062, grad_norm=0.537, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.58it/s, loss=0.1062, grad_norm=0.537, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.58it/s, loss=0.2876, grad_norm=3.593, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.45it/s, loss=0.2876, grad_norm=3.593, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.45it/s, loss=0.0864, grad_norm=0.462, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.31it/s, loss=0.0864, grad_norm=0.462, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.31it/s, loss=0.1116, grad_norm=0.528, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.11it/s, loss=0.1116, grad_norm=0.528, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.11it/s, loss=0.0854, grad_norm=0.573, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.82it/s, loss=0.0854, grad_norm=0.573, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.82it/s, loss=0.0890, grad_norm=0.932, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.42it/s, loss=0.0890, grad_norm=0.932, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.42it/s, loss=0.0859, grad_norm=0.531, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.89it/s, loss=0.0859, grad_norm=0.531, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.89it/s, loss=0.0748, grad_norm=0.552, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.25it/s, loss=0.0748, grad_norm=0.552, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.25it/s, loss=0.0688, grad_norm=0.461, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.51it/s, loss=0.0688, grad_norm=0.461, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.51it/s, loss=0.0569, grad_norm=0.431, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.73it/s, loss=0.0569, grad_norm=0.431, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.73it/s, loss=0.1549, grad_norm=1.460, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.57it/s, loss=0.1549, grad_norm=1.460, lr=0.000010]

Epoch 5/5 Complete (7.0s) [LR: 0.000005]
Train - Loss: 0.1328, Acc: 0.9888, Precision: 0.9852, Recall: 0.9925, F1: 0.9888, AUC: 0.9993
------------------------------------------------------------
Training curves saved to model\chb01_fold5\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb01_fold5
============================================================
✅ Fold 5 training completed successfully!

============================================================
TRAINING FOLD 6/6
============================================================
Using dataset prefix: chb01_fold6
Loading datasets from: preprocessing\data\chb01_fold6
Saving models to: model\chb01_fold6
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.2131, std=2.3473
Loaded train dataset: 264 samples
  - Spectrogram shape: torch.Size([264, 30, 18, 50, 10])
  - Value range: [-5.0214, 3.8747]
  - Class distribution: tensor([132, 132])
LOOCV Mode (Fold 6): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.7061, grad_norm=1.300, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.22s/it, loss=0.7061, grad_norm=1.300, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.22s/it, loss=0.6952, grad_norm=1.178, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.80s/it, loss=0.6952, grad_norm=1.178, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.80s/it, loss=0.6970, grad_norm=1.236, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.6970, grad_norm=1.236, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.6878, grad_norm=1.239, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.6878, grad_norm=1.239, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.6852, grad_norm=1.181, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.6852, grad_norm=1.181, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.6867, grad_norm=1.203, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.87it/s, loss=0.6867, grad_norm=1.203, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.87it/s, loss=0.6943, grad_norm=0.972, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.69it/s, loss=0.6943, grad_norm=0.972, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.69it/s, loss=0.6786, grad_norm=1.257, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.57it/s, loss=0.6786, grad_norm=1.257, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.57it/s, loss=0.7066, grad_norm=1.283, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.42it/s, loss=0.7066, grad_norm=1.283, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.42it/s, loss=0.6749, grad_norm=1.137, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.16it/s, loss=0.6749, grad_norm=1.137, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.16it/s, loss=0.6841, grad_norm=1.134, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.79it/s, loss=0.6841, grad_norm=1.134, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.79it/s, loss=0.6940, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.39it/s, loss=0.6940, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.39it/s, loss=0.6768, grad_norm=1.138, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.85it/s, loss=0.6768, grad_norm=1.138, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.85it/s, loss=0.6862, grad_norm=1.325, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.26it/s, loss=0.6862, grad_norm=1.325, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.26it/s, loss=0.6707, grad_norm=1.138, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.43it/s, loss=0.6707, grad_norm=1.138, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.43it/s, loss=0.6758, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.59it/s, loss=0.6758, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.59it/s, loss=0.6786, grad_norm=1.637, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.57it/s, loss=0.6786, grad_norm=1.637, lr=0.000010]

Epoch 1/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6870, Acc: 0.5833, Precision: 0.5611, Recall: 0.7652, F1: 0.6474, AUC: 0.6221
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6662, grad_norm=1.198, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.16s/it, loss=0.6662, grad_norm=1.198, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.16s/it, loss=0.6588, grad_norm=1.193, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.6588, grad_norm=1.193, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.6512, grad_norm=1.274, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6512, grad_norm=1.274, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.6593, grad_norm=1.172, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.6593, grad_norm=1.172, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.6441, grad_norm=1.271, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.17it/s, loss=0.6441, grad_norm=1.271, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.17it/s, loss=0.6429, grad_norm=1.429, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.92it/s, loss=0.6429, grad_norm=1.429, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.92it/s, loss=0.6335, grad_norm=1.505, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.76it/s, loss=0.6335, grad_norm=1.505, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.76it/s, loss=0.6367, grad_norm=1.177, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.62it/s, loss=0.6367, grad_norm=1.177, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.62it/s, loss=0.6318, grad_norm=1.245, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.48it/s, loss=0.6318, grad_norm=1.245, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.48it/s, loss=0.6038, grad_norm=1.277, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.24it/s, loss=0.6038, grad_norm=1.277, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.24it/s, loss=0.6119, grad_norm=1.205, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.90it/s, loss=0.6119, grad_norm=1.205, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.90it/s, loss=0.6152, grad_norm=1.405, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.45it/s, loss=0.6152, grad_norm=1.405, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.45it/s, loss=0.5992, grad_norm=1.566, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.90it/s, loss=0.5992, grad_norm=1.566, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.90it/s, loss=0.5746, grad_norm=1.278, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.23it/s, loss=0.5746, grad_norm=1.278, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.23it/s, loss=0.5804, grad_norm=1.546, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.48it/s, loss=0.5804, grad_norm=1.546, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.48it/s, loss=0.5643, grad_norm=1.349, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.71it/s, loss=0.5643, grad_norm=1.349, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.71it/s, loss=0.5765, grad_norm=1.720, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.61it/s, loss=0.5765, grad_norm=1.720, lr=0.000010]

Epoch 2/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6206, Acc: 0.9167, Precision: 0.9044, Recall: 0.9318, F1: 0.9179, AUC: 0.9798
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.5584, grad_norm=1.375, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:10,  4.40s/it, loss=0.5584, grad_norm=1.375, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:10,  4.40s/it, loss=0.5328, grad_norm=1.502, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:28,  1.88s/it, loss=0.5328, grad_norm=1.502, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:28,  1.88s/it, loss=0.5082, grad_norm=1.318, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:15,  1.07s/it, loss=0.5082, grad_norm=1.318, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:15,  1.07s/it, loss=0.4937, grad_norm=1.314, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.45it/s, loss=0.4937, grad_norm=1.314, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.45it/s, loss=0.5019, grad_norm=1.183, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.08it/s, loss=0.5019, grad_norm=1.183, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.08it/s, loss=0.4677, grad_norm=1.177, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.80it/s, loss=0.4677, grad_norm=1.177, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:05<00:03,  2.80it/s, loss=0.4846, grad_norm=1.654, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.62it/s, loss=0.4846, grad_norm=1.654, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.62it/s, loss=0.4837, grad_norm=1.382, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.48it/s, loss=0.4837, grad_norm=1.382, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.48it/s, loss=0.4575, grad_norm=1.209, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.34it/s, loss=0.4575, grad_norm=1.209, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.34it/s, loss=0.3828, grad_norm=1.139, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.12it/s, loss=0.3828, grad_norm=1.139, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.12it/s, loss=0.4350, grad_norm=1.512, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.80it/s, loss=0.4350, grad_norm=1.512, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.80it/s, loss=0.5171, grad_norm=1.982, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.36it/s, loss=0.5171, grad_norm=1.982, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.36it/s, loss=0.4020, grad_norm=1.379, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.79it/s, loss=0.4020, grad_norm=1.379, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.79it/s, loss=0.3500, grad_norm=1.016, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.17it/s, loss=0.3500, grad_norm=1.016, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.17it/s, loss=0.3491, grad_norm=0.979, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.20it/s, loss=0.3491, grad_norm=0.979, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:06<00:00,  8.20it/s, loss=0.3894, grad_norm=1.640, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.23it/s, loss=0.3894, grad_norm=1.640, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.23it/s, loss=0.3228, grad_norm=1.212, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.51it/s, loss=0.3228, grad_norm=1.212, lr=0.000010]

Epoch 3/5 Complete (7.2s) [LR: 0.000010]
Train - Loss: 0.4492, Acc: 0.9583, Precision: 0.9231, Recall: 1.0000, F1: 0.9600, AUC: 0.9963
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.2935, grad_norm=0.969, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.22s/it, loss=0.2935, grad_norm=0.969, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.22s/it, loss=0.3281, grad_norm=1.098, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.80s/it, loss=0.3281, grad_norm=1.098, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.80s/it, loss=0.3623, grad_norm=1.719, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.3623, grad_norm=1.719, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.03s/it, loss=0.3067, grad_norm=1.806, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.48it/s, loss=0.3067, grad_norm=1.806, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.48it/s, loss=0.2599, grad_norm=0.860, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.10it/s, loss=0.2599, grad_norm=0.860, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.10it/s, loss=0.2859, grad_norm=1.032, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.80it/s, loss=0.2859, grad_norm=1.032, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.80it/s, loss=0.2718, grad_norm=1.560, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.56it/s, loss=0.2718, grad_norm=1.560, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.56it/s, loss=0.2101, grad_norm=0.816, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.33it/s, loss=0.2101, grad_norm=0.816, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.33it/s, loss=0.2073, grad_norm=0.874, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.06it/s, loss=0.2073, grad_norm=0.874, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.06it/s, loss=0.2060, grad_norm=0.891, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.85it/s, loss=0.2060, grad_norm=0.891, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.85it/s, loss=0.2265, grad_norm=1.296, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.60it/s, loss=0.2265, grad_norm=1.296, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.60it/s, loss=0.2719, grad_norm=2.107, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.21it/s, loss=0.2719, grad_norm=2.107, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.21it/s, loss=0.1734, grad_norm=0.702, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.73it/s, loss=0.1734, grad_norm=0.702, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.73it/s, loss=0.1798, grad_norm=1.593, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.15it/s, loss=0.1798, grad_norm=1.593, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.15it/s, loss=0.1640, grad_norm=0.746, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.44it/s, loss=0.1640, grad_norm=0.746, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.44it/s, loss=0.1745, grad_norm=0.707, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.66it/s, loss=0.1745, grad_norm=0.707, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  8.66it/s, loss=0.1521, grad_norm=0.872, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.55it/s, loss=0.1521, grad_norm=0.872, lr=0.000010]

Epoch 4/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.2397, Acc: 0.9848, Precision: 0.9776, Recall: 0.9924, F1: 0.9850, AUC: 0.9995
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.1592, grad_norm=0.887, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.16s/it, loss=0.1592, grad_norm=0.887, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:06,  4.16s/it, loss=0.1521, grad_norm=1.106, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.1521, grad_norm=1.106, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:26,  1.78s/it, loss=0.1395, grad_norm=1.515, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.1395, grad_norm=1.515, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.02s/it, loss=0.1150, grad_norm=0.563, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.1150, grad_norm=0.563, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.1208, grad_norm=0.667, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.17it/s, loss=0.1208, grad_norm=0.667, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.17it/s, loss=0.0832, grad_norm=0.518, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.93it/s, loss=0.0832, grad_norm=0.518, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.93it/s, loss=0.1153, grad_norm=0.700, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.77it/s, loss=0.1153, grad_norm=0.700, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.77it/s, loss=0.1533, grad_norm=2.500, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.64it/s, loss=0.1533, grad_norm=2.500, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.64it/s, loss=0.0794, grad_norm=0.486, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.49it/s, loss=0.0794, grad_norm=0.486, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.49it/s, loss=0.0905, grad_norm=0.576, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.27it/s, loss=0.0905, grad_norm=0.576, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.27it/s, loss=0.0726, grad_norm=0.454, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.97it/s, loss=0.0726, grad_norm=0.454, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.97it/s, loss=0.1001, grad_norm=0.893, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.52it/s, loss=0.1001, grad_norm=0.893, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.52it/s, loss=0.0901, grad_norm=0.751, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.96it/s, loss=0.0901, grad_norm=0.751, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.96it/s, loss=0.0602, grad_norm=0.391, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.29it/s, loss=0.0602, grad_norm=0.391, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.29it/s, loss=0.0572, grad_norm=0.573, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.53it/s, loss=0.0572, grad_norm=0.573, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.53it/s, loss=0.0821, grad_norm=0.592, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.71it/s, loss=0.0821, grad_norm=0.592, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.71it/s, loss=0.0451, grad_norm=0.391, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.62it/s, loss=0.0451, grad_norm=0.391, lr=0.000010]

Epoch 5/5 Complete (6.9s) [LR: 0.000005]
Train - Loss: 0.1009, Acc: 1.0000, Precision: 1.0000, Recall: 1.0000, F1: 1.0000, AUC: 1.0000
------------------------------------------------------------
Training curves saved to model\chb01_fold6\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb01_fold6
============================================================
✅ Fold 6 training completed successfully!

============================================================
✅ BATCH TRAINING COMPLETED!
✅ Trained models for 7 folds for patient chb01
============================================================
============================================================
============================================================
BATCH EVALUATION: ALL FOLDS
BATCH EVALUATION: ALL FOLDS
Evaluating 7 folds for patient chb01
Evaluating 7 folds for patient chb01
============================================================
============================================================
Using CUDA: NVIDIA GeForce RTX 3090 Ti
Using CUDA: NVIDIA GeForce RTX 3090 Ti

============================================================
============================================================

EVALUATING FOLD 0/6
EVALUATING FOLD 0/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb01_fold0
Dataset prefix: chb01_fold0
Using test dataset: preprocessing\data\chb01_fold0\test_dataset.h5
Using test dataset: preprocessing\data\chb01_fold0\test_dataset.h5
Loading test dataset from preprocessing\data\chb01_fold0\test_dataset.h5...
Loading test dataset from preprocessing\data\chb01_fold0\test_dataset.h5...
  - Normalization: z-score, mean=-0.2098, std=2.3681
  - Normalization: z-score, mean=-0.2098, std=2.3681
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-4.9787, 3.9108]
  - Value range: [-4.9787, 3.9108]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb01_fold0\epoch_005.pth...
Loading model checkpoint from model\chb01_fold0\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:  33%|############################################################################6                                                                                                                                                         | 1/3 [00:00<00:00,  4.19it/s]Testing:  33%|############################################################################6                                                                                                                                                         | 1/3 [00:00<00:00,  4.19it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00,  9.57it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00,  9.57it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0548
Loss:      0.0548
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        24         0
Actual Interictal        24         0
       Preictal         0        24
       Preictal         0        24

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 24 samples
Pred Interictal (0): 24 samples
Pred Preictal (1):   24 samples
Pred Preictal (1):   24 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        24
    Preictal     1.0000    1.0000    1.0000        24

    accuracy                         1.0000        48
   macro avg     1.0000    1.0000    1.0000        48
weighted avg     1.0000    1.0000    1.0000        48
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        24
    Preictal     1.0000    1.0000    1.0000        24

    accuracy                         1.0000        48
   macro avg     1.0000    1.0000    1.0000        48
weighted avg     1.0000    1.0000    1.0000        48



✅ Results saved to model\chb01_fold0\test_results.json
✅ Results saved to model\chb01_fold0\test_results.json


============================================================
============================================================

EVALUATING FOLD 1/6
EVALUATING FOLD 1/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb01_fold1
Dataset prefix: chb01_fold1
Using test dataset: preprocessing\data\chb01_fold1\test_dataset.h5
Using test dataset: preprocessing\data\chb01_fold1\test_dataset.h5
Loading test dataset from preprocessing\data\chb01_fold1\test_dataset.h5...
Loading test dataset from preprocessing\data\chb01_fold1\test_dataset.h5...
  - Normalization: z-score, mean=-0.2203, std=2.3318
  - Normalization: z-score, mean=-0.2203, std=2.3318
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.0517, 3.6885]
  - Value range: [-5.0517, 3.6885]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb01_fold1\epoch_005.pth...
Loading model checkpoint from model\chb01_fold1\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 28.43it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 28.43it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 28.34it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 28.34it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0429
Loss:      0.0429
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        23         0
Actual Interictal        23         0
       Preictal         0        23
       Preictal         0        23

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 23 samples
Pred Interictal (0): 23 samples
Pred Preictal (1):   23 samples
Pred Preictal (1):   23 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        23
    Preictal     1.0000    1.0000    1.0000        23

    accuracy                         1.0000        46
   macro avg     1.0000    1.0000    1.0000        46
weighted avg     1.0000    1.0000    1.0000        46
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        23
    Preictal     1.0000    1.0000    1.0000        23

    accuracy                         1.0000        46
   macro avg     1.0000    1.0000    1.0000        46
weighted avg     1.0000    1.0000    1.0000        46



✅ Results saved to model\chb01_fold1\test_results.json
✅ Results saved to model\chb01_fold1\test_results.json


============================================================
============================================================

EVALUATING FOLD 2/6
EVALUATING FOLD 2/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb01_fold2
Dataset prefix: chb01_fold2
Using test dataset: preprocessing\data\chb01_fold2\test_dataset.h5
Using test dataset: preprocessing\data\chb01_fold2\test_dataset.h5
Loading test dataset from preprocessing\data\chb01_fold2\test_dataset.h5...
Loading test dataset from preprocessing\data\chb01_fold2\test_dataset.h5...
  - Normalization: z-score, mean=-0.2173, std=2.3152
  - Normalization: z-score, mean=-0.2173, std=2.3152
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.0894, 3.9438]
  - Value range: [-5.0894, 3.9438]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb01_fold2\epoch_005.pth...
Loading model checkpoint from model\chb01_fold2\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.63it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.63it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0365
Loss:      0.0365
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        22         0
Actual Interictal        22         0
       Preictal         0        22
       Preictal         0        22

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 22 samples
Pred Interictal (0): 22 samples
Pred Preictal (1):   22 samples
Pred Preictal (1):   22 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        22
    Preictal     1.0000    1.0000    1.0000        22

    accuracy                         1.0000        44
   macro avg     1.0000    1.0000    1.0000        44
weighted avg     1.0000    1.0000    1.0000        44
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        22
    Preictal     1.0000    1.0000    1.0000        22

    accuracy                         1.0000        44
   macro avg     1.0000    1.0000    1.0000        44
weighted avg     1.0000    1.0000    1.0000        44



✅ Results saved to model\chb01_fold2\test_results.json
✅ Results saved to model\chb01_fold2\test_results.json


============================================================
============================================================

EVALUATING FOLD 3/6
EVALUATING FOLD 3/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb01_fold3
Dataset prefix: chb01_fold3
Using test dataset: preprocessing\data\chb01_fold3\test_dataset.h5
Using test dataset: preprocessing\data\chb01_fold3\test_dataset.h5
Loading test dataset from preprocessing\data\chb01_fold3\test_dataset.h5...
Loading test dataset from preprocessing\data\chb01_fold3\test_dataset.h5...
  - Normalization: z-score, mean=-0.1791, std=2.3158
  - Normalization: z-score, mean=-0.1791, std=2.3158
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.1044, 3.7009]
  - Value range: [-5.1044, 3.7009]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb01_fold3\epoch_005.pth...
Loading model checkpoint from model\chb01_fold3\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.69it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.69it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0272
Loss:      0.0272
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        23         0
Actual Interictal        23         0
       Preictal         0        23
       Preictal         0        23

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 23 samples
Pred Interictal (0): 23 samples
Pred Preictal (1):   23 samples
Pred Preictal (1):   23 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        23
    Preictal     1.0000    1.0000    1.0000        23

    accuracy                         1.0000        46
   macro avg     1.0000    1.0000    1.0000        46
weighted avg     1.0000    1.0000    1.0000        46
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        23
    Preictal     1.0000    1.0000    1.0000        23

    accuracy                         1.0000        46
   macro avg     1.0000    1.0000    1.0000        46
weighted avg     1.0000    1.0000    1.0000        46



✅ Results saved to model\chb01_fold3\test_results.json
✅ Results saved to model\chb01_fold3\test_results.json


============================================================
============================================================

EVALUATING FOLD 4/6
EVALUATING FOLD 4/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb01_fold4
Dataset prefix: chb01_fold4
Using test dataset: preprocessing\data\chb01_fold4\test_dataset.h5
Using test dataset: preprocessing\data\chb01_fold4\test_dataset.h5
Loading test dataset from preprocessing\data\chb01_fold4\test_dataset.h5...
Loading test dataset from preprocessing\data\chb01_fold4\test_dataset.h5...
  - Normalization: z-score, mean=-0.1879, std=2.3519
  - Normalization: z-score, mean=-0.1879, std=2.3519
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.0224, 3.9141]
  - Value range: [-5.0224, 3.9141]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb01_fold4\epoch_005.pth...
Loading model checkpoint from model\chb01_fold4\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.21it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.21it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0487
Loss:      0.0487
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        21         0
Actual Interictal        21         0
       Preictal         0        21
       Preictal         0        21

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 21 samples
Pred Interictal (0): 21 samples
Pred Preictal (1):   21 samples
Pred Preictal (1):   21 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        21
    Preictal     1.0000    1.0000    1.0000        21

    accuracy                         1.0000        42
   macro avg     1.0000    1.0000    1.0000        42
weighted avg     1.0000    1.0000    1.0000        42
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        21
    Preictal     1.0000    1.0000    1.0000        21

    accuracy                         1.0000        42
   macro avg     1.0000    1.0000    1.0000        42
weighted avg     1.0000    1.0000    1.0000        42



✅ Results saved to model\chb01_fold4\test_results.json
✅ Results saved to model\chb01_fold4\test_results.json


============================================================
============================================================

EVALUATING FOLD 5/6
EVALUATING FOLD 5/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb01_fold5
Dataset prefix: chb01_fold5
Using test dataset: preprocessing\data\chb01_fold5\test_dataset.h5
Using test dataset: preprocessing\data\chb01_fold5\test_dataset.h5
Loading test dataset from preprocessing\data\chb01_fold5\test_dataset.h5...
Loading test dataset from preprocessing\data\chb01_fold5\test_dataset.h5...
  - Normalization: z-score, mean=-0.1944, std=2.3496
  - Normalization: z-score, mean=-0.1944, std=2.3496
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.0245, 3.8342]
  - Value range: [-5.0245, 3.8342]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb01_fold5\epoch_005.pth...
Loading model checkpoint from model\chb01_fold5\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.46it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.46it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0354
Loss:      0.0354
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        19         0
Actual Interictal        19         0
       Preictal         0        19
       Preictal         0        19

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 19 samples
Pred Interictal (0): 19 samples
Pred Preictal (1):   19 samples
Pred Preictal (1):   19 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        19
    Preictal     1.0000    1.0000    1.0000        19

    accuracy                         1.0000        38
   macro avg     1.0000    1.0000    1.0000        38
weighted avg     1.0000    1.0000    1.0000        38
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        19
    Preictal     1.0000    1.0000    1.0000        19

    accuracy                         1.0000        38
   macro avg     1.0000    1.0000    1.0000        38
weighted avg     1.0000    1.0000    1.0000        38



✅ Results saved to model\chb01_fold5\test_results.json
✅ Results saved to model\chb01_fold5\test_results.json


============================================================
============================================================

EVALUATING FOLD 6/6
EVALUATING FOLD 6/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb01_fold6
Dataset prefix: chb01_fold6
Using test dataset: preprocessing\data\chb01_fold6\test_dataset.h5
Using test dataset: preprocessing\data\chb01_fold6\test_dataset.h5
Loading test dataset from preprocessing\data\chb01_fold6\test_dataset.h5...
Loading test dataset from preprocessing\data\chb01_fold6\test_dataset.h5...
  - Normalization: z-score, mean=-0.2131, std=2.3473
  - Normalization: z-score, mean=-0.2131, std=2.3473
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.0214, 3.8441]
  - Value range: [-5.0214, 3.8441]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb01_fold6\epoch_005.pth...
Loading model checkpoint from model\chb01_fold6\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.35it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.35it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0374
Loss:      0.0374
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        21         0
Actual Interictal        21         0
       Preictal         0        21
       Preictal         0        21

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 21 samples
Pred Interictal (0): 21 samples
Pred Preictal (1):   21 samples
Pred Preictal (1):   21 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        21
    Preictal     1.0000    1.0000    1.0000        21

    accuracy                         1.0000        42
   macro avg     1.0000    1.0000    1.0000        42
weighted avg     1.0000    1.0000    1.0000        42
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        21
    Preictal     1.0000    1.0000    1.0000        21

    accuracy                         1.0000        42
   macro avg     1.0000    1.0000    1.0000        42
weighted avg     1.0000    1.0000    1.0000        42



✅ Results saved to model\chb01_fold6\test_results.json
✅ Results saved to model\chb01_fold6\test_results.json


============================================================
============================================================

BATCH EVALUATION SUMMARY
BATCH EVALUATION SUMMARY
============================================================
============================================================
Folds evaluated: 7/7
Folds evaluated: 7/7

Mean metrics (across folds):
Mean metrics (across folds):

  Accuracy:  1.0000 (±0.0000)
  Accuracy:  1.0000 (±0.0000)
  Precision: 1.0000 (±0.0000)
  Precision: 1.0000 (±0.0000)
  Recall:    1.0000 (±0.0000)
  Recall:    1.0000 (±0.0000)
  F1 Score:  1.0000 (±0.0000)
  F1 Score:  1.0000 (±0.0000)
  AUC-ROC:   1.0000 (±0.0000)
  AUC-ROC:   1.0000 (±0.0000)

✅ Batch results saved to model\batch_test_results.json
✅ Batch results saved to model\batch_test_results.json

============================================================
============================================================
