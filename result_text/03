============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb03
============================================================

Configuration:
  - Task mode: PREDICTION (preictal vs interictal)
  - LOOCV Mode: ENABLED
  - Sequence length: 30 segments
  - Sequence duration: 150s (2.5 min)
  - Stride: 5 segments (83% overlap)
  - Segment duration: 5s
  - Preictal window: 10 min
  - Interictal buffer: 120 min
  - Channel validation: ENABLED
  - Target channels: 18 channels
============================================================

Extracting sequences from patient chb03...
  Channel validation: 37/38 files valid
Patient chb03: 755 sequences (113 preictal, 642 interictal)

============================================================
PROCESSING FOLD 0/6
============================================================
Output prefix: chb03_fold0
LOOCV Fold 0: Test seizure=0, Train seizures=[1, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb03: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 18 total (9 preictal, 9 interictal)
train: 208 total (104 preictal, 104 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 251.4s (4.2 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 104 preictal, 104 interictal (dropped 0 preictal, 217 interictal)
test: 9 preictal, 9 interictal (dropped 0 preictal, 312 interictal)

Sequences saved to chb03_fold0_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 38
Files with valid channels: 37
Files with invalid channels: 1

Most common missing channels:
  - C3-P3: missing in 1 files
  - C4-P4: missing in 1 files
  - CZ-PZ: missing in 1 files
  - F3-C3: missing in 1 files
  - F4-C4: missing in 1 files

✅ Fold 0 completed successfully!
✅ Sequences saved to chb03_fold0_sequences_prediction.json

============================================================
PROCESSING FOLD 1/6
============================================================
Output prefix: chb03_fold1
LOOCV Fold 1: Test seizure=1, Train seizures=[0, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb03: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 178 total (89 preictal, 89 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 251.4s (4.2 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 89 preictal, 89 interictal (dropped 0 preictal, 232 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 297 interictal)

Sequences saved to chb03_fold1_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 38
Files with valid channels: 37
Files with invalid channels: 1

Most common missing channels:
  - C3-P3: missing in 1 files
  - C4-P4: missing in 1 files
  - CZ-PZ: missing in 1 files
  - F3-C3: missing in 1 files
  - F4-C4: missing in 1 files

✅ Fold 1 completed successfully!
✅ Sequences saved to chb03_fold1_sequences_prediction.json

============================================================
PROCESSING FOLD 2/6
============================================================
Output prefix: chb03_fold2
LOOCV Fold 2: Test seizure=2, Train seizures=[0, 1, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb03: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 36 total (18 preictal, 18 interictal)
train: 190 total (95 preictal, 95 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 251.4s (4.2 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 95 preictal, 95 interictal (dropped 0 preictal, 226 interictal)
test: 18 preictal, 18 interictal (dropped 0 preictal, 303 interictal)

Sequences saved to chb03_fold2_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 38
Files with valid channels: 37
Files with invalid channels: 1

Most common missing channels:
  - C3-P3: missing in 1 files
  - C4-P4: missing in 1 files
  - CZ-PZ: missing in 1 files
  - F3-C3: missing in 1 files
  - F4-C4: missing in 1 files

✅ Fold 2 completed successfully!
✅ Sequences saved to chb03_fold2_sequences_prediction.json

============================================================
PROCESSING FOLD 3/6
============================================================
Output prefix: chb03_fold3
LOOCV Fold 3: Test seizure=3, Train seizures=[0, 1, 2, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb03: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 251.4s (4.2 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 0 preictal, 229 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 300 interictal)

Sequences saved to chb03_fold3_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 38
Files with valid channels: 37
Files with invalid channels: 1

Most common missing channels:
  - C3-P3: missing in 1 files
  - C4-P4: missing in 1 files
  - CZ-PZ: missing in 1 files
  - F3-C3: missing in 1 files
  - F4-C4: missing in 1 files

✅ Fold 3 completed successfully!
✅ Sequences saved to chb03_fold3_sequences_prediction.json

============================================================
PROCESSING FOLD 4/6
============================================================
Output prefix: chb03_fold4
LOOCV Fold 4: Test seizure=4, Train seizures=[0, 1, 2, 3, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb03: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 186 total (93 preictal, 93 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 251.4s (4.2 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 93 preictal, 93 interictal (dropped 0 preictal, 228 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 301 interictal)

Sequences saved to chb03_fold4_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 38
Files with valid channels: 37
Files with invalid channels: 1

Most common missing channels:
  - C3-P3: missing in 1 files
  - C4-P4: missing in 1 files
  - CZ-PZ: missing in 1 files
  - F3-C3: missing in 1 files
  - F4-C4: missing in 1 files

✅ Fold 4 completed successfully!
✅ Sequences saved to chb03_fold4_sequences_prediction.json

============================================================
PROCESSING FOLD 5/6
============================================================
Output prefix: chb03_fold5
LOOCV Fold 5: Test seizure=5, Train seizures=[0, 1, 2, 3, 4, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb03: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 251.4s (4.2 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 0 preictal, 229 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 300 interictal)

Sequences saved to chb03_fold5_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 38
Files with valid channels: 37
Files with invalid channels: 1

Most common missing channels:
  - C3-P3: missing in 1 files
  - C4-P4: missing in 1 files
  - CZ-PZ: missing in 1 files
  - F3-C3: missing in 1 files
  - F4-C4: missing in 1 files

✅ Fold 5 completed successfully!
✅ Sequences saved to chb03_fold5_sequences_prediction.json

============================================================
PROCESSING FOLD 6/6
============================================================
Output prefix: chb03_fold6
LOOCV Fold 6: Test seizure=6, Train seizures=[0, 1, 2, 3, 4, 5]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 547
  - Preictal sequences: 113
  - Interictal sequences: 434
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb03: 547 total (113 preictal, 434 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 321 total (0 preictal, 321 interictal)
train: 226 total (113 preictal, 113 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 251.4s (4.2 min)
Class balance: 113/434 = 0.26

=== SPLIT BALANCING SUMMARY ===
train: 113 preictal, 113 interictal (dropped 0 preictal, 208 interictal)
test: Skipped balancing due to missing class

Sequences saved to chb03_fold6_sequences_prediction.json
File size: 0.91 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 38
Files with valid channels: 37
Files with invalid channels: 1

Most common missing channels:
  - C3-P3: missing in 1 files
  - C4-P4: missing in 1 files
  - CZ-PZ: missing in 1 files
  - F3-C3: missing in 1 files
  - F4-C4: missing in 1 files

✅ Fold 6 completed successfully!
✅ Sequences saved to chb03_fold6_sequences_prediction.json

============================================================
✅ BATCH PROCESSING COMPLETED!
✅ Processed 7 folds for patient chb03
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb03
============================================================

============================================================
PREPROCESSING FOLD 0/6
============================================================
2025-11-19 19:56:46,147 - INFO - ============================================================
2025-11-19 19:56:46,147 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:56:46,147 - INFO - ============================================================
2025-11-19 19:56:46,147 - INFO - Output prefix: chb03_fold0
2025-11-19 19:56:46,147 - INFO - EEG Preprocessor initialized
2025-11-19 19:56:46,147 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:56:46,147 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:56:46,147 - INFO - Segment duration: 5 seconds
2025-11-19 19:56:46,147 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:56:46,147 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:56:46,147 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:56:46,147 - INFO - Loading segments from chb03_fold0_sequences_prediction.json
2025-11-19 19:56:46,161 - INFO - Loaded 226 total sequences
2025-11-19 19:56:46,161 - INFO - Channel validation (from segmentation): 37/38 files valid
2025-11-19 19:56:46,161 - INFO - Files skipped due to missing channels: 1
2025-11-19 19:56:46,161 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:56:46,161 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:56:46,161 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:56:46,161 - INFO - train: 208 sequences (104 preictal, 104 interictal)
2025-11-19 19:56:46,161 - INFO - test: 18 sequences (9 preictal, 9 interictal)
2025-11-19 19:56:46,173 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:56:46,173 - INFO - train: kept 104 preictal and 104 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:56:46,173 - INFO - test: kept 9 preictal and 9 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:56:46,185 - INFO - ============================================================
2025-11-19 19:56:46,185 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:56:46,185 - INFO - ============================================================
2025-11-19 19:56:46,185 - INFO - Processing 208 training samples to compute normalization stats...
2025-11-19 19:56:46,185 - INFO - Processing 208 sequences from 33 unique files
Processing training data:   0%|                    | 0/208 [00:00<?, ?it/s]Processing training data:   0%|            | 1/208 [00:01<06:01,  1.74s/it]Processing training data:   1%|1           | 3/208 [00:03<03:26,  1.01s/it]Processing training data:  16%|#7         | 33/208 [00:04<00:15, 10.97it/s]Processing training data:  17%|#9         | 36/208 [00:04<00:17, 10.05it/s]Processing training data:  27%|##9        | 56/208 [00:05<00:08, 17.67it/s]Processing training data:  33%|###5       | 68/208 [00:05<00:07, 18.27it/s]Processing training data:  34%|###7       | 71/208 [00:06<00:09, 14.68it/s]Processing training data:  36%|###9       | 74/208 [00:07<00:15,  8.74it/s]Processing training data:  38%|####1      | 78/208 [00:09<00:20,  6.20it/s]Processing training data:  39%|####3      | 82/208 [00:10<00:24,  5.20it/s]Processing training data:  42%|####6      | 88/208 [00:10<00:18,  6.35it/s]Processing training data:  52%|#####2    | 109/208 [00:12<00:10,  9.77it/s]Processing training data:  55%|#####4    | 114/208 [00:13<00:11,  8.51it/s]Processing training data:  57%|#####6    | 118/208 [00:13<00:10,  8.39it/s]Processing training data:  67%|######6   | 139/208 [00:14<00:05, 12.48it/s]Processing training data:  70%|######9   | 145/208 [00:15<00:05, 10.88it/s]Processing training data:  72%|#######1  | 149/208 [00:16<00:07,  8.32it/s]Processing training data:  74%|#######3  | 153/208 [00:17<00:07,  6.94it/s]Processing training data:  77%|#######6  | 160/208 [00:18<00:07,  6.63it/s]Processing training data:  80%|#######9  | 166/208 [00:20<00:07,  5.96it/s]Processing training data:  82%|########2 | 171/208 [00:21<00:07,  5.12it/s]Processing training data:  85%|########4 | 176/208 [00:21<00:05,  6.04it/s]Processing training data:  86%|########5 | 178/208 [00:22<00:04,  6.17it/s]Processing training data:  86%|########6 | 179/208 [00:23<00:07,  3.64it/s]Processing training data:  89%|########8 | 185/208 [00:24<00:05,  4.11it/s]Processing training data:  92%|#########1| 191/208 [00:25<00:03,  4.58it/s]Processing training data:  94%|#########4| 196/208 [00:27<00:02,  4.13it/s]Processing training data:  96%|#########6| 200/208 [00:27<00:01,  5.03it/s]Processing training data:  97%|#########6| 201/208 [00:27<00:01,  4.88it/s]Processing training data:  97%|#########7| 202/208 [00:28<00:01,  4.72it/s]Processing training data:  98%|#########7| 203/208 [00:29<00:01,  3.18it/s]Processing training data:  99%|#########9| 206/208 [00:29<00:00,  4.21it/s]Processing training data: 100%|#########9| 207/208 [00:30<00:00,  3.50it/s]Processing training data: 100%|##########| 208/208 [00:30<00:00,  6.91it/s]
2025-11-19 19:57:16,289 - INFO - Computing normalization statistics from training data...
2025-11-19 19:57:16,674 - INFO - Normalization stats computed:
2025-11-19 19:57:16,674 - INFO -   Mean: -0.618304
2025-11-19 19:57:16,674 - INFO -   Std: 2.164905
2025-11-19 19:57:16,674 - INFO -   Saved to: preprocessing\checkpoints\chb03_fold0\normalization_stats.json
2025-11-19 19:57:16,709 - INFO - Applying normalization and saving 208 training sequences...
Normalizing and saving training data:   0%|        | 0/208 [00:00<?, ?it/s]2025-11-19 19:57:16,719 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold0\train_dataset.h5
Normalizing and saving training data:   5%| | 10/208 [00:00<00:13, 14.72it/Normalizing and saving training data:  10%| | 20/208 [00:01<00:12, 15.02it/Normalizing and saving training data:  14%|1| 30/208 [00:01<00:11, 15.24it/Normalizing and saving training data:  19%|1| 40/208 [00:02<00:10, 15.38it/Normalizing and saving training data:  24%|2| 50/208 [00:03<00:10, 15.45it/Normalizing and saving training data:  29%|2| 60/208 [00:03<00:09, 15.49it/Normalizing and saving training data:  34%|3| 70/208 [00:04<00:08, 15.67it/Normalizing and saving training data:  38%|3| 80/208 [00:05<00:08, 15.77it/Normalizing and saving training data:  43%|4| 90/208 [00:05<00:07, 15.80it/Normalizing and saving training data:  48%|4| 100/208 [00:06<00:06, 15.86itNormalizing and saving training data:  53%|5| 110/208 [00:07<00:06, 15.87itNormalizing and saving training data:  58%|5| 120/208 [00:07<00:05, 15.93itNormalizing and saving training data:  62%|6| 130/208 [00:08<00:04, 15.94itNormalizing and saving training data:  67%|6| 140/208 [00:08<00:04, 15.90itNormalizing and saving training data:  72%|7| 150/208 [00:09<00:03, 15.88itNormalizing and saving training data:  77%|7| 160/208 [00:10<00:03, 15.85itNormalizing and saving training data:  82%|8| 170/208 [00:10<00:02, 15.73itNormalizing and saving training data:  87%|8| 180/208 [00:11<00:01, 15.76itNormalizing and saving training data:  91%|9| 190/208 [00:12<00:01, 15.77itNormalizing and saving training data:  96%|9| 200/208 [00:12<00:00, 15.74itNormalizing and saving training data: 100%|#| 208/208 [00:12<00:00, 16.32it
2025-11-19 19:57:29,980 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:57:29,987 - INFO - Loaded normalization statistics:
2025-11-19 19:57:29,987 - INFO -   Mean: -0.618304
2025-11-19 19:57:29,987 - INFO -   Std: 2.164905
2025-11-19 19:57:29,987 - INFO - Split train already completed, skipping
2025-11-19 19:57:29,987 - INFO - Processing test split...
2025-11-19 19:57:29,987 - INFO - Need to process 18/18 sequences for test
2025-11-19 19:57:29,987 - INFO - Processing 18 sequences from 9 unique files
2025-11-19 19:57:29,987 - INFO - Average 2.0 sequences per file
Processing test:   0%|                              | 0/18 [00:00<?, ?it/s]Processing test:   6%|#2                    | 1/18 [00:00<00:07,  2.22it/s]Processing test:  56%|###########6         | 10/18 [00:00<00:00, 16.84it/s]2025-11-19 19:57:30,700 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold0\test_dataset.h5
2025-11-19 19:57:31,304 - INFO - Progress: 218/226 (96.5%) - ETA: 0.0 minutes
Processing test:  72%|###############1     | 13/18 [00:02<00:00,  5.32it/s]Processing test:  83%|#################5   | 15/18 [00:02<00:00,  4.89it/s]Processing test:  89%|##################6  | 16/18 [00:02<00:00,  4.68it/s]Processing test:  94%|###################8 | 17/18 [00:04<00:00,  2.65it/s]Processing test: 100%|#####################| 18/18 [00:04<00:00,  4.35it/s]
2025-11-19 19:57:34,644 - INFO - Validating final datasets...
2025-11-19 19:57:34,652 - INFO - train dataset validation:
2025-11-19 19:57:34,652 - INFO -   - Segments: 208
2025-11-19 19:57:34,652 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:57:34,652 - INFO -   - Classes: 104 preictal, 104 interictal
2025-11-19 19:57:34,652 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:57:34,657 - INFO - test dataset validation:
2025-11-19 19:57:34,658 - INFO -   - Segments: 18
2025-11-19 19:57:34,658 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:57:34,658 - INFO -   - Classes: 9 preictal, 9 interictal
2025-11-19 19:57:34,658 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:57:34,658 - INFO - ============================================================
2025-11-19 19:57:34,658 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:57:34,658 - INFO - Total time: 0.8 minutes
2025-11-19 19:57:34,658 - INFO - Processed segments: 226
2025-11-19 19:57:34,658 - INFO - Average rate: 4.7 segments/second
2025-11-19 19:57:34,658 - INFO - ============================================================
✅ Fold 0 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 1/6
============================================================
2025-11-19 19:57:34,701 - INFO - ============================================================
2025-11-19 19:57:34,701 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:57:34,701 - INFO - ============================================================
2025-11-19 19:57:34,701 - INFO - Output prefix: chb03_fold1
2025-11-19 19:57:34,702 - INFO - EEG Preprocessor initialized
2025-11-19 19:57:34,702 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:57:34,702 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:57:34,702 - INFO - Segment duration: 5 seconds
2025-11-19 19:57:34,702 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:57:34,702 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:57:34,702 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:57:34,702 - INFO - Loading segments from chb03_fold1_sequences_prediction.json
2025-11-19 19:57:34,712 - INFO - Loaded 226 total sequences
2025-11-19 19:57:34,712 - INFO - Channel validation (from segmentation): 37/38 files valid
2025-11-19 19:57:34,712 - INFO - Files skipped due to missing channels: 1
2025-11-19 19:57:34,712 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:57:34,712 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:57:34,712 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:57:34,712 - INFO - train: 178 sequences (89 preictal, 89 interictal)
2025-11-19 19:57:34,712 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-19 19:57:34,724 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:57:34,724 - INFO - train: kept 89 preictal and 89 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:57:34,724 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:57:34,736 - INFO - ============================================================
2025-11-19 19:57:34,736 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:57:34,736 - INFO - ============================================================
2025-11-19 19:57:34,736 - INFO - Processing 178 training samples to compute normalization stats...
2025-11-19 19:57:34,736 - INFO - Processing 178 sequences from 34 unique files
Processing training data:   0%|                    | 0/178 [00:00<?, ?it/s]Processing training data:   1%|            | 1/178 [00:00<02:47,  1.05it/s]Processing training data:   2%|2           | 4/178 [00:02<01:25,  2.05it/s]Processing training data:   6%|6          | 10/178 [00:03<00:46,  3.60it/s]Processing training data:   7%|8          | 13/178 [00:04<00:50,  3.27it/s]Processing training data:  10%|#          | 17/178 [00:05<00:49,  3.23it/s]Processing training data:  12%|#3         | 22/178 [00:06<00:34,  4.48it/s]Processing training data:  24%|##6        | 43/178 [00:06<00:09, 13.73it/s]Processing training data:  26%|##9        | 47/178 [00:07<00:13,  9.49it/s]Processing training data:  28%|###        | 50/178 [00:08<00:18,  6.79it/s]Processing training data:  29%|###2       | 52/178 [00:09<00:20,  6.25it/s]Processing training data:  41%|####5      | 73/178 [00:10<00:09, 11.51it/s]Processing training data:  43%|####6      | 76/178 [00:11<00:12,  8.32it/s]Processing training data:  44%|####8      | 78/178 [00:12<00:17,  5.85it/s]Processing training data:  45%|####9      | 80/178 [00:13<00:23,  4.20it/s]Processing training data:  48%|#####3     | 86/178 [00:14<00:16,  5.48it/s]Processing training data:  60%|#####9    | 106/178 [00:15<00:07,  9.75it/s]Processing training data:  61%|######1   | 109/178 [00:16<00:09,  7.49it/s]Processing training data:  65%|######4   | 115/178 [00:16<00:07,  8.31it/s]Processing training data:  66%|######6   | 118/178 [00:18<00:09,  6.22it/s]Processing training data:  70%|#######   | 125/178 [00:18<00:06,  8.19it/s]Processing training data:  75%|#######5  | 134/178 [00:18<00:03, 11.33it/s]Processing training data:  79%|#######8  | 140/178 [00:20<00:04,  7.81it/s]Processing training data:  80%|########  | 143/178 [00:20<00:04,  7.86it/s]Processing training data:  87%|########7 | 155/178 [00:20<00:01, 12.38it/s]Processing training data:  89%|########8 | 158/178 [00:21<00:02,  9.70it/s]Processing training data:  91%|#########1| 162/178 [00:22<00:01,  9.62it/s]Processing training data:  92%|#########2| 164/178 [00:23<00:02,  5.79it/s]Processing training data:  94%|#########3| 167/178 [00:24<00:02,  5.21it/s]Processing training data:  95%|#########4| 169/178 [00:24<00:01,  4.86it/s]Processing training data:  96%|#########6| 171/178 [00:25<00:02,  3.44it/s]Processing training data:  98%|#########7| 174/178 [00:26<00:00,  4.36it/s]Processing training data:  98%|#########8| 175/178 [00:26<00:00,  4.32it/s]Processing training data:  99%|#########8| 176/178 [00:27<00:00,  3.10it/s]Processing training data: 100%|##########| 178/178 [00:27<00:00,  3.76it/s]Processing training data: 100%|##########| 178/178 [00:27<00:00,  6.48it/s]
2025-11-19 19:58:02,199 - INFO - Computing normalization statistics from training data...
2025-11-19 19:58:02,465 - INFO - Normalization stats computed:
2025-11-19 19:58:02,465 - INFO -   Mean: -0.412561
2025-11-19 19:58:02,465 - INFO -   Std: 2.093266
2025-11-19 19:58:02,465 - INFO -   Saved to: preprocessing\checkpoints\chb03_fold1\normalization_stats.json
2025-11-19 19:58:02,497 - INFO - Applying normalization and saving 178 training sequences...
Normalizing and saving training data:   0%|        | 0/178 [00:00<?, ?it/s]2025-11-19 19:58:02,504 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold1\train_dataset.h5
Normalizing and saving training data:   6%| | 10/178 [00:00<00:10, 15.96it/Normalizing and saving training data:  11%|1| 20/178 [00:01<00:09, 15.88it/Normalizing and saving training data:  17%|1| 30/178 [00:01<00:09, 15.93it/Normalizing and saving training data:  22%|2| 40/178 [00:02<00:08, 15.93it/Normalizing and saving training data:  28%|2| 50/178 [00:03<00:07, 16.00it/Normalizing and saving training data:  34%|3| 60/178 [00:03<00:07, 15.99it/Normalizing and saving training data:  39%|3| 70/178 [00:04<00:06, 15.99it/Normalizing and saving training data:  45%|4| 80/178 [00:05<00:06, 16.01it/Normalizing and saving training data:  51%|5| 90/178 [00:05<00:05, 15.85it/Normalizing and saving training data:  56%|5| 100/178 [00:06<00:04, 15.90itNormalizing and saving training data:  62%|6| 110/178 [00:06<00:04, 15.93itNormalizing and saving training data:  67%|6| 120/178 [00:07<00:03, 15.96itNormalizing and saving training data:  73%|7| 130/178 [00:08<00:03, 16.00itNormalizing and saving training data:  79%|7| 140/178 [00:08<00:02, 15.96itNormalizing and saving training data:  84%|8| 150/178 [00:09<00:01, 15.79itNormalizing and saving training data:  90%|8| 160/178 [00:10<00:01, 15.75itNormalizing and saving training data:  96%|9| 170/178 [00:10<00:00, 15.77itNormalizing and saving training data: 100%|#| 178/178 [00:10<00:00, 16.63it
2025-11-19 19:58:13,716 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:58:13,722 - INFO - Loaded normalization statistics:
2025-11-19 19:58:13,722 - INFO -   Mean: -0.412561
2025-11-19 19:58:13,722 - INFO -   Std: 2.093266
2025-11-19 19:58:13,723 - INFO - Split train already completed, skipping
2025-11-19 19:58:13,723 - INFO - Processing test split...
2025-11-19 19:58:13,723 - INFO - Need to process 48/48 sequences for test
2025-11-19 19:58:13,723 - INFO - Processing 48 sequences from 17 unique files
2025-11-19 19:58:13,723 - INFO - Average 2.8 sequences per file
Processing test:   0%|                              | 0/48 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/48 [00:00<00:14,  3.34it/s]Processing test:   4%|9                     | 2/48 [00:00<00:23,  1.94it/s]2025-11-19 19:58:14,693 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold1\test_dataset.h5
2025-11-19 19:58:16,206 - INFO - Progress: 203/226 (89.8%) - ETA: 0.1 minutes
Processing test:  54%|###########3         | 26/48 [00:03<00:02,  9.05it/s]Processing test:  58%|############2        | 28/48 [00:03<00:02,  8.55it/s]Processing test:  60%|############6        | 29/48 [00:03<00:02,  7.58it/s]Processing test:  62%|#############1       | 30/48 [00:04<00:03,  4.90it/s]Processing test:  69%|##############4      | 33/48 [00:05<00:02,  5.65it/s]Processing test:  71%|##############8      | 34/48 [00:05<00:02,  5.08it/s]Processing test:  73%|###############3     | 35/48 [00:05<00:03,  4.27it/s]2025-11-19 19:58:20,311 - INFO - Progress: 214/226 (94.7%) - ETA: 0.0 minutes
Processing test:  77%|################1    | 37/48 [00:06<00:03,  3.18it/s]Processing test:  79%|################6    | 38/48 [00:08<00:04,  2.10it/s]Processing test:  85%|#################9   | 41/48 [00:08<00:02,  2.93it/s]Processing test:  90%|##################8  | 43/48 [00:08<00:01,  3.44it/s]Processing test:  92%|###################2 | 44/48 [00:09<00:01,  3.37it/s]Processing test:  94%|###################6 | 45/48 [00:10<00:01,  2.03it/s]2025-11-19 19:58:24,952 - INFO - Progress: 224/226 (99.1%) - ETA: 0.0 minutes
Processing test:  98%|####################5| 47/48 [00:11<00:00,  2.08it/s]Processing test: 100%|#####################| 48/48 [00:11<00:00,  2.21it/s]Processing test: 100%|#####################| 48/48 [00:11<00:00,  4.04it/s]
2025-11-19 19:58:25,754 - INFO - Validating final datasets...
2025-11-19 19:58:25,762 - INFO - train dataset validation:
2025-11-19 19:58:25,762 - INFO -   - Segments: 178
2025-11-19 19:58:25,762 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:58:25,762 - INFO -   - Classes: 89 preictal, 89 interictal
2025-11-19 19:58:25,762 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:58:25,768 - INFO - test dataset validation:
2025-11-19 19:58:25,768 - INFO -   - Segments: 48
2025-11-19 19:58:25,768 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:58:25,768 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-19 19:58:25,768 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:58:25,768 - INFO - ============================================================
2025-11-19 19:58:25,768 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:58:25,768 - INFO - Total time: 0.9 minutes
2025-11-19 19:58:25,768 - INFO - Processed segments: 226
2025-11-19 19:58:25,768 - INFO - Average rate: 4.4 segments/second
2025-11-19 19:58:25,768 - INFO - ============================================================
✅ Fold 1 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 2/6
============================================================
2025-11-19 19:58:25,801 - INFO - ============================================================
2025-11-19 19:58:25,801 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:58:25,801 - INFO - ============================================================
2025-11-19 19:58:25,801 - INFO - Output prefix: chb03_fold2
2025-11-19 19:58:25,801 - INFO - EEG Preprocessor initialized
2025-11-19 19:58:25,801 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:58:25,801 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:58:25,801 - INFO - Segment duration: 5 seconds
2025-11-19 19:58:25,801 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:58:25,801 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:58:25,801 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:58:25,801 - INFO - Loading segments from chb03_fold2_sequences_prediction.json
2025-11-19 19:58:25,812 - INFO - Loaded 226 total sequences
2025-11-19 19:58:25,812 - INFO - Channel validation (from segmentation): 37/38 files valid
2025-11-19 19:58:25,812 - INFO - Files skipped due to missing channels: 1
2025-11-19 19:58:25,812 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:58:25,812 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:58:25,812 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:58:25,812 - INFO - train: 190 sequences (95 preictal, 95 interictal)
2025-11-19 19:58:25,812 - INFO - test: 36 sequences (18 preictal, 18 interictal)
2025-11-19 19:58:25,824 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:58:25,825 - INFO - train: kept 95 preictal and 95 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:58:25,825 - INFO - test: kept 18 preictal and 18 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:58:25,837 - INFO - ============================================================
2025-11-19 19:58:25,837 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:58:25,837 - INFO - ============================================================
2025-11-19 19:58:25,837 - INFO - Processing 190 training samples to compute normalization stats...
2025-11-19 19:58:25,837 - INFO - Processing 190 sequences from 33 unique files
Processing training data:   0%|                    | 0/190 [00:00<?, ?it/s]Processing training data:   1%|            | 1/190 [00:00<01:37,  1.93it/s]Processing training data:  13%|#4         | 25/190 [00:01<00:11, 14.77it/s]Processing training data:  15%|#6         | 28/190 [00:02<00:15, 10.60it/s]Processing training data:  17%|#8         | 32/190 [00:03<00:15, 10.08it/s]Processing training data:  27%|###        | 52/190 [00:04<00:10, 13.41it/s]Processing training data:  31%|###3       | 58/190 [00:05<00:12, 10.63it/s]Processing training data:  32%|###4       | 60/190 [00:05<00:14,  9.26it/s]Processing training data:  43%|####6      | 81/190 [00:06<00:08, 13.14it/s]Processing training data:  45%|####9      | 86/190 [00:07<00:09, 10.67it/s]Processing training data:  47%|#####1     | 89/190 [00:08<00:13,  7.54it/s]Processing training data:  51%|#####6     | 97/190 [00:10<00:12,  7.32it/s]Processing training data:  54%|#####3    | 102/190 [00:11<00:14,  6.11it/s]Processing training data:  55%|#####5    | 105/190 [00:12<00:16,  5.14it/s]Processing training data:  57%|#####6    | 108/190 [00:12<00:15,  5.28it/s]Processing training data:  68%|######7   | 129/190 [00:13<00:04, 12.97it/s]Processing training data:  69%|######9   | 132/190 [00:13<00:05, 11.45it/s]Processing training data:  71%|#######   | 134/190 [00:14<00:07,  7.44it/s]Processing training data:  73%|#######2  | 138/190 [00:15<00:06,  8.49it/s]Processing training data:  74%|#######3  | 140/190 [00:16<00:10,  4.82it/s]Processing training data:  76%|#######5  | 144/190 [00:17<00:09,  4.83it/s]Processing training data:  77%|#######7  | 147/190 [00:18<00:09,  4.68it/s]Processing training data:  79%|#######9  | 151/190 [00:18<00:07,  5.55it/s]Processing training data:  81%|########  | 153/190 [00:18<00:06,  5.84it/s]Processing training data:  81%|########1 | 154/190 [00:19<00:06,  5.30it/s]Processing training data:  86%|########5 | 163/190 [00:20<00:04,  5.89it/s]Processing training data:  88%|########8 | 168/190 [00:22<00:04,  4.60it/s]Processing training data:  92%|#########1| 174/190 [00:23<00:03,  4.75it/s]Processing training data:  93%|#########3| 177/190 [00:24<00:02,  4.61it/s]Processing training data:  95%|#########5| 181/190 [00:25<00:02,  4.26it/s]Processing training data:  97%|#########7| 185/190 [00:25<00:00,  5.37it/s]Processing training data:  98%|#########7| 186/190 [00:25<00:00,  5.18it/s]Processing training data:  98%|#########8| 187/190 [00:26<00:00,  3.95it/s]Processing training data:  99%|#########9| 189/190 [00:27<00:00,  3.48it/s]Processing training data: 100%|##########| 190/190 [00:27<00:00,  6.95it/s]
2025-11-19 19:58:53,160 - INFO - Computing normalization statistics from training data...
2025-11-19 19:58:53,443 - INFO - Normalization stats computed:
2025-11-19 19:58:53,444 - INFO -   Mean: -0.543101
2025-11-19 19:58:53,444 - INFO -   Std: 2.155351
2025-11-19 19:58:53,444 - INFO -   Saved to: preprocessing\checkpoints\chb03_fold2\normalization_stats.json
2025-11-19 19:58:53,477 - INFO - Applying normalization and saving 190 training sequences...
Normalizing and saving training data:   0%|        | 0/190 [00:00<?, ?it/s]2025-11-19 19:58:53,483 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold2\train_dataset.h5
Normalizing and saving training data:   5%| | 10/190 [00:00<00:11, 16.27it/Normalizing and saving training data:  11%|1| 20/190 [00:01<00:10, 16.05it/Normalizing and saving training data:  16%|1| 30/190 [00:01<00:10, 15.74it/Normalizing and saving training data:  21%|2| 40/190 [00:02<00:09, 15.60it/Normalizing and saving training data:  26%|2| 50/190 [00:03<00:08, 15.65it/Normalizing and saving training data:  32%|3| 60/190 [00:03<00:08, 15.84it/Normalizing and saving training data:  37%|3| 70/190 [00:04<00:07, 15.93it/Normalizing and saving training data:  42%|4| 80/190 [00:05<00:06, 16.04it/Normalizing and saving training data:  47%|4| 90/190 [00:05<00:06, 15.98it/Normalizing and saving training data:  53%|5| 100/190 [00:06<00:05, 15.99itNormalizing and saving training data:  58%|5| 110/190 [00:06<00:05, 15.86itNormalizing and saving training data:  63%|6| 120/190 [00:07<00:04, 15.88itNormalizing and saving training data:  68%|6| 130/190 [00:08<00:03, 15.88itNormalizing and saving training data:  74%|7| 140/190 [00:08<00:03, 15.81itNormalizing and saving training data:  79%|7| 150/190 [00:09<00:02, 15.89itNormalizing and saving training data:  84%|8| 160/190 [00:10<00:01, 15.86itNormalizing and saving training data:  89%|8| 170/190 [00:10<00:01, 15.93itNormalizing and saving training data:  95%|9| 180/190 [00:11<00:00, 15.98itNormalizing and saving training data: 100%|#| 190/190 [00:11<00:00, 16.02itNormalizing and saving training data: 100%|#| 190/190 [00:11<00:00, 15.91it
2025-11-19 19:59:05,433 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:59:05,440 - INFO - Loaded normalization statistics:
2025-11-19 19:59:05,440 - INFO -   Mean: -0.543101
2025-11-19 19:59:05,440 - INFO -   Std: 2.155351
2025-11-19 19:59:05,440 - INFO - Split train already completed, skipping
2025-11-19 19:59:05,440 - INFO - Processing test split...
2025-11-19 19:59:05,440 - INFO - Need to process 36/36 sequences for test
2025-11-19 19:59:05,440 - INFO - Processing 36 sequences from 16 unique files
2025-11-19 19:59:05,440 - INFO - Average 2.2 sequences per file
Processing test:   0%|                              | 0/36 [00:00<?, ?it/s]Processing test:   3%|6                     | 1/36 [00:00<00:17,  2.04it/s]2025-11-19 19:59:05,932 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold2\test_dataset.h5
2025-11-19 19:59:06,656 - INFO - Progress: 202/226 (89.4%) - ETA: 0.1 minutes
Processing test:  36%|#######5             | 13/36 [00:01<00:02,  8.35it/s]Processing test:  42%|########7            | 15/36 [00:01<00:02,  8.23it/s]Processing test:  44%|#########3           | 16/36 [00:02<00:02,  6.98it/s]Processing test:  61%|############8        | 22/36 [00:02<00:01, 10.80it/s]2025-11-19 19:59:08,546 - INFO - Progress: 212/226 (93.8%) - ETA: 0.0 minutes
Processing test:  67%|##############       | 24/36 [00:03<00:02,  5.96it/s]Processing test:  69%|##############5      | 25/36 [00:03<00:01,  5.64it/s]Processing test:  72%|###############1     | 26/36 [00:03<00:01,  5.32it/s]Processing test:  75%|###############7     | 27/36 [00:04<00:01,  5.07it/s]Processing test:  78%|################3    | 28/36 [00:04<00:01,  4.83it/s]Processing test:  81%|################9    | 29/36 [00:05<00:02,  2.53it/s]Processing test:  86%|##################   | 31/36 [00:05<00:01,  3.44it/s]Processing test:  89%|##################6  | 32/36 [00:05<00:01,  3.55it/s]2025-11-19 19:59:12,044 - INFO - Progress: 222/226 (98.2%) - ETA: 0.0 minutes
Processing test:  92%|###################2 | 33/36 [00:07<00:01,  2.11it/s]Processing test:  97%|####################4| 35/36 [00:07<00:00,  3.00it/s]Processing test: 100%|#####################| 36/36 [00:07<00:00,  3.22it/s]Processing test: 100%|#####################| 36/36 [00:07<00:00,  4.75it/s]
2025-11-19 19:59:13,286 - INFO - Validating final datasets...
2025-11-19 19:59:13,293 - INFO - train dataset validation:
2025-11-19 19:59:13,294 - INFO -   - Segments: 190
2025-11-19 19:59:13,294 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:59:13,294 - INFO -   - Classes: 95 preictal, 95 interictal
2025-11-19 19:59:13,294 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:59:13,299 - INFO - test dataset validation:
2025-11-19 19:59:13,299 - INFO -   - Segments: 36
2025-11-19 19:59:13,299 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:59:13,299 - INFO -   - Classes: 18 preictal, 18 interictal
2025-11-19 19:59:13,299 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:59:13,299 - INFO - ============================================================
2025-11-19 19:59:13,299 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:59:13,299 - INFO - Total time: 0.8 minutes
2025-11-19 19:59:13,299 - INFO - Processed segments: 226
2025-11-19 19:59:13,299 - INFO - Average rate: 4.8 segments/second
2025-11-19 19:59:13,299 - INFO - ============================================================
✅ Fold 2 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 3/6
============================================================
2025-11-19 19:59:13,335 - INFO - ============================================================
2025-11-19 19:59:13,335 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:59:13,335 - INFO - ============================================================
2025-11-19 19:59:13,335 - INFO - Output prefix: chb03_fold3
2025-11-19 19:59:13,335 - INFO - EEG Preprocessor initialized
2025-11-19 19:59:13,335 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:59:13,335 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:59:13,335 - INFO - Segment duration: 5 seconds
2025-11-19 19:59:13,335 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:59:13,336 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:59:13,336 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:59:13,336 - INFO - Loading segments from chb03_fold3_sequences_prediction.json
2025-11-19 19:59:13,345 - INFO - Loaded 226 total sequences
2025-11-19 19:59:13,345 - INFO - Channel validation (from segmentation): 37/38 files valid
2025-11-19 19:59:13,345 - INFO - Files skipped due to missing channels: 1
2025-11-19 19:59:13,346 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:59:13,346 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:59:13,346 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:59:13,346 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-19 19:59:13,346 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-19 19:59:13,358 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:59:13,358 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:59:13,358 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:59:13,370 - INFO - ============================================================
2025-11-19 19:59:13,370 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:59:13,370 - INFO - ============================================================
2025-11-19 19:59:13,370 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-19 19:59:13,370 - INFO - Processing 184 sequences from 33 unique files
Processing training data:   0%|                    | 0/184 [00:00<?, ?it/s]Processing training data:   1%|            | 1/184 [00:00<02:57,  1.03it/s]Processing training data:   2%|2           | 4/184 [00:02<01:32,  1.96it/s]Processing training data:   4%|5           | 8/184 [00:03<01:00,  2.91it/s]Processing training data:   6%|6          | 11/184 [00:03<00:46,  3.69it/s]Processing training data:  17%|#9         | 32/184 [00:04<00:14, 10.54it/s]Processing training data:  21%|##2        | 38/184 [00:05<00:13, 10.92it/s]Processing training data:  32%|###4       | 58/184 [00:05<00:07, 16.82it/s]Processing training data:  34%|###7       | 62/184 [00:06<00:10, 11.11it/s]Processing training data:  36%|###9       | 66/184 [00:08<00:15,  7.65it/s]Processing training data:  38%|####1      | 70/184 [00:09<00:17,  6.60it/s]Processing training data:  40%|####4      | 74/184 [00:09<00:15,  7.12it/s]Processing training data:  47%|#####1     | 86/184 [00:11<00:13,  7.14it/s]Processing training data:  63%|######3   | 116/184 [00:12<00:05, 12.33it/s]Processing training data:  65%|######5   | 120/184 [00:13<00:05, 12.35it/s]Processing training data:  70%|#######   | 129/184 [00:14<00:05, 10.67it/s]Processing training data:  72%|#######1  | 132/184 [00:15<00:06,  8.07it/s]Processing training data:  73%|#######3  | 135/184 [00:16<00:07,  6.48it/s]Processing training data:  75%|#######5  | 138/184 [00:17<00:08,  5.30it/s]Processing training data:  77%|#######7  | 142/184 [00:19<00:09,  4.24it/s]Processing training data:  80%|#######9  | 147/184 [00:20<00:08,  4.20it/s]Processing training data:  82%|########1 | 150/184 [00:21<00:08,  3.95it/s]Processing training data:  84%|########4 | 155/184 [00:21<00:06,  4.69it/s]Processing training data:  86%|########6 | 159/184 [00:22<00:04,  5.05it/s]Processing training data:  88%|########7 | 161/184 [00:22<00:04,  5.38it/s]Processing training data:  88%|########8 | 162/184 [00:23<00:05,  3.96it/s]Processing training data:  91%|######### | 167/184 [00:24<00:03,  4.99it/s]Processing training data:  92%|#########1| 169/184 [00:25<00:03,  3.82it/s]Processing training data:  94%|#########4| 173/184 [00:25<00:02,  4.74it/s]Processing training data:  95%|#########5| 175/184 [00:26<00:01,  4.92it/s]Processing training data:  96%|#########6| 177/184 [00:27<00:01,  3.53it/s]Processing training data:  99%|#########8| 182/184 [00:27<00:00,  5.50it/s]Processing training data:  99%|#########9| 183/184 [00:27<00:00,  5.29it/s]Processing training data: 100%|##########| 184/184 [00:27<00:00,  5.09it/s]Processing training data: 100%|##########| 184/184 [00:27<00:00,  6.58it/s]
2025-11-19 19:59:41,342 - INFO - Computing normalization statistics from training data...
2025-11-19 19:59:41,615 - INFO - Normalization stats computed:
2025-11-19 19:59:41,615 - INFO -   Mean: -0.580241
2025-11-19 19:59:41,615 - INFO -   Std: 2.194767
2025-11-19 19:59:41,615 - INFO -   Saved to: preprocessing\checkpoints\chb03_fold3\normalization_stats.json
2025-11-19 19:59:41,643 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|        | 0/184 [00:00<?, ?it/s]2025-11-19 19:59:41,650 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold3\train_dataset.h5
Normalizing and saving training data:   5%| | 10/184 [00:00<00:10, 16.44it/Normalizing and saving training data:  11%|1| 20/184 [00:01<00:10, 16.19it/Normalizing and saving training data:  16%|1| 30/184 [00:01<00:09, 16.26it/Normalizing and saving training data:  22%|2| 40/184 [00:02<00:08, 16.27it/Normalizing and saving training data:  27%|2| 50/184 [00:03<00:08, 16.14it/Normalizing and saving training data:  33%|3| 60/184 [00:03<00:07, 16.12it/Normalizing and saving training data:  38%|3| 70/184 [00:04<00:07, 16.08it/Normalizing and saving training data:  43%|4| 80/184 [00:04<00:06, 16.08it/Normalizing and saving training data:  49%|4| 90/184 [00:05<00:05, 16.10it/Normalizing and saving training data:  54%|5| 100/184 [00:06<00:05, 16.11itNormalizing and saving training data:  60%|5| 110/184 [00:06<00:04, 16.07itNormalizing and saving training data:  65%|6| 120/184 [00:07<00:03, 16.14itNormalizing and saving training data:  71%|7| 130/184 [00:08<00:03, 16.14itNormalizing and saving training data:  76%|7| 140/184 [00:08<00:02, 16.07itNormalizing and saving training data:  82%|8| 150/184 [00:09<00:02, 15.97itNormalizing and saving training data:  87%|8| 160/184 [00:09<00:01, 15.93itNormalizing and saving training data:  92%|9| 170/184 [00:10<00:00, 15.93itNormalizing and saving training data:  98%|9| 180/184 [00:11<00:00, 15.90itNormalizing and saving training data: 100%|#| 184/184 [00:11<00:00, 16.41it
2025-11-19 19:59:53,128 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:59:53,135 - INFO - Loaded normalization statistics:
2025-11-19 19:59:53,135 - INFO -   Mean: -0.580241
2025-11-19 19:59:53,135 - INFO -   Std: 2.194767
2025-11-19 19:59:53,135 - INFO - Split train already completed, skipping
2025-11-19 19:59:53,136 - INFO - Processing test split...
2025-11-19 19:59:53,136 - INFO - Need to process 42/42 sequences for test
2025-11-19 19:59:53,136 - INFO - Processing 42 sequences from 16 unique files
2025-11-19 19:59:53,136 - INFO - Average 2.6 sequences per file
Processing test:   0%|                              | 0/42 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/42 [00:00<00:25,  1.63it/s]2025-11-19 19:59:53,751 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold3\test_dataset.h5
2025-11-19 19:59:55,007 - INFO - Progress: 205/226 (90.7%) - ETA: 0.1 minutes
Processing test:  52%|###########          | 22/42 [00:02<00:02,  9.94it/s]Processing test:  57%|############         | 24/42 [00:02<00:01,  9.55it/s]Processing test:  60%|############5        | 25/42 [00:03<00:02,  7.37it/s]Processing test:  64%|#############5       | 27/42 [00:03<00:02,  7.41it/s]Processing test:  67%|##############       | 28/42 [00:03<00:02,  6.72it/s]Processing test:  69%|##############5      | 29/42 [00:03<00:02,  6.05it/s]Processing test:  71%|###############      | 30/42 [00:04<00:02,  5.41it/s]Processing test:  74%|###############5     | 31/42 [00:04<00:02,  4.89it/s]2025-11-19 19:59:58,295 - INFO - Progress: 215/226 (95.1%) - ETA: 0.0 minutes
Processing test:  76%|################     | 32/42 [00:06<00:05,  1.96it/s]Processing test:  83%|#################5   | 35/42 [00:07<00:03,  2.00it/s]Processing test:  88%|##################5  | 37/42 [00:08<00:02,  1.92it/s]Processing test:  93%|###################5 | 39/42 [00:08<00:01,  2.51it/s]Processing test:  95%|#################### | 40/42 [00:09<00:00,  2.70it/s]Processing test:  98%|####################5| 41/42 [00:09<00:00,  2.90it/s]2025-11-19 20:00:03,222 - INFO - Progress: 225/226 (99.6%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 42/42 [00:10<00:00,  2.16it/s]Processing test: 100%|#####################| 42/42 [00:10<00:00,  4.06it/s]
2025-11-19 20:00:03,568 - INFO - Validating final datasets...
2025-11-19 20:00:03,576 - INFO - train dataset validation:
2025-11-19 20:00:03,576 - INFO -   - Segments: 184
2025-11-19 20:00:03,576 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 20:00:03,576 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-19 20:00:03,576 - INFO -   - Balance: 50.0% preictal
2025-11-19 20:00:03,581 - INFO - test dataset validation:
2025-11-19 20:00:03,581 - INFO -   - Segments: 42
2025-11-19 20:00:03,581 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 20:00:03,581 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-19 20:00:03,581 - INFO -   - Balance: 50.0% preictal
2025-11-19 20:00:03,581 - INFO - ============================================================
2025-11-19 20:00:03,581 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 20:00:03,581 - INFO - Total time: 0.8 minutes
2025-11-19 20:00:03,581 - INFO - Processed segments: 226
2025-11-19 20:00:03,581 - INFO - Average rate: 4.5 segments/second
2025-11-19 20:00:03,581 - INFO - ============================================================
✅ Fold 3 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 4/6
============================================================
2025-11-19 20:00:03,609 - INFO - ============================================================
2025-11-19 20:00:03,609 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 20:00:03,609 - INFO - ============================================================
2025-11-19 20:00:03,609 - INFO - Output prefix: chb03_fold4
2025-11-19 20:00:03,609 - INFO - EEG Preprocessor initialized
2025-11-19 20:00:03,609 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 20:00:03,609 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 20:00:03,609 - INFO - Segment duration: 5 seconds
2025-11-19 20:00:03,609 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 20:00:03,609 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 20:00:03,609 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 20:00:03,610 - INFO - Loading segments from chb03_fold4_sequences_prediction.json
2025-11-19 20:00:03,620 - INFO - Loaded 226 total sequences
2025-11-19 20:00:03,620 - INFO - Channel validation (from segmentation): 37/38 files valid
2025-11-19 20:00:03,620 - INFO - Files skipped due to missing channels: 1
2025-11-19 20:00:03,620 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 20:00:03,620 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 20:00:03,620 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 20:00:03,620 - INFO - train: 186 sequences (93 preictal, 93 interictal)
2025-11-19 20:00:03,620 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-19 20:00:03,632 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 20:00:03,632 - INFO - train: kept 93 preictal and 93 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 20:00:03,632 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 20:00:03,644 - INFO - ============================================================
2025-11-19 20:00:03,644 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 20:00:03,644 - INFO - ============================================================
2025-11-19 20:00:03,644 - INFO - Processing 186 training samples to compute normalization stats...
2025-11-19 20:00:03,644 - INFO - Processing 186 sequences from 33 unique files
Processing training data:   0%|                    | 0/186 [00:00<?, ?it/s]Processing training data:   1%|            | 1/186 [00:00<01:30,  2.03it/s]Processing training data:  12%|#3         | 22/186 [00:01<00:13, 11.75it/s]Processing training data:  28%|###        | 52/186 [00:02<00:05, 23.97it/s]Processing training data:  30%|###2       | 55/186 [00:03<00:07, 17.71it/s]Processing training data:  31%|###4       | 58/186 [00:03<00:08, 14.72it/s]Processing training data:  42%|####6      | 79/186 [00:04<00:04, 24.28it/s]Processing training data:  49%|#####3     | 91/186 [00:05<00:05, 17.32it/s]Processing training data:  52%|#####7     | 97/186 [00:06<00:07, 12.55it/s]Processing training data:  55%|#####5    | 103/186 [00:07<00:08,  9.80it/s]Processing training data:  59%|#####8    | 109/186 [00:08<00:09,  8.47it/s]Processing training data:  61%|######1   | 114/186 [00:09<00:08,  8.11it/s]Processing training data:  62%|######2   | 116/186 [00:10<00:11,  5.95it/s]Processing training data:  66%|######5   | 122/186 [00:11<00:09,  6.43it/s]Processing training data:  67%|######6   | 124/186 [00:12<00:12,  4.91it/s]Processing training data:  68%|######7   | 126/186 [00:13<00:16,  3.74it/s]Processing training data:  69%|######9   | 129/186 [00:14<00:17,  3.26it/s]Processing training data:  73%|#######2  | 135/186 [00:15<00:12,  4.08it/s]Processing training data:  75%|#######5  | 140/186 [00:16<00:09,  4.78it/s]Processing training data:  77%|#######7  | 144/186 [00:17<00:09,  4.47it/s]Processing training data:  78%|#######8  | 146/186 [00:18<00:10,  3.97it/s]Processing training data:  80%|#######9  | 148/186 [00:18<00:10,  3.64it/s]Processing training data:  81%|########  | 150/186 [00:19<00:09,  4.00it/s]Processing training data:  85%|########5 | 159/186 [00:19<00:03,  7.18it/s]Processing training data:  87%|########6 | 161/186 [00:20<00:03,  6.63it/s]Processing training data:  88%|########8 | 164/186 [00:20<00:03,  6.72it/s]Processing training data:  89%|########9 | 166/186 [00:21<00:03,  5.35it/s]Processing training data:  90%|######### | 168/186 [00:21<00:04,  4.44it/s]Processing training data:  93%|#########3| 173/186 [00:22<00:02,  5.93it/s]Processing training data:  94%|#########4| 175/186 [00:22<00:01,  6.28it/s]Processing training data:  95%|#########4| 176/186 [00:23<00:01,  5.22it/s]Processing training data:  96%|#########5| 178/186 [00:24<00:02,  3.41it/s]Processing training data:  98%|#########7| 182/186 [00:25<00:01,  3.21it/s]Processing training data: 100%|##########| 186/186 [00:25<00:00,  4.64it/s]Processing training data: 100%|##########| 186/186 [00:25<00:00,  7.20it/s]
2025-11-19 20:00:29,472 - INFO - Computing normalization statistics from training data...
2025-11-19 20:00:29,769 - INFO - Normalization stats computed:
2025-11-19 20:00:29,769 - INFO -   Mean: -0.593189
2025-11-19 20:00:29,769 - INFO -   Std: 2.170350
2025-11-19 20:00:29,769 - INFO -   Saved to: preprocessing\checkpoints\chb03_fold4\normalization_stats.json
2025-11-19 20:00:29,789 - INFO - Applying normalization and saving 186 training sequences...
Normalizing and saving training data:   0%|        | 0/186 [00:00<?, ?it/s]2025-11-19 20:00:29,796 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold4\train_dataset.h5
Normalizing and saving training data:   5%| | 10/186 [00:00<00:11, 15.73it/Normalizing and saving training data:  11%|1| 20/186 [00:01<00:10, 15.83it/Normalizing and saving training data:  16%|1| 30/186 [00:01<00:09, 15.92it/Normalizing and saving training data:  22%|2| 40/186 [00:02<00:09, 15.93it/Normalizing and saving training data:  27%|2| 50/186 [00:03<00:08, 15.99it/Normalizing and saving training data:  32%|3| 60/186 [00:03<00:07, 15.80it/Normalizing and saving training data:  38%|3| 70/186 [00:04<00:07, 15.69it/Normalizing and saving training data:  43%|4| 80/186 [00:05<00:06, 15.80it/Normalizing and saving training data:  48%|4| 90/186 [00:05<00:06, 15.57it/Normalizing and saving training data:  54%|5| 100/186 [00:06<00:05, 15.38itNormalizing and saving training data:  59%|5| 110/186 [00:07<00:04, 15.46itNormalizing and saving training data:  65%|6| 120/186 [00:07<00:04, 15.63itNormalizing and saving training data:  70%|6| 130/186 [00:08<00:03, 15.76itNormalizing and saving training data:  75%|7| 140/186 [00:08<00:02, 15.73itNormalizing and saving training data:  81%|8| 150/186 [00:09<00:02, 15.40itNormalizing and saving training data:  86%|8| 160/186 [00:10<00:01, 15.31itNormalizing and saving training data:  91%|9| 170/186 [00:10<00:01, 15.37itNormalizing and saving training data:  97%|9| 180/186 [00:11<00:00, 15.50itNormalizing and saving training data: 100%|#| 186/186 [00:11<00:00, 16.13it
2025-11-19 20:00:41,717 - INFO - Training data processing completed during stats computation phase
2025-11-19 20:00:41,724 - INFO - Loaded normalization statistics:
2025-11-19 20:00:41,725 - INFO -   Mean: -0.593189
2025-11-19 20:00:41,725 - INFO -   Std: 2.170350
2025-11-19 20:00:41,725 - INFO - Split train already completed, skipping
2025-11-19 20:00:41,725 - INFO - Processing test split...
2025-11-19 20:00:41,725 - INFO - Need to process 40/40 sequences for test
2025-11-19 20:00:41,725 - INFO - Processing 40 sequences from 13 unique files
2025-11-19 20:00:41,725 - INFO - Average 3.1 sequences per file
Processing test:   0%|                              | 0/40 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/40 [00:00<00:19,  2.02it/s]2025-11-19 20:00:42,221 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold4\test_dataset.h5
2025-11-19 20:00:43,413 - INFO - Progress: 206/226 (91.2%) - ETA: 0.1 minutes
Processing test:  52%|###########          | 21/40 [00:02<00:01, 10.03it/s]Processing test:  57%|############         | 23/40 [00:02<00:01,  9.76it/s]Processing test:  60%|############6        | 24/40 [00:03<00:02,  5.67it/s]Processing test:  65%|#############6       | 26/40 [00:04<00:03,  4.07it/s]Processing test:  72%|###############2     | 29/40 [00:04<00:02,  4.99it/s]Processing test:  75%|###############7     | 30/40 [00:05<00:02,  3.54it/s]2025-11-19 20:00:48,133 - INFO - Progress: 217/226 (96.0%) - ETA: 0.0 minutes
Processing test:  80%|################8    | 32/40 [00:07<00:03,  2.65it/s]Processing test:  85%|#################8   | 34/40 [00:07<00:02,  2.76it/s]Processing test:  90%|##################9  | 36/40 [00:08<00:01,  3.00it/s]Processing test:  95%|###################9 | 38/40 [00:08<00:00,  3.63it/s]Processing test:  98%|####################4| 39/40 [00:08<00:00,  3.68it/s]Processing test: 100%|#####################| 40/40 [00:08<00:00,  3.76it/s]Processing test: 100%|#####################| 40/40 [00:08<00:00,  4.47it/s]
2025-11-19 20:00:51,252 - INFO - Validating final datasets...
2025-11-19 20:00:51,260 - INFO - train dataset validation:
2025-11-19 20:00:51,260 - INFO -   - Segments: 186
2025-11-19 20:00:51,260 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 20:00:51,260 - INFO -   - Classes: 93 preictal, 93 interictal
2025-11-19 20:00:51,260 - INFO -   - Balance: 50.0% preictal
2025-11-19 20:00:51,266 - INFO - test dataset validation:
2025-11-19 20:00:51,266 - INFO -   - Segments: 40
2025-11-19 20:00:51,266 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 20:00:51,266 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-19 20:00:51,266 - INFO -   - Balance: 50.0% preictal
2025-11-19 20:00:51,266 - INFO - ============================================================
2025-11-19 20:00:51,266 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 20:00:51,266 - INFO - Total time: 0.8 minutes
2025-11-19 20:00:51,266 - INFO - Processed segments: 226
2025-11-19 20:00:51,266 - INFO - Average rate: 4.7 segments/second
2025-11-19 20:00:51,266 - INFO - ============================================================
✅ Fold 4 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 5/6
============================================================
2025-11-19 20:00:51,294 - INFO - ============================================================
2025-11-19 20:00:51,294 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 20:00:51,294 - INFO - ============================================================
2025-11-19 20:00:51,294 - INFO - Output prefix: chb03_fold5
2025-11-19 20:00:51,294 - INFO - EEG Preprocessor initialized
2025-11-19 20:00:51,295 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 20:00:51,295 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 20:00:51,295 - INFO - Segment duration: 5 seconds
2025-11-19 20:00:51,295 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 20:00:51,295 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 20:00:51,295 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 20:00:51,295 - INFO - Loading segments from chb03_fold5_sequences_prediction.json
2025-11-19 20:00:51,308 - INFO - Loaded 226 total sequences
2025-11-19 20:00:51,308 - INFO - Channel validation (from segmentation): 37/38 files valid
2025-11-19 20:00:51,309 - INFO - Files skipped due to missing channels: 1
2025-11-19 20:00:51,309 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 20:00:51,309 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 20:00:51,309 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 20:00:51,309 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-19 20:00:51,309 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-19 20:00:51,321 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 20:00:51,321 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 20:00:51,321 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 20:00:51,333 - INFO - ============================================================
2025-11-19 20:00:51,333 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 20:00:51,333 - INFO - ============================================================
2025-11-19 20:00:51,333 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-19 20:00:51,333 - INFO - Processing 184 sequences from 34 unique files
Processing training data:   0%|                    | 0/184 [00:00<?, ?it/s]Processing training data:   1%|            | 1/184 [00:00<01:27,  2.09it/s]Processing training data:  11%|#2         | 21/184 [00:00<00:05, 31.52it/s]Processing training data:  16%|#7         | 30/184 [00:01<00:05, 27.73it/s]Processing training data:  23%|##5        | 42/184 [00:01<00:06, 22.26it/s]Processing training data:  24%|##6        | 45/184 [00:03<00:14,  9.34it/s]Processing training data:  41%|####4      | 75/184 [00:04<00:05, 19.49it/s]Processing training data:  42%|####6      | 78/184 [00:04<00:06, 16.40it/s]Processing training data:  54%|#####9     | 99/184 [00:05<00:04, 17.01it/s]Processing training data:  55%|#####4    | 101/184 [00:07<00:07, 10.43it/s]Processing training data:  57%|#####6    | 104/184 [00:08<00:10,  7.49it/s]Processing training data:  61%|######    | 112/184 [00:09<00:10,  6.76it/s]Processing training data:  64%|######3   | 117/184 [00:10<00:09,  6.82it/s]Processing training data:  65%|######5   | 120/184 [00:11<00:11,  5.59it/s]Processing training data:  68%|######7   | 125/184 [00:12<00:11,  5.03it/s]Processing training data:  69%|######9   | 127/184 [00:13<00:11,  4.89it/s]Processing training data:  70%|#######   | 129/184 [00:14<00:12,  4.25it/s]Processing training data:  72%|#######2  | 133/184 [00:15<00:14,  3.64it/s]Processing training data:  74%|#######4  | 137/184 [00:16<00:12,  3.65it/s]Processing training data:  77%|#######7  | 142/184 [00:17<00:08,  4.84it/s]Processing training data:  79%|#######8  | 145/184 [00:18<00:08,  4.41it/s]Processing training data:  81%|########  | 149/184 [00:18<00:06,  5.14it/s]Processing training data:  83%|########2 | 152/184 [00:19<00:05,  5.36it/s]Processing training data:  84%|########3 | 154/184 [00:20<00:08,  3.59it/s]Processing training data:  87%|########6 | 160/184 [00:20<00:04,  5.18it/s]Processing training data:  88%|########8 | 162/184 [00:21<00:05,  4.09it/s]Processing training data:  90%|########9 | 165/184 [00:22<00:04,  4.13it/s]Processing training data:  91%|######### | 167/184 [00:23<00:05,  3.16it/s]Processing training data:  92%|#########2| 170/184 [00:24<00:04,  3.23it/s]Processing training data:  95%|#########4| 174/184 [00:25<00:02,  3.46it/s]Processing training data:  96%|#########5| 176/184 [00:26<00:02,  2.96it/s]Processing training data:  97%|#########6| 178/184 [00:26<00:01,  3.47it/s]Processing training data:  97%|#########7| 179/184 [00:28<00:02,  2.39it/s]Processing training data:  99%|#########9| 183/184 [00:28<00:00,  3.79it/s]Processing training data: 100%|##########| 184/184 [00:28<00:00,  3.72it/s]Processing training data: 100%|##########| 184/184 [00:28<00:00,  6.40it/s]
2025-11-19 20:01:20,082 - INFO - Computing normalization statistics from training data...
2025-11-19 20:01:20,388 - INFO - Normalization stats computed:
2025-11-19 20:01:20,388 - INFO -   Mean: -0.584911
2025-11-19 20:01:20,388 - INFO -   Std: 2.166184
2025-11-19 20:01:20,388 - INFO -   Saved to: preprocessing\checkpoints\chb03_fold5\normalization_stats.json
2025-11-19 20:01:20,412 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|        | 0/184 [00:00<?, ?it/s]2025-11-19 20:01:20,420 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold5\train_dataset.h5
Normalizing and saving training data:   5%| | 10/184 [00:00<00:10, 15.86it/Normalizing and saving training data:  11%|1| 20/184 [00:01<00:10, 15.74it/Normalizing and saving training data:  16%|1| 30/184 [00:01<00:09, 15.82it/Normalizing and saving training data:  22%|2| 40/184 [00:02<00:09, 15.83it/Normalizing and saving training data:  27%|2| 50/184 [00:03<00:08, 15.85it/Normalizing and saving training data:  33%|3| 60/184 [00:03<00:07, 15.92it/Normalizing and saving training data:  38%|3| 70/184 [00:04<00:07, 15.90it/Normalizing and saving training data:  43%|4| 80/184 [00:05<00:06, 15.93it/Normalizing and saving training data:  49%|4| 90/184 [00:05<00:05, 15.93it/Normalizing and saving training data:  54%|5| 100/184 [00:06<00:05, 15.92itNormalizing and saving training data:  60%|5| 110/184 [00:06<00:04, 15.91itNormalizing and saving training data:  65%|6| 120/184 [00:07<00:04, 15.96itNormalizing and saving training data:  71%|7| 130/184 [00:08<00:03, 15.94itNormalizing and saving training data:  76%|7| 140/184 [00:08<00:02, 15.85itNormalizing and saving training data:  82%|8| 150/184 [00:09<00:02, 15.73itNormalizing and saving training data:  87%|8| 160/184 [00:10<00:01, 15.44itNormalizing and saving training data:  92%|9| 170/184 [00:10<00:00, 15.52itNormalizing and saving training data:  98%|9| 180/184 [00:11<00:00, 15.61itNormalizing and saving training data: 100%|#| 184/184 [00:11<00:00, 16.13it
2025-11-19 20:01:32,094 - INFO - Training data processing completed during stats computation phase
2025-11-19 20:01:32,101 - INFO - Loaded normalization statistics:
2025-11-19 20:01:32,101 - INFO -   Mean: -0.584911
2025-11-19 20:01:32,101 - INFO -   Std: 2.166184
2025-11-19 20:01:32,101 - INFO - Split train already completed, skipping
2025-11-19 20:01:32,101 - INFO - Processing test split...
2025-11-19 20:01:32,101 - INFO - Need to process 42/42 sequences for test
2025-11-19 20:01:32,101 - INFO - Processing 42 sequences from 17 unique files
2025-11-19 20:01:32,101 - INFO - Average 2.5 sequences per file
Processing test:   0%|                              | 0/42 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/42 [00:00<00:23,  1.72it/s]2025-11-19 20:01:32,684 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold5\test_dataset.h5
2025-11-19 20:01:33,948 - INFO - Progress: 205/226 (90.7%) - ETA: 0.1 minutes
Processing test:  52%|###########          | 22/42 [00:02<00:01, 10.97it/s]Processing test:  55%|###########5         | 23/42 [00:02<00:02,  9.18it/s]Processing test:  60%|############5        | 25/42 [00:02<00:01,  8.92it/s]Processing test:  62%|#############        | 26/42 [00:03<00:02,  5.62it/s]Processing test:  69%|##############5      | 29/42 [00:03<00:02,  6.35it/s]Processing test:  71%|###############      | 30/42 [00:04<00:02,  5.59it/s]Processing test:  74%|###############5     | 31/42 [00:04<00:02,  5.02it/s]2025-11-19 20:01:37,299 - INFO - Progress: 215/226 (95.1%) - ETA: 0.0 minutes
Processing test:  76%|################     | 32/42 [00:05<00:03,  3.09it/s]Processing test:  79%|################5    | 33/42 [00:05<00:02,  3.23it/s]Processing test:  81%|#################    | 34/42 [00:05<00:02,  3.38it/s]Processing test:  83%|#################5   | 35/42 [00:06<00:02,  3.30it/s]Processing test:  86%|##################   | 36/42 [00:06<00:02,  2.72it/s]Processing test:  90%|###################  | 38/42 [00:07<00:01,  3.51it/s]Processing test:  93%|###################5 | 39/42 [00:08<00:01,  2.03it/s]Processing test:  98%|####################5| 41/42 [00:08<00:00,  2.79it/s]2025-11-19 20:01:41,407 - INFO - Progress: 225/226 (99.6%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 42/42 [00:09<00:00,  2.10it/s]Processing test: 100%|#####################| 42/42 [00:09<00:00,  4.38it/s]
2025-11-19 20:01:41,778 - INFO - Validating final datasets...
2025-11-19 20:01:41,786 - INFO - train dataset validation:
2025-11-19 20:01:41,786 - INFO -   - Segments: 184
2025-11-19 20:01:41,786 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 20:01:41,786 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-19 20:01:41,786 - INFO -   - Balance: 50.0% preictal
2025-11-19 20:01:41,792 - INFO - test dataset validation:
2025-11-19 20:01:41,792 - INFO -   - Segments: 42
2025-11-19 20:01:41,792 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 20:01:41,792 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-19 20:01:41,792 - INFO -   - Balance: 50.0% preictal
2025-11-19 20:01:41,792 - INFO - ============================================================
2025-11-19 20:01:41,792 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 20:01:41,792 - INFO - Total time: 0.8 minutes
2025-11-19 20:01:41,792 - INFO - Processed segments: 226
2025-11-19 20:01:41,792 - INFO - Average rate: 4.5 segments/second
2025-11-19 20:01:41,792 - INFO - ============================================================
✅ Fold 5 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 6/6
============================================================
2025-11-19 20:01:41,821 - INFO - ============================================================
2025-11-19 20:01:41,822 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 20:01:41,822 - INFO - ============================================================
2025-11-19 20:01:41,822 - INFO - Output prefix: chb03_fold6
2025-11-19 20:01:41,822 - INFO - EEG Preprocessor initialized
2025-11-19 20:01:41,822 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 20:01:41,822 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 20:01:41,822 - INFO - Segment duration: 5 seconds
2025-11-19 20:01:41,822 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 20:01:41,822 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 20:01:41,822 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 20:01:41,822 - INFO - Loading segments from chb03_fold6_sequences_prediction.json
2025-11-19 20:01:41,840 - INFO - Loaded 547 total sequences
2025-11-19 20:01:41,840 - INFO - Channel validation (from segmentation): 37/38 files valid
2025-11-19 20:01:41,840 - INFO - Files skipped due to missing channels: 1
2025-11-19 20:01:41,840 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 20:01:41,840 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 20:01:41,840 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 20:01:41,840 - INFO - train: 226 sequences (113 preictal, 113 interictal)
2025-11-19 20:01:41,840 - INFO - test: 321 sequences (0 preictal, 321 interictal)
2025-11-19 20:01:41,869 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 20:01:41,869 - INFO - train: kept 113 preictal and 113 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 20:01:41,869 - WARNING - test: Skipped balancing due to missing class
2025-11-19 20:01:41,897 - INFO - ============================================================
2025-11-19 20:01:41,897 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 20:01:41,897 - INFO - ============================================================
2025-11-19 20:01:41,897 - INFO - Processing 226 training samples to compute normalization stats...
2025-11-19 20:01:41,897 - INFO - Processing 226 sequences from 35 unique files
Processing training data:   0%|                    | 0/226 [00:00<?, ?it/s]Processing training data:   0%|            | 1/226 [00:00<01:17,  2.89it/s]Processing training data:   4%|4          | 10/226 [00:00<00:16, 13.00it/s]Processing training data:  13%|#4         | 30/226 [00:01<00:11, 16.97it/s]Processing training data:  15%|#7         | 35/226 [00:02<00:11, 16.21it/s]Processing training data:  21%|##2        | 47/226 [00:02<00:10, 16.70it/s]Processing training data:  22%|##3        | 49/226 [00:03<00:13, 13.19it/s]Processing training data:  31%|###4       | 70/226 [00:04<00:09, 17.12it/s]Processing training data:  32%|###5       | 73/226 [00:04<00:10, 14.35it/s]Processing training data:  42%|####5      | 94/226 [00:05<00:08, 16.36it/s]Processing training data:  44%|####8      | 99/226 [00:07<00:11, 11.29it/s]Processing training data:  47%|####6     | 106/226 [00:07<00:10, 11.65it/s]Processing training data:  48%|####7     | 108/226 [00:09<00:16,  7.20it/s]Processing training data:  51%|#####     | 115/226 [00:10<00:17,  6.44it/s]Processing training data:  53%|#####3    | 120/226 [00:11<00:18,  5.59it/s]Processing training data:  56%|#####6    | 127/226 [00:12<00:14,  6.62it/s]Processing training data:  58%|#####7    | 130/226 [00:13<00:18,  5.10it/s]Processing training data:  60%|#####9    | 135/226 [00:14<00:16,  5.58it/s]Processing training data:  62%|######1   | 139/226 [00:14<00:14,  6.06it/s]Processing training data:  63%|######2   | 142/226 [00:16<00:20,  4.11it/s]Processing training data:  76%|#######6  | 172/226 [00:18<00:05,  9.97it/s]Processing training data:  80%|#######9  | 180/226 [00:19<00:05,  8.87it/s]Processing training data:  81%|########1 | 184/226 [00:20<00:05,  7.60it/s]Processing training data:  85%|########4 | 191/226 [00:21<00:04,  7.44it/s]Processing training data:  86%|########5 | 194/226 [00:22<00:05,  5.72it/s]Processing training data:  88%|########8 | 200/226 [00:23<00:04,  5.73it/s]Processing training data:  91%|######### | 205/226 [00:24<00:03,  6.71it/s]Processing training data:  92%|#########2| 208/226 [00:24<00:02,  6.23it/s]Processing training data:  94%|#########3| 212/226 [00:24<00:01,  7.37it/s]Processing training data:  94%|#########4| 213/226 [00:25<00:02,  5.11it/s]Processing training data:  96%|#########5| 216/226 [00:27<00:02,  3.92it/s]Processing training data:  97%|#########7| 220/226 [00:27<00:01,  5.01it/s]Processing training data:  98%|#########8| 222/226 [00:27<00:00,  4.79it/s]Processing training data:  99%|#########9| 224/226 [00:28<00:00,  5.25it/s]Processing training data: 100%|#########9| 225/226 [00:28<00:00,  5.10it/s]Processing training data: 100%|##########| 226/226 [00:28<00:00,  4.93it/s]Processing training data: 100%|##########| 226/226 [00:28<00:00,  7.89it/s]
2025-11-19 20:02:10,526 - INFO - Computing normalization statistics from training data...
2025-11-19 20:02:10,860 - INFO - Normalization stats computed:
2025-11-19 20:02:10,860 - INFO -   Mean: -0.507442
2025-11-19 20:02:10,860 - INFO -   Std: 2.160880
2025-11-19 20:02:10,860 - INFO -   Saved to: preprocessing\checkpoints\chb03_fold6\normalization_stats.json
2025-11-19 20:02:10,911 - INFO - Applying normalization and saving 226 training sequences...
Normalizing and saving training data:   0%|        | 0/226 [00:00<?, ?it/s]2025-11-19 20:02:10,918 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold6\train_dataset.h5
Normalizing and saving training data:   4%| | 10/226 [00:00<00:13, 15.87it/Normalizing and saving training data:   9%| | 20/226 [00:01<00:13, 14.96it/Normalizing and saving training data:  13%|1| 30/226 [00:02<00:13, 14.84it/Normalizing and saving training data:  18%|1| 40/226 [00:02<00:12, 15.12it/Normalizing and saving training data:  22%|2| 50/226 [00:03<00:11, 14.73it/Normalizing and saving training data:  27%|2| 60/226 [00:04<00:11, 14.45it/Normalizing and saving training data:  31%|3| 70/226 [00:04<00:10, 14.55it/Normalizing and saving training data:  35%|3| 80/226 [00:05<00:09, 14.91it/Normalizing and saving training data:  40%|3| 90/226 [00:06<00:08, 15.14it/Normalizing and saving training data:  44%|4| 100/226 [00:06<00:08, 15.33itNormalizing and saving training data:  49%|4| 110/226 [00:07<00:07, 15.43itNormalizing and saving training data:  53%|5| 120/226 [00:07<00:06, 15.51itNormalizing and saving training data:  58%|5| 130/226 [00:08<00:06, 15.52itNormalizing and saving training data:  62%|6| 140/226 [00:09<00:05, 15.57itNormalizing and saving training data:  66%|6| 150/226 [00:09<00:04, 15.59itNormalizing and saving training data:  71%|7| 160/226 [00:10<00:04, 15.38itNormalizing and saving training data:  75%|7| 170/226 [00:11<00:03, 15.30itNormalizing and saving training data:  80%|7| 180/226 [00:11<00:03, 15.32itNormalizing and saving training data:  84%|8| 190/226 [00:12<00:02, 15.30itNormalizing and saving training data:  88%|8| 200/226 [00:13<00:01, 15.27itNormalizing and saving training data:  93%|9| 210/226 [00:13<00:01, 15.30itNormalizing and saving training data:  97%|9| 220/226 [00:14<00:00, 15.20itNormalizing and saving training data: 100%|#| 226/226 [00:14<00:00, 15.61it
2025-11-19 20:02:25,827 - INFO - Training data processing completed during stats computation phase
2025-11-19 20:02:25,834 - INFO - Loaded normalization statistics:
2025-11-19 20:02:25,834 - INFO -   Mean: -0.507442
2025-11-19 20:02:25,834 - INFO -   Std: 2.160880
2025-11-19 20:02:25,834 - INFO - Split train already completed, skipping
2025-11-19 20:02:25,834 - INFO - Processing test split...
2025-11-19 20:02:25,834 - INFO - Need to process 321/321 sequences for test
2025-11-19 20:02:25,834 - INFO - Processing 321 sequences from 29 unique files
2025-11-19 20:02:25,834 - INFO - Average 11.1 sequences per file
Processing test:   0%|                             | 0/321 [00:00<?, ?it/s]Processing test:   0%|                     | 1/321 [00:01<05:46,  1.08s/it]Processing test:   2%|5                    | 8/321 [00:02<01:34,  3.32it/s]2025-11-19 20:02:28,476 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb03_fold6\test_dataset.h5
2025-11-19 20:02:29,502 - INFO - Progress: 243/547 (44.4%) - ETA: 1.0 minutes
Processing test:   6%|#1                  | 18/321 [00:05<01:23,  3.63it/s]2025-11-19 20:02:32,118 - INFO - Progress: 259/547 (47.3%) - ETA: 0.9 minutes
Processing test:  11%|##1                 | 34/321 [00:06<00:50,  5.73it/s]Processing test:  12%|##4                 | 39/321 [00:08<00:57,  4.90it/s]2025-11-19 20:02:35,355 - INFO - Progress: 275/547 (50.3%) - ETA: 0.9 minutes
Processing test:  16%|###1                | 50/321 [00:10<00:57,  4.74it/s]2025-11-19 20:02:37,483 - INFO - Progress: 286/547 (52.3%) - ETA: 0.8 minutes
Processing test:  19%|###8                | 61/321 [00:13<00:52,  4.95it/s]2025-11-19 20:02:39,593 - INFO - Progress: 298/547 (54.5%) - ETA: 0.8 minutes
Processing test:  23%|####5               | 73/321 [00:15<00:49,  5.05it/s]2025-11-19 20:02:41,964 - INFO - Progress: 311/547 (56.9%) - ETA: 0.8 minutes
Processing test:  27%|#####3              | 86/321 [00:17<00:44,  5.23it/s]2025-11-19 20:02:44,166 - INFO - Progress: 322/547 (58.9%) - ETA: 0.7 minutes
Processing test:  30%|######              | 97/321 [00:19<00:43,  5.14it/s]Processing test:  33%|######2            | 106/321 [00:21<00:39,  5.44it/s]2025-11-19 20:02:48,295 - INFO - Progress: 342/547 (62.5%) - ETA: 0.7 minutes
Processing test:  36%|######9            | 117/321 [00:23<00:41,  4.90it/s]2025-11-19 20:02:50,559 - INFO - Progress: 354/547 (64.7%) - ETA: 0.6 minutes
Processing test:  40%|#######6           | 129/321 [00:26<00:37,  5.08it/s]2025-11-19 20:02:52,760 - INFO - Progress: 366/547 (66.9%) - ETA: 0.6 minutes
Processing test:  44%|########3          | 141/321 [00:28<00:35,  5.10it/s]2025-11-19 20:02:55,157 - INFO - Progress: 379/547 (69.3%) - ETA: 0.5 minutes
Processing test:  48%|#########1         | 154/321 [00:30<00:31,  5.26it/s]2025-11-19 20:02:57,595 - INFO - Progress: 394/547 (72.0%) - ETA: 0.5 minutes
Processing test:  53%|##########         | 169/321 [00:33<00:27,  5.60it/s]2025-11-19 20:02:59,949 - INFO - Progress: 409/547 (74.8%) - ETA: 0.4 minutes
Processing test:  57%|##########8        | 184/321 [00:35<00:23,  5.76it/s]2025-11-19 20:03:02,213 - INFO - Progress: 421/547 (77.0%) - ETA: 0.4 minutes
Processing test:  61%|###########6       | 196/321 [00:37<00:21,  5.70it/s]2025-11-19 20:03:04,265 - INFO - Progress: 431/547 (78.8%) - ETA: 0.4 minutes
Processing test:  64%|############1      | 206/321 [00:39<00:21,  5.41it/s]2025-11-19 20:03:06,663 - INFO - Progress: 445/547 (81.4%) - ETA: 0.3 minutes
Processing test:  69%|#############      | 220/321 [00:42<00:18,  5.45it/s]2025-11-19 20:03:08,979 - INFO - Progress: 455/547 (83.2%) - ETA: 0.3 minutes
Processing test:  72%|#############6     | 230/321 [00:44<00:17,  5.16it/s]Processing test:  74%|##############1    | 239/321 [00:46<00:15,  5.31it/s]2025-11-19 20:03:13,435 - INFO - Progress: 477/547 (87.2%) - ETA: 0.2 minutes
Processing test:  79%|##############9    | 252/321 [00:49<00:13,  5.08it/s]2025-11-19 20:03:15,557 - INFO - Progress: 488/547 (89.2%) - ETA: 0.2 minutes
Processing test:  82%|###############5   | 263/321 [00:51<00:11,  4.94it/s]2025-11-19 20:03:17,886 - INFO - Progress: 498/547 (91.0%) - ETA: 0.2 minutes
Processing test:  85%|################1  | 273/321 [00:53<00:09,  5.03it/s]Processing test:  87%|################5  | 279/321 [00:54<00:08,  5.01it/s]2025-11-19 20:03:21,427 - INFO - Progress: 515/547 (94.1%) - ETA: 0.1 minutes
Processing test:  90%|#################1 | 290/321 [00:57<00:06,  4.80it/s]2025-11-19 20:03:23,488 - INFO - Progress: 525/547 (96.0%) - ETA: 0.1 minutes
Processing test:  93%|#################7 | 300/321 [00:59<00:04,  4.73it/s]2025-11-19 20:03:25,725 - INFO - Progress: 536/547 (98.0%) - ETA: 0.0 minutes
Processing test:  97%|##################4| 311/321 [01:01<00:02,  4.85it/s]2025-11-19 20:03:27,870 - INFO - Progress: 547/547 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|###################| 321/321 [01:02<00:00,  5.17it/s]
2025-11-19 20:03:27,898 - INFO - Validating final datasets...
2025-11-19 20:03:27,906 - INFO - train dataset validation:
2025-11-19 20:03:27,906 - INFO -   - Segments: 226
2025-11-19 20:03:27,906 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 20:03:27,906 - INFO -   - Classes: 113 preictal, 113 interictal
2025-11-19 20:03:27,906 - INFO -   - Balance: 50.0% preictal
2025-11-19 20:03:27,911 - INFO - test dataset validation:
2025-11-19 20:03:27,911 - INFO -   - Segments: 321
2025-11-19 20:03:27,911 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 20:03:27,911 - INFO -   - Classes: 0 preictal, 321 interictal
2025-11-19 20:03:27,911 - INFO -   - Balance: 0.0% preictal
2025-11-19 20:03:27,911 - INFO - ============================================================
2025-11-19 20:03:27,912 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 20:03:27,912 - INFO - Total time: 1.8 minutes
2025-11-19 20:03:27,912 - INFO - Processed segments: 547
2025-11-19 20:03:27,912 - INFO - Average rate: 5.2 segments/second
2025-11-19 20:03:27,912 - INFO - ============================================================
✅ Fold 6 preprocessing completed successfully!

============================================================
✅ BATCH PREPROCESSING COMPLETED!
✅ Processed 7 folds for patient chb03
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb03
============================================================

============================================================
TRAINING FOLD 0/6
============================================================
Using dataset prefix: chb03_fold0
Loading datasets from: preprocessing\data\chb03_fold0
Saving models to: model\chb03_fold0
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.6183, std=2.1649
Loaded train dataset: 208 samples
  - Spectrogram shape: torch.Size([208, 30, 18, 50, 10])
  - Value range: [-5.2574, 4.4383]
  - Class distribution: tensor([104, 104])
LOOCV Mode (Fold 0): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/13 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/13 [00:04<?, ?it/s, loss=0.7170, grad_norm=1.Training Epoch 1/5:   8%| | 1/13 [00:04<00:51,  4.32s/it, loss=0.7170, gradTraining Epoch 1/5:   8%| | 1/13 [00:04<00:51,  4.32s/it, loss=0.6909, gradTraining Epoch 1/5:  15%|1| 2/13 [00:04<00:20,  1.84s/it, loss=0.6909, gradTraining Epoch 1/5:  15%|1| 2/13 [00:04<00:20,  1.84s/it, loss=0.6995, gradTraining Epoch 1/5:  23%|2| 3/13 [00:04<00:10,  1.05s/it, loss=0.6995, gradTraining Epoch 1/5:  23%|2| 3/13 [00:04<00:10,  1.05s/it, loss=0.6860, gradTraining Epoch 1/5:  31%|3| 4/13 [00:04<00:06,  1.47it/s, loss=0.6860, gradTraining Epoch 1/5:  31%|3| 4/13 [00:04<00:06,  1.47it/s, loss=0.6955, gradTraining Epoch 1/5:  38%|3| 5/13 [00:04<00:03,  2.11it/s, loss=0.6955, gradTraining Epoch 1/5:  38%|3| 5/13 [00:04<00:03,  2.11it/s, loss=0.6960, gradTraining Epoch 1/5:  46%|4| 6/13 [00:04<00:02,  2.84it/s, loss=0.6960, gradTraining Epoch 1/5:  46%|4| 6/13 [00:04<00:02,  2.84it/s, loss=0.7071, gradTraining Epoch 1/5:  54%|5| 7/13 [00:04<00:01,  3.61it/s, loss=0.7071, gradTraining Epoch 1/5:  54%|5| 7/13 [00:05<00:01,  3.61it/s, loss=0.6774, gradTraining Epoch 1/5:  62%|6| 8/13 [00:05<00:01,  4.40it/s, loss=0.6774, gradTraining Epoch 1/5:  62%|6| 8/13 [00:05<00:01,  4.40it/s, loss=0.7049, gradTraining Epoch 1/5:  69%|6| 9/13 [00:05<00:00,  5.25it/s, loss=0.7049, gradTraining Epoch 1/5:  69%|6| 9/13 [00:05<00:00,  5.25it/s, loss=0.6822, gradTraining Epoch 1/5:  77%|7| 10/13 [00:05<00:00,  6.02it/s, loss=0.6822, graTraining Epoch 1/5:  77%|7| 10/13 [00:05<00:00,  6.02it/s, loss=0.6948, graTraining Epoch 1/5:  85%|8| 11/13 [00:05<00:00,  6.66it/s, loss=0.6948, graTraining Epoch 1/5:  85%|8| 11/13 [00:05<00:00,  6.66it/s, loss=0.7014, graTraining Epoch 1/5:  92%|9| 12/13 [00:05<00:00,  7.14it/s, loss=0.7014, graTraining Epoch 1/5:  92%|9| 12/13 [00:05<00:00,  7.14it/s, loss=0.6965, graTraining Epoch 1/5: 100%|#| 13/13 [00:05<00:00,  7.37it/s, loss=0.6965, graTraining Epoch 1/5: 100%|#| 13/13 [00:06<00:00,  2.01it/s, loss=0.6965, gra

Epoch 1/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6961, Acc: 0.4808, Precision: 0.4894, Recall: 0.8846, F1: 0.6301, AUC: 0.4583
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/13 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/13 [00:04<?, ?it/s, loss=0.6997, grad_norm=1.Training Epoch 2/5:   8%| | 1/13 [00:04<00:50,  4.21s/it, loss=0.6997, gradTraining Epoch 2/5:   8%| | 1/13 [00:04<00:50,  4.21s/it, loss=0.6800, gradTraining Epoch 2/5:  15%|1| 2/13 [00:04<00:19,  1.80s/it, loss=0.6800, gradTraining Epoch 2/5:  15%|1| 2/13 [00:04<00:19,  1.80s/it, loss=0.6706, gradTraining Epoch 2/5:  23%|2| 3/13 [00:04<00:10,  1.03s/it, loss=0.6706, gradTraining Epoch 2/5:  23%|2| 3/13 [00:04<00:10,  1.03s/it, loss=0.6907, gradTraining Epoch 2/5:  31%|3| 4/13 [00:04<00:05,  1.50it/s, loss=0.6907, gradTraining Epoch 2/5:  31%|3| 4/13 [00:04<00:05,  1.50it/s, loss=0.6766, gradTraining Epoch 2/5:  38%|3| 5/13 [00:04<00:03,  2.11it/s, loss=0.6766, gradTraining Epoch 2/5:  38%|3| 5/13 [00:04<00:03,  2.11it/s, loss=0.6838, gradTraining Epoch 2/5:  46%|4| 6/13 [00:04<00:02,  2.81it/s, loss=0.6838, gradTraining Epoch 2/5:  46%|4| 6/13 [00:04<00:02,  2.81it/s, loss=0.6940, gradTraining Epoch 2/5:  54%|5| 7/13 [00:04<00:01,  3.55it/s, loss=0.6940, gradTraining Epoch 2/5:  54%|5| 7/13 [00:05<00:01,  3.55it/s, loss=0.6773, gradTraining Epoch 2/5:  62%|6| 8/13 [00:05<00:01,  4.28it/s, loss=0.6773, gradTraining Epoch 2/5:  62%|6| 8/13 [00:05<00:01,  4.28it/s, loss=0.6912, gradTraining Epoch 2/5:  69%|6| 9/13 [00:05<00:00,  4.94it/s, loss=0.6912, gradTraining Epoch 2/5:  69%|6| 9/13 [00:05<00:00,  4.94it/s, loss=0.6909, gradTraining Epoch 2/5:  77%|7| 10/13 [00:05<00:00,  5.52it/s, loss=0.6909, graTraining Epoch 2/5:  77%|7| 10/13 [00:05<00:00,  5.52it/s, loss=0.6947, graTraining Epoch 2/5:  85%|8| 11/13 [00:05<00:00,  6.02it/s, loss=0.6947, graTraining Epoch 2/5:  85%|8| 11/13 [00:05<00:00,  6.02it/s, loss=0.6983, graTraining Epoch 2/5:  92%|9| 12/13 [00:05<00:00,  6.45it/s, loss=0.6983, graTraining Epoch 2/5:  92%|9| 12/13 [00:05<00:00,  6.45it/s, loss=0.6779, graTraining Epoch 2/5: 100%|#| 13/13 [00:05<00:00,  6.76it/s, loss=0.6779, graTraining Epoch 2/5: 100%|#| 13/13 [00:06<00:00,  2.05it/s, loss=0.6779, gra

Epoch 2/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6866, Acc: 0.5577, Precision: 0.5405, Recall: 0.7692, F1: 0.6349, AUC: 0.6314
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/13 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/13 [00:04<?, ?it/s, loss=0.6841, grad_norm=1.Training Epoch 3/5:   8%| | 1/13 [00:04<00:48,  4.06s/it, loss=0.6841, gradTraining Epoch 3/5:   8%| | 1/13 [00:04<00:48,  4.06s/it, loss=0.6898, gradTraining Epoch 3/5:  15%|1| 2/13 [00:04<00:19,  1.76s/it, loss=0.6898, gradTraining Epoch 3/5:  15%|1| 2/13 [00:04<00:19,  1.76s/it, loss=0.6712, gradTraining Epoch 3/5:  23%|2| 3/13 [00:04<00:10,  1.02s/it, loss=0.6712, gradTraining Epoch 3/5:  23%|2| 3/13 [00:04<00:10,  1.02s/it, loss=0.6791, gradTraining Epoch 3/5:  31%|3| 4/13 [00:04<00:06,  1.48it/s, loss=0.6791, gradTraining Epoch 3/5:  31%|3| 4/13 [00:04<00:06,  1.48it/s, loss=0.6848, gradTraining Epoch 3/5:  38%|3| 5/13 [00:04<00:03,  2.09it/s, loss=0.6848, gradTraining Epoch 3/5:  38%|3| 5/13 [00:04<00:03,  2.09it/s, loss=0.6656, gradTraining Epoch 3/5:  46%|4| 6/13 [00:04<00:02,  2.77it/s, loss=0.6656, gradTraining Epoch 3/5:  46%|4| 6/13 [00:04<00:02,  2.77it/s, loss=0.6898, gradTraining Epoch 3/5:  54%|5| 7/13 [00:04<00:01,  3.47it/s, loss=0.6898, gradTraining Epoch 3/5:  54%|5| 7/13 [00:05<00:01,  3.47it/s, loss=0.6717, gradTraining Epoch 3/5:  62%|6| 8/13 [00:05<00:01,  4.19it/s, loss=0.6717, gradTraining Epoch 3/5:  62%|6| 8/13 [00:05<00:01,  4.19it/s, loss=0.6856, gradTraining Epoch 3/5:  69%|6| 9/13 [00:05<00:00,  4.88it/s, loss=0.6856, gradTraining Epoch 3/5:  69%|6| 9/13 [00:05<00:00,  4.88it/s, loss=0.6811, gradTraining Epoch 3/5:  77%|7| 10/13 [00:05<00:00,  5.71it/s, loss=0.6811, graTraining Epoch 3/5:  77%|7| 10/13 [00:05<00:00,  5.71it/s, loss=0.6596, graTraining Epoch 3/5:  85%|8| 11/13 [00:05<00:00,  6.44it/s, loss=0.6596, graTraining Epoch 3/5:  85%|8| 11/13 [00:05<00:00,  6.44it/s, loss=0.6976, graTraining Epoch 3/5:  92%|9| 12/13 [00:05<00:00,  7.02it/s, loss=0.6976, graTraining Epoch 3/5:  92%|9| 12/13 [00:05<00:00,  7.02it/s, loss=0.6584, graTraining Epoch 3/5: 100%|#| 13/13 [00:05<00:00,  7.55it/s, loss=0.6584, graTraining Epoch 3/5: 100%|#| 13/13 [00:06<00:00,  2.10it/s, loss=0.6584, gra

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6783, Acc: 0.6827, Precision: 0.6863, Recall: 0.6731, F1: 0.6796, AUC: 0.7224
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/13 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/13 [00:04<?, ?it/s, loss=0.6852, grad_norm=1.Training Epoch 4/5:   8%| | 1/13 [00:04<00:49,  4.09s/it, loss=0.6852, gradTraining Epoch 4/5:   8%| | 1/13 [00:04<00:49,  4.09s/it, loss=0.6628, gradTraining Epoch 4/5:  15%|1| 2/13 [00:04<00:19,  1.76s/it, loss=0.6628, gradTraining Epoch 4/5:  15%|1| 2/13 [00:04<00:19,  1.76s/it, loss=0.6827, gradTraining Epoch 4/5:  23%|2| 3/13 [00:04<00:10,  1.01s/it, loss=0.6827, gradTraining Epoch 4/5:  23%|2| 3/13 [00:04<00:10,  1.01s/it, loss=0.6479, gradTraining Epoch 4/5:  31%|3| 4/13 [00:04<00:05,  1.53it/s, loss=0.6479, gradTraining Epoch 4/5:  31%|3| 4/13 [00:04<00:05,  1.53it/s, loss=0.6462, gradTraining Epoch 4/5:  38%|3| 5/13 [00:04<00:03,  2.18it/s, loss=0.6462, gradTraining Epoch 4/5:  38%|3| 5/13 [00:04<00:03,  2.18it/s, loss=0.6667, gradTraining Epoch 4/5:  46%|4| 6/13 [00:04<00:02,  2.94it/s, loss=0.6667, gradTraining Epoch 4/5:  46%|4| 6/13 [00:04<00:02,  2.94it/s, loss=0.6504, gradTraining Epoch 4/5:  54%|5| 7/13 [00:04<00:01,  3.77it/s, loss=0.6504, gradTraining Epoch 4/5:  54%|5| 7/13 [00:04<00:01,  3.77it/s, loss=0.6430, gradTraining Epoch 4/5:  62%|6| 8/13 [00:04<00:01,  4.61it/s, loss=0.6430, gradTraining Epoch 4/5:  62%|6| 8/13 [00:04<00:01,  4.61it/s, loss=0.6434, gradTraining Epoch 4/5:  69%|6| 9/13 [00:04<00:00,  5.47it/s, loss=0.6434, gradTraining Epoch 4/5:  69%|6| 9/13 [00:05<00:00,  5.47it/s, loss=0.6670, gradTraining Epoch 4/5:  77%|7| 10/13 [00:05<00:00,  6.24it/s, loss=0.6670, graTraining Epoch 4/5:  77%|7| 10/13 [00:05<00:00,  6.24it/s, loss=0.6386, graTraining Epoch 4/5:  85%|8| 11/13 [00:05<00:00,  6.89it/s, loss=0.6386, graTraining Epoch 4/5:  85%|8| 11/13 [00:05<00:00,  6.89it/s, loss=0.6442, graTraining Epoch 4/5:  92%|9| 12/13 [00:05<00:00,  7.45it/s, loss=0.6442, graTraining Epoch 4/5:  92%|9| 12/13 [00:05<00:00,  7.45it/s, loss=0.6712, graTraining Epoch 4/5: 100%|#| 13/13 [00:05<00:00,  7.95it/s, loss=0.6712, graTraining Epoch 4/5: 100%|#| 13/13 [00:06<00:00,  2.17it/s, loss=0.6712, gra

Epoch 4/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6576, Acc: 0.7212, Precision: 0.7170, Recall: 0.7308, F1: 0.7238, AUC: 0.8051
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/13 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/13 [00:04<?, ?it/s, loss=0.6031, grad_norm=1.Training Epoch 5/5:   8%| | 1/13 [00:04<00:48,  4.02s/it, loss=0.6031, gradTraining Epoch 5/5:   8%| | 1/13 [00:04<00:48,  4.02s/it, loss=0.6491, gradTraining Epoch 5/5:  15%|1| 2/13 [00:04<00:19,  1.73s/it, loss=0.6491, gradTraining Epoch 5/5:  15%|1| 2/13 [00:04<00:19,  1.73s/it, loss=0.6678, gradTraining Epoch 5/5:  23%|2| 3/13 [00:04<00:10,  1.00s/it, loss=0.6678, gradTraining Epoch 5/5:  23%|2| 3/13 [00:04<00:10,  1.00s/it, loss=0.6174, gradTraining Epoch 5/5:  31%|3| 4/13 [00:04<00:05,  1.54it/s, loss=0.6174, gradTraining Epoch 5/5:  31%|3| 4/13 [00:04<00:05,  1.54it/s, loss=0.6327, gradTraining Epoch 5/5:  38%|3| 5/13 [00:04<00:03,  2.17it/s, loss=0.6327, gradTraining Epoch 5/5:  38%|3| 5/13 [00:04<00:03,  2.17it/s, loss=0.6018, gradTraining Epoch 5/5:  46%|4| 6/13 [00:04<00:02,  2.93it/s, loss=0.6018, gradTraining Epoch 5/5:  46%|4| 6/13 [00:04<00:02,  2.93it/s, loss=0.6162, gradTraining Epoch 5/5:  54%|5| 7/13 [00:04<00:01,  3.78it/s, loss=0.6162, gradTraining Epoch 5/5:  54%|5| 7/13 [00:04<00:01,  3.78it/s, loss=0.6237, gradTraining Epoch 5/5:  62%|6| 8/13 [00:04<00:01,  4.64it/s, loss=0.6237, gradTraining Epoch 5/5:  62%|6| 8/13 [00:04<00:01,  4.64it/s, loss=0.5865, gradTraining Epoch 5/5:  69%|6| 9/13 [00:04<00:00,  5.50it/s, loss=0.5865, gradTraining Epoch 5/5:  69%|6| 9/13 [00:05<00:00,  5.50it/s, loss=0.5572, gradTraining Epoch 5/5:  77%|7| 10/13 [00:05<00:00,  6.33it/s, loss=0.5572, graTraining Epoch 5/5:  77%|7| 10/13 [00:05<00:00,  6.33it/s, loss=0.6079, graTraining Epoch 5/5:  85%|8| 11/13 [00:05<00:00,  7.01it/s, loss=0.6079, graTraining Epoch 5/5:  85%|8| 11/13 [00:05<00:00,  7.01it/s, loss=0.6016, graTraining Epoch 5/5:  92%|9| 12/13 [00:05<00:00,  7.60it/s, loss=0.6016, graTraining Epoch 5/5:  92%|9| 12/13 [00:05<00:00,  7.60it/s, loss=0.5391, graTraining Epoch 5/5: 100%|#| 13/13 [00:05<00:00,  7.68it/s, loss=0.5391, graTraining Epoch 5/5: 100%|#| 13/13 [00:05<00:00,  2.17it/s, loss=0.5391, gra

Epoch 5/5 Complete (6.4s) [LR: 0.000005]
Train - Loss: 0.6080, Acc: 0.8125, Precision: 0.7826, Recall: 0.8654, F1: 0.8219, AUC: 0.8972
------------------------------------------------------------
Training curves saved to model\chb03_fold0\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb03_fold0
============================================================
✅ Fold 0 training completed successfully!

============================================================
TRAINING FOLD 1/6
============================================================
Using dataset prefix: chb03_fold1
Loading datasets from: preprocessing\data\chb03_fold1
Saving models to: model\chb03_fold1
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.4126, std=2.0933
Loaded train dataset: 178 samples
  - Spectrogram shape: torch.Size([178, 30, 18, 50, 10])
  - Value range: [-5.5355, 4.8022]
  - Class distribution: tensor([89, 89])
LOOCV Mode (Fold 1): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7005, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.12s/it, loss=0.7005, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.12s/it, loss=0.6939, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.6939, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.7100, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.7100, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.7022, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.7022, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6816, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.6816, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.6910, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.94it/s, loss=0.6910, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.94it/s, loss=0.6954, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.79it/s, loss=0.6954, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.79it/s, loss=0.6902, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6902, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.69it/s, loss=0.6945, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6945, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6848, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6848, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6949, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6949, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6831, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.05it/s, loss=0.6831, gra

Epoch 1/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6935, Acc: 0.5056, Precision: 0.5294, Recall: 0.1011, F1: 0.1698, AUC: 0.5118
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6930, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6930, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6858, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.6858, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.6839, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6839, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6802, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6802, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6904, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.6904, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.6685, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.93it/s, loss=0.6685, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.93it/s, loss=0.6738, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.74it/s, loss=0.6738, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.74it/s, loss=0.6944, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.62it/s, loss=0.6944, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.62it/s, loss=0.6631, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.45it/s, loss=0.6631, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.45it/s, loss=0.6593, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.22it/s, loss=0.6593, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.22it/s, loss=0.6707, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.90it/s, loss=0.6707, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.90it/s, loss=0.6576, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.06it/s, loss=0.6576, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6767, Acc: 0.6236, Precision: 0.7500, Recall: 0.3708, F1: 0.4962, AUC: 0.7264
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6637, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6637, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6619, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6619, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6757, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.6757, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.6583, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6583, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6618, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.6618, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.6475, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6475, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6466, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.70it/s, loss=0.6466, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.70it/s, loss=0.6569, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.50it/s, loss=0.6569, gradTraining Epoch 3/5:  67%|6| 8/12 [00:05<00:00,  4.50it/s, loss=0.6466, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.35it/s, loss=0.6466, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.35it/s, loss=0.6247, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.94it/s, loss=0.6247, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.94it/s, loss=0.6472, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.66it/s, loss=0.6472, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.66it/s, loss=0.7217, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.05it/s, loss=0.7217, gra

Epoch 3/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6594, Acc: 0.7640, Precision: 0.8133, Recall: 0.6854, F1: 0.7439, AUC: 0.8513
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6181, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:45,  4.15s/it, loss=0.6181, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:45,  4.15s/it, loss=0.6410, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.79s/it, loss=0.6410, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.79s/it, loss=0.5835, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.5835, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6539, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.50it/s, loss=0.6539, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.50it/s, loss=0.6038, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.14it/s, loss=0.6038, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.14it/s, loss=0.6152, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.6152, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.6353, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.70it/s, loss=0.6353, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.70it/s, loss=0.6114, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.43it/s, loss=0.6114, gradTraining Epoch 4/5:  67%|6| 8/12 [00:05<00:00,  4.43it/s, loss=0.5870, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.10it/s, loss=0.5870, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.10it/s, loss=0.5950, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.67it/s, loss=0.5950, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.67it/s, loss=0.5748, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.09it/s, loss=0.5748, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.09it/s, loss=0.7239, graTraining Epoch 4/5: 100%|#| 12/12 [00:06<00:00,  1.99it/s, loss=0.7239, gra

Epoch 4/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6202, Acc: 0.8596, Precision: 0.8265, Recall: 0.9101, F1: 0.8663, AUC: 0.9150
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.5949, grad_norm=2.Training Epoch 5/5:   8%| | 1/12 [00:04<00:45,  4.11s/it, loss=0.5949, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:45,  4.11s/it, loss=0.5593, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.5593, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.5569, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.5569, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.5472, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.5472, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.5615, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.14it/s, loss=0.5615, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.14it/s, loss=0.5418, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.87it/s, loss=0.5418, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.87it/s, loss=0.5665, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.66it/s, loss=0.5665, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.66it/s, loss=0.5566, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.52it/s, loss=0.5566, gradTraining Epoch 5/5:  67%|6| 8/12 [00:05<00:00,  4.52it/s, loss=0.5081, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.32it/s, loss=0.5081, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.32it/s, loss=0.4300, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.02it/s, loss=0.4300, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.02it/s, loss=0.6183, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.75it/s, loss=0.6183, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.75it/s, loss=0.9520, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.04it/s, loss=0.9520, gra

Epoch 5/5 Complete (6.3s) [LR: 0.000005]
Train - Loss: 0.5827, Acc: 0.8258, Precision: 0.8152, Recall: 0.8427, F1: 0.8287, AUC: 0.9086
------------------------------------------------------------
Training curves saved to model\chb03_fold1\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb03_fold1
============================================================
✅ Fold 1 training completed successfully!

============================================================
TRAINING FOLD 2/6
============================================================
Using dataset prefix: chb03_fold2
Loading datasets from: preprocessing\data\chb03_fold2
Saving models to: model\chb03_fold2
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.5431, std=2.1554
Loaded train dataset: 190 samples
  - Spectrogram shape: torch.Size([190, 30, 18, 50, 10])
  - Value range: [-5.3156, 4.4008]
  - Class distribution: tensor([95, 95])
LOOCV Mode (Fold 2): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6973, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:46,  4.26s/it, loss=0.6973, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:46,  4.26s/it, loss=0.6908, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:18,  1.82s/it, loss=0.6908, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:18,  1.82s/it, loss=0.6996, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.04s/it, loss=0.6996, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.04s/it, loss=0.6866, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.48it/s, loss=0.6866, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.48it/s, loss=0.7076, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.12it/s, loss=0.7076, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.12it/s, loss=0.6855, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.84it/s, loss=0.6855, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.84it/s, loss=0.7067, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.62it/s, loss=0.7067, gradTraining Epoch 1/5:  58%|5| 7/12 [00:05<00:01,  3.62it/s, loss=0.6565, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.45it/s, loss=0.6565, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.45it/s, loss=0.6857, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.31it/s, loss=0.6857, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.31it/s, loss=0.6882, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.10it/s, loss=0.6882, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.10it/s, loss=0.7135, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.79it/s, loss=0.7135, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.79it/s, loss=0.7132, graTraining Epoch 1/5: 100%|#| 12/12 [00:06<00:00,  1.96it/s, loss=0.7132, gra

Epoch 1/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6943, Acc: 0.5368, Precision: 0.5198, Recall: 0.9684, F1: 0.6765, AUC: 0.4910
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6860, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:45,  4.12s/it, loss=0.6860, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:45,  4.12s/it, loss=0.6815, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.6815, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.6877, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6877, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6587, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6587, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6982, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.6982, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.6738, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6738, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6837, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6837, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6998, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.64it/s, loss=0.6998, gradTraining Epoch 2/5:  67%|6| 8/12 [00:05<00:00,  4.64it/s, loss=0.6622, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.35it/s, loss=0.6622, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.35it/s, loss=0.6858, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  5.86it/s, loss=0.6858, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  5.86it/s, loss=0.6779, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.62it/s, loss=0.6779, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.62it/s, loss=0.6858, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.02it/s, loss=0.6858, gra

Epoch 2/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6817, Acc: 0.6105, Precision: 0.5660, Recall: 0.9474, F1: 0.7087, AUC: 0.6905
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6842, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6842, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6792, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6792, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6700, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6700, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6657, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6657, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6696, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6696, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6580, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.02it/s, loss=0.6580, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.02it/s, loss=0.6585, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6585, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6630, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6630, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6898, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.53it/s, loss=0.6898, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.53it/s, loss=0.6513, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.22it/s, loss=0.6513, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.22it/s, loss=0.6535, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.75it/s, loss=0.6535, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.75it/s, loss=0.6772, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  7.47it/s, loss=0.6772, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.02it/s, loss=0.6772, gra

Epoch 3/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6683, Acc: 0.6947, Precision: 0.6667, Recall: 0.7789, F1: 0.7184, AUC: 0.7381
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6593, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:47,  4.30s/it, loss=0.6593, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:47,  4.30s/it, loss=0.6308, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:18,  1.86s/it, loss=0.6308, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:18,  1.86s/it, loss=0.6587, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.08s/it, loss=0.6587, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.08s/it, loss=0.6458, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.42it/s, loss=0.6458, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.42it/s, loss=0.6190, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.01it/s, loss=0.6190, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.01it/s, loss=0.6349, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.67it/s, loss=0.6349, gradTraining Epoch 4/5:  50%|5| 6/12 [00:05<00:02,  2.67it/s, loss=0.6287, gradTraining Epoch 4/5:  58%|5| 7/12 [00:05<00:01,  3.38it/s, loss=0.6287, gradTraining Epoch 4/5:  58%|5| 7/12 [00:05<00:01,  3.38it/s, loss=0.6304, gradTraining Epoch 4/5:  67%|6| 8/12 [00:05<00:00,  4.10it/s, loss=0.6304, gradTraining Epoch 4/5:  67%|6| 8/12 [00:05<00:00,  4.10it/s, loss=0.6505, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  4.91it/s, loss=0.6505, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  4.91it/s, loss=0.5985, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.72it/s, loss=0.5985, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.72it/s, loss=0.6656, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.50it/s, loss=0.6656, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.50it/s, loss=0.6024, graTraining Epoch 4/5: 100%|#| 12/12 [00:06<00:00,  1.90it/s, loss=0.6024, gra

Epoch 4/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6354, Acc: 0.7632, Precision: 0.7232, Recall: 0.8526, F1: 0.7826, AUC: 0.8182
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.5849, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:48,  4.40s/it, loss=0.5849, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:48,  4.40s/it, loss=0.6655, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:18,  1.88s/it, loss=0.6655, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:18,  1.88s/it, loss=0.6207, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:09,  1.07s/it, loss=0.6207, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:09,  1.07s/it, loss=0.5922, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.43it/s, loss=0.5922, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.43it/s, loss=0.5530, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.02it/s, loss=0.5530, gradTraining Epoch 5/5:  42%|4| 5/12 [00:05<00:03,  2.02it/s, loss=0.5734, gradTraining Epoch 5/5:  50%|5| 6/12 [00:05<00:02,  2.70it/s, loss=0.5734, gradTraining Epoch 5/5:  50%|5| 6/12 [00:05<00:02,  2.70it/s, loss=0.5487, gradTraining Epoch 5/5:  58%|5| 7/12 [00:05<00:01,  3.44it/s, loss=0.5487, gradTraining Epoch 5/5:  58%|5| 7/12 [00:05<00:01,  3.44it/s, loss=0.5978, gradTraining Epoch 5/5:  67%|6| 8/12 [00:05<00:00,  4.28it/s, loss=0.5978, gradTraining Epoch 5/5:  67%|6| 8/12 [00:05<00:00,  4.28it/s, loss=0.5516, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.15it/s, loss=0.5516, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.15it/s, loss=0.6011, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  5.79it/s, loss=0.6011, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  5.79it/s, loss=0.5043, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.55it/s, loss=0.5043, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.55it/s, loss=0.6206, graTraining Epoch 5/5: 100%|#| 12/12 [00:06<00:00,  1.91it/s, loss=0.6206, gra

Epoch 5/5 Complete (6.7s) [LR: 0.000005]
Train - Loss: 0.5845, Acc: 0.7684, Precision: 0.7073, Recall: 0.9158, F1: 0.7982, AUC: 0.8696
------------------------------------------------------------
Training curves saved to model\chb03_fold2\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb03_fold2
============================================================
✅ Fold 2 training completed successfully!

============================================================
TRAINING FOLD 3/6
============================================================
Using dataset prefix: chb03_fold3
Loading datasets from: preprocessing\data\chb03_fold3
Saving models to: model\chb03_fold3
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.5802, std=2.1948
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.2032, 4.1462]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 3): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7142, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:46,  4.18s/it, loss=0.7142, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:46,  4.18s/it, loss=0.6777, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:18,  1.80s/it, loss=0.6777, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:18,  1.80s/it, loss=0.6923, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.04s/it, loss=0.6923, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.04s/it, loss=0.6927, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.47it/s, loss=0.6927, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.47it/s, loss=0.6805, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.10it/s, loss=0.6805, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.10it/s, loss=0.6889, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.83it/s, loss=0.6889, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.83it/s, loss=0.6959, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.64it/s, loss=0.6959, gradTraining Epoch 1/5:  58%|5| 7/12 [00:05<00:01,  3.64it/s, loss=0.7120, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.49it/s, loss=0.7120, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.49it/s, loss=0.6913, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.34it/s, loss=0.6913, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.34it/s, loss=0.6926, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.10it/s, loss=0.6926, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.10it/s, loss=0.6899, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.76it/s, loss=0.6899, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.76it/s, loss=0.6949, graTraining Epoch 1/5: 100%|#| 12/12 [00:06<00:00,  1.97it/s, loss=0.6949, gra

Epoch 1/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.6936, Acc: 0.5543, Precision: 0.5338, Recall: 0.8587, F1: 0.6583, AUC: 0.5017
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6830, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:45,  4.14s/it, loss=0.6830, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:45,  4.14s/it, loss=0.6922, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.6922, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.6676, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6676, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6774, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6774, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6744, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.13it/s, loss=0.6744, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.13it/s, loss=0.6993, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.87it/s, loss=0.6993, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.87it/s, loss=0.6917, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.70it/s, loss=0.6917, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.70it/s, loss=0.6991, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.41it/s, loss=0.6991, gradTraining Epoch 2/5:  67%|6| 8/12 [00:05<00:00,  4.41it/s, loss=0.6670, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.06it/s, loss=0.6670, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.06it/s, loss=0.6768, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  5.85it/s, loss=0.6768, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  5.85it/s, loss=0.6649, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.55it/s, loss=0.6649, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.55it/s, loss=0.6630, graTraining Epoch 2/5: 100%|#| 12/12 [00:06<00:00,  1.99it/s, loss=0.6630, gra

Epoch 2/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6797, Acc: 0.6359, Precision: 0.5969, Recall: 0.8370, F1: 0.6968, AUC: 0.6711
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6600, grad_norm=0.Training Epoch 3/5:   8%| | 1/12 [00:04<00:46,  4.19s/it, loss=0.6600, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:46,  4.19s/it, loss=0.6720, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:18,  1.81s/it, loss=0.6720, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:18,  1.81s/it, loss=0.6834, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.03s/it, loss=0.6834, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.03s/it, loss=0.6703, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.48it/s, loss=0.6703, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.48it/s, loss=0.6735, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.10it/s, loss=0.6735, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.10it/s, loss=0.6833, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.85it/s, loss=0.6833, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.85it/s, loss=0.6513, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.69it/s, loss=0.6513, gradTraining Epoch 3/5:  58%|5| 7/12 [00:05<00:01,  3.69it/s, loss=0.6565, gradTraining Epoch 3/5:  67%|6| 8/12 [00:05<00:00,  4.44it/s, loss=0.6565, gradTraining Epoch 3/5:  67%|6| 8/12 [00:05<00:00,  4.44it/s, loss=0.6583, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.17it/s, loss=0.6583, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.17it/s, loss=0.6567, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.99it/s, loss=0.6567, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.99it/s, loss=0.6382, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.71it/s, loss=0.6382, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.71it/s, loss=0.6355, graTraining Epoch 3/5: 100%|#| 12/12 [00:06<00:00,  1.99it/s, loss=0.6355, gra

Epoch 3/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6616, Acc: 0.7120, Precision: 0.6893, Recall: 0.7717, F1: 0.7282, AUC: 0.7937
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6421, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:46,  4.19s/it, loss=0.6421, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:46,  4.19s/it, loss=0.6331, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.79s/it, loss=0.6331, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.79s/it, loss=0.6316, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6316, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6446, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6446, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6226, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.6226, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.6692, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.92it/s, loss=0.6692, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.92it/s, loss=0.6298, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6298, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6155, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6155, gradTraining Epoch 4/5:  67%|6| 8/12 [00:05<00:00,  4.68it/s, loss=0.6708, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.53it/s, loss=0.6708, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.53it/s, loss=0.6446, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.18it/s, loss=0.6446, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.18it/s, loss=0.5868, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.59it/s, loss=0.5868, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.59it/s, loss=0.7233, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.01it/s, loss=0.7233, gra

Epoch 4/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6428, Acc: 0.7120, Precision: 0.6667, Recall: 0.8478, F1: 0.7464, AUC: 0.8134
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.5780, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:45,  4.13s/it, loss=0.5780, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:45,  4.13s/it, loss=0.6264, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.6264, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.5808, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.5808, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.5701, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.52it/s, loss=0.5701, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.52it/s, loss=0.6489, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.6489, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.5910, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.94it/s, loss=0.5910, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.94it/s, loss=0.5611, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.79it/s, loss=0.5611, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.79it/s, loss=0.6030, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.64it/s, loss=0.6030, gradTraining Epoch 5/5:  67%|6| 8/12 [00:05<00:00,  4.64it/s, loss=0.5722, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.49it/s, loss=0.5722, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.49it/s, loss=0.5633, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.5633, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.5535, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.93it/s, loss=0.5535, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.93it/s, loss=0.5898, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.02it/s, loss=0.5898, gra

Epoch 5/5 Complete (6.4s) [LR: 0.000005]
Train - Loss: 0.5865, Acc: 0.7935, Precision: 0.8000, Recall: 0.7826, F1: 0.7912, AUC: 0.8977
------------------------------------------------------------
Training curves saved to model\chb03_fold3\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb03_fold3
============================================================
✅ Fold 3 training completed successfully!

============================================================
TRAINING FOLD 4/6
============================================================
Using dataset prefix: chb03_fold4
Loading datasets from: preprocessing\data\chb03_fold4
Saving models to: model\chb03_fold4
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.5932, std=2.1704
Loaded train dataset: 186 samples
  - Spectrogram shape: torch.Size([186, 30, 18, 50, 10])
  - Value range: [-5.2557, 4.6521]
  - Class distribution: tensor([93, 93])
LOOCV Mode (Fold 4): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7014, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.08s/it, loss=0.7014, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.08s/it, loss=0.6926, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6926, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6943, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6943, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6919, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6919, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6733, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.13it/s, loss=0.6733, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.13it/s, loss=0.6968, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.82it/s, loss=0.6968, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.82it/s, loss=0.6931, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.54it/s, loss=0.6931, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.54it/s, loss=0.6909, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.31it/s, loss=0.6909, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.31it/s, loss=0.7204, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.06it/s, loss=0.7204, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.06it/s, loss=0.6888, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  5.85it/s, loss=0.6888, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  5.85it/s, loss=0.6981, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.55it/s, loss=0.6981, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.55it/s, loss=0.6865, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.00it/s, loss=0.6865, gra

Epoch 1/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6940, Acc: 0.5108, Precision: 0.5500, Recall: 0.1183, F1: 0.1947, AUC: 0.4718
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6721, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:46,  4.23s/it, loss=0.6721, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:46,  4.23s/it, loss=0.6693, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:18,  1.82s/it, loss=0.6693, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:18,  1.82s/it, loss=0.6956, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.05s/it, loss=0.6956, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.05s/it, loss=0.6825, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.48it/s, loss=0.6825, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.48it/s, loss=0.6774, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.11it/s, loss=0.6774, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.11it/s, loss=0.6786, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.82it/s, loss=0.6786, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.82it/s, loss=0.6680, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.59it/s, loss=0.6680, gradTraining Epoch 2/5:  58%|5| 7/12 [00:05<00:01,  3.59it/s, loss=0.6785, gradTraining Epoch 2/5:  67%|6| 8/12 [00:05<00:00,  4.44it/s, loss=0.6785, gradTraining Epoch 2/5:  67%|6| 8/12 [00:05<00:00,  4.44it/s, loss=0.6865, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.30it/s, loss=0.6865, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.30it/s, loss=0.6833, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.09it/s, loss=0.6833, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.09it/s, loss=0.6932, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.79it/s, loss=0.6932, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.79it/s, loss=0.6963, graTraining Epoch 2/5: 100%|#| 12/12 [00:06<00:00,  1.97it/s, loss=0.6963, gra

Epoch 2/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.6818, Acc: 0.6559, Precision: 0.7959, Recall: 0.4194, F1: 0.5493, AUC: 0.7203
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6812, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:45,  4.17s/it, loss=0.6812, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:45,  4.17s/it, loss=0.6843, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6843, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6695, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6695, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6581, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.49it/s, loss=0.6581, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.49it/s, loss=0.6765, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.13it/s, loss=0.6765, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.13it/s, loss=0.6714, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.88it/s, loss=0.6714, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.88it/s, loss=0.6628, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.71it/s, loss=0.6628, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.71it/s, loss=0.6630, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.57it/s, loss=0.6630, gradTraining Epoch 3/5:  67%|6| 8/12 [00:05<00:00,  4.57it/s, loss=0.6905, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.39it/s, loss=0.6905, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.39it/s, loss=0.6725, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.16it/s, loss=0.6725, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.16it/s, loss=0.6656, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.83it/s, loss=0.6656, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.83it/s, loss=0.6800, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.00it/s, loss=0.6800, gra

Epoch 3/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6730, Acc: 0.6559, Precision: 0.7231, Recall: 0.5054, F1: 0.5949, AUC: 0.7640
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6771, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:03<00:43,  4.00s/it, loss=0.6771, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:43,  4.00s/it, loss=0.6386, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6386, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6744, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6744, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6765, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6765, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6591, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6591, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6487, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6487, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6443, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.77it/s, loss=0.6443, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.77it/s, loss=0.6730, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.62it/s, loss=0.6730, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.62it/s, loss=0.6228, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.45it/s, loss=0.6228, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.45it/s, loss=0.6143, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.22it/s, loss=0.6143, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.22it/s, loss=0.6424, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.87it/s, loss=0.6424, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.87it/s, loss=0.5845, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.5845, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6463, Acc: 0.7419, Precision: 0.7647, Recall: 0.6989, F1: 0.7303, AUC: 0.8404
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6017, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:03<00:43,  3.98s/it, loss=0.6017, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:43,  3.98s/it, loss=0.5963, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.5963, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6098, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6098, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.5931, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.5931, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.5762, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.16it/s, loss=0.5762, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.16it/s, loss=0.6508, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.6508, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.6112, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.74it/s, loss=0.6112, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.74it/s, loss=0.5695, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.63it/s, loss=0.5695, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.63it/s, loss=0.5641, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.46it/s, loss=0.5641, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.46it/s, loss=0.5221, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.5221, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.5856, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.5856, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.6504, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6504, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.5942, Acc: 0.8226, Precision: 0.8750, Recall: 0.7527, F1: 0.8092, AUC: 0.9100
------------------------------------------------------------
Training curves saved to model\chb03_fold4\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb03_fold4
============================================================
✅ Fold 4 training completed successfully!

============================================================
TRAINING FOLD 5/6
============================================================
Using dataset prefix: chb03_fold5
Loading datasets from: preprocessing\data\chb03_fold5
Saving models to: model\chb03_fold5
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.5849, std=2.1662
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.2697, 4.5752]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 5): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6954, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:48,  4.41s/it, loss=0.6954, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:48,  4.41s/it, loss=0.6892, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:18,  1.89s/it, loss=0.6892, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:18,  1.89s/it, loss=0.6748, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.08s/it, loss=0.6748, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.08s/it, loss=0.6694, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.44it/s, loss=0.6694, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.44it/s, loss=0.6949, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.08it/s, loss=0.6949, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.08it/s, loss=0.6987, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.83it/s, loss=0.6987, gradTraining Epoch 1/5:  50%|5| 6/12 [00:05<00:02,  2.83it/s, loss=0.6692, gradTraining Epoch 1/5:  58%|5| 7/12 [00:05<00:01,  3.65it/s, loss=0.6692, gradTraining Epoch 1/5:  58%|5| 7/12 [00:05<00:01,  3.65it/s, loss=0.7101, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.53it/s, loss=0.7101, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.53it/s, loss=0.6944, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.29it/s, loss=0.6944, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.29it/s, loss=0.7155, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.05it/s, loss=0.7155, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.05it/s, loss=0.7535, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.68it/s, loss=0.7535, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.68it/s, loss=0.6849, graTraining Epoch 1/5: 100%|#| 12/12 [00:06<00:00,  1.93it/s, loss=0.6849, gra

Epoch 1/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6958, Acc: 0.4837, Precision: 0.4615, Recall: 0.1957, F1: 0.2748, AUC: 0.4863
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6738, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:45,  4.18s/it, loss=0.6738, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:45,  4.18s/it, loss=0.6939, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:18,  1.80s/it, loss=0.6939, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:18,  1.80s/it, loss=0.7017, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.04s/it, loss=0.7017, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.04s/it, loss=0.6855, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.48it/s, loss=0.6855, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.48it/s, loss=0.6704, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.11it/s, loss=0.6704, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.11it/s, loss=0.7014, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.85it/s, loss=0.7014, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.85it/s, loss=0.7109, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.67it/s, loss=0.7109, gradTraining Epoch 2/5:  58%|5| 7/12 [00:05<00:01,  3.67it/s, loss=0.6651, gradTraining Epoch 2/5:  67%|6| 8/12 [00:05<00:00,  4.53it/s, loss=0.6651, gradTraining Epoch 2/5:  67%|6| 8/12 [00:05<00:00,  4.53it/s, loss=0.6949, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.38it/s, loss=0.6949, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.38it/s, loss=0.6685, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.19it/s, loss=0.6685, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.19it/s, loss=0.6786, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.69it/s, loss=0.6786, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.69it/s, loss=0.6918, graTraining Epoch 2/5: 100%|#| 12/12 [00:06<00:00,  2.00it/s, loss=0.6918, gra

Epoch 2/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6864, Acc: 0.5380, Precision: 0.6000, Recall: 0.2283, F1: 0.3307, AUC: 0.6160
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6877, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:45,  4.10s/it, loss=0.6877, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:45,  4.10s/it, loss=0.6886, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6886, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6685, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.6685, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.6906, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6906, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6805, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6805, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.7000, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.7000, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6911, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6911, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6839, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6839, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6825, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6825, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.56it/s, loss=0.6836, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.32it/s, loss=0.6836, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.32it/s, loss=0.6790, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6790, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6969, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.06it/s, loss=0.6969, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6861, Acc: 0.5924, Precision: 0.6076, Recall: 0.5217, F1: 0.5614, AUC: 0.6116
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6752, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:45,  4.10s/it, loss=0.6752, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:45,  4.10s/it, loss=0.6825, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6825, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6641, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6641, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6638, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6638, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6726, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.15it/s, loss=0.6726, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.15it/s, loss=0.6644, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.89it/s, loss=0.6644, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.89it/s, loss=0.6662, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.69it/s, loss=0.6662, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.69it/s, loss=0.6698, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.41it/s, loss=0.6698, gradTraining Epoch 4/5:  67%|6| 8/12 [00:05<00:00,  4.41it/s, loss=0.6469, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.17it/s, loss=0.6469, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.17it/s, loss=0.6640, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.94it/s, loss=0.6640, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.94it/s, loss=0.6321, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.60it/s, loss=0.6321, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.60it/s, loss=0.6600, graTraining Epoch 4/5: 100%|#| 12/12 [00:06<00:00,  1.97it/s, loss=0.6600, gra

Epoch 4/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.6635, Acc: 0.7174, Precision: 0.7222, Recall: 0.7065, F1: 0.7143, AUC: 0.8106
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6213, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6213, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6429, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6429, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6193, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6193, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6292, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6292, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6475, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6475, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6322, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6322, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6104, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.80it/s, loss=0.6104, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.80it/s, loss=0.6943, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.65it/s, loss=0.6943, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.65it/s, loss=0.6162, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.43it/s, loss=0.6162, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.43it/s, loss=0.6067, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.19it/s, loss=0.6067, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.19it/s, loss=0.6037, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.83it/s, loss=0.6037, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.83it/s, loss=0.5955, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.06it/s, loss=0.5955, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6266, Acc: 0.8098, Precision: 0.8276, Recall: 0.7826, F1: 0.8045, AUC: 0.8826
------------------------------------------------------------
Training curves saved to model\chb03_fold5\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb03_fold5
============================================================
✅ Fold 5 training completed successfully!

============================================================
TRAINING FOLD 6/6
============================================================
Using dataset prefix: chb03_fold6
Loading datasets from: preprocessing\data\chb03_fold6
Saving models to: model\chb03_fold6
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.5074, std=2.1609
Loaded train dataset: 226 samples
  - Spectrogram shape: torch.Size([226, 30, 18, 50, 10])
  - Value range: [-5.3185, 4.3161]
  - Class distribution: tensor([113, 113])
LOOCV Mode (Fold 6): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/15 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/15 [00:04<?, ?it/s, loss=0.6928, grad_norm=1.Training Epoch 1/5:   7%| | 1/15 [00:04<00:59,  4.27s/it, loss=0.6928, gradTraining Epoch 1/5:   7%| | 1/15 [00:04<00:59,  4.27s/it, loss=0.7217, gradTraining Epoch 1/5:  13%|1| 2/15 [00:04<00:23,  1.82s/it, loss=0.7217, gradTraining Epoch 1/5:  13%|1| 2/15 [00:04<00:23,  1.82s/it, loss=0.6882, gradTraining Epoch 1/5:  20%|2| 3/15 [00:04<00:12,  1.04s/it, loss=0.6882, gradTraining Epoch 1/5:  20%|2| 3/15 [00:04<00:12,  1.04s/it, loss=0.7027, gradTraining Epoch 1/5:  27%|2| 4/15 [00:04<00:07,  1.49it/s, loss=0.7027, gradTraining Epoch 1/5:  27%|2| 4/15 [00:04<00:07,  1.49it/s, loss=0.6813, gradTraining Epoch 1/5:  33%|3| 5/15 [00:04<00:04,  2.13it/s, loss=0.6813, gradTraining Epoch 1/5:  33%|3| 5/15 [00:04<00:04,  2.13it/s, loss=0.6788, gradTraining Epoch 1/5:  40%|4| 6/15 [00:04<00:03,  2.83it/s, loss=0.6788, gradTraining Epoch 1/5:  40%|4| 6/15 [00:04<00:03,  2.83it/s, loss=0.6938, gradTraining Epoch 1/5:  47%|4| 7/15 [00:04<00:02,  3.66it/s, loss=0.6938, gradTraining Epoch 1/5:  47%|4| 7/15 [00:05<00:02,  3.66it/s, loss=0.7014, gradTraining Epoch 1/5:  53%|5| 8/15 [00:05<00:01,  4.52it/s, loss=0.7014, gradTraining Epoch 1/5:  53%|5| 8/15 [00:05<00:01,  4.52it/s, loss=0.6875, gradTraining Epoch 1/5:  60%|6| 9/15 [00:05<00:01,  5.20it/s, loss=0.6875, gradTraining Epoch 1/5:  60%|6| 9/15 [00:05<00:01,  5.20it/s, loss=0.6901, gradTraining Epoch 1/5:  67%|6| 10/15 [00:05<00:00,  5.98it/s, loss=0.6901, graTraining Epoch 1/5:  67%|6| 10/15 [00:05<00:00,  5.98it/s, loss=0.6832, graTraining Epoch 1/5:  73%|7| 11/15 [00:05<00:00,  6.65it/s, loss=0.6832, graTraining Epoch 1/5:  73%|7| 11/15 [00:05<00:00,  6.65it/s, loss=0.6852, graTraining Epoch 1/5:  80%|8| 12/15 [00:05<00:00,  7.17it/s, loss=0.6852, graTraining Epoch 1/5:  80%|8| 12/15 [00:05<00:00,  7.17it/s, loss=0.7065, graTraining Epoch 1/5:  87%|8| 13/15 [00:05<00:00,  7.68it/s, loss=0.7065, graTraining Epoch 1/5:  87%|8| 13/15 [00:05<00:00,  7.68it/s, loss=0.6809, graTraining Epoch 1/5:  93%|9| 14/15 [00:05<00:00,  8.08it/s, loss=0.6809, graTraining Epoch 1/5:  93%|9| 14/15 [00:05<00:00,  8.08it/s, loss=0.6870, graTraining Epoch 1/5: 100%|#| 15/15 [00:06<00:00,  2.30it/s, loss=0.6870, gra

Epoch 1/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6921, Acc: 0.5398, Precision: 0.5243, Recall: 0.8584, F1: 0.6510, AUC: 0.5314
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/15 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/15 [00:04<?, ?it/s, loss=0.6998, grad_norm=1.Training Epoch 2/5:   7%| | 1/15 [00:04<00:57,  4.11s/it, loss=0.6998, gradTraining Epoch 2/5:   7%| | 1/15 [00:04<00:57,  4.11s/it, loss=0.6906, gradTraining Epoch 2/5:  13%|1| 2/15 [00:04<00:22,  1.77s/it, loss=0.6906, gradTraining Epoch 2/5:  13%|1| 2/15 [00:04<00:22,  1.77s/it, loss=0.6836, gradTraining Epoch 2/5:  20%|2| 3/15 [00:04<00:12,  1.01s/it, loss=0.6836, gradTraining Epoch 2/5:  20%|2| 3/15 [00:04<00:12,  1.01s/it, loss=0.6682, gradTraining Epoch 2/5:  27%|2| 4/15 [00:04<00:07,  1.53it/s, loss=0.6682, gradTraining Epoch 2/5:  27%|2| 4/15 [00:04<00:07,  1.53it/s, loss=0.6857, gradTraining Epoch 2/5:  33%|3| 5/15 [00:04<00:04,  2.18it/s, loss=0.6857, gradTraining Epoch 2/5:  33%|3| 5/15 [00:04<00:04,  2.18it/s, loss=0.6983, gradTraining Epoch 2/5:  40%|4| 6/15 [00:04<00:03,  2.86it/s, loss=0.6983, gradTraining Epoch 2/5:  40%|4| 6/15 [00:04<00:03,  2.86it/s, loss=0.6826, gradTraining Epoch 2/5:  47%|4| 7/15 [00:04<00:02,  3.67it/s, loss=0.6826, gradTraining Epoch 2/5:  47%|4| 7/15 [00:04<00:02,  3.67it/s, loss=0.6831, gradTraining Epoch 2/5:  53%|5| 8/15 [00:04<00:01,  4.52it/s, loss=0.6831, gradTraining Epoch 2/5:  53%|5| 8/15 [00:05<00:01,  4.52it/s, loss=0.6969, gradTraining Epoch 2/5:  60%|6| 9/15 [00:05<00:01,  5.37it/s, loss=0.6969, gradTraining Epoch 2/5:  60%|6| 9/15 [00:05<00:01,  5.37it/s, loss=0.6978, gradTraining Epoch 2/5:  67%|6| 10/15 [00:05<00:00,  5.97it/s, loss=0.6978, graTraining Epoch 2/5:  67%|6| 10/15 [00:05<00:00,  5.97it/s, loss=0.6793, graTraining Epoch 2/5:  73%|7| 11/15 [00:05<00:00,  6.35it/s, loss=0.6793, graTraining Epoch 2/5:  73%|7| 11/15 [00:05<00:00,  6.35it/s, loss=0.6836, graTraining Epoch 2/5:  80%|8| 12/15 [00:05<00:00,  7.00it/s, loss=0.6836, graTraining Epoch 2/5:  80%|8| 12/15 [00:05<00:00,  7.00it/s, loss=0.6844, graTraining Epoch 2/5:  87%|8| 13/15 [00:05<00:00,  7.55it/s, loss=0.6844, graTraining Epoch 2/5:  87%|8| 13/15 [00:05<00:00,  7.55it/s, loss=0.6802, graTraining Epoch 2/5:  93%|9| 14/15 [00:05<00:00,  7.97it/s, loss=0.6802, graTraining Epoch 2/5:  93%|9| 14/15 [00:05<00:00,  7.97it/s, loss=0.7098, graTraining Epoch 2/5: 100%|#| 15/15 [00:06<00:00,  2.41it/s, loss=0.7098, gra

Epoch 2/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6883, Acc: 0.5133, Precision: 0.5085, Recall: 0.7965, F1: 0.6207, AUC: 0.6066
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/15 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/15 [00:04<?, ?it/s, loss=0.6648, grad_norm=1.Training Epoch 3/5:   7%| | 1/15 [00:04<00:57,  4.10s/it, loss=0.6648, gradTraining Epoch 3/5:   7%| | 1/15 [00:04<00:57,  4.10s/it, loss=0.6823, gradTraining Epoch 3/5:  13%|1| 2/15 [00:04<00:22,  1.76s/it, loss=0.6823, gradTraining Epoch 3/5:  13%|1| 2/15 [00:04<00:22,  1.76s/it, loss=0.6654, gradTraining Epoch 3/5:  20%|2| 3/15 [00:04<00:12,  1.01s/it, loss=0.6654, gradTraining Epoch 3/5:  20%|2| 3/15 [00:04<00:12,  1.01s/it, loss=0.6468, gradTraining Epoch 3/5:  27%|2| 4/15 [00:04<00:07,  1.51it/s, loss=0.6468, gradTraining Epoch 3/5:  27%|2| 4/15 [00:04<00:07,  1.51it/s, loss=0.6654, gradTraining Epoch 3/5:  33%|3| 5/15 [00:04<00:04,  2.16it/s, loss=0.6654, gradTraining Epoch 3/5:  33%|3| 5/15 [00:04<00:04,  2.16it/s, loss=0.6773, gradTraining Epoch 3/5:  40%|4| 6/15 [00:04<00:03,  2.87it/s, loss=0.6773, gradTraining Epoch 3/5:  40%|4| 6/15 [00:04<00:03,  2.87it/s, loss=0.6681, gradTraining Epoch 3/5:  47%|4| 7/15 [00:04<00:02,  3.69it/s, loss=0.6681, gradTraining Epoch 3/5:  47%|4| 7/15 [00:04<00:02,  3.69it/s, loss=0.6528, gradTraining Epoch 3/5:  53%|5| 8/15 [00:04<00:01,  4.48it/s, loss=0.6528, gradTraining Epoch 3/5:  53%|5| 8/15 [00:05<00:01,  4.48it/s, loss=0.6563, gradTraining Epoch 3/5:  60%|6| 9/15 [00:05<00:01,  5.25it/s, loss=0.6563, gradTraining Epoch 3/5:  60%|6| 9/15 [00:05<00:01,  5.25it/s, loss=0.6896, gradTraining Epoch 3/5:  67%|6| 10/15 [00:05<00:00,  6.00it/s, loss=0.6896, graTraining Epoch 3/5:  67%|6| 10/15 [00:05<00:00,  6.00it/s, loss=0.6784, graTraining Epoch 3/5:  73%|7| 11/15 [00:05<00:00,  6.62it/s, loss=0.6784, graTraining Epoch 3/5:  73%|7| 11/15 [00:05<00:00,  6.62it/s, loss=0.6566, graTraining Epoch 3/5:  80%|8| 12/15 [00:05<00:00,  7.01it/s, loss=0.6566, graTraining Epoch 3/5:  80%|8| 12/15 [00:05<00:00,  7.01it/s, loss=0.6965, graTraining Epoch 3/5:  87%|8| 13/15 [00:05<00:00,  7.33it/s, loss=0.6965, graTraining Epoch 3/5:  87%|8| 13/15 [00:05<00:00,  7.33it/s, loss=0.6925, graTraining Epoch 3/5:  93%|9| 14/15 [00:05<00:00,  7.62it/s, loss=0.6925, graTraining Epoch 3/5:  93%|9| 14/15 [00:05<00:00,  7.62it/s, loss=0.7696, graTraining Epoch 3/5: 100%|#| 15/15 [00:06<00:00,  2.38it/s, loss=0.7696, gra

Epoch 3/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6775, Acc: 0.6549, Precision: 0.6061, Recall: 0.8850, F1: 0.7194, AUC: 0.7243
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/15 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/15 [00:04<?, ?it/s, loss=0.6616, grad_norm=1.Training Epoch 4/5:   7%| | 1/15 [00:04<00:58,  4.15s/it, loss=0.6616, gradTraining Epoch 4/5:   7%| | 1/15 [00:04<00:58,  4.15s/it, loss=0.6861, gradTraining Epoch 4/5:  13%|1| 2/15 [00:04<00:23,  1.78s/it, loss=0.6861, gradTraining Epoch 4/5:  13%|1| 2/15 [00:04<00:23,  1.78s/it, loss=0.6663, gradTraining Epoch 4/5:  20%|2| 3/15 [00:04<00:12,  1.02s/it, loss=0.6663, gradTraining Epoch 4/5:  20%|2| 3/15 [00:04<00:12,  1.02s/it, loss=0.6710, gradTraining Epoch 4/5:  27%|2| 4/15 [00:04<00:07,  1.52it/s, loss=0.6710, gradTraining Epoch 4/5:  27%|2| 4/15 [00:04<00:07,  1.52it/s, loss=0.6334, gradTraining Epoch 4/5:  33%|3| 5/15 [00:04<00:04,  2.16it/s, loss=0.6334, gradTraining Epoch 4/5:  33%|3| 5/15 [00:04<00:04,  2.16it/s, loss=0.6536, gradTraining Epoch 4/5:  40%|4| 6/15 [00:04<00:03,  2.91it/s, loss=0.6536, gradTraining Epoch 4/5:  40%|4| 6/15 [00:04<00:03,  2.91it/s, loss=0.6634, gradTraining Epoch 4/5:  47%|4| 7/15 [00:04<00:02,  3.72it/s, loss=0.6634, gradTraining Epoch 4/5:  47%|4| 7/15 [00:04<00:02,  3.72it/s, loss=0.6449, gradTraining Epoch 4/5:  53%|5| 8/15 [00:04<00:01,  4.58it/s, loss=0.6449, gradTraining Epoch 4/5:  53%|5| 8/15 [00:05<00:01,  4.58it/s, loss=0.6583, gradTraining Epoch 4/5:  60%|6| 9/15 [00:05<00:01,  5.41it/s, loss=0.6583, gradTraining Epoch 4/5:  60%|6| 9/15 [00:05<00:01,  5.41it/s, loss=0.6947, gradTraining Epoch 4/5:  67%|6| 10/15 [00:05<00:00,  6.10it/s, loss=0.6947, graTraining Epoch 4/5:  67%|6| 10/15 [00:05<00:00,  6.10it/s, loss=0.6501, graTraining Epoch 4/5:  73%|7| 11/15 [00:05<00:00,  6.59it/s, loss=0.6501, graTraining Epoch 4/5:  73%|7| 11/15 [00:05<00:00,  6.59it/s, loss=0.6263, graTraining Epoch 4/5:  80%|8| 12/15 [00:05<00:00,  6.87it/s, loss=0.6263, graTraining Epoch 4/5:  80%|8| 12/15 [00:05<00:00,  6.87it/s, loss=0.6408, graTraining Epoch 4/5:  87%|8| 13/15 [00:05<00:00,  7.06it/s, loss=0.6408, graTraining Epoch 4/5:  87%|8| 13/15 [00:05<00:00,  7.06it/s, loss=0.6151, graTraining Epoch 4/5:  93%|9| 14/15 [00:05<00:00,  7.27it/s, loss=0.6151, graTraining Epoch 4/5:  93%|9| 14/15 [00:05<00:00,  7.27it/s, loss=0.6393, graTraining Epoch 4/5: 100%|#| 15/15 [00:06<00:00,  2.37it/s, loss=0.6393, gra

Epoch 4/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6537, Acc: 0.7035, Precision: 0.6769, Recall: 0.7788, F1: 0.7243, AUC: 0.7818
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/15 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/15 [00:04<?, ?it/s, loss=0.5914, grad_norm=1.Training Epoch 5/5:   7%| | 1/15 [00:04<00:57,  4.09s/it, loss=0.5914, gradTraining Epoch 5/5:   7%| | 1/15 [00:04<00:57,  4.09s/it, loss=0.6143, gradTraining Epoch 5/5:  13%|1| 2/15 [00:04<00:22,  1.76s/it, loss=0.6143, gradTraining Epoch 5/5:  13%|1| 2/15 [00:04<00:22,  1.76s/it, loss=0.6232, gradTraining Epoch 5/5:  20%|2| 3/15 [00:04<00:12,  1.02s/it, loss=0.6232, gradTraining Epoch 5/5:  20%|2| 3/15 [00:04<00:12,  1.02s/it, loss=0.6050, gradTraining Epoch 5/5:  27%|2| 4/15 [00:04<00:07,  1.50it/s, loss=0.6050, gradTraining Epoch 5/5:  27%|2| 4/15 [00:04<00:07,  1.50it/s, loss=0.5904, gradTraining Epoch 5/5:  33%|3| 5/15 [00:04<00:04,  2.10it/s, loss=0.5904, gradTraining Epoch 5/5:  33%|3| 5/15 [00:04<00:04,  2.10it/s, loss=0.5644, gradTraining Epoch 5/5:  40%|4| 6/15 [00:04<00:03,  2.79it/s, loss=0.5644, gradTraining Epoch 5/5:  40%|4| 6/15 [00:04<00:03,  2.79it/s, loss=0.5700, gradTraining Epoch 5/5:  47%|4| 7/15 [00:04<00:02,  3.53it/s, loss=0.5700, gradTraining Epoch 5/5:  47%|4| 7/15 [00:05<00:02,  3.53it/s, loss=0.5943, gradTraining Epoch 5/5:  53%|5| 8/15 [00:05<00:01,  4.26it/s, loss=0.5943, gradTraining Epoch 5/5:  53%|5| 8/15 [00:05<00:01,  4.26it/s, loss=0.7302, gradTraining Epoch 5/5:  60%|6| 9/15 [00:05<00:01,  4.92it/s, loss=0.7302, gradTraining Epoch 5/5:  60%|6| 9/15 [00:05<00:01,  4.92it/s, loss=0.6250, gradTraining Epoch 5/5:  67%|6| 10/15 [00:05<00:00,  5.54it/s, loss=0.6250, graTraining Epoch 5/5:  67%|6| 10/15 [00:05<00:00,  5.54it/s, loss=0.5909, graTraining Epoch 5/5:  73%|7| 11/15 [00:05<00:00,  6.03it/s, loss=0.5909, graTraining Epoch 5/5:  73%|7| 11/15 [00:05<00:00,  6.03it/s, loss=0.6068, graTraining Epoch 5/5:  80%|8| 12/15 [00:05<00:00,  6.41it/s, loss=0.6068, graTraining Epoch 5/5:  80%|8| 12/15 [00:05<00:00,  6.41it/s, loss=0.5227, graTraining Epoch 5/5:  87%|8| 13/15 [00:05<00:00,  6.76it/s, loss=0.5227, graTraining Epoch 5/5:  87%|8| 13/15 [00:05<00:00,  6.76it/s, loss=0.5447, graTraining Epoch 5/5:  93%|9| 14/15 [00:05<00:00,  6.99it/s, loss=0.5447, graTraining Epoch 5/5:  93%|9| 14/15 [00:05<00:00,  6.99it/s, loss=0.6754, graTraining Epoch 5/5: 100%|#| 15/15 [00:06<00:00,  2.34it/s, loss=0.6754, gra

Epoch 5/5 Complete (6.8s) [LR: 0.000005]
Train - Loss: 0.6032, Acc: 0.7920, Precision: 0.7500, Recall: 0.8761, F1: 0.8082, AUC: 0.8731
------------------------------------------------------------
Training curves saved to model\chb03_fold6\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb03_fold6
============================================================
✅ Fold 6 training completed successfully!

============================================================
✅ BATCH TRAINING COMPLETED!
✅ Trained models for 7 folds for patient chb03
============================================================
============================================================
============================================================
BATCH EVALUATION: ALL FOLDS
BATCH EVALUATION: ALL FOLDS
Evaluating 7 folds for patient chb03
Evaluating 7 folds for patient chb03
============================================================
============================================================
Using CUDA: NVIDIA GeForce RTX 3090 Ti
Using CUDA: NVIDIA GeForce RTX 3090 Ti

============================================================
============================================================

EVALUATING FOLD 0/6
EVALUATING FOLD 0/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb03_fold0
Dataset prefix: chb03_fold0
Using test dataset: preprocessing\data\chb03_fold0\test_dataset.h5
Using test dataset: preprocessing\data\chb03_fold0\test_dataset.h5
Loading test dataset from preprocessing\data\chb03_fold0\test_dataset.h5...
Loading test dataset from preprocessing\data\chb03_fold0\test_dataset.h5...
  - Normalization: z-score, mean=-0.6183, std=2.1649
  - Normalization: z-score, mean=-0.6183, std=2.1649
Loaded test dataset: 18 samples
Loaded test dataset: 18 samples
  - Spectrogram shape: torch.Size([18, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([18, 30, 18, 50, 10])
  - Value range: [-5.2574, 4.6213]
  - Value range: [-5.2574, 4.6213]
  - Class distribution: tensor([9, 9])
  - Class distribution: tensor([9, 9])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb03_fold0\epoch_005.pth...
Loading model checkpoint from model\chb03_fold0\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/2 [00:00<?, ?it/s]Testing:   0%|                                       | 0/2 [00:00<?, ?it/s]Testing:  50%|###############5               | 1/2 [00:00<00:00,  4.06it/s]Testing:  50%|###############5               | 1/2 [00:00<00:00,  4.06it/s]Testing: 100%|###############################| 2/2 [00:00<00:00,  7.48it/s]Testing: 100%|###############################| 2/2 [00:00<00:00,  7.48it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.5466
Loss:      0.5466
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         9         0
Actual Interictal         9         0
       Preictal         0         9
       Preictal         0         9

Class Distribution:
Class Distribution:

True Interictal (0): 9 samples
True Interictal (0): 9 samples
True Preictal (1):   9 samples
True Preictal (1):   9 samples
Pred Interictal (0): 9 samples
Pred Interictal (0): 9 samples
Pred Preictal (1):   9 samples
Pred Preictal (1):   9 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000         9
    Preictal     1.0000    1.0000    1.0000         9

    accuracy                         1.0000        18
   macro avg     1.0000    1.0000    1.0000        18
weighted avg     1.0000    1.0000    1.0000        18
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000         9
    Preictal     1.0000    1.0000    1.0000         9

    accuracy                         1.0000        18
   macro avg     1.0000    1.0000    1.0000        18
weighted avg     1.0000    1.0000    1.0000        18



✅ Results saved to model\chb03_fold0\test_results.json
✅ Results saved to model\chb03_fold0\test_results.json


============================================================
============================================================

EVALUATING FOLD 1/6
EVALUATING FOLD 1/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb03_fold1
Dataset prefix: chb03_fold1
Using test dataset: preprocessing\data\chb03_fold1\test_dataset.h5
Using test dataset: preprocessing\data\chb03_fold1\test_dataset.h5
Loading test dataset from preprocessing\data\chb03_fold1\test_dataset.h5...
Loading test dataset from preprocessing\data\chb03_fold1\test_dataset.h5...
  - Normalization: z-score, mean=-0.4126, std=2.0933
  - Normalization: z-score, mean=-0.4126, std=2.0933
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-5.5355, 4.6277]
  - Value range: [-5.5355, 4.6277]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb03_fold1\epoch_005.pth...
Loading model checkpoint from model\chb03_fold1\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.61it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.61it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.53it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.53it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.9523
Loss:      0.9523
Accuracy:  0.4375 (43.75%)
Accuracy:  0.4375 (43.75%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.2830
AUC-ROC:   0.2830

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        21         3
Actual Interictal        21         3
       Preictal        24         0
       Preictal        24         0

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 45 samples
Pred Interictal (0): 45 samples
Pred Preictal (1):   3 samples
Pred Preictal (1):   3 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4667    0.8750    0.6087        24
    Preictal     0.0000    0.0000    0.0000        24

    accuracy                         0.4375        48
   macro avg     0.2333    0.4375    0.3043        48
weighted avg     0.2333    0.4375    0.3043        48
              precision    recall  f1-score   support

  Interictal     0.4667    0.8750    0.6087        24
    Preictal     0.0000    0.0000    0.0000        24

    accuracy                         0.4375        48
   macro avg     0.2333    0.4375    0.3043        48
weighted avg     0.2333    0.4375    0.3043        48



✅ Results saved to model\chb03_fold1\test_results.json
✅ Results saved to model\chb03_fold1\test_results.json


============================================================
============================================================

EVALUATING FOLD 2/6
EVALUATING FOLD 2/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb03_fold2
Dataset prefix: chb03_fold2
Using test dataset: preprocessing\data\chb03_fold2\test_dataset.h5
Using test dataset: preprocessing\data\chb03_fold2\test_dataset.h5
Loading test dataset from preprocessing\data\chb03_fold2\test_dataset.h5...
Loading test dataset from preprocessing\data\chb03_fold2\test_dataset.h5...
  - Normalization: z-score, mean=-0.5431, std=2.1554
  - Normalization: z-score, mean=-0.5431, std=2.1554
Loaded test dataset: 36 samples
Loaded test dataset: 36 samples
  - Spectrogram shape: torch.Size([36, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([36, 30, 18, 50, 10])
  - Value range: [-5.3156, 4.2507]
  - Value range: [-5.3156, 4.2507]
  - Class distribution: tensor([18, 18])
  - Class distribution: tensor([18, 18])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb03_fold2\epoch_005.pth...
Loading model checkpoint from model\chb03_fold2\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.41it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.41it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7892
Loss:      0.7892
Accuracy:  0.3889 (38.89%)
Accuracy:  0.3889 (38.89%)
Precision: 0.3889
Precision: 0.3889
Recall:    0.3889
Recall:    0.3889
F1 Score:  0.3889
F1 Score:  0.3889
AUC-ROC:   0.2438
AUC-ROC:   0.2438

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         7        11
Actual Interictal         7        11
       Preictal        11         7
       Preictal        11         7

Class Distribution:
Class Distribution:

True Interictal (0): 18 samples
True Interictal (0): 18 samples
True Preictal (1):   18 samples
True Preictal (1):   18 samples
Pred Interictal (0): 18 samples
Pred Interictal (0): 18 samples
Pred Preictal (1):   18 samples
Pred Preictal (1):   18 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.3889    0.3889    0.3889        18
    Preictal     0.3889    0.3889    0.3889        18

    accuracy                         0.3889        36
   macro avg     0.3889    0.3889    0.3889        36
weighted avg     0.3889    0.3889    0.3889        36
              precision    recall  f1-score   support

  Interictal     0.3889    0.3889    0.3889        18
    Preictal     0.3889    0.3889    0.3889        18

    accuracy                         0.3889        36
   macro avg     0.3889    0.3889    0.3889        36
weighted avg     0.3889    0.3889    0.3889        36



✅ Results saved to model\chb03_fold2\test_results.json
✅ Results saved to model\chb03_fold2\test_results.json


============================================================
============================================================

EVALUATING FOLD 3/6
EVALUATING FOLD 3/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb03_fold3
Dataset prefix: chb03_fold3
Using test dataset: preprocessing\data\chb03_fold3\test_dataset.h5
Using test dataset: preprocessing\data\chb03_fold3\test_dataset.h5
Loading test dataset from preprocessing\data\chb03_fold3\test_dataset.h5...
Loading test dataset from preprocessing\data\chb03_fold3\test_dataset.h5...
  - Normalization: z-score, mean=-0.5802, std=2.1948
  - Normalization: z-score, mean=-0.5802, std=2.1948
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.2032, 4.0620]
  - Value range: [-5.2032, 4.0620]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb03_fold3\epoch_005.pth...
Loading model checkpoint from model\chb03_fold3\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 30.66it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 30.66it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6366
Loss:      0.6366
Accuracy:  0.6905 (69.05%)
Accuracy:  0.6905 (69.05%)
Precision: 0.7222
Precision: 0.7222
Recall:    0.6190
Recall:    0.6190
F1 Score:  0.6667
F1 Score:  0.6667
AUC-ROC:   0.7392
AUC-ROC:   0.7392

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        16         5
Actual Interictal        16         5
       Preictal         8        13
       Preictal         8        13

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 24 samples
Pred Interictal (0): 24 samples
Pred Preictal (1):   18 samples
Pred Preictal (1):   18 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.6667    0.7619    0.7111        21
    Preictal     0.7222    0.6190    0.6667        21

    accuracy                         0.6905        42
   macro avg     0.6944    0.6905    0.6889        42
weighted avg     0.6944    0.6905    0.6889        42
              precision    recall  f1-score   support

  Interictal     0.6667    0.7619    0.7111        21
    Preictal     0.7222    0.6190    0.6667        21

    accuracy                         0.6905        42
   macro avg     0.6944    0.6905    0.6889        42
weighted avg     0.6944    0.6905    0.6889        42



✅ Results saved to model\chb03_fold3\test_results.json
✅ Results saved to model\chb03_fold3\test_results.json


============================================================
============================================================

EVALUATING FOLD 4/6
EVALUATING FOLD 4/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb03_fold4
Dataset prefix: chb03_fold4
Using test dataset: preprocessing\data\chb03_fold4\test_dataset.h5
Using test dataset: preprocessing\data\chb03_fold4\test_dataset.h5
Loading test dataset from preprocessing\data\chb03_fold4\test_dataset.h5...
Loading test dataset from preprocessing\data\chb03_fold4\test_dataset.h5...
  - Normalization: z-score, mean=-0.5932, std=2.1704
  - Normalization: z-score, mean=-0.5932, std=2.1704
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.2557, 4.4509]
  - Value range: [-5.2557, 4.4509]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb03_fold4\epoch_005.pth...
Loading model checkpoint from model\chb03_fold4\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.85it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.85it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.75it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.75it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.5653
Loss:      0.5653
Accuracy:  0.8250 (82.50%)
Accuracy:  0.8250 (82.50%)
Precision: 0.7600
Precision: 0.7600
Recall:    0.9500
Recall:    0.9500
F1 Score:  0.8444
F1 Score:  0.8444
AUC-ROC:   0.8200
AUC-ROC:   0.8200

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         6
Actual Interictal        14         6
       Preictal         1        19
       Preictal         1        19

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 15 samples
Pred Interictal (0): 15 samples
Pred Preictal (1):   25 samples
Pred Preictal (1):   25 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.9333    0.7000    0.8000        20
    Preictal     0.7600    0.9500    0.8444        20

    accuracy                         0.8250        40
   macro avg     0.8467    0.8250    0.8222        40
weighted avg     0.8467    0.8250    0.8222        40
              precision    recall  f1-score   support

  Interictal     0.9333    0.7000    0.8000        20
    Preictal     0.7600    0.9500    0.8444        20

    accuracy                         0.8250        40
   macro avg     0.8467    0.8250    0.8222        40
weighted avg     0.8467    0.8250    0.8222        40



✅ Results saved to model\chb03_fold4\test_results.json
✅ Results saved to model\chb03_fold4\test_results.json


============================================================
============================================================

EVALUATING FOLD 5/6
EVALUATING FOLD 5/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb03_fold5
Dataset prefix: chb03_fold5
Using test dataset: preprocessing\data\chb03_fold5\test_dataset.h5
Using test dataset: preprocessing\data\chb03_fold5\test_dataset.h5
Loading test dataset from preprocessing\data\chb03_fold5\test_dataset.h5...
Loading test dataset from preprocessing\data\chb03_fold5\test_dataset.h5...
  - Normalization: z-score, mean=-0.5849, std=2.1662
  - Normalization: z-score, mean=-0.5849, std=2.1662
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.2693, 4.7201]
  - Value range: [-5.2693, 4.7201]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb03_fold5\epoch_005.pth...
Loading model checkpoint from model\chb03_fold5\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.65it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.65it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6428
Loss:      0.6428
Accuracy:  0.5000 (50.00%)
Accuracy:  0.5000 (50.00%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.7392
AUC-ROC:   0.7392

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        21         0
Actual Interictal        21         0
       Preictal        21         0
       Preictal        21         0

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 42 samples
Pred Interictal (0): 42 samples
Pred Preictal (1):   0 samples
Pred Preictal (1):   0 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        21
    Preictal     0.0000    0.0000    0.0000        21

    accuracy                         0.5000        42
   macro avg     0.2500    0.5000    0.3333        42
weighted avg     0.2500    0.5000    0.3333        42
              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        21
    Preictal     0.0000    0.0000    0.0000        21

    accuracy                         0.5000        42
   macro avg     0.2500    0.5000    0.3333        42
weighted avg     0.2500    0.5000    0.3333        42



✅ Results saved to model\chb03_fold5\test_results.json
✅ Results saved to model\chb03_fold5\test_results.json


============================================================
============================================================

EVALUATING FOLD 6/6
EVALUATING FOLD 6/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb03_fold6
Dataset prefix: chb03_fold6
Using test dataset: preprocessing\data\chb03_fold6\test_dataset.h5
Using test dataset: preprocessing\data\chb03_fold6\test_dataset.h5
Loading test dataset from preprocessing\data\chb03_fold6\test_dataset.h5...
Loading test dataset from preprocessing\data\chb03_fold6\test_dataset.h5...
  - Normalization: z-score, mean=-0.5074, std=2.1609
  - Normalization: z-score, mean=-0.5074, std=2.1609
Loaded test dataset: 321 samples
Loaded test dataset: 321 samples
  - Spectrogram shape: torch.Size([321, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([321, 30, 18, 50, 10])
  - Value range: [-5.3185, 4.2702]
  - Value range: [-5.3185, 4.2702]
  - Class distribution: tensor([321])
  - Class distribution: tensor([321])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb03_fold6\epoch_005.pth...
Loading model checkpoint from model\chb03_fold6\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                      | 0/21 [00:00<?, ?it/s]Testing:   0%|                                      | 0/21 [00:00<?, ?it/s]Testing:  19%|#####7                        | 4/21 [00:00<00:00, 31.04it/s]Testing:  19%|#####7                        | 4/21 [00:00<00:00, 31.04it/s]Testing:  38%|###########4                  | 8/21 [00:00<00:00, 31.54it/s]Testing:  38%|###########4                  | 8/21 [00:00<00:00, 31.54it/s]Testing:  57%|################5            | 12/21 [00:00<00:00, 31.69it/s]Testing:  57%|################5            | 12/21 [00:00<00:00, 31.69it/s]Testing:  76%|######################       | 16/21 [00:00<00:00, 31.73it/s]Testing:  76%|######################       | 16/21 [00:00<00:00, 31.73it/s]Testing:  95%|###########################6 | 20/21 [00:00<00:00, 31.81it/s]Testing:  95%|###########################6 | 20/21 [00:00<00:00, 31.81it/s]Testing: 100%|#############################| 21/21 [00:00<00:00, 32.24it/s]Testing: 100%|#############################| 21/21 [00:00<00:00, 32.24it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.5311
Loss:      0.5311
Accuracy:  0.8972 (89.72%)
Accuracy:  0.8972 (89.72%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.0000
AUC-ROC:   0.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal       288        33
Actual Interictal       288        33
       Preictal         0         0
       Preictal         0         0

Class Distribution:
Class Distribution:

True Interictal (0): 321 samples
True Interictal (0): 321 samples
True Preictal (1):   0 samples
True Preictal (1):   0 samples
Pred Interictal (0): 288 samples
Pred Interictal (0): 288 samples
Pred Preictal (1):   33 samples
Pred Preictal (1):   33 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.8972    0.9458       321
    Preictal     0.0000    0.0000    0.0000         0

    accuracy                         0.8972       321
   macro avg     0.5000    0.4486    0.4729       321
weighted avg     1.0000    0.8972    0.9458       321
              precision    recall  f1-score   support

  Interictal     1.0000    0.8972    0.9458       321
    Preictal     0.0000    0.0000    0.0000         0

    accuracy                         0.8972       321
   macro avg     0.5000    0.4486    0.4729       321
weighted avg     1.0000    0.8972    0.9458       321



✅ Results saved to model\chb03_fold6\test_results.json
✅ Results saved to model\chb03_fold6\test_results.json


============================================================
============================================================

BATCH EVALUATION SUMMARY
BATCH EVALUATION SUMMARY
============================================================
============================================================
Folds evaluated: 7/7
Folds evaluated: 7/7

Mean metrics (across folds):
Mean metrics (across folds):

  Accuracy:  0.6770 (±0.2225)
  Accuracy:  0.6770 (±0.2225)
  Precision: 0.4102 (±0.3915)
  Precision: 0.4102 (±0.3915)
  Recall:    0.4226 (±0.4118)
  Recall:    0.4226 (±0.4118)
  F1 Score:  0.4143 (±0.3977)
  F1 Score:  0.4143 (±0.3977)
  AUC-ROC:   0.5465 (±0.3411)
  AUC-ROC:   0.5465 (±0.3411)

✅ Batch results saved to model\batch_test_results.json
✅ Batch results saved to model\batch_test_results.json

============================================================
============================================================
