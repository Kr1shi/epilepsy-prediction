============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb10
============================================================

Configuration:
  - Task mode: PREDICTION (preictal vs interictal)
  - LOOCV Mode: ENABLED
  - Sequence length: 30 segments
  - Sequence duration: 150s (2.5 min)
  - Stride: 5 segments (83% overlap)
  - Segment duration: 5s
  - Preictal window: 10 min
  - Interictal buffer: 120 min
  - Channel validation: ENABLED
  - Target channels: 18 channels
============================================================

Extracting sequences from patient chb10...
Patient chb10: 883 sequences (149 preictal, 734 interictal)

============================================================
PROCESSING FOLD 0/6
============================================================
Output prefix: chb10_fold0
LOOCV Fold 0: Test seizure=0, Train seizures=[1, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 298
  - Preictal sequences: 149
  - Interictal sequences: 149
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb10: 298 total (149 preictal, 149 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 260 total (130 preictal, 130 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 265.1s (4.4 min)
Class balance: 149/149 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 130 preictal, 130 interictal (dropped 0 preictal, 237 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 348 interictal)

Sequences saved to chb10_fold0_sequences_prediction.json
File size: 0.50 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 25
Files with valid channels: 25
Files with invalid channels: 0

✅ Fold 0 completed successfully!
✅ Sequences saved to chb10_fold0_sequences_prediction.json

============================================================
PROCESSING FOLD 1/6
============================================================
Output prefix: chb10_fold1
LOOCV Fold 1: Test seizure=1, Train seizures=[0, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 298
  - Preictal sequences: 149
  - Interictal sequences: 149
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb10: 298 total (149 preictal, 149 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 250 total (125 preictal, 125 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 265.1s (4.4 min)
Class balance: 149/149 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 125 preictal, 125 interictal (dropped 0 preictal, 242 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 343 interictal)

Sequences saved to chb10_fold1_sequences_prediction.json
File size: 0.50 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 25
Files with valid channels: 25
Files with invalid channels: 0

✅ Fold 1 completed successfully!
✅ Sequences saved to chb10_fold1_sequences_prediction.json

============================================================
PROCESSING FOLD 2/6
============================================================
Output prefix: chb10_fold2
LOOCV Fold 2: Test seizure=2, Train seizures=[0, 1, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 298
  - Preictal sequences: 149
  - Interictal sequences: 149
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb10: 298 total (149 preictal, 149 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 250 total (125 preictal, 125 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 265.1s (4.4 min)
Class balance: 149/149 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 125 preictal, 125 interictal (dropped 0 preictal, 242 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 343 interictal)

Sequences saved to chb10_fold2_sequences_prediction.json
File size: 0.50 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 25
Files with valid channels: 25
Files with invalid channels: 0

✅ Fold 2 completed successfully!
✅ Sequences saved to chb10_fold2_sequences_prediction.json

============================================================
PROCESSING FOLD 3/6
============================================================
Output prefix: chb10_fold3
LOOCV Fold 3: Test seizure=3, Train seizures=[0, 1, 2, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 298
  - Preictal sequences: 149
  - Interictal sequences: 149
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb10: 298 total (149 preictal, 149 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 260 total (130 preictal, 130 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 265.1s (4.4 min)
Class balance: 149/149 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 130 preictal, 130 interictal (dropped 0 preictal, 237 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 348 interictal)

Sequences saved to chb10_fold3_sequences_prediction.json
File size: 0.50 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 25
Files with valid channels: 25
Files with invalid channels: 0

✅ Fold 3 completed successfully!
✅ Sequences saved to chb10_fold3_sequences_prediction.json

============================================================
PROCESSING FOLD 4/6
============================================================
Output prefix: chb10_fold4
LOOCV Fold 4: Test seizure=4, Train seizures=[0, 1, 2, 3, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 298
  - Preictal sequences: 149
  - Interictal sequences: 149
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb10: 298 total (149 preictal, 149 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 258 total (129 preictal, 129 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 265.1s (4.4 min)
Class balance: 149/149 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 129 preictal, 129 interictal (dropped 0 preictal, 238 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 347 interictal)

Sequences saved to chb10_fold4_sequences_prediction.json
File size: 0.50 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 25
Files with valid channels: 25
Files with invalid channels: 0

✅ Fold 4 completed successfully!
✅ Sequences saved to chb10_fold4_sequences_prediction.json

============================================================
PROCESSING FOLD 5/6
============================================================
Output prefix: chb10_fold5
LOOCV Fold 5: Test seizure=5, Train seizures=[0, 1, 2, 3, 4, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 298
  - Preictal sequences: 149
  - Interictal sequences: 149
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb10: 298 total (149 preictal, 149 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 252 total (126 preictal, 126 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 265.1s (4.4 min)
Class balance: 149/149 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 126 preictal, 126 interictal (dropped 0 preictal, 241 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 344 interictal)

Sequences saved to chb10_fold5_sequences_prediction.json
File size: 0.50 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 25
Files with valid channels: 25
Files with invalid channels: 0

✅ Fold 5 completed successfully!
✅ Sequences saved to chb10_fold5_sequences_prediction.json

============================================================
PROCESSING FOLD 6/6
============================================================
Output prefix: chb10_fold6
LOOCV Fold 6: Test seizure=6, Train seizures=[0, 1, 2, 3, 4, 5]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 298
  - Preictal sequences: 149
  - Interictal sequences: 149
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb10: 298 total (149 preictal, 149 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 258 total (129 preictal, 129 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 265.1s (4.4 min)
Class balance: 149/149 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 129 preictal, 129 interictal (dropped 0 preictal, 238 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 347 interictal)

Sequences saved to chb10_fold6_sequences_prediction.json
File size: 0.50 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 25
Files with valid channels: 25
Files with invalid channels: 0

✅ Fold 6 completed successfully!
✅ Sequences saved to chb10_fold6_sequences_prediction.json

============================================================
✅ BATCH PROCESSING COMPLETED!
✅ Processed 7 folds for patient chb10
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb10
============================================================

============================================================
PREPROCESSING FOLD 0/6
============================================================
2025-11-20 12:02:55,249 - INFO - ============================================================
2025-11-20 12:02:55,249 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 12:02:55,249 - INFO - ============================================================
2025-11-20 12:02:55,249 - INFO - Output prefix: chb10_fold0
2025-11-20 12:02:55,249 - INFO - EEG Preprocessor initialized
2025-11-20 12:02:55,249 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 12:02:55,249 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 12:02:55,249 - INFO - Segment duration: 5 seconds
2025-11-20 12:02:55,249 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 12:02:55,249 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 12:02:55,249 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 12:02:55,249 - INFO - Loading segments from chb10_fold0_sequences_prediction.json
2025-11-20 12:02:55,261 - INFO - Loaded 298 total sequences
2025-11-20 12:02:55,261 - INFO - Channel validation (from segmentation): 25/25 files valid
2025-11-20 12:02:55,261 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 12:02:55,261 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 12:02:55,261 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 12:02:55,261 - INFO - train: 260 sequences (130 preictal, 130 interictal)
2025-11-20 12:02:55,261 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-20 12:02:55,277 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 12:02:55,277 - INFO - train: kept 130 preictal and 130 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:02:55,277 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:02:55,292 - INFO - ============================================================
2025-11-20 12:02:55,292 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 12:02:55,292 - INFO - ============================================================
2025-11-20 12:02:55,292 - INFO - Processing 260 training samples to compute normalization stats...
2025-11-20 12:02:55,292 - INFO - Processing 260 sequences from 23 unique files
Processing training data:   0%|                    | 0/260 [00:00<?, ?it/s]Processing training data:   0%|            | 1/260 [00:04<21:26,  4.97s/it]Processing training data:   4%|4          | 10/260 [00:07<02:36,  1.60it/s]Processing training data:   6%|6          | 16/260 [00:08<01:38,  2.47it/s]Processing training data:  15%|#6         | 40/260 [00:09<00:29,  7.41it/s]Processing training data:  25%|##7        | 64/260 [00:10<00:16, 11.83it/s]Processing training data:  33%|###6       | 87/260 [00:10<00:11, 15.58it/s]Processing training data:  41%|####      | 106/260 [00:13<00:14, 10.56it/s]Processing training data:  44%|####3     | 114/260 [00:17<00:21,  6.84it/s]Processing training data:  48%|####8     | 125/260 [00:19<00:21,  6.14it/s]Processing training data:  52%|#####1    | 135/260 [00:20<00:18,  6.89it/s]Processing training data:  60%|#####9    | 155/260 [00:23<00:16,  6.46it/s]Processing training data:  63%|######2   | 163/260 [00:24<00:13,  6.97it/s]Processing training data:  70%|#######   | 183/260 [00:25<00:08,  9.40it/s]Processing training data:  71%|#######1  | 185/260 [00:28<00:13,  5.69it/s]Processing training data:  75%|#######4  | 194/260 [00:31<00:14,  4.49it/s]Processing training data:  78%|#######7  | 202/260 [00:34<00:15,  3.74it/s]Processing training data:  81%|########1 | 211/260 [00:38<00:14,  3.34it/s]Processing training data:  85%|########4 | 220/260 [00:41<00:13,  3.04it/s]Processing training data:  87%|########7 | 227/260 [00:43<00:10,  3.24it/s]Processing training data:  88%|########8 | 230/260 [00:47<00:12,  2.35it/s]Processing training data:  92%|#########1| 239/260 [00:49<00:07,  2.79it/s]Processing training data:  94%|#########4| 245/260 [00:51<00:05,  2.78it/s]Processing training data:  97%|#########6| 252/260 [00:54<00:03,  2.53it/s]Processing training data: 100%|##########| 260/260 [00:54<00:00,  4.73it/s]
2025-11-20 12:03:50,221 - INFO - Computing normalization statistics from training data...
2025-11-20 12:03:50,683 - INFO - Normalization stats computed:
2025-11-20 12:03:50,683 - INFO -   Mean: 0.326774
2025-11-20 12:03:50,683 - INFO -   Std: 2.658467
2025-11-20 12:03:50,683 - INFO -   Saved to: preprocessing\checkpoints\chb10_fold0\normalization_stats.json
2025-11-20 12:03:50,730 - INFO - Applying normalization and saving 260 training sequences...
Normalizing and saving training data:   0%|        | 0/260 [00:00<?, ?it/s]2025-11-20 12:03:50,739 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold0\train_dataset.h5
Normalizing and saving training data:   4%| | 10/260 [00:00<00:16, 15.24it/Normalizing and saving training data:   8%| | 20/260 [00:01<00:15, 15.09it/Normalizing and saving training data:  12%|1| 30/260 [00:01<00:15, 15.22it/Normalizing and saving training data:  15%|1| 40/260 [00:02<00:14, 15.33it/Normalizing and saving training data:  19%|1| 50/260 [00:03<00:13, 15.07it/Normalizing and saving training data:  23%|2| 60/260 [00:03<00:13, 15.12it/Normalizing and saving training data:  27%|2| 70/260 [00:04<00:12, 15.20it/Normalizing and saving training data:  31%|3| 80/260 [00:05<00:11, 15.18it/Normalizing and saving training data:  35%|3| 90/260 [00:05<00:11, 15.24it/Normalizing and saving training data:  38%|3| 100/260 [00:06<00:10, 15.35itNormalizing and saving training data:  42%|4| 110/260 [00:07<00:09, 15.32itNormalizing and saving training data:  46%|4| 120/260 [00:07<00:09, 15.33itNormalizing and saving training data:  50%|5| 130/260 [00:08<00:08, 15.31itNormalizing and saving training data:  54%|5| 140/260 [00:09<00:07, 15.21itNormalizing and saving training data:  58%|5| 150/260 [00:09<00:07, 15.26itNormalizing and saving training data:  62%|6| 160/260 [00:10<00:06, 15.21itNormalizing and saving training data:  65%|6| 170/260 [00:11<00:05, 15.16itNormalizing and saving training data:  69%|6| 180/260 [00:11<00:05, 15.25itNormalizing and saving training data:  73%|7| 190/260 [00:12<00:04, 15.30itNormalizing and saving training data:  77%|7| 200/260 [00:13<00:03, 15.28itNormalizing and saving training data:  81%|8| 210/260 [00:13<00:03, 15.29itNormalizing and saving training data:  85%|8| 220/260 [00:14<00:02, 15.22itNormalizing and saving training data:  88%|8| 230/260 [00:15<00:01, 15.28itNormalizing and saving training data:  92%|9| 240/260 [00:15<00:01, 15.33itNormalizing and saving training data:  96%|9| 250/260 [00:16<00:00, 15.33itNormalizing and saving training data: 100%|#| 260/260 [00:17<00:00, 14.96itNormalizing and saving training data: 100%|#| 260/260 [00:17<00:00, 15.21it
2025-11-20 12:04:07,840 - INFO - Training data processing completed during stats computation phase
2025-11-20 12:04:07,848 - INFO - Loaded normalization statistics:
2025-11-20 12:04:07,848 - INFO -   Mean: 0.326774
2025-11-20 12:04:07,848 - INFO -   Std: 2.658467
2025-11-20 12:04:07,848 - INFO - Split train already completed, skipping
2025-11-20 12:04:07,848 - INFO - Processing test split...
2025-11-20 12:04:07,848 - INFO - Need to process 38/38 sequences for test
2025-11-20 12:04:07,848 - INFO - Processing 38 sequences from 10 unique files
2025-11-20 12:04:07,848 - INFO - Average 3.8 sequences per file
Processing test:   0%|                              | 0/38 [00:00<?, ?it/s]Processing test:   3%|5                     | 1/38 [00:01<00:37,  1.02s/it]2025-11-20 12:04:08,870 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold0\test_dataset.h5
2025-11-20 12:04:10,112 - INFO - Progress: 279/298 (93.6%) - ETA: 0.1 minutes
Processing test:  53%|###########          | 20/38 [00:04<00:03,  4.93it/s]Processing test:  58%|############1        | 22/38 [00:05<00:03,  4.06it/s]Processing test:  63%|#############2       | 24/38 [00:06<00:03,  3.73it/s]Processing test:  68%|##############3      | 26/38 [00:06<00:03,  3.43it/s]Processing test:  74%|###############4     | 28/38 [00:08<00:03,  2.93it/s]2025-11-20 12:04:16,536 - INFO - Progress: 289/298 (97.0%) - ETA: 0.0 minutes
Processing test:  79%|################5    | 30/38 [00:12<00:05,  1.37it/s]Processing test:  89%|##################7  | 34/38 [00:15<00:02,  1.36it/s]Processing test:  97%|####################4| 37/38 [00:15<00:00,  1.73it/s]Processing test: 100%|#####################| 38/38 [00:16<00:00,  1.76it/s]Processing test: 100%|#####################| 38/38 [00:16<00:00,  2.34it/s]
2025-11-20 12:04:24,679 - INFO - Validating final datasets...
2025-11-20 12:04:24,687 - INFO - train dataset validation:
2025-11-20 12:04:24,687 - INFO -   - Segments: 260
2025-11-20 12:04:24,687 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:04:24,687 - INFO -   - Classes: 130 preictal, 130 interictal
2025-11-20 12:04:24,687 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:04:24,693 - INFO - test dataset validation:
2025-11-20 12:04:24,693 - INFO -   - Segments: 38
2025-11-20 12:04:24,693 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:04:24,693 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-20 12:04:24,693 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:04:24,693 - INFO - ============================================================
2025-11-20 12:04:24,693 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 12:04:24,693 - INFO - Total time: 1.5 minutes
2025-11-20 12:04:24,693 - INFO - Processed segments: 298
2025-11-20 12:04:24,693 - INFO - Average rate: 3.3 segments/second
2025-11-20 12:04:24,694 - INFO - ============================================================
✅ Fold 0 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 1/6
============================================================
2025-11-20 12:04:24,769 - INFO - ============================================================
2025-11-20 12:04:24,769 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 12:04:24,769 - INFO - ============================================================
2025-11-20 12:04:24,769 - INFO - Output prefix: chb10_fold1
2025-11-20 12:04:24,769 - INFO - EEG Preprocessor initialized
2025-11-20 12:04:24,769 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 12:04:24,769 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 12:04:24,769 - INFO - Segment duration: 5 seconds
2025-11-20 12:04:24,769 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 12:04:24,769 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 12:04:24,769 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 12:04:24,770 - INFO - Loading segments from chb10_fold1_sequences_prediction.json
2025-11-20 12:04:24,782 - INFO - Loaded 298 total sequences
2025-11-20 12:04:24,782 - INFO - Channel validation (from segmentation): 25/25 files valid
2025-11-20 12:04:24,783 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 12:04:24,783 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 12:04:24,783 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 12:04:24,783 - INFO - train: 250 sequences (125 preictal, 125 interictal)
2025-11-20 12:04:24,783 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-20 12:04:24,798 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 12:04:24,799 - INFO - train: kept 125 preictal and 125 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:04:24,799 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:04:24,814 - INFO - ============================================================
2025-11-20 12:04:24,814 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 12:04:24,814 - INFO - ============================================================
2025-11-20 12:04:24,814 - INFO - Processing 250 training samples to compute normalization stats...
2025-11-20 12:04:24,814 - INFO - Processing 250 sequences from 23 unique files
Processing training data:   0%|                    | 0/250 [00:00<?, ?it/s]Processing training data:   0%|            | 1/250 [00:02<11:15,  2.71s/it]Processing training data:   2%|2           | 6/250 [00:05<03:18,  1.23it/s]Processing training data:   5%|5          | 12/250 [00:07<02:07,  1.87it/s]Processing training data:   7%|7          | 18/250 [00:10<02:07,  1.83it/s]Processing training data:  12%|#2         | 29/250 [00:12<01:06,  3.31it/s]Processing training data:  13%|#4         | 32/250 [00:15<01:34,  2.31it/s]Processing training data:  17%|#8         | 42/250 [00:17<01:12,  2.86it/s]Processing training data:  19%|##1        | 48/250 [00:18<00:58,  3.48it/s]Processing training data:  27%|##9        | 67/250 [00:21<00:40,  4.52it/s]Processing training data:  31%|###4       | 78/250 [00:24<00:39,  4.39it/s]Processing training data:  34%|###7       | 86/250 [00:27<00:44,  3.66it/s]Processing training data:  37%|####       | 93/250 [00:30<00:47,  3.28it/s]Processing training data:  41%|####      | 102/250 [00:31<00:35,  4.16it/s]Processing training data:  49%|####8     | 122/250 [00:31<00:17,  7.14it/s]Processing training data:  57%|#####6    | 142/250 [00:32<00:10, 10.31it/s]Processing training data:  64%|######4   | 161/250 [00:33<00:06, 12.88it/s]Processing training data:  74%|#######4  | 185/250 [00:34<00:03, 16.73it/s]Processing training data:  83%|########3 | 208/250 [00:37<00:03, 10.79it/s]Processing training data:  87%|########7 | 218/250 [00:38<00:03, 10.35it/s]Processing training data:  90%|########9 | 224/250 [00:41<00:03,  6.67it/s]Processing training data:  93%|#########2| 232/250 [00:45<00:03,  4.86it/s]Processing training data:  96%|#########5| 239/250 [00:48<00:02,  4.09it/s]Processing training data:  97%|#########7| 243/250 [00:51<00:02,  3.18it/s]Processing training data: 100%|##########| 250/250 [00:51<00:00,  4.89it/s]
2025-11-20 12:05:15,928 - INFO - Computing normalization statistics from training data...
2025-11-20 12:05:16,342 - INFO - Normalization stats computed:
2025-11-20 12:05:16,342 - INFO -   Mean: 0.258079
2025-11-20 12:05:16,342 - INFO -   Std: 2.666171
2025-11-20 12:05:16,342 - INFO -   Saved to: preprocessing\checkpoints\chb10_fold1\normalization_stats.json
2025-11-20 12:05:16,389 - INFO - Applying normalization and saving 250 training sequences...
Normalizing and saving training data:   0%|        | 0/250 [00:00<?, ?it/s]2025-11-20 12:05:16,400 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold1\train_dataset.h5
Normalizing and saving training data:   4%| | 10/250 [00:00<00:15, 15.82it/Normalizing and saving training data:   8%| | 20/250 [00:01<00:14, 15.76it/Normalizing and saving training data:  12%|1| 30/250 [00:01<00:13, 15.82it/Normalizing and saving training data:  16%|1| 40/250 [00:02<00:13, 15.90it/Normalizing and saving training data:  20%|2| 50/250 [00:03<00:12, 15.87it/Normalizing and saving training data:  24%|2| 60/250 [00:03<00:11, 15.92it/Normalizing and saving training data:  28%|2| 70/250 [00:04<00:11, 15.98it/Normalizing and saving training data:  32%|3| 80/250 [00:05<00:10, 15.97it/Normalizing and saving training data:  36%|3| 90/250 [00:05<00:10, 15.88it/Normalizing and saving training data:  40%|4| 100/250 [00:06<00:09, 15.94itNormalizing and saving training data:  44%|4| 110/250 [00:06<00:08, 15.81itNormalizing and saving training data:  48%|4| 120/250 [00:07<00:08, 15.81itNormalizing and saving training data:  52%|5| 130/250 [00:08<00:07, 15.73itNormalizing and saving training data:  56%|5| 140/250 [00:08<00:07, 15.53itNormalizing and saving training data:  60%|6| 150/250 [00:09<00:06, 15.43itNormalizing and saving training data:  64%|6| 160/250 [00:10<00:05, 15.33itNormalizing and saving training data:  68%|6| 170/250 [00:10<00:05, 15.17itNormalizing and saving training data:  72%|7| 180/250 [00:11<00:04, 15.25itNormalizing and saving training data:  76%|7| 190/250 [00:12<00:03, 15.33itNormalizing and saving training data:  80%|8| 200/250 [00:12<00:03, 14.97itNormalizing and saving training data:  84%|8| 210/250 [00:13<00:02, 15.11itNormalizing and saving training data:  88%|8| 220/250 [00:14<00:01, 15.21itNormalizing and saving training data:  92%|9| 230/250 [00:14<00:01, 15.20itNormalizing and saving training data:  96%|9| 240/250 [00:15<00:00, 15.16itNormalizing and saving training data: 100%|#| 250/250 [00:16<00:00, 15.28itNormalizing and saving training data: 100%|#| 250/250 [00:16<00:00, 15.51it
2025-11-20 12:05:32,525 - INFO - Training data processing completed during stats computation phase
2025-11-20 12:05:32,532 - INFO - Loaded normalization statistics:
2025-11-20 12:05:32,532 - INFO -   Mean: 0.258079
2025-11-20 12:05:32,532 - INFO -   Std: 2.666171
2025-11-20 12:05:32,532 - INFO - Split train already completed, skipping
2025-11-20 12:05:32,532 - INFO - Processing test split...
2025-11-20 12:05:32,532 - INFO - Need to process 48/48 sequences for test
2025-11-20 12:05:32,532 - INFO - Processing 48 sequences from 15 unique files
2025-11-20 12:05:32,532 - INFO - Average 3.2 sequences per file
Processing test:   0%|                              | 0/48 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/48 [00:00<00:24,  1.94it/s]Processing test:   4%|9                     | 2/48 [00:02<01:02,  1.36s/it]Processing test:  10%|##2                   | 5/48 [00:03<00:24,  1.75it/s]2025-11-20 12:05:35,779 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold1\test_dataset.h5
2025-11-20 12:05:37,496 - INFO - Progress: 278/298 (93.3%) - ETA: 0.1 minutes
Processing test:  60%|############6        | 29/48 [00:07<00:04,  4.41it/s]Processing test:  65%|#############5       | 31/48 [00:08<00:03,  4.39it/s]Processing test:  67%|##############       | 32/48 [00:08<00:04,  3.87it/s]Processing test:  71%|##############8      | 34/48 [00:09<00:03,  3.92it/s]Processing test:  73%|###############3     | 35/48 [00:12<00:07,  1.77it/s]2025-11-20 12:05:45,849 - INFO - Progress: 288/298 (96.6%) - ETA: 0.0 minutes
Processing test:  81%|#################    | 39/48 [00:13<00:04,  2.17it/s]Processing test:  83%|#################5   | 40/48 [00:16<00:06,  1.30it/s]Processing test:  90%|##################8  | 43/48 [00:18<00:03,  1.55it/s]Processing test:  94%|###################6 | 45/48 [00:18<00:01,  1.82it/s]Processing test:  96%|####################1| 46/48 [00:19<00:01,  1.86it/s]Processing test:  98%|####################5| 47/48 [00:19<00:00,  1.91it/s]Processing test: 100%|#####################| 48/48 [00:19<00:00,  1.96it/s]2025-11-20 12:05:53,145 - INFO - Progress: 298/298 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 48/48 [00:20<00:00,  2.33it/s]
2025-11-20 12:05:53,161 - INFO - Validating final datasets...
2025-11-20 12:05:53,170 - INFO - train dataset validation:
2025-11-20 12:05:53,170 - INFO -   - Segments: 250
2025-11-20 12:05:53,170 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:05:53,170 - INFO -   - Classes: 125 preictal, 125 interictal
2025-11-20 12:05:53,170 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:05:53,175 - INFO - test dataset validation:
2025-11-20 12:05:53,175 - INFO -   - Segments: 48
2025-11-20 12:05:53,175 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:05:53,175 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-20 12:05:53,175 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:05:53,175 - INFO - ============================================================
2025-11-20 12:05:53,175 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 12:05:53,175 - INFO - Total time: 1.5 minutes
2025-11-20 12:05:53,175 - INFO - Processed segments: 298
2025-11-20 12:05:53,175 - INFO - Average rate: 3.4 segments/second
2025-11-20 12:05:53,176 - INFO - ============================================================
✅ Fold 1 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 2/6
============================================================
2025-11-20 12:05:53,243 - INFO - ============================================================
2025-11-20 12:05:53,244 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 12:05:53,244 - INFO - ============================================================
2025-11-20 12:05:53,244 - INFO - Output prefix: chb10_fold2
2025-11-20 12:05:53,244 - INFO - EEG Preprocessor initialized
2025-11-20 12:05:53,244 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 12:05:53,244 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 12:05:53,244 - INFO - Segment duration: 5 seconds
2025-11-20 12:05:53,244 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 12:05:53,244 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 12:05:53,244 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 12:05:53,244 - INFO - Loading segments from chb10_fold2_sequences_prediction.json
2025-11-20 12:05:53,255 - INFO - Loaded 298 total sequences
2025-11-20 12:05:53,255 - INFO - Channel validation (from segmentation): 25/25 files valid
2025-11-20 12:05:53,255 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 12:05:53,255 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 12:05:53,255 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 12:05:53,255 - INFO - train: 250 sequences (125 preictal, 125 interictal)
2025-11-20 12:05:53,255 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-20 12:05:53,271 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 12:05:53,272 - INFO - train: kept 125 preictal and 125 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:05:53,272 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:05:53,287 - INFO - ============================================================
2025-11-20 12:05:53,287 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 12:05:53,287 - INFO - ============================================================
2025-11-20 12:05:53,287 - INFO - Processing 250 training samples to compute normalization stats...
2025-11-20 12:05:53,287 - INFO - Processing 250 sequences from 23 unique files
Processing training data:   0%|                    | 0/250 [00:00<?, ?it/s]Processing training data:   0%|            | 1/250 [00:02<09:25,  2.27s/it]Processing training data:   4%|4           | 9/250 [00:02<01:03,  3.80it/s]Processing training data:  12%|#2         | 29/250 [00:06<00:39,  5.53it/s]Processing training data:  16%|#7         | 40/250 [00:08<00:44,  4.72it/s]Processing training data:  20%|##1        | 49/250 [00:11<00:47,  4.23it/s]Processing training data:  23%|##5        | 57/250 [00:12<00:37,  5.11it/s]Processing training data:  31%|###3       | 77/250 [00:15<00:30,  5.69it/s]Processing training data:  34%|###7       | 86/250 [00:17<00:31,  5.17it/s]Processing training data:  37%|####       | 93/250 [00:20<00:39,  3.97it/s]Processing training data:  40%|####      | 100/250 [00:21<00:33,  4.54it/s]Processing training data:  48%|####7     | 119/250 [00:22<00:17,  7.41it/s]Processing training data:  57%|#####6    | 142/250 [00:26<00:15,  6.97it/s]Processing training data:  60%|######    | 150/250 [00:26<00:13,  7.32it/s]Processing training data:  70%|######9   | 174/250 [00:27<00:06, 11.08it/s]Processing training data:  77%|#######7  | 193/250 [00:30<00:06,  9.14it/s]Processing training data:  80%|########  | 201/250 [00:34<00:08,  6.04it/s]Processing training data:  84%|########3 | 209/250 [00:36<00:07,  5.51it/s]Processing training data:  87%|########6 | 217/250 [00:39<00:07,  4.34it/s]Processing training data:  90%|########9 | 224/250 [00:42<00:07,  3.63it/s]Processing training data:  92%|#########2| 230/250 [00:45<00:06,  3.01it/s]Processing training data:  95%|#########5| 238/250 [00:47<00:03,  3.53it/s]Processing training data:  96%|#########6| 240/250 [00:50<00:04,  2.41it/s]Processing training data: 100%|##########| 250/250 [00:51<00:00,  3.66it/s]Processing training data: 100%|##########| 250/250 [00:51<00:00,  4.90it/s]
2025-11-20 12:06:44,294 - INFO - Computing normalization statistics from training data...
2025-11-20 12:06:44,744 - INFO - Normalization stats computed:
2025-11-20 12:06:44,744 - INFO -   Mean: 0.363741
2025-11-20 12:06:44,744 - INFO -   Std: 2.662814
2025-11-20 12:06:44,744 - INFO -   Saved to: preprocessing\checkpoints\chb10_fold2\normalization_stats.json
2025-11-20 12:06:44,789 - INFO - Applying normalization and saving 250 training sequences...
Normalizing and saving training data:   0%|        | 0/250 [00:00<?, ?it/s]2025-11-20 12:06:44,797 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold2\train_dataset.h5
Normalizing and saving training data:   4%| | 10/250 [00:00<00:14, 16.24it/Normalizing and saving training data:   8%| | 20/250 [00:01<00:14, 15.99it/Normalizing and saving training data:  12%|1| 30/250 [00:01<00:13, 15.93it/Normalizing and saving training data:  16%|1| 40/250 [00:02<00:13, 15.94it/Normalizing and saving training data:  20%|2| 50/250 [00:03<00:12, 15.96it/Normalizing and saving training data:  24%|2| 60/250 [00:03<00:11, 15.92it/Normalizing and saving training data:  28%|2| 70/250 [00:04<00:11, 15.92it/Normalizing and saving training data:  32%|3| 80/250 [00:05<00:10, 15.91it/Normalizing and saving training data:  36%|3| 90/250 [00:05<00:10, 15.89it/Normalizing and saving training data:  40%|4| 100/250 [00:06<00:09, 15.82itNormalizing and saving training data:  44%|4| 110/250 [00:06<00:08, 15.83itNormalizing and saving training data:  48%|4| 120/250 [00:07<00:08, 15.86itNormalizing and saving training data:  52%|5| 130/250 [00:08<00:07, 15.85itNormalizing and saving training data:  56%|5| 140/250 [00:08<00:06, 15.81itNormalizing and saving training data:  60%|6| 150/250 [00:09<00:06, 15.69itNormalizing and saving training data:  64%|6| 160/250 [00:10<00:05, 15.71itNormalizing and saving training data:  68%|6| 170/250 [00:10<00:05, 15.58itNormalizing and saving training data:  72%|7| 180/250 [00:11<00:04, 15.59itNormalizing and saving training data:  76%|7| 190/250 [00:12<00:03, 15.60itNormalizing and saving training data:  80%|8| 200/250 [00:12<00:03, 15.51itNormalizing and saving training data:  84%|8| 210/250 [00:13<00:02, 15.49itNormalizing and saving training data:  88%|8| 220/250 [00:13<00:01, 15.52itNormalizing and saving training data:  92%|9| 230/250 [00:14<00:01, 15.57itNormalizing and saving training data:  96%|9| 240/250 [00:15<00:00, 15.64itNormalizing and saving training data: 100%|#| 250/250 [00:15<00:00, 15.62itNormalizing and saving training data: 100%|#| 250/250 [00:15<00:00, 15.73it
2025-11-20 12:07:00,694 - INFO - Training data processing completed during stats computation phase
2025-11-20 12:07:00,702 - INFO - Loaded normalization statistics:
2025-11-20 12:07:00,702 - INFO -   Mean: 0.363741
2025-11-20 12:07:00,702 - INFO -   Std: 2.662814
2025-11-20 12:07:00,702 - INFO - Split train already completed, skipping
2025-11-20 12:07:00,702 - INFO - Processing test split...
2025-11-20 12:07:00,702 - INFO - Need to process 48/48 sequences for test
2025-11-20 12:07:00,702 - INFO - Processing 48 sequences from 15 unique files
2025-11-20 12:07:00,702 - INFO - Average 3.2 sequences per file
Processing test:   0%|                              | 0/48 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/48 [00:00<00:24,  1.95it/s]Processing test:   4%|9                     | 2/48 [00:01<00:33,  1.39it/s]2025-11-20 12:07:02,077 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold2\test_dataset.h5
2025-11-20 12:07:03,643 - INFO - Progress: 275/298 (92.3%) - ETA: 0.1 minutes
Processing test:  54%|###########3         | 26/48 [00:04<00:03,  6.25it/s]Processing test:  58%|############2        | 28/48 [00:07<00:05,  3.57it/s]Processing test:  69%|##############4      | 33/48 [00:09<00:04,  3.01it/s]Processing test:  73%|###############3     | 35/48 [00:11<00:05,  2.38it/s]2025-11-20 12:07:13,018 - INFO - Progress: 286/298 (96.0%) - ETA: 0.1 minutes
Processing test:  77%|################1    | 37/48 [00:12<00:04,  2.20it/s]Processing test:  79%|################6    | 38/48 [00:13<00:04,  2.15it/s]Processing test:  81%|#################    | 39/48 [00:15<00:05,  1.59it/s]Processing test:  85%|#################9   | 41/48 [00:15<00:03,  1.84it/s]Processing test:  88%|##################3  | 42/48 [00:19<00:05,  1.02it/s]Processing test:  92%|###################2 | 44/48 [00:20<00:03,  1.06it/s]Processing test:  96%|####################1| 46/48 [00:21<00:01,  1.37it/s]2025-11-20 12:07:22,665 - INFO - Progress: 296/298 (99.3%) - ETA: 0.0 minutes
Processing test:  98%|####################5| 47/48 [00:22<00:00,  1.23it/s]Processing test: 100%|#####################| 48/48 [00:23<00:00,  1.32it/s]Processing test: 100%|#####################| 48/48 [00:23<00:00,  2.08it/s]
2025-11-20 12:07:23,911 - INFO - Validating final datasets...
2025-11-20 12:07:23,919 - INFO - train dataset validation:
2025-11-20 12:07:23,919 - INFO -   - Segments: 250
2025-11-20 12:07:23,919 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:07:23,919 - INFO -   - Classes: 125 preictal, 125 interictal
2025-11-20 12:07:23,919 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:07:23,924 - INFO - test dataset validation:
2025-11-20 12:07:23,924 - INFO -   - Segments: 48
2025-11-20 12:07:23,924 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:07:23,924 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-20 12:07:23,924 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:07:23,924 - INFO - ============================================================
2025-11-20 12:07:23,924 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 12:07:23,924 - INFO - Total time: 1.5 minutes
2025-11-20 12:07:23,924 - INFO - Processed segments: 298
2025-11-20 12:07:23,925 - INFO - Average rate: 3.3 segments/second
2025-11-20 12:07:23,925 - INFO - ============================================================
✅ Fold 2 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 3/6
============================================================
2025-11-20 12:07:23,991 - INFO - ============================================================
2025-11-20 12:07:23,991 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 12:07:23,991 - INFO - ============================================================
2025-11-20 12:07:23,991 - INFO - Output prefix: chb10_fold3
2025-11-20 12:07:23,991 - INFO - EEG Preprocessor initialized
2025-11-20 12:07:23,991 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 12:07:23,991 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 12:07:23,991 - INFO - Segment duration: 5 seconds
2025-11-20 12:07:23,991 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 12:07:23,991 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 12:07:23,991 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 12:07:23,991 - INFO - Loading segments from chb10_fold3_sequences_prediction.json
2025-11-20 12:07:24,002 - INFO - Loaded 298 total sequences
2025-11-20 12:07:24,002 - INFO - Channel validation (from segmentation): 25/25 files valid
2025-11-20 12:07:24,002 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 12:07:24,002 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 12:07:24,002 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 12:07:24,002 - INFO - train: 260 sequences (130 preictal, 130 interictal)
2025-11-20 12:07:24,002 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-20 12:07:24,018 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 12:07:24,018 - INFO - train: kept 130 preictal and 130 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:07:24,018 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:07:24,033 - INFO - ============================================================
2025-11-20 12:07:24,034 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 12:07:24,034 - INFO - ============================================================
2025-11-20 12:07:24,034 - INFO - Processing 260 training samples to compute normalization stats...
2025-11-20 12:07:24,034 - INFO - Processing 260 sequences from 23 unique files
Processing training data:   0%|                    | 0/260 [00:00<?, ?it/s]Processing training data:   0%|            | 1/260 [00:02<11:27,  2.65s/it]Processing training data:   3%|3           | 8/260 [00:03<01:26,  2.92it/s]Processing training data:  12%|#3         | 32/260 [00:05<00:30,  7.36it/s]Processing training data:  15%|#6         | 40/260 [00:06<00:27,  8.03it/s]Processing training data:  24%|##6        | 63/260 [00:09<00:24,  8.13it/s]Processing training data:  28%|###        | 73/260 [00:12<00:30,  6.10it/s]Processing training data:  32%|###5       | 83/260 [00:12<00:24,  7.16it/s]Processing training data:  40%|###9      | 103/260 [00:13<00:15, 10.28it/s]Processing training data:  47%|####6     | 122/260 [00:16<00:16,  8.38it/s]Processing training data:  51%|#####1    | 133/260 [00:19<00:19,  6.47it/s]Processing training data:  55%|#####5    | 143/260 [00:21<00:20,  5.81it/s]Processing training data:  58%|#####8    | 151/260 [00:22<00:17,  6.26it/s]Processing training data:  67%|######7   | 175/260 [00:25<00:11,  7.53it/s]Processing training data:  71%|#######1  | 185/260 [00:28<00:13,  5.57it/s]Processing training data:  75%|#######5  | 196/260 [00:29<00:09,  6.87it/s]Processing training data:  76%|#######6  | 198/260 [00:31<00:13,  4.50it/s]Processing training data:  78%|#######8  | 203/260 [00:35<00:17,  3.24it/s]Processing training data:  82%|########1 | 212/260 [00:38<00:15,  3.10it/s]Processing training data:  85%|########5 | 222/260 [00:39<00:09,  4.20it/s]Processing training data:  93%|#########3| 242/260 [00:42<00:03,  4.88it/s]Processing training data:  96%|#########6| 250/260 [00:44<00:02,  4.53it/s]Processing training data:  98%|#########8| 255/260 [00:45<00:01,  4.91it/s]Processing training data:  98%|#########8| 256/260 [00:47<00:01,  3.66it/s]Processing training data: 100%|##########| 260/260 [00:47<00:00,  5.51it/s]
2025-11-20 12:08:11,264 - INFO - Computing normalization statistics from training data...
2025-11-20 12:08:11,744 - INFO - Normalization stats computed:
2025-11-20 12:08:11,744 - INFO -   Mean: 0.368884
2025-11-20 12:08:11,744 - INFO -   Std: 2.643232
2025-11-20 12:08:11,744 - INFO -   Saved to: preprocessing\checkpoints\chb10_fold3\normalization_stats.json
2025-11-20 12:08:11,791 - INFO - Applying normalization and saving 260 training sequences...
Normalizing and saving training data:   0%|        | 0/260 [00:00<?, ?it/s]2025-11-20 12:08:11,799 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold3\train_dataset.h5
Normalizing and saving training data:   4%| | 10/260 [00:00<00:15, 15.93it/Normalizing and saving training data:   8%| | 20/260 [00:01<00:15, 15.76it/Normalizing and saving training data:  12%|1| 30/260 [00:01<00:14, 15.57it/Normalizing and saving training data:  15%|1| 40/260 [00:02<00:14, 15.60it/Normalizing and saving training data:  19%|1| 50/260 [00:03<00:13, 15.65it/Normalizing and saving training data:  23%|2| 60/260 [00:03<00:12, 15.56it/Normalizing and saving training data:  27%|2| 70/260 [00:04<00:12, 15.50it/Normalizing and saving training data:  31%|3| 80/260 [00:05<00:11, 15.57it/Normalizing and saving training data:  35%|3| 90/260 [00:05<00:10, 15.55it/Normalizing and saving training data:  38%|3| 100/260 [00:06<00:10, 15.57itNormalizing and saving training data:  42%|4| 110/260 [00:07<00:09, 15.67itNormalizing and saving training data:  46%|4| 120/260 [00:07<00:08, 15.71itNormalizing and saving training data:  50%|5| 130/260 [00:08<00:08, 15.74itNormalizing and saving training data:  54%|5| 140/260 [00:08<00:07, 15.73itNormalizing and saving training data:  58%|5| 150/260 [00:09<00:06, 15.75itNormalizing and saving training data:  62%|6| 160/260 [00:10<00:06, 15.73itNormalizing and saving training data:  65%|6| 170/260 [00:10<00:05, 15.70itNormalizing and saving training data:  69%|6| 180/260 [00:11<00:05, 15.72itNormalizing and saving training data:  73%|7| 190/260 [00:12<00:04, 15.73itNormalizing and saving training data:  77%|7| 200/260 [00:12<00:03, 15.72itNormalizing and saving training data:  81%|8| 210/260 [00:13<00:03, 15.69itNormalizing and saving training data:  85%|8| 220/260 [00:14<00:02, 15.68itNormalizing and saving training data:  88%|8| 230/260 [00:14<00:01, 15.71itNormalizing and saving training data:  92%|9| 240/260 [00:15<00:01, 15.70itNormalizing and saving training data:  96%|9| 250/260 [00:15<00:00, 15.69itNormalizing and saving training data: 100%|#| 260/260 [00:16<00:00, 15.63itNormalizing and saving training data: 100%|#| 260/260 [00:16<00:00, 15.67it
2025-11-20 12:08:28,405 - INFO - Training data processing completed during stats computation phase
2025-11-20 12:08:28,412 - INFO - Loaded normalization statistics:
2025-11-20 12:08:28,412 - INFO -   Mean: 0.368884
2025-11-20 12:08:28,412 - INFO -   Std: 2.643232
2025-11-20 12:08:28,412 - INFO - Split train already completed, skipping
2025-11-20 12:08:28,412 - INFO - Processing test split...
2025-11-20 12:08:28,412 - INFO - Need to process 38/38 sequences for test
2025-11-20 12:08:28,412 - INFO - Processing 38 sequences from 14 unique files
2025-11-20 12:08:28,412 - INFO - Average 2.7 sequences per file
Processing test:   0%|                              | 0/38 [00:00<?, ?it/s]Processing test:   3%|5                     | 1/38 [00:00<00:30,  1.23it/s]2025-11-20 12:08:29,227 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold3\test_dataset.h5
2025-11-20 12:08:30,391 - INFO - Progress: 279/298 (93.6%) - ETA: 0.1 minutes
Processing test:  53%|###########          | 20/38 [00:02<00:02,  8.74it/s]Processing test:  55%|###########6         | 21/38 [00:03<00:02,  6.80it/s]Processing test:  58%|############1        | 22/38 [00:03<00:02,  5.57it/s]Processing test:  61%|############7        | 23/38 [00:04<00:03,  4.48it/s]Processing test:  63%|#############2       | 24/38 [00:06<00:06,  2.20it/s]Processing test:  68%|##############3      | 26/38 [00:06<00:04,  2.41it/s]Processing test:  71%|##############9      | 27/38 [00:07<00:05,  2.15it/s]Processing test:  74%|###############4     | 28/38 [00:10<00:09,  1.04it/s]2025-11-20 12:08:39,597 - INFO - Progress: 290/298 (97.3%) - ETA: 0.0 minutes
Processing test:  82%|#################1   | 31/38 [00:11<00:04,  1.41it/s]Processing test:  84%|#################6   | 32/38 [00:12<00:04,  1.45it/s]Processing test:  87%|##################2  | 33/38 [00:13<00:03,  1.38it/s]Processing test:  95%|###################8 | 36/38 [00:13<00:00,  2.16it/s]Processing test:  97%|####################4| 37/38 [00:15<00:00,  1.51it/s]Processing test: 100%|#####################| 38/38 [00:15<00:00,  2.50it/s]
2025-11-20 12:08:44,123 - INFO - Validating final datasets...
2025-11-20 12:08:44,132 - INFO - train dataset validation:
2025-11-20 12:08:44,132 - INFO -   - Segments: 260
2025-11-20 12:08:44,132 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:08:44,132 - INFO -   - Classes: 130 preictal, 130 interictal
2025-11-20 12:08:44,132 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:08:44,138 - INFO - test dataset validation:
2025-11-20 12:08:44,138 - INFO -   - Segments: 38
2025-11-20 12:08:44,138 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:08:44,138 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-20 12:08:44,138 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:08:44,138 - INFO - ============================================================
2025-11-20 12:08:44,138 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 12:08:44,138 - INFO - Total time: 1.3 minutes
2025-11-20 12:08:44,138 - INFO - Processed segments: 298
2025-11-20 12:08:44,138 - INFO - Average rate: 3.7 segments/second
2025-11-20 12:08:44,138 - INFO - ============================================================
✅ Fold 3 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 4/6
============================================================
2025-11-20 12:08:44,207 - INFO - ============================================================
2025-11-20 12:08:44,207 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 12:08:44,207 - INFO - ============================================================
2025-11-20 12:08:44,207 - INFO - Output prefix: chb10_fold4
2025-11-20 12:08:44,207 - INFO - EEG Preprocessor initialized
2025-11-20 12:08:44,207 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 12:08:44,207 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 12:08:44,207 - INFO - Segment duration: 5 seconds
2025-11-20 12:08:44,207 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 12:08:44,207 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 12:08:44,207 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 12:08:44,207 - INFO - Loading segments from chb10_fold4_sequences_prediction.json
2025-11-20 12:08:44,219 - INFO - Loaded 298 total sequences
2025-11-20 12:08:44,219 - INFO - Channel validation (from segmentation): 25/25 files valid
2025-11-20 12:08:44,219 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 12:08:44,219 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 12:08:44,219 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 12:08:44,219 - INFO - train: 258 sequences (129 preictal, 129 interictal)
2025-11-20 12:08:44,219 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-20 12:08:44,235 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 12:08:44,235 - INFO - train: kept 129 preictal and 129 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:08:44,236 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:08:44,252 - INFO - ============================================================
2025-11-20 12:08:44,252 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 12:08:44,252 - INFO - ============================================================
2025-11-20 12:08:44,252 - INFO - Processing 258 training samples to compute normalization stats...
2025-11-20 12:08:44,252 - INFO - Processing 258 sequences from 22 unique files
Processing training data:   0%|                    | 0/258 [00:00<?, ?it/s]Processing training data:   0%|            | 1/258 [00:03<13:58,  3.26s/it]Processing training data:   4%|4          | 11/258 [00:03<01:09,  3.58it/s]Processing training data:  12%|#3         | 31/258 [00:04<00:23,  9.66it/s]Processing training data:  21%|##3        | 54/258 [00:05<00:13, 15.64it/s]Processing training data:  28%|###1       | 73/258 [00:08<00:18,  9.94it/s]Processing training data:  35%|###8       | 91/258 [00:09<00:13, 12.55it/s]Processing training data:  43%|####2     | 110/258 [00:09<00:09, 14.84it/s]Processing training data:  52%|#####1    | 134/258 [00:10<00:06, 18.45it/s]Processing training data:  61%|######1   | 158/258 [00:14<00:08, 11.46it/s]Processing training data:  65%|######5   | 168/258 [00:17<00:12,  7.42it/s]Processing training data:  70%|######9   | 180/258 [00:20<00:12,  6.32it/s]Processing training data:  72%|#######2  | 186/258 [00:23<00:14,  4.87it/s]Processing training data:  75%|#######4  | 193/258 [00:27<00:16,  3.86it/s]Processing training data:  79%|#######8  | 203/258 [00:29<00:13,  3.94it/s]Processing training data:  81%|########  | 208/258 [00:32<00:15,  3.23it/s]Processing training data:  85%|########5 | 220/258 [00:34<00:09,  4.11it/s]Processing training data:  88%|########7 | 226/258 [00:36<00:08,  3.58it/s]Processing training data:  90%|########9 | 231/258 [00:38<00:08,  3.26it/s]Processing training data:  93%|#########2| 239/258 [00:40<00:05,  3.67it/s]Processing training data:  94%|#########3| 242/258 [00:42<00:05,  2.90it/s]Processing training data:  95%|#########5| 246/258 [00:44<00:04,  2.60it/s]Processing training data:  98%|#########8| 253/258 [00:47<00:01,  2.60it/s]Processing training data: 100%|##########| 258/258 [00:47<00:00,  5.45it/s]
2025-11-20 12:09:31,608 - INFO - Computing normalization statistics from training data...
2025-11-20 12:09:32,010 - INFO - Normalization stats computed:
2025-11-20 12:09:32,010 - INFO -   Mean: 0.308639
2025-11-20 12:09:32,010 - INFO -   Std: 2.661590
2025-11-20 12:09:32,010 - INFO -   Saved to: preprocessing\checkpoints\chb10_fold4\normalization_stats.json
2025-11-20 12:09:32,056 - INFO - Applying normalization and saving 258 training sequences...
Normalizing and saving training data:   0%|        | 0/258 [00:00<?, ?it/s]2025-11-20 12:09:32,065 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold4\train_dataset.h5
Normalizing and saving training data:   4%| | 10/258 [00:00<00:15, 16.26it/Normalizing and saving training data:   8%| | 20/258 [00:01<00:14, 16.11it/Normalizing and saving training data:  12%|1| 30/258 [00:01<00:14, 16.07it/Normalizing and saving training data:  16%|1| 40/258 [00:02<00:13, 15.96it/Normalizing and saving training data:  19%|1| 50/258 [00:03<00:12, 16.01it/Normalizing and saving training data:  23%|2| 60/258 [00:03<00:12, 16.06it/Normalizing and saving training data:  27%|2| 70/258 [00:04<00:11, 15.93it/Normalizing and saving training data:  31%|3| 80/258 [00:05<00:11, 15.94it/Normalizing and saving training data:  35%|3| 90/258 [00:05<00:10, 15.96it/Normalizing and saving training data:  39%|3| 100/258 [00:06<00:09, 15.92itNormalizing and saving training data:  43%|4| 110/258 [00:06<00:09, 15.89itNormalizing and saving training data:  47%|4| 120/258 [00:07<00:08, 15.87itNormalizing and saving training data:  50%|5| 130/258 [00:08<00:08, 15.80itNormalizing and saving training data:  54%|5| 140/258 [00:08<00:07, 15.74itNormalizing and saving training data:  58%|5| 150/258 [00:09<00:06, 15.72itNormalizing and saving training data:  62%|6| 160/258 [00:10<00:06, 15.74itNormalizing and saving training data:  66%|6| 170/258 [00:10<00:05, 15.74itNormalizing and saving training data:  70%|6| 180/258 [00:11<00:04, 15.76itNormalizing and saving training data:  74%|7| 190/258 [00:11<00:04, 15.75itNormalizing and saving training data:  78%|7| 200/258 [00:12<00:03, 15.75itNormalizing and saving training data:  81%|8| 210/258 [00:13<00:03, 15.75itNormalizing and saving training data:  85%|8| 220/258 [00:13<00:02, 15.75itNormalizing and saving training data:  89%|8| 230/258 [00:14<00:01, 15.76itNormalizing and saving training data:  93%|9| 240/258 [00:15<00:01, 15.78itNormalizing and saving training data:  97%|9| 250/258 [00:15<00:00, 15.74itNormalizing and saving training data: 100%|#| 258/258 [00:15<00:00, 16.33it
2025-11-20 12:09:48,378 - INFO - Training data processing completed during stats computation phase
2025-11-20 12:09:48,385 - INFO - Loaded normalization statistics:
2025-11-20 12:09:48,385 - INFO -   Mean: 0.308639
2025-11-20 12:09:48,385 - INFO -   Std: 2.661590
2025-11-20 12:09:48,385 - INFO - Split train already completed, skipping
2025-11-20 12:09:48,385 - INFO - Processing test split...
2025-11-20 12:09:48,385 - INFO - Need to process 40/40 sequences for test
2025-11-20 12:09:48,385 - INFO - Processing 40 sequences from 12 unique files
2025-11-20 12:09:48,385 - INFO - Average 3.3 sequences per file
Processing test:   0%|                              | 0/40 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/40 [00:00<00:31,  1.25it/s]2025-11-20 12:09:49,187 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold4\test_dataset.h5
2025-11-20 12:09:50,413 - INFO - Progress: 278/298 (93.3%) - ETA: 0.1 minutes
Processing test:  52%|###########          | 21/40 [00:04<00:03,  5.45it/s]Processing test:  60%|############6        | 24/40 [00:04<00:02,  5.50it/s]Processing test:  62%|#############1       | 25/40 [00:05<00:03,  4.67it/s]Processing test:  65%|#############6       | 26/40 [00:07<00:06,  2.31it/s]Processing test:  72%|###############2     | 29/40 [00:08<00:04,  2.57it/s]2025-11-20 12:09:57,541 - INFO - Progress: 289/298 (97.0%) - ETA: 0.0 minutes
Processing test:  80%|################8    | 32/40 [00:09<00:03,  2.57it/s]Processing test:  82%|#################3   | 33/40 [00:12<00:04,  1.47it/s]Processing test:  90%|##################9  | 36/40 [00:13<00:02,  1.60it/s]Processing test:  95%|###################9 | 38/40 [00:14<00:01,  1.86it/s]Processing test:  98%|####################4| 39/40 [00:15<00:00,  1.83it/s]Processing test: 100%|#####################| 40/40 [00:15<00:00,  1.85it/s]Processing test: 100%|#####################| 40/40 [00:15<00:00,  2.56it/s]
2025-11-20 12:10:04,584 - INFO - Validating final datasets...
2025-11-20 12:10:04,592 - INFO - train dataset validation:
2025-11-20 12:10:04,592 - INFO -   - Segments: 258
2025-11-20 12:10:04,592 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:10:04,592 - INFO -   - Classes: 129 preictal, 129 interictal
2025-11-20 12:10:04,592 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:10:04,597 - INFO - test dataset validation:
2025-11-20 12:10:04,597 - INFO -   - Segments: 40
2025-11-20 12:10:04,598 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:10:04,598 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-20 12:10:04,598 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:10:04,598 - INFO - ============================================================
2025-11-20 12:10:04,598 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 12:10:04,598 - INFO - Total time: 1.3 minutes
2025-11-20 12:10:04,598 - INFO - Processed segments: 298
2025-11-20 12:10:04,598 - INFO - Average rate: 3.7 segments/second
2025-11-20 12:10:04,598 - INFO - ============================================================
✅ Fold 4 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 5/6
============================================================
2025-11-20 12:10:04,669 - INFO - ============================================================
2025-11-20 12:10:04,669 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 12:10:04,669 - INFO - ============================================================
2025-11-20 12:10:04,669 - INFO - Output prefix: chb10_fold5
2025-11-20 12:10:04,669 - INFO - EEG Preprocessor initialized
2025-11-20 12:10:04,669 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 12:10:04,669 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 12:10:04,669 - INFO - Segment duration: 5 seconds
2025-11-20 12:10:04,669 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 12:10:04,669 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 12:10:04,669 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 12:10:04,670 - INFO - Loading segments from chb10_fold5_sequences_prediction.json
2025-11-20 12:10:04,680 - INFO - Loaded 298 total sequences
2025-11-20 12:10:04,680 - INFO - Channel validation (from segmentation): 25/25 files valid
2025-11-20 12:10:04,680 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 12:10:04,680 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 12:10:04,680 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 12:10:04,681 - INFO - train: 252 sequences (126 preictal, 126 interictal)
2025-11-20 12:10:04,681 - INFO - test: 46 sequences (23 preictal, 23 interictal)
2025-11-20 12:10:04,696 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 12:10:04,696 - INFO - train: kept 126 preictal and 126 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:10:04,696 - INFO - test: kept 23 preictal and 23 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:10:04,712 - INFO - ============================================================
2025-11-20 12:10:04,712 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 12:10:04,712 - INFO - ============================================================
2025-11-20 12:10:04,712 - INFO - Processing 252 training samples to compute normalization stats...
2025-11-20 12:10:04,712 - INFO - Processing 252 sequences from 23 unique files
Processing training data:   0%|                    | 0/252 [00:00<?, ?it/s]Processing training data:   0%|            | 1/252 [00:03<13:29,  3.22s/it]Processing training data:   4%|4          | 11/252 [00:03<01:07,  3.59it/s]Processing training data:  12%|#3         | 31/252 [00:04<00:22,  9.92it/s]Processing training data:  20%|##2        | 51/252 [00:05<00:13, 14.70it/s]Processing training data:  30%|###2       | 75/252 [00:06<00:08, 20.16it/s]Processing training data:  37%|####1      | 94/252 [00:06<00:07, 21.87it/s]Processing training data:  47%|####6     | 118/252 [00:07<00:05, 25.66it/s]Processing training data:  54%|#####4    | 137/252 [00:10<00:08, 13.00it/s]Processing training data:  58%|#####7    | 146/252 [00:13<00:13,  8.10it/s]Processing training data:  62%|######1   | 155/252 [00:16<00:15,  6.38it/s]Processing training data:  65%|######5   | 164/252 [00:18<00:16,  5.41it/s]Processing training data:  68%|######7   | 171/252 [00:22<00:19,  4.22it/s]Processing training data:  72%|#######1  | 181/252 [00:25<00:18,  3.75it/s]Processing training data:  76%|#######5  | 191/252 [00:28<00:16,  3.67it/s]Processing training data:  78%|#######8  | 197/252 [00:31<00:16,  3.27it/s]Processing training data:  81%|########1 | 205/252 [00:33<00:13,  3.37it/s]Processing training data:  84%|########3 | 211/252 [00:36<00:15,  2.71it/s]Processing training data:  87%|########7 | 220/252 [00:38<00:09,  3.40it/s]Processing training data:  90%|########9 | 226/252 [00:41<00:09,  2.72it/s]Processing training data:  93%|#########2| 234/252 [00:44<00:06,  2.66it/s]Processing training data:  95%|#########5| 240/252 [00:47<00:04,  2.71it/s]Processing training data:  98%|#########7| 246/252 [00:49<00:02,  2.71it/s]Processing training data:  99%|#########9| 250/252 [00:50<00:00,  2.91it/s]Processing training data: 100%|##########| 252/252 [00:50<00:00,  5.02it/s]
2025-11-20 12:10:54,910 - INFO - Computing normalization statistics from training data...
2025-11-20 12:10:55,292 - INFO - Normalization stats computed:
2025-11-20 12:10:55,292 - INFO -   Mean: 0.218818
2025-11-20 12:10:55,292 - INFO -   Std: 2.643813
2025-11-20 12:10:55,292 - INFO -   Saved to: preprocessing\checkpoints\chb10_fold5\normalization_stats.json
2025-11-20 12:10:55,338 - INFO - Applying normalization and saving 252 training sequences...
Normalizing and saving training data:   0%|        | 0/252 [00:00<?, ?it/s]2025-11-20 12:10:55,346 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold5\train_dataset.h5
Normalizing and saving training data:   4%| | 10/252 [00:00<00:14, 16.17it/Normalizing and saving training data:   8%| | 20/252 [00:01<00:14, 16.04it/Normalizing and saving training data:  12%|1| 30/252 [00:01<00:13, 16.05it/Normalizing and saving training data:  16%|1| 40/252 [00:02<00:13, 16.11it/Normalizing and saving training data:  20%|1| 50/252 [00:03<00:12, 16.00it/Normalizing and saving training data:  24%|2| 60/252 [00:03<00:11, 16.08it/Normalizing and saving training data:  28%|2| 70/252 [00:04<00:11, 16.11it/Normalizing and saving training data:  32%|3| 80/252 [00:04<00:10, 16.10it/Normalizing and saving training data:  36%|3| 90/252 [00:05<00:10, 16.08it/Normalizing and saving training data:  40%|3| 100/252 [00:06<00:09, 16.12itNormalizing and saving training data:  44%|4| 110/252 [00:06<00:08, 16.14itNormalizing and saving training data:  48%|4| 120/252 [00:07<00:08, 16.15itNormalizing and saving training data:  52%|5| 130/252 [00:08<00:07, 16.12itNormalizing and saving training data:  56%|5| 140/252 [00:08<00:06, 16.08itNormalizing and saving training data:  60%|5| 150/252 [00:09<00:06, 16.05itNormalizing and saving training data:  63%|6| 160/252 [00:09<00:05, 15.92itNormalizing and saving training data:  67%|6| 170/252 [00:10<00:05, 15.94itNormalizing and saving training data:  71%|7| 180/252 [00:11<00:04, 15.95itNormalizing and saving training data:  75%|7| 190/252 [00:11<00:03, 15.95itNormalizing and saving training data:  79%|7| 200/252 [00:12<00:03, 15.92itNormalizing and saving training data:  83%|8| 210/252 [00:13<00:02, 15.91itNormalizing and saving training data:  87%|8| 220/252 [00:13<00:02, 15.94itNormalizing and saving training data:  91%|9| 230/252 [00:14<00:01, 15.79itNormalizing and saving training data:  95%|9| 240/252 [00:15<00:00, 15.82itNormalizing and saving training data:  99%|9| 250/252 [00:15<00:00, 15.84itNormalizing and saving training data: 100%|#| 252/252 [00:15<00:00, 16.12it
2025-11-20 12:11:11,137 - INFO - Training data processing completed during stats computation phase
2025-11-20 12:11:11,144 - INFO - Loaded normalization statistics:
2025-11-20 12:11:11,144 - INFO -   Mean: 0.218818
2025-11-20 12:11:11,144 - INFO -   Std: 2.643813
2025-11-20 12:11:11,144 - INFO - Split train already completed, skipping
2025-11-20 12:11:11,144 - INFO - Processing test split...
2025-11-20 12:11:11,144 - INFO - Need to process 46/46 sequences for test
2025-11-20 12:11:11,144 - INFO - Processing 46 sequences from 14 unique files
2025-11-20 12:11:11,144 - INFO - Average 3.3 sequences per file
Processing test:   0%|                              | 0/46 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/46 [00:00<00:37,  1.20it/s]2025-11-20 12:11:11,980 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold5\test_dataset.h5
2025-11-20 12:11:13,351 - INFO - Progress: 275/298 (92.3%) - ETA: 0.1 minutes
Processing test:  52%|##########9          | 24/46 [00:03<00:02,  8.03it/s]Processing test:  57%|###########8         | 26/46 [00:03<00:02,  7.10it/s]Processing test:  59%|############3        | 27/46 [00:06<00:05,  3.39it/s]Processing test:  65%|#############6       | 30/46 [00:08<00:07,  2.20it/s]2025-11-20 12:11:20,752 - INFO - Progress: 285/298 (95.6%) - ETA: 0.1 minutes
Processing test:  74%|###############5     | 34/46 [00:12<00:07,  1.63it/s]Processing test:  80%|################8    | 37/46 [00:13<00:04,  1.96it/s]Processing test:  83%|#################3   | 38/46 [00:14<00:04,  1.69it/s]Processing test:  87%|##################2  | 40/46 [00:15<00:03,  1.92it/s]Processing test:  89%|##################7  | 41/46 [00:16<00:02,  1.79it/s]Processing test:  93%|###################6 | 43/46 [00:16<00:01,  2.10it/s]2025-11-20 12:11:28,409 - INFO - Progress: 295/298 (99.0%) - ETA: 0.0 minutes
Processing test:  96%|#################### | 44/46 [00:17<00:01,  1.72it/s]Processing test:  98%|####################5| 45/46 [00:18<00:00,  1.73it/s]Processing test: 100%|#####################| 46/46 [00:18<00:00,  1.79it/s]Processing test: 100%|#####################| 46/46 [00:18<00:00,  2.45it/s]
2025-11-20 12:11:30,165 - INFO - Validating final datasets...
2025-11-20 12:11:30,172 - INFO - train dataset validation:
2025-11-20 12:11:30,172 - INFO -   - Segments: 252
2025-11-20 12:11:30,172 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:11:30,172 - INFO -   - Classes: 126 preictal, 126 interictal
2025-11-20 12:11:30,172 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:11:30,177 - INFO - test dataset validation:
2025-11-20 12:11:30,177 - INFO -   - Segments: 46
2025-11-20 12:11:30,177 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:11:30,177 - INFO -   - Classes: 23 preictal, 23 interictal
2025-11-20 12:11:30,177 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:11:30,177 - INFO - ============================================================
2025-11-20 12:11:30,177 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 12:11:30,177 - INFO - Total time: 1.4 minutes
2025-11-20 12:11:30,178 - INFO - Processed segments: 298
2025-11-20 12:11:30,178 - INFO - Average rate: 3.5 segments/second
2025-11-20 12:11:30,178 - INFO - ============================================================
✅ Fold 5 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 6/6
============================================================
2025-11-20 12:11:30,247 - INFO - ============================================================
2025-11-20 12:11:30,247 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 12:11:30,247 - INFO - ============================================================
2025-11-20 12:11:30,247 - INFO - Output prefix: chb10_fold6
2025-11-20 12:11:30,247 - INFO - EEG Preprocessor initialized
2025-11-20 12:11:30,247 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 12:11:30,247 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 12:11:30,247 - INFO - Segment duration: 5 seconds
2025-11-20 12:11:30,247 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 12:11:30,247 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 12:11:30,247 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 12:11:30,247 - INFO - Loading segments from chb10_fold6_sequences_prediction.json
2025-11-20 12:11:30,258 - INFO - Loaded 298 total sequences
2025-11-20 12:11:30,258 - INFO - Channel validation (from segmentation): 25/25 files valid
2025-11-20 12:11:30,258 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 12:11:30,258 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 12:11:30,258 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 12:11:30,258 - INFO - train: 258 sequences (129 preictal, 129 interictal)
2025-11-20 12:11:30,258 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-20 12:11:30,275 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 12:11:30,275 - INFO - train: kept 129 preictal and 129 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:11:30,276 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 12:11:30,292 - INFO - ============================================================
2025-11-20 12:11:30,292 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 12:11:30,292 - INFO - ============================================================
2025-11-20 12:11:30,292 - INFO - Processing 258 training samples to compute normalization stats...
2025-11-20 12:11:30,292 - INFO - Processing 258 sequences from 23 unique files
Processing training data:   0%|                    | 0/258 [00:00<?, ?it/s]Processing training data:   0%|            | 1/258 [00:01<08:25,  1.97s/it]Processing training data:   5%|5          | 12/258 [00:04<01:21,  3.03it/s]Processing training data:   8%|8          | 21/258 [00:07<01:20,  2.95it/s]Processing training data:  12%|#3         | 31/258 [00:08<00:49,  4.58it/s]Processing training data:  21%|##3        | 55/258 [00:09<00:21,  9.60it/s]Processing training data:  31%|###3       | 79/258 [00:09<00:12, 14.32it/s]Processing training data:  40%|###9      | 102/258 [00:12<00:14, 10.88it/s]Processing training data:  42%|####2     | 109/258 [00:13<00:13, 10.75it/s]Processing training data:  50%|####9     | 128/258 [00:14<00:09, 13.44it/s]Processing training data:  57%|#####7    | 148/258 [00:16<00:10, 10.43it/s]Processing training data:  61%|######    | 157/258 [00:20<00:14,  6.91it/s]Processing training data:  64%|######3   | 164/258 [00:20<00:13,  7.21it/s]Processing training data:  71%|#######   | 183/258 [00:23<00:10,  6.99it/s]Processing training data:  76%|#######5  | 195/258 [00:27<00:11,  5.62it/s]Processing training data:  78%|#######7  | 200/258 [00:30<00:14,  4.02it/s]Processing training data:  81%|########1 | 209/258 [00:34<00:13,  3.51it/s]Processing training data:  84%|########4 | 217/258 [00:36<00:12,  3.27it/s]Processing training data:  87%|########7 | 225/258 [00:39<00:09,  3.31it/s]Processing training data:  89%|########9 | 230/258 [00:40<00:08,  3.26it/s]Processing training data:  92%|#########2| 238/258 [00:42<00:05,  3.77it/s]Processing training data:  93%|#########3| 241/258 [00:45<00:06,  2.65it/s]Processing training data:  96%|#########5| 247/258 [00:48<00:04,  2.55it/s]Processing training data:  98%|#########8| 254/258 [00:49<00:01,  3.00it/s]Processing training data: 100%|##########| 258/258 [00:49<00:00,  5.21it/s]
2025-11-20 12:12:19,858 - INFO - Computing normalization statistics from training data...
2025-11-20 12:12:20,321 - INFO - Normalization stats computed:
2025-11-20 12:12:20,321 - INFO -   Mean: 0.303007
2025-11-20 12:12:20,321 - INFO -   Std: 2.649993
2025-11-20 12:12:20,321 - INFO -   Saved to: preprocessing\checkpoints\chb10_fold6\normalization_stats.json
2025-11-20 12:12:20,367 - INFO - Applying normalization and saving 258 training sequences...
Normalizing and saving training data:   0%|        | 0/258 [00:00<?, ?it/s]2025-11-20 12:12:20,378 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold6\train_dataset.h5
Normalizing and saving training data:   4%| | 10/258 [00:00<00:15, 15.72it/Normalizing and saving training data:   8%| | 20/258 [00:01<00:14, 15.95it/Normalizing and saving training data:  12%|1| 30/258 [00:01<00:14, 16.07it/Normalizing and saving training data:  16%|1| 40/258 [00:02<00:13, 16.09it/Normalizing and saving training data:  19%|1| 50/258 [00:03<00:12, 16.06it/Normalizing and saving training data:  23%|2| 60/258 [00:03<00:12, 15.92it/Normalizing and saving training data:  27%|2| 70/258 [00:04<00:11, 15.90it/Normalizing and saving training data:  31%|3| 80/258 [00:05<00:11, 15.86it/Normalizing and saving training data:  35%|3| 90/258 [00:05<00:10, 15.85it/Normalizing and saving training data:  39%|3| 100/258 [00:06<00:10, 15.78itNormalizing and saving training data:  43%|4| 110/258 [00:06<00:09, 15.81itNormalizing and saving training data:  47%|4| 120/258 [00:07<00:08, 15.80itNormalizing and saving training data:  50%|5| 130/258 [00:08<00:08, 15.87itNormalizing and saving training data:  54%|5| 140/258 [00:08<00:07, 15.80itNormalizing and saving training data:  58%|5| 150/258 [00:09<00:06, 15.82itNormalizing and saving training data:  62%|6| 160/258 [00:10<00:06, 15.85itNormalizing and saving training data:  66%|6| 170/258 [00:10<00:05, 15.84itNormalizing and saving training data:  70%|6| 180/258 [00:11<00:04, 15.84itNormalizing and saving training data:  74%|7| 190/258 [00:11<00:04, 15.83itNormalizing and saving training data:  78%|7| 200/258 [00:12<00:03, 15.77itNormalizing and saving training data:  81%|8| 210/258 [00:13<00:03, 15.75itNormalizing and saving training data:  85%|8| 220/258 [00:13<00:02, 15.76itNormalizing and saving training data:  89%|8| 230/258 [00:14<00:01, 15.71itNormalizing and saving training data:  93%|9| 240/258 [00:15<00:01, 15.67itNormalizing and saving training data:  97%|9| 250/258 [00:15<00:00, 15.62itNormalizing and saving training data: 100%|#| 258/258 [00:15<00:00, 16.31it
2025-11-20 12:12:36,706 - INFO - Training data processing completed during stats computation phase
2025-11-20 12:12:36,713 - INFO - Loaded normalization statistics:
2025-11-20 12:12:36,714 - INFO -   Mean: 0.303007
2025-11-20 12:12:36,714 - INFO -   Std: 2.649993
2025-11-20 12:12:36,714 - INFO - Split train already completed, skipping
2025-11-20 12:12:36,714 - INFO - Processing test split...
2025-11-20 12:12:36,714 - INFO - Need to process 40/40 sequences for test
2025-11-20 12:12:36,714 - INFO - Processing 40 sequences from 16 unique files
2025-11-20 12:12:36,714 - INFO - Average 2.5 sequences per file
Processing test:   0%|                              | 0/40 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/40 [00:00<00:31,  1.23it/s]2025-11-20 12:12:37,531 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb10_fold6\test_dataset.h5
2025-11-20 12:12:38,721 - INFO - Progress: 278/298 (93.3%) - ETA: 0.1 minutes
Processing test:  52%|###########          | 21/40 [00:02<00:02,  8.99it/s]Processing test:  55%|###########5         | 22/40 [00:03<00:02,  7.22it/s]Processing test:  57%|############         | 23/40 [00:03<00:03,  5.65it/s]Processing test:  60%|############6        | 24/40 [00:04<00:03,  4.37it/s]Processing test:  65%|#############6       | 26/40 [00:04<00:03,  4.12it/s]Processing test:  68%|##############1      | 27/40 [00:05<00:03,  3.31it/s]Processing test:  72%|###############2     | 29/40 [00:06<00:03,  3.36it/s]Processing test:  75%|###############7     | 30/40 [00:06<00:03,  2.87it/s]2025-11-20 12:12:44,068 - INFO - Progress: 288/298 (96.6%) - ETA: 0.0 minutes
Processing test:  78%|################2    | 31/40 [00:08<00:04,  1.80it/s]Processing test:  82%|#################3   | 33/40 [00:09<00:04,  1.48it/s]Processing test:  88%|##################3  | 35/40 [00:10<00:02,  1.71it/s]Processing test:  92%|###################4 | 37/40 [00:11<00:01,  2.08it/s]Processing test:  95%|###################9 | 38/40 [00:11<00:01,  1.97it/s]Processing test:  98%|####################4| 39/40 [00:12<00:00,  1.92it/s]Processing test: 100%|#####################| 40/40 [00:13<00:00,  1.88it/s]2025-11-20 12:12:50,413 - INFO - Progress: 298/298 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 40/40 [00:13<00:00,  2.92it/s]
2025-11-20 12:12:50,431 - INFO - Validating final datasets...
2025-11-20 12:12:50,439 - INFO - train dataset validation:
2025-11-20 12:12:50,439 - INFO -   - Segments: 258
2025-11-20 12:12:50,439 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:12:50,439 - INFO -   - Classes: 129 preictal, 129 interictal
2025-11-20 12:12:50,439 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:12:50,444 - INFO - test dataset validation:
2025-11-20 12:12:50,444 - INFO -   - Segments: 40
2025-11-20 12:12:50,444 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 12:12:50,444 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-20 12:12:50,444 - INFO -   - Balance: 50.0% preictal
2025-11-20 12:12:50,444 - INFO - ============================================================
2025-11-20 12:12:50,445 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 12:12:50,445 - INFO - Total time: 1.3 minutes
2025-11-20 12:12:50,445 - INFO - Processed segments: 298
2025-11-20 12:12:50,445 - INFO - Average rate: 3.7 segments/second
2025-11-20 12:12:50,445 - INFO - ============================================================
✅ Fold 6 preprocessing completed successfully!

============================================================
✅ BATCH PREPROCESSING COMPLETED!
✅ Processed 7 folds for patient chb10
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb10
============================================================

============================================================
TRAINING FOLD 0/6
============================================================
Using dataset prefix: chb10_fold0
Loading datasets from: preprocessing\data\chb10_fold0
Saving models to: model\chb10_fold0
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.3268, std=2.6585
Loaded train dataset: 260 samples
  - Spectrogram shape: torch.Size([260, 30, 18, 50, 10])
  - Value range: [-4.6368, 3.4905]
  - Class distribution: tensor([130, 130])
LOOCV Mode (Fold 0): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.7119, grad_norm=1.Training Epoch 1/5:   6%| | 1/17 [00:04<01:06,  4.15s/it, loss=0.7119, gradTraining Epoch 1/5:   6%| | 1/17 [00:04<01:06,  4.15s/it, loss=0.6959, gradTraining Epoch 1/5:  12%|1| 2/17 [00:04<00:26,  1.77s/it, loss=0.6959, gradTraining Epoch 1/5:  12%|1| 2/17 [00:04<00:26,  1.77s/it, loss=0.6830, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:14,  1.01s/it, loss=0.6830, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:14,  1.01s/it, loss=0.6843, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.52it/s, loss=0.6843, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.52it/s, loss=0.6873, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.18it/s, loss=0.6873, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.18it/s, loss=0.6902, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  2.94it/s, loss=0.6902, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  2.94it/s, loss=0.6902, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.79it/s, loss=0.6902, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.79it/s, loss=0.6946, gradTraining Epoch 1/5:  47%|4| 8/17 [00:04<00:01,  4.65it/s, loss=0.6946, gradTraining Epoch 1/5:  47%|4| 8/17 [00:05<00:01,  4.65it/s, loss=0.6831, gradTraining Epoch 1/5:  53%|5| 9/17 [00:05<00:01,  5.48it/s, loss=0.6831, gradTraining Epoch 1/5:  53%|5| 9/17 [00:05<00:01,  5.48it/s, loss=0.6901, gradTraining Epoch 1/5:  59%|5| 10/17 [00:05<00:01,  6.28it/s, loss=0.6901, graTraining Epoch 1/5:  59%|5| 10/17 [00:05<00:01,  6.28it/s, loss=0.6876, graTraining Epoch 1/5:  65%|6| 11/17 [00:05<00:00,  6.89it/s, loss=0.6876, graTraining Epoch 1/5:  65%|6| 11/17 [00:05<00:00,  6.89it/s, loss=0.6769, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.37it/s, loss=0.6769, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.37it/s, loss=0.6727, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  7.83it/s, loss=0.6727, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  7.83it/s, loss=0.7016, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  8.22it/s, loss=0.7016, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  8.22it/s, loss=0.6791, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.46it/s, loss=0.6791, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.46it/s, loss=0.6613, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.71it/s, loss=0.6613, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.71it/s, loss=0.6756, graTraining Epoch 1/5: 100%|#| 17/17 [00:06<00:00,  2.64it/s, loss=0.6756, gra

Epoch 1/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6862, Acc: 0.6000, Precision: 0.6140, Recall: 0.5385, F1: 0.5738, AUC: 0.6345
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.6830, grad_norm=1.Training Epoch 2/5:   6%| | 1/17 [00:03<01:03,  3.95s/it, loss=0.6830, gradTraining Epoch 2/5:   6%| | 1/17 [00:04<01:03,  3.95s/it, loss=0.6755, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.6755, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.6718, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.6718, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.6702, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.6702, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.6704, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.6704, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.6700, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  3.02it/s, loss=0.6700, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  3.02it/s, loss=0.6599, gradTraining Epoch 2/5:  41%|4| 7/17 [00:04<00:02,  3.86it/s, loss=0.6599, gradTraining Epoch 2/5:  41%|4| 7/17 [00:04<00:02,  3.86it/s, loss=0.6580, gradTraining Epoch 2/5:  47%|4| 8/17 [00:04<00:01,  4.73it/s, loss=0.6580, gradTraining Epoch 2/5:  47%|4| 8/17 [00:04<00:01,  4.73it/s, loss=0.6696, gradTraining Epoch 2/5:  53%|5| 9/17 [00:04<00:01,  5.57it/s, loss=0.6696, gradTraining Epoch 2/5:  53%|5| 9/17 [00:04<00:01,  5.57it/s, loss=0.6635, gradTraining Epoch 2/5:  59%|5| 10/17 [00:04<00:01,  6.26it/s, loss=0.6635, graTraining Epoch 2/5:  59%|5| 10/17 [00:05<00:01,  6.26it/s, loss=0.6650, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  6.85it/s, loss=0.6650, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  6.85it/s, loss=0.6518, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  7.39it/s, loss=0.6518, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  7.39it/s, loss=0.6305, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  7.89it/s, loss=0.6305, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  7.89it/s, loss=0.6476, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  8.20it/s, loss=0.6476, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  8.20it/s, loss=0.6454, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  8.38it/s, loss=0.6454, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  8.38it/s, loss=0.6089, graTraining Epoch 2/5:  94%|9| 16/17 [00:05<00:00,  8.55it/s, loss=0.6089, graTraining Epoch 2/5:  94%|9| 16/17 [00:05<00:00,  8.55it/s, loss=0.6140, graTraining Epoch 2/5: 100%|#| 17/17 [00:06<00:00,  2.72it/s, loss=0.6140, gra

Epoch 2/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6562, Acc: 0.7231, Precision: 0.7101, Recall: 0.7538, F1: 0.7313, AUC: 0.8111
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.6380, grad_norm=1.Training Epoch 3/5:   6%| | 1/17 [00:04<01:05,  4.07s/it, loss=0.6380, gradTraining Epoch 3/5:   6%| | 1/17 [00:04<01:05,  4.07s/it, loss=0.6079, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:26,  1.74s/it, loss=0.6079, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:26,  1.74s/it, loss=0.6249, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:13,  1.00it/s, loss=0.6249, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:13,  1.00it/s, loss=0.5855, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.54it/s, loss=0.5855, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.54it/s, loss=0.6061, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.20it/s, loss=0.6061, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.20it/s, loss=0.6125, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  2.97it/s, loss=0.6125, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  2.97it/s, loss=0.5473, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.80it/s, loss=0.5473, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.80it/s, loss=0.5498, gradTraining Epoch 3/5:  47%|4| 8/17 [00:04<00:01,  4.63it/s, loss=0.5498, gradTraining Epoch 3/5:  47%|4| 8/17 [00:04<00:01,  4.63it/s, loss=0.6088, gradTraining Epoch 3/5:  53%|5| 9/17 [00:04<00:01,  5.49it/s, loss=0.6088, gradTraining Epoch 3/5:  53%|5| 9/17 [00:05<00:01,  5.49it/s, loss=0.6595, gradTraining Epoch 3/5:  59%|5| 10/17 [00:05<00:01,  6.25it/s, loss=0.6595, graTraining Epoch 3/5:  59%|5| 10/17 [00:05<00:01,  6.25it/s, loss=0.6288, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  6.91it/s, loss=0.6288, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  6.91it/s, loss=0.5768, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  7.45it/s, loss=0.5768, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  7.45it/s, loss=0.5386, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  7.89it/s, loss=0.5386, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  7.89it/s, loss=0.5400, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  8.24it/s, loss=0.5400, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  8.24it/s, loss=0.5435, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  8.48it/s, loss=0.5435, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  8.48it/s, loss=0.4574, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.66it/s, loss=0.4574, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.66it/s, loss=0.6039, graTraining Epoch 3/5: 100%|#| 17/17 [00:06<00:00,  2.68it/s, loss=0.6039, gra

Epoch 3/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.5841, Acc: 0.7692, Precision: 0.7108, Recall: 0.9077, F1: 0.7973, AUC: 0.8930
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.5321, grad_norm=1.Training Epoch 4/5:   6%| | 1/17 [00:03<01:03,  3.97s/it, loss=0.5321, gradTraining Epoch 4/5:   6%| | 1/17 [00:04<01:03,  3.97s/it, loss=0.5135, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:25,  1.70s/it, loss=0.5135, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:25,  1.70s/it, loss=0.5460, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:13,  1.02it/s, loss=0.5460, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:13,  1.02it/s, loss=0.4648, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.4648, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.4434, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.25it/s, loss=0.4434, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.25it/s, loss=0.5028, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  3.02it/s, loss=0.5028, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  3.02it/s, loss=0.4839, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.87it/s, loss=0.4839, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.87it/s, loss=0.4241, gradTraining Epoch 4/5:  47%|4| 8/17 [00:04<00:01,  4.75it/s, loss=0.4241, gradTraining Epoch 4/5:  47%|4| 8/17 [00:04<00:01,  4.75it/s, loss=0.5141, gradTraining Epoch 4/5:  53%|5| 9/17 [00:04<00:01,  5.59it/s, loss=0.5141, gradTraining Epoch 4/5:  53%|5| 9/17 [00:04<00:01,  5.59it/s, loss=0.4104, gradTraining Epoch 4/5:  59%|5| 10/17 [00:04<00:01,  6.36it/s, loss=0.4104, graTraining Epoch 4/5:  59%|5| 10/17 [00:05<00:01,  6.36it/s, loss=0.5120, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  7.01it/s, loss=0.5120, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  7.01it/s, loss=0.4166, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  7.50it/s, loss=0.4166, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  7.50it/s, loss=0.3743, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.95it/s, loss=0.3743, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.95it/s, loss=0.4074, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  8.28it/s, loss=0.4074, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  8.28it/s, loss=0.4101, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  8.53it/s, loss=0.4101, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  8.53it/s, loss=0.4267, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.72it/s, loss=0.4267, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.72it/s, loss=0.3136, graTraining Epoch 4/5: 100%|#| 17/17 [00:06<00:00,  2.73it/s, loss=0.3136, gra

Epoch 4/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.4527, Acc: 0.8769, Precision: 0.8182, Recall: 0.9692, F1: 0.8873, AUC: 0.9413
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.3560, grad_norm=1.Training Epoch 5/5:   6%| | 1/17 [00:04<01:06,  4.15s/it, loss=0.3560, gradTraining Epoch 5/5:   6%| | 1/17 [00:04<01:06,  4.15s/it, loss=0.3703, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:26,  1.79s/it, loss=0.3703, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:26,  1.79s/it, loss=0.3115, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:14,  1.03s/it, loss=0.3115, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:14,  1.03s/it, loss=0.4369, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.50it/s, loss=0.4369, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.50it/s, loss=0.4433, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.15it/s, loss=0.4433, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.15it/s, loss=0.3754, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  2.89it/s, loss=0.3754, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  2.89it/s, loss=0.3405, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.69it/s, loss=0.3405, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.69it/s, loss=0.3403, gradTraining Epoch 5/5:  47%|4| 8/17 [00:04<00:02,  4.42it/s, loss=0.3403, gradTraining Epoch 5/5:  47%|4| 8/17 [00:05<00:02,  4.42it/s, loss=0.3782, gradTraining Epoch 5/5:  53%|5| 9/17 [00:05<00:01,  5.18it/s, loss=0.3782, gradTraining Epoch 5/5:  53%|5| 9/17 [00:05<00:01,  5.18it/s, loss=0.3463, gradTraining Epoch 5/5:  59%|5| 10/17 [00:05<00:01,  5.86it/s, loss=0.3463, graTraining Epoch 5/5:  59%|5| 10/17 [00:05<00:01,  5.86it/s, loss=0.2794, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.59it/s, loss=0.2794, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.59it/s, loss=0.3691, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.21it/s, loss=0.3691, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.21it/s, loss=0.3036, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.71it/s, loss=0.3036, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.71it/s, loss=0.2732, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.03it/s, loss=0.2732, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.03it/s, loss=0.2231, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.32it/s, loss=0.2231, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.32it/s, loss=0.2642, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.24it/s, loss=0.2642, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.24it/s, loss=1.0501, graTraining Epoch 5/5: 100%|#| 17/17 [00:06<00:00,  2.58it/s, loss=1.0501, gra

Epoch 5/5 Complete (7.0s) [LR: 0.000005]
Train - Loss: 0.3801, Acc: 0.8885, Precision: 0.8483, Recall: 0.9462, F1: 0.8945, AUC: 0.9471
------------------------------------------------------------
Training curves saved to model\chb10_fold0\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb10_fold0
============================================================
✅ Fold 0 training completed successfully!

============================================================
TRAINING FOLD 1/6
============================================================
Using dataset prefix: chb10_fold1
Loading datasets from: preprocessing\data\chb10_fold1
Saving models to: model\chb10_fold1
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2581, std=2.6662
Loaded train dataset: 250 samples
  - Spectrogram shape: torch.Size([250, 30, 18, 50, 10])
  - Value range: [-4.5976, 3.4946]
  - Class distribution: tensor([125, 125])
LOOCV Mode (Fold 1): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6906, grad_norm=0.Training Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.03s/it, loss=0.6906, gradTraining Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.03s/it, loss=0.6902, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.6902, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.6916, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6916, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6921, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.6921, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.7055, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.7055, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6974, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.6974, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.6889, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.6889, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.7001, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.68it/s, loss=0.7001, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.68it/s, loss=0.6994, gradTraining Epoch 1/5:  56%|5| 9/16 [00:04<00:01,  5.52it/s, loss=0.6994, gradTraining Epoch 1/5:  56%|5| 9/16 [00:05<00:01,  5.52it/s, loss=0.6813, gradTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.34it/s, loss=0.6813, graTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.34it/s, loss=0.6958, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  7.07it/s, loss=0.6958, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  7.07it/s, loss=0.6855, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.61it/s, loss=0.6855, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.61it/s, loss=0.7067, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  8.03it/s, loss=0.7067, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  8.03it/s, loss=0.6944, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.33it/s, loss=0.6944, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.33it/s, loss=0.6988, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.59it/s, loss=0.6988, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.59it/s, loss=0.6854, graTraining Epoch 1/5: 100%|#| 16/16 [00:06<00:00,  2.58it/s, loss=0.6854, gra

Epoch 1/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6940, Acc: 0.5080, Precision: 0.5046, Recall: 0.8720, F1: 0.6393, AUC: 0.4865
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.6946, grad_norm=0.Training Epoch 2/5:   6%| | 1/16 [00:03<00:59,  3.99s/it, loss=0.6946, gradTraining Epoch 2/5:   6%| | 1/16 [00:04<00:59,  3.99s/it, loss=0.6892, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.6892, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.6828, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6828, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6787, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.6787, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.6816, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6816, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6795, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.6795, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.6725, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.6725, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.6859, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.74it/s, loss=0.6859, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.74it/s, loss=0.6829, gradTraining Epoch 2/5:  56%|5| 9/16 [00:04<00:01,  5.59it/s, loss=0.6829, gradTraining Epoch 2/5:  56%|5| 9/16 [00:04<00:01,  5.59it/s, loss=0.6844, gradTraining Epoch 2/5:  62%|6| 10/16 [00:04<00:00,  6.36it/s, loss=0.6844, graTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.36it/s, loss=0.6811, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  7.04it/s, loss=0.6811, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  7.04it/s, loss=0.6951, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.66it/s, loss=0.6951, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.66it/s, loss=0.6641, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  8.12it/s, loss=0.6641, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  8.12it/s, loss=0.6776, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.44it/s, loss=0.6776, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.44it/s, loss=0.6544, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.68it/s, loss=0.6544, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.68it/s, loss=0.6680, graTraining Epoch 2/5: 100%|#| 16/16 [00:06<00:00,  2.60it/s, loss=0.6680, gra

Epoch 2/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6795, Acc: 0.7080, Precision: 0.6625, Recall: 0.8480, F1: 0.7439, AUC: 0.7527
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6657, grad_norm=0.Training Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.02s/it, loss=0.6657, gradTraining Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.02s/it, loss=0.6529, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.6529, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.6683, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6683, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6865, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.6865, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.6552, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.24it/s, loss=0.6552, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.24it/s, loss=0.6618, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  3.02it/s, loss=0.6618, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  3.02it/s, loss=0.6367, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.87it/s, loss=0.6367, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.87it/s, loss=0.6492, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.76it/s, loss=0.6492, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.76it/s, loss=0.6169, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.61it/s, loss=0.6169, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.61it/s, loss=0.6882, gradTraining Epoch 3/5:  62%|6| 10/16 [00:04<00:00,  6.40it/s, loss=0.6882, graTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.40it/s, loss=0.6296, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  7.11it/s, loss=0.6296, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  7.11it/s, loss=0.6580, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.73it/s, loss=0.6580, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.73it/s, loss=0.6075, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  8.13it/s, loss=0.6075, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  8.13it/s, loss=0.6248, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.43it/s, loss=0.6248, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.43it/s, loss=0.6027, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.71it/s, loss=0.6027, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.71it/s, loss=0.6137, graTraining Epoch 3/5: 100%|#| 16/16 [00:06<00:00,  2.60it/s, loss=0.6137, gra

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6448, Acc: 0.7160, Precision: 0.6776, Recall: 0.8240, F1: 0.7437, AUC: 0.8111
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.6166, grad_norm=1.Training Epoch 4/5:   6%| | 1/16 [00:03<00:58,  3.91s/it, loss=0.6166, gradTraining Epoch 4/5:   6%| | 1/16 [00:04<00:58,  3.91s/it, loss=0.5944, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:23,  1.67s/it, loss=0.5944, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:23,  1.67s/it, loss=0.6207, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.03it/s, loss=0.6207, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.03it/s, loss=0.6910, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.59it/s, loss=0.6910, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.59it/s, loss=0.6000, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.27it/s, loss=0.6000, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.27it/s, loss=0.6195, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  3.05it/s, loss=0.6195, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  3.05it/s, loss=0.6537, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.91it/s, loss=0.6537, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.91it/s, loss=0.5283, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.81it/s, loss=0.5283, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.81it/s, loss=0.5438, gradTraining Epoch 4/5:  56%|5| 9/16 [00:04<00:01,  5.70it/s, loss=0.5438, gradTraining Epoch 4/5:  56%|5| 9/16 [00:04<00:01,  5.70it/s, loss=0.6079, gradTraining Epoch 4/5:  62%|6| 10/16 [00:04<00:00,  6.47it/s, loss=0.6079, graTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.47it/s, loss=0.5911, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  7.17it/s, loss=0.5911, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  7.17it/s, loss=0.5356, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.65it/s, loss=0.5356, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.65it/s, loss=0.5210, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  8.04it/s, loss=0.5210, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  8.04it/s, loss=0.5027, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.33it/s, loss=0.5027, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.33it/s, loss=0.5334, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.55it/s, loss=0.5334, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.55it/s, loss=0.5186, graTraining Epoch 4/5: 100%|#| 16/16 [00:06<00:00,  2.63it/s, loss=0.5186, gra

Epoch 4/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.5799, Acc: 0.7720, Precision: 0.7048, Recall: 0.9360, F1: 0.8041, AUC: 0.8551
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.5040, grad_norm=1.Training Epoch 5/5:   6%| | 1/16 [00:03<00:59,  3.99s/it, loss=0.5040, gradTraining Epoch 5/5:   6%| | 1/16 [00:04<00:59,  3.99s/it, loss=0.5518, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.5518, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.4854, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.4854, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.5257, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.5257, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.4775, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.4775, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.5110, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.5110, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.4996, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.4996, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.4379, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.71it/s, loss=0.4379, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.71it/s, loss=0.5007, gradTraining Epoch 5/5:  56%|5| 9/16 [00:04<00:01,  5.54it/s, loss=0.5007, gradTraining Epoch 5/5:  56%|5| 9/16 [00:04<00:01,  5.54it/s, loss=0.4962, gradTraining Epoch 5/5:  62%|6| 10/16 [00:04<00:00,  6.31it/s, loss=0.4962, graTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.31it/s, loss=0.4787, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  7.01it/s, loss=0.4787, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  7.01it/s, loss=0.4251, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.59it/s, loss=0.4251, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.59it/s, loss=0.3860, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  8.00it/s, loss=0.3860, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  8.00it/s, loss=0.4286, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.28it/s, loss=0.4286, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.28it/s, loss=0.6749, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.48it/s, loss=0.6749, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.48it/s, loss=0.3482, graTraining Epoch 5/5: 100%|#| 16/16 [00:06<00:00,  2.59it/s, loss=0.3482, gra

Epoch 5/5 Complete (6.6s) [LR: 0.000005]
Train - Loss: 0.4832, Acc: 0.8040, Precision: 0.7533, Recall: 0.9040, F1: 0.8218, AUC: 0.9180
------------------------------------------------------------
Training curves saved to model\chb10_fold1\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb10_fold1
============================================================
✅ Fold 1 training completed successfully!

============================================================
TRAINING FOLD 2/6
============================================================
Using dataset prefix: chb10_fold2
Loading datasets from: preprocessing\data\chb10_fold2
Saving models to: model\chb10_fold2
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.3637, std=2.6628
Loaded train dataset: 250 samples
  - Spectrogram shape: torch.Size([250, 30, 18, 50, 10])
  - Value range: [-4.6431, 3.4604]
  - Class distribution: tensor([125, 125])
LOOCV Mode (Fold 2): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.6752, grad_norm=1.Training Epoch 1/5:   6%| | 1/16 [00:03<00:59,  3.98s/it, loss=0.6752, gradTraining Epoch 1/5:   6%| | 1/16 [00:04<00:59,  3.98s/it, loss=0.6791, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:23,  1.70s/it, loss=0.6791, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:23,  1.70s/it, loss=0.7035, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.7035, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6368, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.58it/s, loss=0.6368, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.58it/s, loss=0.7004, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.25it/s, loss=0.7004, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.25it/s, loss=0.6901, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  3.03it/s, loss=0.6901, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  3.03it/s, loss=0.7077, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.88it/s, loss=0.7077, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.88it/s, loss=0.6972, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.6972, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.7272, gradTraining Epoch 1/5:  56%|5| 9/16 [00:04<00:01,  5.57it/s, loss=0.7272, gradTraining Epoch 1/5:  56%|5| 9/16 [00:04<00:01,  5.57it/s, loss=0.7052, gradTraining Epoch 1/5:  62%|6| 10/16 [00:04<00:00,  6.22it/s, loss=0.7052, graTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.22it/s, loss=0.6996, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.96it/s, loss=0.6996, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.96it/s, loss=0.7135, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.52it/s, loss=0.7135, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.52it/s, loss=0.7044, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.94it/s, loss=0.7044, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.94it/s, loss=0.6693, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.30it/s, loss=0.6693, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.30it/s, loss=0.6792, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.53it/s, loss=0.6792, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.53it/s, loss=0.6655, graTraining Epoch 1/5: 100%|#| 16/16 [00:06<00:00,  2.60it/s, loss=0.6655, gra

Epoch 1/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6909, Acc: 0.5120, Precision: 0.5061, Recall: 1.0000, F1: 0.6720, AUC: 0.5620
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.6639, grad_norm=0.Training Epoch 2/5:   6%| | 1/16 [00:03<00:59,  4.00s/it, loss=0.6639, gradTraining Epoch 2/5:   6%| | 1/16 [00:04<00:59,  4.00s/it, loss=0.6799, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.6799, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.6754, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6754, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6613, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.6613, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.6797, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:04,  2.24it/s, loss=0.6797, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:04,  2.24it/s, loss=0.6470, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  3.03it/s, loss=0.6470, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  3.03it/s, loss=0.6779, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.88it/s, loss=0.6779, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.88it/s, loss=0.6594, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.76it/s, loss=0.6594, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.76it/s, loss=0.6903, gradTraining Epoch 2/5:  56%|5| 9/16 [00:04<00:01,  5.60it/s, loss=0.6903, gradTraining Epoch 2/5:  56%|5| 9/16 [00:04<00:01,  5.60it/s, loss=0.6584, gradTraining Epoch 2/5:  62%|6| 10/16 [00:04<00:00,  6.38it/s, loss=0.6584, graTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.38it/s, loss=0.6797, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  7.08it/s, loss=0.6797, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  7.08it/s, loss=0.6554, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.61it/s, loss=0.6554, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.61it/s, loss=0.6778, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.96it/s, loss=0.6778, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.96it/s, loss=0.6754, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.17it/s, loss=0.6754, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.17it/s, loss=0.6784, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.44it/s, loss=0.6784, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.44it/s, loss=0.6472, graTraining Epoch 2/5: 100%|#| 16/16 [00:06<00:00,  2.60it/s, loss=0.6472, gra

Epoch 2/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.6692, Acc: 0.6400, Precision: 0.5814, Recall: 1.0000, F1: 0.7353, AUC: 0.7780
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6427, grad_norm=1.Training Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.03s/it, loss=0.6427, gradTraining Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.03s/it, loss=0.6855, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.6855, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.6199, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6199, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6415, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.6415, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.6361, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6361, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6541, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.99it/s, loss=0.6541, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.99it/s, loss=0.6173, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.84it/s, loss=0.6173, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.84it/s, loss=0.6591, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.68it/s, loss=0.6591, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.68it/s, loss=0.6175, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.50it/s, loss=0.6175, gradTraining Epoch 3/5:  56%|5| 9/16 [00:05<00:01,  5.50it/s, loss=0.6174, gradTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.26it/s, loss=0.6174, graTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.26it/s, loss=0.5840, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.93it/s, loss=0.5840, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.93it/s, loss=0.6118, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.46it/s, loss=0.6118, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.46it/s, loss=0.5889, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.95it/s, loss=0.5889, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.95it/s, loss=0.6711, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.32it/s, loss=0.6711, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.32it/s, loss=0.5992, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.59it/s, loss=0.5992, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.59it/s, loss=0.6581, graTraining Epoch 3/5: 100%|#| 16/16 [00:06<00:00,  2.57it/s, loss=0.6581, gra

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6315, Acc: 0.7320, Precision: 0.6686, Recall: 0.9200, F1: 0.7744, AUC: 0.8052
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6507, grad_norm=1.Training Epoch 4/5:   6%| | 1/16 [00:04<01:00,  4.03s/it, loss=0.6507, gradTraining Epoch 4/5:   6%| | 1/16 [00:04<01:00,  4.03s/it, loss=0.6690, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.6690, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.5534, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.5534, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6057, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.6057, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.6012, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6012, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.5238, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.99it/s, loss=0.5238, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.99it/s, loss=0.6522, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.83it/s, loss=0.6522, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.83it/s, loss=0.5296, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.71it/s, loss=0.5296, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.71it/s, loss=0.5902, gradTraining Epoch 4/5:  56%|5| 9/16 [00:04<00:01,  5.57it/s, loss=0.5902, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.57it/s, loss=0.5510, gradTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.30it/s, loss=0.5510, graTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.30it/s, loss=0.6066, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.92it/s, loss=0.6066, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.92it/s, loss=0.5300, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.29it/s, loss=0.5300, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.29it/s, loss=0.5045, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.77it/s, loss=0.5045, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.77it/s, loss=0.5163, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.16it/s, loss=0.5163, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.16it/s, loss=0.5443, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.41it/s, loss=0.5443, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.41it/s, loss=0.5351, graTraining Epoch 4/5: 100%|#| 16/16 [00:06<00:00,  2.57it/s, loss=0.5351, gra

Epoch 4/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5727, Acc: 0.7320, Precision: 0.6686, Recall: 0.9200, F1: 0.7744, AUC: 0.8637
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.5172, grad_norm=1.Training Epoch 5/5:   6%| | 1/16 [00:04<01:00,  4.00s/it, loss=0.5172, gradTraining Epoch 5/5:   6%| | 1/16 [00:04<01:00,  4.00s/it, loss=0.4711, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.4711, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.4533, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.4533, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.5147, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.5147, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.4525, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.24it/s, loss=0.4525, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.24it/s, loss=0.6480, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.01it/s, loss=0.6480, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.01it/s, loss=0.5134, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.87it/s, loss=0.5134, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.87it/s, loss=0.4672, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.4672, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.4741, gradTraining Epoch 5/5:  56%|5| 9/16 [00:04<00:01,  5.59it/s, loss=0.4741, gradTraining Epoch 5/5:  56%|5| 9/16 [00:04<00:01,  5.59it/s, loss=0.4342, gradTraining Epoch 5/5:  62%|6| 10/16 [00:04<00:00,  6.40it/s, loss=0.4342, graTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.40it/s, loss=0.4046, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  7.07it/s, loss=0.4046, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  7.07it/s, loss=0.4513, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.58it/s, loss=0.4513, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.58it/s, loss=0.4214, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.96it/s, loss=0.4214, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.96it/s, loss=0.4146, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.28it/s, loss=0.4146, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.28it/s, loss=0.3548, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.52it/s, loss=0.3548, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.52it/s, loss=0.8196, graTraining Epoch 5/5: 100%|#| 16/16 [00:06<00:00,  2.59it/s, loss=0.8196, gra

Epoch 5/5 Complete (6.6s) [LR: 0.000005]
Train - Loss: 0.4882, Acc: 0.8160, Precision: 0.7582, Recall: 0.9280, F1: 0.8345, AUC: 0.9247
------------------------------------------------------------
Training curves saved to model\chb10_fold2\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb10_fold2
============================================================
✅ Fold 2 training completed successfully!

============================================================
TRAINING FOLD 3/6
============================================================
Using dataset prefix: chb10_fold3
Loading datasets from: preprocessing\data\chb10_fold3
Saving models to: model\chb10_fold3
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.3689, std=2.6432
Loaded train dataset: 260 samples
  - Spectrogram shape: torch.Size([260, 30, 18, 50, 10])
  - Value range: [-4.6795, 3.4933]
  - Class distribution: tensor([130, 130])
LOOCV Mode (Fold 3): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.6893, grad_norm=0.Training Epoch 1/5:   6%| | 1/17 [00:03<01:00,  3.79s/it, loss=0.6893, gradTraining Epoch 1/5:   6%| | 1/17 [00:03<01:00,  3.79s/it, loss=0.7049, gradTraining Epoch 1/5:  12%|1| 2/17 [00:03<00:24,  1.63s/it, loss=0.7049, gradTraining Epoch 1/5:  12%|1| 2/17 [00:04<00:24,  1.63s/it, loss=0.6886, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:13,  1.06it/s, loss=0.6886, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:13,  1.06it/s, loss=0.6888, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.61it/s, loss=0.6888, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.61it/s, loss=0.6931, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.29it/s, loss=0.6931, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.29it/s, loss=0.6915, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  3.08it/s, loss=0.6915, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  3.08it/s, loss=0.6843, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.94it/s, loss=0.6843, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.94it/s, loss=0.6847, gradTraining Epoch 1/5:  47%|4| 8/17 [00:04<00:01,  4.83it/s, loss=0.6847, gradTraining Epoch 1/5:  47%|4| 8/17 [00:04<00:01,  4.83it/s, loss=0.6860, gradTraining Epoch 1/5:  53%|5| 9/17 [00:04<00:01,  5.68it/s, loss=0.6860, gradTraining Epoch 1/5:  53%|5| 9/17 [00:04<00:01,  5.68it/s, loss=0.7018, gradTraining Epoch 1/5:  59%|5| 10/17 [00:04<00:01,  6.40it/s, loss=0.7018, graTraining Epoch 1/5:  59%|5| 10/17 [00:04<00:01,  6.40it/s, loss=0.6785, graTraining Epoch 1/5:  65%|6| 11/17 [00:04<00:00,  7.03it/s, loss=0.6785, graTraining Epoch 1/5:  65%|6| 11/17 [00:05<00:00,  7.03it/s, loss=0.6850, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.58it/s, loss=0.6850, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.58it/s, loss=0.6791, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  8.03it/s, loss=0.6791, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  8.03it/s, loss=0.6716, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  8.38it/s, loss=0.6716, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  8.38it/s, loss=0.6863, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.52it/s, loss=0.6863, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.52it/s, loss=0.6792, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.57it/s, loss=0.6792, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.57it/s, loss=0.6838, graTraining Epoch 1/5: 100%|#| 17/17 [00:06<00:00,  2.78it/s, loss=0.6838, gra

Epoch 1/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.6869, Acc: 0.5615, Precision: 0.6538, Recall: 0.2615, F1: 0.3736, AUC: 0.6502
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.6721, grad_norm=1.Training Epoch 2/5:   6%| | 1/17 [00:04<01:06,  4.17s/it, loss=0.6721, gradTraining Epoch 2/5:   6%| | 1/17 [00:04<01:06,  4.17s/it, loss=0.6720, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:26,  1.78s/it, loss=0.6720, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:26,  1.78s/it, loss=0.6529, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:14,  1.02s/it, loss=0.6529, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:14,  1.02s/it, loss=0.6687, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.50it/s, loss=0.6687, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.50it/s, loss=0.6766, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.10it/s, loss=0.6766, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.10it/s, loss=0.6642, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  2.80it/s, loss=0.6642, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  2.80it/s, loss=0.6525, gradTraining Epoch 2/5:  41%|4| 7/17 [00:04<00:02,  3.62it/s, loss=0.6525, gradTraining Epoch 2/5:  41%|4| 7/17 [00:05<00:02,  3.62it/s, loss=0.6546, gradTraining Epoch 2/5:  47%|4| 8/17 [00:05<00:02,  4.47it/s, loss=0.6546, gradTraining Epoch 2/5:  47%|4| 8/17 [00:05<00:02,  4.47it/s, loss=0.6654, gradTraining Epoch 2/5:  53%|5| 9/17 [00:05<00:01,  5.31it/s, loss=0.6654, gradTraining Epoch 2/5:  53%|5| 9/17 [00:05<00:01,  5.31it/s, loss=0.6363, gradTraining Epoch 2/5:  59%|5| 10/17 [00:05<00:01,  6.08it/s, loss=0.6363, graTraining Epoch 2/5:  59%|5| 10/17 [00:05<00:01,  6.08it/s, loss=0.6734, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  6.75it/s, loss=0.6734, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  6.75it/s, loss=0.6622, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  7.06it/s, loss=0.6622, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  7.06it/s, loss=0.6222, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  7.39it/s, loss=0.6222, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  7.39it/s, loss=0.6373, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  7.52it/s, loss=0.6373, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  7.52it/s, loss=0.6306, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  7.59it/s, loss=0.6306, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  7.59it/s, loss=0.6346, graTraining Epoch 2/5:  94%|9| 16/17 [00:05<00:00,  7.58it/s, loss=0.6346, graTraining Epoch 2/5:  94%|9| 16/17 [00:06<00:00,  7.58it/s, loss=0.6304, graTraining Epoch 2/5: 100%|#| 17/17 [00:06<00:00,  2.57it/s, loss=0.6304, gra

Epoch 2/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6533, Acc: 0.7731, Precision: 0.7591, Recall: 0.8000, F1: 0.7790, AUC: 0.8640
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.6464, grad_norm=1.Training Epoch 3/5:   6%| | 1/17 [00:03<01:03,  3.99s/it, loss=0.6464, gradTraining Epoch 3/5:   6%| | 1/17 [00:04<01:03,  3.99s/it, loss=0.6080, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:25,  1.71s/it, loss=0.6080, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:25,  1.71s/it, loss=0.6110, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:13,  1.02it/s, loss=0.6110, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:13,  1.02it/s, loss=0.6543, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.57it/s, loss=0.6543, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.57it/s, loss=0.6618, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.23it/s, loss=0.6618, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.23it/s, loss=0.6245, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  3.00it/s, loss=0.6245, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  3.00it/s, loss=0.5827, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.84it/s, loss=0.5827, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.84it/s, loss=0.5908, gradTraining Epoch 3/5:  47%|4| 8/17 [00:04<00:01,  4.70it/s, loss=0.5908, gradTraining Epoch 3/5:  47%|4| 8/17 [00:04<00:01,  4.70it/s, loss=0.5918, gradTraining Epoch 3/5:  53%|5| 9/17 [00:04<00:01,  5.56it/s, loss=0.5918, gradTraining Epoch 3/5:  53%|5| 9/17 [00:04<00:01,  5.56it/s, loss=0.5780, gradTraining Epoch 3/5:  59%|5| 10/17 [00:04<00:01,  6.34it/s, loss=0.5780, graTraining Epoch 3/5:  59%|5| 10/17 [00:05<00:01,  6.34it/s, loss=0.5400, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  7.03it/s, loss=0.5400, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  7.03it/s, loss=0.5468, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  7.56it/s, loss=0.5468, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  7.56it/s, loss=0.6256, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  8.02it/s, loss=0.6256, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  8.02it/s, loss=0.5826, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  8.24it/s, loss=0.5826, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  8.24it/s, loss=0.5355, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  8.42it/s, loss=0.5355, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  8.42it/s, loss=0.6017, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.59it/s, loss=0.6017, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.59it/s, loss=0.4699, graTraining Epoch 3/5: 100%|#| 17/17 [00:06<00:00,  2.71it/s, loss=0.4699, gra

Epoch 3/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.5913, Acc: 0.7923, Precision: 0.7209, Recall: 0.9538, F1: 0.8212, AUC: 0.8490
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.5940, grad_norm=1.Training Epoch 4/5:   6%| | 1/17 [00:03<01:02,  3.93s/it, loss=0.5940, gradTraining Epoch 4/5:   6%| | 1/17 [00:04<01:02,  3.93s/it, loss=0.5863, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.5863, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.4715, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:13,  1.04it/s, loss=0.4715, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:13,  1.04it/s, loss=0.5104, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.59it/s, loss=0.5104, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.59it/s, loss=0.5162, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.5162, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.5451, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  3.04it/s, loss=0.5451, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  3.04it/s, loss=0.5067, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.88it/s, loss=0.5067, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.88it/s, loss=0.3979, gradTraining Epoch 4/5:  47%|4| 8/17 [00:04<00:01,  4.74it/s, loss=0.3979, gradTraining Epoch 4/5:  47%|4| 8/17 [00:04<00:01,  4.74it/s, loss=0.5789, gradTraining Epoch 4/5:  53%|5| 9/17 [00:04<00:01,  5.55it/s, loss=0.5789, gradTraining Epoch 4/5:  53%|5| 9/17 [00:04<00:01,  5.55it/s, loss=0.4584, gradTraining Epoch 4/5:  59%|5| 10/17 [00:04<00:01,  6.29it/s, loss=0.4584, graTraining Epoch 4/5:  59%|5| 10/17 [00:05<00:01,  6.29it/s, loss=0.4791, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  6.98it/s, loss=0.4791, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  6.98it/s, loss=0.4725, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  7.52it/s, loss=0.4725, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  7.52it/s, loss=0.5225, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.95it/s, loss=0.5225, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.95it/s, loss=0.4281, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  8.27it/s, loss=0.4281, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  8.27it/s, loss=0.4772, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  8.56it/s, loss=0.4772, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  8.56it/s, loss=0.5941, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.73it/s, loss=0.5941, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.73it/s, loss=0.5860, graTraining Epoch 4/5: 100%|#| 17/17 [00:06<00:00,  2.74it/s, loss=0.5860, gra

Epoch 4/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5132, Acc: 0.7962, Precision: 0.7333, Recall: 0.9308, F1: 0.8203, AUC: 0.8727
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.3050, grad_norm=0.Training Epoch 5/5:   6%| | 1/17 [00:04<01:04,  4.04s/it, loss=0.3050, gradTraining Epoch 5/5:   6%| | 1/17 [00:04<01:04,  4.04s/it, loss=0.5076, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:25,  1.73s/it, loss=0.5076, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:25,  1.73s/it, loss=0.4561, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.4561, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.4318, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.56it/s, loss=0.4318, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.56it/s, loss=0.4585, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.22it/s, loss=0.4585, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.22it/s, loss=0.3283, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  2.98it/s, loss=0.3283, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  2.98it/s, loss=0.3476, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.82it/s, loss=0.3476, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.82it/s, loss=0.3669, gradTraining Epoch 5/5:  47%|4| 8/17 [00:04<00:01,  4.70it/s, loss=0.3669, gradTraining Epoch 5/5:  47%|4| 8/17 [00:04<00:01,  4.70it/s, loss=0.3475, gradTraining Epoch 5/5:  53%|5| 9/17 [00:04<00:01,  5.54it/s, loss=0.3475, gradTraining Epoch 5/5:  53%|5| 9/17 [00:05<00:01,  5.54it/s, loss=0.4452, gradTraining Epoch 5/5:  59%|5| 10/17 [00:05<00:01,  6.32it/s, loss=0.4452, graTraining Epoch 5/5:  59%|5| 10/17 [00:05<00:01,  6.32it/s, loss=0.5044, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.98it/s, loss=0.5044, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.98it/s, loss=0.3441, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.47it/s, loss=0.3441, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.47it/s, loss=0.4494, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.93it/s, loss=0.4494, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.93it/s, loss=0.3659, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.26it/s, loss=0.3659, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.26it/s, loss=0.2548, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.49it/s, loss=0.2548, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.49it/s, loss=0.2874, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.68it/s, loss=0.2874, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.68it/s, loss=0.4603, graTraining Epoch 5/5: 100%|#| 17/17 [00:06<00:00,  2.68it/s, loss=0.4603, gra

Epoch 5/5 Complete (6.7s) [LR: 0.000005]
Train - Loss: 0.3918, Acc: 0.8423, Precision: 0.8027, Recall: 0.9077, F1: 0.8520, AUC: 0.9455
------------------------------------------------------------
Training curves saved to model\chb10_fold3\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb10_fold3
============================================================
✅ Fold 3 training completed successfully!

============================================================
TRAINING FOLD 4/6
============================================================
Using dataset prefix: chb10_fold4
Loading datasets from: preprocessing\data\chb10_fold4
Saving models to: model\chb10_fold4
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.3086, std=2.6616
Loaded train dataset: 258 samples
  - Spectrogram shape: torch.Size([258, 30, 18, 50, 10])
  - Value range: [-4.6245, 3.4895]
  - Class distribution: tensor([129, 129])
LOOCV Mode (Fold 4): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.6994, grad_norm=1.Training Epoch 1/5:   6%| | 1/17 [00:04<01:04,  4.05s/it, loss=0.6994, gradTraining Epoch 1/5:   6%| | 1/17 [00:04<01:04,  4.05s/it, loss=0.6994, gradTraining Epoch 1/5:  12%|1| 2/17 [00:04<00:26,  1.74s/it, loss=0.6994, gradTraining Epoch 1/5:  12%|1| 2/17 [00:04<00:26,  1.74s/it, loss=0.6866, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:14,  1.00s/it, loss=0.6866, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:14,  1.00s/it, loss=0.7038, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.54it/s, loss=0.7038, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.54it/s, loss=0.6897, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.19it/s, loss=0.6897, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.19it/s, loss=0.6838, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  2.95it/s, loss=0.6838, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  2.95it/s, loss=0.6893, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.79it/s, loss=0.6893, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.79it/s, loss=0.6906, gradTraining Epoch 1/5:  47%|4| 8/17 [00:04<00:01,  4.64it/s, loss=0.6906, gradTraining Epoch 1/5:  47%|4| 8/17 [00:04<00:01,  4.64it/s, loss=0.6846, gradTraining Epoch 1/5:  53%|5| 9/17 [00:04<00:01,  5.47it/s, loss=0.6846, gradTraining Epoch 1/5:  53%|5| 9/17 [00:05<00:01,  5.47it/s, loss=0.6818, gradTraining Epoch 1/5:  59%|5| 10/17 [00:05<00:01,  6.22it/s, loss=0.6818, graTraining Epoch 1/5:  59%|5| 10/17 [00:05<00:01,  6.22it/s, loss=0.6838, graTraining Epoch 1/5:  65%|6| 11/17 [00:05<00:00,  6.89it/s, loss=0.6838, graTraining Epoch 1/5:  65%|6| 11/17 [00:05<00:00,  6.89it/s, loss=0.6976, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.43it/s, loss=0.6976, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.43it/s, loss=0.6936, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  7.87it/s, loss=0.6936, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  7.87it/s, loss=0.6830, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  8.19it/s, loss=0.6830, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  8.19it/s, loss=0.6689, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.47it/s, loss=0.6689, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.47it/s, loss=0.6754, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.68it/s, loss=0.6754, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.68it/s, loss=0.6659, graTraining Epoch 1/5: 100%|#| 17/17 [00:06<00:00,  2.68it/s, loss=0.6659, gra

Epoch 1/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6869, Acc: 0.5736, Precision: 0.6418, Recall: 0.3333, F1: 0.4388, AUC: 0.6269
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.6684, grad_norm=1.Training Epoch 2/5:   6%| | 1/17 [00:04<01:04,  4.03s/it, loss=0.6684, gradTraining Epoch 2/5:   6%| | 1/17 [00:04<01:04,  4.03s/it, loss=0.6669, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:25,  1.73s/it, loss=0.6669, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:25,  1.73s/it, loss=0.6703, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.6703, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.6869, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.55it/s, loss=0.6869, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.55it/s, loss=0.6683, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.20it/s, loss=0.6683, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.20it/s, loss=0.6935, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  2.91it/s, loss=0.6935, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  2.91it/s, loss=0.6906, gradTraining Epoch 2/5:  41%|4| 7/17 [00:04<00:02,  3.66it/s, loss=0.6906, gradTraining Epoch 2/5:  41%|4| 7/17 [00:04<00:02,  3.66it/s, loss=0.6590, gradTraining Epoch 2/5:  47%|4| 8/17 [00:04<00:02,  4.43it/s, loss=0.6590, gradTraining Epoch 2/5:  47%|4| 8/17 [00:05<00:02,  4.43it/s, loss=0.6548, gradTraining Epoch 2/5:  53%|5| 9/17 [00:05<00:01,  5.14it/s, loss=0.6548, gradTraining Epoch 2/5:  53%|5| 9/17 [00:05<00:01,  5.14it/s, loss=0.6585, gradTraining Epoch 2/5:  59%|5| 10/17 [00:05<00:01,  5.68it/s, loss=0.6585, graTraining Epoch 2/5:  59%|5| 10/17 [00:05<00:01,  5.68it/s, loss=0.6659, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  6.20it/s, loss=0.6659, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  6.20it/s, loss=0.6686, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  6.53it/s, loss=0.6686, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  6.53it/s, loss=0.6514, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  6.97it/s, loss=0.6514, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  6.97it/s, loss=0.6804, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  7.49it/s, loss=0.6804, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  7.49it/s, loss=0.6868, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  7.71it/s, loss=0.6868, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  7.71it/s, loss=0.6733, graTraining Epoch 2/5:  94%|9| 16/17 [00:05<00:00,  7.75it/s, loss=0.6733, graTraining Epoch 2/5:  94%|9| 16/17 [00:05<00:00,  7.75it/s, loss=0.6742, graTraining Epoch 2/5: 100%|#| 17/17 [00:06<00:00,  2.61it/s, loss=0.6742, gra

Epoch 2/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6716, Acc: 0.6085, Precision: 0.7121, Recall: 0.3643, F1: 0.4821, AUC: 0.7642
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.6377, grad_norm=1.Training Epoch 3/5:   6%| | 1/17 [00:04<01:06,  4.14s/it, loss=0.6377, gradTraining Epoch 3/5:   6%| | 1/17 [00:04<01:06,  4.14s/it, loss=0.6389, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:26,  1.77s/it, loss=0.6389, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:26,  1.77s/it, loss=0.6489, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:14,  1.01s/it, loss=0.6489, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:14,  1.01s/it, loss=0.6347, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.53it/s, loss=0.6347, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.53it/s, loss=0.6511, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.16it/s, loss=0.6511, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.16it/s, loss=0.6460, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  2.93it/s, loss=0.6460, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  2.93it/s, loss=0.6195, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.75it/s, loss=0.6195, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.75it/s, loss=0.6174, gradTraining Epoch 3/5:  47%|4| 8/17 [00:04<00:01,  4.63it/s, loss=0.6174, gradTraining Epoch 3/5:  47%|4| 8/17 [00:05<00:01,  4.63it/s, loss=0.5933, gradTraining Epoch 3/5:  53%|5| 9/17 [00:05<00:01,  5.50it/s, loss=0.5933, gradTraining Epoch 3/5:  53%|5| 9/17 [00:05<00:01,  5.50it/s, loss=0.6348, gradTraining Epoch 3/5:  59%|5| 10/17 [00:05<00:01,  6.28it/s, loss=0.6348, graTraining Epoch 3/5:  59%|5| 10/17 [00:05<00:01,  6.28it/s, loss=0.6480, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  6.99it/s, loss=0.6480, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  6.99it/s, loss=0.6137, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  7.56it/s, loss=0.6137, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  7.56it/s, loss=0.6014, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  8.03it/s, loss=0.6014, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  8.03it/s, loss=0.6076, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  8.37it/s, loss=0.6076, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  8.37it/s, loss=0.5967, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  8.63it/s, loss=0.5967, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  8.63it/s, loss=0.6227, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.80it/s, loss=0.6227, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.80it/s, loss=0.7335, graTraining Epoch 3/5: 100%|#| 17/17 [00:06<00:00,  2.66it/s, loss=0.7335, gra

Epoch 3/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6321, Acc: 0.7558, Precision: 0.7260, Recall: 0.8217, F1: 0.7709, AUC: 0.8170
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.5978, grad_norm=1.Training Epoch 4/5:   6%| | 1/17 [00:04<01:04,  4.01s/it, loss=0.5978, gradTraining Epoch 4/5:   6%| | 1/17 [00:04<01:04,  4.01s/it, loss=0.5978, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:25,  1.73s/it, loss=0.5978, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:25,  1.73s/it, loss=0.5807, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.5807, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.6018, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.54it/s, loss=0.6018, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.54it/s, loss=0.5724, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.15it/s, loss=0.5724, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.15it/s, loss=0.5827, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  2.85it/s, loss=0.5827, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  2.85it/s, loss=0.5652, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.56it/s, loss=0.5652, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.56it/s, loss=0.5364, gradTraining Epoch 4/5:  47%|4| 8/17 [00:04<00:02,  4.28it/s, loss=0.5364, gradTraining Epoch 4/5:  47%|4| 8/17 [00:05<00:02,  4.28it/s, loss=0.5385, gradTraining Epoch 4/5:  53%|5| 9/17 [00:05<00:01,  5.06it/s, loss=0.5385, gradTraining Epoch 4/5:  53%|5| 9/17 [00:05<00:01,  5.06it/s, loss=0.5566, gradTraining Epoch 4/5:  59%|5| 10/17 [00:05<00:01,  5.74it/s, loss=0.5566, graTraining Epoch 4/5:  59%|5| 10/17 [00:05<00:01,  5.74it/s, loss=0.5568, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  6.35it/s, loss=0.5568, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  6.35it/s, loss=0.5347, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  6.88it/s, loss=0.5347, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  6.88it/s, loss=0.5793, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.25it/s, loss=0.5793, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.25it/s, loss=0.5170, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  7.60it/s, loss=0.5170, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  7.60it/s, loss=0.5658, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  8.02it/s, loss=0.5658, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  8.02it/s, loss=0.6223, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.37it/s, loss=0.6223, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.37it/s, loss=0.5373, graTraining Epoch 4/5: 100%|#| 17/17 [00:06<00:00,  2.61it/s, loss=0.5373, gra

Epoch 4/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.5673, Acc: 0.7403, Precision: 0.6649, Recall: 0.9690, F1: 0.7886, AUC: 0.8341
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.4663, grad_norm=1.Training Epoch 5/5:   6%| | 1/17 [00:04<01:04,  4.06s/it, loss=0.4663, gradTraining Epoch 5/5:   6%| | 1/17 [00:04<01:04,  4.06s/it, loss=0.5419, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:26,  1.74s/it, loss=0.5419, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:26,  1.74s/it, loss=0.4660, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.4660, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.4394, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.55it/s, loss=0.4394, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.55it/s, loss=0.4898, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.22it/s, loss=0.4898, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.22it/s, loss=0.4802, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  2.98it/s, loss=0.4802, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  2.98it/s, loss=0.5112, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.82it/s, loss=0.5112, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.82it/s, loss=0.4279, gradTraining Epoch 5/5:  47%|4| 8/17 [00:04<00:01,  4.68it/s, loss=0.4279, gradTraining Epoch 5/5:  47%|4| 8/17 [00:04<00:01,  4.68it/s, loss=0.5007, gradTraining Epoch 5/5:  53%|5| 9/17 [00:04<00:01,  5.50it/s, loss=0.5007, gradTraining Epoch 5/5:  53%|5| 9/17 [00:05<00:01,  5.50it/s, loss=0.5028, gradTraining Epoch 5/5:  59%|5| 10/17 [00:05<00:01,  6.28it/s, loss=0.5028, graTraining Epoch 5/5:  59%|5| 10/17 [00:05<00:01,  6.28it/s, loss=0.6519, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.94it/s, loss=0.6519, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.94it/s, loss=0.4682, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.42it/s, loss=0.4682, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.42it/s, loss=0.3712, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.82it/s, loss=0.3712, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.82it/s, loss=0.4820, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.13it/s, loss=0.4820, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.13it/s, loss=0.4163, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.39it/s, loss=0.4163, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.39it/s, loss=0.4871, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.55it/s, loss=0.4871, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.55it/s, loss=0.8059, graTraining Epoch 5/5: 100%|#| 17/17 [00:06<00:00,  2.69it/s, loss=0.8059, gra

Epoch 5/5 Complete (6.7s) [LR: 0.000005]
Train - Loss: 0.5005, Acc: 0.8140, Precision: 0.7872, Recall: 0.8605, F1: 0.8222, AUC: 0.9033
------------------------------------------------------------
Training curves saved to model\chb10_fold4\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb10_fold4
============================================================
✅ Fold 4 training completed successfully!

============================================================
TRAINING FOLD 5/6
============================================================
Using dataset prefix: chb10_fold5
Loading datasets from: preprocessing\data\chb10_fold5
Saving models to: model\chb10_fold5
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2188, std=2.6438
Loaded train dataset: 252 samples
  - Spectrogram shape: torch.Size([252, 30, 18, 50, 10])
  - Value range: [-4.6217, 3.5479]
  - Class distribution: tensor([126, 126])
LOOCV Mode (Fold 5): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6881, grad_norm=1.Training Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.07s/it, loss=0.6881, gradTraining Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.07s/it, loss=0.7187, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.74s/it, loss=0.7187, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.74s/it, loss=0.6947, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.00it/s, loss=0.6947, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.00it/s, loss=0.6768, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.54it/s, loss=0.6768, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.54it/s, loss=0.6884, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.6884, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.6820, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.92it/s, loss=0.6820, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.92it/s, loss=0.6857, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.73it/s, loss=0.6857, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.73it/s, loss=0.7025, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.55it/s, loss=0.7025, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.55it/s, loss=0.6870, gradTraining Epoch 1/5:  56%|5| 9/16 [00:04<00:01,  5.34it/s, loss=0.6870, gradTraining Epoch 1/5:  56%|5| 9/16 [00:05<00:01,  5.34it/s, loss=0.6968, gradTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.04it/s, loss=0.6968, graTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.04it/s, loss=0.6852, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.66it/s, loss=0.6852, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.66it/s, loss=0.7255, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.17it/s, loss=0.7255, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.17it/s, loss=0.6701, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.51it/s, loss=0.6701, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.51it/s, loss=0.7011, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  7.86it/s, loss=0.7011, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  7.86it/s, loss=0.6776, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.21it/s, loss=0.6776, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.21it/s, loss=0.6663, graTraining Epoch 1/5: 100%|#| 16/16 [00:06<00:00,  2.52it/s, loss=0.6663, gra

Epoch 1/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6904, Acc: 0.5079, Precision: 0.5833, Recall: 0.0556, F1: 0.1014, AUC: 0.5614
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.6849, grad_norm=1.Training Epoch 2/5:   6%| | 1/16 [00:03<00:58,  3.92s/it, loss=0.6849, gradTraining Epoch 2/5:   6%| | 1/16 [00:04<00:58,  3.92s/it, loss=0.6826, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:23,  1.68s/it, loss=0.6826, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:23,  1.68s/it, loss=0.6608, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:12,  1.04it/s, loss=0.6608, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:12,  1.04it/s, loss=0.6919, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.60it/s, loss=0.6919, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.60it/s, loss=0.6599, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:04,  2.28it/s, loss=0.6599, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:04,  2.28it/s, loss=0.6526, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  3.06it/s, loss=0.6526, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  3.06it/s, loss=0.6720, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.91it/s, loss=0.6720, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.91it/s, loss=0.6634, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.79it/s, loss=0.6634, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.79it/s, loss=0.6564, gradTraining Epoch 2/5:  56%|5| 9/16 [00:04<00:01,  5.60it/s, loss=0.6564, gradTraining Epoch 2/5:  56%|5| 9/16 [00:04<00:01,  5.60it/s, loss=0.6606, gradTraining Epoch 2/5:  62%|6| 10/16 [00:04<00:00,  6.37it/s, loss=0.6606, graTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.37it/s, loss=0.6809, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  7.03it/s, loss=0.6809, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  7.03it/s, loss=0.6914, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.55it/s, loss=0.6914, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.55it/s, loss=0.6663, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.99it/s, loss=0.6663, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.99it/s, loss=0.6514, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.26it/s, loss=0.6514, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.26it/s, loss=0.6670, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.52it/s, loss=0.6670, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.52it/s, loss=0.6666, graTraining Epoch 2/5: 100%|#| 16/16 [00:06<00:00,  2.62it/s, loss=0.6666, gra

Epoch 2/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.6693, Acc: 0.6508, Precision: 0.7111, Recall: 0.5079, F1: 0.5926, AUC: 0.7381
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.6632, grad_norm=1.Training Epoch 3/5:   6%| | 1/16 [00:03<00:59,  3.99s/it, loss=0.6632, gradTraining Epoch 3/5:   6%| | 1/16 [00:04<00:59,  3.99s/it, loss=0.6385, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.6385, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.6294, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6294, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6425, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.6425, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.6147, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.24it/s, loss=0.6147, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.24it/s, loss=0.6132, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  3.02it/s, loss=0.6132, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  3.02it/s, loss=0.5985, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.86it/s, loss=0.5985, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.86it/s, loss=0.6058, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.6058, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.5918, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.57it/s, loss=0.5918, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.57it/s, loss=0.5603, gradTraining Epoch 3/5:  62%|6| 10/16 [00:04<00:00,  6.33it/s, loss=0.5603, graTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.33it/s, loss=0.6241, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  7.00it/s, loss=0.6241, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  7.00it/s, loss=0.5982, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.49it/s, loss=0.5982, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.49it/s, loss=0.5675, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.90it/s, loss=0.5675, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.90it/s, loss=0.5739, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.24it/s, loss=0.5739, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.24it/s, loss=0.5810, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.50it/s, loss=0.5810, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.50it/s, loss=0.6026, graTraining Epoch 3/5: 100%|#| 16/16 [00:06<00:00,  2.59it/s, loss=0.6026, gra

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6066, Acc: 0.7619, Precision: 0.7037, Recall: 0.9048, F1: 0.7917, AUC: 0.8696
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6164, grad_norm=1.Training Epoch 4/5:   6%| | 1/16 [00:04<01:00,  4.02s/it, loss=0.6164, gradTraining Epoch 4/5:   6%| | 1/16 [00:04<01:00,  4.02s/it, loss=0.5985, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.5985, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.5374, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.5374, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.5319, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.5319, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.5720, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.21it/s, loss=0.5720, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.21it/s, loss=0.5215, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.97it/s, loss=0.5215, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.97it/s, loss=0.5245, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.80it/s, loss=0.5245, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.80it/s, loss=0.6491, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.66it/s, loss=0.6491, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.66it/s, loss=0.5250, gradTraining Epoch 4/5:  56%|5| 9/16 [00:04<00:01,  5.49it/s, loss=0.5250, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.49it/s, loss=0.5738, gradTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.25it/s, loss=0.5738, graTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.25it/s, loss=0.5084, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.89it/s, loss=0.5084, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.89it/s, loss=0.5551, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.27it/s, loss=0.5551, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.27it/s, loss=0.5559, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.73it/s, loss=0.5559, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.73it/s, loss=0.6216, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.08it/s, loss=0.6216, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.08it/s, loss=0.4830, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.34it/s, loss=0.4830, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.34it/s, loss=0.5677, graTraining Epoch 4/5: 100%|#| 16/16 [00:06<00:00,  2.55it/s, loss=0.5677, gra

Epoch 4/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.5589, Acc: 0.7421, Precision: 0.6871, Recall: 0.8889, F1: 0.7751, AUC: 0.8328
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.5199, grad_norm=1.Training Epoch 5/5:   6%| | 1/16 [00:03<00:59,  3.98s/it, loss=0.5199, gradTraining Epoch 5/5:   6%| | 1/16 [00:04<00:59,  3.98s/it, loss=0.4977, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.4977, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:23,  1.71s/it, loss=0.6004, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6004, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.4686, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.58it/s, loss=0.4686, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.58it/s, loss=0.3751, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.25it/s, loss=0.3751, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.25it/s, loss=0.4908, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.02it/s, loss=0.4908, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.02it/s, loss=0.4605, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.87it/s, loss=0.4605, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.87it/s, loss=0.3767, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.3767, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.4567, gradTraining Epoch 5/5:  56%|5| 9/16 [00:04<00:01,  5.56it/s, loss=0.4567, gradTraining Epoch 5/5:  56%|5| 9/16 [00:04<00:01,  5.56it/s, loss=0.3741, gradTraining Epoch 5/5:  62%|6| 10/16 [00:04<00:00,  6.31it/s, loss=0.3741, graTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.31it/s, loss=0.4990, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.91it/s, loss=0.4990, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.91it/s, loss=0.3873, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.41it/s, loss=0.3873, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.41it/s, loss=0.3975, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.95it/s, loss=0.3975, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.95it/s, loss=0.3406, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.23it/s, loss=0.3406, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.23it/s, loss=0.3771, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.46it/s, loss=0.3771, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.46it/s, loss=0.5102, graTraining Epoch 5/5: 100%|#| 16/16 [00:05<00:00,  8.87it/s, loss=0.5102, graTraining Epoch 5/5: 100%|#| 16/16 [00:06<00:00,  2.59it/s, loss=0.5102, gra

Epoch 5/5 Complete (6.6s) [LR: 0.000005]
Train - Loss: 0.4458, Acc: 0.8770, Precision: 0.8146, Recall: 0.9762, F1: 0.8881, AUC: 0.9449
------------------------------------------------------------
Training curves saved to model\chb10_fold5\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb10_fold5
============================================================
✅ Fold 5 training completed successfully!

============================================================
TRAINING FOLD 6/6
============================================================
Using dataset prefix: chb10_fold6
Loading datasets from: preprocessing\data\chb10_fold6
Saving models to: model\chb10_fold6
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.3030, std=2.6500
Loaded train dataset: 258 samples
  - Spectrogram shape: torch.Size([258, 30, 18, 50, 10])
  - Value range: [-4.6427, 3.5093]
  - Class distribution: tensor([129, 129])
LOOCV Mode (Fold 6): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.7087, grad_norm=1.Training Epoch 1/5:   6%| | 1/17 [00:03<01:03,  3.95s/it, loss=0.7087, gradTraining Epoch 1/5:   6%| | 1/17 [00:04<01:03,  3.95s/it, loss=0.6979, gradTraining Epoch 1/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.6979, gradTraining Epoch 1/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.6877, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.6877, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.7142, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.59it/s, loss=0.7142, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.59it/s, loss=0.6974, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.6974, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.6953, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  3.05it/s, loss=0.6953, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  3.05it/s, loss=0.6918, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.90it/s, loss=0.6918, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.90it/s, loss=0.6906, gradTraining Epoch 1/5:  47%|4| 8/17 [00:04<00:01,  4.79it/s, loss=0.6906, gradTraining Epoch 1/5:  47%|4| 8/17 [00:04<00:01,  4.79it/s, loss=0.6773, gradTraining Epoch 1/5:  53%|5| 9/17 [00:04<00:01,  5.65it/s, loss=0.6773, gradTraining Epoch 1/5:  53%|5| 9/17 [00:04<00:01,  5.65it/s, loss=0.6990, gradTraining Epoch 1/5:  59%|5| 10/17 [00:04<00:01,  6.42it/s, loss=0.6990, graTraining Epoch 1/5:  59%|5| 10/17 [00:05<00:01,  6.42it/s, loss=0.6795, graTraining Epoch 1/5:  65%|6| 11/17 [00:05<00:00,  7.09it/s, loss=0.6795, graTraining Epoch 1/5:  65%|6| 11/17 [00:05<00:00,  7.09it/s, loss=0.6851, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.61it/s, loss=0.6851, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.61it/s, loss=0.6790, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  7.99it/s, loss=0.6790, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  7.99it/s, loss=0.6721, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  8.30it/s, loss=0.6721, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  8.30it/s, loss=0.6842, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.57it/s, loss=0.6842, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.57it/s, loss=0.6637, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.76it/s, loss=0.6637, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.76it/s, loss=0.6744, graTraining Epoch 1/5: 100%|#| 17/17 [00:06<00:00,  2.74it/s, loss=0.6744, gra

Epoch 1/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6881, Acc: 0.5775, Precision: 0.5556, Recall: 0.7752, F1: 0.6472, AUC: 0.5721
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.6730, grad_norm=1.Training Epoch 2/5:   6%| | 1/17 [00:03<01:03,  3.95s/it, loss=0.6730, gradTraining Epoch 2/5:   6%| | 1/17 [00:04<01:03,  3.95s/it, loss=0.6544, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.6544, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.6658, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:13,  1.02it/s, loss=0.6658, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:13,  1.02it/s, loss=0.6718, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.6718, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.6611, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.25it/s, loss=0.6611, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.25it/s, loss=0.6468, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  3.04it/s, loss=0.6468, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  3.04it/s, loss=0.6409, gradTraining Epoch 2/5:  41%|4| 7/17 [00:04<00:02,  3.89it/s, loss=0.6409, gradTraining Epoch 2/5:  41%|4| 7/17 [00:04<00:02,  3.89it/s, loss=0.6836, gradTraining Epoch 2/5:  47%|4| 8/17 [00:04<00:01,  4.77it/s, loss=0.6836, gradTraining Epoch 2/5:  47%|4| 8/17 [00:04<00:01,  4.77it/s, loss=0.6466, gradTraining Epoch 2/5:  53%|5| 9/17 [00:04<00:01,  5.62it/s, loss=0.6466, gradTraining Epoch 2/5:  53%|5| 9/17 [00:04<00:01,  5.62it/s, loss=0.6435, gradTraining Epoch 2/5:  59%|5| 10/17 [00:04<00:01,  6.39it/s, loss=0.6435, graTraining Epoch 2/5:  59%|5| 10/17 [00:05<00:01,  6.39it/s, loss=0.6398, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  7.08it/s, loss=0.6398, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  7.08it/s, loss=0.6226, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  7.64it/s, loss=0.6226, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  7.64it/s, loss=0.6728, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  8.07it/s, loss=0.6728, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  8.07it/s, loss=0.6429, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  8.36it/s, loss=0.6429, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  8.36it/s, loss=0.6174, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  8.56it/s, loss=0.6174, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  8.56it/s, loss=0.6207, graTraining Epoch 2/5:  94%|9| 16/17 [00:05<00:00,  8.76it/s, loss=0.6207, graTraining Epoch 2/5:  94%|9| 16/17 [00:05<00:00,  8.76it/s, loss=0.6474, graTraining Epoch 2/5: 100%|#| 17/17 [00:06<00:00,  2.74it/s, loss=0.6474, gra

Epoch 2/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6501, Acc: 0.7752, Precision: 0.7415, Recall: 0.8450, F1: 0.7899, AUC: 0.8179
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.6310, grad_norm=1.Training Epoch 3/5:   6%| | 1/17 [00:03<01:03,  3.95s/it, loss=0.6310, gradTraining Epoch 3/5:   6%| | 1/17 [00:04<01:03,  3.95s/it, loss=0.5681, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.5681, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.6209, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.6209, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.5821, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.5821, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.5772, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.5772, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.5847, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  3.03it/s, loss=0.5847, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  3.03it/s, loss=0.5929, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.87it/s, loss=0.5929, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.87it/s, loss=0.6952, gradTraining Epoch 3/5:  47%|4| 8/17 [00:04<00:01,  4.74it/s, loss=0.6952, gradTraining Epoch 3/5:  47%|4| 8/17 [00:04<00:01,  4.74it/s, loss=0.5538, gradTraining Epoch 3/5:  53%|5| 9/17 [00:04<00:01,  5.57it/s, loss=0.5538, gradTraining Epoch 3/5:  53%|5| 9/17 [00:04<00:01,  5.57it/s, loss=0.6551, gradTraining Epoch 3/5:  59%|5| 10/17 [00:04<00:01,  6.32it/s, loss=0.6551, graTraining Epoch 3/5:  59%|5| 10/17 [00:05<00:01,  6.32it/s, loss=0.4804, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  7.01it/s, loss=0.4804, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  7.01it/s, loss=0.5441, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  7.48it/s, loss=0.5441, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  7.48it/s, loss=0.5363, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  7.96it/s, loss=0.5363, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  7.96it/s, loss=0.5242, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  8.26it/s, loss=0.5242, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  8.26it/s, loss=0.5471, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  8.53it/s, loss=0.5471, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  8.53it/s, loss=0.5339, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.67it/s, loss=0.5339, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.67it/s, loss=0.7863, graTraining Epoch 3/5: 100%|#| 17/17 [00:06<00:00,  2.74it/s, loss=0.7863, gra

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5890, Acc: 0.7713, Precision: 0.7303, Recall: 0.8605, F1: 0.7900, AUC: 0.8703
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.4202, grad_norm=1.Training Epoch 4/5:   6%| | 1/17 [00:03<01:03,  3.94s/it, loss=0.4202, gradTraining Epoch 4/5:   6%| | 1/17 [00:04<01:03,  3.94s/it, loss=0.5105, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.5105, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:25,  1.69s/it, loss=0.4912, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.4912, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.4081, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.59it/s, loss=0.4081, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.59it/s, loss=0.5282, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.5282, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.26it/s, loss=0.4381, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  3.02it/s, loss=0.4381, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  3.02it/s, loss=0.5805, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.87it/s, loss=0.5805, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.87it/s, loss=0.6751, gradTraining Epoch 4/5:  47%|4| 8/17 [00:04<00:01,  4.74it/s, loss=0.6751, gradTraining Epoch 4/5:  47%|4| 8/17 [00:04<00:01,  4.74it/s, loss=0.4367, gradTraining Epoch 4/5:  53%|5| 9/17 [00:04<00:01,  5.57it/s, loss=0.4367, gradTraining Epoch 4/5:  53%|5| 9/17 [00:04<00:01,  5.57it/s, loss=0.6071, gradTraining Epoch 4/5:  59%|5| 10/17 [00:04<00:01,  6.33it/s, loss=0.6071, graTraining Epoch 4/5:  59%|5| 10/17 [00:05<00:01,  6.33it/s, loss=0.5792, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  6.99it/s, loss=0.5792, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  6.99it/s, loss=0.4358, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  7.52it/s, loss=0.4358, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  7.52it/s, loss=0.4904, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.92it/s, loss=0.4904, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.92it/s, loss=0.5418, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  8.21it/s, loss=0.5418, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  8.21it/s, loss=0.4439, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  8.44it/s, loss=0.4439, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  8.44it/s, loss=0.4284, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.56it/s, loss=0.4284, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.56it/s, loss=1.0175, graTraining Epoch 4/5: 100%|#| 17/17 [00:06<00:00,  2.74it/s, loss=1.0175, gra

Epoch 4/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5313, Acc: 0.8178, Precision: 0.7562, Recall: 0.9380, F1: 0.8374, AUC: 0.8633
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/17 [00:03<?, ?it/s, loss=0.3879, grad_norm=1.Training Epoch 5/5:   6%| | 1/17 [00:03<01:03,  3.96s/it, loss=0.3879, gradTraining Epoch 5/5:   6%| | 1/17 [00:04<01:03,  3.96s/it, loss=0.3721, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:25,  1.70s/it, loss=0.3721, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:25,  1.70s/it, loss=0.5474, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.5474, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:13,  1.03it/s, loss=0.4872, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.4872, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.58it/s, loss=0.4645, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.25it/s, loss=0.4645, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.25it/s, loss=0.2836, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  3.03it/s, loss=0.2836, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  3.03it/s, loss=0.4734, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.87it/s, loss=0.4734, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.87it/s, loss=0.4209, gradTraining Epoch 5/5:  47%|4| 8/17 [00:04<00:01,  4.74it/s, loss=0.4209, gradTraining Epoch 5/5:  47%|4| 8/17 [00:04<00:01,  4.74it/s, loss=0.3840, gradTraining Epoch 5/5:  53%|5| 9/17 [00:04<00:01,  5.54it/s, loss=0.3840, gradTraining Epoch 5/5:  53%|5| 9/17 [00:04<00:01,  5.54it/s, loss=0.6423, gradTraining Epoch 5/5:  59%|5| 10/17 [00:04<00:01,  6.28it/s, loss=0.6423, graTraining Epoch 5/5:  59%|5| 10/17 [00:05<00:01,  6.28it/s, loss=0.4015, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.96it/s, loss=0.4015, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.96it/s, loss=0.3315, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.53it/s, loss=0.3315, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.53it/s, loss=0.3913, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.97it/s, loss=0.3913, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.97it/s, loss=0.3554, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.16it/s, loss=0.3554, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.16it/s, loss=0.3225, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.26it/s, loss=0.3225, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.26it/s, loss=0.3142, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.34it/s, loss=0.3142, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.34it/s, loss=0.6865, graTraining Epoch 5/5: 100%|#| 17/17 [00:06<00:00,  2.70it/s, loss=0.6865, gra

Epoch 5/5 Complete (6.7s) [LR: 0.000005]
Train - Loss: 0.4274, Acc: 0.8566, Precision: 0.8067, Recall: 0.9380, F1: 0.8674, AUC: 0.9407
------------------------------------------------------------
Training curves saved to model\chb10_fold6\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb10_fold6
============================================================
✅ Fold 6 training completed successfully!

============================================================
✅ BATCH TRAINING COMPLETED!
✅ Trained models for 7 folds for patient chb10
============================================================
============================================================
============================================================
BATCH EVALUATION: ALL FOLDS
BATCH EVALUATION: ALL FOLDS
Evaluating 7 folds for patient chb10
Evaluating 7 folds for patient chb10
============================================================
============================================================
Using CUDA: NVIDIA GeForce RTX 3090 Ti
Using CUDA: NVIDIA GeForce RTX 3090 Ti

============================================================
============================================================

EVALUATING FOLD 0/6
EVALUATING FOLD 0/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb10_fold0
Dataset prefix: chb10_fold0
Using test dataset: preprocessing\data\chb10_fold0\test_dataset.h5
Using test dataset: preprocessing\data\chb10_fold0\test_dataset.h5
Loading test dataset from preprocessing\data\chb10_fold0\test_dataset.h5...
Loading test dataset from preprocessing\data\chb10_fold0\test_dataset.h5...
  - Normalization: z-score, mean=0.3268, std=2.6585
  - Normalization: z-score, mean=0.3268, std=2.6585
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-4.6368, 3.5346]
  - Value range: [-4.6368, 3.5346]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb10_fold0\epoch_005.pth...
Loading model checkpoint from model\chb10_fold0\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:  33%|##########3                    | 1/3 [00:00<00:00,  4.32it/s]Testing:  33%|##########3                    | 1/3 [00:00<00:00,  4.32it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 10.16it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 10.16it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      1.6165
Loss:      1.6165
Accuracy:  0.3158 (31.58%)
Accuracy:  0.3158 (31.58%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.0360
AUC-ROC:   0.0360

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        12         7
Actual Interictal        12         7
       Preictal        19         0
       Preictal        19         0

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 31 samples
Pred Interictal (0): 31 samples
Pred Preictal (1):   7 samples
Pred Preictal (1):   7 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.3871    0.6316    0.4800        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.3158        38
   macro avg     0.1935    0.3158    0.2400        38
weighted avg     0.1935    0.3158    0.2400        38
              precision    recall  f1-score   support

  Interictal     0.3871    0.6316    0.4800        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.3158        38
   macro avg     0.1935    0.3158    0.2400        38
weighted avg     0.1935    0.3158    0.2400        38



✅ Results saved to model\chb10_fold0\test_results.json
✅ Results saved to model\chb10_fold0\test_results.json


============================================================
============================================================

EVALUATING FOLD 1/6
EVALUATING FOLD 1/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb10_fold1
Dataset prefix: chb10_fold1
Using test dataset: preprocessing\data\chb10_fold1\test_dataset.h5
Using test dataset: preprocessing\data\chb10_fold1\test_dataset.h5
Loading test dataset from preprocessing\data\chb10_fold1\test_dataset.h5...
Loading test dataset from preprocessing\data\chb10_fold1\test_dataset.h5...
  - Normalization: z-score, mean=0.2581, std=2.6662
  - Normalization: z-score, mean=0.2581, std=2.6662
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-4.5976, 3.5055]
  - Value range: [-4.5976, 3.5055]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb10_fold1\epoch_005.pth...
Loading model checkpoint from model\chb10_fold1\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.72it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.72it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.64it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.64it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.5698
Loss:      0.5698
Accuracy:  0.6667 (66.67%)
Accuracy:  0.6667 (66.67%)
Precision: 0.6250
Precision: 0.6250
Recall:    0.8333
Recall:    0.8333
F1 Score:  0.7143
F1 Score:  0.7143
AUC-ROC:   0.6736
AUC-ROC:   0.6736

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        12        12
Actual Interictal        12        12
       Preictal         4        20
       Preictal         4        20

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 16 samples
Pred Interictal (0): 16 samples
Pred Preictal (1):   32 samples
Pred Preictal (1):   32 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.7500    0.5000    0.6000        24
    Preictal     0.6250    0.8333    0.7143        24

    accuracy                         0.6667        48
   macro avg     0.6875    0.6667    0.6571        48
weighted avg     0.6875    0.6667    0.6571        48
              precision    recall  f1-score   support

  Interictal     0.7500    0.5000    0.6000        24
    Preictal     0.6250    0.8333    0.7143        24

    accuracy                         0.6667        48
   macro avg     0.6875    0.6667    0.6571        48
weighted avg     0.6875    0.6667    0.6571        48



✅ Results saved to model\chb10_fold1\test_results.json
✅ Results saved to model\chb10_fold1\test_results.json


============================================================
============================================================

EVALUATING FOLD 2/6
EVALUATING FOLD 2/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb10_fold2
Dataset prefix: chb10_fold2
Using test dataset: preprocessing\data\chb10_fold2\test_dataset.h5
Using test dataset: preprocessing\data\chb10_fold2\test_dataset.h5
Loading test dataset from preprocessing\data\chb10_fold2\test_dataset.h5...
Loading test dataset from preprocessing\data\chb10_fold2\test_dataset.h5...
  - Normalization: z-score, mean=0.3637, std=2.6628
  - Normalization: z-score, mean=0.3637, std=2.6628
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-4.6431, 3.3603]
  - Value range: [-4.6431, 3.3603]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb10_fold2\epoch_005.pth...
Loading model checkpoint from model\chb10_fold2\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.38it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.38it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.30it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.30it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.5660
Loss:      0.5660
Accuracy:  0.6042 (60.42%)
Accuracy:  0.6042 (60.42%)
Precision: 0.7778
Precision: 0.7778
Recall:    0.2917
Recall:    0.2917
F1 Score:  0.4242
F1 Score:  0.4242
AUC-ROC:   0.8524
AUC-ROC:   0.8524

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        22         2
Actual Interictal        22         2
       Preictal        17         7
       Preictal        17         7

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 39 samples
Pred Interictal (0): 39 samples
Pred Preictal (1):   9 samples
Pred Preictal (1):   9 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5641    0.9167    0.6984        24
    Preictal     0.7778    0.2917    0.4242        24

    accuracy                         0.6042        48
   macro avg     0.6709    0.6042    0.5613        48
weighted avg     0.6709    0.6042    0.5613        48
              precision    recall  f1-score   support

  Interictal     0.5641    0.9167    0.6984        24
    Preictal     0.7778    0.2917    0.4242        24

    accuracy                         0.6042        48
   macro avg     0.6709    0.6042    0.5613        48
weighted avg     0.6709    0.6042    0.5613        48



✅ Results saved to model\chb10_fold2\test_results.json
✅ Results saved to model\chb10_fold2\test_results.json


============================================================
============================================================

EVALUATING FOLD 3/6
EVALUATING FOLD 3/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb10_fold3
Dataset prefix: chb10_fold3
Using test dataset: preprocessing\data\chb10_fold3\test_dataset.h5
Using test dataset: preprocessing\data\chb10_fold3\test_dataset.h5
Loading test dataset from preprocessing\data\chb10_fold3\test_dataset.h5...
Loading test dataset from preprocessing\data\chb10_fold3\test_dataset.h5...
  - Normalization: z-score, mean=0.3689, std=2.6432
  - Normalization: z-score, mean=0.3689, std=2.6432
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-4.6794, 3.5073]
  - Value range: [-4.6794, 3.5073]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb10_fold3\epoch_005.pth...
Loading model checkpoint from model\chb10_fold3\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 36.41it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 36.41it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.9253
Loss:      0.9253
Accuracy:  0.4211 (42.11%)
Accuracy:  0.4211 (42.11%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.5623
AUC-ROC:   0.5623

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        16         3
Actual Interictal        16         3
       Preictal        19         0
       Preictal        19         0

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 35 samples
Pred Interictal (0): 35 samples
Pred Preictal (1):   3 samples
Pred Preictal (1):   3 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4571    0.8421    0.5926        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.4211        38
   macro avg     0.2286    0.4211    0.2963        38
weighted avg     0.2286    0.4211    0.2963        38
              precision    recall  f1-score   support

  Interictal     0.4571    0.8421    0.5926        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.4211        38
   macro avg     0.2286    0.4211    0.2963        38
weighted avg     0.2286    0.4211    0.2963        38



✅ Results saved to model\chb10_fold3\test_results.json
✅ Results saved to model\chb10_fold3\test_results.json


============================================================
============================================================

EVALUATING FOLD 4/6
EVALUATING FOLD 4/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb10_fold4
Dataset prefix: chb10_fold4
Using test dataset: preprocessing\data\chb10_fold4\test_dataset.h5
Using test dataset: preprocessing\data\chb10_fold4\test_dataset.h5
Loading test dataset from preprocessing\data\chb10_fold4\test_dataset.h5...
Loading test dataset from preprocessing\data\chb10_fold4\test_dataset.h5...
  - Normalization: z-score, mean=0.3086, std=2.6616
  - Normalization: z-score, mean=0.3086, std=2.6616
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-4.6245, 3.3761]
  - Value range: [-4.6245, 3.3761]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb10_fold4\epoch_005.pth...
Loading model checkpoint from model\chb10_fold4\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.72it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.72it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.3459
Loss:      0.3459
Accuracy:  0.9500 (95.00%)
Accuracy:  0.9500 (95.00%)
Precision: 0.9091
Precision: 0.9091
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9524
F1 Score:  0.9524
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        18         2
Actual Interictal        18         2
       Preictal         0        20
       Preictal         0        20

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 18 samples
Pred Interictal (0): 18 samples
Pred Preictal (1):   22 samples
Pred Preictal (1):   22 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9000    0.9474        20
    Preictal     0.9091    1.0000    0.9524        20

    accuracy                         0.9500        40
   macro avg     0.9545    0.9500    0.9499        40
weighted avg     0.9545    0.9500    0.9499        40
              precision    recall  f1-score   support

  Interictal     1.0000    0.9000    0.9474        20
    Preictal     0.9091    1.0000    0.9524        20

    accuracy                         0.9500        40
   macro avg     0.9545    0.9500    0.9499        40
weighted avg     0.9545    0.9500    0.9499        40



✅ Results saved to model\chb10_fold4\test_results.json
✅ Results saved to model\chb10_fold4\test_results.json


============================================================
============================================================

EVALUATING FOLD 5/6
EVALUATING FOLD 5/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb10_fold5
Dataset prefix: chb10_fold5
Using test dataset: preprocessing\data\chb10_fold5\test_dataset.h5
Using test dataset: preprocessing\data\chb10_fold5\test_dataset.h5
Loading test dataset from preprocessing\data\chb10_fold5\test_dataset.h5...
Loading test dataset from preprocessing\data\chb10_fold5\test_dataset.h5...
  - Normalization: z-score, mean=0.2188, std=2.6438
  - Normalization: z-score, mean=0.2188, std=2.6438
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-4.6217, 3.4249]
  - Value range: [-4.6217, 3.4249]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb10_fold5\epoch_005.pth...
Loading model checkpoint from model\chb10_fold5\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.81it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.81it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.73it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.73it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.4302
Loss:      0.4302
Accuracy:  0.7826 (78.26%)
Accuracy:  0.7826 (78.26%)
Precision: 0.6970
Precision: 0.6970
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.8214
F1 Score:  0.8214
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        13        10
Actual Interictal        13        10
       Preictal         0        23
       Preictal         0        23

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 13 samples
Pred Interictal (0): 13 samples
Pred Preictal (1):   33 samples
Pred Preictal (1):   33 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.5652    0.7222        23
    Preictal     0.6970    1.0000    0.8214        23

    accuracy                         0.7826        46
   macro avg     0.8485    0.7826    0.7718        46
weighted avg     0.8485    0.7826    0.7718        46
              precision    recall  f1-score   support

  Interictal     1.0000    0.5652    0.7222        23
    Preictal     0.6970    1.0000    0.8214        23

    accuracy                         0.7826        46
   macro avg     0.8485    0.7826    0.7718        46
weighted avg     0.8485    0.7826    0.7718        46



✅ Results saved to model\chb10_fold5\test_results.json
✅ Results saved to model\chb10_fold5\test_results.json


============================================================
============================================================

EVALUATING FOLD 6/6
EVALUATING FOLD 6/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb10_fold6
Dataset prefix: chb10_fold6
Using test dataset: preprocessing\data\chb10_fold6\test_dataset.h5
Using test dataset: preprocessing\data\chb10_fold6\test_dataset.h5
Loading test dataset from preprocessing\data\chb10_fold6\test_dataset.h5...
Loading test dataset from preprocessing\data\chb10_fold6\test_dataset.h5...
  - Normalization: z-score, mean=0.3030, std=2.6500
  - Normalization: z-score, mean=0.3030, std=2.6500
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-4.6427, 3.4990]
  - Value range: [-4.6427, 3.4990]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb10_fold6\epoch_005.pth...
Loading model checkpoint from model\chb10_fold6\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 33.99it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 33.99it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.5444
Loss:      0.5444
Accuracy:  0.7500 (75.00%)
Accuracy:  0.7500 (75.00%)
Precision: 0.7778
Precision: 0.7778
Recall:    0.7000
Recall:    0.7000
F1 Score:  0.7368
F1 Score:  0.7368
AUC-ROC:   0.7900
AUC-ROC:   0.7900

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        16         4
Actual Interictal        16         4
       Preictal         6        14
       Preictal         6        14

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 22 samples
Pred Interictal (0): 22 samples
Pred Preictal (1):   18 samples
Pred Preictal (1):   18 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.7273    0.8000    0.7619        20
    Preictal     0.7778    0.7000    0.7368        20

    accuracy                         0.7500        40
   macro avg     0.7525    0.7500    0.7494        40
weighted avg     0.7525    0.7500    0.7494        40
              precision    recall  f1-score   support

  Interictal     0.7273    0.8000    0.7619        20
    Preictal     0.7778    0.7000    0.7368        20

    accuracy                         0.7500        40
   macro avg     0.7525    0.7500    0.7494        40
weighted avg     0.7525    0.7500    0.7494        40



✅ Results saved to model\chb10_fold6\test_results.json
✅ Results saved to model\chb10_fold6\test_results.json


============================================================
============================================================

BATCH EVALUATION SUMMARY
BATCH EVALUATION SUMMARY
============================================================
============================================================
Folds evaluated: 7/7
Folds evaluated: 7/7

Mean metrics (across folds):
Mean metrics (across folds):

  Accuracy:  0.6415 (±0.2013)
  Accuracy:  0.6415 (±0.2013)
  Precision: 0.5409 (±0.3514)
  Precision: 0.5409 (±0.3514)
  Recall:    0.5464 (±0.4105)
  Recall:    0.5464 (±0.4105)
  F1 Score:  0.5213 (±0.3611)
  F1 Score:  0.5213 (±0.3611)
  AUC-ROC:   0.7021 (±0.3098)
  AUC-ROC:   0.7021 (±0.3098)

✅ Batch results saved to model\batch_test_results.json
✅ Batch results saved to model\batch_test_results.json

============================================================
============================================================
