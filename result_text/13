============================================================
BATCH PROCESSING: ALL FOLDS
Processing 12 folds for patient chb13
============================================================

Configuration:
  - Task mode: PREDICTION (preictal vs interictal)
  - LOOCV Mode: ENABLED
  - Sequence length: 30 segments
  - Sequence duration: 150s (2.5 min)
  - Stride: 5 segments (83% overlap)
  - Segment duration: 5s
  - Preictal window: 10 min
  - Interictal buffer: 120 min
  - Channel validation: ENABLED
  - Target channels: 18 channels
============================================================

Extracting sequences from patient chb13...
Patient chb13: 690 sequences (236 preictal, 454 interictal)

============================================================
PROCESSING FOLD 0/11
============================================================
Output prefix: chb13_fold0
LOOCV Fold 0: Test seizure=0, Train seizures=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 424 total (212 preictal, 212 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 212 preictal, 212 interictal (dropped 0 preictal, 15 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 203 interictal)

Sequences saved to chb13_fold0_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 0 completed successfully!
✅ Sequences saved to chb13_fold0_sequences_prediction.json

============================================================
PROCESSING FOLD 1/11
============================================================
Output prefix: chb13_fold1
LOOCV Fold 1: Test seizure=1, Train seizures=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 432 total (216 preictal, 216 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 216 preictal, 216 interictal (dropped 0 preictal, 11 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 207 interictal)

Sequences saved to chb13_fold1_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 1 completed successfully!
✅ Sequences saved to chb13_fold1_sequences_prediction.json

============================================================
PROCESSING FOLD 2/11
============================================================
Output prefix: chb13_fold2
LOOCV Fold 2: Test seizure=2, Train seizures=[0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 36 total (18 preictal, 18 interictal)
train: 436 total (218 preictal, 218 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 218 preictal, 218 interictal (dropped 0 preictal, 9 interictal)
test: 18 preictal, 18 interictal (dropped 0 preictal, 209 interictal)

Sequences saved to chb13_fold2_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 2 completed successfully!
✅ Sequences saved to chb13_fold2_sequences_prediction.json

============================================================
PROCESSING FOLD 3/11
============================================================
Output prefix: chb13_fold3
LOOCV Fold 3: Test seizure=3, Train seizures=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 32 total (16 preictal, 16 interictal)
train: 440 total (220 preictal, 220 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 220 preictal, 220 interictal (dropped 0 preictal, 7 interictal)
test: 16 preictal, 16 interictal (dropped 0 preictal, 211 interictal)

Sequences saved to chb13_fold3_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 3 completed successfully!
✅ Sequences saved to chb13_fold3_sequences_prediction.json

============================================================
PROCESSING FOLD 4/11
============================================================
Output prefix: chb13_fold4
LOOCV Fold 4: Test seizure=4, Train seizures=[0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 26 total (13 preictal, 13 interictal)
train: 446 total (223 preictal, 223 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 223 preictal, 223 interictal (dropped 0 preictal, 4 interictal)
test: 13 preictal, 13 interictal (dropped 0 preictal, 214 interictal)

Sequences saved to chb13_fold4_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 4 completed successfully!
✅ Sequences saved to chb13_fold4_sequences_prediction.json

============================================================
PROCESSING FOLD 5/11
============================================================
Output prefix: chb13_fold5
LOOCV Fold 5: Test seizure=5, Train seizures=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 434 total (217 preictal, 217 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 217 preictal, 217 interictal (dropped 0 preictal, 10 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 208 interictal)

Sequences saved to chb13_fold5_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 5 completed successfully!
✅ Sequences saved to chb13_fold5_sequences_prediction.json

============================================================
PROCESSING FOLD 6/11
============================================================
Output prefix: chb13_fold6
LOOCV Fold 6: Test seizure=6, Train seizures=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 430 total (215 preictal, 215 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 215 preictal, 215 interictal (dropped 0 preictal, 12 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 206 interictal)

Sequences saved to chb13_fold6_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 6 completed successfully!
✅ Sequences saved to chb13_fold6_sequences_prediction.json

============================================================
PROCESSING FOLD 7/11
============================================================
Output prefix: chb13_fold7
LOOCV Fold 7: Test seizure=7, Train seizures=[0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 432 total (216 preictal, 216 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 216 preictal, 216 interictal (dropped 0 preictal, 11 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 207 interictal)

Sequences saved to chb13_fold7_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 7 completed successfully!
✅ Sequences saved to chb13_fold7_sequences_prediction.json

============================================================
PROCESSING FOLD 8/11
============================================================
Output prefix: chb13_fold8
LOOCV Fold 8: Test seizure=8, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 432 total (216 preictal, 216 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 216 preictal, 216 interictal (dropped 0 preictal, 11 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 207 interictal)

Sequences saved to chb13_fold8_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 8 completed successfully!
✅ Sequences saved to chb13_fold8_sequences_prediction.json

============================================================
PROCESSING FOLD 9/11
============================================================
Output prefix: chb13_fold9
LOOCV Fold 9: Test seizure=9, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 428 total (214 preictal, 214 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 214 preictal, 214 interictal (dropped 0 preictal, 13 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 205 interictal)

Sequences saved to chb13_fold9_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 9 completed successfully!
✅ Sequences saved to chb13_fold9_sequences_prediction.json

============================================================
PROCESSING FOLD 10/11
============================================================
Output prefix: chb13_fold10
LOOCV Fold 10: Test seizure=10, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 434 total (217 preictal, 217 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 217 preictal, 217 interictal (dropped 0 preictal, 10 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 208 interictal)

Sequences saved to chb13_fold10_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 10 completed successfully!
✅ Sequences saved to chb13_fold10_sequences_prediction.json

============================================================
PROCESSING FOLD 11/11
============================================================
Output prefix: chb13_fold11
LOOCV Fold 11: Test seizure=11, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 472
  - Preictal sequences: 236
  - Interictal sequences: 236
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb13: 472 total (236 preictal, 236 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 424 total (212 preictal, 212 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.2s (4.3 min)
Class balance: 236/236 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 212 preictal, 212 interictal (dropped 0 preictal, 15 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 203 interictal)

Sequences saved to chb13_fold11_sequences_prediction.json
File size: 0.79 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 33
Files with valid channels: 33
Files with invalid channels: 0

✅ Fold 11 completed successfully!
✅ Sequences saved to chb13_fold11_sequences_prediction.json

============================================================
✅ BATCH PROCESSING COMPLETED!
✅ Processed 12 folds for patient chb13
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 12 folds for patient chb13
============================================================

============================================================
PREPROCESSING FOLD 0/11
============================================================
2025-11-19 19:17:40,421 - INFO - ============================================================
2025-11-19 19:17:40,421 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:17:40,421 - INFO - ============================================================
2025-11-19 19:17:40,422 - INFO - Output prefix: chb13_fold0
2025-11-19 19:17:40,422 - INFO - EEG Preprocessor initialized
2025-11-19 19:17:40,422 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:17:40,422 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:17:40,422 - INFO - Segment duration: 5 seconds
2025-11-19 19:17:40,422 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:17:40,422 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:17:40,422 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:17:40,422 - INFO - Loading segments from chb13_fold0_sequences_prediction.json
2025-11-19 19:17:40,437 - INFO - Loaded 472 total sequences
2025-11-19 19:17:40,437 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:17:40,437 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:17:40,437 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:17:40,438 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:17:40,438 - INFO - train: 424 sequences (212 preictal, 212 interictal)
2025-11-19 19:17:40,438 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-19 19:17:40,462 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:17:40,462 - INFO - train: kept 212 preictal and 212 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:17:40,462 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:17:40,485 - INFO - ============================================================
2025-11-19 19:17:40,486 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:17:40,486 - INFO - ============================================================
2025-11-19 19:17:40,486 - INFO - Processing 424 training samples to compute normalization stats...
2025-11-19 19:17:40,486 - INFO - Processing 424 sequences from 29 unique files
Processing training data:   0%|                                                                                                                                                                                                                                           | 0/424 [00:00<?, ?it/s]Processing training data:   0%|5                                                                                                                                                                                                                                  | 1/424 [00:02<19:36,  2.78s/it]Processing training data:   3%|######9                                                                                                                                                                                                                           | 13/424 [00:04<01:50,  3.70it/s]Processing training data:   5%|############2                                                                                                                                                                                                                     | 23/424 [00:04<01:01,  6.50it/s]Processing training data:  10%|######################9                                                                                                                                                                                                           | 43/424 [00:05<00:36, 10.55it/s]Processing training data:  12%|###########################7                                                                                                                                                                                                      | 52/424 [00:07<00:39,  9.42it/s]Processing training data:  20%|############################################7                                                                                                                                                                                     | 84/424 [00:07<00:17, 19.25it/s]Processing training data:  24%|#####################################################                                                                                                                                                                            | 100/424 [00:09<00:20, 15.59it/s]Processing training data:  26%|##########################################################3                                                                                                                                                                      | 110/424 [00:10<00:25, 12.55it/s]Processing training data:  28%|###############################################################1                                                                                                                                                                 | 119/424 [00:11<00:28, 10.74it/s]Processing training data:  43%|#################################################################################################6                                                                                                                               | 184/424 [00:12<00:08, 28.80it/s]Processing training data:  48%|############################################################################################################2                                                                                                                    | 204/424 [00:13<00:08, 26.47it/s]Processing training data:  50%|################################################################################################################5                                                                                                                | 212/424 [00:14<00:11, 18.33it/s]Processing training data:  53%|#######################################################################################################################9                                                                                                         | 226/424 [00:16<00:13, 15.02it/s]Processing training data:  58%|#################################################################################################################################4                                                                                               | 244/424 [00:16<00:09, 18.29it/s]Processing training data:  62%|###########################################################################################################################################                                                                                      | 262/424 [00:18<00:10, 15.75it/s]Processing training data:  64%|################################################################################################################################################8                                                                                | 273/424 [00:18<00:09, 16.43it/s]Processing training data:  69%|############################################################################################################################################################                                                                     | 294/424 [00:20<00:08, 15.91it/s]Processing training data:  72%|#################################################################################################################################################################3                                                               | 304/424 [00:21<00:09, 12.03it/s]Processing training data:  74%|######################################################################################################################################################################6                                                          | 314/424 [00:23<00:10, 10.39it/s]Processing training data:  77%|############################################################################################################################################################################9                                                    | 326/424 [00:24<00:09, 10.01it/s]Processing training data:  79%|##################################################################################################################################################################################3                                              | 336/424 [00:26<00:10,  8.61it/s]Processing training data:  82%|########################################################################################################################################################################################1                                        | 347/424 [00:27<00:09,  7.77it/s]Processing training data:  85%|##############################################################################################################################################################################################5                                  | 359/424 [00:28<00:06,  9.43it/s]Processing training data:  89%|#########################################################################################################################################################################################################1                       | 379/424 [00:30<00:04, 10.20it/s]Processing training data:  92%|##############################################################################################################################################################################################################9                  | 390/424 [00:32<00:03,  8.94it/s]Processing training data:  94%|####################################################################################################################################################################################################################2            | 400/424 [00:33<00:02,  8.69it/s]Processing training data:  96%|#########################################################################################################################################################################################################################        | 409/424 [00:35<00:02,  7.36it/s]Processing training data:  99%|#############################################################################################################################################################################################################################8   | 418/424 [00:36<00:00,  6.93it/s]Processing training data: 100%|#################################################################################################################################################################################################################################| 424/424 [00:36<00:00,  7.83it/s]Processing training data: 100%|#################################################################################################################################################################################################################################| 424/424 [00:36<00:00, 11.47it/s]
2025-11-19 19:18:17,440 - INFO - Computing normalization statistics from training data...
2025-11-19 19:18:18,262 - INFO - Normalization stats computed:
2025-11-19 19:18:18,262 - INFO -   Mean: 0.291228
2025-11-19 19:18:18,262 - INFO -   Std: 2.463941
2025-11-19 19:18:18,262 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold0\normalization_stats.json
2025-11-19 19:18:18,331 - INFO - Applying normalization and saving 424 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                                               | 0/424 [00:00<?, ?it/s]2025-11-19 19:18:18,338 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold0\train_dataset.h5
Normalizing and saving training data:   2%|#####                                                                                                                                                                                                                 | 10/424 [00:00<00:28, 14.46it/s]Normalizing and saving training data:   5%|##########                                                                                                                                                                                                            | 20/424 [00:01<00:28, 14.33it/s]Normalizing and saving training data:   7%|###############1                                                                                                                                                                                                      | 30/424 [00:02<00:27, 14.43it/s]Normalizing and saving training data:   9%|####################1                                                                                                                                                                                                 | 40/424 [00:02<00:26, 14.52it/s]Normalizing and saving training data:  12%|#########################2                                                                                                                                                                                            | 50/424 [00:03<00:25, 14.81it/s]Normalizing and saving training data:  14%|##############################2                                                                                                                                                                                       | 60/424 [00:04<00:25, 14.53it/s]Normalizing and saving training data:  17%|###################################3                                                                                                                                                                                  | 70/424 [00:04<00:25, 13.78it/s]Normalizing and saving training data:  19%|########################################3                                                                                                                                                                             | 80/424 [00:05<00:24, 14.24it/s]Normalizing and saving training data:  21%|#############################################4                                                                                                                                                                        | 90/424 [00:06<00:23, 14.52it/s]Normalizing and saving training data:  24%|##################################################2                                                                                                                                                                  | 100/424 [00:06<00:22, 14.67it/s]Normalizing and saving training data:  26%|#######################################################2                                                                                                                                                             | 110/424 [00:07<00:21, 14.79it/s]Normalizing and saving training data:  28%|############################################################2                                                                                                                                                        | 120/424 [00:08<00:20, 14.99it/s]Normalizing and saving training data:  31%|#################################################################3                                                                                                                                                   | 130/424 [00:08<00:19, 15.03it/s]Normalizing and saving training data:  33%|######################################################################3                                                                                                                                              | 140/424 [00:09<00:18, 15.07it/s]Normalizing and saving training data:  35%|###########################################################################3                                                                                                                                         | 150/424 [00:10<00:18, 15.04it/s]Normalizing and saving training data:  38%|################################################################################3                                                                                                                                    | 160/424 [00:10<00:17, 14.97it/s]Normalizing and saving training data:  40%|#####################################################################################4                                                                                                                               | 170/424 [00:11<00:17, 14.87it/s]Normalizing and saving training data:  42%|##########################################################################################4                                                                                                                          | 180/424 [00:12<00:17, 13.95it/s]Normalizing and saving training data:  45%|###############################################################################################4                                                                                                                     | 190/424 [00:13<00:16, 14.03it/s]Normalizing and saving training data:  47%|####################################################################################################4                                                                                                                | 200/424 [00:13<00:15, 14.36it/s]Normalizing and saving training data:  50%|#########################################################################################################4                                                                                                           | 210/424 [00:14<00:14, 14.57it/s]Normalizing and saving training data:  52%|##############################################################################################################5                                                                                                      | 220/424 [00:15<00:13, 14.67it/s]Normalizing and saving training data:  54%|###################################################################################################################5                                                                                                 | 230/424 [00:15<00:13, 14.77it/s]Normalizing and saving training data:  57%|########################################################################################################################5                                                                                            | 240/424 [00:16<00:12, 14.72it/s]Normalizing and saving training data:  59%|#############################################################################################################################5                                                                                       | 250/424 [00:17<00:11, 14.61it/s]Normalizing and saving training data:  61%|##################################################################################################################################6                                                                                  | 260/424 [00:17<00:11, 14.64it/s]Normalizing and saving training data:  64%|#######################################################################################################################################6                                                                             | 270/424 [00:18<00:10, 14.78it/s]Normalizing and saving training data:  66%|############################################################################################################################################6                                                                        | 280/424 [00:19<00:09, 14.91it/s]Normalizing and saving training data:  68%|#################################################################################################################################################6                                                                   | 290/424 [00:19<00:08, 15.01it/s]Normalizing and saving training data:  71%|######################################################################################################################################################7                                                              | 300/424 [00:20<00:08, 15.09it/s]Normalizing and saving training data:  73%|###########################################################################################################################################################7                                                         | 310/424 [00:21<00:07, 15.10it/s]Normalizing and saving training data:  75%|################################################################################################################################################################7                                                    | 320/424 [00:21<00:06, 15.15it/s]Normalizing and saving training data:  78%|#####################################################################################################################################################################7                                               | 330/424 [00:22<00:06, 15.19it/s]Normalizing and saving training data:  80%|##########################################################################################################################################################################8                                          | 340/424 [00:23<00:05, 15.19it/s]Normalizing and saving training data:  83%|###############################################################################################################################################################################8                                     | 350/424 [00:23<00:04, 15.19it/s]Normalizing and saving training data:  85%|####################################################################################################################################################################################8                                | 360/424 [00:24<00:04, 15.19it/s]Normalizing and saving training data:  87%|#########################################################################################################################################################################################8                           | 370/424 [00:25<00:03, 15.19it/s]Normalizing and saving training data:  90%|##############################################################################################################################################################################################8                      | 380/424 [00:25<00:02, 15.18it/s]Normalizing and saving training data:  92%|###################################################################################################################################################################################################9                 | 390/424 [00:26<00:02, 15.16it/s]Normalizing and saving training data:  94%|########################################################################################################################################################################################################9            | 400/424 [00:27<00:01, 15.23it/s]Normalizing and saving training data:  97%|#############################################################################################################################################################################################################9       | 410/424 [00:27<00:00, 15.26it/s]Normalizing and saving training data:  99%|##################################################################################################################################################################################################################9  | 420/424 [00:28<00:00, 15.30it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################################| 424/424 [00:28<00:00, 14.97it/s]
2025-11-19 19:18:46,953 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:18:46,960 - INFO - Loaded normalization statistics:
2025-11-19 19:18:46,960 - INFO -   Mean: 0.291228
2025-11-19 19:18:46,960 - INFO -   Std: 2.463941
2025-11-19 19:18:46,960 - INFO - Split train already completed, skipping
2025-11-19 19:18:46,960 - INFO - Processing test split...
2025-11-19 19:18:46,960 - INFO - Need to process 48/48 sequences for test
2025-11-19 19:18:46,961 - INFO - Processing 48 sequences from 15 unique files
2025-11-19 19:18:46,961 - INFO - Average 3.2 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                                     | 0/48 [00:00<?, ?it/s]Processing test:   2%|####9                                                                                                                                                                                                                                        | 1/48 [00:00<00:33,  1.42it/s]2025-11-19 19:18:47,666 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold0\test_dataset.h5
2025-11-19 19:18:49,123 - INFO - Progress: 448/472 (94.9%) - ETA: 0.1 minutes
Processing test:  52%|##########################################################################################################################9                                                                                                                 | 25/48 [00:02<00:02, 10.79it/s]Processing test:  54%|###############################################################################################################################8                                                                                                            | 26/48 [00:03<00:02,  7.35it/s]Processing test:  60%|##############################################################################################################################################5                                                                                             | 29/48 [00:03<00:02,  7.90it/s]Processing test:  62%|###################################################################################################################################################5                                                                                        | 30/48 [00:04<00:03,  5.80it/s]Processing test:  67%|#############################################################################################################################################################3                                                                              | 32/48 [00:05<00:03,  4.81it/s]Processing test:  71%|#######################################################################################################################################################################1                                                                    | 34/48 [00:06<00:04,  3.43it/s]2025-11-19 19:18:53,951 - INFO - Progress: 460/472 (97.5%) - ETA: 0.0 minutes
Processing test:  77%|#####################################################################################################################################################################################9                                                      | 37/48 [00:07<00:04,  2.75it/s]Processing test:  83%|####################################################################################################################################################################################################6                                       | 40/48 [00:08<00:02,  2.69it/s]Processing test:  88%|##############################################################################################################################################################################################################5                             | 42/48 [00:09<00:01,  3.15it/s]Processing test:  90%|###################################################################################################################################################################################################################4                        | 43/48 [00:10<00:01,  2.54it/s]Processing test:  94%|#############################################################################################################################################################################################################################2              | 45/48 [00:10<00:00,  3.17it/s]Processing test:  96%|##################################################################################################################################################################################################################################1         | 46/48 [00:10<00:00,  3.27it/s]2025-11-19 19:18:58,193 - INFO - Progress: 470/472 (99.6%) - ETA: 0.0 minutes
Processing test:  98%|#######################################################################################################################################################################################################################################     | 47/48 [00:11<00:00,  2.38it/s]Processing test: 100%|############################################################################################################################################################################################################################################| 48/48 [00:11<00:00,  2.60it/s]Processing test: 100%|############################################################################################################################################################################################################################################| 48/48 [00:11<00:00,  4.09it/s]
2025-11-19 19:18:58,887 - INFO - Validating final datasets...
2025-11-19 19:18:58,895 - INFO - train dataset validation:
2025-11-19 19:18:58,895 - INFO -   - Segments: 424
2025-11-19 19:18:58,895 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:18:58,895 - INFO -   - Classes: 212 preictal, 212 interictal
2025-11-19 19:18:58,895 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:18:58,900 - INFO - test dataset validation:
2025-11-19 19:18:58,900 - INFO -   - Segments: 48
2025-11-19 19:18:58,900 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:18:58,900 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-19 19:18:58,900 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:18:58,901 - INFO - ============================================================
2025-11-19 19:18:58,901 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:18:58,901 - INFO - Total time: 1.3 minutes
2025-11-19 19:18:58,901 - INFO - Processed segments: 472
2025-11-19 19:18:58,901 - INFO - Average rate: 6.0 segments/second
2025-11-19 19:18:58,901 - INFO - ============================================================
✅ Fold 0 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 1/11
============================================================
2025-11-19 19:18:58,973 - INFO - ============================================================
2025-11-19 19:18:58,973 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:18:58,973 - INFO - ============================================================
2025-11-19 19:18:58,974 - INFO - Output prefix: chb13_fold1
2025-11-19 19:18:58,974 - INFO - EEG Preprocessor initialized
2025-11-19 19:18:58,974 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:18:58,974 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:18:58,974 - INFO - Segment duration: 5 seconds
2025-11-19 19:18:58,974 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:18:58,974 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:18:58,974 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:18:58,974 - INFO - Loading segments from chb13_fold1_sequences_prediction.json
2025-11-19 19:18:58,988 - INFO - Loaded 472 total sequences
2025-11-19 19:18:58,988 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:18:58,988 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:18:58,988 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:18:58,988 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:18:58,988 - INFO - train: 432 sequences (216 preictal, 216 interictal)
2025-11-19 19:18:58,988 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-19 19:18:59,012 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:18:59,012 - INFO - train: kept 216 preictal and 216 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:18:59,012 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:18:59,036 - INFO - ============================================================
2025-11-19 19:18:59,036 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:18:59,036 - INFO - ============================================================
2025-11-19 19:18:59,037 - INFO - Processing 432 training samples to compute normalization stats...
2025-11-19 19:18:59,037 - INFO - Processing 432 sequences from 28 unique files
Processing training data:   0%|                                                                                                                                                                                                                                           | 0/432 [00:00<?, ?it/s]Processing training data:   0%|5                                                                                                                                                                                                                                  | 1/432 [00:01<10:22,  1.44s/it]Processing training data:   3%|#######3                                                                                                                                                                                                                          | 14/432 [00:02<01:09,  5.99it/s]Processing training data:   5%|############                                                                                                                                                                                                                      | 23/432 [00:03<00:44,  9.11it/s]Processing training data:   9%|#####################4                                                                                                                                                                                                            | 41/432 [00:04<00:35, 11.16it/s]Processing training data:  12%|############################2                                                                                                                                                                                                     | 54/432 [00:05<00:26, 14.20it/s]Processing training data:  17%|#######################################2                                                                                                                                                                                          | 75/432 [00:06<00:22, 15.84it/s]Processing training data:  25%|#######################################################7                                                                                                                                                                         | 107/432 [00:07<00:16, 19.58it/s]Processing training data:  40%|#########################################################################################5                                                                                                                                       | 172/432 [00:08<00:08, 30.69it/s]Processing training data:  42%|##############################################################################################2                                                                                                                                  | 181/432 [00:10<00:11, 22.22it/s]Processing training data:  45%|####################################################################################################5                                                                                                                            | 193/432 [00:11<00:14, 16.81it/s]Processing training data:  47%|##########################################################################################################7                                                                                                                      | 205/432 [00:13<00:16, 14.16it/s]Processing training data:  51%|##################################################################################################################                                                                                                               | 219/432 [00:14<00:16, 12.99it/s]Processing training data:  54%|########################################################################################################################8                                                                                                        | 232/432 [00:14<00:13, 14.57it/s]Processing training data:  59%|#####################################################################################################################################3                                                                                           | 256/432 [00:15<00:08, 20.10it/s]Processing training data:  64%|###############################################################################################################################################7                                                                                 | 276/432 [00:15<00:06, 23.88it/s]Processing training data:  69%|##########################################################################################################################################################1                                                                      | 296/432 [00:17<00:06, 19.82it/s]Processing training data:  71%|###############################################################################################################################################################3                                                                 | 306/432 [00:18<00:08, 14.28it/s]Processing training data:  74%|#######################################################################################################################################################################1                                                         | 321/432 [00:19<00:06, 17.14it/s]Processing training data:  78%|###############################################################################################################################################################################5                                                 | 337/432 [00:20<00:06, 15.36it/s]Processing training data:  80%|###################################################################################################################################################################################6                                             | 345/432 [00:22<00:07, 11.52it/s]Processing training data:  83%|#########################################################################################################################################################################################9                                       | 357/432 [00:23<00:06, 10.94it/s]Processing training data:  85%|###############################################################################################################################################################################################6                                 | 368/432 [00:24<00:06,  9.54it/s]Processing training data:  88%|#####################################################################################################################################################################################################3                           | 379/432 [00:26<00:05,  9.03it/s]Processing training data:  90%|##########################################################################################################################################################################################################                       | 388/432 [00:27<00:05,  8.50it/s]Processing training data:  91%|#############################################################################################################################################################################################################2                   | 394/432 [00:29<00:05,  7.11it/s]Processing training data:  93%|################################################################################################################################################################################################################8                | 401/432 [00:30<00:05,  6.16it/s]Processing training data:  95%|######################################################################################################################################################################################################################           | 411/432 [00:32<00:03,  6.18it/s]Processing training data:  98%|############################################################################################################################################################################################################################8    | 424/432 [00:33<00:01,  6.73it/s]Processing training data: 100%|#################################################################################################################################################################################################################################| 432/432 [00:33<00:00, 12.74it/s]
2025-11-19 19:19:32,949 - INFO - Computing normalization statistics from training data...
2025-11-19 19:19:33,667 - INFO - Normalization stats computed:
2025-11-19 19:19:33,667 - INFO -   Mean: 0.287971
2025-11-19 19:19:33,667 - INFO -   Std: 2.458635
2025-11-19 19:19:33,667 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold1\normalization_stats.json
2025-11-19 19:19:33,741 - INFO - Applying normalization and saving 432 training sequences...
Normalizing and saving training data:   0%|                          | 0/432 [00:00<?, ?it/s]2025-11-19 19:19:33,750 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold1\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/432 [00:00<00:27, 15.21it/s]Normalizing and saving training data:   5%|7                | 20/432 [00:01<00:27, 14.96it/s]Normalizing and saving training data:   7%|#1               | 30/432 [00:01<00:26, 15.03it/s]Normalizing and saving training data:   9%|#5               | 40/432 [00:02<00:25, 15.15it/s]Normalizing and saving training data:  12%|#9               | 50/432 [00:03<00:24, 15.29it/s]Normalizing and saving training data:  14%|##3              | 60/432 [00:03<00:24, 15.28it/s]Normalizing and saving training data:  16%|##7              | 70/432 [00:04<00:23, 15.35it/s]Normalizing and saving training data:  19%|###1             | 80/432 [00:05<00:22, 15.45it/s]Normalizing and saving training data:  21%|###5             | 90/432 [00:05<00:21, 15.55it/s]Normalizing and saving training data:  23%|###7            | 100/432 [00:06<00:21, 15.29it/s]Normalizing and saving training data:  25%|####            | 110/432 [00:07<00:21, 15.00it/s]Normalizing and saving training data:  28%|####4           | 120/432 [00:07<00:20, 14.86it/s]Normalizing and saving training data:  30%|####8           | 130/432 [00:08<00:20, 15.04it/s]Normalizing and saving training data:  32%|#####1          | 140/432 [00:09<00:19, 15.08it/s]Normalizing and saving training data:  35%|#####5          | 150/432 [00:09<00:18, 15.11it/s]Normalizing and saving training data:  37%|#####9          | 160/432 [00:10<00:17, 15.16it/s]Normalizing and saving training data:  39%|######2         | 170/432 [00:11<00:17, 15.20it/s]Normalizing and saving training data:  42%|######6         | 180/432 [00:11<00:16, 15.03it/s]Normalizing and saving training data:  44%|#######         | 190/432 [00:12<00:16, 14.77it/s]Normalizing and saving training data:  46%|#######4        | 200/432 [00:13<00:15, 14.76it/s]Normalizing and saving training data:  49%|#######7        | 210/432 [00:13<00:14, 14.92it/s]Normalizing and saving training data:  51%|########1       | 220/432 [00:14<00:14, 15.08it/s]Normalizing and saving training data:  53%|########5       | 230/432 [00:15<00:13, 15.04it/s]Normalizing and saving training data:  56%|########8       | 240/432 [00:15<00:12, 15.22it/s]Normalizing and saving training data:  58%|#########2      | 250/432 [00:16<00:11, 15.34it/s]Normalizing and saving training data:  60%|#########6      | 260/432 [00:17<00:11, 15.48it/s]Normalizing and saving training data:  62%|##########      | 270/432 [00:17<00:10, 15.60it/s]Normalizing and saving training data:  65%|##########3     | 280/432 [00:18<00:09, 15.54it/s]Normalizing and saving training data:  67%|##########7     | 290/432 [00:19<00:09, 15.54it/s]Normalizing and saving training data:  69%|###########1    | 300/432 [00:19<00:08, 15.62it/s]Normalizing and saving training data:  72%|###########4    | 310/432 [00:20<00:07, 15.51it/s]Normalizing and saving training data:  74%|###########8    | 320/432 [00:20<00:07, 15.57it/s]Normalizing and saving training data:  76%|############2   | 330/432 [00:21<00:06, 15.64it/s]Normalizing and saving training data:  79%|############5   | 340/432 [00:22<00:05, 15.64it/s]Normalizing and saving training data:  81%|############9   | 350/432 [00:22<00:05, 15.64it/s]Normalizing and saving training data:  83%|#############3  | 360/432 [00:23<00:04, 15.63it/s]Normalizing and saving training data:  86%|#############7  | 370/432 [00:24<00:03, 15.64it/s]Normalizing and saving training data:  88%|##############  | 380/432 [00:24<00:03, 15.59it/s]Normalizing and saving training data:  90%|##############4 | 390/432 [00:25<00:02, 15.50it/s]Normalizing and saving training data:  93%|##############8 | 400/432 [00:26<00:02, 15.51it/s]Normalizing and saving training data:  95%|###############1| 410/432 [00:26<00:01, 15.51it/s]Normalizing and saving training data:  97%|###############5| 420/432 [00:27<00:00, 15.48it/s]Normalizing and saving training data: 100%|###############9| 430/432 [00:28<00:00, 15.43it/s]Normalizing and saving training data: 100%|################| 432/432 [00:28<00:00, 15.39it/s]
2025-11-19 19:20:02,006 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:20:02,013 - INFO - Loaded normalization statistics:
2025-11-19 19:20:02,013 - INFO -   Mean: 0.287971
2025-11-19 19:20:02,014 - INFO -   Std: 2.458635
2025-11-19 19:20:02,014 - INFO - Split train already completed, skipping
2025-11-19 19:20:02,014 - INFO - Processing test split...
2025-11-19 19:20:02,014 - INFO - Need to process 40/40 sequences for test
2025-11-19 19:20:02,014 - INFO - Processing 40 sequences from 16 unique files
2025-11-19 19:20:02,014 - INFO - Average 2.5 sequences per file
Processing test:   0%|                                                | 0/40 [00:00<?, ?it/s]Processing test:   2%|#                                       | 1/40 [00:00<00:11,  3.40it/s]Processing test:   5%|##                                      | 2/40 [00:00<00:10,  3.58it/s]Processing test:   8%|###                                     | 3/40 [00:01<00:15,  2.39it/s]2025-11-19 19:20:03,161 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold1\test_dataset.h5
2025-11-19 19:20:04,485 - INFO - Progress: 454/472 (96.2%) - ETA: 0.0 minutes
Processing test:  57%|######################4                | 23/40 [00:03<00:02,  6.30it/s]Processing test:  62%|########################3              | 25/40 [00:04<00:02,  6.41it/s]Processing test:  65%|#########################3             | 26/40 [00:05<00:03,  4.45it/s]Processing test:  70%|###########################3           | 28/40 [00:05<00:02,  4.74it/s]Processing test:  72%|############################2          | 29/40 [00:06<00:03,  3.48it/s]Processing test:  78%|##############################2        | 31/40 [00:07<00:03,  2.95it/s]2025-11-19 19:20:10,057 - INFO - Progress: 464/472 (98.3%) - ETA: 0.0 minutes
Processing test:  82%|################################1      | 33/40 [00:08<00:02,  2.72it/s]Processing test:  85%|#################################1     | 34/40 [00:09<00:02,  2.15it/s]Processing test:  90%|###################################1   | 36/40 [00:09<00:01,  2.72it/s]Processing test:  92%|####################################   | 37/40 [00:09<00:01,  2.89it/s]Processing test:  95%|#####################################  | 38/40 [00:10<00:00,  2.99it/s]Processing test:  98%|###################################### | 39/40 [00:10<00:00,  3.06it/s]Processing test: 100%|#######################################| 40/40 [00:10<00:00,  3.04it/s]Processing test: 100%|#######################################| 40/40 [00:10<00:00,  3.71it/s]
2025-11-19 19:20:13,324 - INFO - Validating final datasets...
2025-11-19 19:20:13,332 - INFO - train dataset validation:
2025-11-19 19:20:13,332 - INFO -   - Segments: 432
2025-11-19 19:20:13,332 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:20:13,332 - INFO -   - Classes: 216 preictal, 216 interictal
2025-11-19 19:20:13,332 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:20:13,338 - INFO - test dataset validation:
2025-11-19 19:20:13,338 - INFO -   - Segments: 40
2025-11-19 19:20:13,338 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:20:13,338 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-19 19:20:13,338 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:20:13,338 - INFO - ============================================================
2025-11-19 19:20:13,338 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:20:13,338 - INFO - Total time: 1.2 minutes
2025-11-19 19:20:13,338 - INFO - Processed segments: 472
2025-11-19 19:20:13,338 - INFO - Average rate: 6.3 segments/second
2025-11-19 19:20:13,338 - INFO - ============================================================
✅ Fold 1 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 2/11
============================================================
2025-11-19 19:20:13,428 - INFO - ============================================================
2025-11-19 19:20:13,428 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:20:13,428 - INFO - ============================================================
2025-11-19 19:20:13,428 - INFO - Output prefix: chb13_fold2
2025-11-19 19:20:13,428 - INFO - EEG Preprocessor initialized
2025-11-19 19:20:13,428 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:20:13,428 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:20:13,428 - INFO - Segment duration: 5 seconds
2025-11-19 19:20:13,428 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:20:13,428 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:20:13,429 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:20:13,429 - INFO - Loading segments from chb13_fold2_sequences_prediction.json
2025-11-19 19:20:13,445 - INFO - Loaded 472 total sequences
2025-11-19 19:20:13,445 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:20:13,445 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:20:13,445 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:20:13,445 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:20:13,445 - INFO - train: 436 sequences (218 preictal, 218 interictal)
2025-11-19 19:20:13,445 - INFO - test: 36 sequences (18 preictal, 18 interictal)
2025-11-19 19:20:13,470 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:20:13,470 - INFO - train: kept 218 preictal and 218 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:20:13,470 - INFO - test: kept 18 preictal and 18 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:20:13,495 - INFO - ============================================================
2025-11-19 19:20:13,495 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:20:13,495 - INFO - ============================================================
2025-11-19 19:20:13,495 - INFO - Processing 436 training samples to compute normalization stats...
2025-11-19 19:20:13,495 - INFO - Processing 436 sequences from 28 unique files
Processing training data:   0%|                                      | 0/436 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/436 [00:01<09:08,  1.26s/it]Processing training data:  15%|####3                        | 66/436 [00:02<00:11, 31.53it/s]Processing training data:  18%|#####1                       | 78/436 [00:02<00:12, 29.41it/s]Processing training data:  22%|######5                      | 98/436 [00:04<00:15, 21.98it/s]Processing training data:  25%|#######                     | 109/436 [00:05<00:19, 17.12it/s]Processing training data:  26%|#######3                    | 114/436 [00:06<00:20, 15.53it/s]Processing training data:  31%|########6                   | 135/436 [00:07<00:17, 17.00it/s]Processing training data:  33%|#########1                  | 142/436 [00:08<00:24, 11.81it/s]Processing training data:  35%|#########6                  | 151/436 [00:10<00:29,  9.77it/s]Processing training data:  37%|##########4                 | 162/436 [00:11<00:27,  9.81it/s]Processing training data:  39%|###########                 | 172/436 [00:11<00:23, 11.35it/s]Processing training data:  44%|############3               | 192/436 [00:13<00:19, 12.35it/s]Processing training data:  47%|#############2              | 206/436 [00:14<00:19, 11.81it/s]Processing training data:  50%|##############              | 218/436 [00:15<00:19, 11.37it/s]Processing training data:  57%|################            | 250/436 [00:16<00:11, 15.77it/s]Processing training data:  60%|################7           | 261/436 [00:18<00:12, 13.47it/s]Processing training data:  63%|#################5          | 273/436 [00:18<00:11, 14.67it/s]Processing training data:  68%|###################         | 297/436 [00:20<00:08, 15.61it/s]Processing training data:  71%|###################9        | 310/436 [00:21<00:09, 13.13it/s]Processing training data:  74%|####################8       | 324/436 [00:22<00:07, 15.14it/s]Processing training data:  79%|######################      | 344/436 [00:23<00:06, 15.14it/s]Processing training data:  81%|######################6     | 353/436 [00:25<00:07, 11.73it/s]Processing training data:  84%|#######################5    | 366/436 [00:26<00:06, 11.20it/s]Processing training data:  87%|########################2   | 378/436 [00:27<00:05, 10.50it/s]Processing training data:  89%|########################8   | 387/436 [00:28<00:05,  9.66it/s]Processing training data:  92%|#########################6  | 400/436 [00:30<00:03,  9.51it/s]Processing training data:  94%|##########################3 | 411/436 [00:31<00:02,  9.41it/s]Processing training data:  97%|########################### | 421/436 [00:31<00:01, 11.13it/s]Processing training data: 100%|############################| 436/436 [00:31<00:00, 13.65it/s]
2025-11-19 19:20:45,436 - INFO - Computing normalization statistics from training data...
2025-11-19 19:20:46,096 - INFO - Normalization stats computed:
2025-11-19 19:20:46,097 - INFO -   Mean: 0.428586
2025-11-19 19:20:46,097 - INFO -   Std: 2.460481
2025-11-19 19:20:46,097 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold2\normalization_stats.json
2025-11-19 19:20:46,167 - INFO - Applying normalization and saving 436 training sequences...
Normalizing and saving training data:   0%|                          | 0/436 [00:00<?, ?it/s]2025-11-19 19:20:46,174 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold2\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/436 [00:00<00:27, 15.44it/s]Normalizing and saving training data:   5%|7                | 20/436 [00:01<00:27, 15.37it/s]Normalizing and saving training data:   7%|#1               | 30/436 [00:01<00:26, 15.51it/s]Normalizing and saving training data:   9%|#5               | 40/436 [00:02<00:25, 15.59it/s]Normalizing and saving training data:  11%|#9               | 50/436 [00:03<00:24, 15.61it/s]Normalizing and saving training data:  14%|##3              | 60/436 [00:03<00:24, 15.57it/s]Normalizing and saving training data:  16%|##7              | 70/436 [00:04<00:23, 15.50it/s]Normalizing and saving training data:  18%|###1             | 80/436 [00:05<00:22, 15.52it/s]Normalizing and saving training data:  21%|###5             | 90/436 [00:05<00:22, 15.06it/s]Normalizing and saving training data:  23%|###6            | 100/436 [00:06<00:22, 14.96it/s]Normalizing and saving training data:  25%|####            | 110/436 [00:07<00:21, 15.13it/s]Normalizing and saving training data:  28%|####4           | 120/436 [00:07<00:20, 15.23it/s]Normalizing and saving training data:  30%|####7           | 130/436 [00:08<00:20, 15.15it/s]Normalizing and saving training data:  32%|#####1          | 140/436 [00:09<00:19, 15.15it/s]Normalizing and saving training data:  34%|#####5          | 150/436 [00:09<00:18, 15.07it/s]Normalizing and saving training data:  37%|#####8          | 160/436 [00:10<00:18, 14.89it/s]Normalizing and saving training data:  39%|######2         | 170/436 [00:11<00:17, 14.79it/s]Normalizing and saving training data:  41%|######6         | 180/436 [00:11<00:17, 14.92it/s]Normalizing and saving training data:  44%|######9         | 190/436 [00:12<00:16, 14.95it/s]Normalizing and saving training data:  46%|#######3        | 200/436 [00:13<00:15, 14.81it/s]Normalizing and saving training data:  48%|#######7        | 210/436 [00:13<00:15, 14.79it/s]Normalizing and saving training data:  50%|########        | 220/436 [00:14<00:14, 14.75it/s]Normalizing and saving training data:  53%|########4       | 230/436 [00:15<00:13, 14.85it/s]Normalizing and saving training data:  55%|########8       | 240/436 [00:15<00:13, 14.92it/s]Normalizing and saving training data:  57%|#########1      | 250/436 [00:16<00:12, 15.01it/s]Normalizing and saving training data:  60%|#########5      | 260/436 [00:17<00:11, 14.99it/s]Normalizing and saving training data:  62%|#########9      | 270/436 [00:17<00:11, 14.57it/s]Normalizing and saving training data:  64%|##########2     | 280/436 [00:18<00:10, 14.57it/s]Normalizing and saving training data:  67%|##########6     | 290/436 [00:19<00:09, 14.63it/s]Normalizing and saving training data:  69%|###########     | 300/436 [00:19<00:09, 14.72it/s]Normalizing and saving training data:  71%|###########3    | 310/436 [00:20<00:08, 14.73it/s]Normalizing and saving training data:  73%|###########7    | 320/436 [00:21<00:07, 14.79it/s]Normalizing and saving training data:  76%|############1   | 330/436 [00:22<00:07, 14.83it/s]Normalizing and saving training data:  78%|############4   | 340/436 [00:22<00:06, 14.82it/s]Normalizing and saving training data:  80%|############8   | 350/436 [00:23<00:05, 14.93it/s]Normalizing and saving training data:  83%|#############2  | 360/436 [00:24<00:05, 14.95it/s]Normalizing and saving training data:  85%|#############5  | 370/436 [00:24<00:04, 14.95it/s]Normalizing and saving training data:  87%|#############9  | 380/436 [00:25<00:03, 14.97it/s]Normalizing and saving training data:  89%|##############3 | 390/436 [00:26<00:03, 14.92it/s]Normalizing and saving training data:  92%|##############6 | 400/436 [00:26<00:02, 14.31it/s]Normalizing and saving training data:  94%|############### | 410/436 [00:27<00:01, 14.58it/s]Normalizing and saving training data:  96%|###############4| 420/436 [00:28<00:01, 14.74it/s]Normalizing and saving training data:  99%|###############7| 430/436 [00:28<00:00, 14.97it/s]Normalizing and saving training data: 100%|################| 436/436 [00:28<00:00, 15.16it/s]
2025-11-19 19:21:15,341 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:21:15,347 - INFO - Loaded normalization statistics:
2025-11-19 19:21:15,348 - INFO -   Mean: 0.428586
2025-11-19 19:21:15,348 - INFO -   Std: 2.460481
2025-11-19 19:21:15,348 - INFO - Split train already completed, skipping
2025-11-19 19:21:15,348 - INFO - Processing test split...
2025-11-19 19:21:15,348 - INFO - Need to process 36/36 sequences for test
2025-11-19 19:21:15,348 - INFO - Processing 36 sequences from 14 unique files
2025-11-19 19:21:15,348 - INFO - Average 2.6 sequences per file
Processing test:   0%|                                                | 0/36 [00:00<?, ?it/s]Processing test:   3%|#1                                      | 1/36 [00:01<00:56,  1.61s/it]Processing test:   8%|###3                                    | 3/36 [00:01<00:17,  1.87it/s]Processing test:  11%|####4                                   | 4/36 [00:02<00:17,  1.81it/s]2025-11-19 19:21:17,860 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold2\test_dataset.h5
2025-11-19 19:21:19,147 - INFO - Progress: 457/472 (96.8%) - ETA: 0.0 minutes
Processing test:  61%|#######################8               | 22/36 [00:05<00:02,  5.51it/s]Processing test:  69%|###########################            | 25/36 [00:05<00:01,  6.07it/s]Processing test:  72%|############################1          | 26/36 [00:06<00:02,  4.09it/s]Processing test:  78%|##############################3        | 28/36 [00:06<00:01,  4.48it/s]Processing test:  81%|###############################4       | 29/36 [00:08<00:02,  2.67it/s]Processing test:  86%|#################################5     | 31/36 [00:08<00:01,  3.09it/s]2025-11-19 19:21:24,670 - INFO - Progress: 467/472 (98.9%) - ETA: 0.0 minutes
Processing test:  89%|##################################6    | 32/36 [00:09<00:01,  2.38it/s]Processing test:  92%|###################################7   | 33/36 [00:09<00:01,  2.53it/s]Processing test:  94%|####################################8  | 34/36 [00:10<00:00,  2.69it/s]Processing test:  97%|#####################################9 | 35/36 [00:10<00:00,  2.89it/s]Processing test: 100%|#######################################| 36/36 [00:10<00:00,  3.10it/s]Processing test: 100%|#######################################| 36/36 [00:10<00:00,  3.38it/s]
2025-11-19 19:21:26,348 - INFO - Validating final datasets...
2025-11-19 19:21:26,356 - INFO - train dataset validation:
2025-11-19 19:21:26,356 - INFO -   - Segments: 436
2025-11-19 19:21:26,356 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:21:26,356 - INFO -   - Classes: 218 preictal, 218 interictal
2025-11-19 19:21:26,356 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:21:26,362 - INFO - test dataset validation:
2025-11-19 19:21:26,362 - INFO -   - Segments: 36
2025-11-19 19:21:26,362 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:21:26,362 - INFO -   - Classes: 18 preictal, 18 interictal
2025-11-19 19:21:26,362 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:21:26,362 - INFO - ============================================================
2025-11-19 19:21:26,362 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:21:26,362 - INFO - Total time: 1.2 minutes
2025-11-19 19:21:26,362 - INFO - Processed segments: 472
2025-11-19 19:21:26,362 - INFO - Average rate: 6.5 segments/second
2025-11-19 19:21:26,362 - INFO - ============================================================
✅ Fold 2 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 3/11
============================================================
2025-11-19 19:21:26,450 - INFO - ============================================================
2025-11-19 19:21:26,450 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:21:26,450 - INFO - ============================================================
2025-11-19 19:21:26,450 - INFO - Output prefix: chb13_fold3
2025-11-19 19:21:26,450 - INFO - EEG Preprocessor initialized
2025-11-19 19:21:26,450 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:21:26,450 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:21:26,450 - INFO - Segment duration: 5 seconds
2025-11-19 19:21:26,450 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:21:26,450 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:21:26,450 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:21:26,450 - INFO - Loading segments from chb13_fold3_sequences_prediction.json
2025-11-19 19:21:26,465 - INFO - Loaded 472 total sequences
2025-11-19 19:21:26,465 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:21:26,465 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:21:26,465 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:21:26,465 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:21:26,466 - INFO - train: 440 sequences (220 preictal, 220 interictal)
2025-11-19 19:21:26,466 - INFO - test: 32 sequences (16 preictal, 16 interictal)
2025-11-19 19:21:26,496 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:21:26,496 - INFO - train: kept 220 preictal and 220 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:21:26,496 - INFO - test: kept 16 preictal and 16 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:21:26,521 - INFO - ============================================================
2025-11-19 19:21:26,521 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:21:26,521 - INFO - ============================================================
2025-11-19 19:21:26,521 - INFO - Processing 440 training samples to compute normalization stats...
2025-11-19 19:21:26,521 - INFO - Processing 440 sequences from 29 unique files
Processing training data:   0%|                                      | 0/440 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/440 [00:01<08:55,  1.22s/it]Processing training data:  15%|####3                        | 66/440 [00:02<00:12, 30.35it/s]Processing training data:  18%|#####2                       | 79/440 [00:03<00:12, 29.09it/s]Processing training data:  22%|######5                      | 99/440 [00:03<00:10, 32.10it/s]Processing training data:  27%|#######5                    | 119/440 [00:04<00:14, 22.66it/s]Processing training data:  30%|########4                   | 132/440 [00:06<00:17, 17.76it/s]Processing training data:  32%|#########                   | 142/440 [00:06<00:16, 17.76it/s]Processing training data:  37%|##########3                 | 163/440 [00:07<00:15, 17.74it/s]Processing training data:  44%|############4               | 195/440 [00:09<00:12, 20.09it/s]Processing training data:  46%|############8               | 202/440 [00:10<00:16, 14.61it/s]Processing training data:  49%|#############7              | 216/440 [00:12<00:16, 13.24it/s]Processing training data:  52%|##############5             | 229/440 [00:13<00:17, 12.13it/s]Processing training data:  55%|###############4            | 243/440 [00:14<00:16, 11.72it/s]Processing training data:  58%|################2           | 256/440 [00:15<00:15, 11.94it/s]Processing training data:  60%|################8           | 265/440 [00:16<00:13, 12.86it/s]Processing training data:  65%|##################1         | 285/440 [00:17<00:10, 14.30it/s]Processing training data:  67%|##################6         | 293/440 [00:18<00:12, 11.71it/s]Processing training data:  69%|###################2        | 303/440 [00:19<00:12, 10.72it/s]Processing training data:  72%|####################        | 315/440 [00:20<00:09, 12.68it/s]Processing training data:  77%|#####################5      | 339/440 [00:20<00:05, 19.69it/s]Processing training data:  81%|######################7     | 357/440 [00:22<00:04, 17.67it/s]Processing training data:  83%|#######################1    | 364/440 [00:23<00:06, 12.32it/s]Processing training data:  86%|########################1   | 380/440 [00:24<00:04, 12.73it/s]Processing training data:  88%|########################7   | 389/440 [00:25<00:04, 10.98it/s]Processing training data:  90%|#########################3  | 398/440 [00:27<00:04,  9.24it/s]Processing training data:  94%|##########################2 | 412/440 [00:28<00:02,  9.59it/s]Processing training data:  96%|##########################9 | 424/440 [00:30<00:01,  9.30it/s]Processing training data:  99%|###########################7| 436/440 [00:30<00:00, 12.25it/s]Processing training data: 100%|###########################9| 439/440 [00:31<00:00, 10.27it/s]Processing training data: 100%|############################| 440/440 [00:31<00:00, 14.14it/s]
2025-11-19 19:21:57,634 - INFO - Computing normalization statistics from training data...
2025-11-19 19:21:58,288 - INFO - Normalization stats computed:
2025-11-19 19:21:58,288 - INFO -   Mean: 0.412241
2025-11-19 19:21:58,288 - INFO -   Std: 2.458303
2025-11-19 19:21:58,288 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold3\normalization_stats.json
2025-11-19 19:21:58,357 - INFO - Applying normalization and saving 440 training sequences...
Normalizing and saving training data:   0%|                          | 0/440 [00:00<?, ?it/s]2025-11-19 19:21:58,364 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold3\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/440 [00:00<00:26, 16.19it/s]Normalizing and saving training data:   5%|7                | 20/440 [00:01<00:26, 16.03it/s]Normalizing and saving training data:   7%|#1               | 30/440 [00:01<00:25, 16.00it/s]Normalizing and saving training data:   9%|#5               | 40/440 [00:02<00:24, 16.02it/s]Normalizing and saving training data:  11%|#9               | 50/440 [00:03<00:24, 16.00it/s]Normalizing and saving training data:  14%|##3              | 60/440 [00:03<00:23, 15.95it/s]Normalizing and saving training data:  16%|##7              | 70/440 [00:04<00:23, 15.92it/s]Normalizing and saving training data:  18%|###              | 80/440 [00:05<00:22, 15.77it/s]Normalizing and saving training data:  20%|###4             | 90/440 [00:05<00:22, 15.75it/s]Normalizing and saving training data:  23%|###6            | 100/440 [00:06<00:21, 15.74it/s]Normalizing and saving training data:  25%|####            | 110/440 [00:06<00:20, 15.76it/s]Normalizing and saving training data:  27%|####3           | 120/440 [00:07<00:20, 15.76it/s]Normalizing and saving training data:  30%|####7           | 130/440 [00:08<00:19, 15.79it/s]Normalizing and saving training data:  32%|#####           | 140/440 [00:08<00:19, 15.79it/s]Normalizing and saving training data:  34%|#####4          | 150/440 [00:09<00:18, 15.79it/s]Normalizing and saving training data:  36%|#####8          | 160/440 [00:10<00:17, 15.77it/s]Normalizing and saving training data:  39%|######1         | 170/440 [00:10<00:17, 15.22it/s]Normalizing and saving training data:  41%|######5         | 180/440 [00:11<00:16, 15.38it/s]Normalizing and saving training data:  43%|######9         | 190/440 [00:12<00:16, 15.48it/s]Normalizing and saving training data:  45%|#######2        | 200/440 [00:12<00:15, 15.57it/s]Normalizing and saving training data:  48%|#######6        | 210/440 [00:13<00:14, 15.61it/s]Normalizing and saving training data:  50%|########        | 220/440 [00:13<00:14, 15.65it/s]Normalizing and saving training data:  52%|########3       | 230/440 [00:14<00:13, 15.68it/s]Normalizing and saving training data:  55%|########7       | 240/440 [00:15<00:12, 15.65it/s]Normalizing and saving training data:  57%|#########       | 250/440 [00:15<00:12, 15.64it/s]Normalizing and saving training data:  59%|#########4      | 260/440 [00:16<00:11, 15.60it/s]Normalizing and saving training data:  61%|#########8      | 270/440 [00:17<00:10, 15.65it/s]Normalizing and saving training data:  64%|##########1     | 280/440 [00:17<00:10, 15.67it/s]Normalizing and saving training data:  66%|##########5     | 290/440 [00:18<00:09, 15.67it/s]Normalizing and saving training data:  68%|##########9     | 300/440 [00:19<00:08, 15.70it/s]Normalizing and saving training data:  70%|###########2    | 310/440 [00:19<00:08, 15.71it/s]Normalizing and saving training data:  73%|###########6    | 320/440 [00:20<00:07, 15.69it/s]Normalizing and saving training data:  75%|############    | 330/440 [00:21<00:07, 15.67it/s]Normalizing and saving training data:  77%|############3   | 340/440 [00:21<00:06, 15.70it/s]Normalizing and saving training data:  80%|############7   | 350/440 [00:22<00:05, 15.59it/s]Normalizing and saving training data:  82%|#############   | 360/440 [00:22<00:05, 15.58it/s]Normalizing and saving training data:  84%|#############4  | 370/440 [00:23<00:04, 15.59it/s]Normalizing and saving training data:  86%|#############8  | 380/440 [00:24<00:03, 15.52it/s]Normalizing and saving training data:  89%|##############1 | 390/440 [00:24<00:03, 15.44it/s]Normalizing and saving training data:  91%|##############5 | 400/440 [00:25<00:02, 15.48it/s]Normalizing and saving training data:  93%|##############9 | 410/440 [00:26<00:01, 15.43it/s]Normalizing and saving training data:  95%|###############2| 420/440 [00:26<00:01, 15.46it/s]Normalizing and saving training data:  98%|###############6| 430/440 [00:27<00:00, 15.46it/s]Normalizing and saving training data: 100%|################| 440/440 [00:28<00:00, 15.48it/s]Normalizing and saving training data: 100%|################| 440/440 [00:28<00:00, 15.65it/s]
2025-11-19 19:22:26,497 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:22:26,504 - INFO - Loaded normalization statistics:
2025-11-19 19:22:26,504 - INFO -   Mean: 0.412241
2025-11-19 19:22:26,504 - INFO -   Std: 2.458303
2025-11-19 19:22:26,504 - INFO - Split train already completed, skipping
2025-11-19 19:22:26,504 - INFO - Processing test split...
2025-11-19 19:22:26,504 - INFO - Need to process 32/32 sequences for test
2025-11-19 19:22:26,504 - INFO - Processing 32 sequences from 13 unique files
2025-11-19 19:22:26,504 - INFO - Average 2.5 sequences per file
Processing test:   0%|                                                | 0/32 [00:00<?, ?it/s]Processing test:   3%|#2                                      | 1/32 [00:00<00:11,  2.76it/s]Processing test:   6%|##5                                     | 2/32 [00:00<00:12,  2.39it/s]2025-11-19 19:22:27,326 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold3\test_dataset.h5
2025-11-19 19:22:28,338 - INFO - Progress: 457/472 (96.8%) - ETA: 0.0 minutes
Processing test:  56%|#####################9                 | 18/32 [00:02<00:02,  6.78it/s]Processing test:  62%|########################3              | 20/32 [00:03<00:01,  6.90it/s]Processing test:  66%|#########################5             | 21/32 [00:03<00:02,  4.75it/s]Processing test:  72%|############################           | 23/32 [00:05<00:02,  3.21it/s]Processing test:  78%|##############################4        | 25/32 [00:05<00:01,  3.72it/s]Processing test:  81%|###############################6       | 26/32 [00:05<00:01,  3.75it/s]Processing test:  84%|################################9      | 27/32 [00:06<00:01,  3.79it/s]2025-11-19 19:22:33,240 - INFO - Progress: 467/472 (98.9%) - ETA: 0.0 minutes
Processing test:  88%|##################################1    | 28/32 [00:06<00:01,  2.63it/s]Processing test:  91%|###################################3   | 29/32 [00:07<00:01,  2.76it/s]Processing test:  97%|#####################################7 | 31/32 [00:07<00:00,  3.67it/s]Processing test: 100%|#######################################| 32/32 [00:07<00:00,  3.77it/s]Processing test: 100%|#######################################| 32/32 [00:07<00:00,  4.12it/s]
2025-11-19 19:22:34,626 - INFO - Validating final datasets...
2025-11-19 19:22:34,634 - INFO - train dataset validation:
2025-11-19 19:22:34,634 - INFO -   - Segments: 440
2025-11-19 19:22:34,634 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:22:34,634 - INFO -   - Classes: 220 preictal, 220 interictal
2025-11-19 19:22:34,634 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:22:34,639 - INFO - test dataset validation:
2025-11-19 19:22:34,639 - INFO -   - Segments: 32
2025-11-19 19:22:34,639 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:22:34,639 - INFO -   - Classes: 16 preictal, 16 interictal
2025-11-19 19:22:34,639 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:22:34,639 - INFO - ============================================================
2025-11-19 19:22:34,639 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:22:34,639 - INFO - Total time: 1.1 minutes
2025-11-19 19:22:34,639 - INFO - Processed segments: 472
2025-11-19 19:22:34,639 - INFO - Average rate: 6.9 segments/second
2025-11-19 19:22:34,639 - INFO - ============================================================
✅ Fold 3 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 4/11
============================================================
2025-11-19 19:22:34,714 - INFO - ============================================================
2025-11-19 19:22:34,714 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:22:34,714 - INFO - ============================================================
2025-11-19 19:22:34,714 - INFO - Output prefix: chb13_fold4
2025-11-19 19:22:34,714 - INFO - EEG Preprocessor initialized
2025-11-19 19:22:34,714 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:22:34,714 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:22:34,714 - INFO - Segment duration: 5 seconds
2025-11-19 19:22:34,714 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:22:34,714 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:22:34,714 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:22:34,714 - INFO - Loading segments from chb13_fold4_sequences_prediction.json
2025-11-19 19:22:34,728 - INFO - Loaded 472 total sequences
2025-11-19 19:22:34,728 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:22:34,728 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:22:34,728 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:22:34,728 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:22:34,728 - INFO - train: 446 sequences (223 preictal, 223 interictal)
2025-11-19 19:22:34,728 - INFO - test: 26 sequences (13 preictal, 13 interictal)
2025-11-19 19:22:34,752 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:22:34,753 - INFO - train: kept 223 preictal and 223 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:22:34,753 - INFO - test: kept 13 preictal and 13 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:22:34,786 - INFO - ============================================================
2025-11-19 19:22:34,786 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:22:34,786 - INFO - ============================================================
2025-11-19 19:22:34,786 - INFO - Processing 446 training samples to compute normalization stats...
2025-11-19 19:22:34,787 - INFO - Processing 446 sequences from 29 unique files
Processing training data:   0%|                                      | 0/446 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/446 [00:01<08:58,  1.21s/it]Processing training data:  15%|####2                        | 66/446 [00:02<00:12, 29.78it/s]Processing training data:  18%|#####2                       | 80/446 [00:03<00:17, 20.73it/s]Processing training data:  20%|#####9                       | 91/446 [00:05<00:22, 15.75it/s]Processing training data:  24%|######6                     | 106/446 [00:05<00:18, 17.93it/s]Processing training data:  29%|########1                   | 130/446 [00:07<00:17, 17.88it/s]Processing training data:  31%|########7                   | 139/446 [00:08<00:21, 14.01it/s]Processing training data:  33%|#########2                  | 148/446 [00:09<00:25, 11.48it/s]Processing training data:  36%|#########9                  | 159/446 [00:10<00:21, 13.10it/s]Processing training data:  40%|###########2                | 179/446 [00:10<00:14, 17.91it/s]Processing training data:  45%|############5               | 200/446 [00:12<00:14, 17.18it/s]Processing training data:  47%|#############2              | 211/446 [00:13<00:15, 15.37it/s]Processing training data:  50%|##############              | 223/446 [00:14<00:17, 12.84it/s]Processing training data:  53%|##############8             | 236/446 [00:14<00:13, 15.40it/s]Processing training data:  57%|###############8            | 252/446 [00:16<00:13, 14.10it/s]Processing training data:  59%|################5           | 263/446 [00:17<00:14, 12.20it/s]Processing training data:  61%|#################           | 272/446 [00:17<00:12, 13.43it/s]Processing training data:  65%|##################2         | 290/446 [00:19<00:11, 13.46it/s]Processing training data:  68%|##################9         | 302/446 [00:19<00:09, 15.31it/s]Processing training data:  72%|####################2       | 322/446 [00:20<00:07, 15.98it/s]Processing training data:  74%|####################7       | 330/446 [00:22<00:09, 12.16it/s]Processing training data:  78%|#####################7      | 347/446 [00:23<00:08, 12.09it/s]Processing training data:  80%|######################3     | 356/446 [00:24<00:06, 13.02it/s]Processing training data:  84%|#######################6    | 376/446 [00:25<00:05, 13.85it/s]Processing training data:  86%|########################1   | 385/446 [00:26<00:05, 11.72it/s]Processing training data:  89%|########################9   | 397/446 [00:27<00:03, 13.79it/s]Processing training data:  93%|##########################1 | 416/446 [00:28<00:02, 13.29it/s]Processing training data:  96%|##########################8 | 428/446 [00:30<00:01, 11.92it/s]Processing training data:  99%|###########################6| 440/446 [00:31<00:00, 10.97it/s]Processing training data: 100%|############################| 446/446 [00:31<00:00, 14.22it/s]
2025-11-19 19:23:06,145 - INFO - Computing normalization statistics from training data...
2025-11-19 19:23:06,831 - INFO - Normalization stats computed:
2025-11-19 19:23:06,831 - INFO -   Mean: 0.337285
2025-11-19 19:23:06,831 - INFO -   Std: 2.450552
2025-11-19 19:23:06,831 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold4\normalization_stats.json
2025-11-19 19:23:06,891 - INFO - Applying normalization and saving 446 training sequences...
Normalizing and saving training data:   0%|                          | 0/446 [00:00<?, ?it/s]2025-11-19 19:23:06,900 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold4\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/446 [00:00<00:27, 15.58it/s]Normalizing and saving training data:   4%|7                | 20/446 [00:01<00:27, 15.77it/s]Normalizing and saving training data:   7%|#1               | 30/446 [00:01<00:26, 15.87it/s]Normalizing and saving training data:   9%|#5               | 40/446 [00:02<00:25, 15.86it/s]Normalizing and saving training data:  11%|#9               | 50/446 [00:03<00:24, 15.90it/s]Normalizing and saving training data:  13%|##2              | 60/446 [00:03<00:24, 15.86it/s]Normalizing and saving training data:  16%|##6              | 70/446 [00:04<00:23, 15.86it/s]Normalizing and saving training data:  18%|###              | 80/446 [00:05<00:23, 15.91it/s]Normalizing and saving training data:  20%|###4             | 90/446 [00:05<00:22, 15.91it/s]Normalizing and saving training data:  22%|###5            | 100/446 [00:06<00:21, 15.89it/s]Normalizing and saving training data:  25%|###9            | 110/446 [00:06<00:21, 15.91it/s]Normalizing and saving training data:  27%|####3           | 120/446 [00:07<00:20, 15.95it/s]Normalizing and saving training data:  29%|####6           | 130/446 [00:08<00:19, 15.94it/s]Normalizing and saving training data:  31%|#####           | 140/446 [00:08<00:19, 15.92it/s]Normalizing and saving training data:  34%|#####3          | 150/446 [00:09<00:18, 15.88it/s]Normalizing and saving training data:  36%|#####7          | 160/446 [00:10<00:18, 15.87it/s]Normalizing and saving training data:  38%|######          | 170/446 [00:10<00:17, 15.84it/s]Normalizing and saving training data:  40%|######4         | 180/446 [00:11<00:16, 15.86it/s]Normalizing and saving training data:  43%|######8         | 190/446 [00:11<00:16, 15.84it/s]Normalizing and saving training data:  45%|#######1        | 200/446 [00:12<00:15, 15.81it/s]Normalizing and saving training data:  47%|#######5        | 210/446 [00:13<00:14, 15.78it/s]Normalizing and saving training data:  49%|#######8        | 220/446 [00:13<00:14, 15.72it/s]Normalizing and saving training data:  52%|########2       | 230/446 [00:14<00:13, 15.61it/s]Normalizing and saving training data:  54%|########6       | 240/446 [00:15<00:13, 15.67it/s]Normalizing and saving training data:  56%|########9       | 250/446 [00:15<00:12, 15.62it/s]Normalizing and saving training data:  58%|#########3      | 260/446 [00:16<00:11, 15.68it/s]Normalizing and saving training data:  61%|#########6      | 270/446 [00:17<00:11, 15.67it/s]Normalizing and saving training data:  63%|##########      | 280/446 [00:17<00:10, 15.67it/s]Normalizing and saving training data:  65%|##########4     | 290/446 [00:18<00:09, 15.69it/s]Normalizing and saving training data:  67%|##########7     | 300/446 [00:18<00:09, 15.70it/s]Normalizing and saving training data:  70%|###########1    | 310/446 [00:19<00:08, 15.71it/s]Normalizing and saving training data:  72%|###########4    | 320/446 [00:20<00:08, 15.73it/s]Normalizing and saving training data:  74%|###########8    | 330/446 [00:20<00:07, 15.75it/s]Normalizing and saving training data:  76%|############1   | 340/446 [00:21<00:06, 15.76it/s]Normalizing and saving training data:  78%|############5   | 350/446 [00:22<00:06, 15.77it/s]Normalizing and saving training data:  81%|############9   | 360/446 [00:22<00:05, 15.70it/s]Normalizing and saving training data:  83%|#############2  | 370/446 [00:23<00:04, 15.67it/s]Normalizing and saving training data:  85%|#############6  | 380/446 [00:24<00:04, 15.64it/s]Normalizing and saving training data:  87%|#############9  | 390/446 [00:24<00:03, 15.67it/s]Normalizing and saving training data:  90%|##############3 | 400/446 [00:25<00:02, 15.65it/s]Normalizing and saving training data:  92%|##############7 | 410/446 [00:25<00:02, 15.71it/s]Normalizing and saving training data:  94%|############### | 420/446 [00:26<00:01, 15.65it/s]Normalizing and saving training data:  96%|###############4| 430/446 [00:27<00:01, 15.69it/s]Normalizing and saving training data:  99%|###############7| 440/446 [00:27<00:00, 15.74it/s]Normalizing and saving training data: 100%|################| 446/446 [00:27<00:00, 15.98it/s]
2025-11-19 19:23:35,211 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:23:35,218 - INFO - Loaded normalization statistics:
2025-11-19 19:23:35,218 - INFO -   Mean: 0.337285
2025-11-19 19:23:35,218 - INFO -   Std: 2.450552
2025-11-19 19:23:35,218 - INFO - Split train already completed, skipping
2025-11-19 19:23:35,218 - INFO - Processing test split...
2025-11-19 19:23:35,219 - INFO - Need to process 26/26 sequences for test
2025-11-19 19:23:35,219 - INFO - Processing 26 sequences from 10 unique files
2025-11-19 19:23:35,219 - INFO - Average 2.6 sequences per file
Processing test:   0%|                                                | 0/26 [00:00<?, ?it/s]Processing test:   4%|#5                                      | 1/26 [00:00<00:12,  1.99it/s]2025-11-19 19:23:35,722 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold4\test_dataset.h5
2025-11-19 19:23:36,506 - INFO - Progress: 459/472 (97.2%) - ETA: 0.0 minutes
Processing test:  54%|#####################                  | 14/26 [00:01<00:01,  9.46it/s]Processing test:  58%|######################4                | 15/26 [00:02<00:01,  6.04it/s]Processing test:  65%|#########################5             | 17/26 [00:02<00:01,  6.35it/s]Processing test:  69%|###########################            | 18/26 [00:03<00:02,  3.72it/s]Processing test:  81%|###############################5       | 21/26 [00:03<00:01,  4.91it/s]Processing test:  85%|#################################      | 22/26 [00:04<00:00,  4.24it/s]2025-11-19 19:23:40,124 - INFO - Progress: 469/472 (99.4%) - ETA: 0.0 minutes
Processing test:  92%|####################################   | 24/26 [00:05<00:00,  3.40it/s]Processing test:  96%|#####################################5 | 25/26 [00:05<00:00,  3.50it/s]Processing test: 100%|#######################################| 26/26 [00:05<00:00,  3.61it/s]Processing test: 100%|#######################################| 26/26 [00:05<00:00,  4.61it/s]
2025-11-19 19:23:41,093 - INFO - Validating final datasets...
2025-11-19 19:23:41,100 - INFO - train dataset validation:
2025-11-19 19:23:41,100 - INFO -   - Segments: 446
2025-11-19 19:23:41,100 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:23:41,100 - INFO -   - Classes: 223 preictal, 223 interictal
2025-11-19 19:23:41,100 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:23:41,105 - INFO - test dataset validation:
2025-11-19 19:23:41,105 - INFO -   - Segments: 26
2025-11-19 19:23:41,105 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:23:41,105 - INFO -   - Classes: 13 preictal, 13 interictal
2025-11-19 19:23:41,105 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:23:41,106 - INFO - ============================================================
2025-11-19 19:23:41,106 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:23:41,106 - INFO - Total time: 1.1 minutes
2025-11-19 19:23:41,106 - INFO - Processed segments: 472
2025-11-19 19:23:41,106 - INFO - Average rate: 7.1 segments/second
2025-11-19 19:23:41,106 - INFO - ============================================================
✅ Fold 4 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 5/11
============================================================
2025-11-19 19:23:41,177 - INFO - ============================================================
2025-11-19 19:23:41,177 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:23:41,177 - INFO - ============================================================
2025-11-19 19:23:41,177 - INFO - Output prefix: chb13_fold5
2025-11-19 19:23:41,177 - INFO - EEG Preprocessor initialized
2025-11-19 19:23:41,177 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:23:41,177 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:23:41,177 - INFO - Segment duration: 5 seconds
2025-11-19 19:23:41,177 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:23:41,177 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:23:41,177 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:23:41,177 - INFO - Loading segments from chb13_fold5_sequences_prediction.json
2025-11-19 19:23:41,192 - INFO - Loaded 472 total sequences
2025-11-19 19:23:41,192 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:23:41,192 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:23:41,192 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:23:41,192 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:23:41,192 - INFO - train: 434 sequences (217 preictal, 217 interictal)
2025-11-19 19:23:41,192 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-19 19:23:41,216 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:23:41,216 - INFO - train: kept 217 preictal and 217 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:23:41,217 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:23:41,241 - INFO - ============================================================
2025-11-19 19:23:41,241 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:23:41,241 - INFO - ============================================================
2025-11-19 19:23:41,241 - INFO - Processing 434 training samples to compute normalization stats...
2025-11-19 19:23:41,241 - INFO - Processing 434 sequences from 29 unique files
Processing training data:   0%|                                      | 0/434 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/434 [00:00<03:58,  1.82it/s]Processing training data:   5%|#4                           | 22/434 [00:01<00:34, 12.03it/s]Processing training data:   8%|##3                          | 35/434 [00:03<00:37, 10.55it/s]Processing training data:  12%|###4                         | 51/434 [00:03<00:24, 15.60it/s]Processing training data:  15%|####4                        | 67/434 [00:05<00:26, 13.63it/s]Processing training data:  18%|#####2                       | 78/434 [00:06<00:29, 11.98it/s]Processing training data:  33%|#########2                  | 143/434 [00:07<00:11, 26.25it/s]Processing training data:  35%|#########8                  | 152/434 [00:08<00:11, 25.39it/s]Processing training data:  39%|##########9                 | 170/434 [00:09<00:12, 20.63it/s]Processing training data:  42%|###########7                | 182/434 [00:10<00:15, 16.46it/s]Processing training data:  44%|############2               | 190/434 [00:11<00:14, 16.99it/s]Processing training data:  47%|#############               | 203/434 [00:12<00:16, 14.35it/s]Processing training data:  49%|#############6              | 211/434 [00:13<00:18, 12.05it/s]Processing training data:  51%|##############2             | 221/434 [00:14<00:15, 13.45it/s]Processing training data:  56%|###############5            | 241/434 [00:14<00:10, 18.83it/s]Processing training data:  60%|################8           | 261/434 [00:15<00:10, 17.10it/s]Processing training data:  63%|#################6          | 273/434 [00:16<00:10, 15.49it/s]Processing training data:  65%|##################1         | 282/434 [00:18<00:12, 12.03it/s]Processing training data:  68%|###################         | 295/434 [00:18<00:09, 14.09it/s]Processing training data:  74%|####################5       | 319/434 [00:19<00:05, 20.53it/s]Processing training data:  78%|#####################8      | 339/434 [00:20<00:05, 17.64it/s]Processing training data:  80%|######################4     | 348/434 [00:22<00:06, 13.22it/s]Processing training data:  82%|######################9     | 356/434 [00:23<00:06, 11.24it/s]Processing training data:  85%|#######################8    | 369/434 [00:24<00:05, 10.95it/s]Processing training data:  88%|########################5   | 381/434 [00:25<00:05, 10.42it/s]Processing training data:  91%|#########################4  | 394/434 [00:27<00:03, 10.10it/s]Processing training data:  92%|#########################8  | 400/434 [00:28<00:04,  8.39it/s]Processing training data:  95%|##########################5 | 412/434 [00:29<00:02,  8.82it/s]Processing training data:  97%|###########################1| 421/434 [00:31<00:01,  7.99it/s]Processing training data: 100%|############################| 434/434 [00:31<00:00, 13.89it/s]
2025-11-19 19:24:12,476 - INFO - Computing normalization statistics from training data...
2025-11-19 19:24:13,133 - INFO - Normalization stats computed:
2025-11-19 19:24:13,134 - INFO -   Mean: 0.335414
2025-11-19 19:24:13,134 - INFO -   Std: 2.450044
2025-11-19 19:24:13,134 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold5\normalization_stats.json
2025-11-19 19:24:13,193 - INFO - Applying normalization and saving 434 training sequences...
Normalizing and saving training data:   0%|                          | 0/434 [00:00<?, ?it/s]2025-11-19 19:24:13,200 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold5\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/434 [00:00<00:28, 15.01it/s]Normalizing and saving training data:   5%|7                | 20/434 [00:01<00:26, 15.54it/s]Normalizing and saving training data:   7%|#1               | 30/434 [00:01<00:25, 15.77it/s]Normalizing and saving training data:   9%|#5               | 40/434 [00:02<00:24, 15.86it/s]Normalizing and saving training data:  12%|#9               | 50/434 [00:03<00:24, 15.92it/s]Normalizing and saving training data:  14%|##3              | 60/434 [00:03<00:23, 15.97it/s]Normalizing and saving training data:  16%|##7              | 70/434 [00:04<00:22, 15.99it/s]Normalizing and saving training data:  18%|###1             | 80/434 [00:05<00:22, 16.01it/s]Normalizing and saving training data:  21%|###5             | 90/434 [00:05<00:21, 16.02it/s]Normalizing and saving training data:  23%|###6            | 100/434 [00:06<00:20, 16.00it/s]Normalizing and saving training data:  25%|####            | 110/434 [00:06<00:20, 16.03it/s]Normalizing and saving training data:  28%|####4           | 120/434 [00:07<00:19, 16.04it/s]Normalizing and saving training data:  30%|####7           | 130/434 [00:08<00:18, 16.03it/s]Normalizing and saving training data:  32%|#####1          | 140/434 [00:08<00:18, 15.94it/s]Normalizing and saving training data:  35%|#####5          | 150/434 [00:09<00:17, 15.89it/s]Normalizing and saving training data:  37%|#####8          | 160/434 [00:10<00:17, 15.89it/s]Normalizing and saving training data:  39%|######2         | 170/434 [00:10<00:16, 15.85it/s]Normalizing and saving training data:  41%|######6         | 180/434 [00:11<00:16, 15.81it/s]Normalizing and saving training data:  44%|#######         | 190/434 [00:11<00:15, 15.84it/s]Normalizing and saving training data:  46%|#######3        | 200/434 [00:12<00:14, 15.83it/s]Normalizing and saving training data:  48%|#######7        | 210/434 [00:13<00:14, 15.83it/s]Normalizing and saving training data:  51%|########1       | 220/434 [00:13<00:13, 15.84it/s]Normalizing and saving training data:  53%|########4       | 230/434 [00:14<00:12, 15.84it/s]Normalizing and saving training data:  55%|########8       | 240/434 [00:15<00:12, 15.85it/s]Normalizing and saving training data:  58%|#########2      | 250/434 [00:15<00:11, 15.85it/s]Normalizing and saving training data:  60%|#########5      | 260/434 [00:16<00:11, 15.80it/s]Normalizing and saving training data:  62%|#########9      | 270/434 [00:17<00:10, 15.82it/s]Normalizing and saving training data:  65%|##########3     | 280/434 [00:17<00:09, 15.80it/s]Normalizing and saving training data:  67%|##########6     | 290/434 [00:18<00:09, 15.82it/s]Normalizing and saving training data:  69%|###########     | 300/434 [00:18<00:08, 15.83it/s]Normalizing and saving training data:  71%|###########4    | 310/434 [00:19<00:07, 15.79it/s]Normalizing and saving training data:  74%|###########7    | 320/434 [00:20<00:07, 15.75it/s]Normalizing and saving training data:  76%|############1   | 330/434 [00:20<00:06, 15.64it/s]Normalizing and saving training data:  78%|############5   | 340/434 [00:21<00:05, 15.70it/s]Normalizing and saving training data:  81%|############9   | 350/434 [00:22<00:05, 15.75it/s]Normalizing and saving training data:  83%|#############2  | 360/434 [00:22<00:04, 15.77it/s]Normalizing and saving training data:  85%|#############6  | 370/434 [00:23<00:04, 15.79it/s]Normalizing and saving training data:  88%|##############  | 380/434 [00:23<00:03, 15.81it/s]Normalizing and saving training data:  90%|##############3 | 390/434 [00:24<00:02, 15.77it/s]Normalizing and saving training data:  92%|##############7 | 400/434 [00:25<00:02, 15.78it/s]Normalizing and saving training data:  94%|###############1| 410/434 [00:25<00:01, 15.75it/s]Normalizing and saving training data:  97%|###############4| 420/434 [00:26<00:00, 15.74it/s]Normalizing and saving training data:  99%|###############8| 430/434 [00:27<00:00, 15.76it/s]Normalizing and saving training data: 100%|################| 434/434 [00:27<00:00, 15.98it/s]
2025-11-19 19:24:40,653 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:24:40,659 - INFO - Loaded normalization statistics:
2025-11-19 19:24:40,660 - INFO -   Mean: 0.335414
2025-11-19 19:24:40,660 - INFO -   Std: 2.450044
2025-11-19 19:24:40,660 - INFO - Split train already completed, skipping
2025-11-19 19:24:40,660 - INFO - Processing test split...
2025-11-19 19:24:40,660 - INFO - Need to process 38/38 sequences for test
2025-11-19 19:24:40,660 - INFO - Processing 38 sequences from 14 unique files
2025-11-19 19:24:40,660 - INFO - Average 2.7 sequences per file
Processing test:   0%|                                                | 0/38 [00:00<?, ?it/s]Processing test:   3%|#                                       | 1/38 [00:00<00:21,  1.68it/s]2025-11-19 19:24:41,255 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold5\test_dataset.h5
2025-11-19 19:24:42,392 - INFO - Progress: 453/472 (96.0%) - ETA: 0.0 minutes
Processing test:  53%|####################5                  | 20/38 [00:02<00:01, 10.75it/s]Processing test:  55%|#####################5                 | 21/38 [00:02<00:02,  7.25it/s]Processing test:  63%|########################6              | 24/38 [00:03<00:01,  7.78it/s]Processing test:  66%|#########################6             | 25/38 [00:03<00:01,  7.18it/s]Processing test:  68%|##########################6            | 26/38 [00:03<00:01,  6.41it/s]Processing test:  71%|###########################7           | 27/38 [00:04<00:02,  3.94it/s]Processing test:  76%|#############################7         | 29/38 [00:04<00:02,  3.78it/s]2025-11-19 19:24:46,308 - INFO - Progress: 464/472 (98.3%) - ETA: 0.0 minutes
Processing test:  82%|###############################8       | 31/38 [00:05<00:02,  3.10it/s]Processing test:  84%|################################8      | 32/38 [00:06<00:01,  3.25it/s]Processing test:  87%|#################################8     | 33/38 [00:06<00:01,  2.92it/s]Processing test:  92%|###################################9   | 35/38 [00:06<00:00,  3.80it/s]Processing test:  95%|####################################9  | 36/38 [00:07<00:00,  3.57it/s]Processing test: 100%|#######################################| 38/38 [00:07<00:00,  4.48it/s]Processing test: 100%|#######################################| 38/38 [00:07<00:00,  5.10it/s]
2025-11-19 19:24:48,646 - INFO - Validating final datasets...
2025-11-19 19:24:48,654 - INFO - train dataset validation:
2025-11-19 19:24:48,654 - INFO -   - Segments: 434
2025-11-19 19:24:48,654 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:24:48,654 - INFO -   - Classes: 217 preictal, 217 interictal
2025-11-19 19:24:48,654 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:24:48,659 - INFO - test dataset validation:
2025-11-19 19:24:48,659 - INFO -   - Segments: 38
2025-11-19 19:24:48,659 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:24:48,659 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-19 19:24:48,659 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:24:48,659 - INFO - ============================================================
2025-11-19 19:24:48,659 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:24:48,659 - INFO - Total time: 1.1 minutes
2025-11-19 19:24:48,659 - INFO - Processed segments: 472
2025-11-19 19:24:48,659 - INFO - Average rate: 7.0 segments/second
2025-11-19 19:24:48,659 - INFO - ============================================================
✅ Fold 5 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 6/11
============================================================
2025-11-19 19:24:48,723 - INFO - ============================================================
2025-11-19 19:24:48,723 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:24:48,723 - INFO - ============================================================
2025-11-19 19:24:48,723 - INFO - Output prefix: chb13_fold6
2025-11-19 19:24:48,723 - INFO - EEG Preprocessor initialized
2025-11-19 19:24:48,723 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:24:48,723 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:24:48,723 - INFO - Segment duration: 5 seconds
2025-11-19 19:24:48,723 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:24:48,723 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:24:48,723 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:24:48,724 - INFO - Loading segments from chb13_fold6_sequences_prediction.json
2025-11-19 19:24:48,738 - INFO - Loaded 472 total sequences
2025-11-19 19:24:48,738 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:24:48,738 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:24:48,738 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:24:48,738 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:24:48,738 - INFO - train: 430 sequences (215 preictal, 215 interictal)
2025-11-19 19:24:48,738 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-19 19:24:48,762 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:24:48,762 - INFO - train: kept 215 preictal and 215 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:24:48,762 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:24:48,786 - INFO - ============================================================
2025-11-19 19:24:48,786 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:24:48,786 - INFO - ============================================================
2025-11-19 19:24:48,786 - INFO - Processing 430 training samples to compute normalization stats...
2025-11-19 19:24:48,787 - INFO - Processing 430 sequences from 28 unique files
Processing training data:   0%|                                      | 0/430 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/430 [00:01<07:23,  1.03s/it]Processing training data:   2%|5                             | 8/430 [00:02<01:44,  4.05it/s]Processing training data:   4%|#                            | 16/430 [00:03<01:18,  5.28it/s]Processing training data:  19%|#####4                       | 81/430 [00:04<00:13, 25.70it/s]Processing training data:  21%|######2                      | 92/430 [00:05<00:18, 18.40it/s]Processing training data:  25%|######9                     | 106/430 [00:07<00:19, 16.50it/s]Processing training data:  32%|########9                   | 138/430 [00:08<00:15, 18.52it/s]Processing training data:  35%|#########8                  | 152/430 [00:08<00:13, 20.45it/s]Processing training data:  39%|##########9                 | 168/430 [00:09<00:11, 22.73it/s]Processing training data:  44%|############2               | 188/430 [00:10<00:11, 20.49it/s]Processing training data:  47%|#############               | 201/430 [00:11<00:13, 16.69it/s]Processing training data:  49%|#############7              | 211/430 [00:13<00:15, 14.16it/s]Processing training data:  52%|##############4             | 222/430 [00:13<00:13, 15.53it/s]Processing training data:  56%|###############7            | 242/430 [00:14<00:12, 15.17it/s]Processing training data:  59%|################4           | 253/430 [00:16<00:13, 12.68it/s]Processing training data:  62%|#################2          | 265/430 [00:17<00:14, 11.33it/s]Processing training data:  65%|##################2         | 280/430 [00:18<00:13, 11.31it/s]Processing training data:  68%|##################9         | 291/430 [00:20<00:13, 10.40it/s]Processing training data:  70%|###################6        | 302/430 [00:21<00:12,  9.94it/s]Processing training data:  72%|####################1       | 310/430 [00:21<00:11, 10.85it/s]Processing training data:  77%|#####################4      | 330/430 [00:22<00:06, 16.30it/s]Processing training data:  81%|######################6     | 348/430 [00:23<00:05, 15.12it/s]Processing training data:  85%|#######################7    | 364/430 [00:24<00:04, 14.68it/s]Processing training data:  86%|########################1   | 371/430 [00:25<00:04, 14.29it/s]Processing training data:  92%|#########################7  | 395/430 [00:26<00:02, 16.28it/s]Processing training data:  93%|##########################1 | 402/430 [00:27<00:02, 12.71it/s]Processing training data:  96%|##########################7 | 411/430 [00:29<00:01, 10.83it/s]Processing training data:  98%|###########################3| 420/430 [00:30<00:01,  9.60it/s]Processing training data: 100%|############################| 430/430 [00:30<00:00, 14.15it/s]
2025-11-19 19:25:19,183 - INFO - Computing normalization statistics from training data...
2025-11-19 19:25:19,850 - INFO - Normalization stats computed:
2025-11-19 19:25:19,851 - INFO -   Mean: 0.417622
2025-11-19 19:25:19,851 - INFO -   Std: 2.464645
2025-11-19 19:25:19,851 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold6\normalization_stats.json
2025-11-19 19:25:19,909 - INFO - Applying normalization and saving 430 training sequences...
Normalizing and saving training data:   0%|                          | 0/430 [00:00<?, ?it/s]2025-11-19 19:25:19,916 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold6\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/430 [00:00<00:26, 15.92it/s]Normalizing and saving training data:   5%|7                | 20/430 [00:01<00:25, 15.97it/s]Normalizing and saving training data:   7%|#1               | 30/430 [00:01<00:25, 15.96it/s]Normalizing and saving training data:   9%|#5               | 40/430 [00:02<00:24, 15.99it/s]Normalizing and saving training data:  12%|#9               | 50/430 [00:03<00:23, 16.03it/s]Normalizing and saving training data:  14%|##3              | 60/430 [00:03<00:23, 16.03it/s]Normalizing and saving training data:  16%|##7              | 70/430 [00:04<00:22, 16.05it/s]Normalizing and saving training data:  19%|###1             | 80/430 [00:04<00:21, 16.03it/s]Normalizing and saving training data:  21%|###5             | 90/430 [00:05<00:21, 16.04it/s]Normalizing and saving training data:  23%|###7            | 100/430 [00:06<00:20, 16.04it/s]Normalizing and saving training data:  26%|####            | 110/430 [00:06<00:19, 16.04it/s]Normalizing and saving training data:  28%|####4           | 120/430 [00:07<00:19, 16.06it/s]Normalizing and saving training data:  30%|####8           | 130/430 [00:08<00:18, 16.03it/s]Normalizing and saving training data:  33%|#####2          | 140/430 [00:08<00:18, 15.99it/s]Normalizing and saving training data:  35%|#####5          | 150/430 [00:09<00:17, 16.00it/s]Normalizing and saving training data:  37%|#####9          | 160/430 [00:10<00:17, 15.83it/s]Normalizing and saving training data:  40%|######3         | 170/430 [00:10<00:16, 15.84it/s]Normalizing and saving training data:  42%|######6         | 180/430 [00:11<00:15, 15.87it/s]Normalizing and saving training data:  44%|#######         | 190/430 [00:11<00:15, 15.86it/s]Normalizing and saving training data:  47%|#######4        | 200/430 [00:12<00:14, 15.87it/s]Normalizing and saving training data:  49%|#######8        | 210/430 [00:13<00:13, 15.90it/s]Normalizing and saving training data:  51%|########1       | 220/430 [00:13<00:13, 15.90it/s]Normalizing and saving training data:  53%|########5       | 230/430 [00:14<00:12, 15.85it/s]Normalizing and saving training data:  56%|########9       | 240/430 [00:15<00:12, 15.71it/s]Normalizing and saving training data:  58%|#########3      | 250/430 [00:15<00:11, 15.67it/s]Normalizing and saving training data:  60%|#########6      | 260/430 [00:16<00:11, 15.43it/s]Normalizing and saving training data:  63%|##########      | 270/430 [00:17<00:10, 15.16it/s]Normalizing and saving training data:  65%|##########4     | 280/430 [00:17<00:09, 15.23it/s]Normalizing and saving training data:  67%|##########7     | 290/430 [00:18<00:09, 14.88it/s]Normalizing and saving training data:  70%|###########1    | 300/430 [00:19<00:08, 14.95it/s]Normalizing and saving training data:  72%|###########5    | 310/430 [00:19<00:07, 15.04it/s]Normalizing and saving training data:  74%|###########9    | 320/430 [00:20<00:07, 15.10it/s]Normalizing and saving training data:  77%|############2   | 330/430 [00:21<00:06, 15.17it/s]Normalizing and saving training data:  79%|############6   | 340/430 [00:21<00:05, 15.24it/s]Normalizing and saving training data:  81%|#############   | 350/430 [00:22<00:05, 15.35it/s]Normalizing and saving training data:  84%|#############3  | 360/430 [00:22<00:04, 15.35it/s]Normalizing and saving training data:  86%|#############7  | 370/430 [00:23<00:03, 15.29it/s]Normalizing and saving training data:  88%|##############1 | 380/430 [00:24<00:03, 15.30it/s]Normalizing and saving training data:  91%|##############5 | 390/430 [00:24<00:02, 15.31it/s]Normalizing and saving training data:  93%|##############8 | 400/430 [00:25<00:01, 15.30it/s]Normalizing and saving training data:  95%|###############2| 410/430 [00:26<00:01, 15.29it/s]Normalizing and saving training data:  98%|###############6| 420/430 [00:26<00:00, 15.24it/s]Normalizing and saving training data: 100%|################| 430/430 [00:27<00:00, 15.34it/s]Normalizing and saving training data: 100%|################| 430/430 [00:27<00:00, 15.60it/s]
2025-11-19 19:25:47,508 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:25:47,515 - INFO - Loaded normalization statistics:
2025-11-19 19:25:47,515 - INFO -   Mean: 0.417622
2025-11-19 19:25:47,515 - INFO -   Std: 2.464645
2025-11-19 19:25:47,515 - INFO - Split train already completed, skipping
2025-11-19 19:25:47,515 - INFO - Processing test split...
2025-11-19 19:25:47,515 - INFO - Need to process 42/42 sequences for test
2025-11-19 19:25:47,515 - INFO - Processing 42 sequences from 14 unique files
2025-11-19 19:25:47,515 - INFO - Average 3.0 sequences per file
Processing test:   0%|                                                | 0/42 [00:00<?, ?it/s]Processing test:   2%|9                                       | 1/42 [00:01<00:51,  1.26s/it]Processing test:   7%|##8                                     | 3/42 [00:01<00:22,  1.77it/s]Processing test:  12%|####7                                   | 5/42 [00:02<00:16,  2.25it/s]2025-11-19 19:25:50,084 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold6\test_dataset.h5
2025-11-19 19:25:51,596 - INFO - Progress: 455/472 (96.4%) - ETA: 0.0 minutes
Processing test:  62%|########################1              | 26/42 [00:05<00:02,  6.31it/s]Processing test:  67%|##########################             | 28/42 [00:06<00:03,  4.33it/s]Processing test:  74%|############################7          | 31/42 [00:07<00:02,  4.14it/s]Processing test:  79%|##############################6        | 33/42 [00:07<00:02,  4.48it/s]Processing test:  81%|###############################5       | 34/42 [00:08<00:01,  4.25it/s]2025-11-19 19:25:56,361 - INFO - Progress: 465/472 (98.5%) - ETA: 0.0 minutes
Processing test:  86%|#################################4     | 36/42 [00:09<00:01,  3.60it/s]Processing test:  88%|##################################3    | 37/42 [00:09<00:01,  3.65it/s]Processing test:  90%|###################################2   | 38/42 [00:10<00:01,  2.77it/s]Processing test:  95%|#####################################1 | 40/42 [00:10<00:00,  3.51it/s]Processing test:  98%|###################################### | 41/42 [00:10<00:00,  3.61it/s]Processing test: 100%|#######################################| 42/42 [00:10<00:00,  3.72it/s]Processing test: 100%|#######################################| 42/42 [00:10<00:00,  3.86it/s]
2025-11-19 19:25:58,863 - INFO - Validating final datasets...
2025-11-19 19:25:58,871 - INFO - train dataset validation:
2025-11-19 19:25:58,871 - INFO -   - Segments: 430
2025-11-19 19:25:58,871 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:25:58,871 - INFO -   - Classes: 215 preictal, 215 interictal
2025-11-19 19:25:58,871 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:25:58,876 - INFO - test dataset validation:
2025-11-19 19:25:58,876 - INFO -   - Segments: 42
2025-11-19 19:25:58,876 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:25:58,876 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-19 19:25:58,876 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:25:58,876 - INFO - ============================================================
2025-11-19 19:25:58,876 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:25:58,876 - INFO - Total time: 1.2 minutes
2025-11-19 19:25:58,876 - INFO - Processed segments: 472
2025-11-19 19:25:58,876 - INFO - Average rate: 6.7 segments/second
2025-11-19 19:25:58,876 - INFO - ============================================================
✅ Fold 6 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 7/11
============================================================
2025-11-19 19:25:58,935 - INFO - ============================================================
2025-11-19 19:25:58,935 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:25:58,935 - INFO - ============================================================
2025-11-19 19:25:58,935 - INFO - Output prefix: chb13_fold7
2025-11-19 19:25:58,935 - INFO - EEG Preprocessor initialized
2025-11-19 19:25:58,935 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:25:58,935 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:25:58,935 - INFO - Segment duration: 5 seconds
2025-11-19 19:25:58,936 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:25:58,936 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:25:58,936 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:25:58,936 - INFO - Loading segments from chb13_fold7_sequences_prediction.json
2025-11-19 19:25:58,949 - INFO - Loaded 472 total sequences
2025-11-19 19:25:58,949 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:25:58,949 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:25:58,949 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:25:58,949 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:25:58,949 - INFO - train: 432 sequences (216 preictal, 216 interictal)
2025-11-19 19:25:58,949 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-19 19:25:58,973 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:25:58,974 - INFO - train: kept 216 preictal and 216 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:25:58,974 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:25:58,998 - INFO - ============================================================
2025-11-19 19:25:58,998 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:25:58,998 - INFO - ============================================================
2025-11-19 19:25:58,998 - INFO - Processing 432 training samples to compute normalization stats...
2025-11-19 19:25:58,998 - INFO - Processing 432 sequences from 29 unique files
Processing training data:   0%|                                      | 0/432 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/432 [00:01<08:52,  1.24s/it]Processing training data:  15%|####4                        | 66/432 [00:02<00:12, 30.16it/s]Processing training data:  18%|#####1                       | 76/432 [00:03<00:16, 21.03it/s]Processing training data:  20%|#####8                       | 87/432 [00:04<00:16, 21.06it/s]Processing training data:  25%|#######                     | 108/432 [00:04<00:12, 25.36it/s]Processing training data:  31%|########5                   | 132/432 [00:05<00:09, 32.13it/s]Processing training data:  34%|#########5                  | 148/432 [00:06<00:11, 24.67it/s]Processing training data:  36%|#########9                  | 154/432 [00:07<00:16, 16.45it/s]Processing training data:  38%|##########6                 | 164/432 [00:08<00:21, 12.70it/s]Processing training data:  41%|###########4                | 176/432 [00:10<00:22, 11.26it/s]Processing training data:  43%|############1               | 187/432 [00:11<00:23, 10.23it/s]Processing training data:  46%|############8               | 199/432 [00:12<00:18, 12.56it/s]Processing training data:  50%|##############              | 217/432 [00:13<00:16, 13.05it/s]Processing training data:  53%|##############8             | 229/432 [00:14<00:16, 12.32it/s]Processing training data:  60%|################9           | 261/432 [00:15<00:09, 17.22it/s]Processing training data:  63%|#################7          | 274/432 [00:16<00:10, 14.92it/s]Processing training data:  65%|##################2         | 282/432 [00:18<00:12, 12.25it/s]Processing training data:  68%|##################9         | 293/432 [00:18<00:10, 13.73it/s]Processing training data:  72%|####################2       | 313/432 [00:19<00:08, 14.41it/s]Processing training data:  76%|#####################1      | 327/432 [00:21<00:08, 12.93it/s]Processing training data:  78%|#####################9      | 338/432 [00:21<00:06, 14.37it/s]Processing training data:  83%|#######################2    | 358/432 [00:22<00:04, 15.94it/s]Processing training data:  85%|#######################7    | 366/432 [00:24<00:05, 12.30it/s]Processing training data:  88%|########################5   | 378/432 [00:25<00:04, 11.52it/s]Processing training data:  90%|#########################2  | 389/432 [00:26<00:04, 10.24it/s]Processing training data:  93%|##########################1 | 403/432 [00:27<00:02, 10.81it/s]Processing training data:  95%|##########################6 | 411/432 [00:29<00:02,  9.52it/s]Processing training data:  98%|###########################3| 422/432 [00:30<00:01,  8.97it/s]Processing training data: 100%|############################| 432/432 [00:30<00:00, 11.49it/s]Processing training data: 100%|############################| 432/432 [00:30<00:00, 14.08it/s]
2025-11-19 19:26:29,676 - INFO - Computing normalization statistics from training data...
2025-11-19 19:26:30,321 - INFO - Normalization stats computed:
2025-11-19 19:26:30,321 - INFO -   Mean: 0.406479
2025-11-19 19:26:30,321 - INFO -   Std: 2.454176
2025-11-19 19:26:30,321 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold7\normalization_stats.json
2025-11-19 19:26:30,382 - INFO - Applying normalization and saving 432 training sequences...
Normalizing and saving training data:   0%|                          | 0/432 [00:00<?, ?it/s]2025-11-19 19:26:30,389 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold7\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/432 [00:00<00:27, 15.44it/s]Normalizing and saving training data:   5%|7                | 20/432 [00:01<00:26, 15.45it/s]Normalizing and saving training data:   7%|#1               | 30/432 [00:01<00:25, 15.51it/s]Normalizing and saving training data:   9%|#5               | 40/432 [00:02<00:25, 15.46it/s]Normalizing and saving training data:  12%|#9               | 50/432 [00:03<00:24, 15.48it/s]Normalizing and saving training data:  14%|##3              | 60/432 [00:03<00:24, 15.47it/s]Normalizing and saving training data:  16%|##7              | 70/432 [00:04<00:23, 15.41it/s]Normalizing and saving training data:  19%|###1             | 80/432 [00:05<00:22, 15.41it/s]Normalizing and saving training data:  21%|###5             | 90/432 [00:05<00:22, 15.41it/s]Normalizing and saving training data:  23%|###7            | 100/432 [00:06<00:21, 15.52it/s]Normalizing and saving training data:  25%|####            | 110/432 [00:07<00:20, 15.56it/s]Normalizing and saving training data:  28%|####4           | 120/432 [00:07<00:20, 15.57it/s]Normalizing and saving training data:  30%|####8           | 130/432 [00:08<00:19, 15.58it/s]Normalizing and saving training data:  32%|#####1          | 140/432 [00:09<00:18, 15.52it/s]Normalizing and saving training data:  35%|#####5          | 150/432 [00:09<00:18, 15.54it/s]Normalizing and saving training data:  37%|#####9          | 160/432 [00:10<00:17, 15.52it/s]Normalizing and saving training data:  39%|######2         | 170/432 [00:10<00:16, 15.54it/s]Normalizing and saving training data:  42%|######6         | 180/432 [00:11<00:16, 15.53it/s]Normalizing and saving training data:  44%|#######         | 190/432 [00:12<00:15, 15.54it/s]Normalizing and saving training data:  46%|#######4        | 200/432 [00:12<00:14, 15.50it/s]Normalizing and saving training data:  49%|#######7        | 210/432 [00:13<00:14, 15.50it/s]Normalizing and saving training data:  51%|########1       | 220/432 [00:14<00:13, 15.47it/s]Normalizing and saving training data:  53%|########5       | 230/432 [00:14<00:13, 15.52it/s]Normalizing and saving training data:  56%|########8       | 240/432 [00:15<00:12, 15.49it/s]Normalizing and saving training data:  58%|#########2      | 250/432 [00:16<00:11, 15.48it/s]Normalizing and saving training data:  60%|#########6      | 260/432 [00:16<00:11, 15.53it/s]Normalizing and saving training data:  62%|##########      | 270/432 [00:17<00:10, 15.58it/s]Normalizing and saving training data:  65%|##########3     | 280/432 [00:18<00:09, 15.63it/s]Normalizing and saving training data:  67%|##########7     | 290/432 [00:18<00:09, 15.64it/s]Normalizing and saving training data:  69%|###########1    | 300/432 [00:19<00:08, 15.67it/s]Normalizing and saving training data:  72%|###########4    | 310/432 [00:19<00:07, 15.70it/s]Normalizing and saving training data:  74%|###########8    | 320/432 [00:20<00:07, 15.71it/s]Normalizing and saving training data:  76%|############2   | 330/432 [00:21<00:06, 15.69it/s]Normalizing and saving training data:  79%|############5   | 340/432 [00:21<00:05, 15.66it/s]Normalizing and saving training data:  81%|############9   | 350/432 [00:22<00:05, 15.66it/s]Normalizing and saving training data:  83%|#############3  | 360/432 [00:23<00:04, 15.63it/s]Normalizing and saving training data:  86%|#############7  | 370/432 [00:23<00:03, 15.60it/s]Normalizing and saving training data:  88%|##############  | 380/432 [00:24<00:03, 15.63it/s]Normalizing and saving training data:  90%|##############4 | 390/432 [00:25<00:02, 15.62it/s]Normalizing and saving training data:  93%|##############8 | 400/432 [00:25<00:02, 15.62it/s]Normalizing and saving training data:  95%|###############1| 410/432 [00:26<00:01, 15.62it/s]Normalizing and saving training data:  97%|###############5| 420/432 [00:26<00:00, 15.63it/s]Normalizing and saving training data: 100%|###############9| 430/432 [00:27<00:00, 15.61it/s]Normalizing and saving training data: 100%|################| 432/432 [00:27<00:00, 15.63it/s]
2025-11-19 19:26:58,196 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:26:58,203 - INFO - Loaded normalization statistics:
2025-11-19 19:26:58,203 - INFO -   Mean: 0.406479
2025-11-19 19:26:58,203 - INFO -   Std: 2.454176
2025-11-19 19:26:58,203 - INFO - Split train already completed, skipping
2025-11-19 19:26:58,203 - INFO - Processing test split...
2025-11-19 19:26:58,203 - INFO - Need to process 40/40 sequences for test
2025-11-19 19:26:58,204 - INFO - Processing 40 sequences from 16 unique files
2025-11-19 19:26:58,204 - INFO - Average 2.5 sequences per file
Processing test:   0%|                                                | 0/40 [00:00<?, ?it/s]Processing test:   2%|#                                       | 1/40 [00:00<00:22,  1.70it/s]2025-11-19 19:26:58,792 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold7\test_dataset.h5
2025-11-19 19:26:59,996 - INFO - Progress: 452/472 (95.8%) - ETA: 0.0 minutes
Processing test:  52%|####################4                  | 21/40 [00:02<00:01,  9.74it/s]Processing test:  60%|#######################4               | 24/40 [00:03<00:02,  6.93it/s]Processing test:  65%|#########################3             | 26/40 [00:03<00:02,  6.32it/s]Processing test:  70%|###########################3           | 28/40 [00:04<00:01,  6.58it/s]Processing test:  72%|############################2          | 29/40 [00:04<00:01,  6.20it/s]Processing test:  75%|#############################2         | 30/40 [00:05<00:03,  2.96it/s]2025-11-19 19:27:04,695 - INFO - Progress: 463/472 (98.1%) - ETA: 0.0 minutes
Processing test:  80%|###############################2       | 32/40 [00:06<00:02,  2.68it/s]Processing test:  82%|################################1      | 33/40 [00:06<00:02,  2.87it/s]Processing test:  85%|#################################1     | 34/40 [00:07<00:01,  3.03it/s]Processing test:  88%|##################################1    | 35/40 [00:07<00:01,  3.25it/s]Processing test:  90%|###################################1   | 36/40 [00:07<00:01,  3.43it/s]Processing test:  92%|####################################   | 37/40 [00:07<00:00,  3.62it/s]Processing test:  95%|#####################################  | 38/40 [00:08<00:00,  3.77it/s]Processing test:  98%|###################################### | 39/40 [00:08<00:00,  3.92it/s]Processing test: 100%|#######################################| 40/40 [00:08<00:00,  4.04it/s]Processing test: 100%|#######################################| 40/40 [00:08<00:00,  4.66it/s]
2025-11-19 19:27:07,393 - INFO - Validating final datasets...
2025-11-19 19:27:07,401 - INFO - train dataset validation:
2025-11-19 19:27:07,401 - INFO -   - Segments: 432
2025-11-19 19:27:07,401 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:27:07,401 - INFO -   - Classes: 216 preictal, 216 interictal
2025-11-19 19:27:07,401 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:27:07,406 - INFO - test dataset validation:
2025-11-19 19:27:07,406 - INFO -   - Segments: 40
2025-11-19 19:27:07,406 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:27:07,407 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-19 19:27:07,407 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:27:07,407 - INFO - ============================================================
2025-11-19 19:27:07,407 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:27:07,407 - INFO - Total time: 1.1 minutes
2025-11-19 19:27:07,407 - INFO - Processed segments: 472
2025-11-19 19:27:07,407 - INFO - Average rate: 6.9 segments/second
2025-11-19 19:27:07,407 - INFO - ============================================================
✅ Fold 7 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 8/11
============================================================
2025-11-19 19:27:07,469 - INFO - ============================================================
2025-11-19 19:27:07,469 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:27:07,469 - INFO - ============================================================
2025-11-19 19:27:07,469 - INFO - Output prefix: chb13_fold8
2025-11-19 19:27:07,469 - INFO - EEG Preprocessor initialized
2025-11-19 19:27:07,469 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:27:07,469 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:27:07,469 - INFO - Segment duration: 5 seconds
2025-11-19 19:27:07,469 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:27:07,469 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:27:07,469 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:27:07,470 - INFO - Loading segments from chb13_fold8_sequences_prediction.json
2025-11-19 19:27:07,484 - INFO - Loaded 472 total sequences
2025-11-19 19:27:07,484 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:27:07,484 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:27:07,484 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:27:07,484 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:27:07,484 - INFO - train: 432 sequences (216 preictal, 216 interictal)
2025-11-19 19:27:07,484 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-19 19:27:07,508 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:27:07,508 - INFO - train: kept 216 preictal and 216 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:27:07,508 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:27:07,536 - INFO - ============================================================
2025-11-19 19:27:07,536 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:27:07,536 - INFO - ============================================================
2025-11-19 19:27:07,536 - INFO - Processing 432 training samples to compute normalization stats...
2025-11-19 19:27:07,536 - INFO - Processing 432 sequences from 28 unique files
Processing training data:   0%|                                      | 0/432 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/432 [00:01<08:50,  1.23s/it]Processing training data:  15%|####4                        | 66/432 [00:01<00:07, 47.79it/s]Processing training data:  20%|#####8                       | 87/432 [00:02<00:07, 45.75it/s]Processing training data:  25%|######9                     | 107/432 [00:02<00:07, 42.27it/s]Processing training data:  30%|########4                   | 131/432 [00:03<00:09, 31.51it/s]Processing training data:  38%|##########5                 | 163/432 [00:05<00:09, 28.10it/s]Processing training data:  41%|###########3                | 175/432 [00:06<00:11, 21.82it/s]Processing training data:  44%|############2               | 189/432 [00:06<00:10, 23.63it/s]Processing training data:  47%|#############2              | 205/432 [00:08<00:12, 18.41it/s]Processing training data:  49%|#############8              | 213/432 [00:09<00:16, 13.55it/s]Processing training data:  52%|##############5             | 225/432 [00:11<00:17, 11.81it/s]Processing training data:  54%|###############2            | 235/432 [00:12<00:18, 10.52it/s]Processing training data:  57%|################            | 247/432 [00:13<00:17, 10.32it/s]Processing training data:  59%|################6           | 257/432 [00:14<00:18,  9.24it/s]Processing training data:  62%|#################4          | 269/432 [00:16<00:17,  9.43it/s]Processing training data:  65%|##################          | 279/432 [00:17<00:16,  9.15it/s]Processing training data:  67%|##################6         | 288/432 [00:18<00:17,  8.36it/s]Processing training data:  70%|###################6        | 303/432 [00:20<00:14,  8.99it/s]Processing training data:  73%|####################3       | 314/432 [00:21<00:13,  8.89it/s]Processing training data:  76%|#####################1      | 327/432 [00:21<00:09, 11.49it/s]Processing training data:  80%|######################3     | 345/432 [00:23<00:07, 12.21it/s]Processing training data:  81%|######################6     | 350/432 [00:23<00:06, 11.86it/s]Processing training data:  86%|#######################9    | 370/432 [00:24<00:04, 14.25it/s]Processing training data:  87%|########################4   | 377/432 [00:25<00:04, 11.50it/s]Processing training data:  90%|#########################1  | 388/432 [00:27<00:04, 10.25it/s]Processing training data:  92%|#########################8  | 399/432 [00:28<00:03,  9.55it/s]Processing training data:  95%|##########################7 | 412/432 [00:29<00:02,  9.60it/s]Processing training data:  98%|###########################3| 422/432 [00:31<00:01,  9.05it/s]Processing training data: 100%|############################| 432/432 [00:31<00:00, 13.84it/s]
2025-11-19 19:27:38,744 - INFO - Computing normalization statistics from training data...
2025-11-19 19:27:39,393 - INFO - Normalization stats computed:
2025-11-19 19:27:39,393 - INFO -   Mean: 0.426685
2025-11-19 19:27:39,393 - INFO -   Std: 2.452065
2025-11-19 19:27:39,393 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold8\normalization_stats.json
2025-11-19 19:27:39,447 - INFO - Applying normalization and saving 432 training sequences...
Normalizing and saving training data:   0%|                          | 0/432 [00:00<?, ?it/s]2025-11-19 19:27:39,454 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold8\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/432 [00:00<00:26, 15.90it/s]Normalizing and saving training data:   5%|7                | 20/432 [00:01<00:25, 15.85it/s]Normalizing and saving training data:   7%|#1               | 30/432 [00:01<00:25, 15.89it/s]Normalizing and saving training data:   9%|#5               | 40/432 [00:02<00:24, 15.89it/s]Normalizing and saving training data:  12%|#9               | 50/432 [00:03<00:24, 15.90it/s]Normalizing and saving training data:  14%|##3              | 60/432 [00:03<00:23, 15.88it/s]Normalizing and saving training data:  16%|##7              | 70/432 [00:04<00:22, 15.85it/s]Normalizing and saving training data:  19%|###1             | 80/432 [00:05<00:22, 15.86it/s]Normalizing and saving training data:  21%|###5             | 90/432 [00:05<00:21, 15.85it/s]Normalizing and saving training data:  23%|###7            | 100/432 [00:06<00:21, 15.77it/s]Normalizing and saving training data:  25%|####            | 110/432 [00:06<00:20, 15.78it/s]Normalizing and saving training data:  28%|####4           | 120/432 [00:07<00:19, 15.76it/s]Normalizing and saving training data:  30%|####8           | 130/432 [00:08<00:19, 15.78it/s]Normalizing and saving training data:  32%|#####1          | 140/432 [00:08<00:18, 15.78it/s]Normalizing and saving training data:  35%|#####5          | 150/432 [00:09<00:17, 15.78it/s]Normalizing and saving training data:  37%|#####9          | 160/432 [00:10<00:17, 15.76it/s]Normalizing and saving training data:  39%|######2         | 170/432 [00:10<00:16, 15.76it/s]Normalizing and saving training data:  42%|######6         | 180/432 [00:11<00:16, 15.74it/s]Normalizing and saving training data:  44%|#######         | 190/432 [00:12<00:15, 15.76it/s]Normalizing and saving training data:  46%|#######4        | 200/432 [00:12<00:14, 15.76it/s]Normalizing and saving training data:  49%|#######7        | 210/432 [00:13<00:14, 15.60it/s]Normalizing and saving training data:  51%|########1       | 220/432 [00:13<00:13, 15.60it/s]Normalizing and saving training data:  53%|########5       | 230/432 [00:14<00:12, 15.60it/s]Normalizing and saving training data:  56%|########8       | 240/432 [00:15<00:12, 15.62it/s]Normalizing and saving training data:  58%|#########2      | 250/432 [00:15<00:11, 15.60it/s]Normalizing and saving training data:  60%|#########6      | 260/432 [00:16<00:10, 15.64it/s]Normalizing and saving training data:  62%|##########      | 270/432 [00:17<00:10, 15.66it/s]Normalizing and saving training data:  65%|##########3     | 280/432 [00:17<00:09, 15.66it/s]Normalizing and saving training data:  67%|##########7     | 290/432 [00:18<00:09, 15.66it/s]Normalizing and saving training data:  69%|###########1    | 300/432 [00:19<00:08, 15.54it/s]Normalizing and saving training data:  72%|###########4    | 310/432 [00:19<00:07, 15.62it/s]Normalizing and saving training data:  74%|###########8    | 320/432 [00:20<00:07, 15.61it/s]Normalizing and saving training data:  76%|############2   | 330/432 [00:20<00:06, 15.66it/s]Normalizing and saving training data:  79%|############5   | 340/432 [00:21<00:05, 15.67it/s]Normalizing and saving training data:  81%|############9   | 350/432 [00:22<00:05, 15.68it/s]Normalizing and saving training data:  83%|#############3  | 360/432 [00:22<00:04, 15.70it/s]Normalizing and saving training data:  86%|#############7  | 370/432 [00:23<00:03, 15.68it/s]Normalizing and saving training data:  88%|##############  | 380/432 [00:24<00:03, 15.67it/s]Normalizing and saving training data:  90%|##############4 | 390/432 [00:24<00:02, 15.68it/s]Normalizing and saving training data:  93%|##############8 | 400/432 [00:25<00:02, 15.56it/s]Normalizing and saving training data:  95%|###############1| 410/432 [00:26<00:01, 15.46it/s]Normalizing and saving training data:  97%|###############5| 420/432 [00:26<00:00, 15.49it/s]Normalizing and saving training data: 100%|###############9| 430/432 [00:27<00:00, 15.41it/s]Normalizing and saving training data: 100%|################| 432/432 [00:27<00:00, 15.75it/s]
2025-11-19 19:28:07,060 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:28:07,067 - INFO - Loaded normalization statistics:
2025-11-19 19:28:07,067 - INFO -   Mean: 0.426685
2025-11-19 19:28:07,068 - INFO -   Std: 2.452065
2025-11-19 19:28:07,068 - INFO - Split train already completed, skipping
2025-11-19 19:28:07,068 - INFO - Processing test split...
2025-11-19 19:28:07,068 - INFO - Need to process 40/40 sequences for test
2025-11-19 19:28:07,068 - INFO - Processing 40 sequences from 16 unique files
2025-11-19 19:28:07,068 - INFO - Average 2.5 sequences per file
Processing test:   0%|                                                | 0/40 [00:00<?, ?it/s]Processing test:   2%|#                                       | 1/40 [00:00<00:25,  1.52it/s]2025-11-19 19:28:07,729 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold8\test_dataset.h5
2025-11-19 19:28:08,931 - INFO - Progress: 452/472 (95.8%) - ETA: 0.0 minutes
Processing test:  52%|####################4                  | 21/40 [00:02<00:01, 10.31it/s]Processing test:  55%|#####################4                 | 22/40 [00:02<00:01,  9.40it/s]Processing test:  57%|######################4                | 23/40 [00:02<00:02,  8.49it/s]Processing test:  60%|#######################4               | 24/40 [00:02<00:02,  7.64it/s]Processing test:  62%|########################3              | 25/40 [00:03<00:03,  4.81it/s]Processing test:  68%|##########################3            | 27/40 [00:03<00:02,  5.22it/s]Processing test:  70%|###########################3           | 28/40 [00:04<00:02,  4.56it/s]Processing test:  72%|############################2          | 29/40 [00:04<00:02,  4.27it/s]Processing test:  75%|#############################2         | 30/40 [00:05<00:04,  2.42it/s]2025-11-19 19:28:13,412 - INFO - Progress: 463/472 (98.1%) - ETA: 0.0 minutes
Processing test:  80%|###############################2       | 32/40 [00:06<00:04,  1.98it/s]Processing test:  85%|#################################1     | 34/40 [00:07<00:02,  2.68it/s]Processing test:  88%|##################################1    | 35/40 [00:07<00:02,  2.23it/s]Processing test:  92%|####################################   | 37/40 [00:08<00:00,  3.01it/s]Processing test:  95%|#####################################  | 38/40 [00:08<00:00,  2.98it/s]Processing test:  98%|###################################### | 39/40 [00:09<00:00,  1.81it/s]Processing test: 100%|#######################################| 40/40 [00:09<00:00,  4.05it/s]
2025-11-19 19:28:17,542 - INFO - Validating final datasets...
2025-11-19 19:28:17,550 - INFO - train dataset validation:
2025-11-19 19:28:17,550 - INFO -   - Segments: 432
2025-11-19 19:28:17,550 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:28:17,550 - INFO -   - Classes: 216 preictal, 216 interictal
2025-11-19 19:28:17,550 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:28:17,555 - INFO - test dataset validation:
2025-11-19 19:28:17,555 - INFO -   - Segments: 40
2025-11-19 19:28:17,555 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:28:17,555 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-19 19:28:17,555 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:28:17,555 - INFO - ============================================================
2025-11-19 19:28:17,555 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:28:17,555 - INFO - Total time: 1.2 minutes
2025-11-19 19:28:17,555 - INFO - Processed segments: 472
2025-11-19 19:28:17,555 - INFO - Average rate: 6.7 segments/second
2025-11-19 19:28:17,555 - INFO - ============================================================
✅ Fold 8 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 9/11
============================================================
2025-11-19 19:28:17,618 - INFO - ============================================================
2025-11-19 19:28:17,618 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:28:17,618 - INFO - ============================================================
2025-11-19 19:28:17,618 - INFO - Output prefix: chb13_fold9
2025-11-19 19:28:17,618 - INFO - EEG Preprocessor initialized
2025-11-19 19:28:17,618 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:28:17,618 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:28:17,619 - INFO - Segment duration: 5 seconds
2025-11-19 19:28:17,619 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:28:17,619 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:28:17,619 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:28:17,619 - INFO - Loading segments from chb13_fold9_sequences_prediction.json
2025-11-19 19:28:17,638 - INFO - Loaded 472 total sequences
2025-11-19 19:28:17,638 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:28:17,638 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:28:17,639 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:28:17,639 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:28:17,639 - INFO - train: 428 sequences (214 preictal, 214 interictal)
2025-11-19 19:28:17,639 - INFO - test: 44 sequences (22 preictal, 22 interictal)
2025-11-19 19:28:17,663 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:28:17,663 - INFO - train: kept 214 preictal and 214 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:28:17,663 - INFO - test: kept 22 preictal and 22 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:28:17,687 - INFO - ============================================================
2025-11-19 19:28:17,687 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:28:17,687 - INFO - ============================================================
2025-11-19 19:28:17,687 - INFO - Processing 428 training samples to compute normalization stats...
2025-11-19 19:28:17,688 - INFO - Processing 428 sequences from 30 unique files
Processing training data:   0%|                                      | 0/428 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/428 [00:00<03:59,  1.78it/s]Processing training data:   6%|#6                           | 25/428 [00:01<00:28, 14.36it/s]Processing training data:   8%|##4                          | 36/428 [00:02<00:22, 17.25it/s]Processing training data:  13%|###6                         | 54/428 [00:03<00:23, 15.89it/s]Processing training data:  16%|####6                        | 69/428 [00:04<00:18, 19.22it/s]Processing training data:  21%|######                       | 89/428 [00:04<00:13, 24.41it/s]Processing training data:  26%|#######1                    | 110/428 [00:05<00:15, 20.62it/s]Processing training data:  28%|#######7                    | 118/428 [00:06<00:15, 20.30it/s]Processing training data:  31%|########7                   | 134/428 [00:06<00:12, 23.25it/s]Processing training data:  36%|##########                  | 154/428 [00:08<00:14, 18.99it/s]Processing training data:  39%|##########7                 | 165/428 [00:09<00:18, 14.15it/s]Processing training data:  42%|###########7                | 179/428 [00:10<00:19, 12.81it/s]Processing training data:  44%|############4               | 190/428 [00:12<00:20, 11.89it/s]Processing training data:  46%|#############               | 199/428 [00:13<00:21, 10.71it/s]Processing training data:  48%|#############5              | 207/428 [00:14<00:21, 10.28it/s]Processing training data:  58%|################3           | 250/428 [00:15<00:09, 17.85it/s]Processing training data:  61%|#################1          | 262/428 [00:16<00:10, 15.26it/s]Processing training data:  63%|#################6          | 270/428 [00:17<00:11, 13.31it/s]Processing training data:  65%|##################3         | 280/428 [00:18<00:12, 11.54it/s]Processing training data:  68%|###################1        | 292/428 [00:20<00:13, 10.46it/s]Processing training data:  72%|####################        | 307/428 [00:21<00:10, 11.02it/s]Processing training data:  74%|####################8       | 318/428 [00:22<00:10, 10.63it/s]Processing training data:  82%|######################8     | 350/428 [00:24<00:05, 14.80it/s]Processing training data:  84%|#######################4    | 359/428 [00:24<00:04, 15.33it/s]Processing training data:  89%|########################7   | 379/428 [00:25<00:03, 15.43it/s]Processing training data:  91%|#########################5  | 390/428 [00:27<00:02, 12.96it/s]Processing training data:  94%|##########################2 | 401/428 [00:28<00:02, 11.53it/s]Processing training data:  96%|##########################9 | 412/428 [00:29<00:01, 10.42it/s]Processing training data:  99%|###########################6| 423/428 [00:30<00:00, 10.55it/s]Processing training data: 100%|############################| 428/428 [00:31<00:00, 11.41it/s]Processing training data: 100%|############################| 428/428 [00:31<00:00, 13.77it/s]
2025-11-19 19:28:48,775 - INFO - Computing normalization statistics from training data...
2025-11-19 19:28:49,422 - INFO - Normalization stats computed:
2025-11-19 19:28:49,422 - INFO -   Mean: 0.417217
2025-11-19 19:28:49,422 - INFO -   Std: 2.449238
2025-11-19 19:28:49,422 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold9\normalization_stats.json
2025-11-19 19:28:49,468 - INFO - Applying normalization and saving 428 training sequences...
Normalizing and saving training data:   0%|                          | 0/428 [00:00<?, ?it/s]2025-11-19 19:28:49,476 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold9\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/428 [00:00<00:27, 15.45it/s]Normalizing and saving training data:   5%|7                | 20/428 [00:01<00:25, 15.70it/s]Normalizing and saving training data:   7%|#1               | 30/428 [00:01<00:25, 15.83it/s]Normalizing and saving training data:   9%|#5               | 40/428 [00:02<00:24, 15.88it/s]Normalizing and saving training data:  12%|#9               | 50/428 [00:03<00:23, 15.91it/s]Normalizing and saving training data:  14%|##3              | 60/428 [00:03<00:23, 15.93it/s]Normalizing and saving training data:  16%|##7              | 70/428 [00:04<00:22, 15.90it/s]Normalizing and saving training data:  19%|###1             | 80/428 [00:05<00:21, 15.90it/s]Normalizing and saving training data:  21%|###5             | 90/428 [00:05<00:21, 15.85it/s]Normalizing and saving training data:  23%|###7            | 100/428 [00:06<00:20, 15.85it/s]Normalizing and saving training data:  26%|####1           | 110/428 [00:06<00:20, 15.87it/s]Normalizing and saving training data:  28%|####4           | 120/428 [00:07<00:19, 15.85it/s]Normalizing and saving training data:  30%|####8           | 130/428 [00:08<00:18, 15.81it/s]Normalizing and saving training data:  33%|#####2          | 140/428 [00:08<00:18, 15.76it/s]Normalizing and saving training data:  35%|#####6          | 150/428 [00:09<00:17, 15.76it/s]Normalizing and saving training data:  37%|#####9          | 160/428 [00:10<00:17, 15.76it/s]Normalizing and saving training data:  40%|######3         | 170/428 [00:10<00:16, 15.78it/s]Normalizing and saving training data:  42%|######7         | 180/428 [00:11<00:15, 15.75it/s]Normalizing and saving training data:  44%|#######1        | 190/428 [00:12<00:15, 15.78it/s]Normalizing and saving training data:  47%|#######4        | 200/428 [00:12<00:14, 15.78it/s]Normalizing and saving training data:  49%|#######8        | 210/428 [00:13<00:13, 15.79it/s]Normalizing and saving training data:  51%|########2       | 220/428 [00:13<00:13, 15.79it/s]Normalizing and saving training data:  54%|########5       | 230/428 [00:14<00:12, 15.68it/s]Normalizing and saving training data:  56%|########9       | 240/428 [00:15<00:12, 15.50it/s]Normalizing and saving training data:  58%|#########3      | 250/428 [00:15<00:11, 15.53it/s]Normalizing and saving training data:  61%|#########7      | 260/428 [00:16<00:10, 15.52it/s]Normalizing and saving training data:  63%|##########      | 270/428 [00:17<00:10, 15.51it/s]Normalizing and saving training data:  65%|##########4     | 280/428 [00:17<00:09, 15.56it/s]Normalizing and saving training data:  68%|##########8     | 290/428 [00:18<00:08, 15.56it/s]Normalizing and saving training data:  70%|###########2    | 300/428 [00:19<00:08, 15.57it/s]Normalizing and saving training data:  72%|###########5    | 310/428 [00:19<00:07, 15.58it/s]Normalizing and saving training data:  75%|###########9    | 320/428 [00:20<00:06, 15.61it/s]Normalizing and saving training data:  77%|############3   | 330/428 [00:20<00:06, 15.63it/s]Normalizing and saving training data:  79%|############7   | 340/428 [00:21<00:05, 15.66it/s]Normalizing and saving training data:  82%|#############   | 350/428 [00:22<00:04, 15.67it/s]Normalizing and saving training data:  84%|#############4  | 360/428 [00:22<00:04, 15.69it/s]Normalizing and saving training data:  86%|#############8  | 370/428 [00:23<00:03, 15.67it/s]Normalizing and saving training data:  89%|##############2 | 380/428 [00:24<00:03, 15.67it/s]Normalizing and saving training data:  91%|##############5 | 390/428 [00:24<00:02, 15.65it/s]Normalizing and saving training data:  93%|##############9 | 400/428 [00:25<00:01, 15.65it/s]Normalizing and saving training data:  96%|###############3| 410/428 [00:26<00:01, 15.59it/s]Normalizing and saving training data:  98%|###############7| 420/428 [00:26<00:00, 15.42it/s]Normalizing and saving training data: 100%|################| 428/428 [00:26<00:00, 15.98it/s]
2025-11-19 19:29:16,801 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:29:16,808 - INFO - Loaded normalization statistics:
2025-11-19 19:29:16,808 - INFO -   Mean: 0.417217
2025-11-19 19:29:16,808 - INFO -   Std: 2.449238
2025-11-19 19:29:16,808 - INFO - Split train already completed, skipping
2025-11-19 19:29:16,808 - INFO - Processing test split...
2025-11-19 19:29:16,809 - INFO - Need to process 44/44 sequences for test
2025-11-19 19:29:16,809 - INFO - Processing 44 sequences from 16 unique files
2025-11-19 19:29:16,809 - INFO - Average 2.8 sequences per file
Processing test:   0%|                                                | 0/44 [00:00<?, ?it/s]Processing test:   2%|9                                       | 1/44 [00:00<00:27,  1.58it/s]2025-11-19 19:29:17,442 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold9\test_dataset.h5
2025-11-19 19:29:18,771 - INFO - Progress: 450/472 (95.3%) - ETA: 0.0 minutes
Processing test:  52%|####################3                  | 23/44 [00:03<00:02,  7.02it/s]Processing test:  57%|######################1                | 25/44 [00:03<00:02,  6.85it/s]Processing test:  61%|#######################9               | 27/44 [00:04<00:03,  5.54it/s]Processing test:  66%|#########################7             | 29/44 [00:05<00:03,  4.62it/s]Processing test:  70%|###########################4           | 31/44 [00:05<00:02,  5.07it/s]Processing test:  73%|############################3          | 32/44 [00:05<00:02,  4.98it/s]2025-11-19 19:29:23,256 - INFO - Progress: 460/472 (97.5%) - ETA: 0.0 minutes
Processing test:  75%|#############################2         | 33/44 [00:07<00:04,  2.64it/s]Processing test:  80%|###############################        | 35/44 [00:07<00:02,  3.25it/s]Processing test:  82%|###############################9       | 36/44 [00:07<00:02,  2.97it/s]Processing test:  86%|#################################6     | 38/44 [00:08<00:01,  3.79it/s]Processing test:  89%|##################################5    | 39/44 [00:08<00:01,  3.90it/s]Processing test:  91%|###################################4   | 40/44 [00:08<00:01,  3.88it/s]Processing test:  93%|####################################3  | 41/44 [00:09<00:01,  2.93it/s]2025-11-19 19:29:26,773 - INFO - Progress: 470/472 (99.6%) - ETA: 0.0 minutes
Processing test:  98%|######################################1| 43/44 [00:10<00:00,  2.60it/s]Processing test: 100%|#######################################| 44/44 [00:10<00:00,  2.80it/s]Processing test: 100%|#######################################| 44/44 [00:10<00:00,  4.20it/s]
2025-11-19 19:29:27,475 - INFO - Validating final datasets...
2025-11-19 19:29:27,483 - INFO - train dataset validation:
2025-11-19 19:29:27,483 - INFO -   - Segments: 428
2025-11-19 19:29:27,483 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:29:27,483 - INFO -   - Classes: 214 preictal, 214 interictal
2025-11-19 19:29:27,483 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:29:27,489 - INFO - test dataset validation:
2025-11-19 19:29:27,489 - INFO -   - Segments: 44
2025-11-19 19:29:27,489 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:29:27,489 - INFO -   - Classes: 22 preictal, 22 interictal
2025-11-19 19:29:27,489 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:29:27,489 - INFO - ============================================================
2025-11-19 19:29:27,489 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:29:27,489 - INFO - Total time: 1.2 minutes
2025-11-19 19:29:27,489 - INFO - Processed segments: 472
2025-11-19 19:29:27,489 - INFO - Average rate: 6.8 segments/second
2025-11-19 19:29:27,489 - INFO - ============================================================
✅ Fold 9 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 10/11
============================================================
2025-11-19 19:29:27,551 - INFO - ============================================================
2025-11-19 19:29:27,551 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:29:27,551 - INFO - ============================================================
2025-11-19 19:29:27,551 - INFO - Output prefix: chb13_fold10
2025-11-19 19:29:27,552 - INFO - EEG Preprocessor initialized
2025-11-19 19:29:27,552 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:29:27,552 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:29:27,552 - INFO - Segment duration: 5 seconds
2025-11-19 19:29:27,552 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:29:27,552 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:29:27,552 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:29:27,553 - INFO - Loading segments from chb13_fold10_sequences_prediction.json
2025-11-19 19:29:27,571 - INFO - Loaded 472 total sequences
2025-11-19 19:29:27,571 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:29:27,571 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:29:27,571 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:29:27,571 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:29:27,571 - INFO - train: 434 sequences (217 preictal, 217 interictal)
2025-11-19 19:29:27,572 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-19 19:29:27,596 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:29:27,597 - INFO - train: kept 217 preictal and 217 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:29:27,597 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:29:27,622 - INFO - ============================================================
2025-11-19 19:29:27,622 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:29:27,622 - INFO - ============================================================
2025-11-19 19:29:27,622 - INFO - Processing 434 training samples to compute normalization stats...
2025-11-19 19:29:27,622 - INFO - Processing 434 sequences from 30 unique files
Processing training data:   0%|                                      | 0/434 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/434 [00:00<03:34,  2.02it/s]Processing training data:   5%|#4                           | 21/434 [00:01<00:33, 12.17it/s]Processing training data:   7%|##                           | 31/434 [00:02<00:26, 14.94it/s]Processing training data:  11%|###2                         | 49/434 [00:03<00:23, 16.45it/s]Processing training data:  13%|###8                         | 57/434 [00:04<00:33, 11.30it/s]Processing training data:  16%|####6                        | 69/434 [00:05<00:25, 14.25it/s]Processing training data:  20%|#####6                       | 85/434 [00:06<00:23, 14.93it/s]Processing training data:  22%|######3                      | 95/434 [00:07<00:29, 11.58it/s]Processing training data:  25%|######9                     | 108/434 [00:08<00:30, 10.69it/s]Processing training data:  28%|#######9                    | 123/434 [00:10<00:27, 11.28it/s]Processing training data:  31%|########5                   | 133/434 [00:10<00:24, 12.44it/s]Processing training data:  36%|##########1                 | 157/434 [00:11<00:14, 18.74it/s]Processing training data:  41%|###########4                | 178/434 [00:12<00:13, 18.31it/s]Processing training data:  43%|############                | 186/434 [00:13<00:18, 13.45it/s]Processing training data:  46%|############7               | 198/434 [00:14<00:19, 12.28it/s]Processing training data:  56%|###############7            | 244/434 [00:16<00:09, 20.68it/s]Processing training data:  58%|################3           | 253/434 [00:16<00:08, 20.30it/s]Processing training data:  63%|#################6          | 273/434 [00:17<00:08, 18.94it/s]Processing training data:  70%|###################6        | 305/434 [00:19<00:06, 21.44it/s]Processing training data:  72%|####################2       | 314/434 [00:20<00:07, 16.16it/s]Processing training data:  74%|####################8       | 323/434 [00:21<00:08, 13.33it/s]Processing training data:  77%|#####################4      | 333/434 [00:22<00:08, 11.81it/s]Processing training data:  79%|######################1     | 344/434 [00:24<00:08, 10.95it/s]Processing training data:  82%|######################8     | 354/434 [00:25<00:08,  9.83it/s]Processing training data:  84%|#######################5    | 365/434 [00:26<00:07,  9.38it/s]Processing training data:  87%|########################3   | 377/434 [00:27<00:04, 11.44it/s]Processing training data:  91%|#########################6  | 397/434 [00:28<00:02, 12.87it/s]Processing training data:  95%|##########################5 | 411/434 [00:29<00:01, 12.00it/s]Processing training data:  97%|########################### | 420/434 [00:31<00:01, 10.13it/s]Processing training data: 100%|############################| 434/434 [00:31<00:00, 13.81it/s]Processing training data: 100%|############################| 434/434 [00:31<00:00, 13.74it/s]
2025-11-19 19:29:59,205 - INFO - Computing normalization statistics from training data...
2025-11-19 19:29:59,898 - INFO - Normalization stats computed:
2025-11-19 19:29:59,898 - INFO -   Mean: 0.370472
2025-11-19 19:29:59,898 - INFO -   Std: 2.448367
2025-11-19 19:29:59,898 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold10\normalization_stats.json
2025-11-19 19:29:59,939 - INFO - Applying normalization and saving 434 training sequences...
Normalizing and saving training data:   0%|                          | 0/434 [00:00<?, ?it/s]2025-11-19 19:29:59,947 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold10\train_dataset.h5
Normalizing and saving training data:   2%|3                | 10/434 [00:00<00:27, 15.54it/s]Normalizing and saving training data:   5%|7                | 20/434 [00:01<00:26, 15.77it/s]Normalizing and saving training data:   7%|#1               | 30/434 [00:01<00:25, 15.80it/s]Normalizing and saving training data:   9%|#5               | 40/434 [00:02<00:24, 15.89it/s]Normalizing and saving training data:  12%|#9               | 50/434 [00:03<00:24, 15.93it/s]Normalizing and saving training data:  14%|##3              | 60/434 [00:03<00:23, 15.91it/s]Normalizing and saving training data:  16%|##7              | 70/434 [00:04<00:22, 15.94it/s]Normalizing and saving training data:  18%|###1             | 80/434 [00:05<00:22, 15.88it/s]Normalizing and saving training data:  21%|###5             | 90/434 [00:05<00:21, 15.90it/s]Normalizing and saving training data:  23%|###6            | 100/434 [00:06<00:21, 15.89it/s]Normalizing and saving training data:  25%|####            | 110/434 [00:06<00:20, 15.86it/s]Normalizing and saving training data:  28%|####4           | 120/434 [00:07<00:19, 15.86it/s]Normalizing and saving training data:  30%|####7           | 130/434 [00:08<00:19, 15.88it/s]Normalizing and saving training data:  32%|#####1          | 140/434 [00:08<00:18, 15.72it/s]Normalizing and saving training data:  35%|#####5          | 150/434 [00:09<00:18, 15.71it/s]Normalizing and saving training data:  37%|#####8          | 160/434 [00:10<00:17, 15.66it/s]Normalizing and saving training data:  39%|######2         | 170/434 [00:10<00:16, 15.67it/s]Normalizing and saving training data:  41%|######6         | 180/434 [00:11<00:16, 15.74it/s]Normalizing and saving training data:  44%|#######         | 190/434 [00:12<00:15, 15.76it/s]Normalizing and saving training data:  46%|#######3        | 200/434 [00:12<00:14, 15.79it/s]Normalizing and saving training data:  48%|#######7        | 210/434 [00:13<00:14, 15.81it/s]Normalizing and saving training data:  51%|########1       | 220/434 [00:13<00:13, 15.82it/s]Normalizing and saving training data:  53%|########4       | 230/434 [00:14<00:12, 15.81it/s]Normalizing and saving training data:  55%|########8       | 240/434 [00:15<00:12, 15.81it/s]Normalizing and saving training data:  58%|#########2      | 250/434 [00:15<00:11, 15.80it/s]Normalizing and saving training data:  60%|#########5      | 260/434 [00:16<00:11, 15.77it/s]Normalizing and saving training data:  62%|#########9      | 270/434 [00:17<00:10, 15.75it/s]Normalizing and saving training data:  65%|##########3     | 280/434 [00:17<00:09, 15.70it/s]Normalizing and saving training data:  67%|##########6     | 290/434 [00:18<00:09, 15.68it/s]Normalizing and saving training data:  69%|###########     | 300/434 [00:19<00:08, 15.61it/s]Normalizing and saving training data:  71%|###########4    | 310/434 [00:19<00:07, 15.59it/s]Normalizing and saving training data:  74%|###########7    | 320/434 [00:20<00:07, 15.61it/s]Normalizing and saving training data:  76%|############1   | 330/434 [00:20<00:06, 15.62it/s]Normalizing and saving training data:  78%|############5   | 340/434 [00:21<00:06, 15.66it/s]Normalizing and saving training data:  81%|############9   | 350/434 [00:22<00:05, 15.66it/s]Normalizing and saving training data:  83%|#############2  | 360/434 [00:22<00:04, 15.66it/s]Normalizing and saving training data:  85%|#############6  | 370/434 [00:23<00:04, 15.67it/s]Normalizing and saving training data:  88%|##############  | 380/434 [00:24<00:03, 15.61it/s]Normalizing and saving training data:  90%|##############3 | 390/434 [00:24<00:02, 15.56it/s]Normalizing and saving training data:  92%|##############7 | 400/434 [00:25<00:02, 15.56it/s]Normalizing and saving training data:  94%|###############1| 410/434 [00:26<00:01, 15.62it/s]Normalizing and saving training data:  97%|###############4| 420/434 [00:26<00:00, 15.60it/s]Normalizing and saving training data:  99%|###############8| 430/434 [00:27<00:00, 15.61it/s]Normalizing and saving training data: 100%|################| 434/434 [00:27<00:00, 15.87it/s]
2025-11-19 19:30:27,584 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:30:27,592 - INFO - Loaded normalization statistics:
2025-11-19 19:30:27,592 - INFO -   Mean: 0.370472
2025-11-19 19:30:27,592 - INFO -   Std: 2.448367
2025-11-19 19:30:27,592 - INFO - Split train already completed, skipping
2025-11-19 19:30:27,592 - INFO - Processing test split...
2025-11-19 19:30:27,592 - INFO - Need to process 38/38 sequences for test
2025-11-19 19:30:27,592 - INFO - Processing 38 sequences from 15 unique files
2025-11-19 19:30:27,592 - INFO - Average 2.5 sequences per file
Processing test:   0%|                                                | 0/38 [00:00<?, ?it/s]Processing test:   3%|#                                       | 1/38 [00:00<00:19,  1.90it/s]2025-11-19 19:30:28,119 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold10\test_dataset.h5
2025-11-19 19:30:29,281 - INFO - Progress: 453/472 (96.0%) - ETA: 0.0 minutes
Processing test:  53%|####################5                  | 20/38 [00:01<00:01, 10.88it/s]Processing test:  55%|#####################5                 | 21/38 [00:02<00:01,  9.67it/s]Processing test:  58%|######################5                | 22/38 [00:02<00:01,  8.74it/s]Processing test:  61%|#######################6               | 23/38 [00:02<00:01,  7.78it/s]Processing test:  63%|########################6              | 24/38 [00:02<00:02,  7.00it/s]Processing test:  66%|#########################6             | 25/38 [00:03<00:02,  6.14it/s]Processing test:  68%|##########################6            | 26/38 [00:04<00:03,  3.12it/s]Processing test:  76%|#############################7         | 29/38 [00:04<00:01,  4.74it/s]2025-11-19 19:30:32,631 - INFO - Progress: 463/472 (98.1%) - ETA: 0.0 minutes
Processing test:  79%|##############################7        | 30/38 [00:05<00:02,  2.99it/s]Processing test:  84%|################################8      | 32/38 [00:05<00:01,  3.00it/s]Processing test:  92%|###################################9   | 35/38 [00:06<00:00,  4.41it/s]Processing test:  95%|####################################9  | 36/38 [00:06<00:00,  4.39it/s]Processing test:  97%|#####################################9 | 37/38 [00:06<00:00,  4.35it/s]Processing test: 100%|#######################################| 38/38 [00:06<00:00,  4.36it/s]Processing test: 100%|#######################################| 38/38 [00:06<00:00,  5.49it/s]
2025-11-19 19:30:35,109 - INFO - Validating final datasets...
2025-11-19 19:30:35,117 - INFO - train dataset validation:
2025-11-19 19:30:35,117 - INFO -   - Segments: 434
2025-11-19 19:30:35,117 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:30:35,117 - INFO -   - Classes: 217 preictal, 217 interictal
2025-11-19 19:30:35,117 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:30:35,122 - INFO - test dataset validation:
2025-11-19 19:30:35,122 - INFO -   - Segments: 38
2025-11-19 19:30:35,122 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:30:35,122 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-19 19:30:35,122 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:30:35,122 - INFO - ============================================================
2025-11-19 19:30:35,122 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:30:35,122 - INFO - Total time: 1.1 minutes
2025-11-19 19:30:35,122 - INFO - Processed segments: 472
2025-11-19 19:30:35,122 - INFO - Average rate: 7.0 segments/second
2025-11-19 19:30:35,122 - INFO - ============================================================
✅ Fold 10 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 11/11
============================================================
2025-11-19 19:30:35,182 - INFO - ============================================================
2025-11-19 19:30:35,182 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-19 19:30:35,182 - INFO - ============================================================
2025-11-19 19:30:35,182 - INFO - Output prefix: chb13_fold11
2025-11-19 19:30:35,182 - INFO - EEG Preprocessor initialized
2025-11-19 19:30:35,182 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-19 19:30:35,183 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-19 19:30:35,183 - INFO - Segment duration: 5 seconds
2025-11-19 19:30:35,183 - INFO - Note: Channel validation performed during segmentation phase
2025-11-19 19:30:35,183 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-19 19:30:35,183 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-19 19:30:35,183 - INFO - Loading segments from chb13_fold11_sequences_prediction.json
2025-11-19 19:30:35,203 - INFO - Loaded 472 total sequences
2025-11-19 19:30:35,203 - INFO - Channel validation (from segmentation): 33/33 files valid
2025-11-19 19:30:35,203 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-19 19:30:35,203 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-19 19:30:35,203 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-19 19:30:35,203 - INFO - train: 424 sequences (212 preictal, 212 interictal)
2025-11-19 19:30:35,203 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-19 19:30:35,227 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-19 19:30:35,228 - INFO - train: kept 212 preictal and 212 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:30:35,228 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-19 19:30:35,252 - INFO - ============================================================
2025-11-19 19:30:35,252 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-19 19:30:35,252 - INFO - ============================================================
2025-11-19 19:30:35,252 - INFO - Processing 424 training samples to compute normalization stats...
2025-11-19 19:30:35,252 - INFO - Processing 424 sequences from 30 unique files
Processing training data:   0%|                                      | 0/424 [00:00<?, ?it/s]Processing training data:   0%|                              | 1/424 [00:01<08:42,  1.23s/it]Processing training data:   3%|7                            | 11/424 [00:02<01:28,  4.69it/s]Processing training data:   5%|#5                           | 22/424 [00:03<00:43,  9.16it/s]Processing training data:   9%|##5                          | 38/424 [00:04<00:37, 10.33it/s]Processing training data:  12%|###3                         | 49/424 [00:05<00:33, 11.27it/s]Processing training data:  21%|######1                      | 90/424 [00:05<00:12, 25.74it/s]Processing training data:  26%|#######2                    | 110/424 [00:06<00:09, 32.94it/s]Processing training data:  27%|#######6                    | 116/424 [00:07<00:16, 18.38it/s]Processing training data:  30%|########3                   | 126/424 [00:07<00:15, 18.79it/s]Processing training data:  34%|#########6                  | 146/424 [00:09<00:15, 18.08it/s]Processing training data:  42%|###########7                | 178/424 [00:09<00:09, 27.10it/s]Processing training data:  47%|#############               | 198/424 [00:11<00:10, 20.76it/s]Processing training data:  50%|##############              | 213/424 [00:12<00:11, 17.76it/s]Processing training data:  53%|##############9             | 226/424 [00:13<00:13, 15.00it/s]Processing training data:  56%|###############5            | 236/424 [00:15<00:15, 12.25it/s]Processing training data:  58%|################3           | 248/424 [00:16<00:15, 11.08it/s]Processing training data:  61%|################9           | 257/424 [00:16<00:13, 12.04it/s]Processing training data:  66%|##################3         | 278/424 [00:18<00:10, 14.18it/s]Processing training data:  68%|##################9         | 287/424 [00:19<00:11, 11.67it/s]Processing training data:  70%|###################6        | 297/424 [00:20<00:12, 10.23it/s]Processing training data:  73%|####################3       | 308/424 [00:21<00:11,  9.71it/s]Processing training data:  75%|####################8       | 316/424 [00:22<00:09, 10.86it/s]Processing training data:  79%|######################      | 334/424 [00:22<00:05, 15.09it/s]Processing training data:  84%|#######################6    | 358/424 [00:24<00:03, 16.63it/s]Processing training data:  86%|########################1   | 366/424 [00:25<00:04, 14.34it/s]Processing training data:  88%|########################7   | 375/424 [00:26<00:04, 11.89it/s]Processing training data:  91%|#########################4  | 386/424 [00:27<00:03, 11.05it/s]Processing training data:  93%|##########################  | 394/424 [00:28<00:03,  9.35it/s]Processing training data:  95%|##########################6 | 403/424 [00:30<00:02,  8.82it/s]Processing training data:  98%|###########################3| 414/424 [00:31<00:01,  8.77it/s]Processing training data: 100%|############################| 424/424 [00:31<00:00, 13.54it/s]
2025-11-19 19:31:06,578 - INFO - Computing normalization statistics from training data...
2025-11-19 19:31:07,209 - INFO - Normalization stats computed:
2025-11-19 19:31:07,209 - INFO -   Mean: 0.437916
2025-11-19 19:31:07,209 - INFO -   Std: 2.456620
2025-11-19 19:31:07,209 - INFO -   Saved to: preprocessing\checkpoints\chb13_fold11\normalization_stats.json
2025-11-19 19:31:07,250 - INFO - Applying normalization and saving 424 training sequences...
Normalizing and saving training data:   0%|                          | 0/424 [00:00<?, ?it/s]2025-11-19 19:31:07,257 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold11\train_dataset.h5
Normalizing and saving training data:   2%|4                | 10/424 [00:00<00:27, 15.13it/s]Normalizing and saving training data:   5%|8                | 20/424 [00:01<00:25, 15.74it/s]Normalizing and saving training data:   7%|#2               | 30/424 [00:01<00:24, 15.94it/s]Normalizing and saving training data:   9%|#6               | 40/424 [00:02<00:23, 16.03it/s]Normalizing and saving training data:  12%|##               | 50/424 [00:03<00:23, 16.09it/s]Normalizing and saving training data:  14%|##4              | 60/424 [00:03<00:22, 16.16it/s]Normalizing and saving training data:  17%|##8              | 70/424 [00:04<00:21, 16.19it/s]Normalizing and saving training data:  19%|###2             | 80/424 [00:04<00:21, 16.21it/s]Normalizing and saving training data:  21%|###6             | 90/424 [00:05<00:20, 16.22it/s]Normalizing and saving training data:  24%|###7            | 100/424 [00:06<00:19, 16.24it/s]Normalizing and saving training data:  26%|####1           | 110/424 [00:06<00:19, 16.24it/s]Normalizing and saving training data:  28%|####5           | 120/424 [00:07<00:18, 16.09it/s]Normalizing and saving training data:  31%|####9           | 130/424 [00:08<00:18, 15.91it/s]Normalizing and saving training data:  33%|#####2          | 140/424 [00:08<00:18, 15.76it/s]Normalizing and saving training data:  35%|#####6          | 150/424 [00:09<00:17, 15.73it/s]Normalizing and saving training data:  38%|######          | 160/424 [00:10<00:16, 15.62it/s]Normalizing and saving training data:  40%|######4         | 170/424 [00:10<00:16, 15.67it/s]Normalizing and saving training data:  42%|######7         | 180/424 [00:11<00:15, 15.71it/s]Normalizing and saving training data:  45%|#######1        | 190/424 [00:11<00:14, 15.69it/s]Normalizing and saving training data:  47%|#######5        | 200/424 [00:12<00:14, 15.70it/s]Normalizing and saving training data:  50%|#######9        | 210/424 [00:13<00:13, 15.73it/s]Normalizing and saving training data:  52%|########3       | 220/424 [00:13<00:12, 15.74it/s]Normalizing and saving training data:  54%|########6       | 230/424 [00:14<00:12, 15.74it/s]Normalizing and saving training data:  57%|#########       | 240/424 [00:15<00:11, 15.76it/s]Normalizing and saving training data:  59%|#########4      | 250/424 [00:15<00:11, 15.77it/s]Normalizing and saving training data:  61%|#########8      | 260/424 [00:16<00:10, 15.74it/s]Normalizing and saving training data:  64%|##########1     | 270/424 [00:17<00:09, 15.75it/s]Normalizing and saving training data:  66%|##########5     | 280/424 [00:17<00:09, 15.79it/s]Normalizing and saving training data:  68%|##########9     | 290/424 [00:18<00:08, 15.82it/s]Normalizing and saving training data:  71%|###########3    | 300/424 [00:18<00:07, 15.84it/s]Normalizing and saving training data:  73%|###########6    | 310/424 [00:19<00:07, 15.84it/s]Normalizing and saving training data:  75%|############    | 320/424 [00:20<00:06, 15.88it/s]Normalizing and saving training data:  78%|############4   | 330/424 [00:20<00:05, 15.87it/s]Normalizing and saving training data:  80%|############8   | 340/424 [00:21<00:05, 15.86it/s]Normalizing and saving training data:  83%|#############2  | 350/424 [00:22<00:04, 15.87it/s]Normalizing and saving training data:  85%|#############5  | 360/424 [00:22<00:04, 15.82it/s]Normalizing and saving training data:  87%|#############9  | 370/424 [00:23<00:03, 15.86it/s]Normalizing and saving training data:  90%|##############3 | 380/424 [00:23<00:02, 15.85it/s]Normalizing and saving training data:  92%|##############7 | 390/424 [00:24<00:02, 15.89it/s]Normalizing and saving training data:  94%|############### | 400/424 [00:25<00:01, 15.84it/s]Normalizing and saving training data:  97%|###############4| 410/424 [00:25<00:00, 15.96it/s]Normalizing and saving training data:  99%|###############8| 420/424 [00:26<00:00, 16.04it/s]Normalizing and saving training data: 100%|################| 424/424 [00:26<00:00, 16.03it/s]
2025-11-19 19:31:33,998 - INFO - Training data processing completed during stats computation phase
2025-11-19 19:31:34,005 - INFO - Loaded normalization statistics:
2025-11-19 19:31:34,005 - INFO -   Mean: 0.437916
2025-11-19 19:31:34,005 - INFO -   Std: 2.456620
2025-11-19 19:31:34,005 - INFO - Split train already completed, skipping
2025-11-19 19:31:34,005 - INFO - Processing test split...
2025-11-19 19:31:34,006 - INFO - Need to process 48/48 sequences for test
2025-11-19 19:31:34,006 - INFO - Processing 48 sequences from 17 unique files
2025-11-19 19:31:34,006 - INFO - Average 2.8 sequences per file
Processing test:   0%|                                                | 0/48 [00:00<?, ?it/s]Processing test:   2%|8                                       | 1/48 [00:00<00:27,  1.69it/s]2025-11-19 19:31:34,600 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb13_fold11\test_dataset.h5
2025-11-19 19:31:36,200 - INFO - Progress: 448/472 (94.9%) - ETA: 0.1 minutes
Processing test:  52%|####################3                  | 25/48 [00:02<00:02, 10.83it/s]Processing test:  54%|#####################1                 | 26/48 [00:03<00:02,  7.62it/s]Processing test:  58%|######################7                | 28/48 [00:03<00:02,  7.73it/s]Processing test:  60%|#######################5               | 29/48 [00:04<00:04,  4.28it/s]Processing test:  67%|##########################             | 32/48 [00:05<00:03,  4.34it/s]Processing test:  71%|###########################6           | 34/48 [00:06<00:03,  3.99it/s]2025-11-19 19:31:40,900 - INFO - Progress: 460/472 (97.5%) - ETA: 0.0 minutes
Processing test:  77%|##############################         | 37/48 [00:07<00:03,  3.64it/s]Processing test:  79%|##############################8        | 38/48 [00:07<00:02,  3.68it/s]Processing test:  81%|###############################6       | 39/48 [00:07<00:02,  3.77it/s]Processing test:  83%|################################5      | 40/48 [00:07<00:02,  3.86it/s]Processing test:  85%|#################################3     | 41/48 [00:08<00:02,  3.21it/s]Processing test:  90%|##################################9    | 43/48 [00:08<00:01,  4.10it/s]Processing test:  92%|###################################7   | 44/48 [00:08<00:00,  4.02it/s]Processing test:  94%|####################################5  | 45/48 [00:09<00:00,  3.07it/s]2025-11-19 19:31:44,081 - INFO - Progress: 470/472 (99.6%) - ETA: 0.0 minutes
Processing test:  98%|######################################1| 47/48 [00:10<00:00,  2.74it/s]Processing test: 100%|#######################################| 48/48 [00:10<00:00,  2.98it/s]Processing test: 100%|#######################################| 48/48 [00:10<00:00,  4.55it/s]
2025-11-19 19:31:44,726 - INFO - Validating final datasets...
2025-11-19 19:31:44,734 - INFO - train dataset validation:
2025-11-19 19:31:44,734 - INFO -   - Segments: 424
2025-11-19 19:31:44,734 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:31:44,734 - INFO -   - Classes: 212 preictal, 212 interictal
2025-11-19 19:31:44,734 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:31:44,739 - INFO - test dataset validation:
2025-11-19 19:31:44,739 - INFO -   - Segments: 48
2025-11-19 19:31:44,739 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-19 19:31:44,739 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-19 19:31:44,739 - INFO -   - Balance: 50.0% preictal
2025-11-19 19:31:44,739 - INFO - ============================================================
2025-11-19 19:31:44,739 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-19 19:31:44,739 - INFO - Total time: 1.2 minutes
2025-11-19 19:31:44,739 - INFO - Processed segments: 472
2025-11-19 19:31:44,739 - INFO - Average rate: 6.8 segments/second
2025-11-19 19:31:44,739 - INFO - ============================================================
✅ Fold 11 preprocessing completed successfully!

============================================================
✅ BATCH PREPROCESSING COMPLETED!
✅ Processed 12 folds for patient chb13
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 12 folds for patient chb13
============================================================

============================================================
TRAINING FOLD 0/11
============================================================
Using dataset prefix: chb13_fold0
Loading datasets from: preprocessing\data\chb13_fold0
Saving models to: model\chb13_fold0
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2912, std=2.4639
Loaded train dataset: 424 samples
  - Spectrogram shape: torch.Size([424, 30, 18, 50, 10])
  - Value range: [-4.9884, 3.5871]
  - Class distribution: tensor([212, 212])
LOOCV Mode (Fold 0): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6902, grad_norm=1.060, lr=0.000010]Training Epoch 1/5:   4%| | 1/27 [00:04<01:47,  4.15s/it, loss=0.6902, grad_norm=1.060, lr=0.Training Epoch 1/5:   4%| | 1/27 [00:04<01:47,  4.15s/it, loss=0.6970, grad_norm=1.098, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.6970, grad_norm=1.098, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.6775, grad_norm=1.361, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6775, grad_norm=1.361, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6899, grad_norm=1.142, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.53it/s, loss=0.6899, grad_norm=1.142, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.53it/s, loss=0.6795, grad_norm=1.012, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.18it/s, loss=0.6795, grad_norm=1.012, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.18it/s, loss=0.7090, grad_norm=1.304, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.93it/s, loss=0.7090, grad_norm=1.304, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.93it/s, loss=0.7091, grad_norm=1.237, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.78it/s, loss=0.7091, grad_norm=1.237, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.78it/s, loss=0.6910, grad_norm=1.209, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:04<00:04,  4.65it/s, loss=0.6910, grad_norm=1.209, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:05<00:04,  4.65it/s, loss=0.6826, grad_norm=0.977, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  5.49it/s, loss=0.6826, grad_norm=0.977, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  5.49it/s, loss=0.7058, grad_norm=1.015, lr=0.Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.28it/s, loss=0.7058, grad_norm=1.015, lr=0Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.28it/s, loss=0.6906, grad_norm=1.045, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.94it/s, loss=0.6906, grad_norm=1.045, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.94it/s, loss=0.6953, grad_norm=1.095, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.46it/s, loss=0.6953, grad_norm=1.095, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.46it/s, loss=0.6885, grad_norm=1.076, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.88it/s, loss=0.6885, grad_norm=1.076, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.88it/s, loss=0.7005, grad_norm=0.918, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  8.15it/s, loss=0.7005, grad_norm=0.918, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  8.15it/s, loss=0.6795, grad_norm=1.057, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.48it/s, loss=0.6795, grad_norm=1.057, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.48it/s, loss=0.6895, grad_norm=0.960, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:05<00:01,  8.64it/s, loss=0.6895, grad_norm=0.960, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:05<00:01,  8.64it/s, loss=0.6977, grad_norm=1.221, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:05<00:01,  8.75it/s, loss=0.6977, grad_norm=1.221, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:06<00:01,  8.75it/s, loss=0.6865, grad_norm=0.946, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  8.82it/s, loss=0.6865, grad_norm=0.946, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  8.82it/s, loss=0.6924, grad_norm=0.983, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  8.88it/s, loss=0.6924, grad_norm=0.983, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  8.88it/s, loss=0.6829, grad_norm=1.134, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  9.06it/s, loss=0.6829, grad_norm=1.134, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  9.06it/s, loss=0.6704, grad_norm=1.037, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  9.14it/s, loss=0.6704, grad_norm=1.037, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  9.14it/s, loss=0.6756, grad_norm=1.117, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  9.13it/s, loss=0.6756, grad_norm=1.117, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  9.13it/s, loss=0.6988, grad_norm=1.238, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  9.04it/s, loss=0.6988, grad_norm=1.238, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  9.04it/s, loss=0.6746, grad_norm=1.053, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:06<00:00,  8.98it/s, loss=0.6746, grad_norm=1.053, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:06<00:00,  8.98it/s, loss=0.6735, grad_norm=1.071, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:06<00:00,  9.01it/s, loss=0.6735, grad_norm=1.071, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:06<00:00,  9.01it/s, loss=0.6821, grad_norm=1.032, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:06<00:00,  8.99it/s, loss=0.6821, grad_norm=1.032, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:06<00:00,  8.99it/s, loss=0.6503, grad_norm=1.488, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:07<00:00,  3.58it/s, loss=0.6503, grad_norm=1.488, lr=0

Epoch 1/5 Complete (7.9s) [LR: 0.000010]
Train - Loss: 0.6874, Acc: 0.5684, Precision: 0.5430, Recall: 0.8632, F1: 0.6667, AUC: 0.5972
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6662, grad_norm=1.068, lr=0.000010]Training Epoch 2/5:   4%| | 1/27 [00:04<01:44,  4.01s/it, loss=0.6662, grad_norm=1.068, lr=0.Training Epoch 2/5:   4%| | 1/27 [00:04<01:44,  4.01s/it, loss=0.6815, grad_norm=1.064, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:42,  1.72s/it, loss=0.6815, grad_norm=1.064, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:42,  1.72s/it, loss=0.6655, grad_norm=1.067, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:23,  1.01it/s, loss=0.6655, grad_norm=1.067, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:23,  1.01it/s, loss=0.6743, grad_norm=0.998, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:14,  1.55it/s, loss=0.6743, grad_norm=0.998, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:14,  1.55it/s, loss=0.6844, grad_norm=0.997, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:09,  2.20it/s, loss=0.6844, grad_norm=0.997, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:09,  2.20it/s, loss=0.6792, grad_norm=0.893, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.96it/s, loss=0.6792, grad_norm=0.893, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.96it/s, loss=0.6701, grad_norm=1.158, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.81it/s, loss=0.6701, grad_norm=1.158, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.81it/s, loss=0.6671, grad_norm=1.137, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:04<00:04,  4.67it/s, loss=0.6671, grad_norm=1.137, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:04<00:04,  4.67it/s, loss=0.6702, grad_norm=1.203, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:04<00:03,  5.49it/s, loss=0.6702, grad_norm=1.203, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  5.49it/s, loss=0.6630, grad_norm=1.163, lr=0.Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.29it/s, loss=0.6630, grad_norm=1.163, lr=0Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.29it/s, loss=0.6483, grad_norm=1.125, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.92it/s, loss=0.6483, grad_norm=1.125, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.92it/s, loss=0.6779, grad_norm=1.139, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  7.44it/s, loss=0.6779, grad_norm=1.139, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  7.44it/s, loss=0.6447, grad_norm=1.203, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.78it/s, loss=0.6447, grad_norm=1.203, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.78it/s, loss=0.6917, grad_norm=1.338, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.09it/s, loss=0.6917, grad_norm=1.338, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.09it/s, loss=0.6560, grad_norm=1.411, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.30it/s, loss=0.6560, grad_norm=1.411, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.30it/s, loss=0.6468, grad_norm=1.347, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.53it/s, loss=0.6468, grad_norm=1.347, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.53it/s, loss=0.6563, grad_norm=1.293, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:05<00:01,  8.68it/s, loss=0.6563, grad_norm=1.293, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:05<00:01,  8.68it/s, loss=0.6729, grad_norm=1.190, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:05<00:01,  8.81it/s, loss=0.6729, grad_norm=1.190, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  8.81it/s, loss=0.6641, grad_norm=1.470, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:00,  8.95it/s, loss=0.6641, grad_norm=1.470, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:00,  8.95it/s, loss=0.6174, grad_norm=1.404, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  8.97it/s, loss=0.6174, grad_norm=1.404, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  8.97it/s, loss=0.6621, grad_norm=1.479, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  9.04it/s, loss=0.6621, grad_norm=1.479, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  9.04it/s, loss=0.6173, grad_norm=1.307, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  8.92it/s, loss=0.6173, grad_norm=1.307, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  8.92it/s, loss=0.6442, grad_norm=1.918, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  9.00it/s, loss=0.6442, grad_norm=1.918, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  9.00it/s, loss=0.6037, grad_norm=1.393, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  9.01it/s, loss=0.6037, grad_norm=1.393, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  9.01it/s, loss=0.6105, grad_norm=1.762, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:06<00:00,  9.01it/s, loss=0.6105, grad_norm=1.762, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:06<00:00,  9.01it/s, loss=0.6248, grad_norm=1.826, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:06<00:00,  9.02it/s, loss=0.6248, grad_norm=1.826, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:06<00:00,  9.02it/s, loss=0.5798, grad_norm=2.095, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:07<00:00,  3.63it/s, loss=0.5798, grad_norm=2.095, lr=0

Epoch 2/5 Complete (7.8s) [LR: 0.000010]
Train - Loss: 0.6533, Acc: 0.7335, Precision: 0.7037, Recall: 0.8066, F1: 0.7516, AUC: 0.7907
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/27 [00:03<?, ?it/s, loss=0.6581, grad_norm=2.214, lr=0.000010]Training Epoch 3/5:   4%| | 1/27 [00:03<01:43,  3.99s/it, loss=0.6581, grad_norm=2.214, lr=0.Training Epoch 3/5:   4%| | 1/27 [00:04<01:43,  3.99s/it, loss=0.5503, grad_norm=1.663, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:42,  1.71s/it, loss=0.5503, grad_norm=1.663, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:42,  1.71s/it, loss=0.5878, grad_norm=1.729, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.5878, grad_norm=1.729, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.5745, grad_norm=2.069, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:14,  1.58it/s, loss=0.5745, grad_norm=2.069, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:14,  1.58it/s, loss=0.5874, grad_norm=1.902, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:09,  2.25it/s, loss=0.5874, grad_norm=1.902, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:09,  2.25it/s, loss=0.5499, grad_norm=2.167, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:06,  3.02it/s, loss=0.5499, grad_norm=2.167, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:06,  3.02it/s, loss=0.5558, grad_norm=2.246, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.86it/s, loss=0.5558, grad_norm=2.246, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.86it/s, loss=0.5514, grad_norm=2.115, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:04<00:04,  4.71it/s, loss=0.5514, grad_norm=2.115, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:04<00:04,  4.71it/s, loss=0.5635, grad_norm=2.762, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:04<00:03,  5.57it/s, loss=0.5635, grad_norm=2.762, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:04<00:03,  5.57it/s, loss=0.5184, grad_norm=1.996, lr=0.Training Epoch 3/5:  37%|3| 10/27 [00:04<00:02,  6.33it/s, loss=0.5184, grad_norm=1.996, lr=0Training Epoch 3/5:  37%|3| 10/27 [00:05<00:02,  6.33it/s, loss=0.5749, grad_norm=2.347, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.97it/s, loss=0.5749, grad_norm=2.347, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.97it/s, loss=0.4933, grad_norm=2.076, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:01,  7.51it/s, loss=0.4933, grad_norm=2.076, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:01,  7.51it/s, loss=0.4798, grad_norm=1.845, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.93it/s, loss=0.4798, grad_norm=1.845, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.93it/s, loss=0.5915, grad_norm=4.187, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  8.23it/s, loss=0.5915, grad_norm=4.187, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  8.23it/s, loss=0.4368, grad_norm=2.456, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  8.29it/s, loss=0.4368, grad_norm=2.456, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  8.29it/s, loss=0.5728, grad_norm=4.650, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:05<00:01,  8.52it/s, loss=0.5728, grad_norm=4.650, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:05<00:01,  8.52it/s, loss=0.4689, grad_norm=2.390, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:05<00:01,  8.66it/s, loss=0.4689, grad_norm=2.390, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:05<00:01,  8.66it/s, loss=0.4402, grad_norm=2.171, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:05<00:01,  8.77it/s, loss=0.4402, grad_norm=2.171, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:05<00:01,  8.77it/s, loss=0.4827, grad_norm=3.671, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:05<00:00,  8.90it/s, loss=0.4827, grad_norm=3.671, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:00,  8.90it/s, loss=0.4618, grad_norm=3.280, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  8.98it/s, loss=0.4618, grad_norm=3.280, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  8.98it/s, loss=0.4565, grad_norm=2.577, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  9.01it/s, loss=0.4565, grad_norm=2.577, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  9.01it/s, loss=0.4535, grad_norm=2.769, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  9.04it/s, loss=0.4535, grad_norm=2.769, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  9.04it/s, loss=0.4310, grad_norm=2.474, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:06<00:00,  9.14it/s, loss=0.4310, grad_norm=2.474, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:06<00:00,  9.14it/s, loss=0.4028, grad_norm=3.177, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:06<00:00,  8.93it/s, loss=0.4028, grad_norm=3.177, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:06<00:00,  8.93it/s, loss=0.3302, grad_norm=2.221, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:06<00:00,  8.99it/s, loss=0.3302, grad_norm=2.221, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:06<00:00,  8.99it/s, loss=0.3343, grad_norm=2.496, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:06<00:00,  9.00it/s, loss=0.3343, grad_norm=2.496, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:06<00:00,  9.00it/s, loss=0.3320, grad_norm=5.765, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:07<00:00,  3.66it/s, loss=0.3320, grad_norm=5.765, lr=0

Epoch 3/5 Complete (7.8s) [LR: 0.000010]
Train - Loss: 0.4978, Acc: 0.8373, Precision: 0.7739, Recall: 0.9528, F1: 0.8541, AUC: 0.9462
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.3524, grad_norm=2.980, lr=0.000010]Training Epoch 4/5:   4%| | 1/27 [00:04<01:44,  4.00s/it, loss=0.3524, grad_norm=2.980, lr=0.Training Epoch 4/5:   4%| | 1/27 [00:04<01:44,  4.00s/it, loss=0.3358, grad_norm=2.808, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:42,  1.71s/it, loss=0.3358, grad_norm=2.808, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:42,  1.71s/it, loss=0.3229, grad_norm=5.886, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.3229, grad_norm=5.886, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.3575, grad_norm=3.206, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:14,  1.57it/s, loss=0.3575, grad_norm=3.206, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:14,  1.57it/s, loss=0.2537, grad_norm=1.436, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:09,  2.24it/s, loss=0.2537, grad_norm=1.436, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:09,  2.24it/s, loss=0.2914, grad_norm=2.980, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:06,  3.01it/s, loss=0.2914, grad_norm=2.980, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:06,  3.01it/s, loss=0.2487, grad_norm=2.527, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.85it/s, loss=0.2487, grad_norm=2.527, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.85it/s, loss=0.3384, grad_norm=5.421, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:04<00:04,  4.72it/s, loss=0.3384, grad_norm=5.421, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:04<00:04,  4.72it/s, loss=0.2535, grad_norm=3.124, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:04<00:03,  5.57it/s, loss=0.2535, grad_norm=3.124, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:04<00:03,  5.57it/s, loss=0.4566, grad_norm=9.502, lr=0.Training Epoch 4/5:  37%|3| 10/27 [00:04<00:02,  6.37it/s, loss=0.4566, grad_norm=9.502, lr=0Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  6.37it/s, loss=0.2361, grad_norm=2.918, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.99it/s, loss=0.2361, grad_norm=2.918, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.99it/s, loss=0.2424, grad_norm=4.165, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:01,  7.51it/s, loss=0.2424, grad_norm=4.165, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:01,  7.51it/s, loss=0.1802, grad_norm=2.383, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.90it/s, loss=0.1802, grad_norm=2.383, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.90it/s, loss=0.1729, grad_norm=2.077, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  8.28it/s, loss=0.1729, grad_norm=2.077, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  8.28it/s, loss=0.5504, grad_norm=19.259, lr=Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.43it/s, loss=0.5504, grad_norm=19.259, lr=Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.43it/s, loss=0.3272, grad_norm=7.498, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.63it/s, loss=0.3272, grad_norm=7.498, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.63it/s, loss=0.1656, grad_norm=5.516, lr=0Training Epoch 4/5:  63%|6| 17/27 [00:05<00:01,  8.55it/s, loss=0.1656, grad_norm=5.516, lr=0Training Epoch 4/5:  63%|6| 17/27 [00:05<00:01,  8.55it/s, loss=0.2842, grad_norm=9.982, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:05<00:01,  8.77it/s, loss=0.2842, grad_norm=9.982, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:05<00:01,  8.77it/s, loss=0.1859, grad_norm=5.601, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:05<00:00,  8.81it/s, loss=0.1859, grad_norm=5.601, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.81it/s, loss=0.1253, grad_norm=1.979, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.88it/s, loss=0.1253, grad_norm=1.979, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.88it/s, loss=0.1229, grad_norm=1.506, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.90it/s, loss=0.1229, grad_norm=1.506, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.90it/s, loss=0.1539, grad_norm=5.165, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.96it/s, loss=0.1539, grad_norm=5.165, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.96it/s, loss=0.1262, grad_norm=5.364, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  9.08it/s, loss=0.1262, grad_norm=5.364, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  9.08it/s, loss=0.1348, grad_norm=3.263, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  9.12it/s, loss=0.1348, grad_norm=3.263, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  9.12it/s, loss=0.3051, grad_norm=7.050, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:06<00:00,  9.17it/s, loss=0.3051, grad_norm=7.050, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:06<00:00,  9.17it/s, loss=0.1883, grad_norm=9.340, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:06<00:00,  9.23it/s, loss=0.1883, grad_norm=9.340, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:06<00:00,  9.23it/s, loss=0.4584, grad_norm=20.879, lr=Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  3.65it/s, loss=0.4584, grad_norm=20.879, lr=

Epoch 4/5 Complete (7.8s) [LR: 0.000010]
Train - Loss: 0.2656, Acc: 0.9269, Precision: 0.9171, Recall: 0.9387, F1: 0.9277, AUC: 0.9782
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.1225, grad_norm=5.950, lr=0.000010]Training Epoch 5/5:   4%| | 1/27 [00:04<01:44,  4.00s/it, loss=0.1225, grad_norm=5.950, lr=0.Training Epoch 5/5:   4%| | 1/27 [00:04<01:44,  4.00s/it, loss=0.1241, grad_norm=4.246, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:42,  1.71s/it, loss=0.1241, grad_norm=4.246, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:42,  1.71s/it, loss=0.0905, grad_norm=1.813, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.0905, grad_norm=1.813, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.0834, grad_norm=3.864, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:14,  1.57it/s, loss=0.0834, grad_norm=3.864, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:14,  1.57it/s, loss=0.1250, grad_norm=4.123, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:09,  2.24it/s, loss=0.1250, grad_norm=4.123, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:09,  2.24it/s, loss=0.0733, grad_norm=0.865, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:06,  3.01it/s, loss=0.0733, grad_norm=0.865, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:06,  3.01it/s, loss=0.1218, grad_norm=6.058, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.87it/s, loss=0.1218, grad_norm=6.058, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.87it/s, loss=0.0828, grad_norm=3.498, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:04<00:04,  4.72it/s, loss=0.0828, grad_norm=3.498, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:04<00:04,  4.72it/s, loss=0.0575, grad_norm=2.414, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:04<00:03,  5.57it/s, loss=0.0575, grad_norm=2.414, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:04<00:03,  5.57it/s, loss=0.0637, grad_norm=1.799, lr=0.Training Epoch 5/5:  37%|3| 10/27 [00:04<00:02,  6.35it/s, loss=0.0637, grad_norm=1.799, lr=0Training Epoch 5/5:  37%|3| 10/27 [00:05<00:02,  6.35it/s, loss=0.0821, grad_norm=3.364, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  6.98it/s, loss=0.0821, grad_norm=3.364, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  6.98it/s, loss=0.1457, grad_norm=8.339, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  7.45it/s, loss=0.1457, grad_norm=8.339, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  7.45it/s, loss=0.0698, grad_norm=3.605, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:01,  7.91it/s, loss=0.0698, grad_norm=3.605, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:01,  7.91it/s, loss=0.0714, grad_norm=3.383, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  8.29it/s, loss=0.0714, grad_norm=3.383, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  8.29it/s, loss=0.1627, grad_norm=11.886, lr=Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  8.57it/s, loss=0.1627, grad_norm=11.886, lr=Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  8.57it/s, loss=0.0425, grad_norm=1.972, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:05<00:01,  8.77it/s, loss=0.0425, grad_norm=1.972, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:05<00:01,  8.77it/s, loss=0.0270, grad_norm=0.434, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:05<00:01,  8.94it/s, loss=0.0270, grad_norm=0.434, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:05<00:01,  8.94it/s, loss=0.0603, grad_norm=5.346, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:05<00:00,  9.02it/s, loss=0.0603, grad_norm=5.346, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:05<00:00,  9.02it/s, loss=0.0292, grad_norm=1.206, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:05<00:00,  8.98it/s, loss=0.0292, grad_norm=1.206, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:00,  8.98it/s, loss=0.0659, grad_norm=11.296, lr=Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  9.03it/s, loss=0.0659, grad_norm=11.296, lr=Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  9.03it/s, loss=0.0474, grad_norm=3.471, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  9.09it/s, loss=0.0474, grad_norm=3.471, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  9.09it/s, loss=0.0266, grad_norm=0.469, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  9.04it/s, loss=0.0266, grad_norm=0.469, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  9.04it/s, loss=0.0310, grad_norm=0.798, lr=0Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  9.04it/s, loss=0.0310, grad_norm=0.798, lr=0Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  9.04it/s, loss=0.0749, grad_norm=8.547, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  9.20it/s, loss=0.0749, grad_norm=8.547, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  9.20it/s, loss=0.0636, grad_norm=6.861, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:06<00:00,  9.18it/s, loss=0.0636, grad_norm=6.861, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:06<00:00,  9.18it/s, loss=0.0230, grad_norm=1.554, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:06<00:00,  9.22it/s, loss=0.0230, grad_norm=1.554, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:06<00:00,  9.22it/s, loss=0.0376, grad_norm=3.007, lr=0Training Epoch 5/5: 100%|#| 27/27 [00:07<00:00,  3.66it/s, loss=0.0376, grad_norm=3.007, lr=0

Epoch 5/5 Complete (7.8s) [LR: 0.000005]
Train - Loss: 0.0743, Acc: 0.9953, Precision: 0.9907, Recall: 1.0000, F1: 0.9953, AUC: 0.9994
------------------------------------------------------------
Training curves saved to model\chb13_fold0\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold0
============================================================
✅ Fold 0 training completed successfully!

============================================================
TRAINING FOLD 1/11
============================================================
Using dataset prefix: chb13_fold1
Loading datasets from: preprocessing\data\chb13_fold1
Saving models to: model\chb13_fold1
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2880, std=2.4586
Loaded train dataset: 432 samples
  - Spectrogram shape: torch.Size([432, 30, 18, 50, 10])
  - Value range: [-4.9979, 3.5650]
  - Class distribution: tensor([216, 216])
LOOCV Mode (Fold 1): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6766, grad_norm=1.044, lr=0.000010]Training Epoch 1/5:   4%| | 1/27 [00:04<01:46,  4.11s/it, loss=0.6766, grad_norm=1.044, lr=0.Training Epoch 1/5:   4%| | 1/27 [00:04<01:46,  4.11s/it, loss=0.6880, grad_norm=0.898, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:43,  1.76s/it, loss=0.6880, grad_norm=0.898, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:43,  1.76s/it, loss=0.6759, grad_norm=0.979, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6759, grad_norm=0.979, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6777, grad_norm=0.936, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:14,  1.53it/s, loss=0.6777, grad_norm=0.936, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:14,  1.53it/s, loss=0.6835, grad_norm=0.831, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.6835, grad_norm=0.831, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.6924, grad_norm=0.870, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.96it/s, loss=0.6924, grad_norm=0.870, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.96it/s, loss=0.6853, grad_norm=0.833, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.81it/s, loss=0.6853, grad_norm=0.833, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.81it/s, loss=0.6920, grad_norm=0.871, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:04<00:04,  4.61it/s, loss=0.6920, grad_norm=0.871, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:04<00:04,  4.61it/s, loss=0.6935, grad_norm=0.778, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:04<00:03,  5.48it/s, loss=0.6935, grad_norm=0.778, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  5.48it/s, loss=0.6894, grad_norm=0.857, lr=0.Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.26it/s, loss=0.6894, grad_norm=0.857, lr=0Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.26it/s, loss=0.7178, grad_norm=1.063, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.91it/s, loss=0.7178, grad_norm=1.063, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.91it/s, loss=0.6922, grad_norm=0.887, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.47it/s, loss=0.6922, grad_norm=0.887, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.47it/s, loss=0.7112, grad_norm=0.996, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.94it/s, loss=0.7112, grad_norm=0.996, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.94it/s, loss=0.6890, grad_norm=0.855, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  8.29it/s, loss=0.6890, grad_norm=0.855, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  8.29it/s, loss=0.6941, grad_norm=0.967, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.56it/s, loss=0.6941, grad_norm=0.967, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.56it/s, loss=0.6850, grad_norm=0.907, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:05<00:01,  8.79it/s, loss=0.6850, grad_norm=0.907, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:05<00:01,  8.79it/s, loss=0.6845, grad_norm=0.911, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:05<00:01,  8.93it/s, loss=0.6845, grad_norm=0.911, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:05<00:01,  8.93it/s, loss=0.7425, grad_norm=1.468, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:05<00:00,  9.07it/s, loss=0.7425, grad_norm=1.468, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:00,  9.07it/s, loss=0.6798, grad_norm=0.800, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  9.13it/s, loss=0.6798, grad_norm=0.800, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  9.13it/s, loss=0.7026, grad_norm=0.912, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  9.12it/s, loss=0.7026, grad_norm=0.912, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  9.12it/s, loss=0.6870, grad_norm=0.857, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  9.20it/s, loss=0.6870, grad_norm=0.857, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  9.20it/s, loss=0.6811, grad_norm=0.876, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  9.24it/s, loss=0.6811, grad_norm=0.876, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  9.24it/s, loss=0.6952, grad_norm=0.813, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  9.26it/s, loss=0.6952, grad_norm=0.813, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  9.26it/s, loss=0.6831, grad_norm=0.835, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:06<00:00,  9.29it/s, loss=0.6831, grad_norm=0.835, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:06<00:00,  9.29it/s, loss=0.6763, grad_norm=0.926, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:06<00:00,  9.23it/s, loss=0.6763, grad_norm=0.926, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:06<00:00,  9.23it/s, loss=0.6636, grad_norm=0.901, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:06<00:00,  9.26it/s, loss=0.6636, grad_norm=0.901, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:06<00:00,  9.26it/s, loss=0.6829, grad_norm=0.949, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:06<00:00,  9.22it/s, loss=0.6829, grad_norm=0.949, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:07<00:00,  3.59it/s, loss=0.6829, grad_norm=0.949, lr=0

Epoch 1/5 Complete (7.9s) [LR: 0.000010]
Train - Loss: 0.6897, Acc: 0.5255, Precision: 0.8235, Recall: 0.0648, F1: 0.1202, AUC: 0.5831
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6593, grad_norm=0.940, lr=0.000010]Training Epoch 2/5:   4%| | 1/27 [00:04<01:44,  4.01s/it, loss=0.6593, grad_norm=0.940, lr=0.Training Epoch 2/5:   4%| | 1/27 [00:04<01:44,  4.01s/it, loss=0.6681, grad_norm=1.030, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:42,  1.72s/it, loss=0.6681, grad_norm=1.030, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:42,  1.72s/it, loss=0.6785, grad_norm=0.851, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:23,  1.01it/s, loss=0.6785, grad_norm=0.851, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:23,  1.01it/s, loss=0.6739, grad_norm=0.943, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:14,  1.56it/s, loss=0.6739, grad_norm=0.943, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:14,  1.56it/s, loss=0.6815, grad_norm=0.914, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:09,  2.23it/s, loss=0.6815, grad_norm=0.914, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:09,  2.23it/s, loss=0.7024, grad_norm=1.253, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.99it/s, loss=0.7024, grad_norm=1.253, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.99it/s, loss=0.6798, grad_norm=1.119, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.83it/s, loss=0.6798, grad_norm=1.119, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.83it/s, loss=0.6573, grad_norm=1.014, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:04<00:04,  4.70it/s, loss=0.6573, grad_norm=1.014, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:04<00:04,  4.70it/s, loss=0.6821, grad_norm=1.225, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:04<00:03,  5.53it/s, loss=0.6821, grad_norm=1.225, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  5.53it/s, loss=0.6760, grad_norm=1.098, lr=0.Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.31it/s, loss=0.6760, grad_norm=1.098, lr=0Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.31it/s, loss=0.6525, grad_norm=0.935, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.99it/s, loss=0.6525, grad_norm=0.935, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.99it/s, loss=0.6762, grad_norm=1.309, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:01,  7.51it/s, loss=0.6762, grad_norm=1.309, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:01,  7.51it/s, loss=0.6371, grad_norm=1.032, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.92it/s, loss=0.6371, grad_norm=1.032, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.92it/s, loss=0.6602, grad_norm=1.134, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.18it/s, loss=0.6602, grad_norm=1.134, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.18it/s, loss=0.6457, grad_norm=1.058, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.40it/s, loss=0.6457, grad_norm=1.058, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.40it/s, loss=0.6767, grad_norm=1.144, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.61it/s, loss=0.6767, grad_norm=1.144, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.61it/s, loss=0.6565, grad_norm=1.247, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:05<00:01,  8.81it/s, loss=0.6565, grad_norm=1.247, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:05<00:01,  8.81it/s, loss=0.6281, grad_norm=1.213, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:05<00:01,  8.85it/s, loss=0.6281, grad_norm=1.213, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:05<00:01,  8.85it/s, loss=0.6593, grad_norm=1.130, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:05<00:00,  9.04it/s, loss=0.6593, grad_norm=1.130, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:00,  9.04it/s, loss=0.6245, grad_norm=1.263, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  9.02it/s, loss=0.6245, grad_norm=1.263, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  9.02it/s, loss=0.6205, grad_norm=1.273, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  9.05it/s, loss=0.6205, grad_norm=1.273, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  9.05it/s, loss=0.6581, grad_norm=1.637, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  9.04it/s, loss=0.6581, grad_norm=1.637, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  9.04it/s, loss=0.6813, grad_norm=1.545, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  9.02it/s, loss=0.6813, grad_norm=1.545, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  9.02it/s, loss=0.6218, grad_norm=1.297, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  9.11it/s, loss=0.6218, grad_norm=1.297, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  9.11it/s, loss=0.6133, grad_norm=1.394, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:06<00:00,  9.12it/s, loss=0.6133, grad_norm=1.394, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:06<00:00,  9.12it/s, loss=0.6596, grad_norm=1.768, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:06<00:00,  9.10it/s, loss=0.6596, grad_norm=1.768, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:06<00:00,  9.10it/s, loss=0.5982, grad_norm=1.451, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:06<00:00,  9.08it/s, loss=0.5982, grad_norm=1.451, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:07<00:00,  3.61it/s, loss=0.5982, grad_norm=1.451, lr=0

Epoch 2/5 Complete (7.9s) [LR: 0.000010]
Train - Loss: 0.6566, Acc: 0.7222, Precision: 0.8117, Recall: 0.5787, F1: 0.6757, AUC: 0.7969
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/27 [00:03<?, ?it/s, loss=0.6012, grad_norm=1.463, lr=0.000010]Training Epoch 3/5:   4%| | 1/27 [00:03<01:43,  3.96s/it, loss=0.6012, grad_norm=1.463, lr=0.Training Epoch 3/5:   4%| | 1/27 [00:04<01:43,  3.96s/it, loss=0.6083, grad_norm=1.553, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:43,  1.72s/it, loss=0.6083, grad_norm=1.553, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:43,  1.72s/it, loss=0.6368, grad_norm=1.889, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.00s/it, loss=0.6368, grad_norm=1.889, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.00s/it, loss=0.5716, grad_norm=1.369, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.52it/s, loss=0.5716, grad_norm=1.369, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.52it/s, loss=0.5993, grad_norm=1.966, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.17it/s, loss=0.5993, grad_norm=1.966, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.17it/s, loss=0.5809, grad_norm=1.749, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.93it/s, loss=0.5809, grad_norm=1.749, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.93it/s, loss=0.5883, grad_norm=1.765, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.76it/s, loss=0.5883, grad_norm=1.765, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.76it/s, loss=0.5762, grad_norm=2.476, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:04<00:04,  4.61it/s, loss=0.5762, grad_norm=2.476, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:04<00:04,  4.61it/s, loss=0.5212, grad_norm=1.634, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:04<00:03,  5.44it/s, loss=0.5212, grad_norm=1.634, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  5.44it/s, loss=0.6016, grad_norm=3.389, lr=0.Training Epoch 3/5:  37%|3| 10/27 [00:05<00:02,  6.21it/s, loss=0.6016, grad_norm=3.389, lr=0Training Epoch 3/5:  37%|3| 10/27 [00:05<00:02,  6.21it/s, loss=0.5712, grad_norm=1.870, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.86it/s, loss=0.5712, grad_norm=1.870, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.86it/s, loss=0.5752, grad_norm=2.107, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  7.41it/s, loss=0.5752, grad_norm=2.107, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  7.41it/s, loss=0.5962, grad_norm=2.492, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.83it/s, loss=0.5962, grad_norm=2.492, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.83it/s, loss=0.5441, grad_norm=2.518, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  8.15it/s, loss=0.5441, grad_norm=2.518, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  8.15it/s, loss=0.5203, grad_norm=2.709, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  8.40it/s, loss=0.5203, grad_norm=2.709, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  8.40it/s, loss=0.4636, grad_norm=1.545, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:05<00:01,  8.59it/s, loss=0.4636, grad_norm=1.545, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:05<00:01,  8.59it/s, loss=0.4625, grad_norm=2.032, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:05<00:01,  8.75it/s, loss=0.4625, grad_norm=2.032, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:05<00:01,  8.75it/s, loss=0.5298, grad_norm=2.422, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:05<00:01,  8.89it/s, loss=0.5298, grad_norm=2.422, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  8.89it/s, loss=0.5137, grad_norm=1.904, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:00,  8.99it/s, loss=0.5137, grad_norm=1.904, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:00,  8.99it/s, loss=0.4760, grad_norm=2.072, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  9.05it/s, loss=0.4760, grad_norm=2.072, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  9.05it/s, loss=0.4458, grad_norm=3.744, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  9.14it/s, loss=0.4458, grad_norm=3.744, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  9.14it/s, loss=0.4615, grad_norm=3.671, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  9.20it/s, loss=0.4615, grad_norm=3.671, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  9.20it/s, loss=0.4471, grad_norm=2.258, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:06<00:00,  9.09it/s, loss=0.4471, grad_norm=2.258, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:06<00:00,  9.09it/s, loss=0.4795, grad_norm=5.304, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:06<00:00,  9.11it/s, loss=0.4795, grad_norm=5.304, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:06<00:00,  9.11it/s, loss=0.4382, grad_norm=2.502, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:06<00:00,  9.12it/s, loss=0.4382, grad_norm=2.502, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:06<00:00,  9.12it/s, loss=0.3556, grad_norm=1.692, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:06<00:00,  9.12it/s, loss=0.3556, grad_norm=1.692, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:06<00:00,  9.12it/s, loss=0.4599, grad_norm=7.451, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:06<00:00,  9.11it/s, loss=0.4599, grad_norm=7.451, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:07<00:00,  3.59it/s, loss=0.4599, grad_norm=7.451, lr=0

Epoch 3/5 Complete (7.9s) [LR: 0.000010]
Train - Loss: 0.5269, Acc: 0.8681, Precision: 0.8698, Recall: 0.8657, F1: 0.8677, AUC: 0.9344
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.3684, grad_norm=2.810, lr=0.000010]Training Epoch 4/5:   4%| | 1/27 [00:04<01:49,  4.20s/it, loss=0.3684, grad_norm=2.810, lr=0.Training Epoch 4/5:   4%| | 1/27 [00:04<01:49,  4.20s/it, loss=0.4980, grad_norm=5.541, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:45,  1.81s/it, loss=0.4980, grad_norm=5.541, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:45,  1.81s/it, loss=0.3842, grad_norm=3.009, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:25,  1.04s/it, loss=0.3842, grad_norm=3.009, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:25,  1.04s/it, loss=0.3981, grad_norm=3.383, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:15,  1.47it/s, loss=0.3981, grad_norm=3.383, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:15,  1.47it/s, loss=0.3422, grad_norm=2.829, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.09it/s, loss=0.3422, grad_norm=2.829, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.09it/s, loss=0.3778, grad_norm=3.706, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.79it/s, loss=0.3778, grad_norm=3.706, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.79it/s, loss=0.2959, grad_norm=2.996, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.56it/s, loss=0.2959, grad_norm=2.996, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:05<00:05,  3.56it/s, loss=0.3349, grad_norm=3.401, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:05<00:04,  4.34it/s, loss=0.3349, grad_norm=3.401, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:05<00:04,  4.34it/s, loss=0.2556, grad_norm=1.884, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:05<00:03,  5.08it/s, loss=0.2556, grad_norm=1.884, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:05<00:03,  5.08it/s, loss=0.2803, grad_norm=3.389, lr=0.Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  5.76it/s, loss=0.2803, grad_norm=3.389, lr=0Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  5.76it/s, loss=0.2359, grad_norm=2.645, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.33it/s, loss=0.2359, grad_norm=2.645, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.33it/s, loss=0.3354, grad_norm=3.977, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  6.77it/s, loss=0.3354, grad_norm=3.977, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  6.77it/s, loss=0.3126, grad_norm=7.008, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:02,  6.79it/s, loss=0.3126, grad_norm=7.008, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:02,  6.79it/s, loss=0.1979, grad_norm=1.815, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.19it/s, loss=0.1979, grad_norm=1.815, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.19it/s, loss=0.2554, grad_norm=4.486, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  7.67it/s, loss=0.2554, grad_norm=4.486, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:06<00:01,  7.67it/s, loss=0.2140, grad_norm=2.853, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:06<00:01,  7.58it/s, loss=0.2140, grad_norm=2.853, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:06<00:01,  7.58it/s, loss=0.5697, grad_norm=13.170, lr=Training Epoch 4/5:  63%|6| 17/27 [00:06<00:01,  7.78it/s, loss=0.5697, grad_norm=13.170, lr=Training Epoch 4/5:  63%|6| 17/27 [00:06<00:01,  7.78it/s, loss=0.2159, grad_norm=5.670, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  8.14it/s, loss=0.2159, grad_norm=5.670, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  8.14it/s, loss=0.1668, grad_norm=3.818, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.42it/s, loss=0.1668, grad_norm=3.818, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.42it/s, loss=0.2165, grad_norm=3.255, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.58it/s, loss=0.2165, grad_norm=3.255, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.58it/s, loss=0.1583, grad_norm=1.692, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.74it/s, loss=0.1583, grad_norm=1.692, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.74it/s, loss=0.2428, grad_norm=8.755, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.86it/s, loss=0.2428, grad_norm=8.755, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.86it/s, loss=0.1335, grad_norm=3.882, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.95it/s, loss=0.1335, grad_norm=3.882, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.95it/s, loss=0.2031, grad_norm=4.065, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  9.00it/s, loss=0.2031, grad_norm=4.065, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:07<00:00,  9.00it/s, loss=0.2237, grad_norm=5.077, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:07<00:00,  9.05it/s, loss=0.2237, grad_norm=5.077, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:07<00:00,  9.05it/s, loss=0.1775, grad_norm=6.736, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:07<00:00,  9.08it/s, loss=0.1775, grad_norm=6.736, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:07<00:00,  9.08it/s, loss=0.1818, grad_norm=4.674, lr=0Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  9.10it/s, loss=0.1818, grad_norm=4.674, lr=0Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  3.44it/s, loss=0.1818, grad_norm=4.674, lr=0

Epoch 4/5 Complete (8.3s) [LR: 0.000010]
Train - Loss: 0.2806, Acc: 0.9352, Precision: 0.9434, Recall: 0.9259, F1: 0.9346, AUC: 0.9803
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/27 [00:03<?, ?it/s, loss=0.1660, grad_norm=6.392, lr=0.000010]Training Epoch 5/5:   4%| | 1/27 [00:03<01:43,  3.96s/it, loss=0.1660, grad_norm=6.392, lr=0.Training Epoch 5/5:   4%| | 1/27 [00:04<01:43,  3.96s/it, loss=0.1041, grad_norm=2.236, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:42,  1.70s/it, loss=0.1041, grad_norm=2.236, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:42,  1.70s/it, loss=0.1833, grad_norm=5.402, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.1833, grad_norm=5.402, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.2033, grad_norm=13.676, lr=0Training Epoch 5/5:  15%|1| 4/27 [00:04<00:14,  1.57it/s, loss=0.2033, grad_norm=13.676, lr=0Training Epoch 5/5:  15%|1| 4/27 [00:04<00:14,  1.57it/s, loss=0.1625, grad_norm=4.774, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:09,  2.21it/s, loss=0.1625, grad_norm=4.774, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:09,  2.21it/s, loss=0.0830, grad_norm=0.728, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.0830, grad_norm=0.728, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.3002, grad_norm=7.964, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.75it/s, loss=0.3002, grad_norm=7.964, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.75it/s, loss=0.0880, grad_norm=4.584, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:04<00:04,  4.58it/s, loss=0.0880, grad_norm=4.584, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:04<00:04,  4.58it/s, loss=0.1962, grad_norm=5.969, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:04<00:03,  5.16it/s, loss=0.1962, grad_norm=5.969, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:05<00:03,  5.16it/s, loss=0.3569, grad_norm=18.489, lr=0Training Epoch 5/5:  37%|3| 10/27 [00:05<00:02,  5.77it/s, loss=0.3569, grad_norm=18.489, lr=Training Epoch 5/5:  37%|3| 10/27 [00:05<00:02,  5.77it/s, loss=0.2635, grad_norm=12.626, lr=Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  6.37it/s, loss=0.2635, grad_norm=12.626, lr=Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  6.37it/s, loss=0.1310, grad_norm=10.732, lr=Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  6.97it/s, loss=0.1310, grad_norm=10.732, lr=Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  6.97it/s, loss=0.1517, grad_norm=9.824, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:01,  7.45it/s, loss=0.1517, grad_norm=9.824, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:01,  7.45it/s, loss=0.0765, grad_norm=3.096, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  7.85it/s, loss=0.0765, grad_norm=3.096, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  7.85it/s, loss=0.0723, grad_norm=3.243, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  8.19it/s, loss=0.0723, grad_norm=3.243, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  8.19it/s, loss=0.2384, grad_norm=14.015, lr=Training Epoch 5/5:  59%|5| 16/27 [00:05<00:01,  8.18it/s, loss=0.2384, grad_norm=14.015, lr=Training Epoch 5/5:  59%|5| 16/27 [00:05<00:01,  8.18it/s, loss=0.0514, grad_norm=3.038, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:05<00:01,  8.00it/s, loss=0.0514, grad_norm=3.038, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:05<00:01,  8.00it/s, loss=0.0795, grad_norm=5.056, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:05<00:01,  8.34it/s, loss=0.0795, grad_norm=5.056, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  8.34it/s, loss=0.0806, grad_norm=4.775, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:00,  8.59it/s, loss=0.0806, grad_norm=4.775, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:00,  8.59it/s, loss=0.0542, grad_norm=1.092, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  8.65it/s, loss=0.0542, grad_norm=1.092, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  8.65it/s, loss=0.0368, grad_norm=1.426, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  8.13it/s, loss=0.0368, grad_norm=1.426, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  8.13it/s, loss=0.0829, grad_norm=9.866, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  8.09it/s, loss=0.0829, grad_norm=9.866, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  8.09it/s, loss=0.0227, grad_norm=0.834, lr=0Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  8.37it/s, loss=0.0227, grad_norm=0.834, lr=0Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  8.37it/s, loss=0.0292, grad_norm=0.724, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  8.61it/s, loss=0.0292, grad_norm=0.724, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  8.61it/s, loss=0.0580, grad_norm=4.042, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:06<00:00,  8.44it/s, loss=0.0580, grad_norm=4.042, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:06<00:00,  8.44it/s, loss=0.0511, grad_norm=1.175, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:06<00:00,  8.19it/s, loss=0.0511, grad_norm=1.175, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:07<00:00,  8.19it/s, loss=0.0269, grad_norm=0.552, lr=0Training Epoch 5/5: 100%|#| 27/27 [00:07<00:00,  8.36it/s, loss=0.0269, grad_norm=0.552, lr=0Training Epoch 5/5: 100%|#| 27/27 [00:07<00:00,  3.52it/s, loss=0.0269, grad_norm=0.552, lr=0

Epoch 5/5 Complete (8.1s) [LR: 0.000005]
Train - Loss: 0.1241, Acc: 0.9699, Precision: 0.9677, Recall: 0.9722, F1: 0.9700, AUC: 0.9928
------------------------------------------------------------
Training curves saved to model\chb13_fold1\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold1
============================================================
✅ Fold 1 training completed successfully!

============================================================
TRAINING FOLD 2/11
============================================================
Using dataset prefix: chb13_fold2
Loading datasets from: preprocessing\data\chb13_fold2
Saving models to: model\chb13_fold2
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.4286, std=2.4605
Loaded train dataset: 436 samples
  - Spectrogram shape: torch.Size([436, 30, 18, 50, 10])
  - Value range: [-5.0513, 3.5065]
  - Class distribution: tensor([218, 218])
LOOCV Mode (Fold 2): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.7274, grad_norm=1.438, lr=0.000010]Training Epoch 1/5:   4%| | 1/28 [00:04<01:49,  4.04s/it, loss=0.7274, grad_norm=1.438, lr=0.Training Epoch 1/5:   4%| | 1/28 [00:04<01:49,  4.04s/it, loss=0.6820, grad_norm=1.152, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:44,  1.73s/it, loss=0.6820, grad_norm=1.152, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:44,  1.73s/it, loss=0.6862, grad_norm=0.929, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:24,  1.01it/s, loss=0.6862, grad_norm=0.929, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:24,  1.01it/s, loss=0.6908, grad_norm=1.082, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.56it/s, loss=0.6908, grad_norm=1.082, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.56it/s, loss=0.6893, grad_norm=0.970, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.23it/s, loss=0.6893, grad_norm=0.970, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.23it/s, loss=0.6926, grad_norm=1.025, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  3.00it/s, loss=0.6926, grad_norm=1.025, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  3.00it/s, loss=0.7134, grad_norm=1.173, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.84it/s, loss=0.7134, grad_norm=1.173, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.84it/s, loss=0.7076, grad_norm=1.333, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:04<00:04,  4.71it/s, loss=0.7076, grad_norm=1.333, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:04<00:04,  4.71it/s, loss=0.7015, grad_norm=1.128, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:04<00:03,  5.55it/s, loss=0.7015, grad_norm=1.128, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:05<00:03,  5.55it/s, loss=0.6954, grad_norm=1.127, lr=0.Training Epoch 1/5:  36%|3| 10/28 [00:05<00:02,  6.31it/s, loss=0.6954, grad_norm=1.127, lr=0Training Epoch 1/5:  36%|3| 10/28 [00:05<00:02,  6.31it/s, loss=0.6688, grad_norm=1.217, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.99it/s, loss=0.6688, grad_norm=1.217, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.99it/s, loss=0.6909, grad_norm=1.277, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.54it/s, loss=0.6909, grad_norm=1.277, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.54it/s, loss=0.6969, grad_norm=1.098, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:01,  7.96it/s, loss=0.6969, grad_norm=1.098, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:01,  7.96it/s, loss=0.6807, grad_norm=1.096, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  8.33it/s, loss=0.6807, grad_norm=1.096, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  8.33it/s, loss=0.6800, grad_norm=0.958, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  8.45it/s, loss=0.6800, grad_norm=0.958, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  8.45it/s, loss=0.6913, grad_norm=1.253, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.75it/s, loss=0.6913, grad_norm=1.253, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.75it/s, loss=0.6688, grad_norm=1.074, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:05<00:01,  8.90it/s, loss=0.6688, grad_norm=1.074, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:05<00:01,  8.90it/s, loss=0.6789, grad_norm=1.065, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:05<00:01,  8.92it/s, loss=0.6789, grad_norm=1.065, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:06<00:01,  8.92it/s, loss=0.7060, grad_norm=1.273, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:00,  9.02it/s, loss=0.7060, grad_norm=1.273, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:00,  9.02it/s, loss=0.7153, grad_norm=1.246, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  9.12it/s, loss=0.7153, grad_norm=1.246, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  9.12it/s, loss=0.7223, grad_norm=1.292, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  9.17it/s, loss=0.7223, grad_norm=1.292, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  9.17it/s, loss=0.6942, grad_norm=1.131, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  9.16it/s, loss=0.6942, grad_norm=1.131, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  9.16it/s, loss=0.7045, grad_norm=1.285, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  9.19it/s, loss=0.7045, grad_norm=1.285, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  9.19it/s, loss=0.6918, grad_norm=1.083, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  8.89it/s, loss=0.6918, grad_norm=1.083, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  8.89it/s, loss=0.6885, grad_norm=1.154, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:06<00:00,  9.04it/s, loss=0.6885, grad_norm=1.154, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:06<00:00,  9.04it/s, loss=0.6867, grad_norm=1.075, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:06<00:00,  9.11it/s, loss=0.6867, grad_norm=1.075, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:06<00:00,  9.11it/s, loss=0.6882, grad_norm=1.066, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:06<00:00,  9.09it/s, loss=0.6882, grad_norm=1.066, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:06<00:00,  9.09it/s, loss=0.6795, grad_norm=2.026, lr=0Training Epoch 1/5: 100%|#| 28/28 [00:07<00:00,  3.72it/s, loss=0.6795, grad_norm=2.026, lr=0

Epoch 1/5 Complete (7.9s) [LR: 0.000010]
Train - Loss: 0.6935, Acc: 0.5000, Precision: 0.5000, Recall: 0.1422, F1: 0.2214, AUC: 0.5126
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.6898, grad_norm=1.012, lr=0.000010]Training Epoch 2/5:   4%| | 1/28 [00:04<01:50,  4.09s/it, loss=0.6898, grad_norm=1.012, lr=0.Training Epoch 2/5:   4%| | 1/28 [00:04<01:50,  4.09s/it, loss=0.6806, grad_norm=1.050, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:45,  1.77s/it, loss=0.6806, grad_norm=1.050, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:45,  1.77s/it, loss=0.6808, grad_norm=1.155, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:25,  1.01s/it, loss=0.6808, grad_norm=1.155, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:25,  1.01s/it, loss=0.6872, grad_norm=1.021, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:15,  1.53it/s, loss=0.6872, grad_norm=1.021, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:15,  1.53it/s, loss=0.6939, grad_norm=0.964, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:10,  2.19it/s, loss=0.6939, grad_norm=0.964, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:10,  2.19it/s, loss=0.6749, grad_norm=1.171, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.6749, grad_norm=1.171, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.6896, grad_norm=1.274, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:04<00:05,  3.77it/s, loss=0.6896, grad_norm=1.274, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:04<00:05,  3.77it/s, loss=0.6728, grad_norm=0.892, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:04<00:04,  4.65it/s, loss=0.6728, grad_norm=0.892, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:04<00:04,  4.65it/s, loss=0.6767, grad_norm=1.125, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:04<00:03,  5.50it/s, loss=0.6767, grad_norm=1.125, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:05<00:03,  5.50it/s, loss=0.6733, grad_norm=1.088, lr=0.Training Epoch 2/5:  36%|3| 10/28 [00:05<00:02,  6.25it/s, loss=0.6733, grad_norm=1.088, lr=0Training Epoch 2/5:  36%|3| 10/28 [00:05<00:02,  6.25it/s, loss=0.6723, grad_norm=1.273, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:05<00:02,  6.92it/s, loss=0.6723, grad_norm=1.273, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:05<00:02,  6.92it/s, loss=0.6802, grad_norm=1.307, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  7.47it/s, loss=0.6802, grad_norm=1.307, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  7.47it/s, loss=0.6762, grad_norm=1.319, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:01,  7.85it/s, loss=0.6762, grad_norm=1.319, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:01,  7.85it/s, loss=0.6783, grad_norm=1.312, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  8.23it/s, loss=0.6783, grad_norm=1.312, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  8.23it/s, loss=0.6740, grad_norm=1.161, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:05<00:01,  8.42it/s, loss=0.6740, grad_norm=1.161, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:05<00:01,  8.42it/s, loss=0.6867, grad_norm=1.402, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:05<00:01,  8.60it/s, loss=0.6867, grad_norm=1.402, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:05<00:01,  8.60it/s, loss=0.6836, grad_norm=1.166, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:05<00:01,  8.73it/s, loss=0.6836, grad_norm=1.166, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:05<00:01,  8.73it/s, loss=0.6526, grad_norm=1.340, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:05<00:01,  8.73it/s, loss=0.6526, grad_norm=1.340, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:06<00:01,  8.73it/s, loss=0.6435, grad_norm=1.194, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:06<00:01,  8.87it/s, loss=0.6435, grad_norm=1.194, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:06<00:01,  8.87it/s, loss=0.6713, grad_norm=1.303, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:06<00:00,  8.93it/s, loss=0.6713, grad_norm=1.303, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:06<00:00,  8.93it/s, loss=0.6807, grad_norm=1.585, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  8.97it/s, loss=0.6807, grad_norm=1.585, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  8.97it/s, loss=0.6673, grad_norm=1.533, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  9.00it/s, loss=0.6673, grad_norm=1.533, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  9.00it/s, loss=0.6710, grad_norm=1.600, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:06<00:00,  9.08it/s, loss=0.6710, grad_norm=1.600, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:06<00:00,  9.08it/s, loss=0.6611, grad_norm=1.422, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:06<00:00,  9.11it/s, loss=0.6611, grad_norm=1.422, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:06<00:00,  9.11it/s, loss=0.6520, grad_norm=1.833, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:06<00:00,  9.11it/s, loss=0.6520, grad_norm=1.833, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:06<00:00,  9.11it/s, loss=0.6434, grad_norm=1.382, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:06<00:00,  9.09it/s, loss=0.6434, grad_norm=1.382, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:06<00:00,  9.09it/s, loss=0.6226, grad_norm=1.296, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:06<00:00,  8.99it/s, loss=0.6226, grad_norm=1.296, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:07<00:00,  8.99it/s, loss=0.6361, grad_norm=2.799, lr=0Training Epoch 2/5: 100%|#| 28/28 [00:07<00:00,  3.67it/s, loss=0.6361, grad_norm=2.799, lr=0

Epoch 2/5 Complete (8.0s) [LR: 0.000010]
Train - Loss: 0.6704, Acc: 0.6950, Precision: 0.7136, Recall: 0.6514, F1: 0.6811, AUC: 0.7830
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.6211, grad_norm=1.399, lr=0.000010]Training Epoch 3/5:   4%| | 1/28 [00:04<01:49,  4.07s/it, loss=0.6211, grad_norm=1.399, lr=0.Training Epoch 3/5:   4%| | 1/28 [00:04<01:49,  4.07s/it, loss=0.6403, grad_norm=1.490, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:45,  1.76s/it, loss=0.6403, grad_norm=1.490, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:45,  1.76s/it, loss=0.6451, grad_norm=1.753, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:25,  1.01s/it, loss=0.6451, grad_norm=1.753, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:25,  1.01s/it, loss=0.6014, grad_norm=1.551, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.52it/s, loss=0.6014, grad_norm=1.551, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.52it/s, loss=0.6033, grad_norm=1.370, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.15it/s, loss=0.6033, grad_norm=1.370, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.15it/s, loss=0.6288, grad_norm=1.985, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.91it/s, loss=0.6288, grad_norm=1.985, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.91it/s, loss=0.5537, grad_norm=1.416, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.73it/s, loss=0.5537, grad_norm=1.416, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.73it/s, loss=0.5480, grad_norm=1.297, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:04<00:04,  4.53it/s, loss=0.5480, grad_norm=1.297, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:05<00:04,  4.53it/s, loss=0.6723, grad_norm=2.776, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:05<00:03,  5.14it/s, loss=0.6723, grad_norm=2.776, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:05<00:03,  5.14it/s, loss=0.5600, grad_norm=1.894, lr=0.Training Epoch 3/5:  36%|3| 10/28 [00:05<00:03,  5.96it/s, loss=0.5600, grad_norm=1.894, lr=0Training Epoch 3/5:  36%|3| 10/28 [00:05<00:03,  5.96it/s, loss=0.5981, grad_norm=1.643, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.61it/s, loss=0.5981, grad_norm=1.643, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.61it/s, loss=0.5285, grad_norm=1.476, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  6.92it/s, loss=0.5285, grad_norm=1.476, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  6.92it/s, loss=0.5786, grad_norm=1.900, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:02,  7.19it/s, loss=0.5786, grad_norm=1.900, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:02,  7.19it/s, loss=0.5955, grad_norm=1.864, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  7.66it/s, loss=0.5955, grad_norm=1.864, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  7.66it/s, loss=0.5340, grad_norm=2.031, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  8.00it/s, loss=0.5340, grad_norm=2.031, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  8.00it/s, loss=0.5826, grad_norm=2.216, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  8.02it/s, loss=0.5826, grad_norm=2.216, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  8.02it/s, loss=0.4814, grad_norm=2.436, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:05<00:01,  7.93it/s, loss=0.4814, grad_norm=2.436, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:06<00:01,  7.93it/s, loss=0.4744, grad_norm=2.162, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:06<00:01,  7.97it/s, loss=0.4744, grad_norm=2.162, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:06<00:01,  7.97it/s, loss=0.6142, grad_norm=3.865, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:06<00:01,  7.98it/s, loss=0.6142, grad_norm=3.865, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:06<00:01,  7.98it/s, loss=0.5655, grad_norm=2.135, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:00,  8.20it/s, loss=0.5655, grad_norm=2.135, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:00,  8.20it/s, loss=0.5018, grad_norm=2.784, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.27it/s, loss=0.5018, grad_norm=2.784, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.27it/s, loss=0.5992, grad_norm=2.418, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.08it/s, loss=0.5992, grad_norm=2.418, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.08it/s, loss=0.5049, grad_norm=1.953, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  8.32it/s, loss=0.5049, grad_norm=1.953, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  8.32it/s, loss=0.4814, grad_norm=3.117, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  8.53it/s, loss=0.4814, grad_norm=3.117, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  8.53it/s, loss=0.4962, grad_norm=2.138, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:06<00:00,  8.61it/s, loss=0.4962, grad_norm=2.138, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:07<00:00,  8.61it/s, loss=0.4346, grad_norm=2.224, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:07<00:00,  8.54it/s, loss=0.4346, grad_norm=2.224, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:07<00:00,  8.54it/s, loss=0.5059, grad_norm=2.000, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:07<00:00,  8.28it/s, loss=0.5059, grad_norm=2.000, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:07<00:00,  8.28it/s, loss=0.5329, grad_norm=6.251, lr=0Training Epoch 3/5: 100%|#| 28/28 [00:07<00:00,  3.57it/s, loss=0.5329, grad_norm=6.251, lr=0

Epoch 3/5 Complete (8.2s) [LR: 0.000010]
Train - Loss: 0.5601, Acc: 0.8257, Precision: 0.8349, Recall: 0.8119, F1: 0.8233, AUC: 0.8963
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.4424, grad_norm=2.834, lr=0.000010]Training Epoch 4/5:   4%| | 1/28 [00:04<01:48,  4.00s/it, loss=0.4424, grad_norm=2.834, lr=0.Training Epoch 4/5:   4%| | 1/28 [00:04<01:48,  4.00s/it, loss=0.4801, grad_norm=2.846, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:44,  1.72s/it, loss=0.4801, grad_norm=2.846, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:44,  1.72s/it, loss=0.4096, grad_norm=2.572, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.4096, grad_norm=2.572, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.3726, grad_norm=2.341, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:15,  1.57it/s, loss=0.3726, grad_norm=2.341, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:15,  1.57it/s, loss=0.5515, grad_norm=10.130, lr=0Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.24it/s, loss=0.5515, grad_norm=10.130, lr=0Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.24it/s, loss=0.3676, grad_norm=1.738, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  3.01it/s, loss=0.3676, grad_norm=1.738, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  3.01it/s, loss=0.4335, grad_norm=3.063, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.85it/s, loss=0.4335, grad_norm=3.063, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.85it/s, loss=0.3833, grad_norm=2.107, lr=0.Training Epoch 4/5:  29%|2| 8/28 [00:04<00:04,  4.65it/s, loss=0.3833, grad_norm=2.107, lr=0.Training Epoch 4/5:  29%|2| 8/28 [00:04<00:04,  4.65it/s, loss=0.2872, grad_norm=3.448, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:04<00:03,  5.30it/s, loss=0.2872, grad_norm=3.448, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:05<00:03,  5.30it/s, loss=0.3602, grad_norm=3.038, lr=0.Training Epoch 4/5:  36%|3| 10/28 [00:05<00:03,  5.92it/s, loss=0.3602, grad_norm=3.038, lr=0Training Epoch 4/5:  36%|3| 10/28 [00:05<00:03,  5.92it/s, loss=0.3867, grad_norm=4.212, lr=0Training Epoch 4/5:  39%|3| 11/28 [00:05<00:02,  6.59it/s, loss=0.3867, grad_norm=4.212, lr=0Training Epoch 4/5:  39%|3| 11/28 [00:05<00:02,  6.59it/s, loss=0.3461, grad_norm=3.180, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  7.06it/s, loss=0.3461, grad_norm=3.180, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  7.06it/s, loss=0.2812, grad_norm=4.013, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:02,  7.49it/s, loss=0.2812, grad_norm=4.013, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:02,  7.49it/s, loss=0.2666, grad_norm=2.323, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:01,  7.90it/s, loss=0.2666, grad_norm=2.323, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:01,  7.90it/s, loss=0.3712, grad_norm=7.395, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:05<00:01,  8.07it/s, loss=0.3712, grad_norm=7.395, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:05<00:01,  8.07it/s, loss=0.2691, grad_norm=2.564, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:05<00:01,  7.81it/s, loss=0.2691, grad_norm=2.564, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:05<00:01,  7.81it/s, loss=0.2990, grad_norm=4.850, lr=0Training Epoch 4/5:  61%|6| 17/28 [00:05<00:01,  8.00it/s, loss=0.2990, grad_norm=4.850, lr=0Training Epoch 4/5:  61%|6| 17/28 [00:05<00:01,  8.00it/s, loss=0.3411, grad_norm=7.636, lr=0Training Epoch 4/5:  64%|6| 18/28 [00:05<00:01,  8.31it/s, loss=0.3411, grad_norm=7.636, lr=0Training Epoch 4/5:  64%|6| 18/28 [00:06<00:01,  8.31it/s, loss=0.2761, grad_norm=7.971, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:06<00:01,  8.54it/s, loss=0.2761, grad_norm=7.971, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:06<00:01,  8.54it/s, loss=0.3180, grad_norm=3.293, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:06<00:00,  8.58it/s, loss=0.3180, grad_norm=3.293, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:06<00:00,  8.58it/s, loss=0.1766, grad_norm=2.620, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  8.22it/s, loss=0.1766, grad_norm=2.620, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  8.22it/s, loss=0.2324, grad_norm=4.488, lr=0Training Epoch 4/5:  79%|7| 22/28 [00:06<00:00,  8.06it/s, loss=0.2324, grad_norm=4.488, lr=0Training Epoch 4/5:  79%|7| 22/28 [00:06<00:00,  8.06it/s, loss=0.2233, grad_norm=2.225, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:06<00:00,  8.00it/s, loss=0.2233, grad_norm=2.225, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:06<00:00,  8.00it/s, loss=0.1779, grad_norm=4.255, lr=0Training Epoch 4/5:  86%|8| 24/28 [00:06<00:00,  7.80it/s, loss=0.1779, grad_norm=4.255, lr=0Training Epoch 4/5:  86%|8| 24/28 [00:06<00:00,  7.80it/s, loss=0.3682, grad_norm=5.388, lr=0Training Epoch 4/5:  89%|8| 25/28 [00:06<00:00,  8.01it/s, loss=0.3682, grad_norm=5.388, lr=0Training Epoch 4/5:  89%|8| 25/28 [00:06<00:00,  8.01it/s, loss=0.2613, grad_norm=7.146, lr=0Training Epoch 4/5:  93%|9| 26/28 [00:06<00:00,  8.32it/s, loss=0.2613, grad_norm=7.146, lr=0Training Epoch 4/5:  93%|9| 26/28 [00:07<00:00,  8.32it/s, loss=0.2197, grad_norm=7.637, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:07<00:00,  8.54it/s, loss=0.2197, grad_norm=7.637, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:07<00:00,  8.54it/s, loss=0.6705, grad_norm=39.705, lr=Training Epoch 4/5: 100%|#| 28/28 [00:07<00:00,  3.63it/s, loss=0.6705, grad_norm=39.705, lr=

Epoch 4/5 Complete (8.1s) [LR: 0.000010]
Train - Loss: 0.3419, Acc: 0.8922, Precision: 0.9014, Recall: 0.8807, F1: 0.8910, AUC: 0.9706
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/28 [00:03<?, ?it/s, loss=0.1548, grad_norm=5.695, lr=0.000010]Training Epoch 5/5:   4%| | 1/28 [00:03<01:45,  3.90s/it, loss=0.1548, grad_norm=5.695, lr=0.Training Epoch 5/5:   4%| | 1/28 [00:04<01:45,  3.90s/it, loss=0.1855, grad_norm=4.505, lr=0.Training Epoch 5/5:   7%| | 2/28 [00:04<00:43,  1.68s/it, loss=0.1855, grad_norm=4.505, lr=0.Training Epoch 5/5:   7%| | 2/28 [00:04<00:43,  1.68s/it, loss=0.2867, grad_norm=14.391, lr=0Training Epoch 5/5:  11%|1| 3/28 [00:04<00:24,  1.03it/s, loss=0.2867, grad_norm=14.391, lr=0Training Epoch 5/5:  11%|1| 3/28 [00:04<00:24,  1.03it/s, loss=0.2084, grad_norm=6.835, lr=0.Training Epoch 5/5:  14%|1| 4/28 [00:04<00:15,  1.57it/s, loss=0.2084, grad_norm=6.835, lr=0.Training Epoch 5/5:  14%|1| 4/28 [00:04<00:15,  1.57it/s, loss=0.3726, grad_norm=14.336, lr=0Training Epoch 5/5:  18%|1| 5/28 [00:04<00:10,  2.22it/s, loss=0.3726, grad_norm=14.336, lr=0Training Epoch 5/5:  18%|1| 5/28 [00:04<00:10,  2.22it/s, loss=0.1654, grad_norm=5.432, lr=0.Training Epoch 5/5:  21%|2| 6/28 [00:04<00:07,  2.97it/s, loss=0.1654, grad_norm=5.432, lr=0.Training Epoch 5/5:  21%|2| 6/28 [00:04<00:07,  2.97it/s, loss=0.2027, grad_norm=5.058, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:04<00:05,  3.78it/s, loss=0.2027, grad_norm=5.058, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:04<00:05,  3.78it/s, loss=0.1226, grad_norm=4.887, lr=0.Training Epoch 5/5:  29%|2| 8/28 [00:04<00:04,  4.66it/s, loss=0.1226, grad_norm=4.887, lr=0.Training Epoch 5/5:  29%|2| 8/28 [00:04<00:04,  4.66it/s, loss=0.1595, grad_norm=8.155, lr=0.Training Epoch 5/5:  32%|3| 9/28 [00:04<00:03,  5.51it/s, loss=0.1595, grad_norm=8.155, lr=0.Training Epoch 5/5:  32%|3| 9/28 [00:04<00:03,  5.51it/s, loss=0.1370, grad_norm=2.486, lr=0.Training Epoch 5/5:  36%|3| 10/28 [00:04<00:02,  6.22it/s, loss=0.1370, grad_norm=2.486, lr=0Training Epoch 5/5:  36%|3| 10/28 [00:05<00:02,  6.22it/s, loss=0.5022, grad_norm=8.102, lr=0Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  6.75it/s, loss=0.5022, grad_norm=8.102, lr=0Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  6.75it/s, loss=0.1735, grad_norm=9.991, lr=0Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  7.18it/s, loss=0.1735, grad_norm=9.991, lr=0Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  7.18it/s, loss=0.2687, grad_norm=16.757, lr=Training Epoch 5/5:  46%|4| 13/28 [00:05<00:01,  7.50it/s, loss=0.2687, grad_norm=16.757, lr=Training Epoch 5/5:  46%|4| 13/28 [00:05<00:01,  7.50it/s, loss=0.2227, grad_norm=6.497, lr=0Training Epoch 5/5:  50%|5| 14/28 [00:05<00:01,  7.82it/s, loss=0.2227, grad_norm=6.497, lr=0Training Epoch 5/5:  50%|5| 14/28 [00:05<00:01,  7.82it/s, loss=0.1696, grad_norm=7.922, lr=0Training Epoch 5/5:  54%|5| 15/28 [00:05<00:01,  8.20it/s, loss=0.1696, grad_norm=7.922, lr=0Training Epoch 5/5:  54%|5| 15/28 [00:05<00:01,  8.20it/s, loss=0.2097, grad_norm=12.324, lr=Training Epoch 5/5:  57%|5| 16/28 [00:05<00:01,  8.37it/s, loss=0.2097, grad_norm=12.324, lr=Training Epoch 5/5:  57%|5| 16/28 [00:05<00:01,  8.37it/s, loss=0.1317, grad_norm=3.924, lr=0Training Epoch 5/5:  61%|6| 17/28 [00:05<00:01,  8.60it/s, loss=0.1317, grad_norm=3.924, lr=0Training Epoch 5/5:  61%|6| 17/28 [00:05<00:01,  8.60it/s, loss=0.1422, grad_norm=9.144, lr=0Training Epoch 5/5:  64%|6| 18/28 [00:05<00:01,  8.80it/s, loss=0.1422, grad_norm=9.144, lr=0Training Epoch 5/5:  64%|6| 18/28 [00:05<00:01,  8.80it/s, loss=0.0984, grad_norm=3.919, lr=0Training Epoch 5/5:  68%|6| 19/28 [00:05<00:01,  8.55it/s, loss=0.0984, grad_norm=3.919, lr=0Training Epoch 5/5:  68%|6| 19/28 [00:06<00:01,  8.55it/s, loss=0.4512, grad_norm=29.900, lr=Training Epoch 5/5:  71%|7| 20/28 [00:06<00:00,  8.38it/s, loss=0.4512, grad_norm=29.900, lr=Training Epoch 5/5:  71%|7| 20/28 [00:06<00:00,  8.38it/s, loss=0.0954, grad_norm=9.478, lr=0Training Epoch 5/5:  75%|7| 21/28 [00:06<00:00,  8.54it/s, loss=0.0954, grad_norm=9.478, lr=0Training Epoch 5/5:  75%|7| 21/28 [00:06<00:00,  8.54it/s, loss=0.0682, grad_norm=4.955, lr=0Training Epoch 5/5:  79%|7| 22/28 [00:06<00:00,  8.65it/s, loss=0.0682, grad_norm=4.955, lr=0Training Epoch 5/5:  79%|7| 22/28 [00:06<00:00,  8.65it/s, loss=0.0647, grad_norm=3.143, lr=0Training Epoch 5/5:  82%|8| 23/28 [00:06<00:00,  8.53it/s, loss=0.0647, grad_norm=3.143, lr=0Training Epoch 5/5:  82%|8| 23/28 [00:06<00:00,  8.53it/s, loss=0.1826, grad_norm=7.694, lr=0Training Epoch 5/5:  86%|8| 24/28 [00:06<00:00,  8.20it/s, loss=0.1826, grad_norm=7.694, lr=0Training Epoch 5/5:  86%|8| 24/28 [00:06<00:00,  8.20it/s, loss=0.0713, grad_norm=4.408, lr=0Training Epoch 5/5:  89%|8| 25/28 [00:06<00:00,  8.42it/s, loss=0.0713, grad_norm=4.408, lr=0Training Epoch 5/5:  89%|8| 25/28 [00:06<00:00,  8.42it/s, loss=0.1347, grad_norm=4.977, lr=0Training Epoch 5/5:  93%|9| 26/28 [00:06<00:00,  8.27it/s, loss=0.1347, grad_norm=4.977, lr=0Training Epoch 5/5:  93%|9| 26/28 [00:06<00:00,  8.27it/s, loss=0.1908, grad_norm=10.792, lr=Training Epoch 5/5:  96%|9| 27/28 [00:06<00:00,  8.11it/s, loss=0.1908, grad_norm=10.792, lr=Training Epoch 5/5:  96%|9| 27/28 [00:07<00:00,  8.11it/s, loss=0.0234, grad_norm=0.601, lr=0Training Epoch 5/5: 100%|#| 28/28 [00:07<00:00,  3.68it/s, loss=0.0234, grad_norm=0.601, lr=0

Epoch 5/5 Complete (8.0s) [LR: 0.000005]
Train - Loss: 0.1856, Acc: 0.9450, Precision: 0.9450, Recall: 0.9450, F1: 0.9450, AUC: 0.9850
------------------------------------------------------------
Training curves saved to model\chb13_fold2\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold2
============================================================
✅ Fold 2 training completed successfully!

============================================================
TRAINING FOLD 3/11
============================================================
Using dataset prefix: chb13_fold3
Loading datasets from: preprocessing\data\chb13_fold3
Saving models to: model\chb13_fold3
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.4122, std=2.4583
Loaded train dataset: 440 samples
  - Spectrogram shape: torch.Size([440, 30, 18, 50, 10])
  - Value range: [-5.0491, 3.5080]
  - Class distribution: tensor([220, 220])
LOOCV Mode (Fold 3): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.7074, grad_norm=1.307, lr=0.000010]Training Epoch 1/5:   4%| | 1/28 [00:04<01:51,  4.14s/it, loss=0.7074, grad_norm=1.307, lr=0.Training Epoch 1/5:   4%| | 1/28 [00:04<01:51,  4.14s/it, loss=0.7027, grad_norm=1.244, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:46,  1.78s/it, loss=0.7027, grad_norm=1.244, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:46,  1.78s/it, loss=0.6971, grad_norm=1.156, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:25,  1.02s/it, loss=0.6971, grad_norm=1.156, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:25,  1.02s/it, loss=0.6880, grad_norm=1.229, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.52it/s, loss=0.6880, grad_norm=1.229, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.52it/s, loss=0.6831, grad_norm=1.214, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.17it/s, loss=0.6831, grad_norm=1.214, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.17it/s, loss=0.7022, grad_norm=1.277, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.7022, grad_norm=1.277, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.6893, grad_norm=1.336, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.79it/s, loss=0.6893, grad_norm=1.336, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.79it/s, loss=0.6824, grad_norm=1.138, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:04<00:04,  4.67it/s, loss=0.6824, grad_norm=1.138, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:05<00:04,  4.67it/s, loss=0.6962, grad_norm=1.291, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:05<00:03,  5.52it/s, loss=0.6962, grad_norm=1.291, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:05<00:03,  5.52it/s, loss=0.7120, grad_norm=1.265, lr=0.Training Epoch 1/5:  36%|3| 10/28 [00:05<00:02,  6.33it/s, loss=0.7120, grad_norm=1.265, lr=0Training Epoch 1/5:  36%|3| 10/28 [00:05<00:02,  6.33it/s, loss=0.6964, grad_norm=1.384, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.96it/s, loss=0.6964, grad_norm=1.384, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.96it/s, loss=0.6920, grad_norm=1.254, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.48it/s, loss=0.6920, grad_norm=1.254, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.48it/s, loss=0.6829, grad_norm=1.154, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:01,  7.95it/s, loss=0.6829, grad_norm=1.154, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:01,  7.95it/s, loss=0.6772, grad_norm=1.410, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  8.22it/s, loss=0.6772, grad_norm=1.410, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  8.22it/s, loss=0.6918, grad_norm=1.287, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  8.32it/s, loss=0.6918, grad_norm=1.287, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  8.32it/s, loss=0.6937, grad_norm=1.230, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.45it/s, loss=0.6937, grad_norm=1.230, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.45it/s, loss=0.6818, grad_norm=1.201, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:05<00:01,  8.58it/s, loss=0.6818, grad_norm=1.201, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:06<00:01,  8.58it/s, loss=0.7122, grad_norm=1.716, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:06<00:01,  8.54it/s, loss=0.7122, grad_norm=1.716, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:06<00:01,  8.54it/s, loss=0.6962, grad_norm=1.455, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:01,  8.31it/s, loss=0.6962, grad_norm=1.455, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:01,  8.31it/s, loss=0.6912, grad_norm=1.341, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  8.32it/s, loss=0.6912, grad_norm=1.341, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  8.32it/s, loss=0.6817, grad_norm=1.249, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  8.44it/s, loss=0.6817, grad_norm=1.249, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  8.44it/s, loss=0.7044, grad_norm=1.281, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  8.58it/s, loss=0.7044, grad_norm=1.281, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  8.58it/s, loss=0.6901, grad_norm=1.280, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  8.62it/s, loss=0.6901, grad_norm=1.280, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  8.62it/s, loss=0.6979, grad_norm=1.491, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  8.69it/s, loss=0.6979, grad_norm=1.491, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  8.69it/s, loss=0.6837, grad_norm=1.321, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:06<00:00,  8.83it/s, loss=0.6837, grad_norm=1.321, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:06<00:00,  8.83it/s, loss=0.6855, grad_norm=1.335, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:06<00:00,  8.96it/s, loss=0.6855, grad_norm=1.335, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:07<00:00,  8.96it/s, loss=0.6867, grad_norm=1.314, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:07<00:00,  9.04it/s, loss=0.6867, grad_norm=1.314, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:07<00:00,  9.04it/s, loss=0.6867, grad_norm=1.817, lr=0Training Epoch 1/5: 100%|#| 28/28 [00:07<00:00,  3.56it/s, loss=0.6867, grad_norm=1.817, lr=0

Epoch 1/5 Complete (8.3s) [LR: 0.000010]
Train - Loss: 0.6926, Acc: 0.5045, Precision: 0.5036, Recall: 0.6318, F1: 0.5605, AUC: 0.5156
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.6773, grad_norm=1.208, lr=0.000010]Training Epoch 2/5:   4%| | 1/28 [00:04<01:48,  4.02s/it, loss=0.6773, grad_norm=1.208, lr=0.Training Epoch 2/5:   4%| | 1/28 [00:04<01:48,  4.02s/it, loss=0.6757, grad_norm=1.404, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:44,  1.72s/it, loss=0.6757, grad_norm=1.404, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:44,  1.72s/it, loss=0.6879, grad_norm=1.556, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.6879, grad_norm=1.556, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.6966, grad_norm=1.388, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:15,  1.57it/s, loss=0.6966, grad_norm=1.388, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:15,  1.57it/s, loss=0.6677, grad_norm=1.264, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:10,  2.24it/s, loss=0.6677, grad_norm=1.264, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:10,  2.24it/s, loss=0.6848, grad_norm=1.304, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  3.02it/s, loss=0.6848, grad_norm=1.304, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  3.02it/s, loss=0.6597, grad_norm=1.550, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:04<00:05,  3.88it/s, loss=0.6597, grad_norm=1.550, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:04<00:05,  3.88it/s, loss=0.6811, grad_norm=1.359, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:04<00:04,  4.76it/s, loss=0.6811, grad_norm=1.359, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:04<00:04,  4.76it/s, loss=0.6732, grad_norm=1.307, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:04<00:03,  5.62it/s, loss=0.6732, grad_norm=1.307, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:04<00:03,  5.62it/s, loss=0.7070, grad_norm=1.659, lr=0.Training Epoch 2/5:  36%|3| 10/28 [00:04<00:02,  6.35it/s, loss=0.7070, grad_norm=1.659, lr=0Training Epoch 2/5:  36%|3| 10/28 [00:05<00:02,  6.35it/s, loss=0.6791, grad_norm=1.433, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:05<00:02,  7.00it/s, loss=0.6791, grad_norm=1.433, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:05<00:02,  7.00it/s, loss=0.6939, grad_norm=1.352, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  7.58it/s, loss=0.6939, grad_norm=1.352, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  7.58it/s, loss=0.6627, grad_norm=1.243, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:01,  8.01it/s, loss=0.6627, grad_norm=1.243, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:01,  8.01it/s, loss=0.6800, grad_norm=1.441, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  8.36it/s, loss=0.6800, grad_norm=1.441, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  8.36it/s, loss=0.6615, grad_norm=1.346, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:05<00:01,  8.59it/s, loss=0.6615, grad_norm=1.346, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:05<00:01,  8.59it/s, loss=0.6554, grad_norm=1.405, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:05<00:01,  8.76it/s, loss=0.6554, grad_norm=1.405, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:05<00:01,  8.76it/s, loss=0.6718, grad_norm=1.345, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:05<00:01,  8.86it/s, loss=0.6718, grad_norm=1.345, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:05<00:01,  8.86it/s, loss=0.6862, grad_norm=1.588, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:05<00:01,  8.90it/s, loss=0.6862, grad_norm=1.588, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:05<00:01,  8.90it/s, loss=0.6882, grad_norm=1.522, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:05<00:01,  8.91it/s, loss=0.6882, grad_norm=1.522, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:06<00:01,  8.91it/s, loss=0.6987, grad_norm=1.537, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:06<00:00,  8.88it/s, loss=0.6987, grad_norm=1.537, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:06<00:00,  8.88it/s, loss=0.6832, grad_norm=1.291, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  8.90it/s, loss=0.6832, grad_norm=1.291, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  8.90it/s, loss=0.6626, grad_norm=1.493, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  8.93it/s, loss=0.6626, grad_norm=1.493, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  8.93it/s, loss=0.6515, grad_norm=1.458, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:06<00:00,  9.01it/s, loss=0.6515, grad_norm=1.458, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:06<00:00,  9.01it/s, loss=0.6416, grad_norm=1.489, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:06<00:00,  9.16it/s, loss=0.6416, grad_norm=1.489, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:06<00:00,  9.16it/s, loss=0.6363, grad_norm=1.430, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:06<00:00,  9.14it/s, loss=0.6363, grad_norm=1.430, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:06<00:00,  9.14it/s, loss=0.6368, grad_norm=1.481, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:06<00:00,  9.09it/s, loss=0.6368, grad_norm=1.481, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:06<00:00,  9.09it/s, loss=0.6406, grad_norm=1.929, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:06<00:00,  9.04it/s, loss=0.6406, grad_norm=1.929, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:06<00:00,  9.04it/s, loss=0.6597, grad_norm=2.026, lr=0Training Epoch 2/5: 100%|#| 28/28 [00:07<00:00,  3.73it/s, loss=0.6597, grad_norm=2.026, lr=0

Epoch 2/5 Complete (7.9s) [LR: 0.000010]
Train - Loss: 0.6714, Acc: 0.6818, Precision: 0.7439, Recall: 0.5545, F1: 0.6354, AUC: 0.7403
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.6620, grad_norm=1.729, lr=0.000010]Training Epoch 3/5:   4%| | 1/28 [00:04<01:49,  4.06s/it, loss=0.6620, grad_norm=1.729, lr=0.Training Epoch 3/5:   4%| | 1/28 [00:04<01:49,  4.06s/it, loss=0.6297, grad_norm=1.524, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:45,  1.74s/it, loss=0.6297, grad_norm=1.524, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:45,  1.74s/it, loss=0.6430, grad_norm=1.860, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:24,  1.00it/s, loss=0.6430, grad_norm=1.860, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:24,  1.00it/s, loss=0.6297, grad_norm=1.641, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.55it/s, loss=0.6297, grad_norm=1.641, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.55it/s, loss=0.5945, grad_norm=1.729, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.21it/s, loss=0.5945, grad_norm=1.729, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.21it/s, loss=0.6210, grad_norm=2.260, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.98it/s, loss=0.6210, grad_norm=2.260, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.98it/s, loss=0.5915, grad_norm=2.391, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.82it/s, loss=0.5915, grad_norm=2.391, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.82it/s, loss=0.5945, grad_norm=1.647, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:04<00:04,  4.69it/s, loss=0.5945, grad_norm=1.647, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:04<00:04,  4.69it/s, loss=0.5778, grad_norm=2.392, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:04<00:03,  5.51it/s, loss=0.5778, grad_norm=2.392, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:05<00:03,  5.51it/s, loss=0.6697, grad_norm=3.238, lr=0.Training Epoch 3/5:  36%|3| 10/28 [00:05<00:02,  6.27it/s, loss=0.6697, grad_norm=3.238, lr=0Training Epoch 3/5:  36%|3| 10/28 [00:05<00:02,  6.27it/s, loss=0.5839, grad_norm=2.153, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.89it/s, loss=0.5839, grad_norm=2.153, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.89it/s, loss=0.5759, grad_norm=2.070, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  7.47it/s, loss=0.5759, grad_norm=2.070, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  7.47it/s, loss=0.6094, grad_norm=1.970, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:01,  7.89it/s, loss=0.6094, grad_norm=1.970, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:01,  7.89it/s, loss=0.5403, grad_norm=1.826, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  7.79it/s, loss=0.5403, grad_norm=1.826, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  7.79it/s, loss=0.5896, grad_norm=2.885, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  7.53it/s, loss=0.5896, grad_norm=2.885, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  7.53it/s, loss=0.6015, grad_norm=1.954, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  7.74it/s, loss=0.6015, grad_norm=1.954, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  7.74it/s, loss=0.5181, grad_norm=2.078, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:05<00:01,  7.84it/s, loss=0.5181, grad_norm=2.078, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:06<00:01,  7.84it/s, loss=0.5360, grad_norm=2.171, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:06<00:01,  7.40it/s, loss=0.5360, grad_norm=2.171, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:06<00:01,  7.40it/s, loss=0.5528, grad_norm=2.450, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:06<00:01,  7.20it/s, loss=0.5528, grad_norm=2.450, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:06<00:01,  7.20it/s, loss=0.5259, grad_norm=3.379, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:01,  7.65it/s, loss=0.5259, grad_norm=3.379, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:01,  7.65it/s, loss=0.5175, grad_norm=2.325, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.08it/s, loss=0.5175, grad_norm=2.325, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.08it/s, loss=0.5035, grad_norm=2.149, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.42it/s, loss=0.5035, grad_norm=2.149, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.42it/s, loss=0.4610, grad_norm=1.825, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  8.65it/s, loss=0.4610, grad_norm=1.825, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  8.65it/s, loss=0.5516, grad_norm=3.507, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  8.75it/s, loss=0.5516, grad_norm=3.507, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  8.75it/s, loss=0.4866, grad_norm=2.279, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:06<00:00,  8.93it/s, loss=0.4866, grad_norm=2.279, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:06<00:00,  8.93it/s, loss=0.4113, grad_norm=2.163, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:06<00:00,  9.02it/s, loss=0.4113, grad_norm=2.163, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:07<00:00,  9.02it/s, loss=0.4402, grad_norm=2.832, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:07<00:00,  8.58it/s, loss=0.4402, grad_norm=2.832, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:07<00:00,  8.58it/s, loss=0.4164, grad_norm=2.362, lr=0Training Epoch 3/5: 100%|#| 28/28 [00:07<00:00,  8.72it/s, loss=0.4164, grad_norm=2.362, lr=0Training Epoch 3/5: 100%|#| 28/28 [00:07<00:00,  3.59it/s, loss=0.4164, grad_norm=2.362, lr=0

Epoch 3/5 Complete (8.2s) [LR: 0.000010]
Train - Loss: 0.5584, Acc: 0.8432, Precision: 0.8107, Recall: 0.8955, F1: 0.8510, AUC: 0.9148
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.4104, grad_norm=2.024, lr=0.000010]Training Epoch 4/5:   4%| | 1/28 [00:04<01:50,  4.07s/it, loss=0.4104, grad_norm=2.024, lr=0.Training Epoch 4/5:   4%| | 1/28 [00:04<01:50,  4.07s/it, loss=0.3975, grad_norm=3.578, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:45,  1.74s/it, loss=0.3975, grad_norm=3.578, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:45,  1.74s/it, loss=0.3398, grad_norm=1.360, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:24,  1.00it/s, loss=0.3398, grad_norm=1.360, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:24,  1.00it/s, loss=0.5045, grad_norm=5.202, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:15,  1.54it/s, loss=0.5045, grad_norm=5.202, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:15,  1.54it/s, loss=0.4113, grad_norm=3.014, lr=0.Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.18it/s, loss=0.4113, grad_norm=3.014, lr=0.Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.18it/s, loss=0.4018, grad_norm=5.905, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  2.86it/s, loss=0.4018, grad_norm=5.905, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  2.86it/s, loss=0.3516, grad_norm=3.813, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.56it/s, loss=0.3516, grad_norm=3.813, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.56it/s, loss=0.4100, grad_norm=3.680, lr=0.Training Epoch 4/5:  29%|2| 8/28 [00:04<00:04,  4.40it/s, loss=0.4100, grad_norm=3.680, lr=0.Training Epoch 4/5:  29%|2| 8/28 [00:05<00:04,  4.40it/s, loss=0.3235, grad_norm=2.248, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:05<00:03,  5.26it/s, loss=0.3235, grad_norm=2.248, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:05<00:03,  5.26it/s, loss=0.4123, grad_norm=6.822, lr=0.Training Epoch 4/5:  36%|3| 10/28 [00:05<00:02,  6.06it/s, loss=0.4123, grad_norm=6.822, lr=0Training Epoch 4/5:  36%|3| 10/28 [00:05<00:02,  6.06it/s, loss=0.3606, grad_norm=5.866, lr=0Training Epoch 4/5:  39%|3| 11/28 [00:05<00:02,  6.61it/s, loss=0.3606, grad_norm=5.866, lr=0Training Epoch 4/5:  39%|3| 11/28 [00:05<00:02,  6.61it/s, loss=0.4792, grad_norm=6.986, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  6.42it/s, loss=0.4792, grad_norm=6.986, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  6.42it/s, loss=0.2847, grad_norm=2.325, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:02,  6.90it/s, loss=0.2847, grad_norm=2.325, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:02,  6.90it/s, loss=0.5282, grad_norm=4.779, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:01,  7.44it/s, loss=0.5282, grad_norm=4.779, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:01,  7.44it/s, loss=0.2822, grad_norm=2.621, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:05<00:01,  7.87it/s, loss=0.2822, grad_norm=2.621, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:05<00:01,  7.87it/s, loss=0.4222, grad_norm=9.636, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:05<00:01,  8.13it/s, loss=0.4222, grad_norm=9.636, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:05<00:01,  8.13it/s, loss=0.4167, grad_norm=6.160, lr=0Training Epoch 4/5:  61%|6| 17/28 [00:05<00:01,  8.37it/s, loss=0.4167, grad_norm=6.160, lr=0Training Epoch 4/5:  61%|6| 17/28 [00:06<00:01,  8.37it/s, loss=0.3389, grad_norm=5.151, lr=0Training Epoch 4/5:  64%|6| 18/28 [00:06<00:01,  7.89it/s, loss=0.3389, grad_norm=5.151, lr=0Training Epoch 4/5:  64%|6| 18/28 [00:06<00:01,  7.89it/s, loss=0.2173, grad_norm=2.379, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:06<00:01,  7.48it/s, loss=0.2173, grad_norm=2.379, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:06<00:01,  7.48it/s, loss=0.2531, grad_norm=6.097, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:06<00:01,  7.88it/s, loss=0.2531, grad_norm=6.097, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:06<00:01,  7.88it/s, loss=0.4009, grad_norm=7.062, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  7.25it/s, loss=0.4009, grad_norm=7.062, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  7.25it/s, loss=0.2941, grad_norm=9.251, lr=0Training Epoch 4/5:  79%|7| 22/28 [00:06<00:00,  7.30it/s, loss=0.2941, grad_norm=9.251, lr=0Training Epoch 4/5:  79%|7| 22/28 [00:06<00:00,  7.30it/s, loss=0.1910, grad_norm=2.799, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:06<00:00,  7.76it/s, loss=0.1910, grad_norm=2.799, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:06<00:00,  7.76it/s, loss=0.2865, grad_norm=11.166, lr=Training Epoch 4/5:  86%|8| 24/28 [00:06<00:00,  8.06it/s, loss=0.2865, grad_norm=11.166, lr=Training Epoch 4/5:  86%|8| 24/28 [00:07<00:00,  8.06it/s, loss=0.2481, grad_norm=10.127, lr=Training Epoch 4/5:  89%|8| 25/28 [00:07<00:00,  8.31it/s, loss=0.2481, grad_norm=10.127, lr=Training Epoch 4/5:  89%|8| 25/28 [00:07<00:00,  8.31it/s, loss=0.3779, grad_norm=10.463, lr=Training Epoch 4/5:  93%|9| 26/28 [00:07<00:00,  7.63it/s, loss=0.3779, grad_norm=10.463, lr=Training Epoch 4/5:  93%|9| 26/28 [00:07<00:00,  7.63it/s, loss=0.1665, grad_norm=2.395, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:07<00:00,  7.58it/s, loss=0.1665, grad_norm=2.395, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:07<00:00,  7.58it/s, loss=0.1552, grad_norm=3.134, lr=0Training Epoch 4/5: 100%|#| 28/28 [00:07<00:00,  3.52it/s, loss=0.1552, grad_norm=3.134, lr=0

Epoch 4/5 Complete (8.4s) [LR: 0.000010]
Train - Loss: 0.3452, Acc: 0.9000, Precision: 0.8793, Recall: 0.9273, F1: 0.9027, AUC: 0.9579
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.2482, grad_norm=6.871, lr=0.000010]Training Epoch 5/5:   4%| | 1/28 [00:04<01:58,  4.38s/it, loss=0.2482, grad_norm=6.871, lr=0.Training Epoch 5/5:   4%| | 1/28 [00:04<01:58,  4.38s/it, loss=0.2275, grad_norm=11.924, lr=0Training Epoch 5/5:   7%| | 2/28 [00:04<00:48,  1.87s/it, loss=0.2275, grad_norm=11.924, lr=0Training Epoch 5/5:   7%| | 2/28 [00:04<00:48,  1.87s/it, loss=0.1223, grad_norm=3.785, lr=0.Training Epoch 5/5:  11%|1| 3/28 [00:04<00:26,  1.07s/it, loss=0.1223, grad_norm=3.785, lr=0.Training Epoch 5/5:  11%|1| 3/28 [00:04<00:26,  1.07s/it, loss=0.1561, grad_norm=5.523, lr=0.Training Epoch 5/5:  14%|1| 4/28 [00:04<00:16,  1.45it/s, loss=0.1561, grad_norm=5.523, lr=0.Training Epoch 5/5:  14%|1| 4/28 [00:04<00:16,  1.45it/s, loss=0.2152, grad_norm=9.915, lr=0.Training Epoch 5/5:  18%|1| 5/28 [00:04<00:11,  2.08it/s, loss=0.2152, grad_norm=9.915, lr=0.Training Epoch 5/5:  18%|1| 5/28 [00:04<00:11,  2.08it/s, loss=0.1529, grad_norm=9.157, lr=0.Training Epoch 5/5:  21%|2| 6/28 [00:04<00:07,  2.82it/s, loss=0.1529, grad_norm=9.157, lr=0.Training Epoch 5/5:  21%|2| 6/28 [00:05<00:07,  2.82it/s, loss=0.1376, grad_norm=5.913, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:05<00:05,  3.65it/s, loss=0.1376, grad_norm=5.913, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:05<00:05,  3.65it/s, loss=0.1872, grad_norm=3.624, lr=0.Training Epoch 5/5:  29%|2| 8/28 [00:05<00:04,  4.51it/s, loss=0.1872, grad_norm=3.624, lr=0.Training Epoch 5/5:  29%|2| 8/28 [00:05<00:04,  4.51it/s, loss=0.1086, grad_norm=7.330, lr=0.Training Epoch 5/5:  32%|3| 9/28 [00:05<00:03,  5.36it/s, loss=0.1086, grad_norm=7.330, lr=0.Training Epoch 5/5:  32%|3| 9/28 [00:05<00:03,  5.36it/s, loss=0.1112, grad_norm=6.829, lr=0.Training Epoch 5/5:  36%|3| 10/28 [00:05<00:02,  6.14it/s, loss=0.1112, grad_norm=6.829, lr=0Training Epoch 5/5:  36%|3| 10/28 [00:05<00:02,  6.14it/s, loss=0.1808, grad_norm=7.016, lr=0Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  6.83it/s, loss=0.1808, grad_norm=7.016, lr=0Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  6.83it/s, loss=0.2251, grad_norm=23.148, lr=Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  7.34it/s, loss=0.2251, grad_norm=23.148, lr=Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  7.34it/s, loss=0.0926, grad_norm=3.714, lr=0Training Epoch 5/5:  46%|4| 13/28 [00:05<00:01,  7.76it/s, loss=0.0926, grad_norm=3.714, lr=0Training Epoch 5/5:  46%|4| 13/28 [00:05<00:01,  7.76it/s, loss=0.1042, grad_norm=1.502, lr=0Training Epoch 5/5:  50%|5| 14/28 [00:05<00:01,  8.16it/s, loss=0.1042, grad_norm=1.502, lr=0Training Epoch 5/5:  50%|5| 14/28 [00:05<00:01,  8.16it/s, loss=0.0839, grad_norm=6.152, lr=0Training Epoch 5/5:  54%|5| 15/28 [00:05<00:01,  8.46it/s, loss=0.0839, grad_norm=6.152, lr=0Training Epoch 5/5:  54%|5| 15/28 [00:06<00:01,  8.46it/s, loss=0.0753, grad_norm=1.747, lr=0Training Epoch 5/5:  57%|5| 16/28 [00:06<00:01,  8.60it/s, loss=0.0753, grad_norm=1.747, lr=0Training Epoch 5/5:  57%|5| 16/28 [00:06<00:01,  8.60it/s, loss=0.0722, grad_norm=3.199, lr=0Training Epoch 5/5:  61%|6| 17/28 [00:06<00:01,  8.77it/s, loss=0.0722, grad_norm=3.199, lr=0Training Epoch 5/5:  61%|6| 17/28 [00:06<00:01,  8.77it/s, loss=0.0827, grad_norm=5.718, lr=0Training Epoch 5/5:  64%|6| 18/28 [00:06<00:01,  8.85it/s, loss=0.0827, grad_norm=5.718, lr=0Training Epoch 5/5:  64%|6| 18/28 [00:06<00:01,  8.85it/s, loss=0.0703, grad_norm=6.926, lr=0Training Epoch 5/5:  68%|6| 19/28 [00:06<00:01,  8.96it/s, loss=0.0703, grad_norm=6.926, lr=0Training Epoch 5/5:  68%|6| 19/28 [00:06<00:01,  8.96it/s, loss=0.4553, grad_norm=19.400, lr=Training Epoch 5/5:  71%|7| 20/28 [00:06<00:00,  9.06it/s, loss=0.4553, grad_norm=19.400, lr=Training Epoch 5/5:  71%|7| 20/28 [00:06<00:00,  9.06it/s, loss=0.2256, grad_norm=12.557, lr=Training Epoch 5/5:  75%|7| 21/28 [00:06<00:00,  9.06it/s, loss=0.2256, grad_norm=12.557, lr=Training Epoch 5/5:  75%|7| 21/28 [00:06<00:00,  9.06it/s, loss=0.0682, grad_norm=2.033, lr=0Training Epoch 5/5:  79%|7| 22/28 [00:06<00:00,  9.12it/s, loss=0.0682, grad_norm=2.033, lr=0Training Epoch 5/5:  79%|7| 22/28 [00:06<00:00,  9.12it/s, loss=0.0291, grad_norm=0.954, lr=0Training Epoch 5/5:  82%|8| 23/28 [00:06<00:00,  9.09it/s, loss=0.0291, grad_norm=0.954, lr=0Training Epoch 5/5:  82%|8| 23/28 [00:06<00:00,  9.09it/s, loss=0.0647, grad_norm=3.845, lr=0Training Epoch 5/5:  86%|8| 24/28 [00:06<00:00,  9.07it/s, loss=0.0647, grad_norm=3.845, lr=0Training Epoch 5/5:  86%|8| 24/28 [00:07<00:00,  9.07it/s, loss=0.1491, grad_norm=13.862, lr=Training Epoch 5/5:  89%|8| 25/28 [00:07<00:00,  9.03it/s, loss=0.1491, grad_norm=13.862, lr=Training Epoch 5/5:  89%|8| 25/28 [00:07<00:00,  9.03it/s, loss=0.0341, grad_norm=1.345, lr=0Training Epoch 5/5:  93%|9| 26/28 [00:07<00:00,  9.03it/s, loss=0.0341, grad_norm=1.345, lr=0Training Epoch 5/5:  93%|9| 26/28 [00:07<00:00,  9.03it/s, loss=0.1294, grad_norm=14.422, lr=Training Epoch 5/5:  96%|9| 27/28 [00:07<00:00,  9.05it/s, loss=0.1294, grad_norm=14.422, lr=Training Epoch 5/5:  96%|9| 27/28 [00:07<00:00,  9.05it/s, loss=0.0334, grad_norm=5.498, lr=0Training Epoch 5/5: 100%|#| 28/28 [00:07<00:00,  3.54it/s, loss=0.0334, grad_norm=5.498, lr=0

Epoch 5/5 Complete (8.3s) [LR: 0.000005]
Train - Loss: 0.1373, Acc: 0.9750, Precision: 0.9686, Recall: 0.9818, F1: 0.9752, AUC: 0.9939
------------------------------------------------------------
Training curves saved to model\chb13_fold3\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold3
============================================================
✅ Fold 3 training completed successfully!

============================================================
TRAINING FOLD 4/11
============================================================
Using dataset prefix: chb13_fold4
Loading datasets from: preprocessing\data\chb13_fold4
Saving models to: model\chb13_fold4
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.3373, std=2.4506
Loaded train dataset: 446 samples
  - Spectrogram shape: torch.Size([446, 30, 18, 50, 10])
  - Value range: [-5.0345, 3.5537]
  - Class distribution: tensor([223, 223])
LOOCV Mode (Fold 4): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.6941, grad_norm=1.283, lr=0.000010]Training Epoch 1/5:   4%| | 1/28 [00:04<01:50,  4.09s/it, loss=0.6941, grad_norm=1.283, lr=0.Training Epoch 1/5:   4%| | 1/28 [00:04<01:50,  4.09s/it, loss=0.7040, grad_norm=1.493, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:45,  1.75s/it, loss=0.7040, grad_norm=1.493, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:45,  1.75s/it, loss=0.6927, grad_norm=1.131, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:25,  1.00s/it, loss=0.6927, grad_norm=1.131, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:25,  1.00s/it, loss=0.7003, grad_norm=1.090, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.53it/s, loss=0.7003, grad_norm=1.090, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.53it/s, loss=0.6952, grad_norm=1.094, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.18it/s, loss=0.6952, grad_norm=1.094, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.18it/s, loss=0.6940, grad_norm=1.223, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  2.95it/s, loss=0.6940, grad_norm=1.223, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  2.95it/s, loss=0.6978, grad_norm=1.252, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.80it/s, loss=0.6978, grad_norm=1.252, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.80it/s, loss=0.7033, grad_norm=1.510, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:04<00:04,  4.66it/s, loss=0.7033, grad_norm=1.510, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:04<00:04,  4.66it/s, loss=0.6905, grad_norm=1.467, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:04<00:03,  5.50it/s, loss=0.6905, grad_norm=1.467, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:05<00:03,  5.50it/s, loss=0.6899, grad_norm=1.333, lr=0.Training Epoch 1/5:  36%|3| 10/28 [00:05<00:02,  6.30it/s, loss=0.6899, grad_norm=1.333, lr=0Training Epoch 1/5:  36%|3| 10/28 [00:05<00:02,  6.30it/s, loss=0.6742, grad_norm=1.374, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.99it/s, loss=0.6742, grad_norm=1.374, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.99it/s, loss=0.6953, grad_norm=1.198, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.56it/s, loss=0.6953, grad_norm=1.198, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.56it/s, loss=0.6977, grad_norm=1.186, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:01,  7.99it/s, loss=0.6977, grad_norm=1.186, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:01,  7.99it/s, loss=0.6918, grad_norm=0.963, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  8.32it/s, loss=0.6918, grad_norm=0.963, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  8.32it/s, loss=0.6742, grad_norm=1.024, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  8.58it/s, loss=0.6742, grad_norm=1.024, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  8.58it/s, loss=0.6894, grad_norm=1.218, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.82it/s, loss=0.6894, grad_norm=1.218, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.82it/s, loss=0.7110, grad_norm=1.377, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:05<00:01,  8.94it/s, loss=0.7110, grad_norm=1.377, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:05<00:01,  8.94it/s, loss=0.7062, grad_norm=1.300, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:05<00:01,  8.95it/s, loss=0.7062, grad_norm=1.300, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:06<00:01,  8.95it/s, loss=0.7067, grad_norm=1.315, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:00,  9.01it/s, loss=0.7067, grad_norm=1.315, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:00,  9.01it/s, loss=0.6974, grad_norm=1.083, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  9.07it/s, loss=0.6974, grad_norm=1.083, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  9.07it/s, loss=0.6797, grad_norm=1.172, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  9.12it/s, loss=0.6797, grad_norm=1.172, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  9.12it/s, loss=0.6591, grad_norm=1.216, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  9.17it/s, loss=0.6591, grad_norm=1.216, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  9.17it/s, loss=0.6662, grad_norm=1.048, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  9.20it/s, loss=0.6662, grad_norm=1.048, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  9.20it/s, loss=0.6833, grad_norm=1.043, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  9.21it/s, loss=0.6833, grad_norm=1.043, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  9.21it/s, loss=0.6938, grad_norm=1.423, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:06<00:00,  9.32it/s, loss=0.6938, grad_norm=1.423, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:06<00:00,  9.32it/s, loss=0.6984, grad_norm=1.356, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:06<00:00,  9.32it/s, loss=0.6984, grad_norm=1.356, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:06<00:00,  9.32it/s, loss=0.6893, grad_norm=1.189, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:06<00:00,  9.22it/s, loss=0.6893, grad_norm=1.189, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:07<00:00,  9.22it/s, loss=0.6697, grad_norm=1.291, lr=0Training Epoch 1/5: 100%|#| 28/28 [00:07<00:00,  9.44it/s, loss=0.6697, grad_norm=1.291, lr=0Training Epoch 1/5: 100%|#| 28/28 [00:07<00:00,  3.68it/s, loss=0.6697, grad_norm=1.291, lr=0

Epoch 1/5 Complete (8.0s) [LR: 0.000010]
Train - Loss: 0.6909, Acc: 0.5067, Precision: 0.5116, Recall: 0.2960, F1: 0.3750, AUC: 0.5498
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.6639, grad_norm=1.165, lr=0.000010]Training Epoch 2/5:   4%| | 1/28 [00:04<01:53,  4.22s/it, loss=0.6639, grad_norm=1.165, lr=0.Training Epoch 2/5:   4%| | 1/28 [00:04<01:53,  4.22s/it, loss=0.6831, grad_norm=1.265, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:46,  1.80s/it, loss=0.6831, grad_norm=1.265, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:46,  1.80s/it, loss=0.6672, grad_norm=1.039, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:25,  1.03s/it, loss=0.6672, grad_norm=1.039, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:25,  1.03s/it, loss=0.6853, grad_norm=1.051, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:16,  1.47it/s, loss=0.6853, grad_norm=1.051, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:16,  1.47it/s, loss=0.6816, grad_norm=1.277, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:11,  2.04it/s, loss=0.6816, grad_norm=1.277, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:11,  2.04it/s, loss=0.6748, grad_norm=1.265, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  2.78it/s, loss=0.6748, grad_norm=1.265, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  2.78it/s, loss=0.6718, grad_norm=1.122, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:04<00:05,  3.60it/s, loss=0.6718, grad_norm=1.122, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:05<00:05,  3.60it/s, loss=0.6691, grad_norm=1.217, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:05<00:04,  4.46it/s, loss=0.6691, grad_norm=1.217, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:05<00:04,  4.46it/s, loss=0.6588, grad_norm=1.369, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:05<00:03,  5.32it/s, loss=0.6588, grad_norm=1.369, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:05<00:03,  5.32it/s, loss=0.6695, grad_norm=1.308, lr=0.Training Epoch 2/5:  36%|3| 10/28 [00:05<00:03,  5.56it/s, loss=0.6695, grad_norm=1.308, lr=0Training Epoch 2/5:  36%|3| 10/28 [00:05<00:03,  5.56it/s, loss=0.6492, grad_norm=1.131, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:05<00:02,  5.69it/s, loss=0.6492, grad_norm=1.131, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:05<00:02,  5.69it/s, loss=0.6873, grad_norm=1.576, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  6.36it/s, loss=0.6873, grad_norm=1.576, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  6.36it/s, loss=0.6717, grad_norm=1.384, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:02,  7.04it/s, loss=0.6717, grad_norm=1.384, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:02,  7.04it/s, loss=0.6342, grad_norm=1.218, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  7.59it/s, loss=0.6342, grad_norm=1.218, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  7.59it/s, loss=0.6627, grad_norm=1.242, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:05<00:01,  7.97it/s, loss=0.6627, grad_norm=1.242, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:06<00:01,  7.97it/s, loss=0.6280, grad_norm=1.271, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:06<00:01,  8.32it/s, loss=0.6280, grad_norm=1.271, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:06<00:01,  8.32it/s, loss=0.6168, grad_norm=1.331, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:06<00:01,  8.57it/s, loss=0.6168, grad_norm=1.331, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:06<00:01,  8.57it/s, loss=0.6399, grad_norm=1.279, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:06<00:01,  8.75it/s, loss=0.6399, grad_norm=1.279, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:06<00:01,  8.75it/s, loss=0.6245, grad_norm=1.379, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:06<00:01,  8.90it/s, loss=0.6245, grad_norm=1.379, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:06<00:01,  8.90it/s, loss=0.6215, grad_norm=1.330, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:06<00:00,  8.40it/s, loss=0.6215, grad_norm=1.330, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:06<00:00,  8.40it/s, loss=0.6406, grad_norm=1.464, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  7.64it/s, loss=0.6406, grad_norm=1.464, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  7.64it/s, loss=0.6512, grad_norm=1.672, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  8.01it/s, loss=0.6512, grad_norm=1.672, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  8.01it/s, loss=0.6074, grad_norm=1.554, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:06<00:00,  8.25it/s, loss=0.6074, grad_norm=1.554, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:07<00:00,  8.25it/s, loss=0.6455, grad_norm=1.848, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:07<00:00,  8.43it/s, loss=0.6455, grad_norm=1.848, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:07<00:00,  8.43it/s, loss=0.6133, grad_norm=1.743, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:07<00:00,  8.61it/s, loss=0.6133, grad_norm=1.743, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:07<00:00,  8.61it/s, loss=0.6343, grad_norm=1.635, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:07<00:00,  8.74it/s, loss=0.6343, grad_norm=1.635, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:07<00:00,  8.74it/s, loss=0.5771, grad_norm=1.511, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:07<00:00,  8.88it/s, loss=0.5771, grad_norm=1.511, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:07<00:00,  8.88it/s, loss=0.6102, grad_norm=1.927, lr=0Training Epoch 2/5: 100%|#| 28/28 [00:07<00:00,  8.94it/s, loss=0.6102, grad_norm=1.927, lr=0Training Epoch 2/5: 100%|#| 28/28 [00:08<00:00,  3.49it/s, loss=0.6102, grad_norm=1.927, lr=0

Epoch 2/5 Complete (8.4s) [LR: 0.000010]
Train - Loss: 0.6479, Acc: 0.7242, Precision: 0.7252, Recall: 0.7220, F1: 0.7236, AUC: 0.8010
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.5859, grad_norm=1.710, lr=0.000010]Training Epoch 3/5:   4%| | 1/28 [00:04<01:48,  4.03s/it, loss=0.5859, grad_norm=1.710, lr=0.Training Epoch 3/5:   4%| | 1/28 [00:04<01:48,  4.03s/it, loss=0.5428, grad_norm=1.530, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:45,  1.73s/it, loss=0.5428, grad_norm=1.530, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:45,  1.73s/it, loss=0.5415, grad_norm=1.615, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:24,  1.01it/s, loss=0.5415, grad_norm=1.615, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:24,  1.01it/s, loss=0.4968, grad_norm=1.573, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.54it/s, loss=0.4968, grad_norm=1.573, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.54it/s, loss=0.5155, grad_norm=1.513, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.19it/s, loss=0.5155, grad_norm=1.513, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.19it/s, loss=0.5425, grad_norm=1.835, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.5425, grad_norm=1.835, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.5396, grad_norm=1.575, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.74it/s, loss=0.5396, grad_norm=1.575, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.74it/s, loss=0.5235, grad_norm=1.656, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:04<00:04,  4.56it/s, loss=0.5235, grad_norm=1.656, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:04<00:04,  4.56it/s, loss=0.5479, grad_norm=1.912, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:04<00:03,  5.34it/s, loss=0.5479, grad_norm=1.912, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:05<00:03,  5.34it/s, loss=0.5697, grad_norm=2.429, lr=0.Training Epoch 3/5:  36%|3| 10/28 [00:05<00:02,  6.04it/s, loss=0.5697, grad_norm=2.429, lr=0Training Epoch 3/5:  36%|3| 10/28 [00:05<00:02,  6.04it/s, loss=0.5257, grad_norm=2.237, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.64it/s, loss=0.5257, grad_norm=2.237, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.64it/s, loss=0.5551, grad_norm=2.843, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  7.22it/s, loss=0.5551, grad_norm=2.843, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  7.22it/s, loss=0.4620, grad_norm=2.204, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:01,  7.66it/s, loss=0.4620, grad_norm=2.204, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:01,  7.66it/s, loss=0.5381, grad_norm=2.418, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  8.03it/s, loss=0.5381, grad_norm=2.418, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  8.03it/s, loss=0.4782, grad_norm=2.250, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  8.30it/s, loss=0.4782, grad_norm=2.250, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  8.30it/s, loss=0.4151, grad_norm=2.140, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  8.50it/s, loss=0.4151, grad_norm=2.140, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  8.50it/s, loss=0.5363, grad_norm=2.941, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:05<00:01,  8.65it/s, loss=0.5363, grad_norm=2.941, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:05<00:01,  8.65it/s, loss=0.3953, grad_norm=2.250, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:05<00:01,  8.75it/s, loss=0.3953, grad_norm=2.250, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:06<00:01,  8.75it/s, loss=0.4133, grad_norm=3.441, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:06<00:01,  8.84it/s, loss=0.4133, grad_norm=3.441, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:06<00:01,  8.84it/s, loss=0.4025, grad_norm=2.626, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:00,  8.89it/s, loss=0.4025, grad_norm=2.626, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:00,  8.89it/s, loss=0.3392, grad_norm=2.036, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.91it/s, loss=0.3392, grad_norm=2.036, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.91it/s, loss=0.5693, grad_norm=6.062, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.90it/s, loss=0.5693, grad_norm=6.062, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.90it/s, loss=0.4361, grad_norm=2.470, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  9.09it/s, loss=0.4361, grad_norm=2.470, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  9.09it/s, loss=0.4833, grad_norm=7.335, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  9.15it/s, loss=0.4833, grad_norm=7.335, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  9.15it/s, loss=0.3590, grad_norm=1.804, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:06<00:00,  9.20it/s, loss=0.3590, grad_norm=1.804, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:06<00:00,  9.20it/s, loss=0.3429, grad_norm=2.805, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:06<00:00,  9.17it/s, loss=0.3429, grad_norm=2.805, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:06<00:00,  9.17it/s, loss=0.4397, grad_norm=1.999, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:06<00:00,  9.13it/s, loss=0.4397, grad_norm=1.999, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:07<00:00,  9.13it/s, loss=0.6730, grad_norm=2.958, lr=0Training Epoch 3/5: 100%|#| 28/28 [00:07<00:00,  9.37it/s, loss=0.6730, grad_norm=2.958, lr=0Training Epoch 3/5: 100%|#| 28/28 [00:07<00:00,  3.62it/s, loss=0.6730, grad_norm=2.958, lr=0

Epoch 3/5 Complete (8.2s) [LR: 0.000010]
Train - Loss: 0.4918, Acc: 0.8677, Precision: 0.8596, Recall: 0.8789, F1: 0.8692, AUC: 0.9106
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.3878, grad_norm=4.905, lr=0.000010]Training Epoch 4/5:   4%| | 1/28 [00:04<01:49,  4.07s/it, loss=0.3878, grad_norm=4.905, lr=0.Training Epoch 4/5:   4%| | 1/28 [00:04<01:49,  4.07s/it, loss=0.4321, grad_norm=3.996, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:45,  1.74s/it, loss=0.4321, grad_norm=3.996, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:45,  1.74s/it, loss=0.3313, grad_norm=3.339, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:24,  1.00it/s, loss=0.3313, grad_norm=3.339, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:24,  1.00it/s, loss=0.2972, grad_norm=2.856, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:15,  1.54it/s, loss=0.2972, grad_norm=2.856, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:15,  1.54it/s, loss=0.3311, grad_norm=3.555, lr=0.Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.20it/s, loss=0.3311, grad_norm=3.555, lr=0.Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.20it/s, loss=0.2506, grad_norm=1.605, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  2.96it/s, loss=0.2506, grad_norm=1.605, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  2.96it/s, loss=0.2847, grad_norm=2.252, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.81it/s, loss=0.2847, grad_norm=2.252, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.81it/s, loss=0.2290, grad_norm=1.277, lr=0.Training Epoch 4/5:  29%|2| 8/28 [00:04<00:04,  4.67it/s, loss=0.2290, grad_norm=1.277, lr=0.Training Epoch 4/5:  29%|2| 8/28 [00:04<00:04,  4.67it/s, loss=0.3706, grad_norm=4.983, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:04<00:03,  5.50it/s, loss=0.3706, grad_norm=4.983, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:05<00:03,  5.50it/s, loss=0.4476, grad_norm=16.201, lr=0Training Epoch 4/5:  36%|3| 10/28 [00:05<00:02,  6.29it/s, loss=0.4476, grad_norm=16.201, lr=Training Epoch 4/5:  36%|3| 10/28 [00:05<00:02,  6.29it/s, loss=0.4048, grad_norm=4.560, lr=0Training Epoch 4/5:  39%|3| 11/28 [00:05<00:02,  6.93it/s, loss=0.4048, grad_norm=4.560, lr=0Training Epoch 4/5:  39%|3| 11/28 [00:05<00:02,  6.93it/s, loss=0.2269, grad_norm=2.729, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  7.45it/s, loss=0.2269, grad_norm=2.729, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  7.45it/s, loss=0.2895, grad_norm=3.169, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:01,  7.90it/s, loss=0.2895, grad_norm=3.169, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:01,  7.90it/s, loss=0.1877, grad_norm=2.171, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:01,  8.26it/s, loss=0.1877, grad_norm=2.171, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:01,  8.26it/s, loss=0.2082, grad_norm=2.251, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:05<00:01,  8.56it/s, loss=0.2082, grad_norm=2.251, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:05<00:01,  8.56it/s, loss=0.2560, grad_norm=7.022, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:05<00:01,  8.71it/s, loss=0.2560, grad_norm=7.022, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:05<00:01,  8.71it/s, loss=0.2813, grad_norm=5.797, lr=0Training Epoch 4/5:  61%|6| 17/28 [00:05<00:01,  8.84it/s, loss=0.2813, grad_norm=5.797, lr=0Training Epoch 4/5:  61%|6| 17/28 [00:05<00:01,  8.84it/s, loss=0.2932, grad_norm=5.054, lr=0Training Epoch 4/5:  64%|6| 18/28 [00:05<00:01,  8.92it/s, loss=0.2932, grad_norm=5.054, lr=0Training Epoch 4/5:  64%|6| 18/28 [00:06<00:01,  8.92it/s, loss=0.1268, grad_norm=2.183, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:06<00:01,  8.96it/s, loss=0.1268, grad_norm=2.183, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:06<00:01,  8.96it/s, loss=0.5244, grad_norm=4.986, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:06<00:00,  9.00it/s, loss=0.5244, grad_norm=4.986, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:06<00:00,  9.00it/s, loss=0.3034, grad_norm=3.439, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  9.01it/s, loss=0.3034, grad_norm=3.439, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  9.01it/s, loss=0.1983, grad_norm=5.559, lr=0Training Epoch 4/5:  79%|7| 22/28 [00:06<00:00,  8.94it/s, loss=0.1983, grad_norm=5.559, lr=0Training Epoch 4/5:  79%|7| 22/28 [00:06<00:00,  8.94it/s, loss=0.1619, grad_norm=3.623, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:06<00:00,  9.03it/s, loss=0.1619, grad_norm=3.623, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:06<00:00,  9.03it/s, loss=0.1297, grad_norm=2.793, lr=0Training Epoch 4/5:  86%|8| 24/28 [00:06<00:00,  8.89it/s, loss=0.1297, grad_norm=2.793, lr=0Training Epoch 4/5:  86%|8| 24/28 [00:06<00:00,  8.89it/s, loss=0.2518, grad_norm=6.350, lr=0Training Epoch 4/5:  89%|8| 25/28 [00:06<00:00,  7.65it/s, loss=0.2518, grad_norm=6.350, lr=0Training Epoch 4/5:  89%|8| 25/28 [00:06<00:00,  7.65it/s, loss=0.1488, grad_norm=3.587, lr=0Training Epoch 4/5:  93%|9| 26/28 [00:06<00:00,  8.00it/s, loss=0.1488, grad_norm=3.587, lr=0Training Epoch 4/5:  93%|9| 26/28 [00:07<00:00,  8.00it/s, loss=0.2207, grad_norm=4.960, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:07<00:00,  7.54it/s, loss=0.2207, grad_norm=4.960, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:07<00:00,  7.54it/s, loss=0.0934, grad_norm=1.406, lr=0Training Epoch 4/5: 100%|#| 28/28 [00:07<00:00,  7.55it/s, loss=0.0934, grad_norm=1.406, lr=0Training Epoch 4/5: 100%|#| 28/28 [00:07<00:00,  3.58it/s, loss=0.0934, grad_norm=1.406, lr=0

Epoch 4/5 Complete (8.2s) [LR: 0.000010]
Train - Loss: 0.2739, Acc: 0.9058, Precision: 0.9022, Recall: 0.9103, F1: 0.9062, AUC: 0.9682
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/28 [00:03<?, ?it/s, loss=0.1662, grad_norm=4.303, lr=0.000010]Training Epoch 5/5:   4%| | 1/28 [00:03<01:47,  3.99s/it, loss=0.1662, grad_norm=4.303, lr=0.Training Epoch 5/5:   4%| | 1/28 [00:04<01:47,  3.99s/it, loss=0.1559, grad_norm=4.826, lr=0.Training Epoch 5/5:   7%| | 2/28 [00:04<00:44,  1.73s/it, loss=0.1559, grad_norm=4.826, lr=0.Training Epoch 5/5:   7%| | 2/28 [00:04<00:44,  1.73s/it, loss=0.1023, grad_norm=2.463, lr=0.Training Epoch 5/5:  11%|1| 3/28 [00:04<00:24,  1.01it/s, loss=0.1023, grad_norm=2.463, lr=0.Training Epoch 5/5:  11%|1| 3/28 [00:04<00:24,  1.01it/s, loss=0.1117, grad_norm=1.699, lr=0.Training Epoch 5/5:  14%|1| 4/28 [00:04<00:15,  1.56it/s, loss=0.1117, grad_norm=1.699, lr=0.Training Epoch 5/5:  14%|1| 4/28 [00:04<00:15,  1.56it/s, loss=0.1171, grad_norm=2.799, lr=0.Training Epoch 5/5:  18%|1| 5/28 [00:04<00:10,  2.22it/s, loss=0.1171, grad_norm=2.799, lr=0.Training Epoch 5/5:  18%|1| 5/28 [00:04<00:10,  2.22it/s, loss=0.0737, grad_norm=2.853, lr=0.Training Epoch 5/5:  21%|2| 6/28 [00:04<00:07,  2.99it/s, loss=0.0737, grad_norm=2.853, lr=0.Training Epoch 5/5:  21%|2| 6/28 [00:04<00:07,  2.99it/s, loss=0.0850, grad_norm=3.526, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:04<00:05,  3.83it/s, loss=0.0850, grad_norm=3.526, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:04<00:05,  3.83it/s, loss=0.0483, grad_norm=1.269, lr=0.Training Epoch 5/5:  29%|2| 8/28 [00:04<00:04,  4.70it/s, loss=0.0483, grad_norm=1.269, lr=0.Training Epoch 5/5:  29%|2| 8/28 [00:04<00:04,  4.70it/s, loss=0.2325, grad_norm=13.653, lr=0Training Epoch 5/5:  32%|3| 9/28 [00:04<00:03,  5.53it/s, loss=0.2325, grad_norm=13.653, lr=0Training Epoch 5/5:  32%|3| 9/28 [00:05<00:03,  5.53it/s, loss=0.0779, grad_norm=1.531, lr=0.Training Epoch 5/5:  36%|3| 10/28 [00:05<00:02,  6.30it/s, loss=0.0779, grad_norm=1.531, lr=0Training Epoch 5/5:  36%|3| 10/28 [00:05<00:02,  6.30it/s, loss=0.1034, grad_norm=3.549, lr=0Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  6.91it/s, loss=0.1034, grad_norm=3.549, lr=0Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  6.91it/s, loss=0.0929, grad_norm=4.512, lr=0Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  7.46it/s, loss=0.0929, grad_norm=4.512, lr=0Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  7.46it/s, loss=0.0786, grad_norm=3.844, lr=0Training Epoch 5/5:  46%|4| 13/28 [00:05<00:01,  7.89it/s, loss=0.0786, grad_norm=3.844, lr=0Training Epoch 5/5:  46%|4| 13/28 [00:05<00:01,  7.89it/s, loss=0.1174, grad_norm=7.377, lr=0Training Epoch 5/5:  50%|5| 14/28 [00:05<00:01,  8.23it/s, loss=0.1174, grad_norm=7.377, lr=0Training Epoch 5/5:  50%|5| 14/28 [00:05<00:01,  8.23it/s, loss=0.1860, grad_norm=8.994, lr=0Training Epoch 5/5:  54%|5| 15/28 [00:05<00:01,  8.51it/s, loss=0.1860, grad_norm=8.994, lr=0Training Epoch 5/5:  54%|5| 15/28 [00:05<00:01,  8.51it/s, loss=0.0501, grad_norm=0.945, lr=0Training Epoch 5/5:  57%|5| 16/28 [00:05<00:01,  8.68it/s, loss=0.0501, grad_norm=0.945, lr=0Training Epoch 5/5:  57%|5| 16/28 [00:05<00:01,  8.68it/s, loss=0.0747, grad_norm=3.529, lr=0Training Epoch 5/5:  61%|6| 17/28 [00:05<00:01,  8.83it/s, loss=0.0747, grad_norm=3.529, lr=0Training Epoch 5/5:  61%|6| 17/28 [00:05<00:01,  8.83it/s, loss=0.0717, grad_norm=2.989, lr=0Training Epoch 5/5:  64%|6| 18/28 [00:05<00:01,  8.92it/s, loss=0.0717, grad_norm=2.989, lr=0Training Epoch 5/5:  64%|6| 18/28 [00:05<00:01,  8.92it/s, loss=0.0894, grad_norm=7.267, lr=0Training Epoch 5/5:  68%|6| 19/28 [00:05<00:01,  8.99it/s, loss=0.0894, grad_norm=7.267, lr=0Training Epoch 5/5:  68%|6| 19/28 [00:06<00:01,  8.99it/s, loss=0.1339, grad_norm=7.900, lr=0Training Epoch 5/5:  71%|7| 20/28 [00:06<00:00,  8.93it/s, loss=0.1339, grad_norm=7.900, lr=0Training Epoch 5/5:  71%|7| 20/28 [00:06<00:00,  8.93it/s, loss=0.0658, grad_norm=5.111, lr=0Training Epoch 5/5:  75%|7| 21/28 [00:06<00:00,  8.96it/s, loss=0.0658, grad_norm=5.111, lr=0Training Epoch 5/5:  75%|7| 21/28 [00:06<00:00,  8.96it/s, loss=0.1916, grad_norm=10.981, lr=Training Epoch 5/5:  79%|7| 22/28 [00:06<00:00,  9.06it/s, loss=0.1916, grad_norm=10.981, lr=Training Epoch 5/5:  79%|7| 22/28 [00:06<00:00,  9.06it/s, loss=0.1852, grad_norm=8.728, lr=0Training Epoch 5/5:  82%|8| 23/28 [00:06<00:00,  9.20it/s, loss=0.1852, grad_norm=8.728, lr=0Training Epoch 5/5:  82%|8| 23/28 [00:06<00:00,  9.20it/s, loss=0.0495, grad_norm=3.101, lr=0Training Epoch 5/5:  86%|8| 24/28 [00:06<00:00,  9.25it/s, loss=0.0495, grad_norm=3.101, lr=0Training Epoch 5/5:  86%|8| 24/28 [00:06<00:00,  9.25it/s, loss=0.0206, grad_norm=0.699, lr=0Training Epoch 5/5:  89%|8| 25/28 [00:06<00:00,  9.35it/s, loss=0.0206, grad_norm=0.699, lr=0Training Epoch 5/5:  89%|8| 25/28 [00:06<00:00,  9.35it/s, loss=0.0471, grad_norm=5.329, lr=0Training Epoch 5/5:  93%|9| 26/28 [00:06<00:00,  9.24it/s, loss=0.0471, grad_norm=5.329, lr=0Training Epoch 5/5:  93%|9| 26/28 [00:06<00:00,  9.24it/s, loss=0.0413, grad_norm=2.949, lr=0Training Epoch 5/5:  96%|9| 27/28 [00:06<00:00,  9.17it/s, loss=0.0413, grad_norm=2.949, lr=0Training Epoch 5/5:  96%|9| 27/28 [00:06<00:00,  9.17it/s, loss=0.0541, grad_norm=4.861, lr=0Training Epoch 5/5: 100%|#| 28/28 [00:07<00:00,  3.71it/s, loss=0.0541, grad_norm=4.861, lr=0

Epoch 5/5 Complete (7.9s) [LR: 0.000005]
Train - Loss: 0.1009, Acc: 0.9865, Precision: 0.9822, Recall: 0.9910, F1: 0.9866, AUC: 0.9958
------------------------------------------------------------
Training curves saved to model\chb13_fold4\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold4
============================================================
✅ Fold 4 training completed successfully!

============================================================
TRAINING FOLD 5/11
============================================================
Using dataset prefix: chb13_fold5
Loading datasets from: preprocessing\data\chb13_fold5
Saving models to: model\chb13_fold5
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.3354, std=2.4500
Loaded train dataset: 434 samples
  - Spectrogram shape: torch.Size([434, 30, 18, 50, 10])
  - Value range: [-5.0348, 3.5519]
  - Class distribution: tensor([217, 217])
LOOCV Mode (Fold 5): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.7050, grad_norm=1.248, lr=0.000010]Training Epoch 1/5:   4%| | 1/28 [00:04<01:49,  4.06s/it, loss=0.7050, grad_norm=1.248, lr=0.Training Epoch 1/5:   4%| | 1/28 [00:04<01:49,  4.06s/it, loss=0.6923, grad_norm=1.232, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:45,  1.75s/it, loss=0.6923, grad_norm=1.232, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:45,  1.75s/it, loss=0.6814, grad_norm=1.238, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:25,  1.01s/it, loss=0.6814, grad_norm=1.238, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:25,  1.01s/it, loss=0.6895, grad_norm=1.111, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.50it/s, loss=0.6895, grad_norm=1.111, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.50it/s, loss=0.6983, grad_norm=1.333, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.15it/s, loss=0.6983, grad_norm=1.333, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.15it/s, loss=0.6781, grad_norm=1.083, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  2.91it/s, loss=0.6781, grad_norm=1.083, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  2.91it/s, loss=0.7003, grad_norm=1.185, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.76it/s, loss=0.7003, grad_norm=1.185, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.76it/s, loss=0.6766, grad_norm=1.326, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:04<00:04,  4.61it/s, loss=0.6766, grad_norm=1.326, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:05<00:04,  4.61it/s, loss=0.6776, grad_norm=1.169, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:05<00:03,  5.29it/s, loss=0.6776, grad_norm=1.169, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:05<00:03,  5.29it/s, loss=0.6928, grad_norm=1.219, lr=0.Training Epoch 1/5:  36%|3| 10/28 [00:05<00:03,  5.75it/s, loss=0.6928, grad_norm=1.219, lr=0Training Epoch 1/5:  36%|3| 10/28 [00:05<00:03,  5.75it/s, loss=0.7005, grad_norm=1.219, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.45it/s, loss=0.7005, grad_norm=1.219, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.45it/s, loss=0.6614, grad_norm=1.343, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.14it/s, loss=0.6614, grad_norm=1.343, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.14it/s, loss=0.7192, grad_norm=1.435, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:02,  7.12it/s, loss=0.7192, grad_norm=1.435, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:02,  7.12it/s, loss=0.7028, grad_norm=1.304, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  7.44it/s, loss=0.7028, grad_norm=1.304, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  7.44it/s, loss=0.7110, grad_norm=1.636, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  7.86it/s, loss=0.7110, grad_norm=1.636, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  7.86it/s, loss=0.7034, grad_norm=1.366, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.21it/s, loss=0.7034, grad_norm=1.366, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.21it/s, loss=0.6703, grad_norm=1.142, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:05<00:01,  8.39it/s, loss=0.6703, grad_norm=1.142, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:06<00:01,  8.39it/s, loss=0.7006, grad_norm=1.535, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:06<00:01,  8.66it/s, loss=0.7006, grad_norm=1.535, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:06<00:01,  8.66it/s, loss=0.6710, grad_norm=1.161, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:01,  8.84it/s, loss=0.6710, grad_norm=1.161, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:01,  8.84it/s, loss=0.6897, grad_norm=1.227, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  8.96it/s, loss=0.6897, grad_norm=1.227, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  8.96it/s, loss=0.6614, grad_norm=1.314, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  9.05it/s, loss=0.6614, grad_norm=1.314, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  9.05it/s, loss=0.6944, grad_norm=1.415, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  9.10it/s, loss=0.6944, grad_norm=1.415, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  9.10it/s, loss=0.6849, grad_norm=1.374, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  9.07it/s, loss=0.6849, grad_norm=1.374, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  9.07it/s, loss=0.6785, grad_norm=1.255, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  8.43it/s, loss=0.6785, grad_norm=1.255, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  8.43it/s, loss=0.6821, grad_norm=1.394, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:06<00:00,  8.60it/s, loss=0.6821, grad_norm=1.394, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:07<00:00,  8.60it/s, loss=0.6698, grad_norm=1.192, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:07<00:00,  8.24it/s, loss=0.6698, grad_norm=1.192, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:07<00:00,  8.24it/s, loss=0.6622, grad_norm=1.155, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:07<00:00,  8.24it/s, loss=0.6622, grad_norm=1.155, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:07<00:00,  8.24it/s, loss=0.6359, grad_norm=3.162, lr=0Training Epoch 1/5: 100%|#| 28/28 [00:07<00:00,  3.62it/s, loss=0.6359, grad_norm=3.162, lr=0

Epoch 1/5 Complete (8.1s) [LR: 0.000010]
Train - Loss: 0.6854, Acc: 0.5507, Precision: 0.6222, Recall: 0.2581, F1: 0.3648, AUC: 0.5965
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/28 [00:03<?, ?it/s, loss=0.6870, grad_norm=1.429, lr=0.000010]Training Epoch 2/5:   4%| | 1/28 [00:03<01:45,  3.91s/it, loss=0.6870, grad_norm=1.429, lr=0.Training Epoch 2/5:   4%| | 1/28 [00:04<01:45,  3.91s/it, loss=0.6747, grad_norm=1.204, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:43,  1.68s/it, loss=0.6747, grad_norm=1.204, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:43,  1.68s/it, loss=0.6470, grad_norm=1.186, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:23,  1.04it/s, loss=0.6470, grad_norm=1.186, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:23,  1.04it/s, loss=0.6517, grad_norm=1.250, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:14,  1.60it/s, loss=0.6517, grad_norm=1.250, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:14,  1.60it/s, loss=0.6521, grad_norm=1.465, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:10,  2.29it/s, loss=0.6521, grad_norm=1.465, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:10,  2.29it/s, loss=0.6689, grad_norm=1.354, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  3.08it/s, loss=0.6689, grad_norm=1.354, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  3.08it/s, loss=0.6882, grad_norm=1.338, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:04<00:05,  3.93it/s, loss=0.6882, grad_norm=1.338, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:04<00:05,  3.93it/s, loss=0.6167, grad_norm=1.351, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:04<00:04,  4.82it/s, loss=0.6167, grad_norm=1.351, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:04<00:04,  4.82it/s, loss=0.6926, grad_norm=1.542, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:04<00:03,  5.68it/s, loss=0.6926, grad_norm=1.542, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:04<00:03,  5.68it/s, loss=0.6577, grad_norm=1.435, lr=0.Training Epoch 2/5:  36%|3| 10/28 [00:04<00:02,  6.44it/s, loss=0.6577, grad_norm=1.435, lr=0Training Epoch 2/5:  36%|3| 10/28 [00:04<00:02,  6.44it/s, loss=0.6653, grad_norm=1.377, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:04<00:02,  7.10it/s, loss=0.6653, grad_norm=1.377, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:05<00:02,  7.10it/s, loss=0.6619, grad_norm=1.441, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  7.64it/s, loss=0.6619, grad_norm=1.441, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  7.64it/s, loss=0.6521, grad_norm=1.652, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:01,  8.08it/s, loss=0.6521, grad_norm=1.652, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:01,  8.08it/s, loss=0.6848, grad_norm=1.697, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  8.43it/s, loss=0.6848, grad_norm=1.697, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  8.43it/s, loss=0.6447, grad_norm=1.380, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:05<00:01,  8.67it/s, loss=0.6447, grad_norm=1.380, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:05<00:01,  8.67it/s, loss=0.6513, grad_norm=1.563, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:05<00:01,  8.84it/s, loss=0.6513, grad_norm=1.563, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:05<00:01,  8.84it/s, loss=0.6462, grad_norm=1.697, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:05<00:01,  8.95it/s, loss=0.6462, grad_norm=1.697, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:05<00:01,  8.95it/s, loss=0.6744, grad_norm=2.025, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:05<00:01,  8.99it/s, loss=0.6744, grad_norm=2.025, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:05<00:01,  8.99it/s, loss=0.6506, grad_norm=1.983, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:05<00:00,  9.02it/s, loss=0.6506, grad_norm=1.983, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:05<00:00,  9.02it/s, loss=0.6326, grad_norm=1.716, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:05<00:00,  9.05it/s, loss=0.6326, grad_norm=1.716, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:06<00:00,  9.05it/s, loss=0.6373, grad_norm=1.922, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  9.18it/s, loss=0.6373, grad_norm=1.922, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  9.18it/s, loss=0.5821, grad_norm=1.744, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  9.28it/s, loss=0.5821, grad_norm=1.744, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  9.28it/s, loss=0.5927, grad_norm=1.539, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:06<00:00,  9.24it/s, loss=0.5927, grad_norm=1.539, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:06<00:00,  9.24it/s, loss=0.6227, grad_norm=1.844, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:06<00:00,  9.24it/s, loss=0.6227, grad_norm=1.844, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:06<00:00,  9.24it/s, loss=0.6110, grad_norm=1.747, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:06<00:00,  9.25it/s, loss=0.6110, grad_norm=1.747, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:06<00:00,  9.25it/s, loss=0.5775, grad_norm=1.758, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:06<00:00,  9.25it/s, loss=0.5775, grad_norm=1.758, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:06<00:00,  9.25it/s, loss=0.5860, grad_norm=1.846, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:06<00:00,  9.25it/s, loss=0.5860, grad_norm=1.846, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:06<00:00,  9.25it/s, loss=0.7441, grad_norm=3.951, lr=0Training Epoch 2/5: 100%|#| 28/28 [00:07<00:00,  3.82it/s, loss=0.7441, grad_norm=3.951, lr=0

Epoch 2/5 Complete (7.7s) [LR: 0.000010]
Train - Loss: 0.6484, Acc: 0.7028, Precision: 0.6833, Recall: 0.7558, F1: 0.7177, AUC: 0.7805
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/28 [00:03<?, ?it/s, loss=0.6052, grad_norm=2.186, lr=0.000010]Training Epoch 3/5:   4%| | 1/28 [00:03<01:47,  3.98s/it, loss=0.6052, grad_norm=2.186, lr=0.Training Epoch 3/5:   4%| | 1/28 [00:04<01:47,  3.98s/it, loss=0.5981, grad_norm=2.029, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:44,  1.71s/it, loss=0.5981, grad_norm=2.029, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:44,  1.71s/it, loss=0.6283, grad_norm=3.840, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.6283, grad_norm=3.840, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.5348, grad_norm=1.915, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.56it/s, loss=0.5348, grad_norm=1.915, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.56it/s, loss=0.5564, grad_norm=1.922, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.22it/s, loss=0.5564, grad_norm=1.922, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.22it/s, loss=0.4979, grad_norm=2.017, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.99it/s, loss=0.4979, grad_norm=2.017, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.99it/s, loss=0.5373, grad_norm=3.379, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.85it/s, loss=0.5373, grad_norm=3.379, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.85it/s, loss=0.5477, grad_norm=2.186, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:04<00:04,  4.70it/s, loss=0.5477, grad_norm=2.186, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:04<00:04,  4.70it/s, loss=0.5124, grad_norm=2.093, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:04<00:03,  5.53it/s, loss=0.5124, grad_norm=2.093, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:04<00:03,  5.53it/s, loss=0.5099, grad_norm=2.938, lr=0.Training Epoch 3/5:  36%|3| 10/28 [00:04<00:02,  6.28it/s, loss=0.5099, grad_norm=2.938, lr=0Training Epoch 3/5:  36%|3| 10/28 [00:05<00:02,  6.28it/s, loss=0.6004, grad_norm=3.018, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.88it/s, loss=0.6004, grad_norm=3.018, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.88it/s, loss=0.5241, grad_norm=2.870, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  7.44it/s, loss=0.5241, grad_norm=2.870, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  7.44it/s, loss=0.4545, grad_norm=2.169, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:01,  7.83it/s, loss=0.4545, grad_norm=2.169, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:01,  7.83it/s, loss=0.5327, grad_norm=6.869, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  8.17it/s, loss=0.5327, grad_norm=6.869, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  8.17it/s, loss=0.4783, grad_norm=1.744, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  8.38it/s, loss=0.4783, grad_norm=1.744, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  8.38it/s, loss=0.4941, grad_norm=2.908, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  8.58it/s, loss=0.4941, grad_norm=2.908, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  8.58it/s, loss=0.4513, grad_norm=3.210, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:05<00:01,  8.77it/s, loss=0.4513, grad_norm=3.210, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:05<00:01,  8.77it/s, loss=0.5331, grad_norm=2.430, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:05<00:01,  8.83it/s, loss=0.5331, grad_norm=2.430, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:05<00:01,  8.83it/s, loss=0.4406, grad_norm=2.098, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:05<00:01,  8.91it/s, loss=0.4406, grad_norm=2.098, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:06<00:01,  8.91it/s, loss=0.4682, grad_norm=2.874, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:00,  8.85it/s, loss=0.4682, grad_norm=2.874, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:00,  8.85it/s, loss=0.5251, grad_norm=3.354, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.89it/s, loss=0.5251, grad_norm=3.354, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.89it/s, loss=0.3670, grad_norm=2.030, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.94it/s, loss=0.3670, grad_norm=2.030, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.94it/s, loss=0.3843, grad_norm=2.369, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  8.95it/s, loss=0.3843, grad_norm=2.369, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  8.95it/s, loss=0.4721, grad_norm=2.736, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  8.96it/s, loss=0.4721, grad_norm=2.736, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  8.96it/s, loss=0.4334, grad_norm=2.121, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:06<00:00,  8.97it/s, loss=0.4334, grad_norm=2.121, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:06<00:00,  8.97it/s, loss=0.4118, grad_norm=2.715, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:06<00:00,  9.13it/s, loss=0.4118, grad_norm=2.715, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:06<00:00,  9.13it/s, loss=0.3119, grad_norm=1.824, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:06<00:00,  9.10it/s, loss=0.3119, grad_norm=1.824, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:06<00:00,  9.10it/s, loss=0.3023, grad_norm=3.684, lr=0Training Epoch 3/5: 100%|#| 28/28 [00:07<00:00,  3.74it/s, loss=0.3023, grad_norm=3.684, lr=0

Epoch 3/5 Complete (7.9s) [LR: 0.000010]
Train - Loss: 0.4898, Acc: 0.8571, Precision: 0.8039, Recall: 0.9447, F1: 0.8686, AUC: 0.9275
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/28 [00:03<?, ?it/s, loss=0.4310, grad_norm=3.507, lr=0.000010]Training Epoch 4/5:   4%| | 1/28 [00:03<01:45,  3.89s/it, loss=0.4310, grad_norm=3.507, lr=0.Training Epoch 4/5:   4%| | 1/28 [00:04<01:45,  3.89s/it, loss=0.3976, grad_norm=3.767, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:43,  1.67s/it, loss=0.3976, grad_norm=3.767, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:43,  1.67s/it, loss=0.2438, grad_norm=1.664, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:23,  1.05it/s, loss=0.2438, grad_norm=1.664, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:23,  1.05it/s, loss=0.3674, grad_norm=5.137, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:14,  1.60it/s, loss=0.3674, grad_norm=5.137, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:14,  1.60it/s, loss=0.2957, grad_norm=3.000, lr=0.Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.28it/s, loss=0.2957, grad_norm=3.000, lr=0.Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.28it/s, loss=0.2451, grad_norm=1.774, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  3.07it/s, loss=0.2451, grad_norm=1.774, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  3.07it/s, loss=0.2609, grad_norm=2.657, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.92it/s, loss=0.2609, grad_norm=2.657, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.92it/s, loss=0.3851, grad_norm=10.688, lr=0Training Epoch 4/5:  29%|2| 8/28 [00:04<00:04,  4.79it/s, loss=0.3851, grad_norm=10.688, lr=0Training Epoch 4/5:  29%|2| 8/28 [00:04<00:04,  4.79it/s, loss=0.3478, grad_norm=8.798, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:04<00:03,  5.65it/s, loss=0.3478, grad_norm=8.798, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:04<00:03,  5.65it/s, loss=0.3816, grad_norm=3.257, lr=0.Training Epoch 4/5:  36%|3| 10/28 [00:04<00:02,  6.39it/s, loss=0.3816, grad_norm=3.257, lr=0Training Epoch 4/5:  36%|3| 10/28 [00:04<00:02,  6.39it/s, loss=0.7768, grad_norm=15.488, lr=Training Epoch 4/5:  39%|3| 11/28 [00:04<00:02,  7.03it/s, loss=0.7768, grad_norm=15.488, lr=Training Epoch 4/5:  39%|3| 11/28 [00:05<00:02,  7.03it/s, loss=0.2755, grad_norm=1.523, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  7.54it/s, loss=0.2755, grad_norm=1.523, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  7.54it/s, loss=0.2107, grad_norm=4.704, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:01,  7.94it/s, loss=0.2107, grad_norm=4.704, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:01,  7.94it/s, loss=0.3051, grad_norm=5.944, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:01,  8.22it/s, loss=0.3051, grad_norm=5.944, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:01,  8.22it/s, loss=0.2631, grad_norm=5.753, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:05<00:01,  8.52it/s, loss=0.2631, grad_norm=5.753, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:05<00:01,  8.52it/s, loss=0.2505, grad_norm=5.404, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:05<00:01,  8.68it/s, loss=0.2505, grad_norm=5.404, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:05<00:01,  8.68it/s, loss=0.3576, grad_norm=12.554, lr=Training Epoch 4/5:  61%|6| 17/28 [00:05<00:01,  8.82it/s, loss=0.3576, grad_norm=12.554, lr=Training Epoch 4/5:  61%|6| 17/28 [00:05<00:01,  8.82it/s, loss=0.3465, grad_norm=10.430, lr=Training Epoch 4/5:  64%|6| 18/28 [00:05<00:01,  8.89it/s, loss=0.3465, grad_norm=10.430, lr=Training Epoch 4/5:  64%|6| 18/28 [00:05<00:01,  8.89it/s, loss=0.1910, grad_norm=4.348, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:05<00:01,  8.89it/s, loss=0.1910, grad_norm=4.348, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:05<00:01,  8.89it/s, loss=0.1303, grad_norm=1.489, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:05<00:00,  8.92it/s, loss=0.1303, grad_norm=1.489, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:06<00:00,  8.92it/s, loss=0.1999, grad_norm=2.856, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  9.04it/s, loss=0.1999, grad_norm=2.856, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  9.04it/s, loss=0.3126, grad_norm=5.105, lr=0Training Epoch 4/5:  79%|7| 22/28 [00:06<00:00,  9.04it/s, loss=0.3126, grad_norm=5.105, lr=0Training Epoch 4/5:  79%|7| 22/28 [00:06<00:00,  9.04it/s, loss=0.1720, grad_norm=3.229, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:06<00:00,  9.10it/s, loss=0.1720, grad_norm=3.229, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:06<00:00,  9.10it/s, loss=0.1958, grad_norm=10.242, lr=Training Epoch 4/5:  86%|8| 24/28 [00:06<00:00,  9.20it/s, loss=0.1958, grad_norm=10.242, lr=Training Epoch 4/5:  86%|8| 24/28 [00:06<00:00,  9.20it/s, loss=0.1513, grad_norm=2.369, lr=0Training Epoch 4/5:  89%|8| 25/28 [00:06<00:00,  9.16it/s, loss=0.1513, grad_norm=2.369, lr=0Training Epoch 4/5:  89%|8| 25/28 [00:06<00:00,  9.16it/s, loss=0.1466, grad_norm=2.754, lr=0Training Epoch 4/5:  93%|9| 26/28 [00:06<00:00,  9.14it/s, loss=0.1466, grad_norm=2.754, lr=0Training Epoch 4/5:  93%|9| 26/28 [00:06<00:00,  9.14it/s, loss=0.1447, grad_norm=4.523, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:06<00:00,  9.10it/s, loss=0.1447, grad_norm=4.523, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:06<00:00,  9.10it/s, loss=0.4694, grad_norm=12.746, lr=Training Epoch 4/5: 100%|#| 28/28 [00:07<00:00,  3.81it/s, loss=0.4694, grad_norm=12.746, lr=

Epoch 4/5 Complete (7.7s) [LR: 0.000010]
Train - Loss: 0.2948, Acc: 0.9194, Precision: 0.8922, Recall: 0.9539, F1: 0.9220, AUC: 0.9680
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.1955, grad_norm=5.667, lr=0.000010]Training Epoch 5/5:   4%| | 1/28 [00:04<01:50,  4.10s/it, loss=0.1955, grad_norm=5.667, lr=0.Training Epoch 5/5:   4%| | 1/28 [00:04<01:50,  4.10s/it, loss=0.1244, grad_norm=1.206, lr=0.Training Epoch 5/5:   7%| | 2/28 [00:04<00:46,  1.77s/it, loss=0.1244, grad_norm=1.206, lr=0.Training Epoch 5/5:   7%| | 2/28 [00:04<00:46,  1.77s/it, loss=0.1299, grad_norm=3.145, lr=0.Training Epoch 5/5:  11%|1| 3/28 [00:04<00:25,  1.02s/it, loss=0.1299, grad_norm=3.145, lr=0.Training Epoch 5/5:  11%|1| 3/28 [00:04<00:25,  1.02s/it, loss=0.1538, grad_norm=8.210, lr=0.Training Epoch 5/5:  14%|1| 4/28 [00:04<00:15,  1.51it/s, loss=0.1538, grad_norm=8.210, lr=0.Training Epoch 5/5:  14%|1| 4/28 [00:04<00:15,  1.51it/s, loss=0.2002, grad_norm=11.267, lr=0Training Epoch 5/5:  18%|1| 5/28 [00:04<00:10,  2.14it/s, loss=0.2002, grad_norm=11.267, lr=0Training Epoch 5/5:  18%|1| 5/28 [00:04<00:10,  2.14it/s, loss=0.1153, grad_norm=6.861, lr=0.Training Epoch 5/5:  21%|2| 6/28 [00:04<00:07,  2.87it/s, loss=0.1153, grad_norm=6.861, lr=0.Training Epoch 5/5:  21%|2| 6/28 [00:04<00:07,  2.87it/s, loss=0.0875, grad_norm=1.721, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:04<00:05,  3.56it/s, loss=0.0875, grad_norm=1.721, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:05<00:05,  3.56it/s, loss=0.1122, grad_norm=3.193, lr=0.Training Epoch 5/5:  29%|2| 8/28 [00:05<00:04,  4.25it/s, loss=0.1122, grad_norm=3.193, lr=0.Training Epoch 5/5:  29%|2| 8/28 [00:05<00:04,  4.25it/s, loss=0.0755, grad_norm=2.399, lr=0.Training Epoch 5/5:  32%|3| 9/28 [00:05<00:03,  5.00it/s, loss=0.0755, grad_norm=2.399, lr=0.Training Epoch 5/5:  32%|3| 9/28 [00:05<00:03,  5.00it/s, loss=0.0821, grad_norm=4.154, lr=0.Training Epoch 5/5:  36%|3| 10/28 [00:05<00:03,  5.66it/s, loss=0.0821, grad_norm=4.154, lr=0Training Epoch 5/5:  36%|3| 10/28 [00:05<00:03,  5.66it/s, loss=0.0547, grad_norm=1.961, lr=0Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  6.06it/s, loss=0.0547, grad_norm=1.961, lr=0Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  6.06it/s, loss=0.0956, grad_norm=6.885, lr=0Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  6.46it/s, loss=0.0956, grad_norm=6.885, lr=0Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  6.46it/s, loss=0.1846, grad_norm=9.981, lr=0Training Epoch 5/5:  46%|4| 13/28 [00:05<00:02,  6.98it/s, loss=0.1846, grad_norm=9.981, lr=0Training Epoch 5/5:  46%|4| 13/28 [00:05<00:02,  6.98it/s, loss=0.3903, grad_norm=13.830, lr=Training Epoch 5/5:  50%|5| 14/28 [00:05<00:01,  7.47it/s, loss=0.3903, grad_norm=13.830, lr=Training Epoch 5/5:  50%|5| 14/28 [00:05<00:01,  7.47it/s, loss=0.6468, grad_norm=21.099, lr=Training Epoch 5/5:  54%|5| 15/28 [00:05<00:01,  7.44it/s, loss=0.6468, grad_norm=21.099, lr=Training Epoch 5/5:  54%|5| 15/28 [00:06<00:01,  7.44it/s, loss=0.1400, grad_norm=14.266, lr=Training Epoch 5/5:  57%|5| 16/28 [00:06<00:01,  7.36it/s, loss=0.1400, grad_norm=14.266, lr=Training Epoch 5/5:  57%|5| 16/28 [00:06<00:01,  7.36it/s, loss=0.7169, grad_norm=32.332, lr=Training Epoch 5/5:  61%|6| 17/28 [00:06<00:01,  7.42it/s, loss=0.7169, grad_norm=32.332, lr=Training Epoch 5/5:  61%|6| 17/28 [00:06<00:01,  7.42it/s, loss=0.0875, grad_norm=9.989, lr=0Training Epoch 5/5:  64%|6| 18/28 [00:06<00:01,  7.43it/s, loss=0.0875, grad_norm=9.989, lr=0Training Epoch 5/5:  64%|6| 18/28 [00:06<00:01,  7.43it/s, loss=0.3414, grad_norm=38.427, lr=Training Epoch 5/5:  68%|6| 19/28 [00:06<00:01,  7.39it/s, loss=0.3414, grad_norm=38.427, lr=Training Epoch 5/5:  68%|6| 19/28 [00:06<00:01,  7.39it/s, loss=0.0522, grad_norm=2.020, lr=0Training Epoch 5/5:  71%|7| 20/28 [00:06<00:01,  7.40it/s, loss=0.0522, grad_norm=2.020, lr=0Training Epoch 5/5:  71%|7| 20/28 [00:06<00:01,  7.40it/s, loss=0.1597, grad_norm=11.309, lr=Training Epoch 5/5:  75%|7| 21/28 [00:06<00:00,  7.60it/s, loss=0.1597, grad_norm=11.309, lr=Training Epoch 5/5:  75%|7| 21/28 [00:06<00:00,  7.60it/s, loss=0.1528, grad_norm=22.141, lr=Training Epoch 5/5:  79%|7| 22/28 [00:06<00:00,  7.49it/s, loss=0.1528, grad_norm=22.141, lr=Training Epoch 5/5:  79%|7| 22/28 [00:06<00:00,  7.49it/s, loss=0.2002, grad_norm=18.666, lr=Training Epoch 5/5:  82%|8| 23/28 [00:06<00:00,  7.55it/s, loss=0.2002, grad_norm=18.666, lr=Training Epoch 5/5:  82%|8| 23/28 [00:07<00:00,  7.55it/s, loss=0.0730, grad_norm=5.497, lr=0Training Epoch 5/5:  86%|8| 24/28 [00:07<00:00,  7.45it/s, loss=0.0730, grad_norm=5.497, lr=0Training Epoch 5/5:  86%|8| 24/28 [00:07<00:00,  7.45it/s, loss=0.1225, grad_norm=15.019, lr=Training Epoch 5/5:  89%|8| 25/28 [00:07<00:00,  7.75it/s, loss=0.1225, grad_norm=15.019, lr=Training Epoch 5/5:  89%|8| 25/28 [00:07<00:00,  7.75it/s, loss=0.0793, grad_norm=9.126, lr=0Training Epoch 5/5:  93%|9| 26/28 [00:07<00:00,  8.03it/s, loss=0.0793, grad_norm=9.126, lr=0Training Epoch 5/5:  93%|9| 26/28 [00:07<00:00,  8.03it/s, loss=0.2262, grad_norm=6.890, lr=0Training Epoch 5/5:  96%|9| 27/28 [00:07<00:00,  8.26it/s, loss=0.2262, grad_norm=6.890, lr=0Training Epoch 5/5:  96%|9| 27/28 [00:07<00:00,  8.26it/s, loss=0.0534, grad_norm=1.969, lr=0Training Epoch 5/5: 100%|#| 28/28 [00:08<00:00,  3.42it/s, loss=0.0534, grad_norm=1.969, lr=0

Epoch 5/5 Complete (8.6s) [LR: 0.000005]
Train - Loss: 0.1805, Acc: 0.9378, Precision: 0.9524, Recall: 0.9217, F1: 0.9368, AUC: 0.9813
------------------------------------------------------------
Training curves saved to model\chb13_fold5\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold5
============================================================
✅ Fold 5 training completed successfully!

============================================================
TRAINING FOLD 6/11
============================================================
Using dataset prefix: chb13_fold6
Loading datasets from: preprocessing\data\chb13_fold6
Saving models to: model\chb13_fold6
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.4176, std=2.4646
Loaded train dataset: 430 samples
  - Spectrogram shape: torch.Size([430, 30, 18, 50, 10])
  - Value range: [-5.0383, 3.5064]
  - Class distribution: tensor([215, 215])
LOOCV Mode (Fold 6): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6961, grad_norm=1.126, lr=0.000010]Training Epoch 1/5:   4%| | 1/27 [00:04<01:48,  4.16s/it, loss=0.6961, grad_norm=1.126, lr=0.Training Epoch 1/5:   4%| | 1/27 [00:04<01:48,  4.16s/it, loss=0.6959, grad_norm=1.028, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.6959, grad_norm=1.028, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.6839, grad_norm=1.193, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.02s/it, loss=0.6839, grad_norm=1.193, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.02s/it, loss=0.6971, grad_norm=1.389, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.51it/s, loss=0.6971, grad_norm=1.389, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.51it/s, loss=0.6817, grad_norm=1.193, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.15it/s, loss=0.6817, grad_norm=1.193, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.15it/s, loss=0.6834, grad_norm=1.240, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.87it/s, loss=0.6834, grad_norm=1.240, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.87it/s, loss=0.7018, grad_norm=1.216, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.67it/s, loss=0.7018, grad_norm=1.216, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.67it/s, loss=0.6938, grad_norm=1.236, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:04<00:04,  4.51it/s, loss=0.6938, grad_norm=1.236, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:05<00:04,  4.51it/s, loss=0.6886, grad_norm=1.243, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  5.30it/s, loss=0.6886, grad_norm=1.243, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  5.30it/s, loss=0.6837, grad_norm=1.304, lr=0.Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.06it/s, loss=0.6837, grad_norm=1.304, lr=0Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.06it/s, loss=0.6819, grad_norm=1.197, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.69it/s, loss=0.6819, grad_norm=1.197, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.69it/s, loss=0.6851, grad_norm=1.233, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.20it/s, loss=0.6851, grad_norm=1.233, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.20it/s, loss=0.7029, grad_norm=1.325, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.63it/s, loss=0.7029, grad_norm=1.325, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.63it/s, loss=0.6809, grad_norm=1.050, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  7.97it/s, loss=0.6809, grad_norm=1.050, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  7.97it/s, loss=0.6703, grad_norm=1.375, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.24it/s, loss=0.6703, grad_norm=1.375, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.24it/s, loss=0.6850, grad_norm=1.308, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:05<00:01,  8.47it/s, loss=0.6850, grad_norm=1.308, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:05<00:01,  8.47it/s, loss=0.6636, grad_norm=1.475, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:05<00:01,  8.59it/s, loss=0.6636, grad_norm=1.475, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:06<00:01,  8.59it/s, loss=0.6988, grad_norm=1.330, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  8.63it/s, loss=0.6988, grad_norm=1.330, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  8.63it/s, loss=0.6929, grad_norm=1.218, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  8.70it/s, loss=0.6929, grad_norm=1.218, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  8.70it/s, loss=0.7034, grad_norm=1.167, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  8.74it/s, loss=0.7034, grad_norm=1.167, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  8.74it/s, loss=0.6814, grad_norm=1.402, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  8.74it/s, loss=0.6814, grad_norm=1.402, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  8.74it/s, loss=0.6756, grad_norm=1.247, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  8.73it/s, loss=0.6756, grad_norm=1.247, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  8.73it/s, loss=0.6810, grad_norm=1.283, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  8.73it/s, loss=0.6810, grad_norm=1.283, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  8.73it/s, loss=0.6984, grad_norm=1.215, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:06<00:00,  8.81it/s, loss=0.6984, grad_norm=1.215, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:06<00:00,  8.81it/s, loss=0.7156, grad_norm=1.601, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:06<00:00,  8.78it/s, loss=0.7156, grad_norm=1.601, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:07<00:00,  8.78it/s, loss=0.6620, grad_norm=1.248, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:07<00:00,  8.80it/s, loss=0.6620, grad_norm=1.248, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:07<00:00,  8.80it/s, loss=0.6690, grad_norm=1.348, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:07<00:00,  9.10it/s, loss=0.6690, grad_norm=1.348, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:07<00:00,  3.52it/s, loss=0.6690, grad_norm=1.348, lr=0

Epoch 1/5 Complete (8.1s) [LR: 0.000010]
Train - Loss: 0.6872, Acc: 0.5488, Precision: 0.5814, Recall: 0.3488, F1: 0.4360, AUC: 0.5920
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6814, grad_norm=1.627, lr=0.000010]Training Epoch 2/5:   4%| | 1/27 [00:04<01:45,  4.06s/it, loss=0.6814, grad_norm=1.627, lr=0.Training Epoch 2/5:   4%| | 1/27 [00:04<01:45,  4.06s/it, loss=0.6627, grad_norm=1.288, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:43,  1.74s/it, loss=0.6627, grad_norm=1.288, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:43,  1.74s/it, loss=0.6710, grad_norm=1.262, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.6710, grad_norm=1.262, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.6555, grad_norm=1.319, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:14,  1.54it/s, loss=0.6555, grad_norm=1.319, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:14,  1.54it/s, loss=0.6783, grad_norm=1.226, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:10,  2.20it/s, loss=0.6783, grad_norm=1.226, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:10,  2.20it/s, loss=0.6768, grad_norm=1.350, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.96it/s, loss=0.6768, grad_norm=1.350, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.96it/s, loss=0.6744, grad_norm=1.191, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.79it/s, loss=0.6744, grad_norm=1.191, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.79it/s, loss=0.6600, grad_norm=1.359, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:04<00:04,  4.64it/s, loss=0.6600, grad_norm=1.359, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:04<00:04,  4.64it/s, loss=0.6442, grad_norm=1.417, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:04<00:03,  5.44it/s, loss=0.6442, grad_norm=1.417, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  5.44it/s, loss=0.6575, grad_norm=1.363, lr=0.Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.17it/s, loss=0.6575, grad_norm=1.363, lr=0Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.17it/s, loss=0.6794, grad_norm=1.662, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.74it/s, loss=0.6794, grad_norm=1.662, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.74it/s, loss=0.6661, grad_norm=1.474, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  7.27it/s, loss=0.6661, grad_norm=1.474, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  7.27it/s, loss=0.6492, grad_norm=1.356, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.73it/s, loss=0.6492, grad_norm=1.356, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.73it/s, loss=0.6546, grad_norm=1.462, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.05it/s, loss=0.6546, grad_norm=1.462, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.05it/s, loss=0.6517, grad_norm=1.755, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.06it/s, loss=0.6517, grad_norm=1.755, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.06it/s, loss=0.6625, grad_norm=1.911, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.31it/s, loss=0.6625, grad_norm=1.911, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.31it/s, loss=0.6260, grad_norm=1.563, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:05<00:01,  8.45it/s, loss=0.6260, grad_norm=1.563, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:05<00:01,  8.45it/s, loss=0.6186, grad_norm=1.920, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:05<00:01,  8.57it/s, loss=0.6186, grad_norm=1.920, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  8.57it/s, loss=0.6610, grad_norm=1.474, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:00,  8.67it/s, loss=0.6610, grad_norm=1.474, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:00,  8.67it/s, loss=0.6197, grad_norm=1.562, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  8.66it/s, loss=0.6197, grad_norm=1.562, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  8.66it/s, loss=0.6547, grad_norm=1.998, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  8.74it/s, loss=0.6547, grad_norm=1.998, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  8.74it/s, loss=0.6315, grad_norm=1.837, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  8.80it/s, loss=0.6315, grad_norm=1.837, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  8.80it/s, loss=0.6044, grad_norm=1.697, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  8.85it/s, loss=0.6044, grad_norm=1.697, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  8.85it/s, loss=0.5766, grad_norm=1.483, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  8.70it/s, loss=0.5766, grad_norm=1.483, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  8.70it/s, loss=0.5830, grad_norm=1.547, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:06<00:00,  8.79it/s, loss=0.5830, grad_norm=1.547, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:06<00:00,  8.79it/s, loss=0.6219, grad_norm=1.869, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:06<00:00,  8.81it/s, loss=0.6219, grad_norm=1.869, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:06<00:00,  8.81it/s, loss=0.5583, grad_norm=1.961, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:06<00:00,  9.11it/s, loss=0.5583, grad_norm=1.961, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:07<00:00,  3.57it/s, loss=0.5583, grad_norm=1.961, lr=0

Epoch 2/5 Complete (8.0s) [LR: 0.000010]
Train - Loss: 0.6437, Acc: 0.7581, Precision: 0.7876, Recall: 0.7070, F1: 0.7451, AUC: 0.8500
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.5947, grad_norm=1.786, lr=0.000010]Training Epoch 3/5:   4%| | 1/27 [00:04<01:46,  4.08s/it, loss=0.5947, grad_norm=1.786, lr=0.Training Epoch 3/5:   4%| | 1/27 [00:04<01:46,  4.08s/it, loss=0.5084, grad_norm=1.599, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:43,  1.75s/it, loss=0.5084, grad_norm=1.599, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:43,  1.75s/it, loss=0.6031, grad_norm=2.487, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.00s/it, loss=0.6031, grad_norm=2.487, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.00s/it, loss=0.5487, grad_norm=1.827, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:14,  1.53it/s, loss=0.5487, grad_norm=1.827, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:14,  1.53it/s, loss=0.4945, grad_norm=1.560, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.4945, grad_norm=1.560, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.5266, grad_norm=1.792, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.5266, grad_norm=1.792, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.5398, grad_norm=2.066, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.76it/s, loss=0.5398, grad_norm=2.066, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.76it/s, loss=0.5212, grad_norm=2.745, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:04<00:04,  4.61it/s, loss=0.5212, grad_norm=2.745, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:04<00:04,  4.61it/s, loss=0.5406, grad_norm=3.211, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:04<00:03,  5.40it/s, loss=0.5406, grad_norm=3.211, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  5.40it/s, loss=0.4377, grad_norm=1.567, lr=0.Training Epoch 3/5:  37%|3| 10/27 [00:05<00:02,  6.12it/s, loss=0.4377, grad_norm=1.567, lr=0Training Epoch 3/5:  37%|3| 10/27 [00:05<00:02,  6.12it/s, loss=0.4652, grad_norm=2.150, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.79it/s, loss=0.4652, grad_norm=2.150, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.79it/s, loss=0.4843, grad_norm=2.867, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  7.25it/s, loss=0.4843, grad_norm=2.867, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  7.25it/s, loss=0.4546, grad_norm=2.221, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.69it/s, loss=0.4546, grad_norm=2.221, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.69it/s, loss=0.5634, grad_norm=2.701, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  7.93it/s, loss=0.5634, grad_norm=2.701, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  7.93it/s, loss=0.4658, grad_norm=3.489, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  8.10it/s, loss=0.4658, grad_norm=3.489, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  8.10it/s, loss=0.3762, grad_norm=1.929, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:05<00:01,  8.07it/s, loss=0.3762, grad_norm=1.929, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:05<00:01,  8.07it/s, loss=0.3600, grad_norm=2.062, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:05<00:01,  8.21it/s, loss=0.3600, grad_norm=2.062, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:06<00:01,  8.21it/s, loss=0.3921, grad_norm=3.358, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  8.30it/s, loss=0.3921, grad_norm=3.358, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  8.30it/s, loss=0.5332, grad_norm=3.270, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:00,  8.41it/s, loss=0.5332, grad_norm=3.270, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:00,  8.41it/s, loss=0.3787, grad_norm=2.196, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  8.44it/s, loss=0.3787, grad_norm=2.196, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  8.44it/s, loss=0.4015, grad_norm=3.090, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  8.45it/s, loss=0.4015, grad_norm=3.090, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  8.45it/s, loss=0.3376, grad_norm=1.823, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  8.51it/s, loss=0.3376, grad_norm=1.823, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  8.51it/s, loss=0.4267, grad_norm=6.796, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:06<00:00,  8.62it/s, loss=0.4267, grad_norm=6.796, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:06<00:00,  8.62it/s, loss=0.4216, grad_norm=5.530, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:06<00:00,  8.62it/s, loss=0.4216, grad_norm=5.530, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:06<00:00,  8.62it/s, loss=0.2322, grad_norm=1.220, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:06<00:00,  8.64it/s, loss=0.2322, grad_norm=1.220, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:06<00:00,  8.64it/s, loss=0.2868, grad_norm=3.151, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:06<00:00,  8.69it/s, loss=0.2868, grad_norm=3.151, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:07<00:00,  8.69it/s, loss=0.4731, grad_norm=3.800, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:07<00:00,  8.94it/s, loss=0.4731, grad_norm=3.800, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:07<00:00,  3.53it/s, loss=0.4731, grad_norm=3.800, lr=0

Epoch 3/5 Complete (8.1s) [LR: 0.000010]
Train - Loss: 0.4581, Acc: 0.8721, Precision: 0.8636, Recall: 0.8837, F1: 0.8736, AUC: 0.9425
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.3482, grad_norm=3.845, lr=0.000010]Training Epoch 4/5:   4%| | 1/27 [00:04<01:44,  4.03s/it, loss=0.3482, grad_norm=3.845, lr=0.Training Epoch 4/5:   4%| | 1/27 [00:04<01:44,  4.03s/it, loss=0.3274, grad_norm=3.198, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:43,  1.73s/it, loss=0.3274, grad_norm=3.198, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:43,  1.73s/it, loss=0.2672, grad_norm=2.649, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:23,  1.01it/s, loss=0.2672, grad_norm=2.649, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:23,  1.01it/s, loss=0.2684, grad_norm=3.798, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:14,  1.55it/s, loss=0.2684, grad_norm=3.798, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:14,  1.55it/s, loss=0.3846, grad_norm=5.827, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:09,  2.21it/s, loss=0.3846, grad_norm=5.827, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:09,  2.21it/s, loss=0.2494, grad_norm=3.795, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.2494, grad_norm=3.795, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.2234, grad_norm=5.098, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.73it/s, loss=0.2234, grad_norm=5.098, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.73it/s, loss=0.2632, grad_norm=4.671, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:04<00:04,  4.54it/s, loss=0.2632, grad_norm=4.671, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:04<00:04,  4.54it/s, loss=0.2667, grad_norm=7.770, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:04<00:03,  5.33it/s, loss=0.2667, grad_norm=7.770, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:05<00:03,  5.33it/s, loss=0.2844, grad_norm=4.937, lr=0.Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  6.06it/s, loss=0.2844, grad_norm=4.937, lr=0Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  6.06it/s, loss=0.1942, grad_norm=2.409, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.66it/s, loss=0.1942, grad_norm=2.409, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.66it/s, loss=0.2208, grad_norm=7.433, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  7.19it/s, loss=0.2208, grad_norm=7.433, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  7.19it/s, loss=0.2546, grad_norm=8.877, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.59it/s, loss=0.2546, grad_norm=8.877, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.59it/s, loss=0.2039, grad_norm=6.944, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.94it/s, loss=0.2039, grad_norm=6.944, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.94it/s, loss=0.3091, grad_norm=7.549, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.14it/s, loss=0.3091, grad_norm=7.549, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.14it/s, loss=0.2521, grad_norm=9.862, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.33it/s, loss=0.2521, grad_norm=9.862, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.33it/s, loss=0.4683, grad_norm=27.661, lr=Training Epoch 4/5:  63%|6| 17/27 [00:05<00:01,  8.42it/s, loss=0.4683, grad_norm=27.661, lr=Training Epoch 4/5:  63%|6| 17/27 [00:05<00:01,  8.42it/s, loss=0.2620, grad_norm=4.394, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:05<00:01,  8.49it/s, loss=0.2620, grad_norm=4.394, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  8.49it/s, loss=0.2321, grad_norm=6.046, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.60it/s, loss=0.2321, grad_norm=6.046, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.60it/s, loss=0.7429, grad_norm=13.890, lr=Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.63it/s, loss=0.7429, grad_norm=13.890, lr=Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.63it/s, loss=0.3895, grad_norm=9.044, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.71it/s, loss=0.3895, grad_norm=9.044, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.71it/s, loss=0.1875, grad_norm=5.920, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.72it/s, loss=0.1875, grad_norm=5.920, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.72it/s, loss=0.1052, grad_norm=1.964, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.75it/s, loss=0.1052, grad_norm=1.964, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.75it/s, loss=0.3673, grad_norm=6.786, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  8.81it/s, loss=0.3673, grad_norm=6.786, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  8.81it/s, loss=0.1630, grad_norm=3.297, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:06<00:00,  8.77it/s, loss=0.1630, grad_norm=3.297, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:06<00:00,  8.77it/s, loss=0.1839, grad_norm=5.202, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:06<00:00,  8.73it/s, loss=0.1839, grad_norm=5.202, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:07<00:00,  8.73it/s, loss=0.1005, grad_norm=1.871, lr=0Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  8.96it/s, loss=0.1005, grad_norm=1.871, lr=0Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  3.54it/s, loss=0.1005, grad_norm=1.871, lr=0

Epoch 4/5 Complete (8.0s) [LR: 0.000010]
Train - Loss: 0.2785, Acc: 0.9047, Precision: 0.9223, Recall: 0.8837, F1: 0.9026, AUC: 0.9662
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/27 [00:03<?, ?it/s, loss=0.2058, grad_norm=7.467, lr=0.000010]Training Epoch 5/5:   4%| | 1/27 [00:03<01:43,  3.99s/it, loss=0.2058, grad_norm=7.467, lr=0.Training Epoch 5/5:   4%| | 1/27 [00:04<01:43,  3.99s/it, loss=0.1622, grad_norm=6.529, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:43,  1.73s/it, loss=0.1622, grad_norm=6.529, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:43,  1.73s/it, loss=0.0648, grad_norm=0.743, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.0648, grad_norm=0.743, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.1489, grad_norm=8.925, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:15,  1.52it/s, loss=0.1489, grad_norm=8.925, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:15,  1.52it/s, loss=0.1787, grad_norm=7.780, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.14it/s, loss=0.1787, grad_norm=7.780, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.14it/s, loss=0.0747, grad_norm=1.665, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.82it/s, loss=0.0747, grad_norm=1.665, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.82it/s, loss=0.1135, grad_norm=1.735, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.53it/s, loss=0.1135, grad_norm=1.735, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.53it/s, loss=0.1024, grad_norm=1.610, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:04<00:04,  4.24it/s, loss=0.1024, grad_norm=1.610, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:05<00:04,  4.24it/s, loss=0.0445, grad_norm=0.811, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:05<00:03,  4.91it/s, loss=0.0445, grad_norm=0.811, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:05<00:03,  4.91it/s, loss=0.0881, grad_norm=4.614, lr=0.Training Epoch 5/5:  37%|3| 10/27 [00:05<00:03,  5.45it/s, loss=0.0881, grad_norm=4.614, lr=0Training Epoch 5/5:  37%|3| 10/27 [00:05<00:03,  5.45it/s, loss=0.0994, grad_norm=4.786, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  5.97it/s, loss=0.0994, grad_norm=4.786, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  5.97it/s, loss=0.1102, grad_norm=4.070, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  6.37it/s, loss=0.1102, grad_norm=4.070, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  6.37it/s, loss=0.0670, grad_norm=1.558, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:02,  6.68it/s, loss=0.0670, grad_norm=1.558, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:02,  6.68it/s, loss=0.1304, grad_norm=6.316, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  7.00it/s, loss=0.1304, grad_norm=6.316, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  7.00it/s, loss=0.0772, grad_norm=3.745, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  7.42it/s, loss=0.0772, grad_norm=3.745, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  7.42it/s, loss=0.0494, grad_norm=0.540, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:05<00:01,  7.71it/s, loss=0.0494, grad_norm=0.540, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:06<00:01,  7.71it/s, loss=0.0986, grad_norm=4.697, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:06<00:01,  8.02it/s, loss=0.0986, grad_norm=4.697, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:06<00:01,  8.02it/s, loss=0.0517, grad_norm=1.440, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  8.18it/s, loss=0.0517, grad_norm=1.440, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  8.18it/s, loss=0.2012, grad_norm=6.887, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:00,  8.31it/s, loss=0.2012, grad_norm=6.887, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:00,  8.31it/s, loss=0.0632, grad_norm=3.102, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  8.41it/s, loss=0.0632, grad_norm=3.102, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  8.41it/s, loss=0.1424, grad_norm=8.969, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  8.64it/s, loss=0.1424, grad_norm=8.969, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  8.64it/s, loss=0.0420, grad_norm=2.195, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  8.70it/s, loss=0.0420, grad_norm=2.195, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  8.70it/s, loss=0.1248, grad_norm=14.160, lr=Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  8.71it/s, loss=0.1248, grad_norm=14.160, lr=Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  8.71it/s, loss=0.1032, grad_norm=11.599, lr=Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  8.72it/s, loss=0.1032, grad_norm=11.599, lr=Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  8.72it/s, loss=0.0334, grad_norm=1.540, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:06<00:00,  8.73it/s, loss=0.0334, grad_norm=1.540, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:07<00:00,  8.73it/s, loss=0.0435, grad_norm=1.463, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:07<00:00,  8.66it/s, loss=0.0435, grad_norm=1.463, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:07<00:00,  8.66it/s, loss=0.1256, grad_norm=12.149, lr=Training Epoch 5/5: 100%|#| 27/27 [00:07<00:00,  8.93it/s, loss=0.1256, grad_norm=12.149, lr=Training Epoch 5/5: 100%|#| 27/27 [00:07<00:00,  3.47it/s, loss=0.1256, grad_norm=12.149, lr=

Epoch 5/5 Complete (8.2s) [LR: 0.000005]
Train - Loss: 0.1017, Acc: 0.9721, Precision: 0.9552, Recall: 0.9907, F1: 0.9726, AUC: 0.9974
------------------------------------------------------------
Training curves saved to model\chb13_fold6\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold6
============================================================
✅ Fold 6 training completed successfully!

============================================================
TRAINING FOLD 7/11
============================================================
Using dataset prefix: chb13_fold7
Loading datasets from: preprocessing\data\chb13_fold7
Saving models to: model\chb13_fold7
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.4065, std=2.4542
Loaded train dataset: 432 samples
  - Spectrogram shape: torch.Size([432, 30, 18, 50, 10])
  - Value range: [-5.0553, 3.4917]
  - Class distribution: tensor([216, 216])
LOOCV Mode (Fold 7): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.7002, grad_norm=1.187, lr=0.000010]Training Epoch 1/5:   4%| | 1/27 [00:04<01:47,  4.12s/it, loss=0.7002, grad_norm=1.187, lr=0.Training Epoch 1/5:   4%| | 1/27 [00:04<01:47,  4.12s/it, loss=0.6939, grad_norm=1.073, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:44,  1.77s/it, loss=0.6939, grad_norm=1.073, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:44,  1.77s/it, loss=0.6938, grad_norm=1.163, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6938, grad_norm=1.163, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6911, grad_norm=1.132, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.52it/s, loss=0.6911, grad_norm=1.132, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.52it/s, loss=0.6884, grad_norm=0.926, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.17it/s, loss=0.6884, grad_norm=0.926, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.17it/s, loss=0.6951, grad_norm=1.104, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.91it/s, loss=0.6951, grad_norm=1.104, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.91it/s, loss=0.6955, grad_norm=1.127, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.72it/s, loss=0.6955, grad_norm=1.127, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.72it/s, loss=0.6939, grad_norm=1.049, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:04<00:04,  4.57it/s, loss=0.6939, grad_norm=1.049, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:05<00:04,  4.57it/s, loss=0.6949, grad_norm=1.075, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  5.39it/s, loss=0.6949, grad_norm=1.075, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  5.39it/s, loss=0.6992, grad_norm=1.169, lr=0.Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.15it/s, loss=0.6992, grad_norm=1.169, lr=0Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.15it/s, loss=0.6878, grad_norm=1.168, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.78it/s, loss=0.6878, grad_norm=1.168, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.78it/s, loss=0.6913, grad_norm=1.157, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.32it/s, loss=0.6913, grad_norm=1.157, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.32it/s, loss=0.6950, grad_norm=1.153, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.75it/s, loss=0.6950, grad_norm=1.153, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.75it/s, loss=0.6813, grad_norm=0.969, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  8.06it/s, loss=0.6813, grad_norm=0.969, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  8.06it/s, loss=0.6860, grad_norm=1.142, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.19it/s, loss=0.6860, grad_norm=1.142, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.19it/s, loss=0.6973, grad_norm=1.212, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:05<00:01,  8.32it/s, loss=0.6973, grad_norm=1.212, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:05<00:01,  8.32it/s, loss=0.6903, grad_norm=1.183, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:05<00:01,  8.50it/s, loss=0.6903, grad_norm=1.183, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:06<00:01,  8.50it/s, loss=0.7031, grad_norm=1.121, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  8.64it/s, loss=0.7031, grad_norm=1.121, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  8.64it/s, loss=0.6966, grad_norm=1.162, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  8.75it/s, loss=0.6966, grad_norm=1.162, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  8.75it/s, loss=0.6840, grad_norm=0.986, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  8.79it/s, loss=0.6840, grad_norm=0.986, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  8.79it/s, loss=0.6748, grad_norm=1.029, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  8.73it/s, loss=0.6748, grad_norm=1.029, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  8.73it/s, loss=0.6890, grad_norm=1.114, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  8.71it/s, loss=0.6890, grad_norm=1.114, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  8.71it/s, loss=0.6916, grad_norm=1.197, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  8.80it/s, loss=0.6916, grad_norm=1.197, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  8.80it/s, loss=0.7033, grad_norm=1.269, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:06<00:00,  8.70it/s, loss=0.7033, grad_norm=1.269, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:06<00:00,  8.70it/s, loss=0.6945, grad_norm=1.075, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:06<00:00,  8.80it/s, loss=0.6945, grad_norm=1.075, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:06<00:00,  8.80it/s, loss=0.6872, grad_norm=1.191, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:06<00:00,  8.71it/s, loss=0.6872, grad_norm=1.191, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:07<00:00,  8.71it/s, loss=0.6851, grad_norm=1.063, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:07<00:00,  8.69it/s, loss=0.6851, grad_norm=1.063, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:07<00:00,  3.53it/s, loss=0.6851, grad_norm=1.063, lr=0

Epoch 1/5 Complete (8.0s) [LR: 0.000010]
Train - Loss: 0.6920, Acc: 0.5208, Precision: 0.5198, Recall: 0.5463, F1: 0.5327, AUC: 0.5317
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6848, grad_norm=0.937, lr=0.000010]Training Epoch 2/5:   4%| | 1/27 [00:04<01:49,  4.19s/it, loss=0.6848, grad_norm=0.937, lr=0.Training Epoch 2/5:   4%| | 1/27 [00:04<01:49,  4.19s/it, loss=0.6968, grad_norm=1.161, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:45,  1.81s/it, loss=0.6968, grad_norm=1.161, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:45,  1.81s/it, loss=0.6908, grad_norm=1.210, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:25,  1.05s/it, loss=0.6908, grad_norm=1.210, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:25,  1.05s/it, loss=0.6751, grad_norm=1.097, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:15,  1.45it/s, loss=0.6751, grad_norm=1.097, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:15,  1.45it/s, loss=0.6723, grad_norm=1.129, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:10,  2.04it/s, loss=0.6723, grad_norm=1.129, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:10,  2.04it/s, loss=0.6932, grad_norm=1.192, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.71it/s, loss=0.6932, grad_norm=1.192, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:05<00:07,  2.71it/s, loss=0.6814, grad_norm=0.986, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:05<00:05,  3.43it/s, loss=0.6814, grad_norm=0.986, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:05<00:05,  3.43it/s, loss=0.6694, grad_norm=0.994, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:05<00:04,  4.17it/s, loss=0.6694, grad_norm=0.994, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:05<00:04,  4.17it/s, loss=0.6746, grad_norm=1.118, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  4.82it/s, loss=0.6746, grad_norm=1.118, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  4.82it/s, loss=0.6863, grad_norm=1.075, lr=0.Training Epoch 2/5:  37%|3| 10/27 [00:05<00:03,  5.36it/s, loss=0.6863, grad_norm=1.075, lr=0Training Epoch 2/5:  37%|3| 10/27 [00:05<00:03,  5.36it/s, loss=0.6857, grad_norm=1.232, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  5.80it/s, loss=0.6857, grad_norm=1.232, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  5.80it/s, loss=0.6708, grad_norm=1.176, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  6.14it/s, loss=0.6708, grad_norm=1.176, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  6.14it/s, loss=0.6764, grad_norm=1.240, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:02,  6.47it/s, loss=0.6764, grad_norm=1.240, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:02,  6.47it/s, loss=0.6801, grad_norm=1.208, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  6.73it/s, loss=0.6801, grad_norm=1.208, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:06<00:01,  6.73it/s, loss=0.6624, grad_norm=1.226, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:06<00:01,  6.95it/s, loss=0.6624, grad_norm=1.226, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:06<00:01,  6.95it/s, loss=0.6700, grad_norm=1.213, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:06<00:01,  6.98it/s, loss=0.6700, grad_norm=1.213, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:06<00:01,  6.98it/s, loss=0.6731, grad_norm=1.195, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:06<00:01,  7.02it/s, loss=0.6731, grad_norm=1.195, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:06<00:01,  7.02it/s, loss=0.6871, grad_norm=1.537, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  7.06it/s, loss=0.6871, grad_norm=1.537, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  7.06it/s, loss=0.6573, grad_norm=1.174, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:01,  7.05it/s, loss=0.6573, grad_norm=1.174, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:01,  7.05it/s, loss=0.6635, grad_norm=1.263, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  7.18it/s, loss=0.6635, grad_norm=1.263, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  7.18it/s, loss=0.6713, grad_norm=1.278, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  7.29it/s, loss=0.6713, grad_norm=1.278, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:07<00:00,  7.29it/s, loss=0.6478, grad_norm=1.298, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:07<00:00,  6.84it/s, loss=0.6478, grad_norm=1.298, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:07<00:00,  6.84it/s, loss=0.6680, grad_norm=1.807, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:07<00:00,  6.92it/s, loss=0.6680, grad_norm=1.807, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:07<00:00,  6.92it/s, loss=0.7012, grad_norm=1.660, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:07<00:00,  6.99it/s, loss=0.7012, grad_norm=1.660, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:07<00:00,  6.99it/s, loss=0.6419, grad_norm=1.400, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:07<00:00,  7.05it/s, loss=0.6419, grad_norm=1.400, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:07<00:00,  7.05it/s, loss=0.6512, grad_norm=1.312, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:07<00:00,  7.03it/s, loss=0.6512, grad_norm=1.312, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:07<00:00,  7.03it/s, loss=0.6653, grad_norm=1.699, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:07<00:00,  7.02it/s, loss=0.6653, grad_norm=1.699, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:08<00:00,  3.18it/s, loss=0.6653, grad_norm=1.699, lr=0

Epoch 2/5 Complete (8.9s) [LR: 0.000010]
Train - Loss: 0.6740, Acc: 0.6597, Precision: 0.6885, Recall: 0.5833, F1: 0.6316, AUC: 0.7473
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6455, grad_norm=1.601, lr=0.000010]Training Epoch 3/5:   4%| | 1/27 [00:04<01:52,  4.32s/it, loss=0.6455, grad_norm=1.601, lr=0.Training Epoch 3/5:   4%| | 1/27 [00:04<01:52,  4.32s/it, loss=0.6374, grad_norm=1.443, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:46,  1.85s/it, loss=0.6374, grad_norm=1.443, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:46,  1.85s/it, loss=0.6428, grad_norm=1.555, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:25,  1.05s/it, loss=0.6428, grad_norm=1.555, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:25,  1.05s/it, loss=0.6532, grad_norm=1.557, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.46it/s, loss=0.6532, grad_norm=1.557, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.46it/s, loss=0.6757, grad_norm=1.703, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.09it/s, loss=0.6757, grad_norm=1.703, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.09it/s, loss=0.6169, grad_norm=1.770, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.82it/s, loss=0.6169, grad_norm=1.770, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:05<00:07,  2.82it/s, loss=0.6057, grad_norm=1.600, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:05<00:05,  3.63it/s, loss=0.6057, grad_norm=1.600, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:05<00:05,  3.63it/s, loss=0.5893, grad_norm=1.584, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:05<00:04,  4.48it/s, loss=0.5893, grad_norm=1.584, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:05<00:04,  4.48it/s, loss=0.6169, grad_norm=1.781, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  5.30it/s, loss=0.6169, grad_norm=1.781, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  5.30it/s, loss=0.6037, grad_norm=1.630, lr=0.Training Epoch 3/5:  37%|3| 10/27 [00:05<00:02,  6.03it/s, loss=0.6037, grad_norm=1.630, lr=0Training Epoch 3/5:  37%|3| 10/27 [00:05<00:02,  6.03it/s, loss=0.6318, grad_norm=2.025, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.65it/s, loss=0.6318, grad_norm=2.025, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.65it/s, loss=0.6279, grad_norm=1.645, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  7.21it/s, loss=0.6279, grad_norm=1.645, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  7.21it/s, loss=0.6484, grad_norm=2.422, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.64it/s, loss=0.6484, grad_norm=2.422, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.64it/s, loss=0.5744, grad_norm=1.933, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  7.91it/s, loss=0.5744, grad_norm=1.933, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  7.91it/s, loss=0.6185, grad_norm=1.845, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  8.09it/s, loss=0.6185, grad_norm=1.845, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:06<00:01,  8.09it/s, loss=0.5393, grad_norm=1.801, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:06<00:01,  8.14it/s, loss=0.5393, grad_norm=1.801, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:06<00:01,  8.14it/s, loss=0.5807, grad_norm=1.671, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:06<00:01,  8.00it/s, loss=0.5807, grad_norm=1.671, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:06<00:01,  8.00it/s, loss=0.5621, grad_norm=1.999, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  8.08it/s, loss=0.5621, grad_norm=1.999, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  8.08it/s, loss=0.4991, grad_norm=1.996, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:00,  8.11it/s, loss=0.4991, grad_norm=1.996, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:00,  8.11it/s, loss=0.5220, grad_norm=2.383, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  8.07it/s, loss=0.5220, grad_norm=2.383, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  8.07it/s, loss=0.5212, grad_norm=2.022, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  8.12it/s, loss=0.5212, grad_norm=2.022, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  8.12it/s, loss=0.5512, grad_norm=2.384, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  8.10it/s, loss=0.5512, grad_norm=2.384, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  8.10it/s, loss=0.5359, grad_norm=2.982, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:06<00:00,  8.17it/s, loss=0.5359, grad_norm=2.982, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:07<00:00,  8.17it/s, loss=0.5809, grad_norm=5.434, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:07<00:00,  8.17it/s, loss=0.5809, grad_norm=5.434, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:07<00:00,  8.17it/s, loss=0.5415, grad_norm=2.762, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:07<00:00,  8.27it/s, loss=0.5415, grad_norm=2.762, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:07<00:00,  8.27it/s, loss=0.4573, grad_norm=2.422, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:07<00:00,  8.37it/s, loss=0.4573, grad_norm=2.422, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:07<00:00,  8.37it/s, loss=0.4741, grad_norm=3.187, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:07<00:00,  8.46it/s, loss=0.4741, grad_norm=3.187, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:07<00:00,  3.40it/s, loss=0.4741, grad_norm=3.187, lr=0

Epoch 3/5 Complete (8.4s) [LR: 0.000010]
Train - Loss: 0.5835, Acc: 0.8241, Precision: 0.8535, Recall: 0.7824, F1: 0.8164, AUC: 0.8902
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/27 [00:03<?, ?it/s, loss=0.4044, grad_norm=1.698, lr=0.000010]Training Epoch 4/5:   4%| | 1/27 [00:03<01:43,  3.98s/it, loss=0.4044, grad_norm=1.698, lr=0.Training Epoch 4/5:   4%| | 1/27 [00:04<01:43,  3.98s/it, loss=0.4318, grad_norm=3.406, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:42,  1.71s/it, loss=0.4318, grad_norm=3.406, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:42,  1.71s/it, loss=0.4865, grad_norm=7.632, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.4865, grad_norm=7.632, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:23,  1.02it/s, loss=0.4043, grad_norm=1.950, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:14,  1.56it/s, loss=0.4043, grad_norm=1.950, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:14,  1.56it/s, loss=0.4452, grad_norm=3.968, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.18it/s, loss=0.4452, grad_norm=3.968, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.18it/s, loss=0.3976, grad_norm=2.068, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.88it/s, loss=0.3976, grad_norm=2.068, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.88it/s, loss=0.4403, grad_norm=2.836, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.58it/s, loss=0.4403, grad_norm=2.836, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.58it/s, loss=0.4355, grad_norm=4.185, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:04<00:04,  4.29it/s, loss=0.4355, grad_norm=4.185, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:04<00:04,  4.29it/s, loss=0.3888, grad_norm=6.845, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:04<00:03,  5.08it/s, loss=0.3888, grad_norm=6.845, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:05<00:03,  5.08it/s, loss=0.4608, grad_norm=4.559, lr=0.Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  5.83it/s, loss=0.4608, grad_norm=4.559, lr=0Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  5.83it/s, loss=0.3712, grad_norm=3.593, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.45it/s, loss=0.3712, grad_norm=3.593, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.45it/s, loss=0.4186, grad_norm=5.394, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  7.01it/s, loss=0.4186, grad_norm=5.394, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  7.01it/s, loss=0.2928, grad_norm=3.835, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.39it/s, loss=0.2928, grad_norm=3.835, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.39it/s, loss=0.2710, grad_norm=3.585, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.73it/s, loss=0.2710, grad_norm=3.585, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.73it/s, loss=0.4804, grad_norm=6.210, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.01it/s, loss=0.4804, grad_norm=6.210, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.01it/s, loss=0.2279, grad_norm=2.860, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.05it/s, loss=0.2279, grad_norm=2.860, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.05it/s, loss=0.3828, grad_norm=6.246, lr=0Training Epoch 4/5:  63%|6| 17/27 [00:05<00:01,  8.23it/s, loss=0.3828, grad_norm=6.246, lr=0Training Epoch 4/5:  63%|6| 17/27 [00:06<00:01,  8.23it/s, loss=0.2407, grad_norm=2.800, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  8.35it/s, loss=0.2407, grad_norm=2.800, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  8.35it/s, loss=0.2865, grad_norm=7.638, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.46it/s, loss=0.2865, grad_norm=7.638, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.46it/s, loss=0.2406, grad_norm=2.774, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.56it/s, loss=0.2406, grad_norm=2.774, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.56it/s, loss=0.2869, grad_norm=4.236, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.52it/s, loss=0.2869, grad_norm=4.236, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.52it/s, loss=0.2523, grad_norm=6.117, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.53it/s, loss=0.2523, grad_norm=6.117, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.53it/s, loss=0.1447, grad_norm=1.806, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.58it/s, loss=0.1447, grad_norm=1.806, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.58it/s, loss=0.2586, grad_norm=3.241, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  8.62it/s, loss=0.2586, grad_norm=3.241, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  8.62it/s, loss=0.3710, grad_norm=10.062, lr=Training Epoch 4/5:  93%|9| 25/27 [00:06<00:00,  8.65it/s, loss=0.3710, grad_norm=10.062, lr=Training Epoch 4/5:  93%|9| 25/27 [00:06<00:00,  8.65it/s, loss=0.3030, grad_norm=11.249, lr=Training Epoch 4/5:  96%|9| 26/27 [00:06<00:00,  8.64it/s, loss=0.3030, grad_norm=11.249, lr=Training Epoch 4/5:  96%|9| 26/27 [00:07<00:00,  8.64it/s, loss=0.1381, grad_norm=3.387, lr=0Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  8.61it/s, loss=0.1381, grad_norm=3.387, lr=0Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  3.51it/s, loss=0.1381, grad_norm=3.387, lr=0

Epoch 4/5 Complete (8.1s) [LR: 0.000010]
Train - Loss: 0.3431, Acc: 0.9167, Precision: 0.8879, Recall: 0.9537, F1: 0.9196, AUC: 0.9727
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.1883, grad_norm=2.861, lr=0.000010]Training Epoch 5/5:   4%| | 1/27 [00:04<01:45,  4.05s/it, loss=0.1883, grad_norm=2.861, lr=0.Training Epoch 5/5:   4%| | 1/27 [00:04<01:45,  4.05s/it, loss=0.3193, grad_norm=11.347, lr=0Training Epoch 5/5:   7%| | 2/27 [00:04<00:43,  1.74s/it, loss=0.3193, grad_norm=11.347, lr=0Training Epoch 5/5:   7%| | 2/27 [00:04<00:43,  1.74s/it, loss=0.3150, grad_norm=8.350, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.3150, grad_norm=8.350, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.2743, grad_norm=8.533, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:14,  1.54it/s, loss=0.2743, grad_norm=8.533, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:14,  1.54it/s, loss=0.1825, grad_norm=6.690, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.1825, grad_norm=6.690, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.1074, grad_norm=3.945, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.1074, grad_norm=3.945, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.1645, grad_norm=4.063, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.77it/s, loss=0.1645, grad_norm=4.063, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.77it/s, loss=0.1214, grad_norm=2.305, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:04<00:04,  4.60it/s, loss=0.1214, grad_norm=2.305, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:04<00:04,  4.60it/s, loss=0.1929, grad_norm=8.680, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:04<00:03,  5.39it/s, loss=0.1929, grad_norm=8.680, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:05<00:03,  5.39it/s, loss=0.0938, grad_norm=1.167, lr=0.Training Epoch 5/5:  37%|3| 10/27 [00:05<00:02,  6.13it/s, loss=0.0938, grad_norm=1.167, lr=0Training Epoch 5/5:  37%|3| 10/27 [00:05<00:02,  6.13it/s, loss=0.0627, grad_norm=0.661, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  6.75it/s, loss=0.0627, grad_norm=0.661, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  6.75it/s, loss=0.0789, grad_norm=1.390, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  7.24it/s, loss=0.0789, grad_norm=1.390, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  7.24it/s, loss=0.1341, grad_norm=12.334, lr=Training Epoch 5/5:  48%|4| 13/27 [00:05<00:01,  7.60it/s, loss=0.1341, grad_norm=12.334, lr=Training Epoch 5/5:  48%|4| 13/27 [00:05<00:01,  7.60it/s, loss=0.1087, grad_norm=5.480, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  7.91it/s, loss=0.1087, grad_norm=5.480, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  7.91it/s, loss=0.0593, grad_norm=1.299, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  8.18it/s, loss=0.0593, grad_norm=1.299, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  8.18it/s, loss=0.1388, grad_norm=7.089, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:05<00:01,  8.31it/s, loss=0.1388, grad_norm=7.089, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:05<00:01,  8.31it/s, loss=0.1623, grad_norm=7.719, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:05<00:01,  8.43it/s, loss=0.1623, grad_norm=7.719, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:06<00:01,  8.43it/s, loss=0.2974, grad_norm=10.496, lr=Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  8.61it/s, loss=0.2974, grad_norm=10.496, lr=Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  8.61it/s, loss=0.0851, grad_norm=3.175, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:00,  8.66it/s, loss=0.0851, grad_norm=3.175, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:00,  8.66it/s, loss=0.0494, grad_norm=0.843, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  8.67it/s, loss=0.0494, grad_norm=0.843, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  8.67it/s, loss=0.0634, grad_norm=1.472, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  8.65it/s, loss=0.0634, grad_norm=1.472, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  8.65it/s, loss=0.0454, grad_norm=1.335, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  8.65it/s, loss=0.0454, grad_norm=1.335, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  8.65it/s, loss=0.0515, grad_norm=3.750, lr=0Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  8.70it/s, loss=0.0515, grad_norm=3.750, lr=0Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  8.70it/s, loss=0.0518, grad_norm=2.814, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  8.45it/s, loss=0.0518, grad_norm=2.814, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  8.45it/s, loss=0.2492, grad_norm=16.699, lr=Training Epoch 5/5:  93%|9| 25/27 [00:06<00:00,  8.51it/s, loss=0.2492, grad_norm=16.699, lr=Training Epoch 5/5:  93%|9| 25/27 [00:06<00:00,  8.51it/s, loss=0.0527, grad_norm=4.627, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:06<00:00,  8.63it/s, loss=0.0527, grad_norm=4.627, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:07<00:00,  8.63it/s, loss=0.0682, grad_norm=4.269, lr=0Training Epoch 5/5: 100%|#| 27/27 [00:07<00:00,  8.67it/s, loss=0.0682, grad_norm=4.269, lr=0Training Epoch 5/5: 100%|#| 27/27 [00:07<00:00,  3.54it/s, loss=0.0682, grad_norm=4.269, lr=0

Epoch 5/5 Complete (8.0s) [LR: 0.000005]
Train - Loss: 0.1377, Acc: 0.9699, Precision: 0.9552, Recall: 0.9861, F1: 0.9704, AUC: 0.9923
------------------------------------------------------------
Training curves saved to model\chb13_fold7\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold7
============================================================
✅ Fold 7 training completed successfully!

============================================================
TRAINING FOLD 8/11
============================================================
Using dataset prefix: chb13_fold8
Loading datasets from: preprocessing\data\chb13_fold8
Saving models to: model\chb13_fold8
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.4267, std=2.4521
Loaded train dataset: 432 samples
  - Spectrogram shape: torch.Size([432, 30, 18, 50, 10])
  - Value range: [-5.0678, 3.4751]
  - Class distribution: tensor([216, 216])
LOOCV Mode (Fold 8): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6893, grad_norm=1.021, lr=0.000010]Training Epoch 1/5:   4%| | 1/27 [00:04<01:48,  4.18s/it, loss=0.6893, grad_norm=1.021, lr=0.Training Epoch 1/5:   4%| | 1/27 [00:04<01:48,  4.18s/it, loss=0.7160, grad_norm=1.574, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:45,  1.80s/it, loss=0.7160, grad_norm=1.574, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:45,  1.80s/it, loss=0.6844, grad_norm=1.060, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.04s/it, loss=0.6844, grad_norm=1.060, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.04s/it, loss=0.6930, grad_norm=1.149, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.46it/s, loss=0.6930, grad_norm=1.149, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.46it/s, loss=0.6792, grad_norm=1.117, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.07it/s, loss=0.6792, grad_norm=1.117, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.07it/s, loss=0.7041, grad_norm=1.218, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.73it/s, loss=0.7041, grad_norm=1.218, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:05<00:07,  2.73it/s, loss=0.6943, grad_norm=1.059, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:05<00:05,  3.39it/s, loss=0.6943, grad_norm=1.059, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:05<00:05,  3.39it/s, loss=0.6837, grad_norm=1.325, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:05<00:04,  4.13it/s, loss=0.6837, grad_norm=1.325, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:05<00:04,  4.13it/s, loss=0.7038, grad_norm=1.238, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  4.83it/s, loss=0.7038, grad_norm=1.238, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  4.83it/s, loss=0.6936, grad_norm=1.164, lr=0.Training Epoch 1/5:  37%|3| 10/27 [00:05<00:03,  5.33it/s, loss=0.6936, grad_norm=1.164, lr=0Training Epoch 1/5:  37%|3| 10/27 [00:05<00:03,  5.33it/s, loss=0.6917, grad_norm=1.071, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  5.79it/s, loss=0.6917, grad_norm=1.071, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  5.79it/s, loss=0.6832, grad_norm=1.206, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  6.14it/s, loss=0.6832, grad_norm=1.206, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  6.14it/s, loss=0.6751, grad_norm=1.160, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:02,  6.48it/s, loss=0.6751, grad_norm=1.160, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:02,  6.48it/s, loss=0.7073, grad_norm=1.147, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  6.70it/s, loss=0.7073, grad_norm=1.147, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:06<00:01,  6.70it/s, loss=0.6812, grad_norm=1.016, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:06<00:01,  6.85it/s, loss=0.6812, grad_norm=1.016, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:06<00:01,  6.85it/s, loss=0.6891, grad_norm=1.190, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:06<00:01,  6.95it/s, loss=0.6891, grad_norm=1.190, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:06<00:01,  6.95it/s, loss=0.6918, grad_norm=1.196, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:06<00:01,  7.16it/s, loss=0.6918, grad_norm=1.196, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:06<00:01,  7.16it/s, loss=0.6830, grad_norm=1.200, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  7.19it/s, loss=0.6830, grad_norm=1.200, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  7.19it/s, loss=0.6850, grad_norm=1.101, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:01,  7.19it/s, loss=0.6850, grad_norm=1.101, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:01,  7.19it/s, loss=0.6995, grad_norm=1.152, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  7.20it/s, loss=0.6995, grad_norm=1.152, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  7.20it/s, loss=0.7094, grad_norm=1.296, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  7.31it/s, loss=0.7094, grad_norm=1.296, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:07<00:00,  7.31it/s, loss=0.7001, grad_norm=1.571, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:07<00:00,  7.31it/s, loss=0.7001, grad_norm=1.571, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:07<00:00,  7.31it/s, loss=0.6760, grad_norm=1.147, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:07<00:00,  7.22it/s, loss=0.6760, grad_norm=1.147, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:07<00:00,  7.22it/s, loss=0.6688, grad_norm=1.472, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:07<00:00,  7.17it/s, loss=0.6688, grad_norm=1.472, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:07<00:00,  7.17it/s, loss=0.6960, grad_norm=1.603, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:07<00:00,  7.26it/s, loss=0.6960, grad_norm=1.603, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:07<00:00,  7.26it/s, loss=0.6779, grad_norm=1.183, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:07<00:00,  7.20it/s, loss=0.6779, grad_norm=1.183, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:07<00:00,  7.20it/s, loss=0.7035, grad_norm=1.322, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:07<00:00,  7.16it/s, loss=0.7035, grad_norm=1.322, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:08<00:00,  3.20it/s, loss=0.7035, grad_norm=1.322, lr=0

Epoch 1/5 Complete (8.8s) [LR: 0.000010]
Train - Loss: 0.6911, Acc: 0.5255, Precision: 0.5304, Recall: 0.4444, F1: 0.4836, AUC: 0.5324
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6823, grad_norm=1.460, lr=0.000010]Training Epoch 2/5:   4%| | 1/27 [00:04<01:47,  4.15s/it, loss=0.6823, grad_norm=1.460, lr=0.Training Epoch 2/5:   4%| | 1/27 [00:04<01:47,  4.15s/it, loss=0.6845, grad_norm=1.246, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.6845, grad_norm=1.246, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.6798, grad_norm=1.376, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:24,  1.02s/it, loss=0.6798, grad_norm=1.376, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:24,  1.02s/it, loss=0.6630, grad_norm=1.252, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:15,  1.51it/s, loss=0.6630, grad_norm=1.252, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:15,  1.51it/s, loss=0.6854, grad_norm=1.114, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:10,  2.15it/s, loss=0.6854, grad_norm=1.114, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:10,  2.15it/s, loss=0.6714, grad_norm=1.433, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.90it/s, loss=0.6714, grad_norm=1.433, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.90it/s, loss=0.6777, grad_norm=1.171, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.72it/s, loss=0.6777, grad_norm=1.171, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.72it/s, loss=0.6764, grad_norm=1.238, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:04<00:04,  4.57it/s, loss=0.6764, grad_norm=1.238, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:05<00:04,  4.57it/s, loss=0.6878, grad_norm=1.337, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  5.39it/s, loss=0.6878, grad_norm=1.337, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  5.39it/s, loss=0.6580, grad_norm=1.285, lr=0.Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.11it/s, loss=0.6580, grad_norm=1.285, lr=0Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.11it/s, loss=0.6875, grad_norm=1.198, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.76it/s, loss=0.6875, grad_norm=1.198, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.76it/s, loss=0.6777, grad_norm=1.344, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  7.29it/s, loss=0.6777, grad_norm=1.344, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  7.29it/s, loss=0.6760, grad_norm=1.251, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.74it/s, loss=0.6760, grad_norm=1.251, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.74it/s, loss=0.6491, grad_norm=1.369, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.01it/s, loss=0.6491, grad_norm=1.369, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.01it/s, loss=0.6888, grad_norm=1.638, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.25it/s, loss=0.6888, grad_norm=1.638, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.25it/s, loss=0.6704, grad_norm=1.326, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.41it/s, loss=0.6704, grad_norm=1.326, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.41it/s, loss=0.7027, grad_norm=1.302, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:05<00:01,  8.59it/s, loss=0.7027, grad_norm=1.302, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:06<00:01,  8.59it/s, loss=0.6779, grad_norm=1.501, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  8.70it/s, loss=0.6779, grad_norm=1.501, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  8.70it/s, loss=0.6570, grad_norm=1.598, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:00,  8.69it/s, loss=0.6570, grad_norm=1.598, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:00,  8.69it/s, loss=0.6661, grad_norm=1.283, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  8.72it/s, loss=0.6661, grad_norm=1.283, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  8.72it/s, loss=0.6533, grad_norm=1.713, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  8.79it/s, loss=0.6533, grad_norm=1.713, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  8.79it/s, loss=0.6819, grad_norm=1.660, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  8.79it/s, loss=0.6819, grad_norm=1.660, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  8.79it/s, loss=0.6681, grad_norm=1.648, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  8.81it/s, loss=0.6681, grad_norm=1.648, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  8.81it/s, loss=0.6385, grad_norm=1.471, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  8.53it/s, loss=0.6385, grad_norm=1.471, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  8.53it/s, loss=0.6279, grad_norm=1.515, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:06<00:00,  8.09it/s, loss=0.6279, grad_norm=1.515, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:07<00:00,  8.09it/s, loss=0.6603, grad_norm=1.592, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:07<00:00,  7.80it/s, loss=0.6603, grad_norm=1.592, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:07<00:00,  7.80it/s, loss=0.6373, grad_norm=1.479, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:07<00:00,  7.64it/s, loss=0.6373, grad_norm=1.479, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:07<00:00,  3.42it/s, loss=0.6373, grad_norm=1.479, lr=0

Epoch 2/5 Complete (8.3s) [LR: 0.000010]
Train - Loss: 0.6699, Acc: 0.6505, Precision: 0.6512, Recall: 0.6481, F1: 0.6497, AUC: 0.7204
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6186, grad_norm=1.483, lr=0.000010]Training Epoch 3/5:   4%| | 1/27 [00:04<01:45,  4.06s/it, loss=0.6186, grad_norm=1.483, lr=0.Training Epoch 3/5:   4%| | 1/27 [00:04<01:45,  4.06s/it, loss=0.6140, grad_norm=1.616, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:44,  1.76s/it, loss=0.6140, grad_norm=1.616, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:44,  1.76s/it, loss=0.6014, grad_norm=1.681, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.02s/it, loss=0.6014, grad_norm=1.681, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.02s/it, loss=0.6051, grad_norm=1.540, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.49it/s, loss=0.6051, grad_norm=1.540, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.49it/s, loss=0.5787, grad_norm=1.612, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.09it/s, loss=0.5787, grad_norm=1.612, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.09it/s, loss=0.5979, grad_norm=1.912, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.77it/s, loss=0.5979, grad_norm=1.912, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.77it/s, loss=0.5954, grad_norm=1.708, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.48it/s, loss=0.5954, grad_norm=1.708, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:05<00:05,  3.48it/s, loss=0.5793, grad_norm=1.816, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:05<00:04,  4.22it/s, loss=0.5793, grad_norm=1.816, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:05<00:04,  4.22it/s, loss=0.5732, grad_norm=2.113, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  4.89it/s, loss=0.5732, grad_norm=2.113, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  4.89it/s, loss=0.6694, grad_norm=2.765, lr=0.Training Epoch 3/5:  37%|3| 10/27 [00:05<00:03,  5.46it/s, loss=0.6694, grad_norm=2.765, lr=0Training Epoch 3/5:  37%|3| 10/27 [00:05<00:03,  5.46it/s, loss=0.5859, grad_norm=1.834, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  5.98it/s, loss=0.5859, grad_norm=1.834, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  5.98it/s, loss=0.5733, grad_norm=1.820, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  6.42it/s, loss=0.5733, grad_norm=1.820, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  6.42it/s, loss=0.5407, grad_norm=2.062, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:02,  6.77it/s, loss=0.5407, grad_norm=2.062, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:02,  6.77it/s, loss=0.5425, grad_norm=1.995, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  6.97it/s, loss=0.5425, grad_norm=1.995, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  6.97it/s, loss=0.5098, grad_norm=1.849, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  7.21it/s, loss=0.5098, grad_norm=1.849, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:06<00:01,  7.21it/s, loss=0.5306, grad_norm=2.520, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:06<00:01,  7.38it/s, loss=0.5306, grad_norm=2.520, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:06<00:01,  7.38it/s, loss=0.5432, grad_norm=2.210, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:06<00:01,  7.50it/s, loss=0.5432, grad_norm=2.210, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:06<00:01,  7.50it/s, loss=0.5184, grad_norm=2.995, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  7.52it/s, loss=0.5184, grad_norm=2.995, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  7.52it/s, loss=0.4941, grad_norm=2.139, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:01,  7.54it/s, loss=0.4941, grad_norm=2.139, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:01,  7.54it/s, loss=0.4733, grad_norm=2.200, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  7.51it/s, loss=0.4733, grad_norm=2.200, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  7.51it/s, loss=0.4296, grad_norm=1.833, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  7.50it/s, loss=0.4296, grad_norm=1.833, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  7.50it/s, loss=0.4778, grad_norm=2.362, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  7.44it/s, loss=0.4778, grad_norm=2.362, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:07<00:00,  7.44it/s, loss=0.4058, grad_norm=1.984, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:07<00:00,  7.47it/s, loss=0.4058, grad_norm=1.984, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:07<00:00,  7.47it/s, loss=0.5156, grad_norm=3.105, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:07<00:00,  7.52it/s, loss=0.5156, grad_norm=3.105, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:07<00:00,  7.52it/s, loss=0.4987, grad_norm=2.675, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:07<00:00,  7.42it/s, loss=0.4987, grad_norm=2.675, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:07<00:00,  7.42it/s, loss=0.3958, grad_norm=2.614, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:07<00:00,  7.44it/s, loss=0.3958, grad_norm=2.614, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:07<00:00,  7.44it/s, loss=0.5001, grad_norm=3.183, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:07<00:00,  7.37it/s, loss=0.5001, grad_norm=3.183, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:08<00:00,  3.28it/s, loss=0.5001, grad_norm=3.183, lr=0

Epoch 3/5 Complete (8.7s) [LR: 0.000010]
Train - Loss: 0.5396, Acc: 0.8866, Precision: 0.8778, Recall: 0.8981, F1: 0.8879, AUC: 0.9415
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.3554, grad_norm=1.695, lr=0.000010]Training Epoch 4/5:   4%| | 1/27 [00:04<01:47,  4.14s/it, loss=0.3554, grad_norm=1.695, lr=0.Training Epoch 4/5:   4%| | 1/27 [00:04<01:47,  4.14s/it, loss=0.4560, grad_norm=3.985, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.4560, grad_norm=3.985, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.3407, grad_norm=2.139, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:24,  1.02s/it, loss=0.3407, grad_norm=2.139, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:24,  1.02s/it, loss=0.3221, grad_norm=1.350, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:15,  1.51it/s, loss=0.3221, grad_norm=1.350, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:15,  1.51it/s, loss=0.2931, grad_norm=2.606, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.15it/s, loss=0.2931, grad_norm=2.606, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.15it/s, loss=0.3752, grad_norm=4.891, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.89it/s, loss=0.3752, grad_norm=4.891, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.89it/s, loss=0.4126, grad_norm=4.986, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.70it/s, loss=0.4126, grad_norm=4.986, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.70it/s, loss=0.5614, grad_norm=14.272, lr=0Training Epoch 4/5:  30%|2| 8/27 [00:04<00:04,  4.50it/s, loss=0.5614, grad_norm=14.272, lr=0Training Epoch 4/5:  30%|2| 8/27 [00:05<00:04,  4.50it/s, loss=0.2705, grad_norm=2.102, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:05<00:03,  5.29it/s, loss=0.2705, grad_norm=2.102, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:05<00:03,  5.29it/s, loss=0.2517, grad_norm=3.377, lr=0.Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  5.96it/s, loss=0.2517, grad_norm=3.377, lr=0Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  5.96it/s, loss=0.3677, grad_norm=5.882, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.62it/s, loss=0.3677, grad_norm=5.882, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.62it/s, loss=0.5103, grad_norm=5.067, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  7.15it/s, loss=0.5103, grad_norm=5.067, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  7.15it/s, loss=0.2255, grad_norm=4.108, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.52it/s, loss=0.2255, grad_norm=4.108, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.52it/s, loss=0.2319, grad_norm=2.477, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.82it/s, loss=0.2319, grad_norm=2.477, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.82it/s, loss=0.5333, grad_norm=6.743, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.08it/s, loss=0.5333, grad_norm=6.743, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.08it/s, loss=0.4502, grad_norm=5.213, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.25it/s, loss=0.4502, grad_norm=5.213, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.25it/s, loss=0.3359, grad_norm=5.829, lr=0Training Epoch 4/5:  63%|6| 17/27 [00:05<00:01,  8.36it/s, loss=0.3359, grad_norm=5.829, lr=0Training Epoch 4/5:  63%|6| 17/27 [00:06<00:01,  8.36it/s, loss=0.3356, grad_norm=6.400, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  8.37it/s, loss=0.3356, grad_norm=6.400, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  8.37it/s, loss=0.2087, grad_norm=4.014, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.42it/s, loss=0.2087, grad_norm=4.014, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.42it/s, loss=0.2138, grad_norm=4.674, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.47it/s, loss=0.2138, grad_norm=4.674, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.47it/s, loss=0.1532, grad_norm=1.886, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.55it/s, loss=0.1532, grad_norm=1.886, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.55it/s, loss=0.2837, grad_norm=9.140, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.44it/s, loss=0.2837, grad_norm=9.140, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.44it/s, loss=0.2691, grad_norm=4.777, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.53it/s, loss=0.2691, grad_norm=4.777, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.53it/s, loss=0.2734, grad_norm=5.016, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  8.65it/s, loss=0.2734, grad_norm=5.016, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  8.65it/s, loss=0.4275, grad_norm=6.756, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:06<00:00,  8.75it/s, loss=0.4275, grad_norm=6.756, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:07<00:00,  8.75it/s, loss=0.2470, grad_norm=12.686, lr=Training Epoch 4/5:  96%|9| 26/27 [00:07<00:00,  8.77it/s, loss=0.2470, grad_norm=12.686, lr=Training Epoch 4/5:  96%|9| 26/27 [00:07<00:00,  8.77it/s, loss=0.1476, grad_norm=2.121, lr=0Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  8.73it/s, loss=0.1476, grad_norm=2.121, lr=0Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  3.49it/s, loss=0.1476, grad_norm=2.121, lr=0

Epoch 4/5 Complete (8.1s) [LR: 0.000010]
Train - Loss: 0.3279, Acc: 0.9097, Precision: 0.9116, Recall: 0.9074, F1: 0.9095, AUC: 0.9523
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/27 [00:04<?, ?it/s, loss=0.3662, grad_norm=11.014, lr=0.000010]Training Epoch 5/5:   4%| | 1/27 [00:04<01:50,  4.24s/it, loss=0.3662, grad_norm=11.014, lr=0Training Epoch 5/5:   4%| | 1/27 [00:04<01:50,  4.24s/it, loss=0.1226, grad_norm=2.499, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:45,  1.83s/it, loss=0.1226, grad_norm=2.499, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:45,  1.83s/it, loss=0.1471, grad_norm=1.023, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:25,  1.06s/it, loss=0.1471, grad_norm=1.023, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:25,  1.06s/it, loss=0.1472, grad_norm=2.993, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:15,  1.45it/s, loss=0.1472, grad_norm=2.993, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:15,  1.45it/s, loss=0.2538, grad_norm=4.518, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.07it/s, loss=0.2538, grad_norm=4.518, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.07it/s, loss=0.0990, grad_norm=1.669, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.78it/s, loss=0.0990, grad_norm=1.669, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:05<00:07,  2.78it/s, loss=0.2958, grad_norm=13.645, lr=0Training Epoch 5/5:  26%|2| 7/27 [00:05<00:05,  3.47it/s, loss=0.2958, grad_norm=13.645, lr=0Training Epoch 5/5:  26%|2| 7/27 [00:05<00:05,  3.47it/s, loss=0.1034, grad_norm=1.904, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:05<00:04,  4.16it/s, loss=0.1034, grad_norm=1.904, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:05<00:04,  4.16it/s, loss=0.1395, grad_norm=5.378, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:05<00:03,  4.79it/s, loss=0.1395, grad_norm=5.378, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:05<00:03,  4.79it/s, loss=0.2130, grad_norm=8.194, lr=0.Training Epoch 5/5:  37%|3| 10/27 [00:05<00:03,  5.34it/s, loss=0.2130, grad_norm=8.194, lr=0Training Epoch 5/5:  37%|3| 10/27 [00:05<00:03,  5.34it/s, loss=0.1112, grad_norm=3.741, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  5.88it/s, loss=0.1112, grad_norm=3.741, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  5.88it/s, loss=0.1400, grad_norm=3.042, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  6.24it/s, loss=0.1400, grad_norm=3.042, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  6.24it/s, loss=0.5048, grad_norm=18.696, lr=Training Epoch 5/5:  48%|4| 13/27 [00:05<00:02,  6.53it/s, loss=0.5048, grad_norm=18.696, lr=Training Epoch 5/5:  48%|4| 13/27 [00:05<00:02,  6.53it/s, loss=0.1208, grad_norm=4.154, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  6.71it/s, loss=0.1208, grad_norm=4.154, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:06<00:01,  6.71it/s, loss=0.2006, grad_norm=4.632, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:06<00:01,  6.94it/s, loss=0.2006, grad_norm=4.632, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:06<00:01,  6.94it/s, loss=0.0792, grad_norm=1.421, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:06<00:01,  7.30it/s, loss=0.0792, grad_norm=1.421, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:06<00:01,  7.30it/s, loss=0.0929, grad_norm=3.539, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:06<00:01,  7.38it/s, loss=0.0929, grad_norm=3.539, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:06<00:01,  7.38it/s, loss=0.2225, grad_norm=12.218, lr=Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  7.50it/s, loss=0.2225, grad_norm=12.218, lr=Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  7.50it/s, loss=0.1002, grad_norm=4.243, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:01,  7.47it/s, loss=0.1002, grad_norm=4.243, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:01,  7.47it/s, loss=0.0843, grad_norm=1.644, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  7.60it/s, loss=0.0843, grad_norm=1.644, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  7.60it/s, loss=0.0589, grad_norm=0.889, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  7.58it/s, loss=0.0589, grad_norm=0.889, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:07<00:00,  7.58it/s, loss=0.1332, grad_norm=5.629, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:07<00:00,  7.45it/s, loss=0.1332, grad_norm=5.629, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:07<00:00,  7.45it/s, loss=0.2186, grad_norm=16.697, lr=Training Epoch 5/5:  85%|8| 23/27 [00:07<00:00,  7.32it/s, loss=0.2186, grad_norm=16.697, lr=Training Epoch 5/5:  85%|8| 23/27 [00:07<00:00,  7.32it/s, loss=0.0813, grad_norm=4.159, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:07<00:00,  7.29it/s, loss=0.0813, grad_norm=4.159, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:07<00:00,  7.29it/s, loss=0.0437, grad_norm=1.537, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:07<00:00,  7.36it/s, loss=0.0437, grad_norm=1.537, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:07<00:00,  7.36it/s, loss=0.0853, grad_norm=6.509, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:07<00:00,  7.52it/s, loss=0.0853, grad_norm=6.509, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:07<00:00,  7.52it/s, loss=0.1264, grad_norm=6.682, lr=0Training Epoch 5/5: 100%|#| 27/27 [00:07<00:00,  7.56it/s, loss=0.1264, grad_norm=6.682, lr=0Training Epoch 5/5: 100%|#| 27/27 [00:08<00:00,  3.21it/s, loss=0.1264, grad_norm=6.682, lr=0

Epoch 5/5 Complete (8.8s) [LR: 0.000005]
Train - Loss: 0.1589, Acc: 0.9468, Precision: 0.9617, Recall: 0.9306, F1: 0.9459, AUC: 0.9922
------------------------------------------------------------
Training curves saved to model\chb13_fold8\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold8
============================================================
✅ Fold 8 training completed successfully!

============================================================
TRAINING FOLD 9/11
============================================================
Using dataset prefix: chb13_fold9
Loading datasets from: preprocessing\data\chb13_fold9
Saving models to: model\chb13_fold9
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.4172, std=2.4492
Loaded train dataset: 428 samples
  - Spectrogram shape: torch.Size([428, 30, 18, 50, 10])
  - Value range: [-5.0698, 3.5224]
  - Class distribution: tensor([214, 214])
LOOCV Mode (Fold 9): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6953, grad_norm=1.138, lr=0.000010]Training Epoch 1/5:   4%| | 1/27 [00:04<01:47,  4.13s/it, loss=0.6953, grad_norm=1.138, lr=0.Training Epoch 1/5:   4%| | 1/27 [00:04<01:47,  4.13s/it, loss=0.6952, grad_norm=1.327, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.6952, grad_norm=1.327, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.6972, grad_norm=1.229, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.03s/it, loss=0.6972, grad_norm=1.229, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:24,  1.03s/it, loss=0.6804, grad_norm=1.091, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.49it/s, loss=0.6804, grad_norm=1.091, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.49it/s, loss=0.7024, grad_norm=1.172, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.09it/s, loss=0.7024, grad_norm=1.172, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.09it/s, loss=0.6771, grad_norm=1.206, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.77it/s, loss=0.6771, grad_norm=1.206, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.77it/s, loss=0.6764, grad_norm=1.103, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.48it/s, loss=0.6764, grad_norm=1.103, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:05<00:05,  3.48it/s, loss=0.7023, grad_norm=1.005, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:05<00:04,  4.18it/s, loss=0.7023, grad_norm=1.005, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:05<00:04,  4.18it/s, loss=0.6798, grad_norm=1.038, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  4.81it/s, loss=0.6798, grad_norm=1.038, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  4.81it/s, loss=0.6874, grad_norm=1.014, lr=0.Training Epoch 1/5:  37%|3| 10/27 [00:05<00:03,  5.49it/s, loss=0.6874, grad_norm=1.014, lr=0Training Epoch 1/5:  37%|3| 10/27 [00:05<00:03,  5.49it/s, loss=0.7167, grad_norm=1.235, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.03it/s, loss=0.7167, grad_norm=1.235, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.03it/s, loss=0.6995, grad_norm=1.070, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  6.40it/s, loss=0.6995, grad_norm=1.070, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  6.40it/s, loss=0.7380, grad_norm=1.514, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:02,  6.75it/s, loss=0.7380, grad_norm=1.514, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:02,  6.75it/s, loss=0.6837, grad_norm=0.985, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  6.97it/s, loss=0.6837, grad_norm=0.985, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  6.97it/s, loss=0.6883, grad_norm=1.042, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  7.08it/s, loss=0.6883, grad_norm=1.042, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:06<00:01,  7.08it/s, loss=0.6772, grad_norm=1.011, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:06<00:01,  7.15it/s, loss=0.6772, grad_norm=1.011, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:06<00:01,  7.15it/s, loss=0.6982, grad_norm=1.009, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:06<00:01,  7.49it/s, loss=0.6982, grad_norm=1.009, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:06<00:01,  7.49it/s, loss=0.6951, grad_norm=0.975, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  7.85it/s, loss=0.6951, grad_norm=0.975, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  7.85it/s, loss=0.6808, grad_norm=1.009, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:01,  7.96it/s, loss=0.6808, grad_norm=1.009, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:01,  7.96it/s, loss=0.6970, grad_norm=1.040, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  7.78it/s, loss=0.6970, grad_norm=1.040, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  7.78it/s, loss=0.6927, grad_norm=1.187, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  7.74it/s, loss=0.6927, grad_norm=1.187, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  7.74it/s, loss=0.6889, grad_norm=1.000, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  7.71it/s, loss=0.6889, grad_norm=1.000, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:07<00:00,  7.71it/s, loss=0.7033, grad_norm=1.144, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:07<00:00,  7.59it/s, loss=0.7033, grad_norm=1.144, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:07<00:00,  7.59it/s, loss=0.6999, grad_norm=1.066, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:07<00:00,  7.30it/s, loss=0.6999, grad_norm=1.066, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:07<00:00,  7.30it/s, loss=0.7003, grad_norm=1.126, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:07<00:00,  7.28it/s, loss=0.7003, grad_norm=1.126, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:07<00:00,  7.28it/s, loss=0.7024, grad_norm=1.319, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:07<00:00,  7.25it/s, loss=0.7024, grad_norm=1.319, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:07<00:00,  7.25it/s, loss=0.6933, grad_norm=1.148, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:07<00:00,  7.66it/s, loss=0.6933, grad_norm=1.148, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:08<00:00,  3.26it/s, loss=0.6933, grad_norm=1.148, lr=0

Epoch 1/5 Complete (8.7s) [LR: 0.000010]
Train - Loss: 0.6944, Acc: 0.4930, Precision: 0.4960, Recall: 0.8692, F1: 0.6316, AUC: 0.5095
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6934, grad_norm=1.064, lr=0.000010]Training Epoch 2/5:   4%| | 1/27 [00:04<01:47,  4.13s/it, loss=0.6934, grad_norm=1.064, lr=0.Training Epoch 2/5:   4%| | 1/27 [00:04<01:47,  4.13s/it, loss=0.6898, grad_norm=1.160, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:44,  1.77s/it, loss=0.6898, grad_norm=1.160, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:44,  1.77s/it, loss=0.6853, grad_norm=1.151, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6853, grad_norm=1.151, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6858, grad_norm=1.029, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:15,  1.52it/s, loss=0.6858, grad_norm=1.029, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:15,  1.52it/s, loss=0.6979, grad_norm=1.129, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:10,  2.15it/s, loss=0.6979, grad_norm=1.129, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:10,  2.15it/s, loss=0.6807, grad_norm=1.029, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.89it/s, loss=0.6807, grad_norm=1.029, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:04<00:07,  2.89it/s, loss=0.6783, grad_norm=1.099, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.72it/s, loss=0.6783, grad_norm=1.099, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:04<00:05,  3.72it/s, loss=0.7001, grad_norm=1.223, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:04<00:04,  4.56it/s, loss=0.7001, grad_norm=1.223, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:05<00:04,  4.56it/s, loss=0.6846, grad_norm=1.129, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  5.37it/s, loss=0.6846, grad_norm=1.129, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  5.37it/s, loss=0.6866, grad_norm=1.121, lr=0.Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.11it/s, loss=0.6866, grad_norm=1.121, lr=0Training Epoch 2/5:  37%|3| 10/27 [00:05<00:02,  6.11it/s, loss=0.6678, grad_norm=1.089, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.74it/s, loss=0.6678, grad_norm=1.089, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  6.74it/s, loss=0.6779, grad_norm=1.224, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  7.27it/s, loss=0.6779, grad_norm=1.224, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  7.27it/s, loss=0.6715, grad_norm=1.182, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.67it/s, loss=0.6715, grad_norm=1.182, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:01,  7.67it/s, loss=0.6825, grad_norm=1.096, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.00it/s, loss=0.6825, grad_norm=1.096, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:05<00:01,  8.00it/s, loss=0.6805, grad_norm=1.158, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.24it/s, loss=0.6805, grad_norm=1.158, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:05<00:01,  8.24it/s, loss=0.6769, grad_norm=1.266, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.41it/s, loss=0.6769, grad_norm=1.266, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:05<00:01,  8.41it/s, loss=0.6597, grad_norm=1.191, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:05<00:01,  8.52it/s, loss=0.6597, grad_norm=1.191, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:06<00:01,  8.52it/s, loss=0.6799, grad_norm=1.204, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  8.66it/s, loss=0.6799, grad_norm=1.204, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  8.66it/s, loss=0.6751, grad_norm=1.389, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:00,  8.74it/s, loss=0.6751, grad_norm=1.389, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:00,  8.74it/s, loss=0.6777, grad_norm=1.223, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  8.76it/s, loss=0.6777, grad_norm=1.223, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  8.76it/s, loss=0.7026, grad_norm=1.297, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  8.77it/s, loss=0.7026, grad_norm=1.297, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:06<00:00,  8.77it/s, loss=0.6638, grad_norm=1.212, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  8.52it/s, loss=0.6638, grad_norm=1.212, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:06<00:00,  8.52it/s, loss=0.7039, grad_norm=1.468, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  8.07it/s, loss=0.7039, grad_norm=1.468, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:06<00:00,  8.07it/s, loss=0.6760, grad_norm=1.255, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  7.72it/s, loss=0.6760, grad_norm=1.255, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:06<00:00,  7.72it/s, loss=0.6688, grad_norm=1.100, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:06<00:00,  7.57it/s, loss=0.6688, grad_norm=1.100, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:07<00:00,  7.57it/s, loss=0.6931, grad_norm=1.422, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:07<00:00,  7.56it/s, loss=0.6931, grad_norm=1.422, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:07<00:00,  7.56it/s, loss=0.6743, grad_norm=1.777, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:07<00:00,  7.93it/s, loss=0.6743, grad_norm=1.777, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:07<00:00,  3.45it/s, loss=0.6743, grad_norm=1.777, lr=0

Epoch 2/5 Complete (8.2s) [LR: 0.000010]
Train - Loss: 0.6820, Acc: 0.5935, Precision: 0.6695, Recall: 0.3692, F1: 0.4759, AUC: 0.6503
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6578, grad_norm=1.349, lr=0.000010]Training Epoch 3/5:   4%| | 1/27 [00:04<01:46,  4.11s/it, loss=0.6578, grad_norm=1.349, lr=0.Training Epoch 3/5:   4%| | 1/27 [00:04<01:46,  4.11s/it, loss=0.6738, grad_norm=1.279, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:44,  1.76s/it, loss=0.6738, grad_norm=1.279, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:44,  1.76s/it, loss=0.6308, grad_norm=1.272, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6308, grad_norm=1.272, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.6513, grad_norm=1.501, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.53it/s, loss=0.6513, grad_norm=1.501, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.53it/s, loss=0.6272, grad_norm=1.391, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.18it/s, loss=0.6272, grad_norm=1.391, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.18it/s, loss=0.6383, grad_norm=1.594, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.93it/s, loss=0.6383, grad_norm=1.594, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.93it/s, loss=0.6438, grad_norm=1.431, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.76it/s, loss=0.6438, grad_norm=1.431, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.76it/s, loss=0.6396, grad_norm=1.436, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:04<00:04,  4.59it/s, loss=0.6396, grad_norm=1.436, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:05<00:04,  4.59it/s, loss=0.6110, grad_norm=1.383, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  5.37it/s, loss=0.6110, grad_norm=1.383, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  5.37it/s, loss=0.6723, grad_norm=1.577, lr=0.Training Epoch 3/5:  37%|3| 10/27 [00:05<00:02,  6.12it/s, loss=0.6723, grad_norm=1.577, lr=0Training Epoch 3/5:  37%|3| 10/27 [00:05<00:02,  6.12it/s, loss=0.6227, grad_norm=1.498, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.75it/s, loss=0.6227, grad_norm=1.498, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  6.75it/s, loss=0.6021, grad_norm=1.384, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  7.31it/s, loss=0.6021, grad_norm=1.384, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  7.31it/s, loss=0.6064, grad_norm=1.622, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.72it/s, loss=0.6064, grad_norm=1.622, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:01,  7.72it/s, loss=0.6493, grad_norm=2.037, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  7.98it/s, loss=0.6493, grad_norm=2.037, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  7.98it/s, loss=0.6384, grad_norm=1.963, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  8.23it/s, loss=0.6384, grad_norm=1.963, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  8.23it/s, loss=0.5869, grad_norm=1.971, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:05<00:01,  8.44it/s, loss=0.5869, grad_norm=1.971, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:05<00:01,  8.44it/s, loss=0.5699, grad_norm=1.423, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:05<00:01,  8.58it/s, loss=0.5699, grad_norm=1.423, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:06<00:01,  8.58it/s, loss=0.5985, grad_norm=1.668, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  8.64it/s, loss=0.5985, grad_norm=1.668, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  8.64it/s, loss=0.5727, grad_norm=1.945, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:00,  8.66it/s, loss=0.5727, grad_norm=1.945, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:00,  8.66it/s, loss=0.5428, grad_norm=1.811, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  8.65it/s, loss=0.5428, grad_norm=1.811, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  8.65it/s, loss=0.5675, grad_norm=1.780, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  8.42it/s, loss=0.5675, grad_norm=1.780, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  8.42it/s, loss=0.5429, grad_norm=2.341, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  8.50it/s, loss=0.5429, grad_norm=2.341, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  8.50it/s, loss=0.5137, grad_norm=1.968, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:06<00:00,  8.56it/s, loss=0.5137, grad_norm=1.968, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:06<00:00,  8.56it/s, loss=0.5563, grad_norm=2.089, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:06<00:00,  8.61it/s, loss=0.5563, grad_norm=2.089, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:06<00:00,  8.61it/s, loss=0.5296, grad_norm=1.772, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:06<00:00,  8.72it/s, loss=0.5296, grad_norm=1.772, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:06<00:00,  8.72it/s, loss=0.4797, grad_norm=2.028, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:06<00:00,  8.78it/s, loss=0.4797, grad_norm=2.028, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:07<00:00,  8.78it/s, loss=0.5476, grad_norm=2.193, lr=0Training Epoch 3/5: 100%|#| 27/27 [00:07<00:00,  3.53it/s, loss=0.5476, grad_norm=2.193, lr=0

Epoch 3/5 Complete (8.1s) [LR: 0.000010]
Train - Loss: 0.5990, Acc: 0.8481, Precision: 0.8465, Recall: 0.8505, F1: 0.8485, AUC: 0.9245
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.4104, grad_norm=2.293, lr=0.000010]Training Epoch 4/5:   4%| | 1/27 [00:04<01:45,  4.07s/it, loss=0.4104, grad_norm=2.293, lr=0.Training Epoch 4/5:   4%| | 1/27 [00:04<01:45,  4.07s/it, loss=0.5077, grad_norm=4.329, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:43,  1.74s/it, loss=0.5077, grad_norm=4.329, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:43,  1.74s/it, loss=0.4725, grad_norm=3.464, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.4725, grad_norm=3.464, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.3840, grad_norm=1.382, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:14,  1.54it/s, loss=0.3840, grad_norm=1.382, lr=0.Training Epoch 4/5:  15%|1| 4/27 [00:04<00:14,  1.54it/s, loss=0.3673, grad_norm=1.549, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.3673, grad_norm=1.549, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.4303, grad_norm=1.830, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.4303, grad_norm=1.830, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.94it/s, loss=0.4462, grad_norm=2.909, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.76it/s, loss=0.4462, grad_norm=2.909, lr=0.Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.76it/s, loss=0.3353, grad_norm=1.667, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:04<00:04,  4.60it/s, loss=0.3353, grad_norm=1.667, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:04<00:04,  4.60it/s, loss=0.4747, grad_norm=5.003, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:04<00:03,  5.37it/s, loss=0.4747, grad_norm=5.003, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:05<00:03,  5.37it/s, loss=0.3725, grad_norm=3.290, lr=0.Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  6.07it/s, loss=0.3725, grad_norm=3.290, lr=0Training Epoch 4/5:  37%|3| 10/27 [00:05<00:02,  6.07it/s, loss=0.4416, grad_norm=4.965, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.71it/s, loss=0.4416, grad_norm=4.965, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  6.71it/s, loss=0.4301, grad_norm=2.929, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  7.22it/s, loss=0.4301, grad_norm=2.929, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  7.22it/s, loss=0.3921, grad_norm=2.755, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.65it/s, loss=0.3921, grad_norm=2.755, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:01,  7.65it/s, loss=0.2810, grad_norm=2.208, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.98it/s, loss=0.2810, grad_norm=2.208, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  7.98it/s, loss=0.3264, grad_norm=4.102, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.18it/s, loss=0.3264, grad_norm=4.102, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  8.18it/s, loss=0.7039, grad_norm=11.985, lr=Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.37it/s, loss=0.7039, grad_norm=11.985, lr=Training Epoch 4/5:  59%|5| 16/27 [00:05<00:01,  8.37it/s, loss=0.2978, grad_norm=5.000, lr=0Training Epoch 4/5:  63%|6| 17/27 [00:05<00:01,  8.48it/s, loss=0.2978, grad_norm=5.000, lr=0Training Epoch 4/5:  63%|6| 17/27 [00:06<00:01,  8.48it/s, loss=0.2966, grad_norm=3.033, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  8.51it/s, loss=0.2966, grad_norm=3.033, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  8.51it/s, loss=0.3303, grad_norm=3.427, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.52it/s, loss=0.3303, grad_norm=3.427, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:00,  8.52it/s, loss=0.3300, grad_norm=3.685, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.55it/s, loss=0.3300, grad_norm=3.685, lr=0Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  8.55it/s, loss=0.3360, grad_norm=6.615, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.56it/s, loss=0.3360, grad_norm=6.615, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  8.56it/s, loss=0.2719, grad_norm=4.795, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.60it/s, loss=0.2719, grad_norm=4.795, lr=0Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  8.60it/s, loss=0.2853, grad_norm=4.932, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.69it/s, loss=0.2853, grad_norm=4.932, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:06<00:00,  8.69it/s, loss=0.2336, grad_norm=4.199, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  8.69it/s, loss=0.2336, grad_norm=4.199, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:06<00:00,  8.69it/s, loss=0.1850, grad_norm=1.321, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:06<00:00,  8.70it/s, loss=0.1850, grad_norm=1.321, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:06<00:00,  8.70it/s, loss=0.2877, grad_norm=4.510, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:06<00:00,  8.63it/s, loss=0.2877, grad_norm=4.510, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:07<00:00,  8.63it/s, loss=0.1773, grad_norm=2.381, lr=0Training Epoch 4/5: 100%|#| 27/27 [00:07<00:00,  3.55it/s, loss=0.1773, grad_norm=2.381, lr=0

Epoch 4/5 Complete (8.0s) [LR: 0.000010]
Train - Loss: 0.3632, Acc: 0.9089, Precision: 0.9070, Recall: 0.9112, F1: 0.9091, AUC: 0.9663
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.2145, grad_norm=3.449, lr=0.000010]Training Epoch 5/5:   4%| | 1/27 [00:04<01:45,  4.05s/it, loss=0.2145, grad_norm=3.449, lr=0.Training Epoch 5/5:   4%| | 1/27 [00:04<01:45,  4.05s/it, loss=0.3269, grad_norm=6.409, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:43,  1.74s/it, loss=0.3269, grad_norm=6.409, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:43,  1.74s/it, loss=0.1459, grad_norm=2.558, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.1459, grad_norm=2.558, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:23,  1.00it/s, loss=0.1872, grad_norm=4.061, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:14,  1.54it/s, loss=0.1872, grad_norm=4.061, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:14,  1.54it/s, loss=0.2495, grad_norm=3.735, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.2495, grad_norm=3.735, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.19it/s, loss=0.2574, grad_norm=6.069, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.95it/s, loss=0.2574, grad_norm=6.069, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.95it/s, loss=0.0848, grad_norm=1.230, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.77it/s, loss=0.0848, grad_norm=1.230, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:04<00:05,  3.77it/s, loss=0.1098, grad_norm=1.091, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:04<00:04,  4.61it/s, loss=0.1098, grad_norm=1.091, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:04<00:04,  4.61it/s, loss=0.1716, grad_norm=6.932, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:04<00:03,  5.37it/s, loss=0.1716, grad_norm=6.932, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:05<00:03,  5.37it/s, loss=0.1526, grad_norm=3.033, lr=0.Training Epoch 5/5:  37%|3| 10/27 [00:05<00:02,  6.09it/s, loss=0.1526, grad_norm=3.033, lr=0Training Epoch 5/5:  37%|3| 10/27 [00:05<00:02,  6.09it/s, loss=0.1561, grad_norm=5.531, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  6.72it/s, loss=0.1561, grad_norm=5.531, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  6.72it/s, loss=0.1056, grad_norm=5.056, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  7.09it/s, loss=0.1056, grad_norm=5.056, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  7.09it/s, loss=0.1261, grad_norm=5.882, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:01,  7.51it/s, loss=0.1261, grad_norm=5.882, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:01,  7.51it/s, loss=0.0698, grad_norm=1.226, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  7.85it/s, loss=0.0698, grad_norm=1.226, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  7.85it/s, loss=0.1365, grad_norm=3.239, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  8.08it/s, loss=0.1365, grad_norm=3.239, lr=0Training Epoch 5/5:  56%|5| 15/27 [00:05<00:01,  8.08it/s, loss=0.1673, grad_norm=12.959, lr=Training Epoch 5/5:  59%|5| 16/27 [00:05<00:01,  8.33it/s, loss=0.1673, grad_norm=12.959, lr=Training Epoch 5/5:  59%|5| 16/27 [00:05<00:01,  8.33it/s, loss=0.0575, grad_norm=2.281, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:05<00:01,  8.44it/s, loss=0.0575, grad_norm=2.281, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:06<00:01,  8.44it/s, loss=0.0678, grad_norm=0.789, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  8.48it/s, loss=0.0678, grad_norm=0.789, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  8.48it/s, loss=0.0545, grad_norm=0.550, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:00,  8.56it/s, loss=0.0545, grad_norm=0.550, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:00,  8.56it/s, loss=0.1672, grad_norm=10.502, lr=Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  8.62it/s, loss=0.1672, grad_norm=10.502, lr=Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  8.62it/s, loss=0.0541, grad_norm=1.035, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  8.64it/s, loss=0.0541, grad_norm=1.035, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  8.64it/s, loss=0.0584, grad_norm=0.781, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  8.69it/s, loss=0.0584, grad_norm=0.781, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:06<00:00,  8.69it/s, loss=0.1741, grad_norm=11.368, lr=Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  8.71it/s, loss=0.1741, grad_norm=11.368, lr=Training Epoch 5/5:  85%|8| 23/27 [00:06<00:00,  8.71it/s, loss=0.0541, grad_norm=4.236, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  8.76it/s, loss=0.0541, grad_norm=4.236, lr=0Training Epoch 5/5:  89%|8| 24/27 [00:06<00:00,  8.76it/s, loss=0.0543, grad_norm=2.651, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:06<00:00,  8.77it/s, loss=0.0543, grad_norm=2.651, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:06<00:00,  8.77it/s, loss=0.0353, grad_norm=1.131, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:06<00:00,  8.76it/s, loss=0.0353, grad_norm=1.131, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:07<00:00,  8.76it/s, loss=0.0857, grad_norm=12.964, lr=Training Epoch 5/5: 100%|#| 27/27 [00:07<00:00,  3.55it/s, loss=0.0857, grad_norm=12.964, lr=

Epoch 5/5 Complete (8.0s) [LR: 0.000005]
Train - Loss: 0.1305, Acc: 0.9836, Precision: 0.9683, Recall: 1.0000, F1: 0.9839, AUC: 0.9977
------------------------------------------------------------
Training curves saved to model\chb13_fold9\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold9
============================================================
✅ Fold 9 training completed successfully!

============================================================
TRAINING FOLD 10/11
============================================================
Using dataset prefix: chb13_fold10
Loading datasets from: preprocessing\data\chb13_fold10
Saving models to: model\chb13_fold10
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.3705, std=2.4484
Loaded train dataset: 434 samples
  - Spectrogram shape: torch.Size([434, 30, 18, 50, 10])
  - Value range: [-5.0525, 3.5401]
  - Class distribution: tensor([217, 217])
LOOCV Mode (Fold 10): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.6984, grad_norm=1.181, lr=0.000010]Training Epoch 1/5:   4%| | 1/28 [00:04<01:48,  4.03s/it, loss=0.6984, grad_norm=1.181, lr=0.Training Epoch 1/5:   4%| | 1/28 [00:04<01:48,  4.03s/it, loss=0.7016, grad_norm=1.147, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:44,  1.73s/it, loss=0.7016, grad_norm=1.147, lr=0.Training Epoch 1/5:   7%| | 2/28 [00:04<00:44,  1.73s/it, loss=0.7023, grad_norm=1.125, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:25,  1.00s/it, loss=0.7023, grad_norm=1.125, lr=0.Training Epoch 1/5:  11%|1| 3/28 [00:04<00:25,  1.00s/it, loss=0.6883, grad_norm=1.118, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.53it/s, loss=0.6883, grad_norm=1.118, lr=0.Training Epoch 1/5:  14%|1| 4/28 [00:04<00:15,  1.53it/s, loss=0.6930, grad_norm=0.938, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.18it/s, loss=0.6930, grad_norm=0.938, lr=0.Training Epoch 1/5:  18%|1| 5/28 [00:04<00:10,  2.18it/s, loss=0.6820, grad_norm=1.051, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.6820, grad_norm=1.051, lr=0.Training Epoch 1/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.6896, grad_norm=1.162, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.73it/s, loss=0.6896, grad_norm=1.162, lr=0.Training Epoch 1/5:  25%|2| 7/28 [00:04<00:05,  3.73it/s, loss=0.6857, grad_norm=0.996, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:04<00:04,  4.56it/s, loss=0.6857, grad_norm=0.996, lr=0.Training Epoch 1/5:  29%|2| 8/28 [00:04<00:04,  4.56it/s, loss=0.6955, grad_norm=1.056, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:04<00:03,  5.37it/s, loss=0.6955, grad_norm=1.056, lr=0.Training Epoch 1/5:  32%|3| 9/28 [00:05<00:03,  5.37it/s, loss=0.6931, grad_norm=0.951, lr=0.Training Epoch 1/5:  36%|3| 10/28 [00:05<00:02,  6.13it/s, loss=0.6931, grad_norm=0.951, lr=0Training Epoch 1/5:  36%|3| 10/28 [00:05<00:02,  6.13it/s, loss=0.6948, grad_norm=1.201, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.78it/s, loss=0.6948, grad_norm=1.201, lr=0Training Epoch 1/5:  39%|3| 11/28 [00:05<00:02,  6.78it/s, loss=0.6947, grad_norm=1.011, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.24it/s, loss=0.6947, grad_norm=1.011, lr=0Training Epoch 1/5:  43%|4| 12/28 [00:05<00:02,  7.24it/s, loss=0.6940, grad_norm=1.154, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:01,  7.60it/s, loss=0.6940, grad_norm=1.154, lr=0Training Epoch 1/5:  46%|4| 13/28 [00:05<00:01,  7.60it/s, loss=0.7016, grad_norm=1.282, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  7.98it/s, loss=0.7016, grad_norm=1.282, lr=0Training Epoch 1/5:  50%|5| 14/28 [00:05<00:01,  7.98it/s, loss=0.6887, grad_norm=1.142, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  8.26it/s, loss=0.6887, grad_norm=1.142, lr=0Training Epoch 1/5:  54%|5| 15/28 [00:05<00:01,  8.26it/s, loss=0.7058, grad_norm=1.144, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.40it/s, loss=0.7058, grad_norm=1.144, lr=0Training Epoch 1/5:  57%|5| 16/28 [00:05<00:01,  8.40it/s, loss=0.6921, grad_norm=1.205, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:05<00:01,  8.47it/s, loss=0.6921, grad_norm=1.205, lr=0Training Epoch 1/5:  61%|6| 17/28 [00:05<00:01,  8.47it/s, loss=0.6816, grad_norm=1.109, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:05<00:01,  8.53it/s, loss=0.6816, grad_norm=1.109, lr=0Training Epoch 1/5:  64%|6| 18/28 [00:06<00:01,  8.53it/s, loss=0.6883, grad_norm=1.018, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:01,  8.63it/s, loss=0.6883, grad_norm=1.018, lr=0Training Epoch 1/5:  68%|6| 19/28 [00:06<00:01,  8.63it/s, loss=0.6977, grad_norm=1.187, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  8.72it/s, loss=0.6977, grad_norm=1.187, lr=0Training Epoch 1/5:  71%|7| 20/28 [00:06<00:00,  8.72it/s, loss=0.6820, grad_norm=1.071, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  8.70it/s, loss=0.6820, grad_norm=1.071, lr=0Training Epoch 1/5:  75%|7| 21/28 [00:06<00:00,  8.70it/s, loss=0.6726, grad_norm=1.108, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  8.76it/s, loss=0.6726, grad_norm=1.108, lr=0Training Epoch 1/5:  79%|7| 22/28 [00:06<00:00,  8.76it/s, loss=0.6758, grad_norm=1.027, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  8.74it/s, loss=0.6758, grad_norm=1.027, lr=0Training Epoch 1/5:  82%|8| 23/28 [00:06<00:00,  8.74it/s, loss=0.6953, grad_norm=1.157, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  8.79it/s, loss=0.6953, grad_norm=1.157, lr=0Training Epoch 1/5:  86%|8| 24/28 [00:06<00:00,  8.79it/s, loss=0.6955, grad_norm=1.409, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:06<00:00,  8.73it/s, loss=0.6955, grad_norm=1.409, lr=0Training Epoch 1/5:  89%|8| 25/28 [00:06<00:00,  8.73it/s, loss=0.6915, grad_norm=1.252, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:06<00:00,  8.67it/s, loss=0.6915, grad_norm=1.252, lr=0Training Epoch 1/5:  93%|9| 26/28 [00:07<00:00,  8.67it/s, loss=0.6723, grad_norm=1.181, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:07<00:00,  8.69it/s, loss=0.6723, grad_norm=1.181, lr=0Training Epoch 1/5:  96%|9| 27/28 [00:07<00:00,  8.69it/s, loss=0.6698, grad_norm=3.206, lr=0Training Epoch 1/5: 100%|#| 28/28 [00:07<00:00,  3.66it/s, loss=0.6698, grad_norm=3.206, lr=0

Epoch 1/5 Complete (8.0s) [LR: 0.000010]
Train - Loss: 0.6901, Acc: 0.5115, Precision: 0.5197, Recall: 0.3041, F1: 0.3837, AUC: 0.5630
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/28 [00:03<?, ?it/s, loss=0.6874, grad_norm=1.189, lr=0.000010]Training Epoch 2/5:   4%| | 1/28 [00:03<01:47,  3.97s/it, loss=0.6874, grad_norm=1.189, lr=0.Training Epoch 2/5:   4%| | 1/28 [00:04<01:47,  3.97s/it, loss=0.6752, grad_norm=1.184, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:44,  1.71s/it, loss=0.6752, grad_norm=1.184, lr=0.Training Epoch 2/5:   7%| | 2/28 [00:04<00:44,  1.71s/it, loss=0.6981, grad_norm=1.394, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.6981, grad_norm=1.394, lr=0.Training Epoch 2/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.6571, grad_norm=1.248, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:15,  1.56it/s, loss=0.6571, grad_norm=1.248, lr=0.Training Epoch 2/5:  14%|1| 4/28 [00:04<00:15,  1.56it/s, loss=0.6761, grad_norm=1.014, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:10,  2.21it/s, loss=0.6761, grad_norm=1.014, lr=0.Training Epoch 2/5:  18%|1| 5/28 [00:04<00:10,  2.21it/s, loss=0.6924, grad_norm=1.208, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.6924, grad_norm=1.208, lr=0.Training Epoch 2/5:  21%|2| 6/28 [00:04<00:07,  2.94it/s, loss=0.6733, grad_norm=1.249, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:04<00:05,  3.70it/s, loss=0.6733, grad_norm=1.249, lr=0.Training Epoch 2/5:  25%|2| 7/28 [00:04<00:05,  3.70it/s, loss=0.6718, grad_norm=1.245, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:04<00:04,  4.50it/s, loss=0.6718, grad_norm=1.245, lr=0.Training Epoch 2/5:  29%|2| 8/28 [00:04<00:04,  4.50it/s, loss=0.6724, grad_norm=1.321, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:04<00:03,  5.26it/s, loss=0.6724, grad_norm=1.321, lr=0.Training Epoch 2/5:  32%|3| 9/28 [00:05<00:03,  5.26it/s, loss=0.6567, grad_norm=1.256, lr=0.Training Epoch 2/5:  36%|3| 10/28 [00:05<00:03,  5.92it/s, loss=0.6567, grad_norm=1.256, lr=0Training Epoch 2/5:  36%|3| 10/28 [00:05<00:03,  5.92it/s, loss=0.6740, grad_norm=1.352, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:05<00:02,  6.50it/s, loss=0.6740, grad_norm=1.352, lr=0Training Epoch 2/5:  39%|3| 11/28 [00:05<00:02,  6.50it/s, loss=0.6490, grad_norm=1.649, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  6.96it/s, loss=0.6490, grad_norm=1.649, lr=0Training Epoch 2/5:  43%|4| 12/28 [00:05<00:02,  6.96it/s, loss=0.6630, grad_norm=1.410, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:02,  7.45it/s, loss=0.6630, grad_norm=1.410, lr=0Training Epoch 2/5:  46%|4| 13/28 [00:05<00:02,  7.45it/s, loss=0.6835, grad_norm=1.400, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  7.81it/s, loss=0.6835, grad_norm=1.400, lr=0Training Epoch 2/5:  50%|5| 14/28 [00:05<00:01,  7.81it/s, loss=0.6861, grad_norm=1.354, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:05<00:01,  8.06it/s, loss=0.6861, grad_norm=1.354, lr=0Training Epoch 2/5:  54%|5| 15/28 [00:05<00:01,  8.06it/s, loss=0.6645, grad_norm=1.379, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:05<00:01,  8.31it/s, loss=0.6645, grad_norm=1.379, lr=0Training Epoch 2/5:  57%|5| 16/28 [00:05<00:01,  8.31it/s, loss=0.6550, grad_norm=1.391, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:05<00:01,  8.44it/s, loss=0.6550, grad_norm=1.391, lr=0Training Epoch 2/5:  61%|6| 17/28 [00:05<00:01,  8.44it/s, loss=0.6359, grad_norm=1.304, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:05<00:01,  8.57it/s, loss=0.6359, grad_norm=1.304, lr=0Training Epoch 2/5:  64%|6| 18/28 [00:06<00:01,  8.57it/s, loss=0.6875, grad_norm=1.556, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:06<00:01,  8.69it/s, loss=0.6875, grad_norm=1.556, lr=0Training Epoch 2/5:  68%|6| 19/28 [00:06<00:01,  8.69it/s, loss=0.6753, grad_norm=1.581, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:06<00:00,  8.79it/s, loss=0.6753, grad_norm=1.581, lr=0Training Epoch 2/5:  71%|7| 20/28 [00:06<00:00,  8.79it/s, loss=0.6895, grad_norm=1.836, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  8.84it/s, loss=0.6895, grad_norm=1.836, lr=0Training Epoch 2/5:  75%|7| 21/28 [00:06<00:00,  8.84it/s, loss=0.6404, grad_norm=1.310, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  8.85it/s, loss=0.6404, grad_norm=1.310, lr=0Training Epoch 2/5:  79%|7| 22/28 [00:06<00:00,  8.85it/s, loss=0.6272, grad_norm=1.676, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:06<00:00,  8.83it/s, loss=0.6272, grad_norm=1.676, lr=0Training Epoch 2/5:  82%|8| 23/28 [00:06<00:00,  8.83it/s, loss=0.6419, grad_norm=1.320, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:06<00:00,  8.85it/s, loss=0.6419, grad_norm=1.320, lr=0Training Epoch 2/5:  86%|8| 24/28 [00:06<00:00,  8.85it/s, loss=0.6351, grad_norm=1.623, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:06<00:00,  8.74it/s, loss=0.6351, grad_norm=1.623, lr=0Training Epoch 2/5:  89%|8| 25/28 [00:06<00:00,  8.74it/s, loss=0.6296, grad_norm=1.641, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:06<00:00,  8.80it/s, loss=0.6296, grad_norm=1.641, lr=0Training Epoch 2/5:  93%|9| 26/28 [00:06<00:00,  8.80it/s, loss=0.6062, grad_norm=1.502, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:06<00:00,  8.87it/s, loss=0.6062, grad_norm=1.502, lr=0Training Epoch 2/5:  96%|9| 27/28 [00:07<00:00,  8.87it/s, loss=0.6171, grad_norm=4.340, lr=0Training Epoch 2/5: 100%|#| 28/28 [00:07<00:00,  3.69it/s, loss=0.6171, grad_norm=4.340, lr=0

Epoch 2/5 Complete (8.0s) [LR: 0.000010]
Train - Loss: 0.6615, Acc: 0.6636, Precision: 0.7840, Recall: 0.4516, F1: 0.5731, AUC: 0.8275
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/28 [00:03<?, ?it/s, loss=0.6273, grad_norm=1.729, lr=0.000010]Training Epoch 3/5:   4%| | 1/28 [00:03<01:47,  3.98s/it, loss=0.6273, grad_norm=1.729, lr=0.Training Epoch 3/5:   4%| | 1/28 [00:04<01:47,  3.98s/it, loss=0.6068, grad_norm=1.574, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:44,  1.71s/it, loss=0.6068, grad_norm=1.574, lr=0.Training Epoch 3/5:   7%| | 2/28 [00:04<00:44,  1.71s/it, loss=0.6097, grad_norm=1.740, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.6097, grad_norm=1.740, lr=0.Training Epoch 3/5:  11%|1| 3/28 [00:04<00:24,  1.02it/s, loss=0.5483, grad_norm=1.554, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.57it/s, loss=0.5483, grad_norm=1.554, lr=0.Training Epoch 3/5:  14%|1| 4/28 [00:04<00:15,  1.57it/s, loss=0.5546, grad_norm=1.435, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.23it/s, loss=0.5546, grad_norm=1.435, lr=0.Training Epoch 3/5:  18%|1| 5/28 [00:04<00:10,  2.23it/s, loss=0.5689, grad_norm=1.642, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.99it/s, loss=0.5689, grad_norm=1.642, lr=0.Training Epoch 3/5:  21%|2| 6/28 [00:04<00:07,  2.99it/s, loss=0.5698, grad_norm=2.034, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.83it/s, loss=0.5698, grad_norm=2.034, lr=0.Training Epoch 3/5:  25%|2| 7/28 [00:04<00:05,  3.83it/s, loss=0.6436, grad_norm=1.919, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:04<00:04,  4.67it/s, loss=0.6436, grad_norm=1.919, lr=0.Training Epoch 3/5:  29%|2| 8/28 [00:04<00:04,  4.67it/s, loss=0.5688, grad_norm=2.463, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:04<00:03,  5.47it/s, loss=0.5688, grad_norm=2.463, lr=0.Training Epoch 3/5:  32%|3| 9/28 [00:04<00:03,  5.47it/s, loss=0.5560, grad_norm=1.584, lr=0.Training Epoch 3/5:  36%|3| 10/28 [00:04<00:02,  6.21it/s, loss=0.5560, grad_norm=1.584, lr=0Training Epoch 3/5:  36%|3| 10/28 [00:05<00:02,  6.21it/s, loss=0.5544, grad_norm=2.188, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.83it/s, loss=0.5544, grad_norm=2.188, lr=0Training Epoch 3/5:  39%|3| 11/28 [00:05<00:02,  6.83it/s, loss=0.5555, grad_norm=2.900, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  7.38it/s, loss=0.5555, grad_norm=2.900, lr=0Training Epoch 3/5:  43%|4| 12/28 [00:05<00:02,  7.38it/s, loss=0.6367, grad_norm=2.500, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:01,  7.77it/s, loss=0.6367, grad_norm=2.500, lr=0Training Epoch 3/5:  46%|4| 13/28 [00:05<00:01,  7.77it/s, loss=0.6125, grad_norm=2.376, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  8.10it/s, loss=0.6125, grad_norm=2.376, lr=0Training Epoch 3/5:  50%|5| 14/28 [00:05<00:01,  8.10it/s, loss=0.5404, grad_norm=3.039, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  8.33it/s, loss=0.5404, grad_norm=3.039, lr=0Training Epoch 3/5:  54%|5| 15/28 [00:05<00:01,  8.33it/s, loss=0.5121, grad_norm=2.104, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  8.48it/s, loss=0.5121, grad_norm=2.104, lr=0Training Epoch 3/5:  57%|5| 16/28 [00:05<00:01,  8.48it/s, loss=0.4322, grad_norm=2.432, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:05<00:01,  8.51it/s, loss=0.4322, grad_norm=2.432, lr=0Training Epoch 3/5:  61%|6| 17/28 [00:05<00:01,  8.51it/s, loss=0.4630, grad_norm=2.023, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:05<00:01,  8.59it/s, loss=0.4630, grad_norm=2.023, lr=0Training Epoch 3/5:  64%|6| 18/28 [00:06<00:01,  8.59it/s, loss=0.4713, grad_norm=1.911, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:06<00:01,  8.39it/s, loss=0.4713, grad_norm=1.911, lr=0Training Epoch 3/5:  68%|6| 19/28 [00:06<00:01,  8.39it/s, loss=0.4473, grad_norm=2.857, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:00,  8.52it/s, loss=0.4473, grad_norm=2.857, lr=0Training Epoch 3/5:  71%|7| 20/28 [00:06<00:00,  8.52it/s, loss=0.5517, grad_norm=3.225, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.66it/s, loss=0.5517, grad_norm=3.225, lr=0Training Epoch 3/5:  75%|7| 21/28 [00:06<00:00,  8.66it/s, loss=0.4175, grad_norm=2.040, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.72it/s, loss=0.4175, grad_norm=2.040, lr=0Training Epoch 3/5:  79%|7| 22/28 [00:06<00:00,  8.72it/s, loss=0.3949, grad_norm=1.565, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  8.81it/s, loss=0.3949, grad_norm=1.565, lr=0Training Epoch 3/5:  82%|8| 23/28 [00:06<00:00,  8.81it/s, loss=0.3608, grad_norm=1.896, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  8.87it/s, loss=0.3608, grad_norm=1.896, lr=0Training Epoch 3/5:  86%|8| 24/28 [00:06<00:00,  8.87it/s, loss=0.4434, grad_norm=3.962, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:06<00:00,  8.81it/s, loss=0.4434, grad_norm=3.962, lr=0Training Epoch 3/5:  89%|8| 25/28 [00:06<00:00,  8.81it/s, loss=0.5147, grad_norm=5.068, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:06<00:00,  8.83it/s, loss=0.5147, grad_norm=5.068, lr=0Training Epoch 3/5:  93%|9| 26/28 [00:06<00:00,  8.83it/s, loss=0.3653, grad_norm=1.874, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:06<00:00,  8.85it/s, loss=0.3653, grad_norm=1.874, lr=0Training Epoch 3/5:  96%|9| 27/28 [00:06<00:00,  8.85it/s, loss=0.3052, grad_norm=2.015, lr=0Training Epoch 3/5: 100%|#| 28/28 [00:07<00:00,  3.71it/s, loss=0.3052, grad_norm=2.015, lr=0

Epoch 3/5 Complete (7.9s) [LR: 0.000010]
Train - Loss: 0.5154, Acc: 0.8664, Precision: 0.8533, Recall: 0.8848, F1: 0.8688, AUC: 0.9232
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/28 [00:03<?, ?it/s, loss=0.3635, grad_norm=3.175, lr=0.000010]Training Epoch 4/5:   4%| | 1/28 [00:03<01:47,  3.98s/it, loss=0.3635, grad_norm=3.175, lr=0.Training Epoch 4/5:   4%| | 1/28 [00:04<01:47,  3.98s/it, loss=0.3580, grad_norm=4.562, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:44,  1.72s/it, loss=0.3580, grad_norm=4.562, lr=0.Training Epoch 4/5:   7%| | 2/28 [00:04<00:44,  1.72s/it, loss=0.3839, grad_norm=2.330, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:24,  1.00it/s, loss=0.3839, grad_norm=2.330, lr=0.Training Epoch 4/5:  11%|1| 3/28 [00:04<00:24,  1.00it/s, loss=0.3056, grad_norm=3.051, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:15,  1.53it/s, loss=0.3056, grad_norm=3.051, lr=0.Training Epoch 4/5:  14%|1| 4/28 [00:04<00:15,  1.53it/s, loss=0.3232, grad_norm=3.466, lr=0.Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.14it/s, loss=0.3232, grad_norm=3.466, lr=0.Training Epoch 4/5:  18%|1| 5/28 [00:04<00:10,  2.14it/s, loss=0.2487, grad_norm=1.663, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  2.81it/s, loss=0.2487, grad_norm=1.663, lr=0.Training Epoch 4/5:  21%|2| 6/28 [00:04<00:07,  2.81it/s, loss=0.2521, grad_norm=2.075, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.52it/s, loss=0.2521, grad_norm=2.075, lr=0.Training Epoch 4/5:  25%|2| 7/28 [00:04<00:05,  3.52it/s, loss=0.3273, grad_norm=4.760, lr=0.Training Epoch 4/5:  29%|2| 8/28 [00:04<00:04,  4.22it/s, loss=0.3273, grad_norm=4.760, lr=0.Training Epoch 4/5:  29%|2| 8/28 [00:05<00:04,  4.22it/s, loss=0.2524, grad_norm=4.247, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:05<00:03,  4.81it/s, loss=0.2524, grad_norm=4.247, lr=0.Training Epoch 4/5:  32%|3| 9/28 [00:05<00:03,  4.81it/s, loss=0.2073, grad_norm=2.213, lr=0.Training Epoch 4/5:  36%|3| 10/28 [00:05<00:03,  5.28it/s, loss=0.2073, grad_norm=2.213, lr=0Training Epoch 4/5:  36%|3| 10/28 [00:05<00:03,  5.28it/s, loss=0.4307, grad_norm=13.549, lr=Training Epoch 4/5:  39%|3| 11/28 [00:05<00:02,  5.77it/s, loss=0.4307, grad_norm=13.549, lr=Training Epoch 4/5:  39%|3| 11/28 [00:05<00:02,  5.77it/s, loss=0.3152, grad_norm=7.001, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  6.14it/s, loss=0.3152, grad_norm=7.001, lr=0Training Epoch 4/5:  43%|4| 12/28 [00:05<00:02,  6.14it/s, loss=0.4454, grad_norm=5.990, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:02,  6.40it/s, loss=0.4454, grad_norm=5.990, lr=0Training Epoch 4/5:  46%|4| 13/28 [00:05<00:02,  6.40it/s, loss=0.2441, grad_norm=2.883, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:02,  6.61it/s, loss=0.2441, grad_norm=2.883, lr=0Training Epoch 4/5:  50%|5| 14/28 [00:05<00:02,  6.61it/s, loss=0.1605, grad_norm=1.430, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:05<00:01,  6.83it/s, loss=0.1605, grad_norm=1.430, lr=0Training Epoch 4/5:  54%|5| 15/28 [00:06<00:01,  6.83it/s, loss=0.2436, grad_norm=8.070, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:06<00:01,  7.00it/s, loss=0.2436, grad_norm=8.070, lr=0Training Epoch 4/5:  57%|5| 16/28 [00:06<00:01,  7.00it/s, loss=0.5533, grad_norm=13.841, lr=Training Epoch 4/5:  61%|6| 17/28 [00:06<00:01,  7.13it/s, loss=0.5533, grad_norm=13.841, lr=Training Epoch 4/5:  61%|6| 17/28 [00:06<00:01,  7.13it/s, loss=0.2802, grad_norm=11.654, lr=Training Epoch 4/5:  64%|6| 18/28 [00:06<00:01,  7.17it/s, loss=0.2802, grad_norm=11.654, lr=Training Epoch 4/5:  64%|6| 18/28 [00:06<00:01,  7.17it/s, loss=0.2280, grad_norm=4.901, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:06<00:01,  7.13it/s, loss=0.2280, grad_norm=4.901, lr=0Training Epoch 4/5:  68%|6| 19/28 [00:06<00:01,  7.13it/s, loss=0.2252, grad_norm=4.018, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:06<00:01,  7.15it/s, loss=0.2252, grad_norm=4.018, lr=0Training Epoch 4/5:  71%|7| 20/28 [00:06<00:01,  7.15it/s, loss=0.1258, grad_norm=1.520, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  7.13it/s, loss=0.1258, grad_norm=1.520, lr=0Training Epoch 4/5:  75%|7| 21/28 [00:06<00:00,  7.13it/s, loss=0.3521, grad_norm=13.203, lr=Training Epoch 4/5:  79%|7| 22/28 [00:06<00:00,  7.05it/s, loss=0.3521, grad_norm=13.203, lr=Training Epoch 4/5:  79%|7| 22/28 [00:07<00:00,  7.05it/s, loss=0.2467, grad_norm=8.114, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:07<00:00,  7.15it/s, loss=0.2467, grad_norm=8.114, lr=0Training Epoch 4/5:  82%|8| 23/28 [00:07<00:00,  7.15it/s, loss=0.1566, grad_norm=2.317, lr=0Training Epoch 4/5:  86%|8| 24/28 [00:07<00:00,  7.22it/s, loss=0.1566, grad_norm=2.317, lr=0Training Epoch 4/5:  86%|8| 24/28 [00:07<00:00,  7.22it/s, loss=0.2312, grad_norm=3.953, lr=0Training Epoch 4/5:  89%|8| 25/28 [00:07<00:00,  7.25it/s, loss=0.2312, grad_norm=3.953, lr=0Training Epoch 4/5:  89%|8| 25/28 [00:07<00:00,  7.25it/s, loss=0.2367, grad_norm=7.724, lr=0Training Epoch 4/5:  93%|9| 26/28 [00:07<00:00,  7.37it/s, loss=0.2367, grad_norm=7.724, lr=0Training Epoch 4/5:  93%|9| 26/28 [00:07<00:00,  7.37it/s, loss=0.0929, grad_norm=1.744, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:07<00:00,  7.40it/s, loss=0.0929, grad_norm=1.744, lr=0Training Epoch 4/5:  96%|9| 27/28 [00:07<00:00,  7.40it/s, loss=0.7826, grad_norm=52.549, lr=Training Epoch 4/5: 100%|#| 28/28 [00:08<00:00,  3.41it/s, loss=0.7826, grad_norm=52.549, lr=

Epoch 4/5 Complete (8.6s) [LR: 0.000010]
Train - Loss: 0.2990, Acc: 0.9194, Precision: 0.9027, Recall: 0.9401, F1: 0.9210, AUC: 0.9715
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/28 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/28 [00:04<?, ?it/s, loss=0.1366, grad_norm=2.383, lr=0.000010]Training Epoch 5/5:   4%| | 1/28 [00:04<01:53,  4.22s/it, loss=0.1366, grad_norm=2.383, lr=0.Training Epoch 5/5:   4%| | 1/28 [00:04<01:53,  4.22s/it, loss=0.2400, grad_norm=10.039, lr=0Training Epoch 5/5:   7%| | 2/28 [00:04<00:47,  1.82s/it, loss=0.2400, grad_norm=10.039, lr=0Training Epoch 5/5:   7%| | 2/28 [00:04<00:47,  1.82s/it, loss=0.2983, grad_norm=15.405, lr=0Training Epoch 5/5:  11%|1| 3/28 [00:04<00:26,  1.05s/it, loss=0.2983, grad_norm=15.405, lr=0Training Epoch 5/5:  11%|1| 3/28 [00:04<00:26,  1.05s/it, loss=0.4173, grad_norm=21.104, lr=0Training Epoch 5/5:  14%|1| 4/28 [00:04<00:16,  1.45it/s, loss=0.4173, grad_norm=21.104, lr=0Training Epoch 5/5:  14%|1| 4/28 [00:04<00:16,  1.45it/s, loss=0.4678, grad_norm=41.932, lr=0Training Epoch 5/5:  18%|1| 5/28 [00:04<00:11,  2.04it/s, loss=0.4678, grad_norm=41.932, lr=0Training Epoch 5/5:  18%|1| 5/28 [00:04<00:11,  2.04it/s, loss=0.1969, grad_norm=11.131, lr=0Training Epoch 5/5:  21%|2| 6/28 [00:04<00:08,  2.71it/s, loss=0.1969, grad_norm=11.131, lr=0Training Epoch 5/5:  21%|2| 6/28 [00:05<00:08,  2.71it/s, loss=0.1358, grad_norm=4.558, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:05<00:06,  3.42it/s, loss=0.1358, grad_norm=4.558, lr=0.Training Epoch 5/5:  25%|2| 7/28 [00:05<00:06,  3.42it/s, loss=0.3789, grad_norm=13.648, lr=0Training Epoch 5/5:  29%|2| 8/28 [00:05<00:04,  4.10it/s, loss=0.3789, grad_norm=13.648, lr=0Training Epoch 5/5:  29%|2| 8/28 [00:05<00:04,  4.10it/s, loss=0.0956, grad_norm=5.214, lr=0.Training Epoch 5/5:  32%|3| 9/28 [00:05<00:03,  4.78it/s, loss=0.0956, grad_norm=5.214, lr=0.Training Epoch 5/5:  32%|3| 9/28 [00:05<00:03,  4.78it/s, loss=0.2162, grad_norm=17.175, lr=0Training Epoch 5/5:  36%|3| 10/28 [00:05<00:03,  5.35it/s, loss=0.2162, grad_norm=17.175, lr=Training Epoch 5/5:  36%|3| 10/28 [00:05<00:03,  5.35it/s, loss=0.2951, grad_norm=15.002, lr=Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  5.86it/s, loss=0.2951, grad_norm=15.002, lr=Training Epoch 5/5:  39%|3| 11/28 [00:05<00:02,  5.86it/s, loss=0.2201, grad_norm=8.568, lr=0Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  6.29it/s, loss=0.2201, grad_norm=8.568, lr=0Training Epoch 5/5:  43%|4| 12/28 [00:05<00:02,  6.29it/s, loss=0.0859, grad_norm=4.324, lr=0Training Epoch 5/5:  46%|4| 13/28 [00:05<00:02,  6.61it/s, loss=0.0859, grad_norm=4.324, lr=0Training Epoch 5/5:  46%|4| 13/28 [00:05<00:02,  6.61it/s, loss=0.1633, grad_norm=11.861, lr=Training Epoch 5/5:  50%|5| 14/28 [00:05<00:02,  6.83it/s, loss=0.1633, grad_norm=11.861, lr=Training Epoch 5/5:  50%|5| 14/28 [00:06<00:02,  6.83it/s, loss=0.2691, grad_norm=17.495, lr=Training Epoch 5/5:  54%|5| 15/28 [00:06<00:01,  6.99it/s, loss=0.2691, grad_norm=17.495, lr=Training Epoch 5/5:  54%|5| 15/28 [00:06<00:01,  6.99it/s, loss=0.0880, grad_norm=2.827, lr=0Training Epoch 5/5:  57%|5| 16/28 [00:06<00:01,  7.06it/s, loss=0.0880, grad_norm=2.827, lr=0Training Epoch 5/5:  57%|5| 16/28 [00:06<00:01,  7.06it/s, loss=0.3366, grad_norm=15.168, lr=Training Epoch 5/5:  61%|6| 17/28 [00:06<00:01,  7.17it/s, loss=0.3366, grad_norm=15.168, lr=Training Epoch 5/5:  61%|6| 17/28 [00:06<00:01,  7.17it/s, loss=0.3829, grad_norm=21.143, lr=Training Epoch 5/5:  64%|6| 18/28 [00:06<00:01,  7.25it/s, loss=0.3829, grad_norm=21.143, lr=Training Epoch 5/5:  64%|6| 18/28 [00:06<00:01,  7.25it/s, loss=0.2169, grad_norm=6.682, lr=0Training Epoch 5/5:  68%|6| 19/28 [00:06<00:01,  7.29it/s, loss=0.2169, grad_norm=6.682, lr=0Training Epoch 5/5:  68%|6| 19/28 [00:06<00:01,  7.29it/s, loss=0.1493, grad_norm=4.465, lr=0Training Epoch 5/5:  71%|7| 20/28 [00:06<00:01,  7.39it/s, loss=0.1493, grad_norm=4.465, lr=0Training Epoch 5/5:  71%|7| 20/28 [00:06<00:01,  7.39it/s, loss=0.2656, grad_norm=6.979, lr=0Training Epoch 5/5:  75%|7| 21/28 [00:06<00:00,  7.37it/s, loss=0.2656, grad_norm=6.979, lr=0Training Epoch 5/5:  75%|7| 21/28 [00:07<00:00,  7.37it/s, loss=0.1716, grad_norm=6.560, lr=0Training Epoch 5/5:  79%|7| 22/28 [00:07<00:00,  7.41it/s, loss=0.1716, grad_norm=6.560, lr=0Training Epoch 5/5:  79%|7| 22/28 [00:07<00:00,  7.41it/s, loss=0.5994, grad_norm=21.819, lr=Training Epoch 5/5:  82%|8| 23/28 [00:07<00:00,  7.38it/s, loss=0.5994, grad_norm=21.819, lr=Training Epoch 5/5:  82%|8| 23/28 [00:07<00:00,  7.38it/s, loss=0.5836, grad_norm=22.918, lr=Training Epoch 5/5:  86%|8| 24/28 [00:07<00:00,  7.41it/s, loss=0.5836, grad_norm=22.918, lr=Training Epoch 5/5:  86%|8| 24/28 [00:07<00:00,  7.41it/s, loss=0.2292, grad_norm=11.354, lr=Training Epoch 5/5:  89%|8| 25/28 [00:07<00:00,  7.41it/s, loss=0.2292, grad_norm=11.354, lr=Training Epoch 5/5:  89%|8| 25/28 [00:07<00:00,  7.41it/s, loss=0.2697, grad_norm=12.429, lr=Training Epoch 5/5:  93%|9| 26/28 [00:07<00:00,  7.46it/s, loss=0.2697, grad_norm=12.429, lr=Training Epoch 5/5:  93%|9| 26/28 [00:07<00:00,  7.46it/s, loss=0.1987, grad_norm=9.667, lr=0Training Epoch 5/5:  96%|9| 27/28 [00:07<00:00,  7.47it/s, loss=0.1987, grad_norm=9.667, lr=0Training Epoch 5/5:  96%|9| 27/28 [00:07<00:00,  7.47it/s, loss=0.0231, grad_norm=0.600, lr=0Training Epoch 5/5: 100%|#| 28/28 [00:08<00:00,  3.33it/s, loss=0.0231, grad_norm=0.600, lr=0

Epoch 5/5 Complete (8.8s) [LR: 0.000005]
Train - Loss: 0.2547, Acc: 0.8802, Precision: 0.9146, Recall: 0.8387, F1: 0.8750, AUC: 0.9653
------------------------------------------------------------
Training curves saved to model\chb13_fold10\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold10
============================================================
✅ Fold 10 training completed successfully!

============================================================
TRAINING FOLD 11/11
============================================================
Using dataset prefix: chb13_fold11
Loading datasets from: preprocessing\data\chb13_fold11
Saving models to: model\chb13_fold11
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.4379, std=2.4566
Loaded train dataset: 424 samples
  - Spectrogram shape: torch.Size([424, 30, 18, 50, 10])
  - Value range: [-5.0630, 3.5007]
  - Class distribution: tensor([212, 212])
LOOCV Mode (Fold 11): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/11 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 1/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6795, grad_norm=1.322, lr=0.000010]Training Epoch 1/5:   4%| | 1/27 [00:04<01:50,  4.26s/it, loss=0.6795, grad_norm=1.322, lr=0.Training Epoch 1/5:   4%| | 1/27 [00:04<01:50,  4.26s/it, loss=0.6776, grad_norm=1.272, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:45,  1.83s/it, loss=0.6776, grad_norm=1.272, lr=0.Training Epoch 1/5:   7%| | 2/27 [00:04<00:45,  1.83s/it, loss=0.7056, grad_norm=1.379, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:25,  1.04s/it, loss=0.7056, grad_norm=1.379, lr=0.Training Epoch 1/5:  11%|1| 3/27 [00:04<00:25,  1.04s/it, loss=0.7025, grad_norm=1.350, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.48it/s, loss=0.7025, grad_norm=1.350, lr=0.Training Epoch 1/5:  15%|1| 4/27 [00:04<00:15,  1.48it/s, loss=0.7029, grad_norm=1.303, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.10it/s, loss=0.7029, grad_norm=1.303, lr=0.Training Epoch 1/5:  19%|1| 5/27 [00:04<00:10,  2.10it/s, loss=0.6846, grad_norm=1.217, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.82it/s, loss=0.6846, grad_norm=1.217, lr=0.Training Epoch 1/5:  22%|2| 6/27 [00:04<00:07,  2.82it/s, loss=0.6943, grad_norm=1.274, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:04<00:05,  3.61it/s, loss=0.6943, grad_norm=1.274, lr=0.Training Epoch 1/5:  26%|2| 7/27 [00:05<00:05,  3.61it/s, loss=0.7020, grad_norm=1.246, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:05<00:04,  4.40it/s, loss=0.7020, grad_norm=1.246, lr=0.Training Epoch 1/5:  30%|2| 8/27 [00:05<00:04,  4.40it/s, loss=0.6894, grad_norm=1.167, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  5.21it/s, loss=0.6894, grad_norm=1.167, lr=0.Training Epoch 1/5:  33%|3| 9/27 [00:05<00:03,  5.21it/s, loss=0.6780, grad_norm=1.191, lr=0.Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.01it/s, loss=0.6780, grad_norm=1.191, lr=0Training Epoch 1/5:  37%|3| 10/27 [00:05<00:02,  6.01it/s, loss=0.6793, grad_norm=1.324, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.62it/s, loss=0.6793, grad_norm=1.324, lr=0Training Epoch 1/5:  41%|4| 11/27 [00:05<00:02,  6.62it/s, loss=0.6882, grad_norm=1.142, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.18it/s, loss=0.6882, grad_norm=1.142, lr=0Training Epoch 1/5:  44%|4| 12/27 [00:05<00:02,  7.18it/s, loss=0.6952, grad_norm=1.327, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.62it/s, loss=0.6952, grad_norm=1.327, lr=0Training Epoch 1/5:  48%|4| 13/27 [00:05<00:01,  7.62it/s, loss=0.6812, grad_norm=1.382, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  7.94it/s, loss=0.6812, grad_norm=1.382, lr=0Training Epoch 1/5:  52%|5| 14/27 [00:05<00:01,  7.94it/s, loss=0.6877, grad_norm=1.354, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.11it/s, loss=0.6877, grad_norm=1.354, lr=0Training Epoch 1/5:  56%|5| 15/27 [00:05<00:01,  8.11it/s, loss=0.6773, grad_norm=1.201, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:05<00:01,  8.28it/s, loss=0.6773, grad_norm=1.201, lr=0Training Epoch 1/5:  59%|5| 16/27 [00:06<00:01,  8.28it/s, loss=0.6951, grad_norm=1.340, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:06<00:01,  8.24it/s, loss=0.6951, grad_norm=1.340, lr=0Training Epoch 1/5:  63%|6| 17/27 [00:06<00:01,  8.24it/s, loss=0.7148, grad_norm=1.587, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  8.37it/s, loss=0.7148, grad_norm=1.587, lr=0Training Epoch 1/5:  67%|6| 18/27 [00:06<00:01,  8.37it/s, loss=0.6730, grad_norm=1.285, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  8.45it/s, loss=0.6730, grad_norm=1.285, lr=0Training Epoch 1/5:  70%|7| 19/27 [00:06<00:00,  8.45it/s, loss=0.6806, grad_norm=1.253, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  8.54it/s, loss=0.6806, grad_norm=1.253, lr=0Training Epoch 1/5:  74%|7| 20/27 [00:06<00:00,  8.54it/s, loss=0.6950, grad_norm=1.381, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  8.53it/s, loss=0.6950, grad_norm=1.381, lr=0Training Epoch 1/5:  78%|7| 21/27 [00:06<00:00,  8.53it/s, loss=0.6889, grad_norm=1.261, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  8.61it/s, loss=0.6889, grad_norm=1.261, lr=0Training Epoch 1/5:  81%|8| 22/27 [00:06<00:00,  8.61it/s, loss=0.6739, grad_norm=1.109, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  8.53it/s, loss=0.6739, grad_norm=1.109, lr=0Training Epoch 1/5:  85%|8| 23/27 [00:06<00:00,  8.53it/s, loss=0.6818, grad_norm=1.182, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:06<00:00,  8.57it/s, loss=0.6818, grad_norm=1.182, lr=0Training Epoch 1/5:  89%|8| 24/27 [00:07<00:00,  8.57it/s, loss=0.6930, grad_norm=1.337, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:07<00:00,  8.63it/s, loss=0.6930, grad_norm=1.337, lr=0Training Epoch 1/5:  93%|9| 25/27 [00:07<00:00,  8.63it/s, loss=0.6898, grad_norm=1.274, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:07<00:00,  8.62it/s, loss=0.6898, grad_norm=1.274, lr=0Training Epoch 1/5:  96%|9| 26/27 [00:07<00:00,  8.62it/s, loss=0.6787, grad_norm=1.746, lr=0Training Epoch 1/5: 100%|#| 27/27 [00:07<00:00,  3.43it/s, loss=0.6787, grad_norm=1.746, lr=0

Epoch 1/5 Complete (8.3s) [LR: 0.000010]
Train - Loss: 0.6885, Acc: 0.5613, Precision: 0.5394, Recall: 0.8396, F1: 0.6568, AUC: 0.5930
------------------------------------------------------------
Training Epoch 2/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 2/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.6838, grad_norm=1.409, lr=0.000010]Training Epoch 2/5:   4%| | 1/27 [00:04<01:52,  4.32s/it, loss=0.6838, grad_norm=1.409, lr=0.Training Epoch 2/5:   4%| | 1/27 [00:04<01:52,  4.32s/it, loss=0.6732, grad_norm=1.259, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:46,  1.87s/it, loss=0.6732, grad_norm=1.259, lr=0.Training Epoch 2/5:   7%| | 2/27 [00:04<00:46,  1.87s/it, loss=0.6714, grad_norm=1.306, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:25,  1.08s/it, loss=0.6714, grad_norm=1.306, lr=0.Training Epoch 2/5:  11%|1| 3/27 [00:04<00:25,  1.08s/it, loss=0.6888, grad_norm=1.204, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:16,  1.41it/s, loss=0.6888, grad_norm=1.204, lr=0.Training Epoch 2/5:  15%|1| 4/27 [00:04<00:16,  1.41it/s, loss=0.6621, grad_norm=1.293, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:04<00:11,  1.98it/s, loss=0.6621, grad_norm=1.293, lr=0.Training Epoch 2/5:  19%|1| 5/27 [00:05<00:11,  1.98it/s, loss=0.6846, grad_norm=1.169, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:05<00:08,  2.61it/s, loss=0.6846, grad_norm=1.169, lr=0.Training Epoch 2/5:  22%|2| 6/27 [00:05<00:08,  2.61it/s, loss=0.6790, grad_norm=1.388, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:05<00:06,  3.28it/s, loss=0.6790, grad_norm=1.388, lr=0.Training Epoch 2/5:  26%|2| 7/27 [00:05<00:06,  3.28it/s, loss=0.6655, grad_norm=1.397, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:05<00:04,  4.03it/s, loss=0.6655, grad_norm=1.397, lr=0.Training Epoch 2/5:  30%|2| 8/27 [00:05<00:04,  4.03it/s, loss=0.6729, grad_norm=1.522, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  4.73it/s, loss=0.6729, grad_norm=1.522, lr=0.Training Epoch 2/5:  33%|3| 9/27 [00:05<00:03,  4.73it/s, loss=0.6671, grad_norm=1.420, lr=0.Training Epoch 2/5:  37%|3| 10/27 [00:05<00:03,  5.31it/s, loss=0.6671, grad_norm=1.420, lr=0Training Epoch 2/5:  37%|3| 10/27 [00:05<00:03,  5.31it/s, loss=0.6672, grad_norm=1.495, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  5.79it/s, loss=0.6672, grad_norm=1.495, lr=0Training Epoch 2/5:  41%|4| 11/27 [00:05<00:02,  5.79it/s, loss=0.6735, grad_norm=1.370, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  6.19it/s, loss=0.6735, grad_norm=1.370, lr=0Training Epoch 2/5:  44%|4| 12/27 [00:05<00:02,  6.19it/s, loss=0.6675, grad_norm=1.618, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:05<00:02,  6.53it/s, loss=0.6675, grad_norm=1.618, lr=0Training Epoch 2/5:  48%|4| 13/27 [00:06<00:02,  6.53it/s, loss=0.6479, grad_norm=1.696, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:06<00:01,  6.76it/s, loss=0.6479, grad_norm=1.696, lr=0Training Epoch 2/5:  52%|5| 14/27 [00:06<00:01,  6.76it/s, loss=0.6507, grad_norm=1.623, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:06<00:01,  6.98it/s, loss=0.6507, grad_norm=1.623, lr=0Training Epoch 2/5:  56%|5| 15/27 [00:06<00:01,  6.98it/s, loss=0.6550, grad_norm=1.432, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:06<00:01,  7.14it/s, loss=0.6550, grad_norm=1.432, lr=0Training Epoch 2/5:  59%|5| 16/27 [00:06<00:01,  7.14it/s, loss=0.6607, grad_norm=1.679, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:06<00:01,  7.19it/s, loss=0.6607, grad_norm=1.679, lr=0Training Epoch 2/5:  63%|6| 17/27 [00:06<00:01,  7.19it/s, loss=0.6456, grad_norm=1.595, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  7.33it/s, loss=0.6456, grad_norm=1.595, lr=0Training Epoch 2/5:  67%|6| 18/27 [00:06<00:01,  7.33it/s, loss=0.6421, grad_norm=1.670, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:01,  7.36it/s, loss=0.6421, grad_norm=1.670, lr=0Training Epoch 2/5:  70%|7| 19/27 [00:06<00:01,  7.36it/s, loss=0.6558, grad_norm=1.655, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:06<00:00,  7.53it/s, loss=0.6558, grad_norm=1.655, lr=0Training Epoch 2/5:  74%|7| 20/27 [00:07<00:00,  7.53it/s, loss=0.6541, grad_norm=1.955, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:07<00:00,  7.89it/s, loss=0.6541, grad_norm=1.955, lr=0Training Epoch 2/5:  78%|7| 21/27 [00:07<00:00,  7.89it/s, loss=0.6202, grad_norm=1.557, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:07<00:00,  7.88it/s, loss=0.6202, grad_norm=1.557, lr=0Training Epoch 2/5:  81%|8| 22/27 [00:07<00:00,  7.88it/s, loss=0.5841, grad_norm=1.631, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:07<00:00,  8.01it/s, loss=0.5841, grad_norm=1.631, lr=0Training Epoch 2/5:  85%|8| 23/27 [00:07<00:00,  8.01it/s, loss=0.6418, grad_norm=1.914, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:07<00:00,  8.21it/s, loss=0.6418, grad_norm=1.914, lr=0Training Epoch 2/5:  89%|8| 24/27 [00:07<00:00,  8.21it/s, loss=0.6402, grad_norm=1.947, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:07<00:00,  8.37it/s, loss=0.6402, grad_norm=1.947, lr=0Training Epoch 2/5:  93%|9| 25/27 [00:07<00:00,  8.37it/s, loss=0.5709, grad_norm=1.772, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:07<00:00,  8.37it/s, loss=0.5709, grad_norm=1.772, lr=0Training Epoch 2/5:  96%|9| 26/27 [00:07<00:00,  8.37it/s, loss=0.6810, grad_norm=3.585, lr=0Training Epoch 2/5: 100%|#| 27/27 [00:08<00:00,  3.21it/s, loss=0.6810, grad_norm=3.585, lr=0

Epoch 2/5 Complete (8.8s) [LR: 0.000010]
Train - Loss: 0.6558, Acc: 0.7241, Precision: 0.7189, Recall: 0.7358, F1: 0.7273, AUC: 0.8115
------------------------------------------------------------
Training Epoch 3/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 3/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.5826, grad_norm=1.711, lr=0.000010]Training Epoch 3/5:   4%| | 1/27 [00:04<01:46,  4.08s/it, loss=0.5826, grad_norm=1.711, lr=0.Training Epoch 3/5:   4%| | 1/27 [00:04<01:46,  4.08s/it, loss=0.5502, grad_norm=1.846, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:44,  1.76s/it, loss=0.5502, grad_norm=1.846, lr=0.Training Epoch 3/5:   7%| | 2/27 [00:04<00:44,  1.76s/it, loss=0.5427, grad_norm=1.721, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.5427, grad_norm=1.721, lr=0.Training Epoch 3/5:  11%|1| 3/27 [00:04<00:24,  1.01s/it, loss=0.4899, grad_norm=1.739, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.51it/s, loss=0.4899, grad_norm=1.739, lr=0.Training Epoch 3/5:  15%|1| 4/27 [00:04<00:15,  1.51it/s, loss=0.5581, grad_norm=1.958, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.11it/s, loss=0.5581, grad_norm=1.958, lr=0.Training Epoch 3/5:  19%|1| 5/27 [00:04<00:10,  2.11it/s, loss=0.5480, grad_norm=2.102, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.77it/s, loss=0.5480, grad_norm=2.102, lr=0.Training Epoch 3/5:  22%|2| 6/27 [00:04<00:07,  2.77it/s, loss=0.5199, grad_norm=1.818, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:04<00:05,  3.47it/s, loss=0.5199, grad_norm=1.818, lr=0.Training Epoch 3/5:  26%|2| 7/27 [00:05<00:05,  3.47it/s, loss=0.5499, grad_norm=1.989, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:05<00:04,  4.16it/s, loss=0.5499, grad_norm=1.989, lr=0.Training Epoch 3/5:  30%|2| 8/27 [00:05<00:04,  4.16it/s, loss=0.5398, grad_norm=3.077, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  4.85it/s, loss=0.5398, grad_norm=3.077, lr=0.Training Epoch 3/5:  33%|3| 9/27 [00:05<00:03,  4.85it/s, loss=0.5302, grad_norm=2.173, lr=0.Training Epoch 3/5:  37%|3| 10/27 [00:05<00:03,  5.53it/s, loss=0.5302, grad_norm=2.173, lr=0Training Epoch 3/5:  37%|3| 10/27 [00:05<00:03,  5.53it/s, loss=0.4848, grad_norm=2.173, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  5.99it/s, loss=0.4848, grad_norm=2.173, lr=0Training Epoch 3/5:  41%|4| 11/27 [00:05<00:02,  5.99it/s, loss=0.4201, grad_norm=2.848, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  6.39it/s, loss=0.4201, grad_norm=2.848, lr=0Training Epoch 3/5:  44%|4| 12/27 [00:05<00:02,  6.39it/s, loss=0.6070, grad_norm=5.960, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:02,  6.58it/s, loss=0.6070, grad_norm=5.960, lr=0Training Epoch 3/5:  48%|4| 13/27 [00:05<00:02,  6.58it/s, loss=0.4462, grad_norm=2.420, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  6.89it/s, loss=0.4462, grad_norm=2.420, lr=0Training Epoch 3/5:  52%|5| 14/27 [00:05<00:01,  6.89it/s, loss=0.4422, grad_norm=2.660, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:05<00:01,  7.07it/s, loss=0.4422, grad_norm=2.660, lr=0Training Epoch 3/5:  56%|5| 15/27 [00:06<00:01,  7.07it/s, loss=0.4249, grad_norm=2.659, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:06<00:01,  7.26it/s, loss=0.4249, grad_norm=2.659, lr=0Training Epoch 3/5:  59%|5| 16/27 [00:06<00:01,  7.26it/s, loss=0.4167, grad_norm=2.126, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:06<00:01,  7.32it/s, loss=0.4167, grad_norm=2.126, lr=0Training Epoch 3/5:  63%|6| 17/27 [00:06<00:01,  7.32it/s, loss=0.3875, grad_norm=2.523, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  7.35it/s, loss=0.3875, grad_norm=2.523, lr=0Training Epoch 3/5:  67%|6| 18/27 [00:06<00:01,  7.35it/s, loss=0.3960, grad_norm=1.696, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:01,  7.50it/s, loss=0.3960, grad_norm=1.696, lr=0Training Epoch 3/5:  70%|7| 19/27 [00:06<00:01,  7.50it/s, loss=0.5457, grad_norm=4.822, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  7.59it/s, loss=0.5457, grad_norm=4.822, lr=0Training Epoch 3/5:  74%|7| 20/27 [00:06<00:00,  7.59it/s, loss=0.4334, grad_norm=4.143, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  7.59it/s, loss=0.4334, grad_norm=4.143, lr=0Training Epoch 3/5:  78%|7| 21/27 [00:06<00:00,  7.59it/s, loss=0.4190, grad_norm=2.927, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:06<00:00,  7.54it/s, loss=0.4190, grad_norm=2.927, lr=0Training Epoch 3/5:  81%|8| 22/27 [00:07<00:00,  7.54it/s, loss=0.3553, grad_norm=4.283, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:07<00:00,  7.57it/s, loss=0.3553, grad_norm=4.283, lr=0Training Epoch 3/5:  85%|8| 23/27 [00:07<00:00,  7.57it/s, loss=0.3125, grad_norm=2.609, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:07<00:00,  7.47it/s, loss=0.3125, grad_norm=2.609, lr=0Training Epoch 3/5:  89%|8| 24/27 [00:07<00:00,  7.47it/s, loss=0.4996, grad_norm=3.745, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:07<00:00,  7.50it/s, loss=0.4996, grad_norm=3.745, lr=0Training Epoch 3/5:  93%|9| 25/27 [00:07<00:00,  7.50it/s, loss=0.3648, grad_norm=2.736, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:07<00:00,  7.45it/s, loss=0.3648, grad_norm=2.736, lr=0Training Epoch 3/5:  96%|9| 26/27 [00:07<00:00,  7.45it/s, loss=0.4105, grad_norm=12.318, lr=Training Epoch 3/5: 100%|#| 27/27 [00:08<00:00,  3.31it/s, loss=0.4105, grad_norm=12.318, lr=

Epoch 3/5 Complete (8.6s) [LR: 0.000010]
Train - Loss: 0.4732, Acc: 0.8915, Precision: 0.8739, Recall: 0.9151, F1: 0.8940, AUC: 0.9548
------------------------------------------------------------
Training Epoch 4/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 4/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.3049, grad_norm=5.808, lr=0.000010]Training Epoch 4/5:   4%| | 1/27 [00:04<01:47,  4.12s/it, loss=0.3049, grad_norm=5.808, lr=0.Training Epoch 4/5:   4%| | 1/27 [00:04<01:47,  4.12s/it, loss=0.2730, grad_norm=2.218, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.2730, grad_norm=2.218, lr=0.Training Epoch 4/5:   7%| | 2/27 [00:04<00:44,  1.78s/it, loss=0.3758, grad_norm=6.261, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:24,  1.03s/it, loss=0.3758, grad_norm=6.261, lr=0.Training Epoch 4/5:  11%|1| 3/27 [00:04<00:24,  1.03s/it, loss=0.5003, grad_norm=14.939, lr=0Training Epoch 4/5:  15%|1| 4/27 [00:04<00:15,  1.49it/s, loss=0.5003, grad_norm=14.939, lr=0Training Epoch 4/5:  15%|1| 4/27 [00:04<00:15,  1.49it/s, loss=0.2453, grad_norm=3.773, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.10it/s, loss=0.2453, grad_norm=3.773, lr=0.Training Epoch 4/5:  19%|1| 5/27 [00:04<00:10,  2.10it/s, loss=0.2502, grad_norm=3.523, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.80it/s, loss=0.2502, grad_norm=3.523, lr=0.Training Epoch 4/5:  22%|2| 6/27 [00:04<00:07,  2.80it/s, loss=0.4584, grad_norm=17.321, lr=0Training Epoch 4/5:  26%|2| 7/27 [00:04<00:05,  3.56it/s, loss=0.4584, grad_norm=17.321, lr=0Training Epoch 4/5:  26%|2| 7/27 [00:05<00:05,  3.56it/s, loss=0.2611, grad_norm=3.868, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:05<00:04,  4.32it/s, loss=0.2611, grad_norm=3.868, lr=0.Training Epoch 4/5:  30%|2| 8/27 [00:05<00:04,  4.32it/s, loss=0.3992, grad_norm=9.303, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:05<00:03,  4.93it/s, loss=0.3992, grad_norm=9.303, lr=0.Training Epoch 4/5:  33%|3| 9/27 [00:05<00:03,  4.93it/s, loss=0.3410, grad_norm=9.457, lr=0.Training Epoch 4/5:  37%|3| 10/27 [00:05<00:03,  5.48it/s, loss=0.3410, grad_norm=9.457, lr=0Training Epoch 4/5:  37%|3| 10/27 [00:05<00:03,  5.48it/s, loss=0.3718, grad_norm=9.670, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  5.91it/s, loss=0.3718, grad_norm=9.670, lr=0Training Epoch 4/5:  41%|4| 11/27 [00:05<00:02,  5.91it/s, loss=0.3209, grad_norm=9.880, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  6.34it/s, loss=0.3209, grad_norm=9.880, lr=0Training Epoch 4/5:  44%|4| 12/27 [00:05<00:02,  6.34it/s, loss=0.1924, grad_norm=5.533, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:02,  6.65it/s, loss=0.1924, grad_norm=5.533, lr=0Training Epoch 4/5:  48%|4| 13/27 [00:05<00:02,  6.65it/s, loss=0.1523, grad_norm=2.169, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  6.86it/s, loss=0.1523, grad_norm=2.169, lr=0Training Epoch 4/5:  52%|5| 14/27 [00:05<00:01,  6.86it/s, loss=0.2529, grad_norm=6.088, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:05<00:01,  6.99it/s, loss=0.2529, grad_norm=6.088, lr=0Training Epoch 4/5:  56%|5| 15/27 [00:06<00:01,  6.99it/s, loss=0.1468, grad_norm=3.312, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:06<00:01,  7.08it/s, loss=0.1468, grad_norm=3.312, lr=0Training Epoch 4/5:  59%|5| 16/27 [00:06<00:01,  7.08it/s, loss=0.4372, grad_norm=14.879, lr=Training Epoch 4/5:  63%|6| 17/27 [00:06<00:01,  7.17it/s, loss=0.4372, grad_norm=14.879, lr=Training Epoch 4/5:  63%|6| 17/27 [00:06<00:01,  7.17it/s, loss=0.1415, grad_norm=1.757, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  7.24it/s, loss=0.1415, grad_norm=1.757, lr=0Training Epoch 4/5:  67%|6| 18/27 [00:06<00:01,  7.24it/s, loss=0.3290, grad_norm=5.317, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:01,  7.31it/s, loss=0.3290, grad_norm=5.317, lr=0Training Epoch 4/5:  70%|7| 19/27 [00:06<00:01,  7.31it/s, loss=0.2666, grad_norm=13.256, lr=Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  7.34it/s, loss=0.2666, grad_norm=13.256, lr=Training Epoch 4/5:  74%|7| 20/27 [00:06<00:00,  7.34it/s, loss=0.2034, grad_norm=9.741, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  7.38it/s, loss=0.2034, grad_norm=9.741, lr=0Training Epoch 4/5:  78%|7| 21/27 [00:06<00:00,  7.38it/s, loss=0.6494, grad_norm=25.513, lr=Training Epoch 4/5:  81%|8| 22/27 [00:06<00:00,  7.40it/s, loss=0.6494, grad_norm=25.513, lr=Training Epoch 4/5:  81%|8| 22/27 [00:07<00:00,  7.40it/s, loss=0.2115, grad_norm=5.788, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:07<00:00,  7.42it/s, loss=0.2115, grad_norm=5.788, lr=0Training Epoch 4/5:  85%|8| 23/27 [00:07<00:00,  7.42it/s, loss=0.1070, grad_norm=2.158, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:07<00:00,  7.48it/s, loss=0.1070, grad_norm=2.158, lr=0Training Epoch 4/5:  89%|8| 24/27 [00:07<00:00,  7.48it/s, loss=0.1211, grad_norm=3.701, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:07<00:00,  7.50it/s, loss=0.1211, grad_norm=3.701, lr=0Training Epoch 4/5:  93%|9| 25/27 [00:07<00:00,  7.50it/s, loss=0.2566, grad_norm=8.776, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:07<00:00,  7.50it/s, loss=0.2566, grad_norm=8.776, lr=0Training Epoch 4/5:  96%|9| 26/27 [00:07<00:00,  7.50it/s, loss=0.2703, grad_norm=17.452, lr=Training Epoch 4/5: 100%|#| 27/27 [00:08<00:00,  3.30it/s, loss=0.2703, grad_norm=17.452, lr=

Epoch 4/5 Complete (8.6s) [LR: 0.000010]
Train - Loss: 0.2904, Acc: 0.8892, Precision: 0.8802, Recall: 0.9009, F1: 0.8904, AUC: 0.9659
------------------------------------------------------------
Training Epoch 5/5:   0%|                                             | 0/27 [00:00<?, ?it/s]Training Epoch 5/5:   0%|  | 0/27 [00:04<?, ?it/s, loss=0.0973, grad_norm=1.452, lr=0.000010]Training Epoch 5/5:   4%| | 1/27 [00:04<01:51,  4.27s/it, loss=0.0973, grad_norm=1.452, lr=0.Training Epoch 5/5:   4%| | 1/27 [00:04<01:51,  4.27s/it, loss=0.1279, grad_norm=3.719, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:46,  1.85s/it, loss=0.1279, grad_norm=3.719, lr=0.Training Epoch 5/5:   7%| | 2/27 [00:04<00:46,  1.85s/it, loss=0.1703, grad_norm=6.180, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:25,  1.06s/it, loss=0.1703, grad_norm=6.180, lr=0.Training Epoch 5/5:  11%|1| 3/27 [00:04<00:25,  1.06s/it, loss=0.1257, grad_norm=5.327, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:15,  1.44it/s, loss=0.1257, grad_norm=5.327, lr=0.Training Epoch 5/5:  15%|1| 4/27 [00:04<00:15,  1.44it/s, loss=0.1701, grad_norm=8.772, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.04it/s, loss=0.1701, grad_norm=8.772, lr=0.Training Epoch 5/5:  19%|1| 5/27 [00:04<00:10,  2.04it/s, loss=0.0886, grad_norm=2.305, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:04<00:07,  2.70it/s, loss=0.0886, grad_norm=2.305, lr=0.Training Epoch 5/5:  22%|2| 6/27 [00:05<00:07,  2.70it/s, loss=0.1378, grad_norm=4.026, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:05<00:05,  3.42it/s, loss=0.1378, grad_norm=4.026, lr=0.Training Epoch 5/5:  26%|2| 7/27 [00:05<00:05,  3.42it/s, loss=0.0799, grad_norm=3.119, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:05<00:04,  4.19it/s, loss=0.0799, grad_norm=3.119, lr=0.Training Epoch 5/5:  30%|2| 8/27 [00:05<00:04,  4.19it/s, loss=0.0620, grad_norm=2.368, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:05<00:03,  4.92it/s, loss=0.0620, grad_norm=2.368, lr=0.Training Epoch 5/5:  33%|3| 9/27 [00:05<00:03,  4.92it/s, loss=0.0520, grad_norm=0.867, lr=0.Training Epoch 5/5:  37%|3| 10/27 [00:05<00:03,  5.42it/s, loss=0.0520, grad_norm=0.867, lr=0Training Epoch 5/5:  37%|3| 10/27 [00:05<00:03,  5.42it/s, loss=0.0699, grad_norm=1.405, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  5.98it/s, loss=0.0699, grad_norm=1.405, lr=0Training Epoch 5/5:  41%|4| 11/27 [00:05<00:02,  5.98it/s, loss=0.1288, grad_norm=9.782, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  6.35it/s, loss=0.1288, grad_norm=9.782, lr=0Training Epoch 5/5:  44%|4| 12/27 [00:05<00:02,  6.35it/s, loss=0.0843, grad_norm=2.154, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:02,  6.70it/s, loss=0.0843, grad_norm=2.154, lr=0Training Epoch 5/5:  48%|4| 13/27 [00:05<00:02,  6.70it/s, loss=0.0670, grad_norm=2.783, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:05<00:01,  7.06it/s, loss=0.0670, grad_norm=2.783, lr=0Training Epoch 5/5:  52%|5| 14/27 [00:06<00:01,  7.06it/s, loss=0.1923, grad_norm=11.496, lr=Training Epoch 5/5:  56%|5| 15/27 [00:06<00:01,  7.34it/s, loss=0.1923, grad_norm=11.496, lr=Training Epoch 5/5:  56%|5| 15/27 [00:06<00:01,  7.34it/s, loss=0.0420, grad_norm=0.744, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:06<00:01,  7.59it/s, loss=0.0420, grad_norm=0.744, lr=0Training Epoch 5/5:  59%|5| 16/27 [00:06<00:01,  7.59it/s, loss=0.0364, grad_norm=1.086, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:06<00:01,  7.74it/s, loss=0.0364, grad_norm=1.086, lr=0Training Epoch 5/5:  63%|6| 17/27 [00:06<00:01,  7.74it/s, loss=0.0486, grad_norm=1.612, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  7.72it/s, loss=0.0486, grad_norm=1.612, lr=0Training Epoch 5/5:  67%|6| 18/27 [00:06<00:01,  7.72it/s, loss=0.0266, grad_norm=1.019, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:01,  7.73it/s, loss=0.0266, grad_norm=1.019, lr=0Training Epoch 5/5:  70%|7| 19/27 [00:06<00:01,  7.73it/s, loss=0.0360, grad_norm=0.740, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  7.58it/s, loss=0.0360, grad_norm=0.740, lr=0Training Epoch 5/5:  74%|7| 20/27 [00:06<00:00,  7.58it/s, loss=0.0626, grad_norm=2.533, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:06<00:00,  7.69it/s, loss=0.0626, grad_norm=2.533, lr=0Training Epoch 5/5:  78%|7| 21/27 [00:07<00:00,  7.69it/s, loss=0.0347, grad_norm=1.553, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:07<00:00,  7.55it/s, loss=0.0347, grad_norm=1.553, lr=0Training Epoch 5/5:  81%|8| 22/27 [00:07<00:00,  7.55it/s, loss=0.0418, grad_norm=2.384, lr=0Training Epoch 5/5:  85%|8| 23/27 [00:07<00:00,  7.59it/s, loss=0.0418, grad_norm=2.384, lr=0Training Epoch 5/5:  85%|8| 23/27 [00:07<00:00,  7.59it/s, loss=0.1624, grad_norm=10.426, lr=Training Epoch 5/5:  89%|8| 24/27 [00:07<00:00,  7.55it/s, loss=0.1624, grad_norm=10.426, lr=Training Epoch 5/5:  89%|8| 24/27 [00:07<00:00,  7.55it/s, loss=0.0684, grad_norm=8.771, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:07<00:00,  7.50it/s, loss=0.0684, grad_norm=8.771, lr=0Training Epoch 5/5:  93%|9| 25/27 [00:07<00:00,  7.50it/s, loss=0.0219, grad_norm=0.558, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:07<00:00,  7.61it/s, loss=0.0219, grad_norm=0.558, lr=0Training Epoch 5/5:  96%|9| 26/27 [00:07<00:00,  7.61it/s, loss=0.0400, grad_norm=2.728, lr=0Training Epoch 5/5: 100%|#| 27/27 [00:08<00:00,  3.25it/s, loss=0.0400, grad_norm=2.728, lr=0

Epoch 5/5 Complete (8.7s) [LR: 0.000005]
Train - Loss: 0.0843, Acc: 0.9858, Precision: 0.9858, Recall: 0.9858, F1: 0.9858, AUC: 0.9988
------------------------------------------------------------
Training curves saved to model\chb13_fold11\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.7 minutes
Models saved in: model\chb13_fold11
============================================================
✅ Fold 11 training completed successfully!

============================================================
✅ BATCH TRAINING COMPLETED!
✅ Trained models for 12 folds for patient chb13
============================================================
============================================================
============================================================
BATCH EVALUATION: ALL FOLDS
BATCH EVALUATION: ALL FOLDS
Evaluating 12 folds for patient chb13
Evaluating 12 folds for patient chb13
============================================================
============================================================
Using CUDA: NVIDIA GeForce RTX 3090 Ti
Using CUDA: NVIDIA GeForce RTX 3090 Ti

============================================================
============================================================

EVALUATING FOLD 0/11
EVALUATING FOLD 0/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold0
Dataset prefix: chb13_fold0
Using test dataset: preprocessing\data\chb13_fold0\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold0\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold0\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold0\test_dataset.h5...
  - Normalization: z-score, mean=0.2912, std=2.4639
  - Normalization: z-score, mean=0.2912, std=2.4639
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-4.9884, 3.5215]
  - Value range: [-4.9884, 3.5215]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold0\epoch_005.pth...
Loading model checkpoint from model\chb13_fold0\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:  33%|################3                                | 1/3 [00:00<00:00,  4.21it/s]Testing:  33%|################3                                | 1/3 [00:00<00:00,  4.21it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00,  9.63it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00,  9.63it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6058
Loss:      0.6058
Accuracy:  0.7292 (72.92%)
Accuracy:  0.7292 (72.92%)
Precision: 1.0000
Precision: 1.0000
Recall:    0.4583
Recall:    0.4583
F1 Score:  0.6286
F1 Score:  0.6286
AUC-ROC:   0.9809
AUC-ROC:   0.9809

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        24         0
Actual Interictal        24         0
       Preictal        13        11
       Preictal        13        11

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 37 samples
Pred Interictal (0): 37 samples
Pred Preictal (1):   11 samples
Pred Preictal (1):   11 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.6486    1.0000    0.7869        24
    Preictal     1.0000    0.4583    0.6286        24

    accuracy                         0.7292        48
   macro avg     0.8243    0.7292    0.7077        48
weighted avg     0.8243    0.7292    0.7077        48
              precision    recall  f1-score   support

  Interictal     0.6486    1.0000    0.7869        24
    Preictal     1.0000    0.4583    0.6286        24

    accuracy                         0.7292        48
   macro avg     0.8243    0.7292    0.7077        48
weighted avg     0.8243    0.7292    0.7077        48



✅ Results saved to model\chb13_fold0\test_results.json
✅ Results saved to model\chb13_fold0\test_results.json


============================================================
============================================================

EVALUATING FOLD 1/11
EVALUATING FOLD 1/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold1
Dataset prefix: chb13_fold1
Using test dataset: preprocessing\data\chb13_fold1\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold1\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold1\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold1\test_dataset.h5...
  - Normalization: z-score, mean=0.2880, std=2.4586
  - Normalization: z-score, mean=0.2880, std=2.4586
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-4.9972, 3.4833]
  - Value range: [-4.9972, 3.4833]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold1\epoch_005.pth...
Loading model checkpoint from model\chb13_fold1\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 31.58it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 31.58it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      1.1211
Loss:      1.1211
Accuracy:  0.5000 (50.00%)
Accuracy:  0.5000 (50.00%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.7275
AUC-ROC:   0.7275

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        20         0
Actual Interictal        20         0
       Preictal        20         0
       Preictal        20         0

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 40 samples
Pred Interictal (0): 40 samples
Pred Preictal (1):   0 samples
Pred Preictal (1):   0 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        20
    Preictal     0.0000    0.0000    0.0000        20

    accuracy                         0.5000        40
   macro avg     0.2500    0.5000    0.3333        40
weighted avg     0.2500    0.5000    0.3333        40
              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        20
    Preictal     0.0000    0.0000    0.0000        20

    accuracy                         0.5000        40
   macro avg     0.2500    0.5000    0.3333        40
weighted avg     0.2500    0.5000    0.3333        40



✅ Results saved to model\chb13_fold1\test_results.json
✅ Results saved to model\chb13_fold1\test_results.json


============================================================
============================================================

EVALUATING FOLD 2/11
EVALUATING FOLD 2/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold2
Dataset prefix: chb13_fold2
Using test dataset: preprocessing\data\chb13_fold2\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold2\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold2\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold2\test_dataset.h5...
  - Normalization: z-score, mean=0.4286, std=2.4605
  - Normalization: z-score, mean=0.4286, std=2.4605
Loaded test dataset: 36 samples
Loaded test dataset: 36 samples
  - Spectrogram shape: torch.Size([36, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([36, 30, 18, 50, 10])
  - Value range: [-5.0513, 3.5280]
  - Value range: [-5.0513, 3.5280]
  - Class distribution: tensor([18, 18])
  - Class distribution: tensor([18, 18])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold2\epoch_005.pth...
Loading model checkpoint from model\chb13_fold2\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 34.86it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 34.86it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0908
Loss:      0.0908
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        18         0
Actual Interictal        18         0
       Preictal         0        18
       Preictal         0        18

Class Distribution:
Class Distribution:

True Interictal (0): 18 samples
True Interictal (0): 18 samples
True Preictal (1):   18 samples
True Preictal (1):   18 samples
Pred Interictal (0): 18 samples
Pred Interictal (0): 18 samples
Pred Preictal (1):   18 samples
Pred Preictal (1):   18 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        18
    Preictal     1.0000    1.0000    1.0000        18

    accuracy                         1.0000        36
   macro avg     1.0000    1.0000    1.0000        36
weighted avg     1.0000    1.0000    1.0000        36
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        18
    Preictal     1.0000    1.0000    1.0000        18

    accuracy                         1.0000        36
   macro avg     1.0000    1.0000    1.0000        36
weighted avg     1.0000    1.0000    1.0000        36



✅ Results saved to model\chb13_fold2\test_results.json
✅ Results saved to model\chb13_fold2\test_results.json


============================================================
============================================================

EVALUATING FOLD 3/11
EVALUATING FOLD 3/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold3
Dataset prefix: chb13_fold3
Using test dataset: preprocessing\data\chb13_fold3\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold3\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold3\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold3\test_dataset.h5...
  - Normalization: z-score, mean=0.4122, std=2.4583
  - Normalization: z-score, mean=0.4122, std=2.4583
Loaded test dataset: 32 samples
Loaded test dataset: 32 samples
  - Spectrogram shape: torch.Size([32, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([32, 30, 18, 50, 10])
  - Value range: [-5.0491, 3.7269]
  - Value range: [-5.0491, 3.7269]
  - Class distribution: tensor([16, 16])
  - Class distribution: tensor([16, 16])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold3\epoch_005.pth...
Loading model checkpoint from model\chb13_fold3\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/2 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/2 [00:00<?, ?it/s]Testing: 100%|#################################################| 2/2 [00:00<00:00, 30.20it/s]Testing: 100%|#################################################| 2/2 [00:00<00:00, 30.20it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1722
Loss:      0.1722
Accuracy:  0.9375 (93.75%)
Accuracy:  0.9375 (93.75%)
Precision: 0.8889
Precision: 0.8889
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9412
F1 Score:  0.9412
AUC-ROC:   0.9844
AUC-ROC:   0.9844

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         2
Actual Interictal        14         2
       Preictal         0        16
       Preictal         0        16

Class Distribution:
Class Distribution:

True Interictal (0): 16 samples
True Interictal (0): 16 samples
True Preictal (1):   16 samples
True Preictal (1):   16 samples
Pred Interictal (0): 14 samples
Pred Interictal (0): 14 samples
Pred Preictal (1):   18 samples
Pred Preictal (1):   18 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.8750    0.9333        16
    Preictal     0.8889    1.0000    0.9412        16

    accuracy                         0.9375        32
   macro avg     0.9444    0.9375    0.9373        32
weighted avg     0.9444    0.9375    0.9373        32
              precision    recall  f1-score   support

  Interictal     1.0000    0.8750    0.9333        16
    Preictal     0.8889    1.0000    0.9412        16

    accuracy                         0.9375        32
   macro avg     0.9444    0.9375    0.9373        32
weighted avg     0.9444    0.9375    0.9373        32



✅ Results saved to model\chb13_fold3\test_results.json
✅ Results saved to model\chb13_fold3\test_results.json


============================================================
============================================================

EVALUATING FOLD 4/11
EVALUATING FOLD 4/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold4
Dataset prefix: chb13_fold4
Using test dataset: preprocessing\data\chb13_fold4\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold4\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold4\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold4\test_dataset.h5...
  - Normalization: z-score, mean=0.3373, std=2.4506
  - Normalization: z-score, mean=0.3373, std=2.4506
Loaded test dataset: 26 samples
Loaded test dataset: 26 samples
  - Spectrogram shape: torch.Size([26, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([26, 30, 18, 50, 10])
  - Value range: [-5.0167, 3.6761]
  - Value range: [-5.0167, 3.6761]
  - Class distribution: tensor([13, 13])
  - Class distribution: tensor([13, 13])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold4\epoch_005.pth...
Loading model checkpoint from model\chb13_fold4\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/2 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/2 [00:00<?, ?it/s]Testing: 100%|#################################################| 2/2 [00:00<00:00, 30.73it/s]Testing: 100%|#################################################| 2/2 [00:00<00:00, 30.73it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      1.2612
Loss:      1.2612
Accuracy:  0.5385 (53.85%)
Accuracy:  0.5385 (53.85%)
Precision: 1.0000
Precision: 1.0000
Recall:    0.0769
Recall:    0.0769
F1 Score:  0.1429
F1 Score:  0.1429
AUC-ROC:   0.8166
AUC-ROC:   0.8166

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        13         0
Actual Interictal        13         0
       Preictal        12         1
       Preictal        12         1

Class Distribution:
Class Distribution:

True Interictal (0): 13 samples
True Interictal (0): 13 samples
True Preictal (1):   13 samples
True Preictal (1):   13 samples
Pred Interictal (0): 25 samples
Pred Interictal (0): 25 samples
Pred Preictal (1):   1 samples
Pred Preictal (1):   1 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5200    1.0000    0.6842        13
    Preictal     1.0000    0.0769    0.1429        13

    accuracy                         0.5385        26
   macro avg     0.7600    0.5385    0.4135        26
weighted avg     0.7600    0.5385    0.4135        26
              precision    recall  f1-score   support

  Interictal     0.5200    1.0000    0.6842        13
    Preictal     1.0000    0.0769    0.1429        13

    accuracy                         0.5385        26
   macro avg     0.7600    0.5385    0.4135        26
weighted avg     0.7600    0.5385    0.4135        26



✅ Results saved to model\chb13_fold4\test_results.json
✅ Results saved to model\chb13_fold4\test_results.json


============================================================
============================================================

EVALUATING FOLD 5/11
EVALUATING FOLD 5/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold5
Dataset prefix: chb13_fold5
Using test dataset: preprocessing\data\chb13_fold5\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold5\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold5\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold5\test_dataset.h5...
  - Normalization: z-score, mean=0.3354, std=2.4500
  - Normalization: z-score, mean=0.3354, std=2.4500
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.0348, 3.7635]
  - Value range: [-5.0348, 3.7635]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold5\epoch_005.pth...
Loading model checkpoint from model\chb13_fold5\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 35.54it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 35.54it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.4363
Loss:      0.4363
Accuracy:  0.8684 (86.84%)
Accuracy:  0.8684 (86.84%)
Precision: 0.7917
Precision: 0.7917
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.8837
F1 Score:  0.8837
AUC-ROC:   0.9391
AUC-ROC:   0.9391

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         5
Actual Interictal        14         5
       Preictal         0        19
       Preictal         0        19

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 14 samples
Pred Interictal (0): 14 samples
Pred Preictal (1):   24 samples
Pred Preictal (1):   24 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.7368    0.8485        19
    Preictal     0.7917    1.0000    0.8837        19

    accuracy                         0.8684        38
   macro avg     0.8958    0.8684    0.8661        38
weighted avg     0.8958    0.8684    0.8661        38
              precision    recall  f1-score   support

  Interictal     1.0000    0.7368    0.8485        19
    Preictal     0.7917    1.0000    0.8837        19

    accuracy                         0.8684        38
   macro avg     0.8958    0.8684    0.8661        38
weighted avg     0.8958    0.8684    0.8661        38



✅ Results saved to model\chb13_fold5\test_results.json
✅ Results saved to model\chb13_fold5\test_results.json


============================================================
============================================================

EVALUATING FOLD 6/11
EVALUATING FOLD 6/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold6
Dataset prefix: chb13_fold6
Using test dataset: preprocessing\data\chb13_fold6\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold6\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold6\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold6\test_dataset.h5...
  - Normalization: z-score, mean=0.4176, std=2.4646
  - Normalization: z-score, mean=0.4176, std=2.4646
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.0383, 3.3837]
  - Value range: [-5.0383, 3.3837]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold6\epoch_005.pth...
Loading model checkpoint from model\chb13_fold6\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 33.36it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 33.36it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0770
Loss:      0.0770
Accuracy:  0.9762 (97.62%)
Accuracy:  0.9762 (97.62%)
Precision: 0.9545
Precision: 0.9545
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9767
F1 Score:  0.9767
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        20         1
Actual Interictal        20         1
       Preictal         0        21
       Preictal         0        21

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 20 samples
Pred Interictal (0): 20 samples
Pred Preictal (1):   22 samples
Pred Preictal (1):   22 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9524    0.9756        21
    Preictal     0.9545    1.0000    0.9767        21

    accuracy                         0.9762        42
   macro avg     0.9773    0.9762    0.9762        42
weighted avg     0.9773    0.9762    0.9762        42
              precision    recall  f1-score   support

  Interictal     1.0000    0.9524    0.9756        21
    Preictal     0.9545    1.0000    0.9767        21

    accuracy                         0.9762        42
   macro avg     0.9773    0.9762    0.9762        42
weighted avg     0.9773    0.9762    0.9762        42



✅ Results saved to model\chb13_fold6\test_results.json
✅ Results saved to model\chb13_fold6\test_results.json


============================================================
============================================================

EVALUATING FOLD 7/11
EVALUATING FOLD 7/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold7
Dataset prefix: chb13_fold7
Using test dataset: preprocessing\data\chb13_fold7\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold7\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold7\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold7\test_dataset.h5...
  - Normalization: z-score, mean=0.4065, std=2.4542
  - Normalization: z-score, mean=0.4065, std=2.4542
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.0553, 3.5520]
  - Value range: [-5.0553, 3.5520]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold7\epoch_005.pth...
Loading model checkpoint from model\chb13_fold7\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 34.51it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 34.51it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0537
Loss:      0.0537
Accuracy:  0.9750 (97.50%)
Accuracy:  0.9750 (97.50%)
Precision: 0.9524
Precision: 0.9524
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9756
F1 Score:  0.9756
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        19         1
Actual Interictal        19         1
       Preictal         0        20
       Preictal         0        20

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 19 samples
Pred Interictal (0): 19 samples
Pred Preictal (1):   21 samples
Pred Preictal (1):   21 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9500    0.9744        20
    Preictal     0.9524    1.0000    0.9756        20

    accuracy                         0.9750        40
   macro avg     0.9762    0.9750    0.9750        40
weighted avg     0.9762    0.9750    0.9750        40
              precision    recall  f1-score   support

  Interictal     1.0000    0.9500    0.9744        20
    Preictal     0.9524    1.0000    0.9756        20

    accuracy                         0.9750        40
   macro avg     0.9762    0.9750    0.9750        40
weighted avg     0.9762    0.9750    0.9750        40



✅ Results saved to model\chb13_fold7\test_results.json
✅ Results saved to model\chb13_fold7\test_results.json


============================================================
============================================================

EVALUATING FOLD 8/11
EVALUATING FOLD 8/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold8
Dataset prefix: chb13_fold8
Using test dataset: preprocessing\data\chb13_fold8\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold8\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold8\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold8\test_dataset.h5...
  - Normalization: z-score, mean=0.4267, std=2.4521
  - Normalization: z-score, mean=0.4267, std=2.4521
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.0678, 3.5905]
  - Value range: [-5.0678, 3.5905]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold8\epoch_005.pth...
Loading model checkpoint from model\chb13_fold8\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 34.36it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 34.36it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1494
Loss:      0.1494
Accuracy:  0.9500 (95.00%)
Accuracy:  0.9500 (95.00%)
Precision: 0.9091
Precision: 0.9091
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9524
F1 Score:  0.9524
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        18         2
Actual Interictal        18         2
       Preictal         0        20
       Preictal         0        20

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 18 samples
Pred Interictal (0): 18 samples
Pred Preictal (1):   22 samples
Pred Preictal (1):   22 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9000    0.9474        20
    Preictal     0.9091    1.0000    0.9524        20

    accuracy                         0.9500        40
   macro avg     0.9545    0.9500    0.9499        40
weighted avg     0.9545    0.9500    0.9499        40
              precision    recall  f1-score   support

  Interictal     1.0000    0.9000    0.9474        20
    Preictal     0.9091    1.0000    0.9524        20

    accuracy                         0.9500        40
   macro avg     0.9545    0.9500    0.9499        40
weighted avg     0.9545    0.9500    0.9499        40



✅ Results saved to model\chb13_fold8\test_results.json
✅ Results saved to model\chb13_fold8\test_results.json


============================================================
============================================================

EVALUATING FOLD 9/11
EVALUATING FOLD 9/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold9
Dataset prefix: chb13_fold9
Using test dataset: preprocessing\data\chb13_fold9\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold9\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold9\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold9\test_dataset.h5...
  - Normalization: z-score, mean=0.4172, std=2.4492
  - Normalization: z-score, mean=0.4172, std=2.4492
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.0698, 3.8225]
  - Value range: [-5.0698, 3.8225]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold9\epoch_005.pth...
Loading model checkpoint from model\chb13_fold9\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 31.26it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 31.26it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.2024
Loss:      0.2024
Accuracy:  0.9545 (95.45%)
Accuracy:  0.9545 (95.45%)
Precision: 0.9167
Precision: 0.9167
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9565
F1 Score:  0.9565
AUC-ROC:   0.9545
AUC-ROC:   0.9545

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        20         2
Actual Interictal        20         2
       Preictal         0        22
       Preictal         0        22

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 20 samples
Pred Interictal (0): 20 samples
Pred Preictal (1):   24 samples
Pred Preictal (1):   24 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9091    0.9524        22
    Preictal     0.9167    1.0000    0.9565        22

    accuracy                         0.9545        44
   macro avg     0.9583    0.9545    0.9545        44
weighted avg     0.9583    0.9545    0.9545        44
              precision    recall  f1-score   support

  Interictal     1.0000    0.9091    0.9524        22
    Preictal     0.9167    1.0000    0.9565        22

    accuracy                         0.9545        44
   macro avg     0.9583    0.9545    0.9545        44
weighted avg     0.9583    0.9545    0.9545        44



✅ Results saved to model\chb13_fold9\test_results.json
✅ Results saved to model\chb13_fold9\test_results.json


============================================================
============================================================

EVALUATING FOLD 10/11
EVALUATING FOLD 10/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold10
Dataset prefix: chb13_fold10
Using test dataset: preprocessing\data\chb13_fold10\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold10\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold10\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold10\test_dataset.h5...
  - Normalization: z-score, mean=0.3705, std=2.4484
  - Normalization: z-score, mean=0.3705, std=2.4484
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.0525, 3.9980]
  - Value range: [-5.0525, 3.9980]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold10\epoch_005.pth...
Loading model checkpoint from model\chb13_fold10\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 36.39it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 36.39it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1672
Loss:      0.1672
Accuracy:  0.9737 (97.37%)
Accuracy:  0.9737 (97.37%)
Precision: 0.9500
Precision: 0.9500
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9744
F1 Score:  0.9744
AUC-ROC:   0.9972
AUC-ROC:   0.9972

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        18         1
Actual Interictal        18         1
       Preictal         0        19
       Preictal         0        19

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 18 samples
Pred Interictal (0): 18 samples
Pred Preictal (1):   20 samples
Pred Preictal (1):   20 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9474    0.9730        19
    Preictal     0.9500    1.0000    0.9744        19

    accuracy                         0.9737        38
   macro avg     0.9750    0.9737    0.9737        38
weighted avg     0.9750    0.9737    0.9737        38
              precision    recall  f1-score   support

  Interictal     1.0000    0.9474    0.9730        19
    Preictal     0.9500    1.0000    0.9744        19

    accuracy                         0.9737        38
   macro avg     0.9750    0.9737    0.9737        38
weighted avg     0.9750    0.9737    0.9737        38



✅ Results saved to model\chb13_fold10\test_results.json
✅ Results saved to model\chb13_fold10\test_results.json


============================================================
============================================================

EVALUATING FOLD 11/11
EVALUATING FOLD 11/11
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb13_fold11
Dataset prefix: chb13_fold11
Using test dataset: preprocessing\data\chb13_fold11\test_dataset.h5
Using test dataset: preprocessing\data\chb13_fold11\test_dataset.h5
Loading test dataset from preprocessing\data\chb13_fold11\test_dataset.h5...
Loading test dataset from preprocessing\data\chb13_fold11\test_dataset.h5...
  - Normalization: z-score, mean=0.4379, std=2.4566
  - Normalization: z-score, mean=0.4379, std=2.4566
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-5.0630, 3.5149]
  - Value range: [-5.0630, 3.5149]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb13_fold11\epoch_005.pth...
Loading model checkpoint from model\chb13_fold11\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                         | 0/3 [00:00<?, ?it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 31.61it/s]Testing: 100%|#################################################| 3/3 [00:00<00:00, 31.61it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1038
Loss:      0.1038
Accuracy:  0.9792 (97.92%)
Accuracy:  0.9792 (97.92%)
Precision: 0.9600
Precision: 0.9600
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9796
F1 Score:  0.9796
AUC-ROC:   0.9740
AUC-ROC:   0.9740

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        23         1
Actual Interictal        23         1
       Preictal         0        24
       Preictal         0        24

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 23 samples
Pred Interictal (0): 23 samples
Pred Preictal (1):   25 samples
Pred Preictal (1):   25 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9583    0.9787        24
    Preictal     0.9600    1.0000    0.9796        24

    accuracy                         0.9792        48
   macro avg     0.9800    0.9792    0.9792        48
weighted avg     0.9800    0.9792    0.9792        48
              precision    recall  f1-score   support

  Interictal     1.0000    0.9583    0.9787        24
    Preictal     0.9600    1.0000    0.9796        24

    accuracy                         0.9792        48
   macro avg     0.9800    0.9792    0.9792        48
weighted avg     0.9800    0.9792    0.9792        48



✅ Results saved to model\chb13_fold11\test_results.json
✅ Results saved to model\chb13_fold11\test_results.json


============================================================
============================================================

BATCH EVALUATION SUMMARY
BATCH EVALUATION SUMMARY
============================================================
============================================================
Folds evaluated: 12/12
Folds evaluated: 12/12

Mean metrics (across folds):
Mean metrics (across folds):

  Accuracy:  0.8652 (±0.1699)
  Accuracy:  0.8652 (±0.1699)
  Precision: 0.8603 (±0.2654)
  Precision: 0.8603 (±0.2654)
  Recall:    0.7946 (±0.3696)
  Recall:    0.7946 (±0.3696)
  F1 Score:  0.7843 (±0.3339)
  F1 Score:  0.7843 (±0.3339)
  AUC-ROC:   0.9478 (±0.0828)
  AUC-ROC:   0.9478 (±0.0828)

✅ Batch results saved to model\batch_test_results.json
✅ Batch results saved to model\batch_test_results.json

============================================================
============================================================
