============================================================
BATCH PROCESSING: ALL FOLDS
Processing 8 folds for patient chb14
============================================================

Configuration:
  - Task mode: PREDICTION (preictal vs interictal)
  - LOOCV Mode: ENABLED
  - Sequence length: 30 segments
  - Sequence duration: 150s (2.5 min)
  - Stride: 5 segments (83% overlap)
  - Segment duration: 5s
  - Preictal window: 10 min
  - Interictal buffer: 120 min
  - Channel validation: ENABLED
  - Target channels: 18 channels
============================================================

Extracting sequences from patient chb14...
c:\Users\Aaron Lin\CapstoneTest\epilepsy-prediction\data_segmentation_helpers\channel_validation.py:78: RuntimeWarning: Number of records from the header does not match the file size (perhaps the recording was not stopped before exiting). Inferring from the file size.
  raw = mne.io.read_raw_edf(edf_path, preload=False, verbose=False)
c:\Users\Aaron Lin\CapstoneTest\epilepsy-prediction\data_segmentation.py:28: RuntimeWarning: Number of records from the header does not match the file size (perhaps the recording was not stopped before exiting). Inferring from the file size.
  raw = mne.io.read_raw_edf(edf_path, preload=False, verbose=False)
Patient chb14: 467 sequences (172 preictal, 295 interictal)

============================================================
PROCESSING FOLD 0/7
============================================================
Output prefix: chb14_fold0
LOOCV Fold 0: Test seizure=0, Train seizures=[1, 2, 3, 4, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 344
  - Preictal sequences: 172
  - Interictal sequences: 172
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb14: 344 total (172 preictal, 172 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 296 total (148 preictal, 148 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 287.2s (4.8 min)
Class balance: 172/172 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 148 preictal, 148 interictal (dropped 0 preictal, 0 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 123 interictal)

Sequences saved to chb14_fold0_sequences_prediction.json
File size: 0.58 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 26
Files with valid channels: 26
Files with invalid channels: 0

✅ Fold 0 completed successfully!
✅ Sequences saved to chb14_fold0_sequences_prediction.json

============================================================
PROCESSING FOLD 1/7
============================================================
Output prefix: chb14_fold1
LOOCV Fold 1: Test seizure=1, Train seizures=[0, 2, 3, 4, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 318
  - Preictal sequences: 159
  - Interictal sequences: 159
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb14: 318 total (159 preictal, 159 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 22 total (11 preictal, 11 interictal)
train: 296 total (148 preictal, 148 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 282.4s (4.7 min)
Class balance: 159/159 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 148 preictal, 148 interictal (dropped 13 preictal, 0 interictal)
test: 11 preictal, 11 interictal (dropped 0 preictal, 136 interictal)

Sequences saved to chb14_fold1_sequences_prediction.json
File size: 0.53 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 26
Files with valid channels: 26
Files with invalid channels: 0

✅ Fold 1 completed successfully!
✅ Sequences saved to chb14_fold1_sequences_prediction.json

============================================================
PROCESSING FOLD 2/7
============================================================
Output prefix: chb14_fold2
LOOCV Fold 2: Test seizure=2, Train seizures=[0, 1, 3, 4, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 344
  - Preictal sequences: 172
  - Interictal sequences: 172
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb14: 344 total (172 preictal, 172 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 296 total (148 preictal, 148 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 287.2s (4.8 min)
Class balance: 172/172 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 148 preictal, 148 interictal (dropped 0 preictal, 0 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 123 interictal)

Sequences saved to chb14_fold2_sequences_prediction.json
File size: 0.58 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 26
Files with valid channels: 26
Files with invalid channels: 0

✅ Fold 2 completed successfully!
✅ Sequences saved to chb14_fold2_sequences_prediction.json

============================================================
PROCESSING FOLD 3/7
============================================================
Output prefix: chb14_fold3
LOOCV Fold 3: Test seizure=3, Train seizures=[0, 1, 2, 4, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 342
  - Preictal sequences: 171
  - Interictal sequences: 171
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb14: 342 total (171 preictal, 171 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 296 total (148 preictal, 148 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 287.5s (4.8 min)
Class balance: 171/171 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 148 preictal, 148 interictal (dropped 1 preictal, 0 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 124 interictal)

Sequences saved to chb14_fold3_sequences_prediction.json
File size: 0.57 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 26
Files with valid channels: 26
Files with invalid channels: 0

✅ Fold 3 completed successfully!
✅ Sequences saved to chb14_fold3_sequences_prediction.json

============================================================
PROCESSING FOLD 4/7
============================================================
Output prefix: chb14_fold4
LOOCV Fold 4: Test seizure=4, Train seizures=[0, 1, 2, 3, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 336
  - Preictal sequences: 168
  - Interictal sequences: 168
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb14: 336 total (168 preictal, 168 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 296 total (148 preictal, 148 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 290.2s (4.8 min)
Class balance: 168/168 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 148 preictal, 148 interictal (dropped 4 preictal, 0 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 127 interictal)

Sequences saved to chb14_fold4_sequences_prediction.json
File size: 0.56 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 26
Files with valid channels: 26
Files with invalid channels: 0

✅ Fold 4 completed successfully!
✅ Sequences saved to chb14_fold4_sequences_prediction.json

============================================================
PROCESSING FOLD 5/7
============================================================
Output prefix: chb14_fold5
LOOCV Fold 5: Test seizure=5, Train seizures=[0, 1, 2, 3, 4, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 340
  - Preictal sequences: 170
  - Interictal sequences: 170
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb14: 340 total (170 preictal, 170 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 296 total (148 preictal, 148 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 286.2s (4.8 min)
Class balance: 170/170 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 148 preictal, 148 interictal (dropped 2 preictal, 0 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 125 interictal)

Sequences saved to chb14_fold5_sequences_prediction.json
File size: 0.57 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 26
Files with valid channels: 26
Files with invalid channels: 0

✅ Fold 5 completed successfully!
✅ Sequences saved to chb14_fold5_sequences_prediction.json

============================================================
PROCESSING FOLD 6/7
============================================================
Output prefix: chb14_fold6
LOOCV Fold 6: Test seizure=6, Train seizures=[0, 1, 2, 3, 4, 5, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 344
  - Preictal sequences: 172
  - Interictal sequences: 172
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb14: 344 total (172 preictal, 172 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 296 total (148 preictal, 148 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 287.2s (4.8 min)
Class balance: 172/172 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 148 preictal, 148 interictal (dropped 0 preictal, 0 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 123 interictal)

Sequences saved to chb14_fold6_sequences_prediction.json
File size: 0.58 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 26
Files with valid channels: 26
Files with invalid channels: 0

✅ Fold 6 completed successfully!
✅ Sequences saved to chb14_fold6_sequences_prediction.json

============================================================
PROCESSING FOLD 7/7
============================================================
Output prefix: chb14_fold7
LOOCV Fold 7: Test seizure=7, Train seizures=[0, 1, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 344
  - Preictal sequences: 172
  - Interictal sequences: 172
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb14: 344 total (172 preictal, 172 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 296 total (148 preictal, 148 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 287.2s (4.8 min)
Class balance: 172/172 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 148 preictal, 148 interictal (dropped 0 preictal, 0 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 123 interictal)

Sequences saved to chb14_fold7_sequences_prediction.json
File size: 0.58 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 26
Files with valid channels: 26
Files with invalid channels: 0

✅ Fold 7 completed successfully!
✅ Sequences saved to chb14_fold7_sequences_prediction.json

============================================================
✅ BATCH PROCESSING COMPLETED!
✅ Processed 8 folds for patient chb14
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 8 folds for patient chb14
============================================================

============================================================
PREPROCESSING FOLD 0/7
============================================================
2025-11-20 13:36:02,235 - INFO - ============================================================
2025-11-20 13:36:02,235 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 13:36:02,235 - INFO - ============================================================
2025-11-20 13:36:02,235 - INFO - Output prefix: chb14_fold0
2025-11-20 13:36:02,235 - INFO - EEG Preprocessor initialized
2025-11-20 13:36:02,235 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 13:36:02,236 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 13:36:02,236 - INFO - Segment duration: 5 seconds
2025-11-20 13:36:02,236 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 13:36:02,236 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 13:36:02,236 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 13:36:02,236 - INFO - Loading segments from chb14_fold0_sequences_prediction.json
2025-11-20 13:36:02,249 - INFO - Loaded 344 total sequences
2025-11-20 13:36:02,249 - INFO - Channel validation (from segmentation): 26/26 files valid
2025-11-20 13:36:02,249 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 13:36:02,249 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 13:36:02,249 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 13:36:02,249 - INFO - train: 296 sequences (148 preictal, 148 interictal)
2025-11-20 13:36:02,249 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-20 13:36:02,267 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 13:36:02,268 - INFO - train: kept 148 preictal and 148 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:36:02,268 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:36:02,285 - INFO - ============================================================
2025-11-20 13:36:02,285 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 13:36:02,285 - INFO - ============================================================
2025-11-20 13:36:02,285 - INFO - Processing 296 training samples to compute normalization stats...
2025-11-20 13:36:02,285 - INFO - Processing 296 sequences from 20 unique files
Processing training data:   0%|                    | 0/296 [00:00<?, ?it/s]Processing training data:   0%|            | 1/296 [00:02<12:22,  2.52s/it]Processing training data:  12%|#3         | 36/296 [00:04<00:23, 10.89it/s]Processing training data:  16%|#7         | 46/296 [00:04<00:20, 12.20it/s]Processing training data:  22%|##4        | 66/296 [00:05<00:16, 13.66it/s]Processing training data:  25%|##7        | 74/296 [00:06<00:19, 11.61it/s]Processing training data:  27%|##9        | 79/296 [00:08<00:25,  8.59it/s]Processing training data:  31%|###3       | 91/296 [00:10<00:25,  7.92it/s]Processing training data:  34%|###4      | 102/296 [00:11<00:21,  8.87it/s]Processing training data:  37%|###7      | 110/296 [00:11<00:19,  9.65it/s]Processing training data:  45%|####5     | 134/296 [00:13<00:13, 11.88it/s]Processing training data:  49%|####9     | 146/296 [00:13<00:11, 13.19it/s]Processing training data:  57%|#####6    | 168/296 [00:15<00:09, 13.27it/s]Processing training data:  61%|######    | 180/296 [00:17<00:10, 10.71it/s]Processing training data:  65%|######4   | 192/296 [00:18<00:11,  9.40it/s]Processing training data:  68%|######8   | 202/296 [00:19<00:09, 10.22it/s]Processing training data:  76%|#######6  | 225/296 [00:21<00:05, 12.05it/s]Processing training data:  79%|#######9  | 235/296 [00:22<00:06,  9.84it/s]Processing training data:  85%|########4 | 251/296 [00:24<00:04,  9.59it/s]Processing training data:  89%|########8 | 262/296 [00:25<00:03, 10.68it/s]Processing training data:  97%|#########6| 286/296 [00:26<00:00, 11.94it/s]Processing training data: 100%|##########| 296/296 [00:26<00:00, 10.97it/s]
2025-11-20 13:36:29,265 - INFO - Computing normalization statistics from training data...
2025-11-20 13:36:29,817 - INFO - Normalization stats computed:
2025-11-20 13:36:29,817 - INFO -   Mean: -0.006061
2025-11-20 13:36:29,817 - INFO -   Std: 2.513933
2025-11-20 13:36:29,817 - INFO -   Saved to: preprocessing\checkpoints\chb14_fold0\normalization_stats.json
2025-11-20 13:36:29,880 - INFO - Applying normalization and saving 296 training sequences...
Normalizing and saving training data:   0%|        | 0/296 [00:00<?, ?it/s]2025-11-20 13:36:29,889 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold0\train_dataset.h5
Normalizing and saving training data:   3%| | 10/296 [00:00<00:19, 14.69it/Normalizing and saving training data:   7%| | 20/296 [00:01<00:18, 15.11it/Normalizing and saving training data:  10%|1| 30/296 [00:01<00:17, 15.18it/Normalizing and saving training data:  14%|1| 40/296 [00:02<00:16, 15.23it/Normalizing and saving training data:  17%|1| 50/296 [00:03<00:16, 15.12it/Normalizing and saving training data:  20%|2| 60/296 [00:03<00:15, 15.20it/Normalizing and saving training data:  24%|2| 70/296 [00:04<00:14, 15.24it/Normalizing and saving training data:  27%|2| 80/296 [00:05<00:14, 15.08it/Normalizing and saving training data:  30%|3| 90/296 [00:05<00:13, 15.21it/Normalizing and saving training data:  34%|3| 100/296 [00:06<00:12, 15.23itNormalizing and saving training data:  37%|3| 110/296 [00:07<00:12, 15.27itNormalizing and saving training data:  41%|4| 120/296 [00:07<00:11, 15.27itNormalizing and saving training data:  44%|4| 130/296 [00:08<00:10, 15.26itNormalizing and saving training data:  47%|4| 140/296 [00:09<00:10, 15.32itNormalizing and saving training data:  51%|5| 150/296 [00:09<00:09, 15.40itNormalizing and saving training data:  54%|5| 160/296 [00:10<00:08, 15.46itNormalizing and saving training data:  57%|5| 170/296 [00:11<00:08, 15.51itNormalizing and saving training data:  61%|6| 180/296 [00:11<00:07, 15.45itNormalizing and saving training data:  64%|6| 190/296 [00:12<00:06, 15.38itNormalizing and saving training data:  68%|6| 200/296 [00:13<00:06, 15.41itNormalizing and saving training data:  71%|7| 210/296 [00:13<00:05, 15.43itNormalizing and saving training data:  74%|7| 220/296 [00:14<00:04, 15.45itNormalizing and saving training data:  78%|7| 230/296 [00:15<00:04, 15.39itNormalizing and saving training data:  81%|8| 240/296 [00:15<00:03, 15.40itNormalizing and saving training data:  84%|8| 250/296 [00:16<00:03, 15.28itNormalizing and saving training data:  88%|8| 260/296 [00:16<00:02, 15.31itNormalizing and saving training data:  91%|9| 270/296 [00:17<00:01, 15.35itNormalizing and saving training data:  95%|9| 280/296 [00:18<00:01, 15.37itNormalizing and saving training data:  98%|9| 290/296 [00:18<00:00, 15.38itNormalizing and saving training data: 100%|#| 296/296 [00:18<00:00, 15.63it
2025-11-20 13:36:49,234 - INFO - Training data processing completed during stats computation phase
2025-11-20 13:36:49,241 - INFO - Loaded normalization statistics:
2025-11-20 13:36:49,241 - INFO -   Mean: -0.006061
2025-11-20 13:36:49,241 - INFO -   Std: 2.513933
2025-11-20 13:36:49,241 - INFO - Split train already completed, skipping
2025-11-20 13:36:49,241 - INFO - Processing test split...
2025-11-20 13:36:49,241 - INFO - Need to process 48/48 sequences for test
2025-11-20 13:36:49,241 - INFO - Processing 48 sequences from 12 unique files
2025-11-20 13:36:49,241 - INFO - Average 4.0 sequences per file
Processing test:   0%|                              | 0/48 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/48 [00:00<00:15,  3.09it/s]Processing test:   4%|9                     | 2/48 [00:00<00:24,  1.89it/s]2025-11-20 13:36:50,240 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold0\test_dataset.h5
2025-11-20 13:36:51,753 - INFO - Progress: 321/344 (93.3%) - ETA: 0.1 minutes
Processing test:  54%|###########3         | 26/48 [00:04<00:03,  6.70it/s]Processing test:  62%|#############1       | 30/48 [00:04<00:02,  6.39it/s]Processing test:  67%|##############       | 32/48 [00:05<00:02,  6.13it/s]Processing test:  69%|##############4      | 33/48 [00:07<00:04,  3.51it/s]2025-11-20 13:36:56,926 - INFO - Progress: 331/344 (96.2%) - ETA: 0.0 minutes
Processing test:  75%|###############7     | 36/48 [00:08<00:04,  2.87it/s]Processing test:  83%|#################5   | 40/48 [00:09<00:02,  3.67it/s]Processing test:  88%|##################3  | 42/48 [00:09<00:01,  3.71it/s]Processing test:  94%|###################6 | 45/48 [00:10<00:00,  3.64it/s]2025-11-20 13:37:00,423 - INFO - Progress: 342/344 (99.4%) - ETA: 0.0 minutes
Processing test:  98%|####################5| 47/48 [00:11<00:00,  3.06it/s]Processing test: 100%|#####################| 48/48 [00:11<00:00,  3.05it/s]Processing test: 100%|#####################| 48/48 [00:11<00:00,  4.04it/s]
2025-11-20 13:37:01,278 - INFO - Validating final datasets...
2025-11-20 13:37:01,286 - INFO - train dataset validation:
2025-11-20 13:37:01,286 - INFO -   - Segments: 296
2025-11-20 13:37:01,286 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:37:01,286 - INFO -   - Classes: 148 preictal, 148 interictal
2025-11-20 13:37:01,286 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:37:01,292 - INFO - test dataset validation:
2025-11-20 13:37:01,292 - INFO -   - Segments: 48
2025-11-20 13:37:01,292 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:37:01,292 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-20 13:37:01,292 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:37:01,292 - INFO - ============================================================
2025-11-20 13:37:01,292 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 13:37:01,292 - INFO - Total time: 1.0 minutes
2025-11-20 13:37:01,292 - INFO - Processed segments: 344
2025-11-20 13:37:01,292 - INFO - Average rate: 5.8 segments/second
2025-11-20 13:37:01,292 - INFO - ============================================================
✅ Fold 0 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 1/7
============================================================
2025-11-20 13:37:01,367 - INFO - ============================================================
2025-11-20 13:37:01,367 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 13:37:01,368 - INFO - ============================================================
2025-11-20 13:37:01,368 - INFO - Output prefix: chb14_fold1
2025-11-20 13:37:01,368 - INFO - EEG Preprocessor initialized
2025-11-20 13:37:01,368 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 13:37:01,368 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 13:37:01,368 - INFO - Segment duration: 5 seconds
2025-11-20 13:37:01,368 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 13:37:01,368 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 13:37:01,368 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 13:37:01,368 - INFO - Loading segments from chb14_fold1_sequences_prediction.json
2025-11-20 13:37:01,381 - INFO - Loaded 318 total sequences
2025-11-20 13:37:01,381 - INFO - Channel validation (from segmentation): 26/26 files valid
2025-11-20 13:37:01,381 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 13:37:01,381 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 13:37:01,381 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 13:37:01,381 - INFO - train: 296 sequences (148 preictal, 148 interictal)
2025-11-20 13:37:01,381 - INFO - test: 22 sequences (11 preictal, 11 interictal)
2025-11-20 13:37:01,398 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 13:37:01,398 - INFO - train: kept 148 preictal and 148 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:37:01,398 - INFO - test: kept 11 preictal and 11 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:37:01,415 - INFO - ============================================================
2025-11-20 13:37:01,415 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 13:37:01,415 - INFO - ============================================================
2025-11-20 13:37:01,415 - INFO - Processing 296 training samples to compute normalization stats...
2025-11-20 13:37:01,415 - INFO - Processing 296 sequences from 20 unique files
Processing training data:   0%|                    | 0/296 [00:00<?, ?it/s]Processing training data:   0%|            | 1/296 [00:00<03:05,  1.59it/s]Processing training data:   8%|8          | 24/296 [00:01<00:17, 15.37it/s]Processing training data:  23%|##5        | 68/296 [00:02<00:06, 35.89it/s]Processing training data:  30%|###2       | 88/296 [00:03<00:08, 24.87it/s]Processing training data:  32%|###5       | 96/296 [00:05<00:13, 14.54it/s]Processing training data:  37%|###7      | 110/296 [00:06<00:11, 16.20it/s]Processing training data:  45%|####4     | 132/296 [00:07<00:10, 15.01it/s]Processing training data:  50%|#####     | 148/296 [00:09<00:11, 13.24it/s]Processing training data:  54%|#####3    | 159/296 [00:10<00:11, 11.84it/s]Processing training data:  56%|#####6    | 167/296 [00:11<00:10, 12.06it/s]Processing training data:  63%|######3   | 187/296 [00:12<00:09, 12.03it/s]Processing training data:  68%|######8   | 202/296 [00:14<00:08, 10.90it/s]Processing training data:  73%|#######2  | 216/296 [00:16<00:08,  9.95it/s]Processing training data:  76%|#######6  | 225/296 [00:17<00:08,  8.41it/s]Processing training data:  79%|#######9  | 235/296 [00:19<00:08,  7.49it/s]Processing training data:  84%|########4 | 249/296 [00:20<00:05,  9.29it/s]Processing training data:  86%|########6 | 255/296 [00:22<00:05,  7.29it/s]Processing training data:  90%|########9 | 266/296 [00:22<00:03,  8.85it/s]Processing training data:  96%|#########6| 285/296 [00:24<00:01, 10.40it/s]Processing training data:  98%|#########7| 290/296 [00:25<00:00,  7.92it/s]Processing training data: 100%|##########| 296/296 [00:25<00:00, 11.48it/s]
2025-11-20 13:37:27,203 - INFO - Computing normalization statistics from training data...
2025-11-20 13:37:27,737 - INFO - Normalization stats computed:
2025-11-20 13:37:27,737 - INFO -   Mean: -0.018582
2025-11-20 13:37:27,737 - INFO -   Std: 2.514945
2025-11-20 13:37:27,737 - INFO -   Saved to: preprocessing\checkpoints\chb14_fold1\normalization_stats.json
2025-11-20 13:37:27,790 - INFO - Applying normalization and saving 296 training sequences...
Normalizing and saving training data:   0%|        | 0/296 [00:00<?, ?it/s]2025-11-20 13:37:27,801 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold1\train_dataset.h5
Normalizing and saving training data:   3%| | 10/296 [00:00<00:17, 16.26it/Normalizing and saving training data:   7%| | 20/296 [00:01<00:17, 15.82it/Normalizing and saving training data:  10%|1| 30/296 [00:01<00:16, 15.86it/Normalizing and saving training data:  14%|1| 40/296 [00:02<00:16, 15.88it/Normalizing and saving training data:  17%|1| 50/296 [00:03<00:15, 15.91it/Normalizing and saving training data:  20%|2| 60/296 [00:03<00:14, 15.96it/Normalizing and saving training data:  24%|2| 70/296 [00:04<00:14, 15.97it/Normalizing and saving training data:  27%|2| 80/296 [00:05<00:13, 16.00it/Normalizing and saving training data:  30%|3| 90/296 [00:05<00:12, 16.00it/Normalizing and saving training data:  34%|3| 100/296 [00:06<00:12, 16.03itNormalizing and saving training data:  37%|3| 110/296 [00:06<00:11, 16.04itNormalizing and saving training data:  41%|4| 120/296 [00:07<00:11, 15.99itNormalizing and saving training data:  44%|4| 130/296 [00:08<00:10, 16.03itNormalizing and saving training data:  47%|4| 140/296 [00:08<00:09, 15.96itNormalizing and saving training data:  51%|5| 150/296 [00:09<00:09, 15.90itNormalizing and saving training data:  54%|5| 160/296 [00:10<00:08, 15.91itNormalizing and saving training data:  57%|5| 170/296 [00:10<00:07, 15.92itNormalizing and saving training data:  61%|6| 180/296 [00:11<00:07, 15.79itNormalizing and saving training data:  64%|6| 190/296 [00:11<00:06, 15.80itNormalizing and saving training data:  68%|6| 200/296 [00:12<00:06, 15.84itNormalizing and saving training data:  71%|7| 210/296 [00:13<00:05, 15.91itNormalizing and saving training data:  74%|7| 220/296 [00:13<00:04, 15.84itNormalizing and saving training data:  78%|7| 230/296 [00:14<00:04, 15.78itNormalizing and saving training data:  81%|8| 240/296 [00:15<00:03, 15.85itNormalizing and saving training data:  84%|8| 250/296 [00:15<00:02, 15.86itNormalizing and saving training data:  88%|8| 260/296 [00:16<00:02, 15.89itNormalizing and saving training data:  91%|9| 270/296 [00:16<00:01, 15.83itNormalizing and saving training data:  95%|9| 280/296 [00:17<00:01, 15.84itNormalizing and saving training data:  98%|9| 290/296 [00:18<00:00, 15.84itNormalizing and saving training data: 100%|#| 296/296 [00:18<00:00, 16.23it
2025-11-20 13:37:46,434 - INFO - Training data processing completed during stats computation phase
2025-11-20 13:37:46,440 - INFO - Loaded normalization statistics:
2025-11-20 13:37:46,440 - INFO -   Mean: -0.018582
2025-11-20 13:37:46,440 - INFO -   Std: 2.514945
2025-11-20 13:37:46,441 - INFO - Split train already completed, skipping
2025-11-20 13:37:46,441 - INFO - Processing test split...
2025-11-20 13:37:46,441 - INFO - Need to process 22/22 sequences for test
2025-11-20 13:37:46,441 - INFO - Processing 22 sequences from 9 unique files
2025-11-20 13:37:46,441 - INFO - Average 2.4 sequences per file
Processing test:   0%|                              | 0/22 [00:00<?, ?it/s]Processing test:   5%|#                     | 1/22 [00:00<00:16,  1.31it/s]Processing test:  14%|###                   | 3/22 [00:01<00:06,  2.97it/s]Processing test:  18%|####                  | 4/22 [00:01<00:07,  2.56it/s]2025-11-20 13:37:48,072 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold1\test_dataset.h5
2025-11-20 13:37:48,913 - INFO - Progress: 310/318 (97.5%) - ETA: 0.0 minutes
Processing test:  68%|##############3      | 15/22 [00:03<00:01,  4.15it/s]Processing test:  77%|################2    | 17/22 [00:04<00:01,  4.28it/s]Processing test:  82%|#################1   | 18/22 [00:04<00:00,  4.11it/s]Processing test:  86%|##################1  | 19/22 [00:05<00:01,  2.80it/s]Processing test:  95%|#################### | 21/22 [00:06<00:00,  3.23it/s]Processing test: 100%|#####################| 22/22 [00:06<00:00,  3.12it/s]Processing test: 100%|#####################| 22/22 [00:06<00:00,  3.38it/s]
2025-11-20 13:37:53,469 - INFO - Validating final datasets...
2025-11-20 13:37:53,476 - INFO - train dataset validation:
2025-11-20 13:37:53,476 - INFO -   - Segments: 296
2025-11-20 13:37:53,476 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:37:53,476 - INFO -   - Classes: 148 preictal, 148 interictal
2025-11-20 13:37:53,476 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:37:53,481 - INFO - test dataset validation:
2025-11-20 13:37:53,481 - INFO -   - Segments: 22
2025-11-20 13:37:53,481 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:37:53,481 - INFO -   - Classes: 11 preictal, 11 interictal
2025-11-20 13:37:53,481 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:37:53,481 - INFO - ============================================================
2025-11-20 13:37:53,481 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 13:37:53,481 - INFO - Total time: 0.9 minutes
2025-11-20 13:37:53,481 - INFO - Processed segments: 318
2025-11-20 13:37:53,481 - INFO - Average rate: 6.1 segments/second
2025-11-20 13:37:53,481 - INFO - ============================================================
✅ Fold 1 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 2/7
============================================================
2025-11-20 13:37:53,561 - INFO - ============================================================
2025-11-20 13:37:53,561 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 13:37:53,561 - INFO - ============================================================
2025-11-20 13:37:53,561 - INFO - Output prefix: chb14_fold2
2025-11-20 13:37:53,561 - INFO - EEG Preprocessor initialized
2025-11-20 13:37:53,561 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 13:37:53,561 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 13:37:53,561 - INFO - Segment duration: 5 seconds
2025-11-20 13:37:53,561 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 13:37:53,561 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 13:37:53,561 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 13:37:53,562 - INFO - Loading segments from chb14_fold2_sequences_prediction.json
2025-11-20 13:37:53,573 - INFO - Loaded 344 total sequences
2025-11-20 13:37:53,573 - INFO - Channel validation (from segmentation): 26/26 files valid
2025-11-20 13:37:53,573 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 13:37:53,573 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 13:37:53,573 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 13:37:53,573 - INFO - train: 296 sequences (148 preictal, 148 interictal)
2025-11-20 13:37:53,573 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-20 13:37:53,591 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 13:37:53,592 - INFO - train: kept 148 preictal and 148 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:37:53,592 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:37:53,609 - INFO - ============================================================
2025-11-20 13:37:53,609 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 13:37:53,610 - INFO - ============================================================
2025-11-20 13:37:53,610 - INFO - Processing 296 training samples to compute normalization stats...
2025-11-20 13:37:53,610 - INFO - Processing 296 sequences from 20 unique files
Processing training data:   0%|                    | 0/296 [00:00<?, ?it/s]Processing training data:   0%|            | 1/296 [00:00<02:57,  1.66it/s]Processing training data:   8%|8          | 24/296 [00:02<00:22, 11.95it/s]Processing training data:  11%|#2         | 34/296 [00:03<00:29,  8.75it/s]Processing training data:  17%|#8         | 49/296 [00:05<00:28,  8.80it/s]Processing training data:  20%|##1        | 59/296 [00:07<00:31,  7.60it/s]Processing training data:  24%|##6        | 71/296 [00:08<00:30,  7.41it/s]Processing training data:  29%|###1       | 85/296 [00:10<00:24,  8.46it/s]Processing training data:  32%|###5       | 96/296 [00:10<00:20,  9.93it/s]Processing training data:  41%|####      | 120/296 [00:11<00:11, 15.52it/s]Processing training data:  47%|####7     | 140/296 [00:12<00:10, 15.25it/s]Processing training data:  50%|####9     | 147/296 [00:14<00:13, 10.74it/s]Processing training data:  55%|#####4    | 162/296 [00:15<00:10, 12.99it/s]Processing training data:  62%|######2   | 184/296 [00:15<00:06, 17.21it/s]Processing training data:  70%|#######   | 208/296 [00:16<00:04, 20.91it/s]Processing training data:  82%|########2 | 243/296 [00:17<00:01, 26.69it/s]Processing training data:  84%|########3 | 248/296 [00:18<00:02, 17.92it/s]Processing training data:  87%|########6 | 257/296 [00:20<00:03, 12.66it/s]Processing training data:  92%|#########1| 271/296 [00:21<00:02, 11.34it/s]Processing training data:  95%|#########5| 282/296 [00:23<00:01, 10.17it/s]Processing training data:  97%|#########6| 287/296 [00:24<00:01,  8.22it/s]Processing training data: 100%|##########| 296/296 [00:24<00:00, 11.99it/s]
2025-11-20 13:38:18,307 - INFO - Computing normalization statistics from training data...
2025-11-20 13:38:18,876 - INFO - Normalization stats computed:
2025-11-20 13:38:18,876 - INFO -   Mean: -0.016110
2025-11-20 13:38:18,876 - INFO -   Std: 2.518634
2025-11-20 13:38:18,876 - INFO -   Saved to: preprocessing\checkpoints\chb14_fold2\normalization_stats.json
2025-11-20 13:38:18,929 - INFO - Applying normalization and saving 296 training sequences...
Normalizing and saving training data:   0%|        | 0/296 [00:00<?, ?it/s]2025-11-20 13:38:18,939 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold2\train_dataset.h5
Normalizing and saving training data:   3%| | 10/296 [00:00<00:17, 16.10it/Normalizing and saving training data:   7%| | 20/296 [00:01<00:17, 15.83it/Normalizing and saving training data:  10%|1| 30/296 [00:01<00:16, 15.83it/Normalizing and saving training data:  14%|1| 40/296 [00:02<00:16, 15.87it/Normalizing and saving training data:  17%|1| 50/296 [00:03<00:15, 15.88it/Normalizing and saving training data:  20%|2| 60/296 [00:03<00:14, 15.89it/Normalizing and saving training data:  24%|2| 70/296 [00:04<00:14, 15.87it/Normalizing and saving training data:  27%|2| 80/296 [00:05<00:13, 15.91it/Normalizing and saving training data:  30%|3| 90/296 [00:05<00:12, 15.92it/Normalizing and saving training data:  34%|3| 100/296 [00:06<00:12, 15.94itNormalizing and saving training data:  37%|3| 110/296 [00:06<00:11, 15.94itNormalizing and saving training data:  41%|4| 120/296 [00:07<00:11, 15.94itNormalizing and saving training data:  44%|4| 130/296 [00:08<00:10, 15.94itNormalizing and saving training data:  47%|4| 140/296 [00:08<00:09, 15.87itNormalizing and saving training data:  51%|5| 150/296 [00:09<00:09, 15.81itNormalizing and saving training data:  54%|5| 160/296 [00:10<00:08, 15.79itNormalizing and saving training data:  57%|5| 170/296 [00:10<00:08, 15.60itNormalizing and saving training data:  61%|6| 180/296 [00:11<00:07, 15.59itNormalizing and saving training data:  64%|6| 190/296 [00:12<00:06, 15.59itNormalizing and saving training data:  68%|6| 200/296 [00:12<00:06, 15.59itNormalizing and saving training data:  71%|7| 210/296 [00:13<00:05, 15.63itNormalizing and saving training data:  74%|7| 220/296 [00:13<00:04, 15.65itNormalizing and saving training data:  78%|7| 230/296 [00:14<00:04, 15.66itNormalizing and saving training data:  81%|8| 240/296 [00:15<00:03, 15.67itNormalizing and saving training data:  84%|8| 250/296 [00:15<00:02, 15.69itNormalizing and saving training data:  88%|8| 260/296 [00:16<00:02, 15.60itNormalizing and saving training data:  91%|9| 270/296 [00:17<00:01, 15.60itNormalizing and saving training data:  95%|9| 280/296 [00:17<00:01, 15.62itNormalizing and saving training data:  98%|9| 290/296 [00:18<00:00, 15.62itNormalizing and saving training data: 100%|#| 296/296 [00:18<00:00, 16.07it
2025-11-20 13:38:37,759 - INFO - Training data processing completed during stats computation phase
2025-11-20 13:38:37,766 - INFO - Loaded normalization statistics:
2025-11-20 13:38:37,766 - INFO -   Mean: -0.016110
2025-11-20 13:38:37,766 - INFO -   Std: 2.518634
2025-11-20 13:38:37,766 - INFO - Split train already completed, skipping
2025-11-20 13:38:37,766 - INFO - Processing test split...
2025-11-20 13:38:37,766 - INFO - Need to process 48/48 sequences for test
2025-11-20 13:38:37,766 - INFO - Processing 48 sequences from 15 unique files
2025-11-20 13:38:37,766 - INFO - Average 3.2 sequences per file
Processing test:   0%|                              | 0/48 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/48 [00:00<00:33,  1.41it/s]2025-11-20 13:38:38,479 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold2\test_dataset.h5
2025-11-20 13:38:39,934 - INFO - Progress: 320/344 (93.0%) - ETA: 0.1 minutes
Processing test:  52%|##########9          | 25/48 [00:02<00:02,  9.24it/s]Processing test:  56%|###########8         | 27/48 [00:03<00:03,  6.51it/s]Processing test:  60%|############6        | 29/48 [00:04<00:02,  6.43it/s]Processing test:  62%|#############1       | 30/48 [00:05<00:04,  3.91it/s]Processing test:  69%|##############4      | 33/48 [00:06<00:03,  4.33it/s]2025-11-20 13:38:44,537 - INFO - Progress: 330/344 (95.9%) - ETA: 0.0 minutes
Processing test:  73%|###############3     | 35/48 [00:07<00:04,  3.09it/s]Processing test:  79%|################6    | 38/48 [00:07<00:02,  3.79it/s]Processing test:  81%|#################    | 39/48 [00:08<00:02,  3.57it/s]Processing test:  85%|#################9   | 41/48 [00:08<00:01,  3.90it/s]Processing test:  88%|##################3  | 42/48 [00:09<00:01,  3.62it/s]Processing test:  90%|##################8  | 43/48 [00:09<00:01,  3.50it/s]Processing test:  92%|###################2 | 44/48 [00:10<00:01,  2.06it/s]2025-11-20 13:38:49,142 - INFO - Progress: 342/344 (99.4%) - ETA: 0.0 minutes
Processing test:  98%|####################5| 47/48 [00:11<00:00,  2.34it/s]Processing test: 100%|#####################| 48/48 [00:12<00:00,  2.38it/s]Processing test: 100%|#####################| 48/48 [00:12<00:00,  3.96it/s]
2025-11-20 13:38:50,039 - INFO - Validating final datasets...
2025-11-20 13:38:50,047 - INFO - train dataset validation:
2025-11-20 13:38:50,047 - INFO -   - Segments: 296
2025-11-20 13:38:50,047 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:38:50,047 - INFO -   - Classes: 148 preictal, 148 interictal
2025-11-20 13:38:50,047 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:38:50,052 - INFO - test dataset validation:
2025-11-20 13:38:50,052 - INFO -   - Segments: 48
2025-11-20 13:38:50,052 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:38:50,052 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-20 13:38:50,052 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:38:50,052 - INFO - ============================================================
2025-11-20 13:38:50,052 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 13:38:50,052 - INFO - Total time: 0.9 minutes
2025-11-20 13:38:50,052 - INFO - Processed segments: 344
2025-11-20 13:38:50,052 - INFO - Average rate: 6.1 segments/second
2025-11-20 13:38:50,052 - INFO - ============================================================
✅ Fold 2 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 3/7
============================================================
2025-11-20 13:38:50,132 - INFO - ============================================================
2025-11-20 13:38:50,132 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 13:38:50,132 - INFO - ============================================================
2025-11-20 13:38:50,132 - INFO - Output prefix: chb14_fold3
2025-11-20 13:38:50,132 - INFO - EEG Preprocessor initialized
2025-11-20 13:38:50,132 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 13:38:50,132 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 13:38:50,132 - INFO - Segment duration: 5 seconds
2025-11-20 13:38:50,132 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 13:38:50,132 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 13:38:50,132 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 13:38:50,133 - INFO - Loading segments from chb14_fold3_sequences_prediction.json
2025-11-20 13:38:50,144 - INFO - Loaded 342 total sequences
2025-11-20 13:38:50,144 - INFO - Channel validation (from segmentation): 26/26 files valid
2025-11-20 13:38:50,144 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 13:38:50,144 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 13:38:50,144 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 13:38:50,144 - INFO - train: 296 sequences (148 preictal, 148 interictal)
2025-11-20 13:38:50,144 - INFO - test: 46 sequences (23 preictal, 23 interictal)
2025-11-20 13:38:50,162 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 13:38:50,162 - INFO - train: kept 148 preictal and 148 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:38:50,162 - INFO - test: kept 23 preictal and 23 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:38:50,180 - INFO - ============================================================
2025-11-20 13:38:50,180 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 13:38:50,180 - INFO - ============================================================
2025-11-20 13:38:50,180 - INFO - Processing 296 training samples to compute normalization stats...
2025-11-20 13:38:50,180 - INFO - Processing 296 sequences from 19 unique files
Processing training data:   0%|                    | 0/296 [00:00<?, ?it/s]Processing training data:   0%|            | 1/296 [00:00<02:57,  1.66it/s]Processing training data:   8%|9          | 25/296 [00:01<00:10, 25.38it/s]Processing training data:  15%|#6         | 44/296 [00:02<00:16, 15.03it/s]Processing training data:  20%|##1        | 58/296 [00:04<00:20, 11.54it/s]Processing training data:  25%|##7        | 73/296 [00:05<00:18, 11.83it/s]Processing training data:  45%|####4     | 132/296 [00:06<00:05, 28.34it/s]Processing training data:  52%|#####2    | 154/296 [00:08<00:06, 21.41it/s]Processing training data:  57%|#####6    | 168/296 [00:09<00:06, 18.51it/s]Processing training data:  60%|######    | 178/296 [00:10<00:06, 17.75it/s]Processing training data:  68%|######8   | 202/296 [00:11<00:05, 16.57it/s]Processing training data:  73%|#######2  | 215/296 [00:13<00:05, 13.55it/s]Processing training data:  77%|#######7  | 228/296 [00:14<00:05, 11.72it/s]Processing training data:  81%|########  | 239/296 [00:16<00:05, 10.46it/s]Processing training data:  83%|########3 | 247/296 [00:17<00:05,  9.14it/s]Processing training data:  86%|########6 | 256/296 [00:18<00:04,  8.74it/s]Processing training data:  90%|########9 | 266/296 [00:20<00:03,  8.22it/s]Processing training data:  93%|#########2| 274/296 [00:21<00:03,  7.07it/s]Processing training data:  96%|#########5| 284/296 [00:23<00:01,  6.73it/s]Processing training data:  99%|#########8| 292/296 [00:24<00:00,  7.28it/s]Processing training data: 100%|##########| 296/296 [00:24<00:00, 12.15it/s]
2025-11-20 13:39:14,544 - INFO - Computing normalization statistics from training data...
2025-11-20 13:39:15,040 - INFO - Normalization stats computed:
2025-11-20 13:39:15,040 - INFO -   Mean: -0.017765
2025-11-20 13:39:15,040 - INFO -   Std: 2.522263
2025-11-20 13:39:15,040 - INFO -   Saved to: preprocessing\checkpoints\chb14_fold3\normalization_stats.json
2025-11-20 13:39:15,093 - INFO - Applying normalization and saving 296 training sequences...
Normalizing and saving training data:   0%|        | 0/296 [00:00<?, ?it/s]2025-11-20 13:39:15,101 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold3\train_dataset.h5
Normalizing and saving training data:   3%| | 10/296 [00:00<00:17, 16.37it/Normalizing and saving training data:   7%| | 20/296 [00:01<00:17, 16.12it/Normalizing and saving training data:  10%|1| 30/296 [00:01<00:16, 16.09it/Normalizing and saving training data:  14%|1| 40/296 [00:02<00:15, 16.03it/Normalizing and saving training data:  17%|1| 50/296 [00:03<00:15, 16.07it/Normalizing and saving training data:  20%|2| 60/296 [00:03<00:14, 16.04it/Normalizing and saving training data:  24%|2| 70/296 [00:04<00:14, 16.05it/Normalizing and saving training data:  27%|2| 80/296 [00:04<00:13, 16.05it/Normalizing and saving training data:  30%|3| 90/296 [00:05<00:12, 16.07it/Normalizing and saving training data:  34%|3| 100/296 [00:06<00:12, 16.09itNormalizing and saving training data:  37%|3| 110/296 [00:06<00:11, 16.08itNormalizing and saving training data:  41%|4| 120/296 [00:07<00:10, 16.08itNormalizing and saving training data:  44%|4| 130/296 [00:08<00:10, 16.06itNormalizing and saving training data:  47%|4| 140/296 [00:08<00:09, 15.99itNormalizing and saving training data:  51%|5| 150/296 [00:09<00:09, 15.96itNormalizing and saving training data:  54%|5| 160/296 [00:09<00:08, 15.95itNormalizing and saving training data:  57%|5| 170/296 [00:10<00:07, 15.94itNormalizing and saving training data:  61%|6| 180/296 [00:11<00:07, 15.94itNormalizing and saving training data:  64%|6| 190/296 [00:11<00:06, 15.88itNormalizing and saving training data:  68%|6| 200/296 [00:12<00:06, 15.88itNormalizing and saving training data:  71%|7| 210/296 [00:13<00:05, 15.87itNormalizing and saving training data:  74%|7| 220/296 [00:13<00:04, 15.86itNormalizing and saving training data:  78%|7| 230/296 [00:14<00:04, 15.81itNormalizing and saving training data:  81%|8| 240/296 [00:15<00:03, 15.82itNormalizing and saving training data:  84%|8| 250/296 [00:15<00:02, 15.80itNormalizing and saving training data:  88%|8| 260/296 [00:16<00:02, 15.84itNormalizing and saving training data:  91%|9| 270/296 [00:16<00:01, 15.84itNormalizing and saving training data:  95%|9| 280/296 [00:17<00:01, 15.87itNormalizing and saving training data:  98%|9| 290/296 [00:18<00:00, 15.90itNormalizing and saving training data: 100%|#| 296/296 [00:18<00:00, 16.28it
2025-11-20 13:39:33,678 - INFO - Training data processing completed during stats computation phase
2025-11-20 13:39:33,685 - INFO - Loaded normalization statistics:
2025-11-20 13:39:33,685 - INFO -   Mean: -0.017765
2025-11-20 13:39:33,685 - INFO -   Std: 2.522263
2025-11-20 13:39:33,685 - INFO - Split train already completed, skipping
2025-11-20 13:39:33,685 - INFO - Processing test split...
2025-11-20 13:39:33,685 - INFO - Need to process 46/46 sequences for test
2025-11-20 13:39:33,685 - INFO - Processing 46 sequences from 13 unique files
2025-11-20 13:39:33,685 - INFO - Average 3.5 sequences per file
Processing test:   0%|                              | 0/46 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/46 [00:00<00:31,  1.44it/s]2025-11-20 13:39:34,382 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold3\test_dataset.h5
2025-11-20 13:39:35,750 - INFO - Progress: 319/342 (93.3%) - ETA: 0.1 minutes
Processing test:  52%|##########9          | 24/46 [00:03<00:02,  7.34it/s]Processing test:  63%|#############2       | 29/46 [00:03<00:02,  8.17it/s]Processing test:  65%|#############6       | 30/46 [00:04<00:02,  7.23it/s]Processing test:  67%|##############1      | 31/46 [00:04<00:02,  6.43it/s]Processing test:  70%|##############6      | 32/46 [00:05<00:04,  3.49it/s]2025-11-20 13:39:40,330 - INFO - Progress: 330/342 (96.5%) - ETA: 0.0 minutes
Processing test:  76%|###############9     | 35/46 [00:06<00:03,  3.31it/s]Processing test:  78%|################4    | 36/46 [00:07<00:03,  2.53it/s]Processing test:  87%|##################2  | 40/46 [00:08<00:01,  3.46it/s]Processing test:  91%|###################1 | 42/46 [00:09<00:01,  2.60it/s]Processing test:  96%|#################### | 44/46 [00:10<00:00,  3.02it/s]2025-11-20 13:39:44,616 - INFO - Progress: 340/342 (99.4%) - ETA: 0.0 minutes
Processing test:  98%|####################5| 45/46 [00:11<00:00,  2.34it/s]Processing test: 100%|#####################| 46/46 [00:11<00:00,  2.42it/s]Processing test: 100%|#####################| 46/46 [00:11<00:00,  3.95it/s]
2025-11-20 13:39:45,487 - INFO - Validating final datasets...
2025-11-20 13:39:45,494 - INFO - train dataset validation:
2025-11-20 13:39:45,494 - INFO -   - Segments: 296
2025-11-20 13:39:45,494 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:39:45,494 - INFO -   - Classes: 148 preictal, 148 interictal
2025-11-20 13:39:45,494 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:39:45,499 - INFO - test dataset validation:
2025-11-20 13:39:45,499 - INFO -   - Segments: 46
2025-11-20 13:39:45,499 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:39:45,499 - INFO -   - Classes: 23 preictal, 23 interictal
2025-11-20 13:39:45,499 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:39:45,500 - INFO - ============================================================
2025-11-20 13:39:45,500 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 13:39:45,500 - INFO - Total time: 0.9 minutes
2025-11-20 13:39:45,500 - INFO - Processed segments: 342
2025-11-20 13:39:45,500 - INFO - Average rate: 6.2 segments/second
2025-11-20 13:39:45,500 - INFO - ============================================================
✅ Fold 3 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 4/7
============================================================
2025-11-20 13:39:45,578 - INFO - ============================================================
2025-11-20 13:39:45,578 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 13:39:45,578 - INFO - ============================================================
2025-11-20 13:39:45,579 - INFO - Output prefix: chb14_fold4
2025-11-20 13:39:45,579 - INFO - EEG Preprocessor initialized
2025-11-20 13:39:45,579 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 13:39:45,579 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 13:39:45,579 - INFO - Segment duration: 5 seconds
2025-11-20 13:39:45,579 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 13:39:45,579 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 13:39:45,579 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 13:39:45,579 - INFO - Loading segments from chb14_fold4_sequences_prediction.json
2025-11-20 13:39:45,590 - INFO - Loaded 336 total sequences
2025-11-20 13:39:45,590 - INFO - Channel validation (from segmentation): 26/26 files valid
2025-11-20 13:39:45,590 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 13:39:45,590 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 13:39:45,590 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 13:39:45,590 - INFO - train: 296 sequences (148 preictal, 148 interictal)
2025-11-20 13:39:45,591 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-20 13:39:45,608 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 13:39:45,608 - INFO - train: kept 148 preictal and 148 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:39:45,608 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:39:45,626 - INFO - ============================================================
2025-11-20 13:39:45,626 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 13:39:45,626 - INFO - ============================================================
2025-11-20 13:39:45,626 - INFO - Processing 296 training samples to compute normalization stats...
2025-11-20 13:39:45,626 - INFO - Processing 296 sequences from 19 unique files
Processing training data:   0%|                    | 0/296 [00:00<?, ?it/s]Processing training data:   0%|            | 1/296 [00:00<03:03,  1.60it/s]Processing training data:   8%|9          | 25/296 [00:02<00:22, 12.13it/s]Processing training data:  12%|#3         | 37/296 [00:03<00:25,  9.96it/s]Processing training data:  16%|#7         | 46/296 [00:05<00:31,  8.02it/s]Processing training data:  20%|##1        | 58/296 [00:06<00:27,  8.65it/s]Processing training data:  39%|###8      | 114/296 [00:07<00:07, 24.04it/s]Processing training data:  46%|####6     | 137/296 [00:08<00:06, 22.94it/s]Processing training data:  49%|####9     | 146/296 [00:09<00:08, 17.54it/s]Processing training data:  52%|#####2    | 154/296 [00:11<00:11, 12.15it/s]Processing training data:  56%|#####6    | 167/296 [00:13<00:12, 10.53it/s]Processing training data:  60%|######    | 178/296 [00:14<00:11, 10.23it/s]Processing training data:  64%|######4   | 190/296 [00:15<00:10,  9.87it/s]Processing training data:  68%|######7   | 200/296 [00:17<00:11,  8.53it/s]Processing training data:  71%|#######   | 210/296 [00:18<00:11,  7.67it/s]Processing training data:  75%|#######5  | 222/296 [00:19<00:07,  9.31it/s]Processing training data:  82%|########2 | 243/296 [00:20<00:04, 12.76it/s]Processing training data:  84%|########4 | 250/296 [00:21<00:03, 12.37it/s]Processing training data:  93%|#########2| 274/296 [00:22<00:01, 13.25it/s]Processing training data:  98%|#########7| 290/296 [00:24<00:00, 11.93it/s]Processing training data: 100%|##########| 296/296 [00:24<00:00, 12.15it/s]
2025-11-20 13:40:09,996 - INFO - Computing normalization statistics from training data...
2025-11-20 13:40:10,486 - INFO - Normalization stats computed:
2025-11-20 13:40:10,486 - INFO -   Mean: -0.001295
2025-11-20 13:40:10,486 - INFO -   Std: 2.514137
2025-11-20 13:40:10,486 - INFO -   Saved to: preprocessing\checkpoints\chb14_fold4\normalization_stats.json
2025-11-20 13:40:10,539 - INFO - Applying normalization and saving 296 training sequences...
Normalizing and saving training data:   0%|        | 0/296 [00:00<?, ?it/s]2025-11-20 13:40:10,549 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold4\train_dataset.h5
Normalizing and saving training data:   3%| | 10/296 [00:00<00:17, 16.11it/Normalizing and saving training data:   7%| | 20/296 [00:01<00:17, 16.05it/Normalizing and saving training data:  10%|1| 30/296 [00:01<00:16, 16.12it/Normalizing and saving training data:  14%|1| 40/296 [00:02<00:15, 16.14it/Normalizing and saving training data:  17%|1| 50/296 [00:03<00:15, 16.14it/Normalizing and saving training data:  20%|2| 60/296 [00:03<00:14, 16.13it/Normalizing and saving training data:  24%|2| 70/296 [00:04<00:14, 16.03it/Normalizing and saving training data:  27%|2| 80/296 [00:04<00:13, 16.03it/Normalizing and saving training data:  30%|3| 90/296 [00:05<00:12, 16.09it/Normalizing and saving training data:  34%|3| 100/296 [00:06<00:12, 16.07itNormalizing and saving training data:  37%|3| 110/296 [00:06<00:11, 16.08itNormalizing and saving training data:  41%|4| 120/296 [00:07<00:10, 16.08itNormalizing and saving training data:  44%|4| 130/296 [00:08<00:10, 16.11itNormalizing and saving training data:  47%|4| 140/296 [00:08<00:09, 16.07itNormalizing and saving training data:  51%|5| 150/296 [00:09<00:09, 15.86itNormalizing and saving training data:  54%|5| 160/296 [00:09<00:08, 15.90itNormalizing and saving training data:  57%|5| 170/296 [00:10<00:07, 15.92itNormalizing and saving training data:  61%|6| 180/296 [00:11<00:07, 15.93itNormalizing and saving training data:  64%|6| 190/296 [00:11<00:06, 15.85itNormalizing and saving training data:  68%|6| 200/296 [00:12<00:06, 15.88itNormalizing and saving training data:  71%|7| 210/296 [00:13<00:05, 15.89itNormalizing and saving training data:  74%|7| 220/296 [00:13<00:04, 15.89itNormalizing and saving training data:  78%|7| 230/296 [00:14<00:04, 15.86itNormalizing and saving training data:  81%|8| 240/296 [00:15<00:03, 15.87itNormalizing and saving training data:  84%|8| 250/296 [00:15<00:02, 15.83itNormalizing and saving training data:  88%|8| 260/296 [00:16<00:02, 15.83itNormalizing and saving training data:  91%|9| 270/296 [00:16<00:01, 15.83itNormalizing and saving training data:  95%|9| 280/296 [00:17<00:01, 15.76itNormalizing and saving training data:  98%|9| 290/296 [00:18<00:00, 15.76itNormalizing and saving training data: 100%|#| 296/296 [00:18<00:00, 16.27it
2025-11-20 13:40:29,154 - INFO - Training data processing completed during stats computation phase
2025-11-20 13:40:29,161 - INFO - Loaded normalization statistics:
2025-11-20 13:40:29,161 - INFO -   Mean: -0.001295
2025-11-20 13:40:29,161 - INFO -   Std: 2.514137
2025-11-20 13:40:29,161 - INFO - Split train already completed, skipping
2025-11-20 13:40:29,161 - INFO - Processing test split...
2025-11-20 13:40:29,162 - INFO - Need to process 40/40 sequences for test
2025-11-20 13:40:29,162 - INFO - Processing 40 sequences from 12 unique files
2025-11-20 13:40:29,162 - INFO - Average 3.3 sequences per file
Processing test:   0%|                              | 0/40 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/40 [00:01<00:43,  1.11s/it]Processing test:  10%|##2                   | 4/40 [00:01<00:11,  3.22it/s]Processing test:  12%|##7                   | 5/40 [00:02<00:13,  2.52it/s]2025-11-20 13:40:31,264 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold4\test_dataset.h5
2025-11-20 13:40:32,692 - INFO - Progress: 320/336 (95.2%) - ETA: 0.0 minutes
Processing test:  62%|#############1       | 25/40 [00:05<00:02,  5.64it/s]Processing test:  72%|###############2     | 29/40 [00:05<00:01,  5.71it/s]Processing test:  78%|################2    | 31/40 [00:06<00:01,  5.67it/s]Processing test:  80%|################8    | 32/40 [00:06<00:01,  5.20it/s]Processing test:  82%|#################3   | 33/40 [00:07<00:01,  4.38it/s]2025-11-20 13:40:36,814 - INFO - Progress: 330/336 (98.2%) - ETA: 0.0 minutes
Processing test:  88%|##################3  | 35/40 [00:08<00:01,  3.00it/s]Processing test:  92%|###################4 | 37/40 [00:09<00:01,  2.61it/s]Processing test:  98%|####################4| 39/40 [00:09<00:00,  3.04it/s]Processing test: 100%|#####################| 40/40 [00:10<00:00,  3.00it/s]Processing test: 100%|#####################| 40/40 [00:10<00:00,  3.93it/s]
2025-11-20 13:40:39,738 - INFO - Validating final datasets...
2025-11-20 13:40:39,746 - INFO - train dataset validation:
2025-11-20 13:40:39,746 - INFO -   - Segments: 296
2025-11-20 13:40:39,746 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:40:39,746 - INFO -   - Classes: 148 preictal, 148 interictal
2025-11-20 13:40:39,746 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:40:39,751 - INFO - test dataset validation:
2025-11-20 13:40:39,751 - INFO -   - Segments: 40
2025-11-20 13:40:39,752 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:40:39,752 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-20 13:40:39,752 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:40:39,752 - INFO - ============================================================
2025-11-20 13:40:39,752 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 13:40:39,752 - INFO - Total time: 0.9 minutes
2025-11-20 13:40:39,752 - INFO - Processed segments: 336
2025-11-20 13:40:39,752 - INFO - Average rate: 6.2 segments/second
2025-11-20 13:40:39,752 - INFO - ============================================================
✅ Fold 4 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 5/7
============================================================
2025-11-20 13:40:39,834 - INFO - ============================================================
2025-11-20 13:40:39,834 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 13:40:39,834 - INFO - ============================================================
2025-11-20 13:40:39,834 - INFO - Output prefix: chb14_fold5
2025-11-20 13:40:39,834 - INFO - EEG Preprocessor initialized
2025-11-20 13:40:39,834 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 13:40:39,834 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 13:40:39,834 - INFO - Segment duration: 5 seconds
2025-11-20 13:40:39,834 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 13:40:39,834 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 13:40:39,834 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 13:40:39,834 - INFO - Loading segments from chb14_fold5_sequences_prediction.json
2025-11-20 13:40:39,846 - INFO - Loaded 340 total sequences
2025-11-20 13:40:39,846 - INFO - Channel validation (from segmentation): 26/26 files valid
2025-11-20 13:40:39,846 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 13:40:39,846 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 13:40:39,846 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 13:40:39,846 - INFO - train: 296 sequences (148 preictal, 148 interictal)
2025-11-20 13:40:39,846 - INFO - test: 44 sequences (22 preictal, 22 interictal)
2025-11-20 13:40:39,864 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 13:40:39,864 - INFO - train: kept 148 preictal and 148 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:40:39,864 - INFO - test: kept 22 preictal and 22 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:40:39,882 - INFO - ============================================================
2025-11-20 13:40:39,882 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 13:40:39,882 - INFO - ============================================================
2025-11-20 13:40:39,882 - INFO - Processing 296 training samples to compute normalization stats...
2025-11-20 13:40:39,883 - INFO - Processing 296 sequences from 19 unique files
Processing training data:   0%|                    | 0/296 [00:00<?, ?it/s]Processing training data:   0%|            | 1/296 [00:01<06:49,  1.39s/it]Processing training data:   4%|4          | 12/296 [00:02<00:49,  5.69it/s]Processing training data:   7%|8          | 22/296 [00:03<00:31,  8.61it/s]Processing training data:  15%|#6         | 45/296 [00:04<00:20, 12.39it/s]Processing training data:  20%|##1        | 58/296 [00:05<00:17, 13.99it/s]Processing training data:  28%|###        | 82/296 [00:05<00:10, 20.13it/s]Processing training data:  36%|###5      | 106/296 [00:07<00:10, 18.67it/s]Processing training data:  39%|###9      | 116/296 [00:08<00:13, 13.84it/s]Processing training data:  43%|####3     | 128/296 [00:10<00:15, 11.14it/s]Processing training data:  47%|####6     | 139/296 [00:11<00:15, 10.40it/s]Processing training data:  67%|######6   | 197/296 [00:13<00:04, 20.15it/s]Processing training data:  70%|######9   | 207/296 [00:14<00:05, 15.08it/s]Processing training data:  75%|#######4  | 221/296 [00:16<00:05, 13.42it/s]Processing training data:  78%|#######7  | 230/296 [00:17<00:05, 11.16it/s]Processing training data:  82%|########1 | 242/296 [00:19<00:05, 10.43it/s]Processing training data:  85%|########5 | 252/296 [00:19<00:03, 11.31it/s]Processing training data:  92%|#########1| 271/296 [00:21<00:02, 11.62it/s]Processing training data:  96%|#########5| 284/296 [00:22<00:00, 12.25it/s]Processing training data:  98%|#########7| 289/296 [00:24<00:00,  8.75it/s]Processing training data: 100%|##########| 296/296 [00:24<00:00, 12.33it/s]
2025-11-20 13:41:03,885 - INFO - Computing normalization statistics from training data...
2025-11-20 13:41:04,341 - INFO - Normalization stats computed:
2025-11-20 13:41:04,341 - INFO -   Mean: -0.016600
2025-11-20 13:41:04,341 - INFO -   Std: 2.528898
2025-11-20 13:41:04,341 - INFO -   Saved to: preprocessing\checkpoints\chb14_fold5\normalization_stats.json
2025-11-20 13:41:04,393 - INFO - Applying normalization and saving 296 training sequences...
Normalizing and saving training data:   0%|        | 0/296 [00:00<?, ?it/s]2025-11-20 13:41:04,402 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold5\train_dataset.h5
Normalizing and saving training data:   3%| | 10/296 [00:00<00:18, 15.82it/Normalizing and saving training data:   7%| | 20/296 [00:01<00:17, 15.85it/Normalizing and saving training data:  10%|1| 30/296 [00:01<00:17, 15.65it/Normalizing and saving training data:  14%|1| 40/296 [00:02<00:16, 15.58it/Normalizing and saving training data:  17%|1| 50/296 [00:03<00:16, 14.82it/Normalizing and saving training data:  20%|2| 60/296 [00:03<00:15, 14.97it/Normalizing and saving training data:  24%|2| 70/296 [00:04<00:14, 15.08it/Normalizing and saving training data:  27%|2| 80/296 [00:05<00:14, 15.17it/Normalizing and saving training data:  30%|3| 90/296 [00:05<00:13, 15.21it/Normalizing and saving training data:  34%|3| 100/296 [00:06<00:12, 15.23itNormalizing and saving training data:  37%|3| 110/296 [00:07<00:12, 15.30itNormalizing and saving training data:  41%|4| 120/296 [00:07<00:11, 15.40itNormalizing and saving training data:  44%|4| 130/296 [00:08<00:10, 15.46itNormalizing and saving training data:  47%|4| 140/296 [00:09<00:10, 15.44itNormalizing and saving training data:  51%|5| 150/296 [00:09<00:09, 15.44itNormalizing and saving training data:  54%|5| 160/296 [00:10<00:08, 15.32itNormalizing and saving training data:  57%|5| 170/296 [00:11<00:08, 15.33itNormalizing and saving training data:  61%|6| 180/296 [00:11<00:07, 15.29itNormalizing and saving training data:  64%|6| 190/296 [00:12<00:06, 15.28itNormalizing and saving training data:  68%|6| 200/296 [00:13<00:06, 15.32itNormalizing and saving training data:  71%|7| 210/296 [00:13<00:05, 15.35itNormalizing and saving training data:  74%|7| 220/296 [00:14<00:04, 15.39itNormalizing and saving training data:  78%|7| 230/296 [00:14<00:04, 15.43itNormalizing and saving training data:  81%|8| 240/296 [00:15<00:03, 15.44itNormalizing and saving training data:  84%|8| 250/296 [00:16<00:02, 15.45itNormalizing and saving training data:  88%|8| 260/296 [00:16<00:02, 15.42itNormalizing and saving training data:  91%|9| 270/296 [00:17<00:01, 15.42itNormalizing and saving training data:  95%|9| 280/296 [00:18<00:01, 15.39itNormalizing and saving training data:  98%|9| 290/296 [00:18<00:00, 15.40itNormalizing and saving training data: 100%|#| 296/296 [00:18<00:00, 15.66it
2025-11-20 13:41:23,699 - INFO - Training data processing completed during stats computation phase
2025-11-20 13:41:23,706 - INFO - Loaded normalization statistics:
2025-11-20 13:41:23,706 - INFO -   Mean: -0.016600
2025-11-20 13:41:23,706 - INFO -   Std: 2.528898
2025-11-20 13:41:23,707 - INFO - Split train already completed, skipping
2025-11-20 13:41:23,707 - INFO - Processing test split...
2025-11-20 13:41:23,707 - INFO - Need to process 44/44 sequences for test
2025-11-20 13:41:23,707 - INFO - Processing 44 sequences from 13 unique files
2025-11-20 13:41:23,707 - INFO - Average 3.4 sequences per file
Processing test:   0%|                              | 0/44 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/44 [00:01<00:49,  1.16s/it]Processing test:  11%|##5                   | 5/44 [00:01<00:12,  3.09it/s]2025-11-20 13:41:25,575 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold5\test_dataset.h5
2025-11-20 13:41:27,148 - INFO - Progress: 322/340 (94.7%) - ETA: 0.0 minutes
Processing test:  61%|############8        | 27/44 [00:04<00:02,  6.48it/s]Processing test:  68%|##############3      | 30/44 [00:05<00:02,  6.63it/s]Processing test:  70%|##############7      | 31/44 [00:05<00:02,  6.18it/s]Processing test:  73%|###############2     | 32/44 [00:05<00:02,  5.54it/s]Processing test:  75%|###############7     | 33/44 [00:06<00:02,  4.97it/s]Processing test:  77%|################2    | 34/44 [00:06<00:02,  4.52it/s]Processing test:  80%|################7    | 35/44 [00:07<00:02,  3.22it/s]2025-11-20 13:41:31,639 - INFO - Progress: 332/340 (97.6%) - ETA: 0.0 minutes
Processing test:  84%|#################6   | 37/44 [00:09<00:04,  1.74it/s]Processing test:  91%|###################  | 40/44 [00:10<00:02,  1.91it/s]Processing test:  95%|#################### | 42/44 [00:11<00:00,  2.29it/s]Processing test: 100%|#####################| 44/44 [00:11<00:00,  2.72it/s]Processing test: 100%|#####################| 44/44 [00:11<00:00,  3.74it/s]
2025-11-20 13:41:36,003 - INFO - Validating final datasets...
2025-11-20 13:41:36,011 - INFO - train dataset validation:
2025-11-20 13:41:36,011 - INFO -   - Segments: 296
2025-11-20 13:41:36,011 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:41:36,011 - INFO -   - Classes: 148 preictal, 148 interictal
2025-11-20 13:41:36,011 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:41:36,016 - INFO - test dataset validation:
2025-11-20 13:41:36,017 - INFO -   - Segments: 44
2025-11-20 13:41:36,017 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:41:36,017 - INFO -   - Classes: 22 preictal, 22 interictal
2025-11-20 13:41:36,017 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:41:36,017 - INFO - ============================================================
2025-11-20 13:41:36,017 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 13:41:36,017 - INFO - Total time: 0.9 minutes
2025-11-20 13:41:36,017 - INFO - Processed segments: 340
2025-11-20 13:41:36,017 - INFO - Average rate: 6.1 segments/second
2025-11-20 13:41:36,017 - INFO - ============================================================
✅ Fold 5 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 6/7
============================================================
2025-11-20 13:41:36,099 - INFO - ============================================================
2025-11-20 13:41:36,099 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 13:41:36,099 - INFO - ============================================================
2025-11-20 13:41:36,099 - INFO - Output prefix: chb14_fold6
2025-11-20 13:41:36,099 - INFO - EEG Preprocessor initialized
2025-11-20 13:41:36,099 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 13:41:36,099 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 13:41:36,099 - INFO - Segment duration: 5 seconds
2025-11-20 13:41:36,099 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 13:41:36,099 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 13:41:36,099 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 13:41:36,100 - INFO - Loading segments from chb14_fold6_sequences_prediction.json
2025-11-20 13:41:36,111 - INFO - Loaded 344 total sequences
2025-11-20 13:41:36,111 - INFO - Channel validation (from segmentation): 26/26 files valid
2025-11-20 13:41:36,111 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 13:41:36,111 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 13:41:36,111 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 13:41:36,111 - INFO - train: 296 sequences (148 preictal, 148 interictal)
2025-11-20 13:41:36,111 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-20 13:41:36,131 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 13:41:36,131 - INFO - train: kept 148 preictal and 148 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:41:36,131 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:41:36,150 - INFO - ============================================================
2025-11-20 13:41:36,150 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 13:41:36,150 - INFO - ============================================================
2025-11-20 13:41:36,150 - INFO - Processing 296 training samples to compute normalization stats...
2025-11-20 13:41:36,150 - INFO - Processing 296 sequences from 19 unique files
Processing training data:   0%|                    | 0/296 [00:00<?, ?it/s]Processing training data:   0%|            | 1/296 [00:01<08:16,  1.68s/it]Processing training data:   5%|5          | 16/296 [00:02<00:42,  6.59it/s]Processing training data:  25%|##7        | 75/296 [00:03<00:07, 30.31it/s]Processing training data:  33%|###6       | 99/296 [00:05<00:09, 21.86it/s]Processing training data:  37%|###6      | 109/296 [00:07<00:12, 14.93it/s]Processing training data:  42%|####1     | 123/296 [00:07<00:10, 16.17it/s]Processing training data:  49%|####9     | 146/296 [00:09<00:09, 15.52it/s]Processing training data:  53%|#####3    | 158/296 [00:10<00:10, 12.56it/s]Processing training data:  57%|#####6    | 168/296 [00:11<00:09, 13.19it/s]Processing training data:  64%|######4   | 190/296 [00:13<00:07, 13.48it/s]Processing training data:  68%|######8   | 202/296 [00:14<00:08, 11.65it/s]Processing training data:  72%|#######1  | 212/296 [00:16<00:08,  9.81it/s]Processing training data:  74%|#######4  | 220/296 [00:17<00:08,  9.13it/s]Processing training data:  76%|#######6  | 225/296 [00:18<00:08,  8.32it/s]Processing training data:  77%|#######7  | 229/296 [00:18<00:08,  7.95it/s]Processing training data:  84%|########4 | 249/296 [00:20<00:04,  9.40it/s]Processing training data:  89%|########8 | 263/296 [00:22<00:03,  9.17it/s]Processing training data:  94%|#########3| 277/296 [00:23<00:02,  8.73it/s]Processing training data:  98%|#########7| 290/296 [00:25<00:00,  9.23it/s]Processing training data: 100%|##########| 296/296 [00:25<00:00, 11.78it/s]
2025-11-20 13:42:01,282 - INFO - Computing normalization statistics from training data...
2025-11-20 13:42:01,824 - INFO - Normalization stats computed:
2025-11-20 13:42:01,824 - INFO -   Mean: -0.028950
2025-11-20 13:42:01,825 - INFO -   Std: 2.526145
2025-11-20 13:42:01,825 - INFO -   Saved to: preprocessing\checkpoints\chb14_fold6\normalization_stats.json
2025-11-20 13:42:01,883 - INFO - Applying normalization and saving 296 training sequences...
Normalizing and saving training data:   0%|        | 0/296 [00:00<?, ?it/s]2025-11-20 13:42:01,893 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold6\train_dataset.h5
Normalizing and saving training data:   3%| | 10/296 [00:00<00:17, 16.05it/Normalizing and saving training data:   7%| | 20/296 [00:01<00:17, 15.70it/Normalizing and saving training data:  10%|1| 30/296 [00:01<00:16, 15.70it/Normalizing and saving training data:  14%|1| 40/296 [00:02<00:16, 15.71it/Normalizing and saving training data:  17%|1| 50/296 [00:03<00:15, 15.73it/Normalizing and saving training data:  20%|2| 60/296 [00:03<00:14, 15.74it/Normalizing and saving training data:  24%|2| 70/296 [00:04<00:14, 15.72it/Normalizing and saving training data:  27%|2| 80/296 [00:05<00:13, 15.67it/Normalizing and saving training data:  30%|3| 90/296 [00:05<00:13, 15.69it/Normalizing and saving training data:  34%|3| 100/296 [00:06<00:12, 15.75itNormalizing and saving training data:  37%|3| 110/296 [00:06<00:11, 15.77itNormalizing and saving training data:  41%|4| 120/296 [00:07<00:11, 15.80itNormalizing and saving training data:  44%|4| 130/296 [00:08<00:10, 15.78itNormalizing and saving training data:  47%|4| 140/296 [00:08<00:09, 15.76itNormalizing and saving training data:  51%|5| 150/296 [00:09<00:09, 15.71itNormalizing and saving training data:  54%|5| 160/296 [00:10<00:08, 15.56itNormalizing and saving training data:  57%|5| 170/296 [00:10<00:08, 15.55itNormalizing and saving training data:  61%|6| 180/296 [00:11<00:07, 15.57itNormalizing and saving training data:  64%|6| 190/296 [00:12<00:06, 15.55itNormalizing and saving training data:  68%|6| 200/296 [00:12<00:06, 15.53itNormalizing and saving training data:  71%|7| 210/296 [00:13<00:05, 15.56itNormalizing and saving training data:  74%|7| 220/296 [00:14<00:04, 15.56itNormalizing and saving training data:  78%|7| 230/296 [00:14<00:04, 15.56itNormalizing and saving training data:  81%|8| 240/296 [00:15<00:03, 15.54itNormalizing and saving training data:  84%|8| 250/296 [00:15<00:02, 15.56itNormalizing and saving training data:  88%|8| 260/296 [00:16<00:02, 15.47itNormalizing and saving training data:  91%|9| 270/296 [00:17<00:01, 15.51itNormalizing and saving training data:  95%|9| 280/296 [00:17<00:01, 15.55itNormalizing and saving training data:  98%|9| 290/296 [00:18<00:00, 15.56itNormalizing and saving training data: 100%|#| 296/296 [00:18<00:00, 15.95it
2025-11-20 13:42:20,851 - INFO - Training data processing completed during stats computation phase
2025-11-20 13:42:20,857 - INFO - Loaded normalization statistics:
2025-11-20 13:42:20,857 - INFO -   Mean: -0.028950
2025-11-20 13:42:20,857 - INFO -   Std: 2.526145
2025-11-20 13:42:20,857 - INFO - Split train already completed, skipping
2025-11-20 13:42:20,857 - INFO - Processing test split...
2025-11-20 13:42:20,858 - INFO - Need to process 48/48 sequences for test
2025-11-20 13:42:20,858 - INFO - Processing 48 sequences from 13 unique files
2025-11-20 13:42:20,858 - INFO - Average 3.7 sequences per file
Processing test:   0%|                              | 0/48 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/48 [00:00<00:44,  1.06it/s]Processing test:   8%|#8                    | 4/48 [00:01<00:16,  2.75it/s]2025-11-20 13:42:22,491 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold6\test_dataset.h5
2025-11-20 13:42:24,121 - INFO - Progress: 323/344 (93.9%) - ETA: 0.1 minutes
Processing test:  58%|############2        | 28/48 [00:04<00:02,  6.90it/s]Processing test:  62%|#############1       | 30/48 [00:05<00:02,  6.42it/s]Processing test:  67%|##############       | 32/48 [00:06<00:03,  4.29it/s]Processing test:  71%|##############8      | 34/48 [00:07<00:03,  3.64it/s]Processing test:  77%|################1    | 37/48 [00:08<00:02,  4.19it/s]2025-11-20 13:42:29,541 - INFO - Progress: 333/344 (96.8%) - ETA: 0.0 minutes
Processing test:  79%|################6    | 38/48 [00:10<00:04,  2.17it/s]Processing test:  83%|#################5   | 40/48 [00:11<00:03,  2.21it/s]Processing test:  88%|##################3  | 42/48 [00:12<00:02,  2.32it/s]Processing test:  92%|###################2 | 44/48 [00:12<00:01,  2.78it/s]Processing test:  94%|###################6 | 45/48 [00:13<00:01,  2.13it/s]2025-11-20 13:42:34,872 - INFO - Progress: 343/344 (99.7%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 48/48 [00:14<00:00,  2.45it/s]Processing test: 100%|#####################| 48/48 [00:14<00:00,  3.35it/s]
2025-11-20 13:42:35,303 - INFO - Validating final datasets...
2025-11-20 13:42:35,311 - INFO - train dataset validation:
2025-11-20 13:42:35,311 - INFO -   - Segments: 296
2025-11-20 13:42:35,311 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:42:35,311 - INFO -   - Classes: 148 preictal, 148 interictal
2025-11-20 13:42:35,311 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:42:35,316 - INFO - test dataset validation:
2025-11-20 13:42:35,316 - INFO -   - Segments: 48
2025-11-20 13:42:35,316 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:42:35,316 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-20 13:42:35,316 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:42:35,317 - INFO - ============================================================
2025-11-20 13:42:35,317 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 13:42:35,317 - INFO - Total time: 1.0 minutes
2025-11-20 13:42:35,317 - INFO - Processed segments: 344
2025-11-20 13:42:35,317 - INFO - Average rate: 5.8 segments/second
2025-11-20 13:42:35,317 - INFO - ============================================================
✅ Fold 6 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 7/7
============================================================
2025-11-20 13:42:35,396 - INFO - ============================================================
2025-11-20 13:42:35,396 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 13:42:35,396 - INFO - ============================================================
2025-11-20 13:42:35,396 - INFO - Output prefix: chb14_fold7
2025-11-20 13:42:35,396 - INFO - EEG Preprocessor initialized
2025-11-20 13:42:35,396 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 13:42:35,396 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 13:42:35,396 - INFO - Segment duration: 5 seconds
2025-11-20 13:42:35,396 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 13:42:35,396 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 13:42:35,396 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 13:42:35,397 - INFO - Loading segments from chb14_fold7_sequences_prediction.json
2025-11-20 13:42:35,411 - INFO - Loaded 344 total sequences
2025-11-20 13:42:35,411 - INFO - Channel validation (from segmentation): 26/26 files valid
2025-11-20 13:42:35,411 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 13:42:35,411 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 13:42:35,411 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 13:42:35,411 - INFO - train: 296 sequences (148 preictal, 148 interictal)
2025-11-20 13:42:35,411 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-20 13:42:35,434 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 13:42:35,435 - INFO - train: kept 148 preictal and 148 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:42:35,435 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 13:42:35,453 - INFO - ============================================================
2025-11-20 13:42:35,453 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 13:42:35,453 - INFO - ============================================================
2025-11-20 13:42:35,453 - INFO - Processing 296 training samples to compute normalization stats...
2025-11-20 13:42:35,453 - INFO - Processing 296 sequences from 19 unique files
Processing training data:   0%|                    | 0/296 [00:00<?, ?it/s]Processing training data:   0%|            | 1/296 [00:01<08:04,  1.64s/it]Processing training data:   4%|4          | 13/296 [00:03<01:03,  4.48it/s]Processing training data:  10%|#          | 29/296 [00:03<00:28,  9.44it/s]Processing training data:  17%|#8         | 51/296 [00:05<00:20, 11.98it/s]Processing training data:  20%|##1        | 59/296 [00:06<00:19, 12.12it/s]Processing training data:  28%|###        | 83/296 [00:06<00:11, 18.53it/s]Processing training data:  35%|###4      | 103/296 [00:07<00:08, 22.00it/s]Processing training data:  43%|####2     | 126/296 [00:08<00:08, 20.49it/s]Processing training data:  62%|######2   | 185/296 [00:09<00:03, 33.82it/s]Processing training data:  65%|######4   | 192/296 [00:11<00:04, 20.88it/s]Processing training data:  69%|######8   | 203/296 [00:12<00:05, 15.97it/s]Processing training data:  72%|#######2  | 214/296 [00:14<00:06, 12.36it/s]Processing training data:  75%|#######5  | 223/296 [00:15<00:07, 10.18it/s]Processing training data:  80%|########  | 238/296 [00:17<00:06,  9.62it/s]Processing training data:  84%|########4 | 249/296 [00:19<00:05,  8.85it/s]Processing training data:  88%|########8 | 261/296 [00:20<00:03,  8.89it/s]Processing training data:  91%|#########1| 270/296 [00:22<00:03,  7.97it/s]Processing training data:  95%|#########4| 281/296 [00:23<00:02,  7.48it/s]Processing training data:  98%|#########7| 290/296 [00:25<00:00,  7.15it/s]Processing training data: 100%|##########| 296/296 [00:25<00:00, 11.76it/s]
2025-11-20 13:43:00,625 - INFO - Computing normalization statistics from training data...
2025-11-20 13:43:01,129 - INFO - Normalization stats computed:
2025-11-20 13:43:01,129 - INFO -   Mean: -0.004097
2025-11-20 13:43:01,129 - INFO -   Std: 2.518365
2025-11-20 13:43:01,129 - INFO -   Saved to: preprocessing\checkpoints\chb14_fold7\normalization_stats.json
2025-11-20 13:43:01,183 - INFO - Applying normalization and saving 296 training sequences...
Normalizing and saving training data:   0%|        | 0/296 [00:00<?, ?it/s]2025-11-20 13:43:01,191 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold7\train_dataset.h5
Normalizing and saving training data:   3%| | 10/296 [00:00<00:17, 16.17it/Normalizing and saving training data:   7%| | 20/296 [00:01<00:17, 15.82it/Normalizing and saving training data:  10%|1| 30/296 [00:01<00:16, 15.80it/Normalizing and saving training data:  14%|1| 40/296 [00:02<00:16, 15.81it/Normalizing and saving training data:  17%|1| 50/296 [00:03<00:15, 15.75it/Normalizing and saving training data:  20%|2| 60/296 [00:03<00:14, 15.78it/Normalizing and saving training data:  24%|2| 70/296 [00:04<00:14, 15.76it/Normalizing and saving training data:  27%|2| 80/296 [00:05<00:13, 15.79it/Normalizing and saving training data:  30%|3| 90/296 [00:05<00:13, 15.79it/Normalizing and saving training data:  34%|3| 100/296 [00:06<00:12, 15.77itNormalizing and saving training data:  37%|3| 110/296 [00:06<00:11, 15.79itNormalizing and saving training data:  41%|4| 120/296 [00:07<00:11, 15.81itNormalizing and saving training data:  44%|4| 130/296 [00:08<00:10, 15.81itNormalizing and saving training data:  47%|4| 140/296 [00:08<00:09, 15.76itNormalizing and saving training data:  51%|5| 150/296 [00:09<00:09, 15.75itNormalizing and saving training data:  54%|5| 160/296 [00:10<00:08, 15.72itNormalizing and saving training data:  57%|5| 170/296 [00:10<00:08, 15.72itNormalizing and saving training data:  61%|6| 180/296 [00:11<00:07, 15.72itNormalizing and saving training data:  64%|6| 190/296 [00:12<00:06, 15.72itNormalizing and saving training data:  68%|6| 200/296 [00:12<00:06, 15.67itNormalizing and saving training data:  71%|7| 210/296 [00:13<00:05, 15.64itNormalizing and saving training data:  74%|7| 220/296 [00:13<00:04, 15.46itNormalizing and saving training data:  78%|7| 230/296 [00:14<00:04, 15.30itNormalizing and saving training data:  81%|8| 240/296 [00:15<00:03, 15.36itNormalizing and saving training data:  84%|8| 250/296 [00:15<00:03, 15.23itNormalizing and saving training data:  88%|8| 260/296 [00:16<00:02, 15.31itNormalizing and saving training data:  91%|9| 270/296 [00:17<00:01, 15.31itNormalizing and saving training data:  95%|9| 280/296 [00:17<00:01, 15.34itNormalizing and saving training data:  98%|9| 290/296 [00:18<00:00, 15.36itNormalizing and saving training data: 100%|#| 296/296 [00:18<00:00, 15.93it
2025-11-20 13:43:20,185 - INFO - Training data processing completed during stats computation phase
2025-11-20 13:43:20,191 - INFO - Loaded normalization statistics:
2025-11-20 13:43:20,192 - INFO -   Mean: -0.004097
2025-11-20 13:43:20,192 - INFO -   Std: 2.518365
2025-11-20 13:43:20,192 - INFO - Split train already completed, skipping
2025-11-20 13:43:20,192 - INFO - Processing test split...
2025-11-20 13:43:20,192 - INFO - Need to process 48/48 sequences for test
2025-11-20 13:43:20,192 - INFO - Processing 48 sequences from 12 unique files
2025-11-20 13:43:20,192 - INFO - Average 4.0 sequences per file
Processing test:   0%|                              | 0/48 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/48 [00:00<00:45,  1.02it/s]Processing test:   6%|#3                    | 3/48 [00:01<00:23,  1.91it/s]2025-11-20 13:43:21,900 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb14_fold7\test_dataset.h5
2025-11-20 13:43:23,483 - INFO - Progress: 322/344 (93.6%) - ETA: 0.1 minutes
Processing test:  56%|###########8         | 27/48 [00:04<00:02,  7.88it/s]Processing test:  62%|#############1       | 30/48 [00:04<00:02,  7.91it/s]Processing test:  65%|#############5       | 31/48 [00:06<00:03,  4.44it/s]Processing test:  73%|###############3     | 35/48 [00:07<00:03,  4.31it/s]2025-11-20 13:43:27,998 - INFO - Progress: 334/344 (97.1%) - ETA: 0.0 minutes
Processing test:  81%|#################    | 39/48 [00:08<00:02,  3.63it/s]Processing test:  85%|#################9   | 41/48 [00:09<00:02,  3.41it/s]Processing test:  90%|##################8  | 43/48 [00:09<00:01,  3.58it/s]Processing test:  94%|###################6 | 45/48 [00:10<00:00,  3.22it/s]Processing test:  98%|####################5| 47/48 [00:10<00:00,  3.64it/s]Processing test: 100%|#####################| 48/48 [00:11<00:00,  3.45it/s]2025-11-20 13:43:32,198 - INFO - Progress: 344/344 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 48/48 [00:12<00:00,  4.00it/s]
2025-11-20 13:43:32,217 - INFO - Validating final datasets...
2025-11-20 13:43:32,226 - INFO - train dataset validation:
2025-11-20 13:43:32,226 - INFO -   - Segments: 296
2025-11-20 13:43:32,226 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:43:32,226 - INFO -   - Classes: 148 preictal, 148 interictal
2025-11-20 13:43:32,226 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:43:32,231 - INFO - test dataset validation:
2025-11-20 13:43:32,231 - INFO -   - Segments: 48
2025-11-20 13:43:32,231 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 13:43:32,231 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-20 13:43:32,231 - INFO -   - Balance: 50.0% preictal
2025-11-20 13:43:32,231 - INFO - ============================================================
2025-11-20 13:43:32,231 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 13:43:32,231 - INFO - Total time: 0.9 minutes
2025-11-20 13:43:32,231 - INFO - Processed segments: 344
2025-11-20 13:43:32,231 - INFO - Average rate: 6.1 segments/second
2025-11-20 13:43:32,231 - INFO - ============================================================
✅ Fold 7 preprocessing completed successfully!

============================================================
✅ BATCH PREPROCESSING COMPLETED!
✅ Processed 8 folds for patient chb14
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 8 folds for patient chb14
============================================================

============================================================
TRAINING FOLD 0/7
============================================================
Using dataset prefix: chb14_fold0
Loading datasets from: preprocessing\data\chb14_fold0
Saving models to: model\chb14_fold0
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.0061, std=2.5139
Loaded train dataset: 296 samples
  - Spectrogram shape: torch.Size([296, 30, 18, 50, 10])
  - Value range: [-4.7710, 3.7209]
  - Class distribution: tensor([148, 148])
LOOCV Mode (Fold 0): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6955, grad_norm=1.Training Epoch 1/5:   5%| | 1/19 [00:04<01:14,  4.12s/it, loss=0.6955, gradTraining Epoch 1/5:   5%| | 1/19 [00:04<01:14,  4.12s/it, loss=0.6957, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6957, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6919, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.00s/it, loss=0.6919, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.00s/it, loss=0.7047, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.7047, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.6877, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.6877, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.6900, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.6900, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.6898, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.80it/s, loss=0.6898, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.80it/s, loss=0.6847, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.67it/s, loss=0.6847, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.67it/s, loss=0.6928, gradTraining Epoch 1/5:  47%|4| 9/19 [00:04<00:01,  5.53it/s, loss=0.6928, gradTraining Epoch 1/5:  47%|4| 9/19 [00:05<00:01,  5.53it/s, loss=0.6992, gradTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.31it/s, loss=0.6992, graTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.31it/s, loss=0.6802, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.91it/s, loss=0.6802, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.91it/s, loss=0.6839, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.42it/s, loss=0.6839, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.42it/s, loss=0.6933, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  7.85it/s, loss=0.6933, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  7.85it/s, loss=0.6869, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.18it/s, loss=0.6869, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.18it/s, loss=0.6905, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.40it/s, loss=0.6905, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.40it/s, loss=0.6838, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.56it/s, loss=0.6838, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.56it/s, loss=0.6930, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.58it/s, loss=0.6930, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.58it/s, loss=0.6825, graTraining Epoch 1/5:  95%|9| 18/19 [00:05<00:00,  8.54it/s, loss=0.6825, graTraining Epoch 1/5:  95%|9| 18/19 [00:06<00:00,  8.54it/s, loss=0.6792, graTraining Epoch 1/5: 100%|#| 19/19 [00:06<00:00,  2.85it/s, loss=0.6792, gra

Epoch 1/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.6898, Acc: 0.5541, Precision: 0.5435, Recall: 0.6757, F1: 0.6024, AUC: 0.5730
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6720, grad_norm=1.Training Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.08s/it, loss=0.6720, gradTraining Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.08s/it, loss=0.6771, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.75s/it, loss=0.6771, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.75s/it, loss=0.6787, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:16,  1.00s/it, loss=0.6787, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:16,  1.00s/it, loss=0.6828, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.6828, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.6701, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.6701, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.6769, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.6769, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.6951, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.80it/s, loss=0.6951, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.80it/s, loss=0.6616, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.67it/s, loss=0.6616, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.67it/s, loss=0.6807, gradTraining Epoch 2/5:  47%|4| 9/19 [00:04<00:01,  5.50it/s, loss=0.6807, gradTraining Epoch 2/5:  47%|4| 9/19 [00:05<00:01,  5.50it/s, loss=0.6547, gradTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.28it/s, loss=0.6547, graTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.28it/s, loss=0.6580, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.89it/s, loss=0.6580, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.89it/s, loss=0.6641, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.44it/s, loss=0.6641, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.44it/s, loss=0.6595, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.89it/s, loss=0.6595, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.89it/s, loss=0.6741, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.24it/s, loss=0.6741, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.24it/s, loss=0.6672, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.48it/s, loss=0.6672, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.48it/s, loss=0.6643, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.65it/s, loss=0.6643, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.65it/s, loss=0.6653, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.78it/s, loss=0.6653, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.78it/s, loss=0.6621, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  8.85it/s, loss=0.6621, graTraining Epoch 2/5:  95%|9| 18/19 [00:06<00:00,  8.85it/s, loss=0.6270, graTraining Epoch 2/5: 100%|#| 19/19 [00:06<00:00,  2.87it/s, loss=0.6270, gra

Epoch 2/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6680, Acc: 0.6993, Precision: 0.6468, Recall: 0.8784, F1: 0.7450, AUC: 0.8051
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6547, grad_norm=1.Training Epoch 3/5:   5%| | 1/19 [00:04<01:13,  4.10s/it, loss=0.6547, gradTraining Epoch 3/5:   5%| | 1/19 [00:04<01:13,  4.10s/it, loss=0.6312, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6312, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6390, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.6390, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.6343, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.52it/s, loss=0.6343, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.52it/s, loss=0.6382, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.17it/s, loss=0.6382, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.17it/s, loss=0.6281, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.88it/s, loss=0.6281, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.88it/s, loss=0.6568, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.60it/s, loss=0.6568, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.60it/s, loss=0.6261, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.35it/s, loss=0.6261, gradTraining Epoch 3/5:  42%|4| 8/19 [00:05<00:02,  4.35it/s, loss=0.5783, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.04it/s, loss=0.5783, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.04it/s, loss=0.6385, gradTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  5.66it/s, loss=0.6385, graTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  5.66it/s, loss=0.6036, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.22it/s, loss=0.6036, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.22it/s, loss=0.5977, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:01,  6.67it/s, loss=0.5977, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:01,  6.67it/s, loss=0.5981, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.03it/s, loss=0.5981, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.03it/s, loss=0.6164, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  7.27it/s, loss=0.6164, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  7.27it/s, loss=0.6578, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  7.47it/s, loss=0.6578, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  7.47it/s, loss=0.5361, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  7.82it/s, loss=0.5361, graTraining Epoch 3/5:  84%|8| 16/19 [00:06<00:00,  7.82it/s, loss=0.5292, graTraining Epoch 3/5:  89%|8| 17/19 [00:06<00:00,  8.02it/s, loss=0.5292, graTraining Epoch 3/5:  89%|8| 17/19 [00:06<00:00,  8.02it/s, loss=0.5298, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  7.96it/s, loss=0.5298, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  7.96it/s, loss=0.5881, graTraining Epoch 3/5: 100%|#| 19/19 [00:06<00:00,  2.76it/s, loss=0.5881, gra

Epoch 3/5 Complete (7.3s) [LR: 0.000010]
Train - Loss: 0.6096, Acc: 0.7872, Precision: 0.7778, Recall: 0.8041, F1: 0.7907, AUC: 0.8721
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.5927, grad_norm=2.Training Epoch 4/5:   5%| | 1/19 [00:04<01:15,  4.21s/it, loss=0.5927, gradTraining Epoch 4/5:   5%| | 1/19 [00:04<01:15,  4.21s/it, loss=0.5143, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:30,  1.81s/it, loss=0.5143, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:30,  1.81s/it, loss=0.5675, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.03s/it, loss=0.5675, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.03s/it, loss=0.5630, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:10,  1.49it/s, loss=0.5630, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:10,  1.49it/s, loss=0.5720, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.14it/s, loss=0.5720, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.14it/s, loss=0.5331, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.88it/s, loss=0.5331, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.88it/s, loss=0.4596, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.65it/s, loss=0.4596, gradTraining Epoch 4/5:  37%|3| 7/19 [00:05<00:03,  3.65it/s, loss=0.5869, gradTraining Epoch 4/5:  42%|4| 8/19 [00:05<00:02,  4.52it/s, loss=0.5869, gradTraining Epoch 4/5:  42%|4| 8/19 [00:05<00:02,  4.52it/s, loss=0.4880, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.40it/s, loss=0.4880, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.40it/s, loss=0.5011, gradTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.16it/s, loss=0.5011, graTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.16it/s, loss=0.4747, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.84it/s, loss=0.4747, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.84it/s, loss=0.4706, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.35it/s, loss=0.4706, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.35it/s, loss=0.4473, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.86it/s, loss=0.4473, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.86it/s, loss=0.4623, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.24it/s, loss=0.4623, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.24it/s, loss=0.4563, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.48it/s, loss=0.4563, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.48it/s, loss=0.4197, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.63it/s, loss=0.4197, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.63it/s, loss=0.4539, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.73it/s, loss=0.4539, graTraining Epoch 4/5:  89%|8| 17/19 [00:06<00:00,  8.73it/s, loss=0.5246, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.80it/s, loss=0.5246, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.80it/s, loss=0.6470, graTraining Epoch 4/5: 100%|#| 19/19 [00:06<00:00,  2.81it/s, loss=0.6470, gra

Epoch 4/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.5123, Acc: 0.8514, Precision: 0.8377, Recall: 0.8716, F1: 0.8543, AUC: 0.9250
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.3776, grad_norm=2.Training Epoch 5/5:   5%| | 1/19 [00:04<01:13,  4.06s/it, loss=0.3776, gradTraining Epoch 5/5:   5%| | 1/19 [00:04<01:13,  4.06s/it, loss=0.3933, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.3933, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.4144, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.4144, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.3240, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.3240, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.4496, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.4496, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.4710, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.98it/s, loss=0.4710, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.98it/s, loss=0.3327, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.81it/s, loss=0.3327, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.81it/s, loss=0.3420, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.67it/s, loss=0.3420, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.67it/s, loss=0.2475, gradTraining Epoch 5/5:  47%|4| 9/19 [00:04<00:01,  5.54it/s, loss=0.2475, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.54it/s, loss=0.3746, gradTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.32it/s, loss=0.3746, graTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.32it/s, loss=0.2878, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  7.02it/s, loss=0.2878, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  7.02it/s, loss=0.2687, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.55it/s, loss=0.2687, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.55it/s, loss=0.2532, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.87it/s, loss=0.2532, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.87it/s, loss=0.2435, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.93it/s, loss=0.2435, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.93it/s, loss=0.5007, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  7.91it/s, loss=0.5007, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  7.91it/s, loss=0.3052, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  7.86it/s, loss=0.3052, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  7.86it/s, loss=0.2318, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  7.80it/s, loss=0.2318, graTraining Epoch 5/5:  89%|8| 17/19 [00:06<00:00,  7.80it/s, loss=0.2506, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  7.77it/s, loss=0.2506, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  7.77it/s, loss=0.3926, graTraining Epoch 5/5: 100%|#| 19/19 [00:06<00:00,  2.84it/s, loss=0.3926, gra

Epoch 5/5 Complete (7.1s) [LR: 0.000005]
Train - Loss: 0.3400, Acc: 0.9324, Precision: 0.9103, Recall: 0.9595, F1: 0.9342, AUC: 0.9854
------------------------------------------------------------
Training curves saved to model\chb14_fold0\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb14_fold0
============================================================
✅ Fold 0 training completed successfully!

============================================================
TRAINING FOLD 1/7
============================================================
Using dataset prefix: chb14_fold1
Loading datasets from: preprocessing\data\chb14_fold1
Saving models to: model\chb14_fold1
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.0186, std=2.5149
Loaded train dataset: 296 samples
  - Spectrogram shape: torch.Size([296, 30, 18, 50, 10])
  - Value range: [-4.7641, 3.7527]
  - Class distribution: tensor([148, 148])
LOOCV Mode (Fold 1): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.7034, grad_norm=1.Training Epoch 1/5:   5%| | 1/19 [00:04<01:12,  4.01s/it, loss=0.7034, gradTraining Epoch 1/5:   5%| | 1/19 [00:04<01:12,  4.01s/it, loss=0.6927, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.72s/it, loss=0.6927, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.72s/it, loss=0.6926, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.6926, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.6844, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.57it/s, loss=0.6844, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.57it/s, loss=0.6848, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.24it/s, loss=0.6848, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.24it/s, loss=0.6891, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  3.02it/s, loss=0.6891, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  3.02it/s, loss=0.7009, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.88it/s, loss=0.7009, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.88it/s, loss=0.6959, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.77it/s, loss=0.6959, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.77it/s, loss=0.6883, gradTraining Epoch 1/5:  47%|4| 9/19 [00:04<00:01,  5.59it/s, loss=0.6883, gradTraining Epoch 1/5:  47%|4| 9/19 [00:04<00:01,  5.59it/s, loss=0.6970, gradTraining Epoch 1/5:  53%|5| 10/19 [00:04<00:01,  6.39it/s, loss=0.6970, graTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.39it/s, loss=0.6947, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  7.08it/s, loss=0.6947, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  7.08it/s, loss=0.6978, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.58it/s, loss=0.6978, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.58it/s, loss=0.6840, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  8.03it/s, loss=0.6840, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  8.03it/s, loss=0.6858, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.40it/s, loss=0.6858, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.40it/s, loss=0.6892, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.59it/s, loss=0.6892, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.59it/s, loss=0.6891, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.79it/s, loss=0.6891, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.79it/s, loss=0.6818, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.93it/s, loss=0.6818, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.93it/s, loss=0.7001, graTraining Epoch 1/5:  95%|9| 18/19 [00:05<00:00,  9.07it/s, loss=0.7001, graTraining Epoch 1/5:  95%|9| 18/19 [00:05<00:00,  9.07it/s, loss=0.6848, graTraining Epoch 1/5: 100%|#| 19/19 [00:06<00:00,  2.94it/s, loss=0.6848, gra

Epoch 1/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6914, Acc: 0.5372, Precision: 0.5556, Recall: 0.3716, F1: 0.4453, AUC: 0.5467
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6772, grad_norm=1.Training Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.6772, gradTraining Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.6832, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6832, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6872, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6872, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6847, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6847, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6748, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.22it/s, loss=0.6748, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.22it/s, loss=0.6860, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.6860, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.6641, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.79it/s, loss=0.6641, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.79it/s, loss=0.6679, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.66it/s, loss=0.6679, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.66it/s, loss=0.6693, gradTraining Epoch 2/5:  47%|4| 9/19 [00:04<00:01,  5.36it/s, loss=0.6693, gradTraining Epoch 2/5:  47%|4| 9/19 [00:05<00:01,  5.36it/s, loss=0.6765, gradTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.12it/s, loss=0.6765, graTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.12it/s, loss=0.6808, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.83it/s, loss=0.6808, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.83it/s, loss=0.6631, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.44it/s, loss=0.6631, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.44it/s, loss=0.6642, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.95it/s, loss=0.6642, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.95it/s, loss=0.6798, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.33it/s, loss=0.6798, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.33it/s, loss=0.6713, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.47it/s, loss=0.6713, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.47it/s, loss=0.6663, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.67it/s, loss=0.6663, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.67it/s, loss=0.6692, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.90it/s, loss=0.6692, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.90it/s, loss=0.6697, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  8.99it/s, loss=0.6697, graTraining Epoch 2/5:  95%|9| 18/19 [00:06<00:00,  8.99it/s, loss=0.6615, graTraining Epoch 2/5: 100%|#| 19/19 [00:06<00:00,  2.88it/s, loss=0.6615, gra

Epoch 2/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6735, Acc: 0.7027, Precision: 0.7273, Recall: 0.6486, F1: 0.6857, AUC: 0.7719
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6509, grad_norm=1.Training Epoch 3/5:   5%| | 1/19 [00:04<01:14,  4.14s/it, loss=0.6509, gradTraining Epoch 3/5:   5%| | 1/19 [00:04<01:14,  4.14s/it, loss=0.6755, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:30,  1.77s/it, loss=0.6755, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:30,  1.77s/it, loss=0.6349, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.6349, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.6617, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.52it/s, loss=0.6617, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.52it/s, loss=0.6394, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.17it/s, loss=0.6394, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.17it/s, loss=0.6339, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.87it/s, loss=0.6339, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.87it/s, loss=0.6774, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.61it/s, loss=0.6774, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.61it/s, loss=0.6619, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.37it/s, loss=0.6619, gradTraining Epoch 3/5:  42%|4| 8/19 [00:05<00:02,  4.37it/s, loss=0.6586, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.22it/s, loss=0.6586, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.22it/s, loss=0.6419, gradTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.01it/s, loss=0.6419, graTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.01it/s, loss=0.6260, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.70it/s, loss=0.6260, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.70it/s, loss=0.6406, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.28it/s, loss=0.6406, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.28it/s, loss=0.6182, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.72it/s, loss=0.6182, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.72it/s, loss=0.6551, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  7.92it/s, loss=0.6551, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  7.92it/s, loss=0.6130, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.19it/s, loss=0.6130, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.19it/s, loss=0.5980, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.42it/s, loss=0.5980, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.42it/s, loss=0.6030, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.57it/s, loss=0.6030, graTraining Epoch 3/5:  89%|8| 17/19 [00:06<00:00,  8.57it/s, loss=0.5798, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  8.67it/s, loss=0.5798, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  8.67it/s, loss=0.6174, graTraining Epoch 3/5: 100%|#| 19/19 [00:06<00:00,  2.81it/s, loss=0.6174, gra

Epoch 3/5 Complete (7.2s) [LR: 0.000010]
Train - Loss: 0.6362, Acc: 0.7264, Precision: 0.8681, Recall: 0.5338, F1: 0.6611, AUC: 0.8497
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/19 [00:03<?, ?it/s, loss=0.6367, grad_norm=2.Training Epoch 4/5:   5%| | 1/19 [00:03<01:11,  3.96s/it, loss=0.6367, gradTraining Epoch 4/5:   5%| | 1/19 [00:04<01:11,  3.96s/it, loss=0.5739, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:28,  1.70s/it, loss=0.5739, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:28,  1.70s/it, loss=0.5983, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.5983, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.5937, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.57it/s, loss=0.5937, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.57it/s, loss=0.5809, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.5809, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.6262, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.6262, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.5856, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.76it/s, loss=0.5856, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.76it/s, loss=0.5347, gradTraining Epoch 4/5:  42%|4| 8/19 [00:04<00:02,  4.60it/s, loss=0.5347, gradTraining Epoch 4/5:  42%|4| 8/19 [00:04<00:02,  4.60it/s, loss=0.6025, gradTraining Epoch 4/5:  47%|4| 9/19 [00:04<00:01,  5.45it/s, loss=0.6025, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.45it/s, loss=0.5560, gradTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.22it/s, loss=0.5560, graTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.22it/s, loss=0.5234, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.89it/s, loss=0.5234, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.89it/s, loss=0.5253, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.45it/s, loss=0.5253, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.45it/s, loss=0.5505, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.93it/s, loss=0.5505, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.93it/s, loss=0.5231, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.06it/s, loss=0.5231, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.06it/s, loss=0.4994, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.31it/s, loss=0.4994, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.31it/s, loss=0.4542, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.55it/s, loss=0.4542, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.55it/s, loss=0.4297, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.72it/s, loss=0.4297, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.72it/s, loss=0.5446, graTraining Epoch 4/5:  95%|9| 18/19 [00:05<00:00,  8.91it/s, loss=0.5446, graTraining Epoch 4/5:  95%|9| 18/19 [00:05<00:00,  8.91it/s, loss=0.4170, graTraining Epoch 4/5: 100%|#| 19/19 [00:06<00:00,  2.91it/s, loss=0.4170, gra

Epoch 4/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.5450, Acc: 0.8311, Precision: 0.8551, Recall: 0.7973, F1: 0.8252, AUC: 0.9151
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.4796, grad_norm=2.Training Epoch 5/5:   5%| | 1/19 [00:04<01:12,  4.01s/it, loss=0.4796, gradTraining Epoch 5/5:   5%| | 1/19 [00:04<01:12,  4.01s/it, loss=0.4107, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:29,  1.72s/it, loss=0.4107, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:29,  1.72s/it, loss=0.3768, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.3768, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.3670, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.57it/s, loss=0.3670, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.57it/s, loss=0.4125, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.24it/s, loss=0.4125, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.24it/s, loss=0.3567, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  3.01it/s, loss=0.3567, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  3.01it/s, loss=0.3962, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.86it/s, loss=0.3962, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.86it/s, loss=0.3201, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.73it/s, loss=0.3201, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.73it/s, loss=0.4733, gradTraining Epoch 5/5:  47%|4| 9/19 [00:04<00:01,  5.58it/s, loss=0.4733, gradTraining Epoch 5/5:  47%|4| 9/19 [00:04<00:01,  5.58it/s, loss=0.2863, gradTraining Epoch 5/5:  53%|5| 10/19 [00:04<00:01,  6.34it/s, loss=0.2863, graTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.34it/s, loss=0.3090, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  7.00it/s, loss=0.3090, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  7.00it/s, loss=0.3442, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.60it/s, loss=0.3442, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.60it/s, loss=0.2700, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  8.06it/s, loss=0.2700, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  8.06it/s, loss=0.3453, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  8.35it/s, loss=0.3453, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  8.35it/s, loss=0.2015, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.56it/s, loss=0.2015, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.56it/s, loss=0.2356, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.72it/s, loss=0.2356, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.72it/s, loss=0.1969, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  8.83it/s, loss=0.1969, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  8.83it/s, loss=0.2229, graTraining Epoch 5/5:  95%|9| 18/19 [00:05<00:00,  8.94it/s, loss=0.2229, graTraining Epoch 5/5:  95%|9| 18/19 [00:05<00:00,  8.94it/s, loss=0.3578, graTraining Epoch 5/5: 100%|#| 19/19 [00:06<00:00,  2.92it/s, loss=0.3578, gra

Epoch 5/5 Complete (6.9s) [LR: 0.000005]
Train - Loss: 0.3349, Acc: 0.9595, Precision: 0.9474, Recall: 0.9730, F1: 0.9600, AUC: 0.9936
------------------------------------------------------------
Training curves saved to model\chb14_fold1\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb14_fold1
============================================================
✅ Fold 1 training completed successfully!

============================================================
TRAINING FOLD 2/7
============================================================
Using dataset prefix: chb14_fold2
Loading datasets from: preprocessing\data\chb14_fold2
Saving models to: model\chb14_fold2
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.0161, std=2.5186
Loaded train dataset: 296 samples
  - Spectrogram shape: torch.Size([296, 30, 18, 50, 10])
  - Value range: [-4.7581, 3.7518]
  - Class distribution: tensor([148, 148])
LOOCV Mode (Fold 2): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.7018, grad_norm=1.Training Epoch 1/5:   5%| | 1/19 [00:04<01:13,  4.10s/it, loss=0.7018, gradTraining Epoch 1/5:   5%| | 1/19 [00:04<01:13,  4.10s/it, loss=0.6859, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6859, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6910, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.00s/it, loss=0.6910, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.00s/it, loss=0.6933, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.6933, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.6982, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.6982, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.6921, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.6921, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.6871, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.81it/s, loss=0.6871, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.81it/s, loss=0.6852, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.70it/s, loss=0.6852, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.70it/s, loss=0.6978, gradTraining Epoch 1/5:  47%|4| 9/19 [00:04<00:01,  5.55it/s, loss=0.6978, gradTraining Epoch 1/5:  47%|4| 9/19 [00:05<00:01,  5.55it/s, loss=0.6954, gradTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.34it/s, loss=0.6954, graTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.34it/s, loss=0.6993, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  7.04it/s, loss=0.6993, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  7.04it/s, loss=0.6944, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.60it/s, loss=0.6944, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.60it/s, loss=0.6852, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  8.06it/s, loss=0.6852, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  8.06it/s, loss=0.6845, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.41it/s, loss=0.6845, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.41it/s, loss=0.6812, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.64it/s, loss=0.6812, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.64it/s, loss=0.6907, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.83it/s, loss=0.6907, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.83it/s, loss=0.6847, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.95it/s, loss=0.6847, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.95it/s, loss=0.6822, graTraining Epoch 1/5:  95%|9| 18/19 [00:05<00:00,  9.05it/s, loss=0.6822, graTraining Epoch 1/5:  95%|9| 18/19 [00:06<00:00,  9.05it/s, loss=0.6903, graTraining Epoch 1/5: 100%|#| 19/19 [00:06<00:00,  2.88it/s, loss=0.6903, gra

Epoch 1/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6906, Acc: 0.5541, Precision: 0.5889, Recall: 0.3581, F1: 0.4454, AUC: 0.5682
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/19 [00:03<?, ?it/s, loss=0.6839, grad_norm=1.Training Epoch 2/5:   5%| | 1/19 [00:03<01:10,  3.94s/it, loss=0.6839, gradTraining Epoch 2/5:   5%| | 1/19 [00:04<01:10,  3.94s/it, loss=0.6810, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:28,  1.69s/it, loss=0.6810, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:28,  1.69s/it, loss=0.6725, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.03it/s, loss=0.6725, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.03it/s, loss=0.6740, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.59it/s, loss=0.6740, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.59it/s, loss=0.6678, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.27it/s, loss=0.6678, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.27it/s, loss=0.6727, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  3.06it/s, loss=0.6727, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  3.06it/s, loss=0.6832, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.92it/s, loss=0.6832, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.92it/s, loss=0.6661, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.81it/s, loss=0.6661, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.81it/s, loss=0.6751, gradTraining Epoch 2/5:  47%|4| 9/19 [00:04<00:01,  5.67it/s, loss=0.6751, gradTraining Epoch 2/5:  47%|4| 9/19 [00:04<00:01,  5.67it/s, loss=0.6614, gradTraining Epoch 2/5:  53%|5| 10/19 [00:04<00:01,  6.46it/s, loss=0.6614, graTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.46it/s, loss=0.6683, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  7.14it/s, loss=0.6683, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  7.14it/s, loss=0.6675, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.65it/s, loss=0.6675, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.65it/s, loss=0.6645, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  8.04it/s, loss=0.6645, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  8.04it/s, loss=0.6660, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.41it/s, loss=0.6660, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.41it/s, loss=0.6483, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.59it/s, loss=0.6483, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.59it/s, loss=0.6457, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.74it/s, loss=0.6457, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.74it/s, loss=0.6582, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.90it/s, loss=0.6582, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.90it/s, loss=0.6619, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  8.96it/s, loss=0.6619, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  8.96it/s, loss=0.6514, graTraining Epoch 2/5: 100%|#| 19/19 [00:06<00:00,  2.96it/s, loss=0.6514, gra

Epoch 2/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6668, Acc: 0.7568, Precision: 0.7500, Recall: 0.7703, F1: 0.7600, AUC: 0.8349
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/19 [00:03<?, ?it/s, loss=0.6308, grad_norm=1.Training Epoch 3/5:   5%| | 1/19 [00:03<01:11,  3.95s/it, loss=0.6308, gradTraining Epoch 3/5:   5%| | 1/19 [00:04<01:11,  3.95s/it, loss=0.6316, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:28,  1.69s/it, loss=0.6316, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:28,  1.69s/it, loss=0.6353, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.03it/s, loss=0.6353, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.03it/s, loss=0.6431, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.59it/s, loss=0.6431, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.59it/s, loss=0.6407, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.27it/s, loss=0.6407, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.27it/s, loss=0.6253, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  3.06it/s, loss=0.6253, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  3.06it/s, loss=0.6178, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.91it/s, loss=0.6178, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.91it/s, loss=0.6042, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.78it/s, loss=0.6042, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.78it/s, loss=0.5827, gradTraining Epoch 3/5:  47%|4| 9/19 [00:04<00:01,  5.61it/s, loss=0.5827, gradTraining Epoch 3/5:  47%|4| 9/19 [00:04<00:01,  5.61it/s, loss=0.6071, gradTraining Epoch 3/5:  53%|5| 10/19 [00:04<00:01,  6.40it/s, loss=0.6071, graTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.40it/s, loss=0.5908, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  7.05it/s, loss=0.5908, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  7.05it/s, loss=0.6181, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.56it/s, loss=0.6181, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.56it/s, loss=0.5838, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.95it/s, loss=0.5838, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.95it/s, loss=0.6032, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.24it/s, loss=0.6032, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.24it/s, loss=0.5942, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.48it/s, loss=0.5942, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.48it/s, loss=0.5897, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.67it/s, loss=0.5897, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.67it/s, loss=0.6493, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.87it/s, loss=0.6493, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.87it/s, loss=0.5578, graTraining Epoch 3/5:  95%|9| 18/19 [00:05<00:00,  8.92it/s, loss=0.5578, graTraining Epoch 3/5:  95%|9| 18/19 [00:05<00:00,  8.92it/s, loss=0.5516, graTraining Epoch 3/5: 100%|#| 19/19 [00:06<00:00,  2.94it/s, loss=0.5516, gra

Epoch 3/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6083, Acc: 0.7939, Precision: 0.8222, Recall: 0.7500, F1: 0.7845, AUC: 0.8876
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.5485, grad_norm=1.Training Epoch 4/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.5485, gradTraining Epoch 4/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.5498, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.5498, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.5862, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.00s/it, loss=0.5862, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.00s/it, loss=0.5762, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.5762, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.4940, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.19it/s, loss=0.4940, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.19it/s, loss=0.5904, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.94it/s, loss=0.5904, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.94it/s, loss=0.4690, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.79it/s, loss=0.4690, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.79it/s, loss=0.4965, gradTraining Epoch 4/5:  42%|4| 8/19 [00:04<00:02,  4.68it/s, loss=0.4965, gradTraining Epoch 4/5:  42%|4| 8/19 [00:04<00:02,  4.68it/s, loss=0.5036, gradTraining Epoch 4/5:  47%|4| 9/19 [00:04<00:01,  5.47it/s, loss=0.5036, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.47it/s, loss=0.4350, gradTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.15it/s, loss=0.4350, graTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.15it/s, loss=0.4701, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.88it/s, loss=0.4701, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.88it/s, loss=0.4632, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.49it/s, loss=0.4632, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.49it/s, loss=0.5918, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.91it/s, loss=0.5918, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.91it/s, loss=0.4870, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.30it/s, loss=0.4870, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.30it/s, loss=0.3811, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.59it/s, loss=0.3811, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.59it/s, loss=0.4868, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.82it/s, loss=0.4868, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.82it/s, loss=0.5212, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.99it/s, loss=0.5212, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.99it/s, loss=0.4236, graTraining Epoch 4/5:  95%|9| 18/19 [00:05<00:00,  9.10it/s, loss=0.4236, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  9.10it/s, loss=0.4402, graTraining Epoch 4/5: 100%|#| 19/19 [00:06<00:00,  2.88it/s, loss=0.4402, gra

Epoch 4/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.5007, Acc: 0.8446, Precision: 0.8187, Recall: 0.8851, F1: 0.8506, AUC: 0.9116
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/19 [00:03<?, ?it/s, loss=0.4110, grad_norm=2.Training Epoch 5/5:   5%| | 1/19 [00:03<01:08,  3.79s/it, loss=0.4110, gradTraining Epoch 5/5:   5%| | 1/19 [00:03<01:08,  3.79s/it, loss=0.3613, gradTraining Epoch 5/5:  11%|1| 2/19 [00:03<00:27,  1.62s/it, loss=0.3613, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:27,  1.62s/it, loss=0.3565, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:14,  1.07it/s, loss=0.3565, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:14,  1.07it/s, loss=0.3764, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.65it/s, loss=0.3764, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.65it/s, loss=0.2656, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:05,  2.35it/s, loss=0.2656, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:05,  2.35it/s, loss=0.3589, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  3.15it/s, loss=0.3589, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  3.15it/s, loss=0.2942, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:02,  4.02it/s, loss=0.2942, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:02,  4.02it/s, loss=0.2948, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.92it/s, loss=0.2948, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.92it/s, loss=0.2676, gradTraining Epoch 5/5:  47%|4| 9/19 [00:04<00:01,  5.77it/s, loss=0.2676, gradTraining Epoch 5/5:  47%|4| 9/19 [00:04<00:01,  5.77it/s, loss=0.3335, gradTraining Epoch 5/5:  53%|5| 10/19 [00:04<00:01,  6.54it/s, loss=0.3335, graTraining Epoch 5/5:  53%|5| 10/19 [00:04<00:01,  6.54it/s, loss=0.2384, graTraining Epoch 5/5:  58%|5| 11/19 [00:04<00:01,  7.21it/s, loss=0.2384, graTraining Epoch 5/5:  58%|5| 11/19 [00:04<00:01,  7.21it/s, loss=0.2206, graTraining Epoch 5/5:  63%|6| 12/19 [00:04<00:00,  7.75it/s, loss=0.2206, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.75it/s, loss=0.2646, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  8.14it/s, loss=0.2646, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  8.14it/s, loss=0.2169, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  8.48it/s, loss=0.2169, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  8.48it/s, loss=0.1933, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.72it/s, loss=0.1933, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.72it/s, loss=0.2418, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.92it/s, loss=0.2418, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.92it/s, loss=0.2078, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  9.06it/s, loss=0.2078, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  9.06it/s, loss=0.1646, graTraining Epoch 5/5:  95%|9| 18/19 [00:05<00:00,  9.16it/s, loss=0.1646, graTraining Epoch 5/5:  95%|9| 18/19 [00:05<00:00,  9.16it/s, loss=0.6082, graTraining Epoch 5/5: 100%|#| 19/19 [00:06<00:00,  3.05it/s, loss=0.6082, gra

Epoch 5/5 Complete (6.6s) [LR: 0.000005]
Train - Loss: 0.2987, Acc: 0.9493, Precision: 0.9290, Recall: 0.9730, F1: 0.9505, AUC: 0.9903
------------------------------------------------------------
Training curves saved to model\chb14_fold2\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb14_fold2
============================================================
✅ Fold 2 training completed successfully!

============================================================
TRAINING FOLD 3/7
============================================================
Using dataset prefix: chb14_fold3
Loading datasets from: preprocessing\data\chb14_fold3
Saving models to: model\chb14_fold3
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.0178, std=2.5223
Loaded train dataset: 296 samples
  - Spectrogram shape: torch.Size([296, 30, 18, 50, 10])
  - Value range: [-4.7506, 3.7437]
  - Class distribution: tensor([148, 148])
LOOCV Mode (Fold 3): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6951, grad_norm=1.Training Epoch 1/5:   5%| | 1/19 [00:04<01:13,  4.08s/it, loss=0.6951, gradTraining Epoch 1/5:   5%| | 1/19 [00:04<01:13,  4.08s/it, loss=0.6827, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6827, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6757, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.6757, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.6944, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6944, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.7076, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.7076, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.6930, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.98it/s, loss=0.6930, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.98it/s, loss=0.6956, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.6956, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.7009, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.68it/s, loss=0.7009, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.68it/s, loss=0.7006, gradTraining Epoch 1/5:  47%|4| 9/19 [00:04<00:01,  5.53it/s, loss=0.7006, gradTraining Epoch 1/5:  47%|4| 9/19 [00:05<00:01,  5.53it/s, loss=0.7024, gradTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.29it/s, loss=0.7024, graTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.29it/s, loss=0.7028, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.95it/s, loss=0.7028, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.95it/s, loss=0.6845, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.45it/s, loss=0.6845, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.45it/s, loss=0.6826, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  7.89it/s, loss=0.6826, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  7.89it/s, loss=0.6819, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.28it/s, loss=0.6819, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.28it/s, loss=0.6857, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.52it/s, loss=0.6857, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.52it/s, loss=0.6817, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.68it/s, loss=0.6817, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.68it/s, loss=0.6875, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.80it/s, loss=0.6875, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.80it/s, loss=0.6800, graTraining Epoch 1/5:  95%|9| 18/19 [00:05<00:00,  8.89it/s, loss=0.6800, graTraining Epoch 1/5:  95%|9| 18/19 [00:06<00:00,  8.89it/s, loss=0.6754, graTraining Epoch 1/5: 100%|#| 19/19 [00:06<00:00,  2.88it/s, loss=0.6754, gra

Epoch 1/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6900, Acc: 0.5169, Precision: 0.5333, Recall: 0.2703, F1: 0.3587, AUC: 0.5693
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6738, grad_norm=1.Training Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.6738, gradTraining Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.6754, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6754, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6866, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.6866, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.6765, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.6765, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.6878, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.18it/s, loss=0.6878, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.18it/s, loss=0.6856, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.94it/s, loss=0.6856, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.94it/s, loss=0.6582, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.78it/s, loss=0.6582, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.78it/s, loss=0.6783, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.65it/s, loss=0.6783, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.65it/s, loss=0.6857, gradTraining Epoch 2/5:  47%|4| 9/19 [00:04<00:01,  5.50it/s, loss=0.6857, gradTraining Epoch 2/5:  47%|4| 9/19 [00:05<00:01,  5.50it/s, loss=0.6774, gradTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.31it/s, loss=0.6774, graTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.31it/s, loss=0.6805, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.99it/s, loss=0.6805, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.99it/s, loss=0.6960, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.51it/s, loss=0.6960, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.51it/s, loss=0.6627, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.96it/s, loss=0.6627, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.96it/s, loss=0.6540, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.29it/s, loss=0.6540, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.29it/s, loss=0.6571, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.57it/s, loss=0.6571, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.57it/s, loss=0.6701, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.79it/s, loss=0.6701, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.79it/s, loss=0.6507, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.95it/s, loss=0.6507, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.95it/s, loss=0.6591, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  9.02it/s, loss=0.6591, graTraining Epoch 2/5:  95%|9| 18/19 [00:06<00:00,  9.02it/s, loss=0.6589, graTraining Epoch 2/5: 100%|#| 19/19 [00:06<00:00,  2.88it/s, loss=0.6589, gra

Epoch 2/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6723, Acc: 0.7061, Precision: 0.7259, Recall: 0.6622, F1: 0.6926, AUC: 0.7841
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6420, grad_norm=1.Training Epoch 3/5:   5%| | 1/19 [00:04<01:12,  4.05s/it, loss=0.6420, gradTraining Epoch 3/5:   5%| | 1/19 [00:04<01:12,  4.05s/it, loss=0.6688, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.73s/it, loss=0.6688, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.73s/it, loss=0.6375, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6375, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6345, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6345, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6346, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.6346, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.6106, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.99it/s, loss=0.6106, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.99it/s, loss=0.6371, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.84it/s, loss=0.6371, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.84it/s, loss=0.6164, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.72it/s, loss=0.6164, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.72it/s, loss=0.6650, gradTraining Epoch 3/5:  47%|4| 9/19 [00:04<00:01,  5.56it/s, loss=0.6650, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.56it/s, loss=0.6513, gradTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.33it/s, loss=0.6513, graTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.33it/s, loss=0.6357, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  7.00it/s, loss=0.6357, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  7.00it/s, loss=0.6265, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.54it/s, loss=0.6265, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.54it/s, loss=0.5780, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.95it/s, loss=0.5780, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.95it/s, loss=0.6569, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.29it/s, loss=0.6569, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.29it/s, loss=0.6338, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.57it/s, loss=0.6338, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.57it/s, loss=0.6149, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.76it/s, loss=0.6149, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.76it/s, loss=0.5766, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.91it/s, loss=0.5766, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.91it/s, loss=0.6603, graTraining Epoch 3/5:  95%|9| 18/19 [00:05<00:00,  8.99it/s, loss=0.6603, graTraining Epoch 3/5:  95%|9| 18/19 [00:05<00:00,  8.99it/s, loss=0.5386, graTraining Epoch 3/5: 100%|#| 19/19 [00:06<00:00,  2.90it/s, loss=0.5386, gra

Epoch 3/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6273, Acc: 0.7534, Precision: 0.7551, Recall: 0.7500, F1: 0.7525, AUC: 0.8432
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.5314, grad_norm=1.Training Epoch 4/5:   5%| | 1/19 [00:04<01:14,  4.16s/it, loss=0.5314, gradTraining Epoch 4/5:   5%| | 1/19 [00:04<01:14,  4.16s/it, loss=0.5586, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:30,  1.79s/it, loss=0.5586, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:30,  1.79s/it, loss=0.5288, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.03s/it, loss=0.5288, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.03s/it, loss=0.5684, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:10,  1.47it/s, loss=0.5684, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:10,  1.47it/s, loss=0.5663, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.11it/s, loss=0.5663, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.11it/s, loss=0.5717, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.85it/s, loss=0.5717, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.85it/s, loss=0.4873, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.68it/s, loss=0.4873, gradTraining Epoch 4/5:  37%|3| 7/19 [00:05<00:03,  3.68it/s, loss=0.4966, gradTraining Epoch 4/5:  42%|4| 8/19 [00:05<00:02,  4.55it/s, loss=0.4966, gradTraining Epoch 4/5:  42%|4| 8/19 [00:05<00:02,  4.55it/s, loss=0.5368, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.42it/s, loss=0.5368, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.42it/s, loss=0.6106, gradTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.17it/s, loss=0.6106, graTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.17it/s, loss=0.4430, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.83it/s, loss=0.4430, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.83it/s, loss=0.4897, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:01,  6.94it/s, loss=0.4897, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:01,  6.94it/s, loss=0.4531, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.06it/s, loss=0.4531, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.06it/s, loss=0.4809, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  7.19it/s, loss=0.4809, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  7.19it/s, loss=0.4114, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  7.48it/s, loss=0.4114, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  7.48it/s, loss=0.4494, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  7.88it/s, loss=0.4494, graTraining Epoch 4/5:  84%|8| 16/19 [00:06<00:00,  7.88it/s, loss=0.4625, graTraining Epoch 4/5:  89%|8| 17/19 [00:06<00:00,  8.18it/s, loss=0.4625, graTraining Epoch 4/5:  89%|8| 17/19 [00:06<00:00,  8.18it/s, loss=0.3605, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.41it/s, loss=0.3605, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.41it/s, loss=0.4787, graTraining Epoch 4/5: 100%|#| 19/19 [00:06<00:00,  2.76it/s, loss=0.4787, gra

Epoch 4/5 Complete (7.3s) [LR: 0.000010]
Train - Loss: 0.4992, Acc: 0.8750, Precision: 0.8725, Recall: 0.8784, F1: 0.8754, AUC: 0.9500
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.3714, grad_norm=3.Training Epoch 5/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.3714, gradTraining Epoch 5/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.3584, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.3584, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.3839, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.3839, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.3122, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.3122, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.3371, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.3371, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.3080, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.98it/s, loss=0.3080, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.98it/s, loss=0.2655, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.84it/s, loss=0.2655, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.84it/s, loss=0.2927, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.73it/s, loss=0.2927, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.73it/s, loss=0.2946, gradTraining Epoch 5/5:  47%|4| 9/19 [00:04<00:01,  5.57it/s, loss=0.2946, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.57it/s, loss=0.2970, gradTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.37it/s, loss=0.2970, graTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.37it/s, loss=0.2860, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  7.02it/s, loss=0.2860, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  7.02it/s, loss=0.2643, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.61it/s, loss=0.2643, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.61it/s, loss=0.2038, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  8.09it/s, loss=0.2038, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  8.09it/s, loss=0.1817, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  8.46it/s, loss=0.1817, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  8.46it/s, loss=0.1861, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.71it/s, loss=0.1861, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.71it/s, loss=0.1961, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.92it/s, loss=0.1961, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.92it/s, loss=0.2937, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  8.74it/s, loss=0.2937, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  8.74it/s, loss=0.1512, graTraining Epoch 5/5:  95%|9| 18/19 [00:05<00:00,  8.92it/s, loss=0.1512, graTraining Epoch 5/5:  95%|9| 18/19 [00:05<00:00,  8.92it/s, loss=0.2930, graTraining Epoch 5/5: 100%|#| 19/19 [00:06<00:00,  2.89it/s, loss=0.2930, gra

Epoch 5/5 Complete (7.0s) [LR: 0.000005]
Train - Loss: 0.2777, Acc: 0.9730, Precision: 0.9730, Recall: 0.9730, F1: 0.9730, AUC: 0.9932
------------------------------------------------------------
Training curves saved to model\chb14_fold3\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb14_fold3
============================================================
✅ Fold 3 training completed successfully!

============================================================
TRAINING FOLD 4/7
============================================================
Using dataset prefix: chb14_fold4
Loading datasets from: preprocessing\data\chb14_fold4
Saving models to: model\chb14_fold4
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.0013, std=2.5141
Loaded train dataset: 296 samples
  - Spectrogram shape: torch.Size([296, 30, 18, 50, 10])
  - Value range: [-4.7725, 3.7492]
  - Class distribution: tensor([148, 148])
LOOCV Mode (Fold 4): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6862, grad_norm=1.Training Epoch 1/5:   5%| | 1/19 [00:04<01:14,  4.13s/it, loss=0.6862, gradTraining Epoch 1/5:   5%| | 1/19 [00:04<01:14,  4.13s/it, loss=0.6962, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6962, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6945, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.6945, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.6951, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.6951, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.7083, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.19it/s, loss=0.7083, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.19it/s, loss=0.6839, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.97it/s, loss=0.6839, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.97it/s, loss=0.6734, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.6734, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.6999, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.71it/s, loss=0.6999, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.71it/s, loss=0.7123, gradTraining Epoch 1/5:  47%|4| 9/19 [00:04<00:01,  5.58it/s, loss=0.7123, gradTraining Epoch 1/5:  47%|4| 9/19 [00:05<00:01,  5.58it/s, loss=0.6868, gradTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.34it/s, loss=0.6868, graTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.34it/s, loss=0.6835, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  7.03it/s, loss=0.6835, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  7.03it/s, loss=0.6944, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.61it/s, loss=0.6944, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.61it/s, loss=0.6921, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  8.07it/s, loss=0.6921, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  8.07it/s, loss=0.7082, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.43it/s, loss=0.7082, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.43it/s, loss=0.6806, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.70it/s, loss=0.6806, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.70it/s, loss=0.6770, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.92it/s, loss=0.6770, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.92it/s, loss=0.6846, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  9.05it/s, loss=0.6846, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  9.05it/s, loss=0.6839, graTraining Epoch 1/5:  95%|9| 18/19 [00:05<00:00,  9.15it/s, loss=0.6839, graTraining Epoch 1/5:  95%|9| 18/19 [00:06<00:00,  9.15it/s, loss=0.6814, graTraining Epoch 1/5: 100%|#| 19/19 [00:06<00:00,  2.89it/s, loss=0.6814, gra

Epoch 1/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6906, Acc: 0.5270, Precision: 0.5171, Recall: 0.8176, F1: 0.6335, AUC: 0.5440
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/19 [00:03<?, ?it/s, loss=0.6738, grad_norm=1.Training Epoch 2/5:   5%| | 1/19 [00:03<01:11,  3.97s/it, loss=0.6738, gradTraining Epoch 2/5:   5%| | 1/19 [00:04<01:11,  3.97s/it, loss=0.6820, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:28,  1.70s/it, loss=0.6820, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:28,  1.70s/it, loss=0.6882, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.03it/s, loss=0.6882, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.03it/s, loss=0.6793, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.58it/s, loss=0.6793, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.58it/s, loss=0.6804, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.26it/s, loss=0.6804, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.26it/s, loss=0.6708, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  3.05it/s, loss=0.6708, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  3.05it/s, loss=0.6836, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.91it/s, loss=0.6836, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.91it/s, loss=0.6698, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.80it/s, loss=0.6698, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.80it/s, loss=0.6838, gradTraining Epoch 2/5:  47%|4| 9/19 [00:04<00:01,  5.67it/s, loss=0.6838, gradTraining Epoch 2/5:  47%|4| 9/19 [00:04<00:01,  5.67it/s, loss=0.6877, gradTraining Epoch 2/5:  53%|5| 10/19 [00:04<00:01,  6.45it/s, loss=0.6877, graTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.45it/s, loss=0.6545, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  7.13it/s, loss=0.6545, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  7.13it/s, loss=0.6773, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.62it/s, loss=0.6773, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.62it/s, loss=0.6568, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  8.04it/s, loss=0.6568, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  8.04it/s, loss=0.6720, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.32it/s, loss=0.6720, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.32it/s, loss=0.6729, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.53it/s, loss=0.6729, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.53it/s, loss=0.6804, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.74it/s, loss=0.6804, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.74it/s, loss=0.6541, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.58it/s, loss=0.6541, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.58it/s, loss=0.6454, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  8.72it/s, loss=0.6454, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  8.72it/s, loss=0.6369, graTraining Epoch 2/5: 100%|#| 19/19 [00:06<00:00,  2.93it/s, loss=0.6369, gra

Epoch 2/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6710, Acc: 0.6926, Precision: 0.6592, Recall: 0.7973, F1: 0.7217, AUC: 0.7684
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6518, grad_norm=1.Training Epoch 3/5:   5%| | 1/19 [00:04<01:12,  4.01s/it, loss=0.6518, gradTraining Epoch 3/5:   5%| | 1/19 [00:04<01:12,  4.01s/it, loss=0.6305, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.73s/it, loss=0.6305, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.73s/it, loss=0.6465, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.6465, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.6271, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.52it/s, loss=0.6271, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.52it/s, loss=0.6308, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.14it/s, loss=0.6308, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.14it/s, loss=0.6117, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.89it/s, loss=0.6117, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.89it/s, loss=0.6173, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.71it/s, loss=0.6173, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.71it/s, loss=0.6009, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.59it/s, loss=0.6009, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.59it/s, loss=0.5881, gradTraining Epoch 3/5:  47%|4| 9/19 [00:04<00:01,  5.42it/s, loss=0.5881, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.42it/s, loss=0.5942, gradTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.14it/s, loss=0.5942, graTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.14it/s, loss=0.5866, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.70it/s, loss=0.5866, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.70it/s, loss=0.6227, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.06it/s, loss=0.6227, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.06it/s, loss=0.6197, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.53it/s, loss=0.6197, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.53it/s, loss=0.6050, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  7.55it/s, loss=0.6050, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  7.55it/s, loss=0.5810, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  7.67it/s, loss=0.5810, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  7.67it/s, loss=0.6472, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  7.80it/s, loss=0.6472, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  7.80it/s, loss=0.6119, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.02it/s, loss=0.6119, graTraining Epoch 3/5:  89%|8| 17/19 [00:06<00:00,  8.02it/s, loss=0.5301, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  8.09it/s, loss=0.5301, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  8.09it/s, loss=0.5828, graTraining Epoch 3/5: 100%|#| 19/19 [00:06<00:00,  2.77it/s, loss=0.5828, gra

Epoch 3/5 Complete (7.3s) [LR: 0.000010]
Train - Loss: 0.6098, Acc: 0.8277, Precision: 0.8489, Recall: 0.7973, F1: 0.8223, AUC: 0.8713
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.5012, grad_norm=1.Training Epoch 4/5:   5%| | 1/19 [00:04<01:16,  4.23s/it, loss=0.5012, gradTraining Epoch 4/5:   5%| | 1/19 [00:04<01:16,  4.23s/it, loss=0.5562, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:30,  1.81s/it, loss=0.5562, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:30,  1.81s/it, loss=0.5358, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.04s/it, loss=0.5358, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.04s/it, loss=0.5069, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:10,  1.49it/s, loss=0.5069, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:10,  1.49it/s, loss=0.5612, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.13it/s, loss=0.5612, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.13it/s, loss=0.5310, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.87it/s, loss=0.5310, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.87it/s, loss=0.4549, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.69it/s, loss=0.4549, gradTraining Epoch 4/5:  37%|3| 7/19 [00:05<00:03,  3.69it/s, loss=0.5236, gradTraining Epoch 4/5:  42%|4| 8/19 [00:05<00:02,  4.53it/s, loss=0.5236, gradTraining Epoch 4/5:  42%|4| 8/19 [00:05<00:02,  4.53it/s, loss=0.4963, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.35it/s, loss=0.4963, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.35it/s, loss=0.5327, gradTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.04it/s, loss=0.5327, graTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.04it/s, loss=0.4563, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.68it/s, loss=0.4563, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.68it/s, loss=0.4654, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.23it/s, loss=0.4654, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.23it/s, loss=0.4694, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.67it/s, loss=0.4694, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.67it/s, loss=0.3972, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  7.96it/s, loss=0.3972, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  7.96it/s, loss=0.3750, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.16it/s, loss=0.3750, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.16it/s, loss=0.4929, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.33it/s, loss=0.4929, graTraining Epoch 4/5:  84%|8| 16/19 [00:06<00:00,  8.33it/s, loss=0.3848, graTraining Epoch 4/5:  89%|8| 17/19 [00:06<00:00,  8.40it/s, loss=0.3848, graTraining Epoch 4/5:  89%|8| 17/19 [00:06<00:00,  8.40it/s, loss=0.3707, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.46it/s, loss=0.3707, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.46it/s, loss=0.3915, graTraining Epoch 4/5: 100%|#| 19/19 [00:06<00:00,  2.78it/s, loss=0.3915, gra

Epoch 4/5 Complete (7.2s) [LR: 0.000010]
Train - Loss: 0.4738, Acc: 0.8581, Precision: 0.8397, Recall: 0.8851, F1: 0.8618, AUC: 0.9443
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.4021, grad_norm=2.Training Epoch 5/5:   5%| | 1/19 [00:04<01:15,  4.17s/it, loss=0.4021, gradTraining Epoch 5/5:   5%| | 1/19 [00:04<01:15,  4.17s/it, loss=0.3115, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:30,  1.79s/it, loss=0.3115, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:30,  1.79s/it, loss=0.4209, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:16,  1.02s/it, loss=0.4209, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:16,  1.02s/it, loss=0.2710, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.51it/s, loss=0.2710, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.51it/s, loss=0.3612, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.15it/s, loss=0.3612, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.15it/s, loss=0.3430, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.90it/s, loss=0.3430, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.90it/s, loss=0.2413, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.69it/s, loss=0.2413, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.69it/s, loss=0.3358, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.52it/s, loss=0.3358, gradTraining Epoch 5/5:  42%|4| 8/19 [00:05<00:02,  4.52it/s, loss=0.2186, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.33it/s, loss=0.2186, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.33it/s, loss=0.2548, gradTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.09it/s, loss=0.2548, graTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.09it/s, loss=0.2406, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.57it/s, loss=0.2406, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.57it/s, loss=0.2245, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.15it/s, loss=0.2245, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.15it/s, loss=0.1690, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.60it/s, loss=0.1690, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.60it/s, loss=0.2154, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.94it/s, loss=0.2154, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.94it/s, loss=0.1889, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.19it/s, loss=0.1889, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.19it/s, loss=0.1920, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.38it/s, loss=0.1920, graTraining Epoch 5/5:  84%|8| 16/19 [00:06<00:00,  8.38it/s, loss=0.3856, graTraining Epoch 5/5:  89%|8| 17/19 [00:06<00:00,  8.51it/s, loss=0.3856, graTraining Epoch 5/5:  89%|8| 17/19 [00:06<00:00,  8.51it/s, loss=0.1194, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  8.59it/s, loss=0.1194, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  8.59it/s, loss=0.1980, graTraining Epoch 5/5: 100%|#| 19/19 [00:06<00:00,  2.80it/s, loss=0.1980, gra

Epoch 5/5 Complete (7.2s) [LR: 0.000005]
Train - Loss: 0.2681, Acc: 0.9628, Precision: 0.9419, Recall: 0.9865, F1: 0.9637, AUC: 0.9903
------------------------------------------------------------
Training curves saved to model\chb14_fold4\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb14_fold4
============================================================
✅ Fold 4 training completed successfully!

============================================================
TRAINING FOLD 5/7
============================================================
Using dataset prefix: chb14_fold5
Loading datasets from: preprocessing\data\chb14_fold5
Saving models to: model\chb14_fold5
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.0166, std=2.5289
Loaded train dataset: 296 samples
  - Spectrogram shape: torch.Size([296, 30, 18, 50, 10])
  - Value range: [-4.7386, 3.7334]
  - Class distribution: tensor([148, 148])
LOOCV Mode (Fold 5): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.7080, grad_norm=1.Training Epoch 1/5:   5%| | 1/19 [00:04<01:15,  4.19s/it, loss=0.7080, gradTraining Epoch 1/5:   5%| | 1/19 [00:04<01:15,  4.19s/it, loss=0.7094, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:30,  1.80s/it, loss=0.7094, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:30,  1.80s/it, loss=0.6869, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.04s/it, loss=0.6869, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.04s/it, loss=0.6990, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:10,  1.47it/s, loss=0.6990, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:10,  1.47it/s, loss=0.6994, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.09it/s, loss=0.6994, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.09it/s, loss=0.6931, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.81it/s, loss=0.6931, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.81it/s, loss=0.6916, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.56it/s, loss=0.6916, gradTraining Epoch 1/5:  37%|3| 7/19 [00:05<00:03,  3.56it/s, loss=0.6764, gradTraining Epoch 1/5:  42%|4| 8/19 [00:05<00:02,  4.39it/s, loss=0.6764, gradTraining Epoch 1/5:  42%|4| 8/19 [00:05<00:02,  4.39it/s, loss=0.6967, gradTraining Epoch 1/5:  47%|4| 9/19 [00:05<00:01,  5.16it/s, loss=0.6967, gradTraining Epoch 1/5:  47%|4| 9/19 [00:05<00:01,  5.16it/s, loss=0.7014, gradTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  5.69it/s, loss=0.7014, graTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  5.69it/s, loss=0.6769, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.37it/s, loss=0.6769, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.37it/s, loss=0.6971, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.02it/s, loss=0.6971, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.02it/s, loss=0.6856, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  7.57it/s, loss=0.6856, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  7.57it/s, loss=0.6902, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  7.98it/s, loss=0.6902, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  7.98it/s, loss=0.7041, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.30it/s, loss=0.7041, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.30it/s, loss=0.6888, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.57it/s, loss=0.6888, graTraining Epoch 1/5:  84%|8| 16/19 [00:06<00:00,  8.57it/s, loss=0.6973, graTraining Epoch 1/5:  89%|8| 17/19 [00:06<00:00,  8.76it/s, loss=0.6973, graTraining Epoch 1/5:  89%|8| 17/19 [00:06<00:00,  8.76it/s, loss=0.6916, graTraining Epoch 1/5:  95%|9| 18/19 [00:06<00:00,  8.91it/s, loss=0.6916, graTraining Epoch 1/5:  95%|9| 18/19 [00:06<00:00,  8.91it/s, loss=0.7053, graTraining Epoch 1/5: 100%|#| 19/19 [00:06<00:00,  2.74it/s, loss=0.7053, gra

Epoch 1/5 Complete (7.3s) [LR: 0.000010]
Train - Loss: 0.6947, Acc: 0.4797, Precision: 0.4880, Recall: 0.8243, F1: 0.6131, AUC: 0.4971
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6927, grad_norm=1.Training Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.06s/it, loss=0.6927, gradTraining Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.06s/it, loss=0.6762, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6762, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6734, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6734, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6846, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6846, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6853, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.22it/s, loss=0.6853, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.22it/s, loss=0.6882, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.99it/s, loss=0.6882, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.99it/s, loss=0.6845, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.80it/s, loss=0.6845, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.80it/s, loss=0.6796, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.66it/s, loss=0.6796, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.66it/s, loss=0.6818, gradTraining Epoch 2/5:  47%|4| 9/19 [00:04<00:01,  5.52it/s, loss=0.6818, gradTraining Epoch 2/5:  47%|4| 9/19 [00:05<00:01,  5.52it/s, loss=0.6782, gradTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.29it/s, loss=0.6782, graTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.29it/s, loss=0.6850, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.83it/s, loss=0.6850, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.83it/s, loss=0.6712, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.32it/s, loss=0.6712, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.32it/s, loss=0.6839, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.82it/s, loss=0.6839, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.82it/s, loss=0.6703, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.14it/s, loss=0.6703, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.14it/s, loss=0.6548, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.38it/s, loss=0.6548, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.38it/s, loss=0.6822, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.51it/s, loss=0.6822, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.51it/s, loss=0.6415, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.29it/s, loss=0.6415, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.29it/s, loss=0.6704, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  8.11it/s, loss=0.6704, graTraining Epoch 2/5:  95%|9| 18/19 [00:06<00:00,  8.11it/s, loss=0.6987, graTraining Epoch 2/5: 100%|#| 19/19 [00:06<00:00,  2.84it/s, loss=0.6987, gra

Epoch 2/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.6780, Acc: 0.6622, Precision: 0.6967, Recall: 0.5743, F1: 0.6296, AUC: 0.7338
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6530, grad_norm=1.Training Epoch 3/5:   5%| | 1/19 [00:04<01:15,  4.21s/it, loss=0.6530, gradTraining Epoch 3/5:   5%| | 1/19 [00:04<01:15,  4.21s/it, loss=0.6848, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:30,  1.82s/it, loss=0.6848, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:30,  1.82s/it, loss=0.6334, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:17,  1.07s/it, loss=0.6334, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:17,  1.07s/it, loss=0.6470, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:10,  1.42it/s, loss=0.6470, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:10,  1.42it/s, loss=0.6591, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:07,  2.00it/s, loss=0.6591, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:07,  2.00it/s, loss=0.6617, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.64it/s, loss=0.6617, gradTraining Epoch 3/5:  32%|3| 6/19 [00:05<00:04,  2.64it/s, loss=0.6458, gradTraining Epoch 3/5:  37%|3| 7/19 [00:05<00:03,  3.34it/s, loss=0.6458, gradTraining Epoch 3/5:  37%|3| 7/19 [00:05<00:03,  3.34it/s, loss=0.6290, gradTraining Epoch 3/5:  42%|4| 8/19 [00:05<00:02,  4.19it/s, loss=0.6290, gradTraining Epoch 3/5:  42%|4| 8/19 [00:05<00:02,  4.19it/s, loss=0.6208, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.04it/s, loss=0.6208, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.04it/s, loss=0.6532, gradTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  5.72it/s, loss=0.6532, graTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  5.72it/s, loss=0.6266, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.20it/s, loss=0.6266, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.20it/s, loss=0.6292, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:01,  6.67it/s, loss=0.6292, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:01,  6.67it/s, loss=0.5956, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.27it/s, loss=0.5956, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.27it/s, loss=0.6718, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  7.77it/s, loss=0.6718, graTraining Epoch 3/5:  74%|7| 14/19 [00:06<00:00,  7.77it/s, loss=0.6339, graTraining Epoch 3/5:  79%|7| 15/19 [00:06<00:00,  8.14it/s, loss=0.6339, graTraining Epoch 3/5:  79%|7| 15/19 [00:06<00:00,  8.14it/s, loss=0.6048, graTraining Epoch 3/5:  84%|8| 16/19 [00:06<00:00,  8.37it/s, loss=0.6048, graTraining Epoch 3/5:  84%|8| 16/19 [00:06<00:00,  8.37it/s, loss=0.6176, graTraining Epoch 3/5:  89%|8| 17/19 [00:06<00:00,  8.57it/s, loss=0.6176, graTraining Epoch 3/5:  89%|8| 17/19 [00:06<00:00,  8.57it/s, loss=0.5949, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  8.73it/s, loss=0.5949, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  8.73it/s, loss=0.6111, graTraining Epoch 3/5: 100%|#| 19/19 [00:07<00:00,  2.70it/s, loss=0.6111, gra

Epoch 3/5 Complete (7.4s) [LR: 0.000010]
Train - Loss: 0.6354, Acc: 0.8074, Precision: 0.8640, Recall: 0.7297, F1: 0.7912, AUC: 0.8894
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6041, grad_norm=1.Training Epoch 4/5:   5%| | 1/19 [00:04<01:13,  4.11s/it, loss=0.6041, gradTraining Epoch 4/5:   5%| | 1/19 [00:04<01:13,  4.11s/it, loss=0.6240, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6240, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.5461, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.5461, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.6011, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.6011, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.5439, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.18it/s, loss=0.5439, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.18it/s, loss=0.5391, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.93it/s, loss=0.5391, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.93it/s, loss=0.5187, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.77it/s, loss=0.5187, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.77it/s, loss=0.5070, gradTraining Epoch 4/5:  42%|4| 8/19 [00:04<00:02,  4.63it/s, loss=0.5070, gradTraining Epoch 4/5:  42%|4| 8/19 [00:05<00:02,  4.63it/s, loss=0.4608, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.43it/s, loss=0.4608, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.43it/s, loss=0.5542, gradTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.18it/s, loss=0.5542, graTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.18it/s, loss=0.6006, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.89it/s, loss=0.6006, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.89it/s, loss=0.4431, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.50it/s, loss=0.4431, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.50it/s, loss=0.5119, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  8.01it/s, loss=0.5119, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  8.01it/s, loss=0.4514, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.29it/s, loss=0.4514, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.29it/s, loss=0.5601, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.55it/s, loss=0.5601, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.55it/s, loss=0.4791, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.69it/s, loss=0.4791, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.69it/s, loss=0.5135, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.82it/s, loss=0.5135, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.82it/s, loss=0.4190, graTraining Epoch 4/5:  95%|9| 18/19 [00:05<00:00,  8.92it/s, loss=0.4190, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.92it/s, loss=0.3792, graTraining Epoch 4/5: 100%|#| 19/19 [00:06<00:00,  2.85it/s, loss=0.3792, gra

Epoch 4/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.5188, Acc: 0.8784, Precision: 0.8733, Recall: 0.8851, F1: 0.8792, AUC: 0.9488
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.4127, grad_norm=2.Training Epoch 5/5:   5%| | 1/19 [00:04<01:13,  4.08s/it, loss=0.4127, gradTraining Epoch 5/5:   5%| | 1/19 [00:04<01:13,  4.08s/it, loss=0.3679, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:29,  1.75s/it, loss=0.3679, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:29,  1.75s/it, loss=0.4734, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.4734, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.3944, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.3944, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.3249, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.3249, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.3515, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.3515, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.96it/s, loss=0.4190, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.71it/s, loss=0.4190, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.71it/s, loss=0.5491, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.44it/s, loss=0.5491, gradTraining Epoch 5/5:  42%|4| 8/19 [00:05<00:02,  4.44it/s, loss=0.3904, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.15it/s, loss=0.3904, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.15it/s, loss=0.2515, gradTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  5.92it/s, loss=0.2515, graTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  5.92it/s, loss=0.3591, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.28it/s, loss=0.3591, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.28it/s, loss=0.2964, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:01,  6.63it/s, loss=0.2964, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:01,  6.63it/s, loss=0.2849, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.01it/s, loss=0.2849, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.01it/s, loss=0.2542, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.52it/s, loss=0.2542, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.52it/s, loss=0.3110, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  7.70it/s, loss=0.3110, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  7.70it/s, loss=0.2273, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  7.75it/s, loss=0.2273, graTraining Epoch 5/5:  84%|8| 16/19 [00:06<00:00,  7.75it/s, loss=0.2583, graTraining Epoch 5/5:  89%|8| 17/19 [00:06<00:00,  7.83it/s, loss=0.2583, graTraining Epoch 5/5:  89%|8| 17/19 [00:06<00:00,  7.83it/s, loss=0.3242, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  8.22it/s, loss=0.3242, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  8.22it/s, loss=0.3239, graTraining Epoch 5/5: 100%|#| 19/19 [00:06<00:00,  2.78it/s, loss=0.3239, gra

Epoch 5/5 Complete (7.2s) [LR: 0.000005]
Train - Loss: 0.3460, Acc: 0.9493, Precision: 0.9290, Recall: 0.9730, F1: 0.9505, AUC: 0.9814
------------------------------------------------------------
Training curves saved to model\chb14_fold5\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb14_fold5
============================================================
✅ Fold 5 training completed successfully!

============================================================
TRAINING FOLD 6/7
============================================================
Using dataset prefix: chb14_fold6
Loading datasets from: preprocessing\data\chb14_fold6
Saving models to: model\chb14_fold6
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.0290, std=2.5261
Loaded train dataset: 296 samples
  - Spectrogram shape: torch.Size([296, 30, 18, 50, 10])
  - Value range: [-4.7389, 3.7424]
  - Class distribution: tensor([148, 148])
LOOCV Mode (Fold 6): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.7026, grad_norm=1.Training Epoch 1/5:   5%| | 1/19 [00:04<01:13,  4.06s/it, loss=0.7026, gradTraining Epoch 1/5:   5%| | 1/19 [00:04<01:13,  4.06s/it, loss=0.6772, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6772, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6826, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6826, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6944, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.6944, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.7053, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.18it/s, loss=0.7053, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.18it/s, loss=0.7052, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.94it/s, loss=0.7052, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.94it/s, loss=0.6750, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.77it/s, loss=0.6750, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.77it/s, loss=0.6878, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.62it/s, loss=0.6878, gradTraining Epoch 1/5:  42%|4| 8/19 [00:04<00:02,  4.62it/s, loss=0.6728, gradTraining Epoch 1/5:  47%|4| 9/19 [00:04<00:01,  5.47it/s, loss=0.6728, gradTraining Epoch 1/5:  47%|4| 9/19 [00:05<00:01,  5.47it/s, loss=0.6882, gradTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.24it/s, loss=0.6882, graTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  6.24it/s, loss=0.6770, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.93it/s, loss=0.6770, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.93it/s, loss=0.6773, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.52it/s, loss=0.6773, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.52it/s, loss=0.6851, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  8.00it/s, loss=0.6851, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  8.00it/s, loss=0.6868, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.41it/s, loss=0.6868, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  8.41it/s, loss=0.6860, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.37it/s, loss=0.6860, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.37it/s, loss=0.6865, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.13it/s, loss=0.6865, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.13it/s, loss=0.6720, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.33it/s, loss=0.6720, graTraining Epoch 1/5:  89%|8| 17/19 [00:05<00:00,  8.33it/s, loss=0.7077, graTraining Epoch 1/5:  95%|9| 18/19 [00:05<00:00,  8.55it/s, loss=0.7077, graTraining Epoch 1/5:  95%|9| 18/19 [00:06<00:00,  8.55it/s, loss=0.7100, graTraining Epoch 1/5: 100%|#| 19/19 [00:06<00:00,  2.85it/s, loss=0.7100, gra

Epoch 1/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.6884, Acc: 0.5642, Precision: 0.6338, Recall: 0.3041, F1: 0.4110, AUC: 0.6003
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/19 [00:03<?, ?it/s, loss=0.6775, grad_norm=1.Training Epoch 2/5:   5%| | 1/19 [00:03<01:11,  3.99s/it, loss=0.6775, gradTraining Epoch 2/5:   5%| | 1/19 [00:04<01:11,  3.99s/it, loss=0.6829, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.71s/it, loss=0.6829, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.71s/it, loss=0.6822, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.6822, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.6788, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6788, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6742, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.6742, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.6653, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.97it/s, loss=0.6653, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.97it/s, loss=0.6689, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.6689, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.6776, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.67it/s, loss=0.6776, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.67it/s, loss=0.6667, gradTraining Epoch 2/5:  47%|4| 9/19 [00:04<00:01,  5.50it/s, loss=0.6667, gradTraining Epoch 2/5:  47%|4| 9/19 [00:05<00:01,  5.50it/s, loss=0.6544, gradTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.25it/s, loss=0.6544, graTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.25it/s, loss=0.6668, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.86it/s, loss=0.6668, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.86it/s, loss=0.6698, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.42it/s, loss=0.6698, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.42it/s, loss=0.6855, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.80it/s, loss=0.6855, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.80it/s, loss=0.6782, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.13it/s, loss=0.6782, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.13it/s, loss=0.6609, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.49it/s, loss=0.6609, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.49it/s, loss=0.6356, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.70it/s, loss=0.6356, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.70it/s, loss=0.6711, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.77it/s, loss=0.6711, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.77it/s, loss=0.6473, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  8.81it/s, loss=0.6473, graTraining Epoch 2/5:  95%|9| 18/19 [00:05<00:00,  8.81it/s, loss=0.6580, graTraining Epoch 2/5: 100%|#| 19/19 [00:06<00:00,  2.89it/s, loss=0.6580, gra

Epoch 2/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6685, Acc: 0.6757, Precision: 0.6757, Recall: 0.6757, F1: 0.6757, AUC: 0.7427
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6675, grad_norm=1.Training Epoch 3/5:   5%| | 1/19 [00:04<01:13,  4.06s/it, loss=0.6675, gradTraining Epoch 3/5:   5%| | 1/19 [00:04<01:13,  4.06s/it, loss=0.6394, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6394, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.6550, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6550, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.01it/s, loss=0.6296, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6296, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.6311, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.22it/s, loss=0.6311, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.22it/s, loss=0.6271, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.98it/s, loss=0.6271, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.98it/s, loss=0.6594, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.6594, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.6432, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.69it/s, loss=0.6432, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.69it/s, loss=0.5979, gradTraining Epoch 3/5:  47%|4| 9/19 [00:04<00:01,  5.53it/s, loss=0.5979, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.53it/s, loss=0.5967, gradTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.27it/s, loss=0.5967, graTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.27it/s, loss=0.6119, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.85it/s, loss=0.6119, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.85it/s, loss=0.6215, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.38it/s, loss=0.6215, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.38it/s, loss=0.5786, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.70it/s, loss=0.5786, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.70it/s, loss=0.5756, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.09it/s, loss=0.5756, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.09it/s, loss=0.5625, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.36it/s, loss=0.5625, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.36it/s, loss=0.5652, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.57it/s, loss=0.5652, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.57it/s, loss=0.5573, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.85it/s, loss=0.5573, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.85it/s, loss=0.5696, graTraining Epoch 3/5:  95%|9| 18/19 [00:05<00:00,  8.89it/s, loss=0.5696, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  8.89it/s, loss=0.6291, graTraining Epoch 3/5: 100%|#| 19/19 [00:06<00:00,  2.87it/s, loss=0.6291, gra

Epoch 3/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6115, Acc: 0.7872, Precision: 0.7815, Recall: 0.7973, F1: 0.7893, AUC: 0.8765
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6496, grad_norm=2.Training Epoch 4/5:   5%| | 1/19 [00:04<01:12,  4.00s/it, loss=0.6496, gradTraining Epoch 4/5:   5%| | 1/19 [00:04<01:12,  4.00s/it, loss=0.5578, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:29,  1.72s/it, loss=0.5578, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:29,  1.72s/it, loss=0.5404, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.5404, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.4997, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.4997, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.54it/s, loss=0.5192, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.5192, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.20it/s, loss=0.5050, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.97it/s, loss=0.5050, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.97it/s, loss=0.5548, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.5548, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.4532, gradTraining Epoch 4/5:  42%|4| 8/19 [00:04<00:02,  4.68it/s, loss=0.4532, gradTraining Epoch 4/5:  42%|4| 8/19 [00:04<00:02,  4.68it/s, loss=0.4520, gradTraining Epoch 4/5:  47%|4| 9/19 [00:04<00:01,  5.53it/s, loss=0.4520, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.53it/s, loss=0.5268, gradTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.29it/s, loss=0.5268, graTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.29it/s, loss=0.3965, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.94it/s, loss=0.3965, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.94it/s, loss=0.4389, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.43it/s, loss=0.4389, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.43it/s, loss=0.3939, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.95it/s, loss=0.3939, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.95it/s, loss=0.4202, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.30it/s, loss=0.4202, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.30it/s, loss=0.4398, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.57it/s, loss=0.4398, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.57it/s, loss=0.4526, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.72it/s, loss=0.4526, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.72it/s, loss=0.4122, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.75it/s, loss=0.4122, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.75it/s, loss=0.3262, graTraining Epoch 4/5:  95%|9| 18/19 [00:05<00:00,  8.13it/s, loss=0.3262, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.13it/s, loss=0.3789, graTraining Epoch 4/5: 100%|#| 19/19 [00:06<00:00,  2.86it/s, loss=0.3789, gra

Epoch 4/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.4694, Acc: 0.8716, Precision: 0.8767, Recall: 0.8649, F1: 0.8707, AUC: 0.9554
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.3120, grad_norm=2.Training Epoch 5/5:   5%| | 1/19 [00:04<01:14,  4.12s/it, loss=0.3120, gradTraining Epoch 5/5:   5%| | 1/19 [00:04<01:14,  4.12s/it, loss=0.4059, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:30,  1.77s/it, loss=0.4059, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:30,  1.77s/it, loss=0.5017, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.5017, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.3292, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.52it/s, loss=0.3292, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.52it/s, loss=0.2497, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.17it/s, loss=0.2497, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.17it/s, loss=0.2616, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.93it/s, loss=0.2616, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.93it/s, loss=0.2298, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.75it/s, loss=0.2298, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.75it/s, loss=0.2637, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.59it/s, loss=0.2637, gradTraining Epoch 5/5:  42%|4| 8/19 [00:05<00:02,  4.59it/s, loss=0.2855, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.41it/s, loss=0.2855, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.41it/s, loss=0.2297, gradTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.10it/s, loss=0.2297, graTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.10it/s, loss=0.2656, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.72it/s, loss=0.2656, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.72it/s, loss=0.2814, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.29it/s, loss=0.2814, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.29it/s, loss=0.1798, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.67it/s, loss=0.1798, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.67it/s, loss=0.1483, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.98it/s, loss=0.1483, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.98it/s, loss=0.1779, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.24it/s, loss=0.1779, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.24it/s, loss=0.2384, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.44it/s, loss=0.2384, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.44it/s, loss=0.1625, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  8.59it/s, loss=0.1625, graTraining Epoch 5/5:  89%|8| 17/19 [00:06<00:00,  8.59it/s, loss=0.1268, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  8.61it/s, loss=0.1268, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  8.61it/s, loss=0.2258, graTraining Epoch 5/5: 100%|#| 19/19 [00:06<00:00,  2.80it/s, loss=0.2258, gra

Epoch 5/5 Complete (7.2s) [LR: 0.000005]
Train - Loss: 0.2566, Acc: 0.9696, Precision: 0.9484, Recall: 0.9932, F1: 0.9703, AUC: 0.9931
------------------------------------------------------------
Training curves saved to model\chb14_fold6\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb14_fold6
============================================================
✅ Fold 6 training completed successfully!

============================================================
TRAINING FOLD 7/7
============================================================
Using dataset prefix: chb14_fold7
Loading datasets from: preprocessing\data\chb14_fold7
Saving models to: model\chb14_fold7
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.0041, std=2.5184
Loaded train dataset: 296 samples
  - Spectrogram shape: torch.Size([296, 30, 18, 50, 10])
  - Value range: [-4.7634, 3.7441]
  - Class distribution: tensor([148, 148])
LOOCV Mode (Fold 7): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6938, grad_norm=1.Training Epoch 1/5:   5%| | 1/19 [00:04<01:15,  4.18s/it, loss=0.6938, gradTraining Epoch 1/5:   5%| | 1/19 [00:04<01:15,  4.18s/it, loss=0.6907, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:30,  1.80s/it, loss=0.6907, gradTraining Epoch 1/5:  11%|1| 2/19 [00:04<00:30,  1.80s/it, loss=0.6912, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.04s/it, loss=0.6912, gradTraining Epoch 1/5:  16%|1| 3/19 [00:04<00:16,  1.04s/it, loss=0.6888, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:10,  1.49it/s, loss=0.6888, gradTraining Epoch 1/5:  21%|2| 4/19 [00:04<00:10,  1.49it/s, loss=0.6995, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.13it/s, loss=0.6995, gradTraining Epoch 1/5:  26%|2| 5/19 [00:04<00:06,  2.13it/s, loss=0.6927, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.88it/s, loss=0.6927, gradTraining Epoch 1/5:  32%|3| 6/19 [00:04<00:04,  2.88it/s, loss=0.6982, gradTraining Epoch 1/5:  37%|3| 7/19 [00:04<00:03,  3.66it/s, loss=0.6982, gradTraining Epoch 1/5:  37%|3| 7/19 [00:05<00:03,  3.66it/s, loss=0.6893, gradTraining Epoch 1/5:  42%|4| 8/19 [00:05<00:02,  4.49it/s, loss=0.6893, gradTraining Epoch 1/5:  42%|4| 8/19 [00:05<00:02,  4.49it/s, loss=0.6819, gradTraining Epoch 1/5:  47%|4| 9/19 [00:05<00:01,  5.28it/s, loss=0.6819, gradTraining Epoch 1/5:  47%|4| 9/19 [00:05<00:01,  5.28it/s, loss=0.6831, gradTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  5.98it/s, loss=0.6831, graTraining Epoch 1/5:  53%|5| 10/19 [00:05<00:01,  5.98it/s, loss=0.6805, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.70it/s, loss=0.6805, graTraining Epoch 1/5:  58%|5| 11/19 [00:05<00:01,  6.70it/s, loss=0.6890, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.21it/s, loss=0.6890, graTraining Epoch 1/5:  63%|6| 12/19 [00:05<00:00,  7.21it/s, loss=0.6999, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  7.63it/s, loss=0.6999, graTraining Epoch 1/5:  68%|6| 13/19 [00:05<00:00,  7.63it/s, loss=0.6953, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  7.95it/s, loss=0.6953, graTraining Epoch 1/5:  74%|7| 14/19 [00:05<00:00,  7.95it/s, loss=0.6783, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.18it/s, loss=0.6783, graTraining Epoch 1/5:  79%|7| 15/19 [00:05<00:00,  8.18it/s, loss=0.6954, graTraining Epoch 1/5:  84%|8| 16/19 [00:05<00:00,  8.27it/s, loss=0.6954, graTraining Epoch 1/5:  84%|8| 16/19 [00:06<00:00,  8.27it/s, loss=0.6803, graTraining Epoch 1/5:  89%|8| 17/19 [00:06<00:00,  8.34it/s, loss=0.6803, graTraining Epoch 1/5:  89%|8| 17/19 [00:06<00:00,  8.34it/s, loss=0.6984, graTraining Epoch 1/5:  95%|9| 18/19 [00:06<00:00,  8.48it/s, loss=0.6984, graTraining Epoch 1/5:  95%|9| 18/19 [00:06<00:00,  8.48it/s, loss=0.6872, graTraining Epoch 1/5: 100%|#| 19/19 [00:06<00:00,  2.76it/s, loss=0.6872, gra

Epoch 1/5 Complete (7.3s) [LR: 0.000010]
Train - Loss: 0.6902, Acc: 0.5473, Precision: 0.5307, Recall: 0.8176, F1: 0.6436, AUC: 0.5566
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.6812, grad_norm=1.Training Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.11s/it, loss=0.6812, gradTraining Epoch 2/5:   5%| | 1/19 [00:04<01:13,  4.11s/it, loss=0.6802, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6802, gradTraining Epoch 2/5:  11%|1| 2/19 [00:04<00:29,  1.76s/it, loss=0.6808, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.6808, gradTraining Epoch 2/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.7023, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.7023, gradTraining Epoch 2/5:  21%|2| 4/19 [00:04<00:09,  1.53it/s, loss=0.6577, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.17it/s, loss=0.6577, gradTraining Epoch 2/5:  26%|2| 5/19 [00:04<00:06,  2.17it/s, loss=0.6920, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.89it/s, loss=0.6920, gradTraining Epoch 2/5:  32%|3| 6/19 [00:04<00:04,  2.89it/s, loss=0.6857, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.71it/s, loss=0.6857, gradTraining Epoch 2/5:  37%|3| 7/19 [00:04<00:03,  3.71it/s, loss=0.6802, gradTraining Epoch 2/5:  42%|4| 8/19 [00:04<00:02,  4.52it/s, loss=0.6802, gradTraining Epoch 2/5:  42%|4| 8/19 [00:05<00:02,  4.52it/s, loss=0.6646, gradTraining Epoch 2/5:  47%|4| 9/19 [00:05<00:01,  5.31it/s, loss=0.6646, gradTraining Epoch 2/5:  47%|4| 9/19 [00:05<00:01,  5.31it/s, loss=0.6871, gradTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.07it/s, loss=0.6871, graTraining Epoch 2/5:  53%|5| 10/19 [00:05<00:01,  6.07it/s, loss=0.6564, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.73it/s, loss=0.6564, graTraining Epoch 2/5:  58%|5| 11/19 [00:05<00:01,  6.73it/s, loss=0.6714, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.28it/s, loss=0.6714, graTraining Epoch 2/5:  63%|6| 12/19 [00:05<00:00,  7.28it/s, loss=0.6605, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.70it/s, loss=0.6605, graTraining Epoch 2/5:  68%|6| 13/19 [00:05<00:00,  7.70it/s, loss=0.6939, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.06it/s, loss=0.6939, graTraining Epoch 2/5:  74%|7| 14/19 [00:05<00:00,  8.06it/s, loss=0.6505, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.33it/s, loss=0.6505, graTraining Epoch 2/5:  79%|7| 15/19 [00:05<00:00,  8.33it/s, loss=0.6479, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.58it/s, loss=0.6479, graTraining Epoch 2/5:  84%|8| 16/19 [00:05<00:00,  8.58it/s, loss=0.6699, graTraining Epoch 2/5:  89%|8| 17/19 [00:05<00:00,  8.76it/s, loss=0.6699, graTraining Epoch 2/5:  89%|8| 17/19 [00:06<00:00,  8.76it/s, loss=0.6637, graTraining Epoch 2/5:  95%|9| 18/19 [00:06<00:00,  8.94it/s, loss=0.6637, graTraining Epoch 2/5:  95%|9| 18/19 [00:06<00:00,  8.94it/s, loss=0.6521, graTraining Epoch 2/5: 100%|#| 19/19 [00:06<00:00,  2.84it/s, loss=0.6521, gra

Epoch 2/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.6725, Acc: 0.6520, Precision: 0.6347, Recall: 0.7162, F1: 0.6730, AUC: 0.7443
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/19 [00:03<?, ?it/s, loss=0.6544, grad_norm=1.Training Epoch 3/5:   5%| | 1/19 [00:03<01:11,  4.00s/it, loss=0.6544, gradTraining Epoch 3/5:   5%| | 1/19 [00:04<01:11,  4.00s/it, loss=0.6248, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.71s/it, loss=0.6248, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:29,  1.71s/it, loss=0.6446, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.6446, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:15,  1.02it/s, loss=0.6334, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.57it/s, loss=0.6334, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:09,  1.57it/s, loss=0.6041, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.24it/s, loss=0.6041, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.24it/s, loss=0.6680, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.97it/s, loss=0.6680, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.97it/s, loss=0.6229, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.6229, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.5603, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.69it/s, loss=0.5603, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.69it/s, loss=0.6040, gradTraining Epoch 3/5:  47%|4| 9/19 [00:04<00:01,  5.55it/s, loss=0.6040, gradTraining Epoch 3/5:  47%|4| 9/19 [00:04<00:01,  5.55it/s, loss=0.6022, gradTraining Epoch 3/5:  53%|5| 10/19 [00:04<00:01,  6.34it/s, loss=0.6022, graTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.34it/s, loss=0.5840, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  7.03it/s, loss=0.5840, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  7.03it/s, loss=0.5670, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.57it/s, loss=0.5670, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.57it/s, loss=0.5905, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  8.01it/s, loss=0.5905, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  8.01it/s, loss=0.5537, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.35it/s, loss=0.5537, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.35it/s, loss=0.6211, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.57it/s, loss=0.6211, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.57it/s, loss=0.5598, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.73it/s, loss=0.5598, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.73it/s, loss=0.5263, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.82it/s, loss=0.5263, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.82it/s, loss=0.5427, graTraining Epoch 3/5:  95%|9| 18/19 [00:05<00:00,  8.92it/s, loss=0.5427, graTraining Epoch 3/5:  95%|9| 18/19 [00:05<00:00,  8.92it/s, loss=0.5365, graTraining Epoch 3/5: 100%|#| 19/19 [00:06<00:00,  2.92it/s, loss=0.5365, gra

Epoch 3/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.5947, Acc: 0.8412, Precision: 0.8137, Recall: 0.8851, F1: 0.8479, AUC: 0.9148
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.5351, grad_norm=1.Training Epoch 4/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.5351, gradTraining Epoch 4/5:   5%| | 1/19 [00:04<01:13,  4.07s/it, loss=0.5090, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.5090, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:29,  1.74s/it, loss=0.4885, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.4885, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:15,  1.00it/s, loss=0.4740, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.4740, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:09,  1.55it/s, loss=0.5394, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.5394, gradTraining Epoch 4/5:  26%|2| 5/19 [00:04<00:06,  2.21it/s, loss=0.5824, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.99it/s, loss=0.5824, gradTraining Epoch 4/5:  32%|3| 6/19 [00:04<00:04,  2.99it/s, loss=0.4472, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.4472, gradTraining Epoch 4/5:  37%|3| 7/19 [00:04<00:03,  3.82it/s, loss=0.5046, gradTraining Epoch 4/5:  42%|4| 8/19 [00:04<00:02,  4.69it/s, loss=0.5046, gradTraining Epoch 4/5:  42%|4| 8/19 [00:04<00:02,  4.69it/s, loss=0.4705, gradTraining Epoch 4/5:  47%|4| 9/19 [00:04<00:01,  5.52it/s, loss=0.4705, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:01,  5.52it/s, loss=0.4240, gradTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.33it/s, loss=0.4240, graTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  6.33it/s, loss=0.4662, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.99it/s, loss=0.4662, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.99it/s, loss=0.3496, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.51it/s, loss=0.3496, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:00,  7.51it/s, loss=0.3828, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.91it/s, loss=0.3828, graTraining Epoch 4/5:  68%|6| 13/19 [00:05<00:00,  7.91it/s, loss=0.4111, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.27it/s, loss=0.4111, graTraining Epoch 4/5:  74%|7| 14/19 [00:05<00:00,  8.27it/s, loss=0.6226, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.55it/s, loss=0.6226, graTraining Epoch 4/5:  79%|7| 15/19 [00:05<00:00,  8.55it/s, loss=0.3611, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.70it/s, loss=0.3611, graTraining Epoch 4/5:  84%|8| 16/19 [00:05<00:00,  8.70it/s, loss=0.3819, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.83it/s, loss=0.3819, graTraining Epoch 4/5:  89%|8| 17/19 [00:05<00:00,  8.83it/s, loss=0.4239, graTraining Epoch 4/5:  95%|9| 18/19 [00:05<00:00,  8.95it/s, loss=0.4239, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.95it/s, loss=0.5280, graTraining Epoch 4/5: 100%|#| 19/19 [00:06<00:00,  2.89it/s, loss=0.5280, gra

Epoch 4/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.4685, Acc: 0.8818, Precision: 0.8343, Recall: 0.9527, F1: 0.8896, AUC: 0.9489
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/19 [00:03<?, ?it/s, loss=0.2993, grad_norm=1.Training Epoch 5/5:   5%| | 1/19 [00:03<01:10,  3.94s/it, loss=0.2993, gradTraining Epoch 5/5:   5%| | 1/19 [00:04<01:10,  3.94s/it, loss=0.3147, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:28,  1.69s/it, loss=0.3147, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:28,  1.69s/it, loss=0.4256, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.03it/s, loss=0.4256, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:15,  1.03it/s, loss=0.2977, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.59it/s, loss=0.2977, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:09,  1.59it/s, loss=0.3081, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.27it/s, loss=0.3081, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.27it/s, loss=0.2991, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  3.05it/s, loss=0.2991, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  3.05it/s, loss=0.3032, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.89it/s, loss=0.3032, gradTraining Epoch 5/5:  37%|3| 7/19 [00:04<00:03,  3.89it/s, loss=0.2213, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.70it/s, loss=0.2213, gradTraining Epoch 5/5:  42%|4| 8/19 [00:04<00:02,  4.70it/s, loss=0.3027, gradTraining Epoch 5/5:  47%|4| 9/19 [00:04<00:01,  5.54it/s, loss=0.3027, gradTraining Epoch 5/5:  47%|4| 9/19 [00:04<00:01,  5.54it/s, loss=0.3666, gradTraining Epoch 5/5:  53%|5| 10/19 [00:04<00:01,  6.30it/s, loss=0.3666, graTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.30it/s, loss=0.2597, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.93it/s, loss=0.2597, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.93it/s, loss=0.4029, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.49it/s, loss=0.4029, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.49it/s, loss=0.2649, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.96it/s, loss=0.2649, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.96it/s, loss=0.2255, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  8.33it/s, loss=0.2255, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  8.33it/s, loss=0.2546, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.65it/s, loss=0.2546, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  8.65it/s, loss=0.1636, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.92it/s, loss=0.1636, graTraining Epoch 5/5:  84%|8| 16/19 [00:05<00:00,  8.92it/s, loss=0.1694, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  8.75it/s, loss=0.1694, graTraining Epoch 5/5:  89%|8| 17/19 [00:05<00:00,  8.75it/s, loss=0.1627, graTraining Epoch 5/5:  95%|9| 18/19 [00:05<00:00,  8.79it/s, loss=0.1627, graTraining Epoch 5/5:  95%|9| 18/19 [00:05<00:00,  8.79it/s, loss=0.4862, graTraining Epoch 5/5: 100%|#| 19/19 [00:06<00:00,  2.94it/s, loss=0.4862, gra

Epoch 5/5 Complete (6.9s) [LR: 0.000005]
Train - Loss: 0.2909, Acc: 0.9493, Precision: 0.9182, Recall: 0.9865, F1: 0.9511, AUC: 0.9884
------------------------------------------------------------
Training curves saved to model\chb14_fold7\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb14_fold7
============================================================
✅ Fold 7 training completed successfully!

============================================================
✅ BATCH TRAINING COMPLETED!
✅ Trained models for 8 folds for patient chb14
============================================================
============================================================
============================================================
BATCH EVALUATION: ALL FOLDS
BATCH EVALUATION: ALL FOLDS
Evaluating 8 folds for patient chb14
Evaluating 8 folds for patient chb14
============================================================
============================================================
Using CUDA: NVIDIA GeForce RTX 3090 Ti
Using CUDA: NVIDIA GeForce RTX 3090 Ti

============================================================
============================================================

EVALUATING FOLD 0/7
EVALUATING FOLD 0/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb14_fold0
Dataset prefix: chb14_fold0
Using test dataset: preprocessing\data\chb14_fold0\test_dataset.h5
Using test dataset: preprocessing\data\chb14_fold0\test_dataset.h5
Loading test dataset from preprocessing\data\chb14_fold0\test_dataset.h5...
Loading test dataset from preprocessing\data\chb14_fold0\test_dataset.h5...
  - Normalization: z-score, mean=-0.0061, std=2.5139
  - Normalization: z-score, mean=-0.0061, std=2.5139
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-4.7710, 3.7492]
  - Value range: [-4.7710, 3.7492]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb14_fold0\epoch_005.pth...
Loading model checkpoint from model\chb14_fold0\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:  33%|############################################################################6                                                                                                                                                         | 1/3 [00:00<00:00,  3.98it/s]Testing:  33%|############################################################################6                                                                                                                                                         | 1/3 [00:00<00:00,  3.98it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00,  8.92it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00,  8.92it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.4415
Loss:      0.4415
Accuracy:  0.8958 (89.58%)
Accuracy:  0.8958 (89.58%)
Precision: 1.0000
Precision: 1.0000
Recall:    0.7917
Recall:    0.7917
F1 Score:  0.8837
F1 Score:  0.8837
AUC-ROC:   0.9965
AUC-ROC:   0.9965

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        24         0
Actual Interictal        24         0
       Preictal         5        19
       Preictal         5        19

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 29 samples
Pred Interictal (0): 29 samples
Pred Preictal (1):   19 samples
Pred Preictal (1):   19 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.8276    1.0000    0.9057        24
    Preictal     1.0000    0.7917    0.8837        24

    accuracy                         0.8958        48
   macro avg     0.9138    0.8958    0.8947        48
weighted avg     0.9138    0.8958    0.8947        48
              precision    recall  f1-score   support

  Interictal     0.8276    1.0000    0.9057        24
    Preictal     1.0000    0.7917    0.8837        24

    accuracy                         0.8958        48
   macro avg     0.9138    0.8958    0.8947        48
weighted avg     0.9138    0.8958    0.8947        48



✅ Results saved to model\chb14_fold0\test_results.json
✅ Results saved to model\chb14_fold0\test_results.json


============================================================
============================================================

EVALUATING FOLD 1/7
EVALUATING FOLD 1/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb14_fold1
Dataset prefix: chb14_fold1
Using test dataset: preprocessing\data\chb14_fold1\test_dataset.h5
Using test dataset: preprocessing\data\chb14_fold1\test_dataset.h5
Loading test dataset from preprocessing\data\chb14_fold1\test_dataset.h5...
Loading test dataset from preprocessing\data\chb14_fold1\test_dataset.h5...
  - Normalization: z-score, mean=-0.0186, std=2.5149
  - Normalization: z-score, mean=-0.0186, std=2.5149
Loaded test dataset: 22 samples
Loaded test dataset: 22 samples
  - Spectrogram shape: torch.Size([22, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([22, 30, 18, 50, 10])
  - Value range: [-4.7641, 3.7404]
  - Value range: [-4.7641, 3.7404]
  - Class distribution: tensor([11, 11])
  - Class distribution: tensor([11, 11])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb14_fold1\epoch_005.pth...
Loading model checkpoint from model\chb14_fold1\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/2 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/2 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 2/2 [00:00<00:00, 36.73it/s]Testing: 100%|######################################################################################################################################################################################################################################| 2/2 [00:00<00:00, 36.73it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.4665
Loss:      0.4665
Accuracy:  0.8182 (81.82%)
Accuracy:  0.8182 (81.82%)
Precision: 0.7333
Precision: 0.7333
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.8462
F1 Score:  0.8462
AUC-ROC:   0.9669
AUC-ROC:   0.9669

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         7         4
Actual Interictal         7         4
       Preictal         0        11
       Preictal         0        11

Class Distribution:
Class Distribution:

True Interictal (0): 11 samples
True Interictal (0): 11 samples
True Preictal (1):   11 samples
True Preictal (1):   11 samples
Pred Interictal (0): 7 samples
Pred Interictal (0): 7 samples
Pred Preictal (1):   15 samples
Pred Preictal (1):   15 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.6364    0.7778        11
    Preictal     0.7333    1.0000    0.8462        11

    accuracy                         0.8182        22
   macro avg     0.8667    0.8182    0.8120        22
weighted avg     0.8667    0.8182    0.8120        22
              precision    recall  f1-score   support

  Interictal     1.0000    0.6364    0.7778        11
    Preictal     0.7333    1.0000    0.8462        11

    accuracy                         0.8182        22
   macro avg     0.8667    0.8182    0.8120        22
weighted avg     0.8667    0.8182    0.8120        22



✅ Results saved to model\chb14_fold1\test_results.json
✅ Results saved to model\chb14_fold1\test_results.json


============================================================
============================================================

EVALUATING FOLD 2/7
EVALUATING FOLD 2/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb14_fold2
Dataset prefix: chb14_fold2
Using test dataset: preprocessing\data\chb14_fold2\test_dataset.h5
Using test dataset: preprocessing\data\chb14_fold2\test_dataset.h5
Loading test dataset from preprocessing\data\chb14_fold2\test_dataset.h5...
Loading test dataset from preprocessing\data\chb14_fold2\test_dataset.h5...
  - Normalization: z-score, mean=-0.0161, std=2.5186
  - Normalization: z-score, mean=-0.0161, std=2.5186
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-4.7580, 3.6265]
  - Value range: [-4.7580, 3.6265]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb14_fold2\epoch_005.pth...
Loading model checkpoint from model\chb14_fold2\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.63it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.63it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.4392
Loss:      0.4392
Accuracy:  0.8125 (81.25%)
Accuracy:  0.8125 (81.25%)
Precision: 0.9412
Precision: 0.9412
Recall:    0.6667
Recall:    0.6667
F1 Score:  0.7805
F1 Score:  0.7805
AUC-ROC:   0.9462
AUC-ROC:   0.9462

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        23         1
Actual Interictal        23         1
       Preictal         8        16
       Preictal         8        16

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 31 samples
Pred Interictal (0): 31 samples
Pred Preictal (1):   17 samples
Pred Preictal (1):   17 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.7419    0.9583    0.8364        24
    Preictal     0.9412    0.6667    0.7805        24

    accuracy                         0.8125        48
   macro avg     0.8416    0.8125    0.8084        48
weighted avg     0.8416    0.8125    0.8084        48
              precision    recall  f1-score   support

  Interictal     0.7419    0.9583    0.8364        24
    Preictal     0.9412    0.6667    0.7805        24

    accuracy                         0.8125        48
   macro avg     0.8416    0.8125    0.8084        48
weighted avg     0.8416    0.8125    0.8084        48



✅ Results saved to model\chb14_fold2\test_results.json
✅ Results saved to model\chb14_fold2\test_results.json


============================================================
============================================================

EVALUATING FOLD 3/7
EVALUATING FOLD 3/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb14_fold3
Dataset prefix: chb14_fold3
Using test dataset: preprocessing\data\chb14_fold3\test_dataset.h5
Using test dataset: preprocessing\data\chb14_fold3\test_dataset.h5
Loading test dataset from preprocessing\data\chb14_fold3\test_dataset.h5...
Loading test dataset from preprocessing\data\chb14_fold3\test_dataset.h5...
  - Normalization: z-score, mean=-0.0178, std=2.5223
  - Normalization: z-score, mean=-0.0178, std=2.5223
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-4.7458, 3.6921]
  - Value range: [-4.7458, 3.6921]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb14_fold3\epoch_005.pth...
Loading model checkpoint from model\chb14_fold3\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.17it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.17it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.08it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.08it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.2977
Loss:      0.2977
Accuracy:  0.8913 (89.13%)
Accuracy:  0.8913 (89.13%)
Precision: 0.8214
Precision: 0.8214
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9020
F1 Score:  0.9020
AUC-ROC:   0.9962
AUC-ROC:   0.9962

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        18         5
Actual Interictal        18         5
       Preictal         0        23
       Preictal         0        23

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 18 samples
Pred Interictal (0): 18 samples
Pred Preictal (1):   28 samples
Pred Preictal (1):   28 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.7826    0.8780        23
    Preictal     0.8214    1.0000    0.9020        23

    accuracy                         0.8913        46
   macro avg     0.9107    0.8913    0.8900        46
weighted avg     0.9107    0.8913    0.8900        46
              precision    recall  f1-score   support

  Interictal     1.0000    0.7826    0.8780        23
    Preictal     0.8214    1.0000    0.9020        23

    accuracy                         0.8913        46
   macro avg     0.9107    0.8913    0.8900        46
weighted avg     0.9107    0.8913    0.8900        46



✅ Results saved to model\chb14_fold3\test_results.json
✅ Results saved to model\chb14_fold3\test_results.json


============================================================
============================================================

EVALUATING FOLD 4/7
EVALUATING FOLD 4/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb14_fold4
Dataset prefix: chb14_fold4
Using test dataset: preprocessing\data\chb14_fold4\test_dataset.h5
Using test dataset: preprocessing\data\chb14_fold4\test_dataset.h5
Loading test dataset from preprocessing\data\chb14_fold4\test_dataset.h5...
Loading test dataset from preprocessing\data\chb14_fold4\test_dataset.h5...
  - Normalization: z-score, mean=-0.0013, std=2.5141
  - Normalization: z-score, mean=-0.0013, std=2.5141
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-4.7724, 3.6959]
  - Value range: [-4.7724, 3.6959]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb14_fold4\epoch_005.pth...
Loading model checkpoint from model\chb14_fold4\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 33.79it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 33.79it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.8946
Loss:      0.8946
Accuracy:  0.4750 (47.50%)
Accuracy:  0.4750 (47.50%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.6500
AUC-ROC:   0.6500

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        19         1
Actual Interictal        19         1
       Preictal        20         0
       Preictal        20         0

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 39 samples
Pred Interictal (0): 39 samples
Pred Preictal (1):   1 samples
Pred Preictal (1):   1 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4872    0.9500    0.6441        20
    Preictal     0.0000    0.0000    0.0000        20

    accuracy                         0.4750        40
   macro avg     0.2436    0.4750    0.3220        40
weighted avg     0.2436    0.4750    0.3220        40
              precision    recall  f1-score   support

  Interictal     0.4872    0.9500    0.6441        20
    Preictal     0.0000    0.0000    0.0000        20

    accuracy                         0.4750        40
   macro avg     0.2436    0.4750    0.3220        40
weighted avg     0.2436    0.4750    0.3220        40



✅ Results saved to model\chb14_fold4\test_results.json
✅ Results saved to model\chb14_fold4\test_results.json


============================================================
============================================================

EVALUATING FOLD 5/7
EVALUATING FOLD 5/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb14_fold5
Dataset prefix: chb14_fold5
Using test dataset: preprocessing\data\chb14_fold5\test_dataset.h5
Using test dataset: preprocessing\data\chb14_fold5\test_dataset.h5
Loading test dataset from preprocessing\data\chb14_fold5\test_dataset.h5...
Loading test dataset from preprocessing\data\chb14_fold5\test_dataset.h5...
  - Normalization: z-score, mean=-0.0166, std=2.5289
  - Normalization: z-score, mean=-0.0166, std=2.5289
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-4.7386, 3.6323]
  - Value range: [-4.7386, 3.6323]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb14_fold5\epoch_005.pth...
Loading model checkpoint from model\chb14_fold5\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 31.37it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 31.37it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.3823
Loss:      0.3823
Accuracy:  0.8409 (84.09%)
Accuracy:  0.8409 (84.09%)
Precision: 0.7778
Precision: 0.7778
Recall:    0.9545
Recall:    0.9545
F1 Score:  0.8571
F1 Score:  0.8571
AUC-ROC:   0.9525
AUC-ROC:   0.9525

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        16         6
Actual Interictal        16         6
       Preictal         1        21
       Preictal         1        21

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 17 samples
Pred Interictal (0): 17 samples
Pred Preictal (1):   27 samples
Pred Preictal (1):   27 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.9412    0.7273    0.8205        22
    Preictal     0.7778    0.9545    0.8571        22

    accuracy                         0.8409        44
   macro avg     0.8595    0.8409    0.8388        44
weighted avg     0.8595    0.8409    0.8388        44
              precision    recall  f1-score   support

  Interictal     0.9412    0.7273    0.8205        22
    Preictal     0.7778    0.9545    0.8571        22

    accuracy                         0.8409        44
   macro avg     0.8595    0.8409    0.8388        44
weighted avg     0.8595    0.8409    0.8388        44



✅ Results saved to model\chb14_fold5\test_results.json
✅ Results saved to model\chb14_fold5\test_results.json


============================================================
============================================================

EVALUATING FOLD 6/7
EVALUATING FOLD 6/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb14_fold6
Dataset prefix: chb14_fold6
Using test dataset: preprocessing\data\chb14_fold6\test_dataset.h5
Using test dataset: preprocessing\data\chb14_fold6\test_dataset.h5
Loading test dataset from preprocessing\data\chb14_fold6\test_dataset.h5...
Loading test dataset from preprocessing\data\chb14_fold6\test_dataset.h5...
  - Normalization: z-score, mean=-0.0290, std=2.5261
  - Normalization: z-score, mean=-0.0290, std=2.5261
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-4.7389, 3.7465]
  - Value range: [-4.7389, 3.7465]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb14_fold6\epoch_005.pth...
Loading model checkpoint from model\chb14_fold6\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.43it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.43it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.4117
Loss:      0.4117
Accuracy:  0.8333 (83.33%)
Accuracy:  0.8333 (83.33%)
Precision: 0.8636
Precision: 0.8636
Recall:    0.7917
Recall:    0.7917
F1 Score:  0.8261
F1 Score:  0.8261
AUC-ROC:   0.9340
AUC-ROC:   0.9340

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        21         3
Actual Interictal        21         3
       Preictal         5        19
       Preictal         5        19

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 26 samples
Pred Interictal (0): 26 samples
Pred Preictal (1):   22 samples
Pred Preictal (1):   22 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.8077    0.8750    0.8400        24
    Preictal     0.8636    0.7917    0.8261        24

    accuracy                         0.8333        48
   macro avg     0.8357    0.8333    0.8330        48
weighted avg     0.8357    0.8333    0.8330        48
              precision    recall  f1-score   support

  Interictal     0.8077    0.8750    0.8400        24
    Preictal     0.8636    0.7917    0.8261        24

    accuracy                         0.8333        48
   macro avg     0.8357    0.8333    0.8330        48
weighted avg     0.8357    0.8333    0.8330        48



✅ Results saved to model\chb14_fold6\test_results.json
✅ Results saved to model\chb14_fold6\test_results.json


============================================================
============================================================

EVALUATING FOLD 7/7
EVALUATING FOLD 7/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb14_fold7
Dataset prefix: chb14_fold7
Using test dataset: preprocessing\data\chb14_fold7\test_dataset.h5
Using test dataset: preprocessing\data\chb14_fold7\test_dataset.h5
Loading test dataset from preprocessing\data\chb14_fold7\test_dataset.h5...
Loading test dataset from preprocessing\data\chb14_fold7\test_dataset.h5...
  - Normalization: z-score, mean=-0.0041, std=2.5184
  - Normalization: z-score, mean=-0.0041, std=2.5184
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-4.7634, 3.7053]
  - Value range: [-4.7634, 3.7053]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb14_fold7\epoch_005.pth...
Loading model checkpoint from model\chb14_fold7\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.23it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.23it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      1.1063
Loss:      1.1063
Accuracy:  0.4375 (43.75%)
Accuracy:  0.4375 (43.75%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.3594
AUC-ROC:   0.3594

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        21         3
Actual Interictal        21         3
       Preictal        24         0
       Preictal        24         0

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 45 samples
Pred Interictal (0): 45 samples
Pred Preictal (1):   3 samples
Pred Preictal (1):   3 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4667    0.8750    0.6087        24
    Preictal     0.0000    0.0000    0.0000        24

    accuracy                         0.4375        48
   macro avg     0.2333    0.4375    0.3043        48
weighted avg     0.2333    0.4375    0.3043        48
              precision    recall  f1-score   support

  Interictal     0.4667    0.8750    0.6087        24
    Preictal     0.0000    0.0000    0.0000        24

    accuracy                         0.4375        48
   macro avg     0.2333    0.4375    0.3043        48
weighted avg     0.2333    0.4375    0.3043        48



✅ Results saved to model\chb14_fold7\test_results.json
✅ Results saved to model\chb14_fold7\test_results.json


============================================================
============================================================

BATCH EVALUATION SUMMARY
BATCH EVALUATION SUMMARY
============================================================
============================================================
Folds evaluated: 8/8
Folds evaluated: 8/8

Mean metrics (across folds):
Mean metrics (across folds):

  Accuracy:  0.7506 (±0.1726)
  Accuracy:  0.7506 (±0.1726)
  Precision: 0.6422 (±0.3792)
  Precision: 0.6422 (±0.3792)
  Recall:    0.6506 (±0.3910)
  Recall:    0.6506 (±0.3910)
  F1 Score:  0.6369 (±0.3693)
  F1 Score:  0.6369 (±0.3693)
  AUC-ROC:   0.8502 (±0.2133)
  AUC-ROC:   0.8502 (±0.2133)

✅ Batch results saved to model\batch_test_results.json
✅ Batch results saved to model\batch_test_results.json

============================================================
============================================================
