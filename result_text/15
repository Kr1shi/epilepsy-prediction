============================================================
BATCH PROCESSING: ALL FOLDS
Processing 20 folds for patient chb15
============================================================

Configuration:
  - Task mode: PREDICTION (preictal vs interictal)
  - LOOCV Mode: ENABLED
  - Sequence length: 30 segments
  - Sequence duration: 150s (2.5 min)
  - Stride: 5 segments (83% overlap)
  - Segment duration: 5s
  - Preictal window: 10 min
  - Interictal buffer: 120 min
  - Channel validation: ENABLED
  - Target channels: 18 channels
============================================================

Extracting sequences from patient chb15...
Patient chb15: 597 sequences (412 preictal, 185 interictal)

============================================================
PROCESSING FOLD 0/19
============================================================
Output prefix: chb15_fold0
LOOCV Fold 0: Test seizure=0, Train seizures=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 218
  - Preictal sequences: 109
  - Interictal sequences: 109
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 218 total (109 preictal, 109 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 34 total (17 preictal, 17 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 261.5s (4.4 min)
Class balance: 109/109 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 303 preictal, 0 interictal)
test: 17 preictal, 17 interictal (dropped 0 preictal, 76 interictal)

Sequences saved to chb15_fold0_sequences_prediction.json
File size: 0.36 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 0 completed successfully!
✅ Sequences saved to chb15_fold0_sequences_prediction.json

============================================================
PROCESSING FOLD 1/19
============================================================
Output prefix: chb15_fold1
LOOCV Fold 1: Test seizure=1, Train seizures=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 224
  - Preictal sequences: 112
  - Interictal sequences: 112
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 224 total (112 preictal, 112 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 261.9s (4.4 min)
Class balance: 112/112 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 300 preictal, 0 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 73 interictal)

Sequences saved to chb15_fold1_sequences_prediction.json
File size: 0.37 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 1 completed successfully!
✅ Sequences saved to chb15_fold1_sequences_prediction.json

============================================================
PROCESSING FOLD 2/19
============================================================
Output prefix: chb15_fold2
LOOCV Fold 2: Test seizure=2, Train seizures=[0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 228
  - Preictal sequences: 114
  - Interictal sequences: 114
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 228 total (114 preictal, 114 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 270.1s (4.5 min)
Class balance: 114/114 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 298 preictal, 0 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 71 interictal)

Sequences saved to chb15_fold2_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 2 completed successfully!
✅ Sequences saved to chb15_fold2_sequences_prediction.json

============================================================
PROCESSING FOLD 3/19
============================================================
Output prefix: chb15_fold3
LOOCV Fold 3: Test seizure=3, Train seizures=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 230
  - Preictal sequences: 115
  - Interictal sequences: 115
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 230 total (115 preictal, 115 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 259.5s (4.3 min)
Class balance: 115/115 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 297 preictal, 0 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 70 interictal)

Sequences saved to chb15_fold3_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 3 completed successfully!
✅ Sequences saved to chb15_fold3_sequences_prediction.json

============================================================
PROCESSING FOLD 4/19
============================================================
Output prefix: chb15_fold4
LOOCV Fold 4: Test seizure=4, Train seizures=[0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 222
  - Preictal sequences: 111
  - Interictal sequences: 111
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 222 total (111 preictal, 111 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 269.1s (4.5 min)
Class balance: 111/111 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 301 preictal, 0 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 74 interictal)

Sequences saved to chb15_fold4_sequences_prediction.json
File size: 0.37 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 4 completed successfully!
✅ Sequences saved to chb15_fold4_sequences_prediction.json

============================================================
PROCESSING FOLD 5/19
============================================================
Output prefix: chb15_fold5
LOOCV Fold 5: Test seizure=5, Train seizures=[0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 222
  - Preictal sequences: 111
  - Interictal sequences: 111
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 222 total (111 preictal, 111 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 244.9s (4.1 min)
Class balance: 111/111 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 301 preictal, 0 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 74 interictal)

Sequences saved to chb15_fold5_sequences_prediction.json
File size: 0.37 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 5 completed successfully!
✅ Sequences saved to chb15_fold5_sequences_prediction.json

============================================================
PROCESSING FOLD 6/19
============================================================
Output prefix: chb15_fold6
LOOCV Fold 6: Test seizure=6, Train seizures=[0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 230
  - Preictal sequences: 115
  - Interictal sequences: 115
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 230 total (115 preictal, 115 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 290.2s (4.8 min)
Class balance: 115/115 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 297 preictal, 0 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 70 interictal)

Sequences saved to chb15_fold6_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 6 completed successfully!
✅ Sequences saved to chb15_fold6_sequences_prediction.json

============================================================
PROCESSING FOLD 7/19
============================================================
Output prefix: chb15_fold7
LOOCV Fold 7: Test seizure=7, Train seizures=[0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 228
  - Preictal sequences: 114
  - Interictal sequences: 114
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 228 total (114 preictal, 114 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 290.0s (4.8 min)
Class balance: 114/114 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 298 preictal, 0 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 71 interictal)

Sequences saved to chb15_fold7_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 7 completed successfully!
✅ Sequences saved to chb15_fold7_sequences_prediction.json

============================================================
PROCESSING FOLD 8/19
============================================================
Output prefix: chb15_fold8
LOOCV Fold 8: Test seizure=8, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 228
  - Preictal sequences: 114
  - Interictal sequences: 114
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 228 total (114 preictal, 114 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 262.3s (4.4 min)
Class balance: 114/114 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 298 preictal, 0 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 71 interictal)

Sequences saved to chb15_fold8_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 8 completed successfully!
✅ Sequences saved to chb15_fold8_sequences_prediction.json

============================================================
PROCESSING FOLD 9/19
============================================================
Output prefix: chb15_fold9
LOOCV Fold 9: Test seizure=9, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 224
  - Preictal sequences: 112
  - Interictal sequences: 112
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 224 total (112 preictal, 112 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 249.6s (4.2 min)
Class balance: 112/112 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 300 preictal, 0 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 73 interictal)

Sequences saved to chb15_fold9_sequences_prediction.json
File size: 0.37 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 9 completed successfully!
✅ Sequences saved to chb15_fold9_sequences_prediction.json

============================================================
PROCESSING FOLD 10/19
============================================================
Output prefix: chb15_fold10
LOOCV Fold 10: Test seizure=10, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 268.5s (4.5 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 299 preictal, 0 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 72 interictal)

Sequences saved to chb15_fold10_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 10 completed successfully!
✅ Sequences saved to chb15_fold10_sequences_prediction.json

============================================================
PROCESSING FOLD 11/19
============================================================
Output prefix: chb15_fold11
LOOCV Fold 11: Test seizure=11, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 222
  - Preictal sequences: 111
  - Interictal sequences: 111
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 222 total (111 preictal, 111 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 266.8s (4.4 min)
Class balance: 111/111 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 301 preictal, 0 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 74 interictal)

Sequences saved to chb15_fold11_sequences_prediction.json
File size: 0.37 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 11 completed successfully!
✅ Sequences saved to chb15_fold11_sequences_prediction.json

============================================================
PROCESSING FOLD 12/19
============================================================
Output prefix: chb15_fold12
LOOCV Fold 12: Test seizure=12, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 252.3s (4.2 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 299 preictal, 0 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 72 interictal)

Sequences saved to chb15_fold12_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 12 completed successfully!
✅ Sequences saved to chb15_fold12_sequences_prediction.json

============================================================
PROCESSING FOLD 13/19
============================================================
Output prefix: chb15_fold13
LOOCV Fold 13: Test seizure=13, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 224
  - Preictal sequences: 112
  - Interictal sequences: 112
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 224 total (112 preictal, 112 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 250.6s (4.2 min)
Class balance: 112/112 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 300 preictal, 0 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 73 interictal)

Sequences saved to chb15_fold13_sequences_prediction.json
File size: 0.37 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 13 completed successfully!
✅ Sequences saved to chb15_fold13_sequences_prediction.json

============================================================
PROCESSING FOLD 14/19
============================================================
Output prefix: chb15_fold14
LOOCV Fold 14: Test seizure=14, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 214
  - Preictal sequences: 107
  - Interictal sequences: 107
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 214 total (107 preictal, 107 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 30 total (15 preictal, 15 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 260.0s (4.3 min)
Class balance: 107/107 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 305 preictal, 0 interictal)
test: 15 preictal, 15 interictal (dropped 0 preictal, 78 interictal)

Sequences saved to chb15_fold14_sequences_prediction.json
File size: 0.36 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 14 completed successfully!
✅ Sequences saved to chb15_fold14_sequences_prediction.json

============================================================
PROCESSING FOLD 15/19
============================================================
Output prefix: chb15_fold15
LOOCV Fold 15: Test seizure=15, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 230
  - Preictal sequences: 115
  - Interictal sequences: 115
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 230 total (115 preictal, 115 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 278.0s (4.6 min)
Class balance: 115/115 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 297 preictal, 0 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 70 interictal)

Sequences saved to chb15_fold15_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 15 completed successfully!
✅ Sequences saved to chb15_fold15_sequences_prediction.json

============================================================
PROCESSING FOLD 16/19
============================================================
Output prefix: chb15_fold16
LOOCV Fold 16: Test seizure=16, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 260.0s (4.3 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 299 preictal, 0 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 72 interictal)

Sequences saved to chb15_fold16_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 16 completed successfully!
✅ Sequences saved to chb15_fold16_sequences_prediction.json

============================================================
PROCESSING FOLD 17/19
============================================================
Output prefix: chb15_fold17
LOOCV Fold 17: Test seizure=17, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 226
  - Preictal sequences: 113
  - Interictal sequences: 113
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 226 total (113 preictal, 113 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 255.6s (4.3 min)
Class balance: 113/113 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 299 preictal, 0 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 72 interictal)

Sequences saved to chb15_fold17_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 17 completed successfully!
✅ Sequences saved to chb15_fold17_sequences_prediction.json

============================================================
PROCESSING FOLD 18/19
============================================================
Output prefix: chb15_fold18
LOOCV Fold 18: Test seizure=18, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 224
  - Preictal sequences: 112
  - Interictal sequences: 112
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 224 total (112 preictal, 112 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 251.1s (4.2 min)
Class balance: 112/112 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 300 preictal, 0 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 73 interictal)

Sequences saved to chb15_fold18_sequences_prediction.json
File size: 0.38 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 18 completed successfully!
✅ Sequences saved to chb15_fold18_sequences_prediction.json

============================================================
PROCESSING FOLD 19/19
============================================================
Output prefix: chb15_fold19
LOOCV Fold 19: Test seizure=19, Train seizures=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 232
  - Preictal sequences: 116
  - Interictal sequences: 116
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb15: 232 total (116 preictal, 116 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 184 total (92 preictal, 92 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 282.5s (4.7 min)
Class balance: 116/116 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 92 preictal, 92 interictal (dropped 296 preictal, 0 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 69 interictal)

Sequences saved to chb15_fold19_sequences_prediction.json
File size: 0.39 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 40
Files with valid channels: 40
Files with invalid channels: 0

✅ Fold 19 completed successfully!
✅ Sequences saved to chb15_fold19_sequences_prediction.json

============================================================
✅ BATCH PROCESSING COMPLETED!
✅ Processed 20 folds for patient chb15
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 20 folds for patient chb15
============================================================

============================================================
PREPROCESSING FOLD 0/19
============================================================
2025-11-12 23:17:22,846 - INFO - ============================================================
2025-11-12 23:17:22,846 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:17:22,846 - INFO - ============================================================
2025-11-12 23:17:22,846 - INFO - Output prefix: chb15_fold0
2025-11-12 23:17:22,846 - INFO - EEG Preprocessor initialized
2025-11-12 23:17:22,846 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:17:22,846 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:17:22,846 - INFO - Segment duration: 5 seconds
2025-11-12 23:17:22,846 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:17:22,846 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:17:22,846 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:17:22,846 - INFO - Loading segments from chb15_fold0_sequences_prediction.json
2025-11-12 23:17:22,856 - INFO - Loaded 218 total sequences
2025-11-12 23:17:22,856 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:17:22,856 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:17:22,856 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:17:22,856 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:17:22,856 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:17:22,856 - INFO - test: 34 sequences (17 preictal, 17 interictal)
2025-11-12 23:17:22,868 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:17:22,868 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:17:22,868 - INFO - test: kept 17 preictal and 17 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:17:22,880 - INFO - ============================================================
2025-11-12 23:17:22,880 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:17:22,880 - INFO - ============================================================
2025-11-12 23:17:22,880 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:17:22,880 - INFO - Processing 184 sequences from 27 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:03<09:11,  3.01s/it]Processing training data:  12%|#########################1                                                                                                                                                                                        | 22/184 [00:04<00:27,  5.88it/s]Processing training data:  19%|#######################################9                                                                                                                                                                          | 35/184 [00:06<00:22,  6.60it/s]Processing training data:  26%|#####################################################6                                                                                                                                                            | 47/184 [00:06<00:15,  8.79it/s]Processing training data:  28%|##########################################################2                                                                                                                                                       | 51/184 [00:08<00:21,  6.32it/s]Processing training data:  31%|#################################################################                                                                                                                                                 | 57/184 [00:09<00:21,  5.83it/s]Processing training data:  36%|############################################################################4                                                                                                                                     | 67/184 [00:11<00:19,  6.04it/s]Processing training data:  43%|##########################################################################################1                                                                                                                       | 79/184 [00:11<00:12,  8.32it/s]Processing training data:  46%|###############################################################################################8                                                                                                                  | 84/184 [00:12<00:13,  7.58it/s]Processing training data:  48%|####################################################################################################4                                                                                                             | 88/184 [00:13<00:12,  7.81it/s]Processing training data:  50%|#########################################################################################################                                                                                                         | 92/184 [00:13<00:11,  7.85it/s]Processing training data:  54%|################################################################################################################9                                                                                                 | 99/184 [00:15<00:13,  6.43it/s]Processing training data:  60%|##############################################################################################################################                                                                                   | 111/184 [00:16<00:08,  8.46it/s]Processing training data:  64%|####################################################################################################################################8                                                                            | 117/184 [00:16<00:07,  8.89it/s]Processing training data:  68%|###############################################################################################################################################1                                                                 | 126/184 [00:17<00:05, 10.23it/s]Processing training data:  73%|#########################################################################################################################################################3                                                       | 135/184 [00:17<00:04, 11.91it/s]Processing training data:  75%|############################################################################################################################################################7                                                    | 138/184 [00:19<00:05,  7.83it/s]Processing training data:  79%|#####################################################################################################################################################################8                                           | 146/184 [00:19<00:03,  9.51it/s]Processing training data:  82%|###########################################################################################################################################################################5                                     | 151/184 [00:20<00:03,  9.33it/s]Processing training data:  84%|##############################################################################################################################################################################9                                  | 154/184 [00:20<00:03,  8.86it/s]Processing training data:  85%|#################################################################################################################################################################################1                               | 156/184 [00:22<00:05,  5.06it/s]Processing training data:  91%|##############################################################################################################################################################################################8                  | 168/184 [00:22<00:02,  7.71it/s]Processing training data:  95%|#####################################################################################################################################################################################################6           | 174/184 [00:23<00:01,  8.33it/s]Processing training data:  96%|#########################################################################################################################################################################################################        | 177/184 [00:23<00:00,  8.27it/s]Processing training data:  97%|##########################################################################################################################################################################################################1      | 178/184 [00:24<00:00,  6.24it/s]Processing training data:  98%|#############################################################################################################################################################################################################5   | 181/184 [00:24<00:00,  6.23it/s]Processing training data:  99%|###############################################################################################################################################################################################################8 | 183/184 [00:25<00:00,  5.38it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:25<00:00,  7.20it/s]
2025-11-12 23:17:48,433 - INFO - Computing normalization statistics from training data...
2025-11-12 23:17:48,691 - INFO - Normalization stats computed:
2025-11-12 23:17:48,692 - INFO -   Mean: -0.698963
2025-11-12 23:17:48,692 - INFO -   Std: 2.006289
2025-11-12 23:17:48,692 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold0\normalization_stats.json
2025-11-12 23:17:48,710 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:17:48,722 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold0\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:11, 15.70it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 15.59it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:10, 15.38it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:09, 15.61it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 15.75it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 15.81it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:07, 15.86it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:05<00:06, 15.93it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 15.92it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.04it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.11it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.16it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:08<00:03, 16.02it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.33it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.53it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.68it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.78it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:11<00:00, 16.62it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:11<00:00, 16.51it/s]
2025-11-12 23:18:00,114 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:18:00,120 - INFO - Loaded normalization statistics:
2025-11-12 23:18:00,120 - INFO -   Mean: -0.698963
2025-11-12 23:18:00,120 - INFO -   Std: 2.006289
2025-11-12 23:18:00,120 - INFO - Split train already completed, skipping
2025-11-12 23:18:00,120 - INFO - Processing test split...
2025-11-12 23:18:00,121 - INFO - Need to process 34/34 sequences for test
2025-11-12 23:18:00,121 - INFO - Processing 34 sequences from 11 unique files
2025-11-12 23:18:00,121 - INFO - Average 3.1 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/34 [00:00<?, ?it/s]Processing test:   3%|######5                                                                                                                                                                                                                      | 1/34 [00:00<00:16,  2.02it/s]2025-11-12 23:18:00,618 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold0\test_dataset.h5
2025-11-12 23:18:01,321 - INFO - Progress: 196/218 (89.9%) - ETA: 0.1 minutes
Processing test:  38%|####################################################################################1                                                                                                                                       | 13/34 [00:01<00:02,  8.81it/s]Processing test:  44%|#################################################################################################                                                                                                                           | 15/34 [00:01<00:02,  7.90it/s]Processing test:  47%|#######################################################################################################5                                                                                                                    | 16/34 [00:03<00:05,  3.44it/s]Processing test:  62%|#######################################################################################################################################8                                                                                    | 21/34 [00:03<00:02,  5.05it/s]2025-11-12 23:18:04,820 - INFO - Progress: 209/218 (95.9%) - ETA: 0.0 minutes
Processing test:  76%|########################################################################################################################################################################2                                                   | 26/34 [00:05<00:01,  4.22it/s]Processing test:  85%|###########################################################################################################################################################################################6                                | 29/34 [00:05<00:01,  4.84it/s]Processing test:  88%|##################################################################################################################################################################################################1                         | 30/34 [00:06<00:00,  4.50it/s]Processing test:  91%|########################################################################################################################################################################################################5                   | 31/34 [00:06<00:00,  4.16it/s]Processing test:  94%|###############################################################################################################################################################################################################             | 32/34 [00:06<00:00,  3.88it/s]Processing test:  97%|#####################################################################################################################################################################################################################5      | 33/34 [00:07<00:00,  3.31it/s]Processing test: 100%|############################################################################################################################################################################################################################| 34/34 [00:07<00:00,  4.64it/s]
2025-11-12 23:18:07,995 - INFO - Validating final datasets...
2025-11-12 23:18:08,003 - INFO - train dataset validation:
2025-11-12 23:18:08,004 - INFO -   - Segments: 184
2025-11-12 23:18:08,004 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:18:08,004 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:18:08,004 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:18:08,008 - INFO - test dataset validation:
2025-11-12 23:18:08,008 - INFO -   - Segments: 34
2025-11-12 23:18:08,008 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:18:08,008 - INFO -   - Classes: 17 preictal, 17 interictal
2025-11-12 23:18:08,008 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:18:08,008 - INFO - ============================================================
2025-11-12 23:18:08,008 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:18:08,008 - INFO - Total time: 0.8 minutes
2025-11-12 23:18:08,009 - INFO - Processed segments: 218
2025-11-12 23:18:08,009 - INFO - Average rate: 4.8 segments/second
2025-11-12 23:18:08,009 - INFO - ============================================================
✅ Fold 0 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 1/19
============================================================
2025-11-12 23:18:08,025 - INFO - ============================================================
2025-11-12 23:18:08,025 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:18:08,025 - INFO - ============================================================
2025-11-12 23:18:08,025 - INFO - Output prefix: chb15_fold1
2025-11-12 23:18:08,025 - INFO - EEG Preprocessor initialized
2025-11-12 23:18:08,025 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:18:08,025 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:18:08,025 - INFO - Segment duration: 5 seconds
2025-11-12 23:18:08,025 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:18:08,025 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:18:08,025 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:18:08,025 - INFO - Loading segments from chb15_fold1_sequences_prediction.json
2025-11-12 23:18:08,035 - INFO - Loaded 224 total sequences
2025-11-12 23:18:08,035 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:18:08,035 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:18:08,036 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:18:08,036 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:18:08,036 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:18:08,036 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-12 23:18:08,048 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:18:08,048 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:18:08,048 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:18:08,067 - INFO - ============================================================
2025-11-12 23:18:08,068 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:18:08,068 - INFO - ============================================================
2025-11-12 23:18:08,068 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:18:08,068 - INFO - Processing 184 sequences from 27 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<03:37,  1.19s/it]Processing training data:   5%|###########4                                                                                                                                                                                                      | 10/184 [00:02<00:43,  3.99it/s]Processing training data:  11%|######################8                                                                                                                                                                                           | 20/184 [00:03<00:22,  7.36it/s]Processing training data:  15%|##############################8                                                                                                                                                                                   | 27/184 [00:04<00:24,  6.35it/s]Processing training data:  19%|#######################################9                                                                                                                                                                          | 35/184 [00:05<00:17,  8.47it/s]Processing training data:  20%|##########################################2                                                                                                                                                                       | 37/184 [00:06<00:29,  5.07it/s]Processing training data:  29%|#############################################################6                                                                                                                                                    | 54/184 [00:08<00:17,  7.50it/s]Processing training data:  39%|##################################################################################1                                                                                                                               | 72/184 [00:08<00:09, 11.71it/s]Processing training data:  41%|#####################################################################################5                                                                                                                            | 75/184 [00:09<00:12,  8.67it/s]Processing training data:  46%|###############################################################################################8                                                                                                                  | 84/184 [00:10<00:09, 10.48it/s]Processing training data:  48%|#####################################################################################################5                                                                                                            | 89/184 [00:12<00:13,  7.12it/s]Processing training data:  54%|#################################################################################################################5                                                                                               | 100/184 [00:12<00:08,  9.70it/s]Processing training data:  57%|#######################################################################################################################2                                                                                         | 105/184 [00:12<00:07, 10.23it/s]Processing training data:  59%|##########################################################################################################################6                                                                                      | 108/184 [00:13<00:07,  9.62it/s]Processing training data:  61%|################################################################################################################################3                                                                                | 113/184 [00:14<00:08,  8.28it/s]Processing training data:  65%|########################################################################################################################################3                                                                        | 120/184 [00:15<00:09,  6.41it/s]Processing training data:  68%|###############################################################################################################################################1                                                                 | 126/184 [00:17<00:10,  5.45it/s]Processing training data:  73%|#########################################################################################################################################################3                                                       | 135/184 [00:17<00:06,  7.29it/s]Processing training data:  76%|###############################################################################################################################################################                                                  | 140/184 [00:19<00:07,  5.70it/s]Processing training data:  84%|################################################################################################################################################################################                                 | 155/184 [00:19<00:02, 10.03it/s]Processing training data:  85%|##################################################################################################################################################################################3                              | 157/184 [00:20<00:03,  7.54it/s]Processing training data:  88%|########################################################################################################################################################################################                         | 162/184 [00:21<00:02,  7.89it/s]Processing training data:  90%|############################################################################################################################################################################################5                    | 166/184 [00:21<00:02,  7.60it/s]Processing training data:  92%|#################################################################################################################################################################################################                | 170/184 [00:22<00:01,  7.34it/s]Processing training data:  97%|###########################################################################################################################################################################################################3     | 179/184 [00:23<00:00,  8.25it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  9.21it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.79it/s]
2025-11-12 23:18:31,687 - INFO - Computing normalization statistics from training data...
2025-11-12 23:18:31,958 - INFO - Normalization stats computed:
2025-11-12 23:18:31,958 - INFO -   Mean: -0.726055
2025-11-12 23:18:31,958 - INFO -   Std: 2.001996
2025-11-12 23:18:31,958 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold1\normalization_stats.json
2025-11-12 23:18:31,976 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:18:31,984 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold1\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 15.86it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 16.05it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.19it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.21it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.00it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.19it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.33it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.41it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.46it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.47it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.41it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.28it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.25it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.33it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.49it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.50it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.59it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.72it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 16.76it/s]
2025-11-12 23:18:43,214 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:18:43,221 - INFO - Loaded normalization statistics:
2025-11-12 23:18:43,221 - INFO -   Mean: -0.726055
2025-11-12 23:18:43,221 - INFO -   Std: 2.001996
2025-11-12 23:18:43,221 - INFO - Split train already completed, skipping
2025-11-12 23:18:43,221 - INFO - Processing test split...
2025-11-12 23:18:43,221 - INFO - Need to process 40/40 sequences for test
2025-11-12 23:18:43,221 - INFO - Processing 40 sequences from 10 unique files
2025-11-12 23:18:43,221 - INFO - Average 4.0 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/40 [00:00<?, ?it/s]Processing test:   2%|#####5                                                                                                                                                                                                                       | 1/40 [00:00<00:22,  1.74it/s]2025-11-12 23:18:43,798 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold1\test_dataset.h5
2025-11-12 23:18:44,966 - INFO - Progress: 204/224 (91.1%) - ETA: 0.1 minutes
Processing test:  52%|###################################################################################################################5                                                                                                        | 21/40 [00:02<00:02,  7.50it/s]Processing test:  62%|#########################################################################################################################################5                                                                                  | 25/40 [00:03<00:01,  8.07it/s]Processing test:  65%|###############################################################################################################################################                                                                             | 26/40 [00:04<00:03,  4.46it/s]Processing test:  75%|#####################################################################################################################################################################                                                       | 30/40 [00:05<00:02,  4.99it/s]2025-11-12 23:18:49,267 - INFO - Progress: 215/224 (96.0%) - ETA: 0.0 minutes
Processing test:  80%|################################################################################################################################################################################                                            | 32/40 [00:06<00:02,  3.36it/s]Processing test:  85%|###########################################################################################################################################################################################                                 | 34/40 [00:07<00:01,  3.16it/s]Processing test:  95%|#################################################################################################################################################################################################################           | 38/40 [00:08<00:00,  4.31it/s]Processing test:  98%|######################################################################################################################################################################################################################5     | 39/40 [00:08<00:00,  4.05it/s]Processing test: 100%|############################################################################################################################################################################################################################| 40/40 [00:08<00:00,  3.80it/s]Processing test: 100%|############################################################################################################################################################################################################################| 40/40 [00:08<00:00,  4.57it/s]
2025-11-12 23:18:52,544 - INFO - Validating final datasets...
2025-11-12 23:18:52,551 - INFO - train dataset validation:
2025-11-12 23:18:52,552 - INFO -   - Segments: 184
2025-11-12 23:18:52,552 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:18:52,552 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:18:52,552 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:18:52,556 - INFO - test dataset validation:
2025-11-12 23:18:52,556 - INFO -   - Segments: 40
2025-11-12 23:18:52,557 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:18:52,557 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-12 23:18:52,557 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:18:52,557 - INFO - ============================================================
2025-11-12 23:18:52,557 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:18:52,557 - INFO - Total time: 0.7 minutes
2025-11-12 23:18:52,557 - INFO - Processed segments: 224
2025-11-12 23:18:52,557 - INFO - Average rate: 5.0 segments/second
2025-11-12 23:18:52,557 - INFO - ============================================================
✅ Fold 1 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 2/19
============================================================
2025-11-12 23:18:52,574 - INFO - ============================================================
2025-11-12 23:18:52,574 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:18:52,574 - INFO - ============================================================
2025-11-12 23:18:52,574 - INFO - Output prefix: chb15_fold2
2025-11-12 23:18:52,574 - INFO - EEG Preprocessor initialized
2025-11-12 23:18:52,574 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:18:52,574 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:18:52,574 - INFO - Segment duration: 5 seconds
2025-11-12 23:18:52,574 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:18:52,574 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:18:52,574 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:18:52,574 - INFO - Loading segments from chb15_fold2_sequences_prediction.json
2025-11-12 23:18:52,584 - INFO - Loaded 228 total sequences
2025-11-12 23:18:52,584 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:18:52,585 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:18:52,585 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:18:52,585 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:18:52,585 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:18:52,585 - INFO - test: 44 sequences (22 preictal, 22 interictal)
2025-11-12 23:18:52,597 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:18:52,597 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:18:52,597 - INFO - test: kept 22 preictal and 22 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:18:52,609 - INFO - ============================================================
2025-11-12 23:18:52,609 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:18:52,609 - INFO - ============================================================
2025-11-12 23:18:52,609 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:18:52,609 - INFO - Processing 184 sequences from 27 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<04:47,  1.57s/it]Processing training data:  12%|##########################2                                                                                                                                                                                       | 23/184 [00:02<00:11, 14.59it/s]Processing training data:  15%|##############################8                                                                                                                                                                                   | 27/184 [00:02<00:12, 12.21it/s]Processing training data:  18%|#####################################6                                                                                                                                                                            | 33/184 [00:04<00:19,  7.63it/s]Processing training data:  23%|#################################################                                                                                                                                                                 | 43/184 [00:04<00:13, 10.35it/s]Processing training data:  25%|####################################################5                                                                                                                                                             | 46/184 [00:05<00:17,  7.90it/s]Processing training data:  28%|###########################################################3                                                                                                                                                      | 52/184 [00:05<00:14,  9.05it/s]Processing training data:  30%|##############################################################7                                                                                                                                                   | 55/184 [00:06<00:14,  8.66it/s]Processing training data:  31%|#################################################################                                                                                                                                                 | 57/184 [00:07<00:27,  4.64it/s]Processing training data:  37%|#############################################################################6                                                                                                                                    | 68/184 [00:08<00:14,  7.86it/s]Processing training data:  42%|#######################################################################################8                                                                                                                          | 77/184 [00:09<00:11,  9.12it/s]Processing training data:  45%|#############################################################################################5                                                                                                                    | 82/184 [00:09<00:10,  9.45it/s]Processing training data:  47%|##################################################################################################1                                                                                                               | 86/184 [00:10<00:10,  8.93it/s]Processing training data:  48%|#####################################################################################################5                                                                                                            | 89/184 [00:11<00:14,  6.62it/s]Processing training data:  51%|###########################################################################################################2                                                                                                      | 94/184 [00:12<00:17,  5.04it/s]Processing training data:  59%|###########################################################################################################################8                                                                                     | 109/184 [00:13<00:08,  9.33it/s]Processing training data:  61%|###############################################################################################################################2                                                                                 | 112/184 [00:13<00:08,  8.41it/s]Processing training data:  64%|######################################################################################################################################                                                                           | 118/184 [00:15<00:10,  6.29it/s]Processing training data:  72%|#####################################################################################################################################################9                                                           | 132/184 [00:16<00:06,  8.14it/s]Processing training data:  76%|#############################################################################################################################################################8                                                   | 139/184 [00:18<00:06,  6.67it/s]Processing training data:  81%|#########################################################################################################################################################################2                                       | 149/184 [00:19<00:05,  6.52it/s]Processing training data:  89%|#########################################################################################################################################################################################1                       | 163/184 [00:20<00:02,  9.48it/s]Processing training data:  91%|#############################################################################################################################################################################################6                   | 167/184 [00:20<00:01,  9.50it/s]Processing training data:  93%|##################################################################################################################################################################################################2              | 171/184 [00:21<00:01,  9.69it/s]Processing training data:  94%|####################################################################################################################################################################################################5            | 173/184 [00:22<00:01,  5.76it/s]Processing training data:  97%|###########################################################################################################################################################################################################3     | 179/184 [00:22<00:00,  7.03it/s]Processing training data:  99%|###############################################################################################################################################################################################################8 | 183/184 [00:23<00:00,  6.96it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.80it/s]
2025-11-12 23:19:16,193 - INFO - Computing normalization statistics from training data...
2025-11-12 23:19:16,478 - INFO - Normalization stats computed:
2025-11-12 23:19:16,478 - INFO -   Mean: -0.778559
2025-11-12 23:19:16,478 - INFO -   Std: 2.018376
2025-11-12 23:19:16,479 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold2\normalization_stats.json
2025-11-12 23:19:16,497 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:19:16,506 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold2\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:11, 15.57it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 15.97it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 15.95it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.10it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.14it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.23it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.35it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.40it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.27it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.36it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.37it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.40it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.39it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.36it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.37it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.37it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.36it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:11<00:00, 16.34it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:11<00:00, 16.65it/s]
2025-11-12 23:19:27,818 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:19:27,825 - INFO - Loaded normalization statistics:
2025-11-12 23:19:27,825 - INFO -   Mean: -0.778559
2025-11-12 23:19:27,825 - INFO -   Std: 2.018376
2025-11-12 23:19:27,825 - INFO - Split train already completed, skipping
2025-11-12 23:19:27,825 - INFO - Processing test split...
2025-11-12 23:19:27,825 - INFO - Need to process 44/44 sequences for test
2025-11-12 23:19:27,825 - INFO - Processing 44 sequences from 12 unique files
2025-11-12 23:19:27,825 - INFO - Average 3.7 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/44 [00:00<?, ?it/s]Processing test:   2%|#####                                                                                                                                                                                                                        | 1/44 [00:01<00:43,  1.01s/it]Processing test:  11%|#########################1                                                                                                                                                                                                   | 5/44 [00:01<00:11,  3.49it/s]2025-11-12 23:19:29,473 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold2\test_dataset.h5
2025-11-12 23:19:30,927 - INFO - Progress: 210/228 (92.1%) - ETA: 0.1 minutes
Processing test:  61%|#######################################################################################################################################                                                                                     | 27/44 [00:03<00:01,  9.09it/s]Processing test:  66%|#################################################################################################################################################                                                                           | 29/44 [00:03<00:01,  8.63it/s]Processing test:  68%|######################################################################################################################################################                                                                      | 30/44 [00:04<00:01,  7.68it/s]Processing test:  70%|###########################################################################################################################################################                                                                 | 31/44 [00:05<00:02,  4.76it/s]Processing test:  80%|###############################################################################################################################################################################                                             | 35/44 [00:05<00:01,  5.91it/s]Processing test:  82%|####################################################################################################################################################################################                                        | 36/44 [00:06<00:01,  4.09it/s]2025-11-12 23:19:34,873 - INFO - Progress: 221/228 (96.9%) - ETA: 0.0 minutes
Processing test:  86%|##############################################################################################################################################################################################                              | 38/44 [00:08<00:02,  2.28it/s]Processing test:  95%|##################################################################################################################################################################################################################          | 42/44 [00:08<00:00,  3.38it/s]Processing test:  98%|#######################################################################################################################################################################################################################     | 43/44 [00:09<00:00,  3.33it/s]Processing test: 100%|############################################################################################################################################################################################################################| 44/44 [00:09<00:00,  3.19it/s]Processing test: 100%|############################################################################################################################################################################################################################| 44/44 [00:09<00:00,  4.58it/s]
2025-11-12 23:19:37,860 - INFO - Validating final datasets...
2025-11-12 23:19:37,868 - INFO - train dataset validation:
2025-11-12 23:19:37,868 - INFO -   - Segments: 184
2025-11-12 23:19:37,868 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:19:37,868 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:19:37,868 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:19:37,872 - INFO - test dataset validation:
2025-11-12 23:19:37,873 - INFO -   - Segments: 44
2025-11-12 23:19:37,873 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:19:37,873 - INFO -   - Classes: 22 preictal, 22 interictal
2025-11-12 23:19:37,873 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:19:37,873 - INFO - ============================================================
2025-11-12 23:19:37,873 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:19:37,873 - INFO - Total time: 0.8 minutes
2025-11-12 23:19:37,873 - INFO - Processed segments: 228
2025-11-12 23:19:37,873 - INFO - Average rate: 5.0 segments/second
2025-11-12 23:19:37,873 - INFO - ============================================================
✅ Fold 2 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 3/19
============================================================
2025-11-12 23:19:37,890 - INFO - ============================================================
2025-11-12 23:19:37,890 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:19:37,890 - INFO - ============================================================
2025-11-12 23:19:37,890 - INFO - Output prefix: chb15_fold3
2025-11-12 23:19:37,890 - INFO - EEG Preprocessor initialized
2025-11-12 23:19:37,890 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:19:37,890 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:19:37,890 - INFO - Segment duration: 5 seconds
2025-11-12 23:19:37,890 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:19:37,890 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:19:37,890 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:19:37,891 - INFO - Loading segments from chb15_fold3_sequences_prediction.json
2025-11-12 23:19:37,900 - INFO - Loaded 230 total sequences
2025-11-12 23:19:37,900 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:19:37,900 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:19:37,900 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:19:37,900 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:19:37,901 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:19:37,901 - INFO - test: 46 sequences (23 preictal, 23 interictal)
2025-11-12 23:19:37,913 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:19:37,913 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:19:37,913 - INFO - test: kept 23 preictal and 23 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:19:37,926 - INFO - ============================================================
2025-11-12 23:19:37,927 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:19:37,927 - INFO - ============================================================
2025-11-12 23:19:37,927 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:19:37,927 - INFO - Processing 184 sequences from 26 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<05:11,  1.70s/it]Processing training data:   8%|###############9                                                                                                                                                                                                  | 14/184 [00:02<00:23,  7.26it/s]Processing training data:   9%|###################4                                                                                                                                                                                              | 17/184 [00:03<00:38,  4.39it/s]Processing training data:  16%|#################################                                                                                                                                                                                 | 29/184 [00:05<00:25,  6.11it/s]Processing training data:  22%|#############################################6                                                                                                                                                                    | 40/184 [00:06<00:22,  6.45it/s]Processing training data:  25%|####################################################5                                                                                                                                                             | 46/184 [00:08<00:25,  5.40it/s]Processing training data:  33%|####################################################################4                                                                                                                                             | 60/184 [00:10<00:19,  6.49it/s]Processing training data:  40%|####################################################################################4                                                                                                                             | 74/184 [00:10<00:12,  9.14it/s]Processing training data:  44%|############################################################################################4                                                                                                                     | 81/184 [00:12<00:14,  7.21it/s]Processing training data:  57%|######################################################################################################################1                                                                                          | 104/184 [00:13<00:06, 12.36it/s]Processing training data:  59%|##########################################################################################################################6                                                                                      | 108/184 [00:14<00:07,  9.53it/s]Processing training data:  63%|###################################################################################################################################7                                                                             | 116/184 [00:14<00:06, 10.61it/s]Processing training data:  65%|########################################################################################################################################3                                                                        | 120/184 [00:15<00:06,  9.77it/s]Processing training data:  70%|#################################################################################################################################################3                                                               | 128/184 [00:15<00:05, 10.92it/s]Processing training data:  72%|#######################################################################################################################################################                                                          | 133/184 [00:16<00:04, 11.14it/s]Processing training data:  74%|##########################################################################################################################################################4                                                      | 136/184 [00:16<00:04, 10.00it/s]Processing training data:  77%|################################################################################################################################################################1                                                | 141/184 [00:17<00:04, 10.63it/s]Processing training data:  78%|###################################################################################################################################################################5                                             | 144/184 [00:17<00:04,  9.47it/s]Processing training data:  81%|#########################################################################################################################################################################2                                       | 149/184 [00:18<00:04,  8.17it/s]Processing training data:  84%|################################################################################################################################################################################                                 | 155/184 [00:18<00:03,  8.96it/s]Processing training data:  88%|########################################################################################################################################################################################                         | 162/184 [00:19<00:02,  9.91it/s]Processing training data:  90%|############################################################################################################################################################################################5                    | 166/184 [00:20<00:01,  9.37it/s]Processing training data:  93%|##################################################################################################################################################################################################2              | 171/184 [00:21<00:01,  7.22it/s]Processing training data:  96%|#######################################################################################################################################################################################################9         | 176/184 [00:21<00:01,  7.99it/s]Processing training data:  97%|##########################################################################################################################################################################################################1      | 178/184 [00:22<00:01,  5.79it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:22<00:00,  7.70it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:22<00:00,  8.06it/s]
2025-11-12 23:20:00,766 - INFO - Computing normalization statistics from training data...
2025-11-12 23:20:01,043 - INFO - Normalization stats computed:
2025-11-12 23:20:01,043 - INFO -   Mean: -0.769346
2025-11-12 23:20:01,044 - INFO -   Std: 2.029824
2025-11-12 23:20:01,044 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold3\normalization_stats.json
2025-11-12 23:20:01,062 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:20:01,071 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold3\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.30it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:09, 16.44it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.55it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.51it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.47it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.50it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.50it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.51it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.52it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.53it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.56it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.58it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.62it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.74it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.86it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.95it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.96it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 17.02it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 17.06it/s]
2025-11-12 23:20:12,113 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:20:12,119 - INFO - Loaded normalization statistics:
2025-11-12 23:20:12,119 - INFO -   Mean: -0.769346
2025-11-12 23:20:12,119 - INFO -   Std: 2.029824
2025-11-12 23:20:12,119 - INFO - Split train already completed, skipping
2025-11-12 23:20:12,119 - INFO - Processing test split...
2025-11-12 23:20:12,119 - INFO - Need to process 46/46 sequences for test
2025-11-12 23:20:12,119 - INFO - Processing 46 sequences from 11 unique files
2025-11-12 23:20:12,119 - INFO - Average 4.2 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/46 [00:00<?, ?it/s]Processing test:   2%|####8                                                                                                                                                                                                                        | 1/46 [00:00<00:28,  1.59it/s]2025-11-12 23:20:12,749 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold3\test_dataset.h5
2025-11-12 23:20:14,024 - INFO - Progress: 207/230 (90.0%) - ETA: 0.1 minutes
Processing test:  52%|##################################################################################################################7                                                                                                         | 24/46 [00:03<00:02,  8.22it/s]Processing test:  57%|############################################################################################################################3                                                                                               | 26/46 [00:03<00:02,  6.74it/s]Processing test:  61%|#####################################################################################################################################9                                                                                      | 28/46 [00:04<00:03,  5.34it/s]Processing test:  70%|#########################################################################################################################################################                                                                   | 32/46 [00:05<00:03,  4.45it/s]2025-11-12 23:20:18,792 - INFO - Progress: 219/230 (95.2%) - ETA: 0.0 minutes
Processing test:  78%|############################################################################################################################################################################1                                               | 36/46 [00:07<00:02,  3.68it/s]Processing test:  87%|###############################################################################################################################################################################################3                            | 40/46 [00:07<00:01,  4.57it/s]Processing test:  89%|####################################################################################################################################################################################################                        | 41/46 [00:08<00:01,  4.31it/s]Processing test:  91%|########################################################################################################################################################################################################8                   | 42/46 [00:08<00:00,  4.07it/s]Processing test:  93%|#############################################################################################################################################################################################################6              | 43/46 [00:08<00:00,  3.83it/s]Processing test:  96%|##################################################################################################################################################################################################################4         | 44/46 [00:09<00:00,  2.91it/s]2025-11-12 23:20:22,466 - INFO - Progress: 230/230 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|############################################################################################################################################################################################################################| 46/46 [00:10<00:00,  4.45it/s]
2025-11-12 23:20:22,478 - INFO - Validating final datasets...
2025-11-12 23:20:22,486 - INFO - train dataset validation:
2025-11-12 23:20:22,486 - INFO -   - Segments: 184
2025-11-12 23:20:22,486 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:20:22,486 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:20:22,486 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:20:22,491 - INFO - test dataset validation:
2025-11-12 23:20:22,491 - INFO -   - Segments: 46
2025-11-12 23:20:22,491 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:20:22,491 - INFO -   - Classes: 23 preictal, 23 interictal
2025-11-12 23:20:22,491 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:20:22,491 - INFO - ============================================================
2025-11-12 23:20:22,491 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:20:22,491 - INFO - Total time: 0.7 minutes
2025-11-12 23:20:22,491 - INFO - Processed segments: 230
2025-11-12 23:20:22,491 - INFO - Average rate: 5.2 segments/second
2025-11-12 23:20:22,491 - INFO - ============================================================
✅ Fold 3 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 4/19
============================================================
2025-11-12 23:20:22,509 - INFO - ============================================================
2025-11-12 23:20:22,509 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:20:22,509 - INFO - ============================================================
2025-11-12 23:20:22,509 - INFO - Output prefix: chb15_fold4
2025-11-12 23:20:22,509 - INFO - EEG Preprocessor initialized
2025-11-12 23:20:22,509 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:20:22,509 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:20:22,509 - INFO - Segment duration: 5 seconds
2025-11-12 23:20:22,509 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:20:22,509 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:20:22,509 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:20:22,510 - INFO - Loading segments from chb15_fold4_sequences_prediction.json
2025-11-12 23:20:22,520 - INFO - Loaded 222 total sequences
2025-11-12 23:20:22,520 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:20:22,520 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:20:22,520 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:20:22,520 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:20:22,520 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:20:22,520 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-12 23:20:22,531 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:20:22,532 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:20:22,532 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:20:22,543 - INFO - ============================================================
2025-11-12 23:20:22,543 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:20:22,543 - INFO - ============================================================
2025-11-12 23:20:22,543 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:20:22,543 - INFO - Processing 184 sequences from 26 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<04:46,  1.57s/it]Processing training data:   8%|#################1                                                                                                                                                                                                | 15/184 [00:03<00:30,  5.62it/s]Processing training data:  14%|############################5                                                                                                                                                                                     | 25/184 [00:03<00:17,  9.03it/s]Processing training data:  16%|##################################2                                                                                                                                                                               | 30/184 [00:05<00:24,  6.19it/s]Processing training data:  23%|#################################################                                                                                                                                                                 | 43/184 [00:05<00:14,  9.64it/s]Processing training data:  25%|####################################################5                                                                                                                                                             | 46/184 [00:06<00:15,  9.03it/s]Processing training data:  28%|###########################################################3                                                                                                                                                      | 52/184 [00:07<00:20,  6.40it/s]Processing training data:  39%|#################################################################################                                                                                                                                 | 71/184 [00:09<00:12,  9.01it/s]Processing training data:  44%|############################################################################################4                                                                                                                     | 81/184 [00:10<00:11,  8.65it/s]Processing training data:  49%|######################################################################################################7                                                                                                           | 90/184 [00:11<00:12,  7.57it/s]Processing training data:  57%|######################################################################################################################1                                                                                          | 104/184 [00:12<00:07, 10.30it/s]Processing training data:  60%|##############################################################################################################################                                                                                   | 111/184 [00:13<00:06, 10.64it/s]Processing training data:  62%|#################################################################################################################################4                                                                               | 114/184 [00:14<00:10,  6.88it/s]Processing training data:  69%|################################################################################################################################################2                                                                | 127/184 [00:15<00:05,  9.61it/s]Processing training data:  72%|#####################################################################################################################################################9                                                           | 132/184 [00:15<00:05,  9.73it/s]Processing training data:  75%|############################################################################################################################################################7                                                    | 138/184 [00:16<00:05,  8.86it/s]Processing training data:  77%|################################################################################################################################################################1                                                | 141/184 [00:17<00:05,  8.14it/s]Processing training data:  80%|########################################################################################################################################################################1                                        | 148/184 [00:17<00:03,  9.17it/s]Processing training data:  82%|###########################################################################################################################################################################5                                     | 151/184 [00:18<00:03,  8.49it/s]Processing training data:  84%|################################################################################################################################################################################                                 | 155/184 [00:18<00:03,  8.13it/s]Processing training data:  86%|###################################################################################################################################################################################4                             | 158/184 [00:19<00:03,  6.70it/s]Processing training data:  89%|#########################################################################################################################################################################################1                       | 163/184 [00:20<00:03,  5.82it/s]Processing training data:  92%|###############################################################################################################################################################################################9                 | 169/184 [00:21<00:02,  6.84it/s]Processing training data:  97%|###########################################################################################################################################################################################################3     | 179/184 [00:21<00:00, 10.44it/s]Processing training data:  98%|#############################################################################################################################################################################################################5   | 181/184 [00:22<00:00,  8.60it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:22<00:00,  8.55it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:22<00:00,  8.16it/s]
2025-11-12 23:20:45,092 - INFO - Computing normalization statistics from training data...
2025-11-12 23:20:45,353 - INFO - Normalization stats computed:
2025-11-12 23:20:45,353 - INFO -   Mean: -0.822258
2025-11-12 23:20:45,353 - INFO -   Std: 2.005157
2025-11-12 23:20:45,353 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold4\normalization_stats.json
2025-11-12 23:20:45,371 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:20:45,379 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold4\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.88it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 16.18it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.25it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.47it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.59it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.66it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.69it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.71it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.73it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.75it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.67it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.57it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.57it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.73it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.69it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.82it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.87it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.95it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 17.07it/s]
2025-11-12 23:20:56,405 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:20:56,411 - INFO - Loaded normalization statistics:
2025-11-12 23:20:56,412 - INFO -   Mean: -0.822258
2025-11-12 23:20:56,412 - INFO -   Std: 2.005157
2025-11-12 23:20:56,412 - INFO - Split train already completed, skipping
2025-11-12 23:20:56,412 - INFO - Processing test split...
2025-11-12 23:20:56,412 - INFO - Need to process 38/38 sequences for test
2025-11-12 23:20:56,412 - INFO - Processing 38 sequences from 10 unique files
2025-11-12 23:20:56,412 - INFO - Average 3.8 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/38 [00:00<?, ?it/s]Processing test:   3%|#####8                                                                                                                                                                                                                       | 1/38 [00:00<00:21,  1.70it/s]2025-11-12 23:20:57,003 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold4\test_dataset.h5
2025-11-12 23:20:58,092 - INFO - Progress: 203/222 (91.4%) - ETA: 0.1 minutes
Processing test:  53%|###################################################################################################################7                                                                                                        | 20/38 [00:02<00:02,  8.33it/s]Processing test:  61%|#####################################################################################################################################1                                                                                      | 23/38 [00:03<00:02,  5.73it/s]Processing test:  71%|############################################################################################################################################################3                                                               | 27/38 [00:05<00:02,  4.35it/s]2025-11-12 23:21:02,539 - INFO - Progress: 215/222 (96.8%) - ETA: 0.0 minutes
Processing test:  84%|#########################################################################################################################################################################################2                                  | 32/38 [00:06<00:01,  4.43it/s]Processing test:  87%|###############################################################################################################################################################################################                             | 33/38 [00:07<00:01,  3.59it/s]Processing test:  92%|##########################################################################################################################################################################################################6                 | 35/38 [00:07<00:00,  3.84it/s]Processing test:  95%|################################################################################################################################################################################################################4           | 36/38 [00:08<00:00,  3.70it/s]Processing test:  97%|######################################################################################################################################################################################################################2     | 37/38 [00:08<00:00,  3.55it/s]Processing test: 100%|############################################################################################################################################################################################################################| 38/38 [00:08<00:00,  3.33it/s]Processing test: 100%|############################################################################################################################################################################################################################| 38/38 [00:08<00:00,  4.32it/s]
2025-11-12 23:21:05,643 - INFO - Validating final datasets...
2025-11-12 23:21:05,651 - INFO - train dataset validation:
2025-11-12 23:21:05,651 - INFO -   - Segments: 184
2025-11-12 23:21:05,651 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:21:05,651 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:21:05,651 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:21:05,656 - INFO - test dataset validation:
2025-11-12 23:21:05,656 - INFO -   - Segments: 38
2025-11-12 23:21:05,656 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:21:05,656 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-12 23:21:05,656 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:21:05,656 - INFO - ============================================================
2025-11-12 23:21:05,656 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:21:05,656 - INFO - Total time: 0.7 minutes
2025-11-12 23:21:05,656 - INFO - Processed segments: 222
2025-11-12 23:21:05,656 - INFO - Average rate: 5.1 segments/second
2025-11-12 23:21:05,656 - INFO - ============================================================
✅ Fold 4 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 5/19
============================================================
2025-11-12 23:21:05,673 - INFO - ============================================================
2025-11-12 23:21:05,673 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:21:05,673 - INFO - ============================================================
2025-11-12 23:21:05,673 - INFO - Output prefix: chb15_fold5
2025-11-12 23:21:05,674 - INFO - EEG Preprocessor initialized
2025-11-12 23:21:05,674 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:21:05,674 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:21:05,674 - INFO - Segment duration: 5 seconds
2025-11-12 23:21:05,674 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:21:05,674 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:21:05,674 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:21:05,674 - INFO - Loading segments from chb15_fold5_sequences_prediction.json
2025-11-12 23:21:05,683 - INFO - Loaded 222 total sequences
2025-11-12 23:21:05,683 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:21:05,683 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:21:05,683 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:21:05,684 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:21:05,684 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:21:05,684 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-12 23:21:05,696 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:21:05,696 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:21:05,696 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:21:05,708 - INFO - ============================================================
2025-11-12 23:21:05,708 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:21:05,708 - INFO - ============================================================
2025-11-12 23:21:05,708 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:21:05,708 - INFO - Processing 184 sequences from 26 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<04:47,  1.57s/it]Processing training data:  13%|###########################3                                                                                                                                                                                      | 24/184 [00:03<00:17,  8.89it/s]Processing training data:  16%|#################################                                                                                                                                                                                 | 29/184 [00:03<00:16,  9.22it/s]Processing training data:  17%|####################################5                                                                                                                                                                             | 32/184 [00:04<00:18,  8.17it/s]Processing training data:  22%|#############################################6                                                                                                                                                                    | 40/184 [00:05<00:21,  6.78it/s]Processing training data:  28%|##########################################################2                                                                                                                                                       | 51/184 [00:07<00:18,  7.12it/s]Processing training data:  34%|######################################################################7                                                                                                                                           | 62/184 [00:08<00:17,  6.99it/s]Processing training data:  45%|#############################################################################################5                                                                                                                    | 82/184 [00:09<00:08, 12.07it/s]Processing training data:  46%|#################################################################################################                                                                                                                 | 85/184 [00:09<00:09, 10.68it/s]Processing training data:  48%|####################################################################################################4                                                                                                             | 88/184 [00:10<00:12,  7.64it/s]Processing training data:  54%|################################################################################################################9                                                                                                 | 99/184 [00:11<00:09,  9.07it/s]Processing training data:  56%|####################################################################################################################9                                                                                            | 103/184 [00:13<00:12,  6.69it/s]Processing training data:  61%|################################################################################################################################3                                                                                | 113/184 [00:13<00:08,  8.70it/s]Processing training data:  65%|########################################################################################################################################3                                                                        | 120/184 [00:14<00:07,  8.41it/s]Processing training data:  68%|###############################################################################################################################################1                                                                 | 126/184 [00:15<00:06,  8.73it/s]Processing training data:  71%|###################################################################################################################################################6                                                             | 130/184 [00:15<00:06,  8.39it/s]Processing training data:  73%|########################################################################################################################################################2                                                        | 134/184 [00:16<00:06,  8.13it/s]Processing training data:  74%|###########################################################################################################################################################6                                                     | 137/184 [00:18<00:09,  4.98it/s]Processing training data:  83%|############################################################################################################################################################################6                                    | 152/184 [00:18<00:03,  9.34it/s]Processing training data:  86%|###################################################################################################################################################################################4                             | 158/184 [00:20<00:03,  6.86it/s]Processing training data:  90%|############################################################################################################################################################################################5                    | 166/184 [00:20<00:02,  8.83it/s]Processing training data:  91%|##############################################################################################################################################################################################8                  | 168/184 [00:21<00:02,  6.28it/s]Processing training data:  94%|####################################################################################################################################################################################################5            | 173/184 [00:22<00:01,  6.82it/s]Processing training data:  96%|#######################################################################################################################################################################################################9         | 176/184 [00:22<00:01,  6.71it/s]Processing training data:  97%|###########################################################################################################################################################################################################3     | 179/184 [00:23<00:00,  6.50it/s]Processing training data:  99%|###############################################################################################################################################################################################################8 | 183/184 [00:23<00:00,  7.00it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.78it/s]
2025-11-12 23:21:29,360 - INFO - Computing normalization statistics from training data...
2025-11-12 23:21:29,642 - INFO - Normalization stats computed:
2025-11-12 23:21:29,643 - INFO -   Mean: -0.683249
2025-11-12 23:21:29,643 - INFO -   Std: 1.992846
2025-11-12 23:21:29,643 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold5\normalization_stats.json
2025-11-12 23:21:29,661 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:21:29,670 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold5\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.08it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 16.28it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.41it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.51it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.56it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.60it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.60it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.62it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.64it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.65it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.46it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.44it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.31it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.48it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.60it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.70it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.74it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.81it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 16.95it/s]
2025-11-12 23:21:40,786 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:21:40,791 - INFO - Loaded normalization statistics:
2025-11-12 23:21:40,791 - INFO -   Mean: -0.683249
2025-11-12 23:21:40,791 - INFO -   Std: 1.992846
2025-11-12 23:21:40,791 - INFO - Split train already completed, skipping
2025-11-12 23:21:40,791 - INFO - Processing test split...
2025-11-12 23:21:40,792 - INFO - Need to process 38/38 sequences for test
2025-11-12 23:21:40,792 - INFO - Processing 38 sequences from 8 unique files
2025-11-12 23:21:40,792 - INFO - Average 4.8 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/38 [00:00<?, ?it/s]Processing test:   3%|#####8                                                                                                                                                                                                                       | 1/38 [00:00<00:21,  1.74it/s]2025-11-12 23:21:41,368 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold5\test_dataset.h5
2025-11-12 23:21:42,442 - INFO - Progress: 203/222 (91.4%) - ETA: 0.1 minutes
Processing test:  53%|###################################################################################################################7                                                                                                        | 20/38 [00:02<00:01, 10.33it/s]Processing test:  58%|###############################################################################################################################3                                                                                            | 22/38 [00:03<00:02,  5.70it/s]Processing test:  66%|################################################################################################################################################7                                                                           | 25/38 [00:04<00:02,  4.82it/s]Processing test:  74%|##################################################################################################################################################################1                                                         | 28/38 [00:05<00:02,  4.92it/s]2025-11-12 23:21:46,449 - INFO - Progress: 213/222 (95.9%) - ETA: 0.0 minutes
Processing test:  79%|#############################################################################################################################################################################6                                              | 30/38 [00:06<00:02,  3.07it/s]Processing test:  92%|##########################################################################################################################################################################################################6                 | 35/38 [00:07<00:00,  3.51it/s]Processing test:  97%|######################################################################################################################################################################################################################2     | 37/38 [00:08<00:00,  3.61it/s]Processing test: 100%|############################################################################################################################################################################################################################| 38/38 [00:08<00:00,  4.52it/s]
2025-11-12 23:21:49,738 - INFO - Validating final datasets...
2025-11-12 23:21:49,745 - INFO - train dataset validation:
2025-11-12 23:21:49,745 - INFO -   - Segments: 184
2025-11-12 23:21:49,745 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:21:49,745 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:21:49,745 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:21:49,750 - INFO - test dataset validation:
2025-11-12 23:21:49,750 - INFO -   - Segments: 38
2025-11-12 23:21:49,750 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:21:49,750 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-12 23:21:49,750 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:21:49,750 - INFO - ============================================================
2025-11-12 23:21:49,750 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:21:49,750 - INFO - Total time: 0.7 minutes
2025-11-12 23:21:49,750 - INFO - Processed segments: 222
2025-11-12 23:21:49,750 - INFO - Average rate: 5.0 segments/second
2025-11-12 23:21:49,750 - INFO - ============================================================
✅ Fold 5 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 6/19
============================================================
2025-11-12 23:21:49,768 - INFO - ============================================================
2025-11-12 23:21:49,768 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:21:49,768 - INFO - ============================================================
2025-11-12 23:21:49,768 - INFO - Output prefix: chb15_fold6
2025-11-12 23:21:49,768 - INFO - EEG Preprocessor initialized
2025-11-12 23:21:49,768 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:21:49,768 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:21:49,768 - INFO - Segment duration: 5 seconds
2025-11-12 23:21:49,768 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:21:49,768 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:21:49,768 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:21:49,768 - INFO - Loading segments from chb15_fold6_sequences_prediction.json
2025-11-12 23:21:49,778 - INFO - Loaded 230 total sequences
2025-11-12 23:21:49,778 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:21:49,778 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:21:49,778 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:21:49,778 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:21:49,778 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:21:49,778 - INFO - test: 46 sequences (23 preictal, 23 interictal)
2025-11-12 23:21:49,790 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:21:49,791 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:21:49,791 - INFO - test: kept 23 preictal and 23 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:21:49,803 - INFO - ============================================================
2025-11-12 23:21:49,803 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:21:49,803 - INFO - ============================================================
2025-11-12 23:21:49,803 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:21:49,803 - INFO - Processing 184 sequences from 26 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<03:35,  1.18s/it]Processing training data:   5%|##########3                                                                                                                                                                                                        | 9/184 [00:02<00:47,  3.68it/s]Processing training data:  10%|#####################6                                                                                                                                                                                            | 19/184 [00:04<00:32,  5.04it/s]Processing training data:  18%|#####################################6                                                                                                                                                                            | 33/184 [00:04<00:16,  9.22it/s]Processing training data:  22%|#############################################6                                                                                                                                                                    | 40/184 [00:06<00:21,  6.81it/s]Processing training data:  28%|##########################################################2                                                                                                                                                       | 51/184 [00:06<00:14,  9.37it/s]Processing training data:  30%|###############################################################9                                                                                                                                                  | 56/184 [00:07<00:15,  8.19it/s]Processing training data:  33%|#####################################################################6                                                                                                                                            | 61/184 [00:09<00:20,  6.15it/s]Processing training data:  39%|#################################################################################                                                                                                                                 | 71/184 [00:11<00:18,  6.06it/s]Processing training data:  45%|#############################################################################################5                                                                                                                    | 82/184 [00:11<00:12,  8.19it/s]Processing training data:  47%|##################################################################################################1                                                                                                               | 86/184 [00:13<00:16,  6.06it/s]Processing training data:  57%|#######################################################################################################################2                                                                                         | 105/184 [00:14<00:09,  8.21it/s]Processing training data:  69%|################################################################################################################################################2                                                                | 127/184 [00:15<00:04, 13.28it/s]Processing training data:  71%|###################################################################################################################################################6                                                             | 130/184 [00:15<00:04, 12.15it/s]Processing training data:  73%|########################################################################################################################################################2                                                        | 134/184 [00:16<00:04, 11.94it/s]Processing training data:  74%|##########################################################################################################################################################4                                                      | 136/184 [00:17<00:05,  8.18it/s]Processing training data:  78%|##################################################################################################################################################################4                                              | 143/184 [00:17<00:05,  8.16it/s]Processing training data:  81%|#########################################################################################################################################################################2                                       | 149/184 [00:19<00:05,  6.60it/s]Processing training data:  86%|####################################################################################################################################################################################6                            | 159/184 [00:19<00:02,  9.07it/s]Processing training data:  89%|##########################################################################################################################################################################################2                      | 164/184 [00:20<00:02,  8.92it/s]Processing training data:  92%|#################################################################################################################################################################################################                | 170/184 [00:20<00:01,  9.68it/s]Processing training data:  95%|#####################################################################################################################################################################################################6           | 174/184 [00:21<00:01,  9.12it/s]Processing training data:  96%|#######################################################################################################################################################################################################9         | 176/184 [00:21<00:00,  8.43it/s]Processing training data:  96%|#########################################################################################################################################################################################################        | 177/184 [00:22<00:01,  6.36it/s]Processing training data:  98%|############################################################################################################################################################################################################4    | 180/184 [00:22<00:00,  6.57it/s]Processing training data:  99%|###############################################################################################################################################################################################################8 | 183/184 [00:23<00:00,  6.11it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.88it/s]
2025-11-12 23:22:13,164 - INFO - Computing normalization statistics from training data...
2025-11-12 23:22:13,437 - INFO - Normalization stats computed:
2025-11-12 23:22:13,437 - INFO -   Mean: -0.735746
2025-11-12 23:22:13,437 - INFO -   Std: 2.005672
2025-11-12 23:22:13,437 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold6\normalization_stats.json
2025-11-12 23:22:13,456 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:22:13,464 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold6\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.44it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 15.71it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 15.63it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:09, 15.84it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 15.98it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.00it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:07, 16.01it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:05<00:06, 16.02it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.13it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.21it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.26it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.33it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:08<00:03, 16.27it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.15it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.04it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 15.96it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.00it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:11<00:00, 15.94it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:11<00:00, 16.39it/s]
2025-11-12 23:22:24,959 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:22:24,965 - INFO - Loaded normalization statistics:
2025-11-12 23:22:24,965 - INFO -   Mean: -0.735746
2025-11-12 23:22:24,965 - INFO -   Std: 2.005672
2025-11-12 23:22:24,965 - INFO - Split train already completed, skipping
2025-11-12 23:22:24,965 - INFO - Processing test split...
2025-11-12 23:22:24,965 - INFO - Need to process 46/46 sequences for test
2025-11-12 23:22:24,965 - INFO - Processing 46 sequences from 11 unique files
2025-11-12 23:22:24,965 - INFO - Average 4.2 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/46 [00:00<?, ?it/s]Processing test:   2%|####8                                                                                                                                                                                                                        | 1/46 [00:00<00:28,  1.60it/s]2025-11-12 23:22:25,593 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold6\test_dataset.h5
2025-11-12 23:22:26,907 - INFO - Progress: 207/230 (90.0%) - ETA: 0.1 minutes
Processing test:  52%|##################################################################################################################7                                                                                                         | 24/46 [00:03<00:03,  7.14it/s]Processing test:  67%|####################################################################################################################################################2                                                                       | 31/46 [00:04<00:02,  7.00it/s]2025-11-12 23:22:30,092 - INFO - Progress: 217/230 (94.3%) - ETA: 0.0 minutes
Processing test:  74%|##################################################################################################################################################################6                                                         | 34/46 [00:05<00:02,  5.99it/s]Processing test:  76%|#######################################################################################################################################################################3                                                    | 35/46 [00:06<00:02,  5.16it/s]Processing test:  80%|################################################################################################################################################################################9                                           | 37/46 [00:06<00:01,  4.81it/s]Processing test:  85%|##########################################################################################################################################################################################5                                 | 39/46 [00:06<00:01,  4.98it/s]Processing test:  87%|###############################################################################################################################################################################################3                            | 40/46 [00:07<00:01,  4.10it/s]Processing test:  91%|########################################################################################################################################################################################################8                   | 42/46 [00:07<00:00,  4.15it/s]2025-11-12 23:22:33,595 - INFO - Progress: 227/230 (98.7%) - ETA: 0.0 minutes
Processing test:  96%|##################################################################################################################################################################################################################4         | 44/46 [00:09<00:00,  2.84it/s]Processing test: 100%|############################################################################################################################################################################################################################| 46/46 [00:09<00:00,  3.31it/s]Processing test: 100%|############################################################################################################################################################################################################################| 46/46 [00:09<00:00,  4.79it/s]
2025-11-12 23:22:34,771 - INFO - Validating final datasets...
2025-11-12 23:22:34,778 - INFO - train dataset validation:
2025-11-12 23:22:34,778 - INFO -   - Segments: 184
2025-11-12 23:22:34,778 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:22:34,778 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:22:34,778 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:22:34,783 - INFO - test dataset validation:
2025-11-12 23:22:34,783 - INFO -   - Segments: 46
2025-11-12 23:22:34,783 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:22:34,783 - INFO -   - Classes: 23 preictal, 23 interictal
2025-11-12 23:22:34,783 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:22:34,783 - INFO - ============================================================
2025-11-12 23:22:34,783 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:22:34,783 - INFO - Total time: 0.8 minutes
2025-11-12 23:22:34,783 - INFO - Processed segments: 230
2025-11-12 23:22:34,783 - INFO - Average rate: 5.1 segments/second
2025-11-12 23:22:34,783 - INFO - ============================================================
✅ Fold 6 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 7/19
============================================================
2025-11-12 23:22:34,801 - INFO - ============================================================
2025-11-12 23:22:34,801 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:22:34,801 - INFO - ============================================================
2025-11-12 23:22:34,801 - INFO - Output prefix: chb15_fold7
2025-11-12 23:22:34,801 - INFO - EEG Preprocessor initialized
2025-11-12 23:22:34,801 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:22:34,801 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:22:34,801 - INFO - Segment duration: 5 seconds
2025-11-12 23:22:34,801 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:22:34,801 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:22:34,801 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:22:34,801 - INFO - Loading segments from chb15_fold7_sequences_prediction.json
2025-11-12 23:22:34,810 - INFO - Loaded 228 total sequences
2025-11-12 23:22:34,810 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:22:34,810 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:22:34,810 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:22:34,810 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:22:34,810 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:22:34,811 - INFO - test: 44 sequences (22 preictal, 22 interictal)
2025-11-12 23:22:34,823 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:22:34,823 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:22:34,823 - INFO - test: kept 22 preictal and 22 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:22:34,835 - INFO - ============================================================
2025-11-12 23:22:34,835 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:22:34,835 - INFO - ============================================================
2025-11-12 23:22:34,835 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:22:34,835 - INFO - Processing 184 sequences from 27 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<04:43,  1.55s/it]Processing training data:   9%|###################4                                                                                                                                                                                              | 17/184 [00:02<00:17,  9.73it/s]Processing training data:  10%|#####################6                                                                                                                                                                                            | 19/184 [00:02<00:21,  7.71it/s]Processing training data:  16%|##################################2                                                                                                                                                                               | 30/184 [00:04<00:22,  6.83it/s]Processing training data:  24%|##################################################2                                                                                                                                                               | 44/184 [00:05<00:16,  8.69it/s]Processing training data:  29%|#############################################################6                                                                                                                                                    | 54/184 [00:07<00:16,  7.74it/s]Processing training data:  39%|#################################################################################                                                                                                                                 | 71/184 [00:07<00:09, 11.42it/s]Processing training data:  40%|####################################################################################4                                                                                                                             | 74/184 [00:09<00:14,  7.36it/s]Processing training data:  47%|##################################################################################################1                                                                                                               | 86/184 [00:11<00:13,  7.34it/s]Processing training data:  52%|#############################################################################################################5                                                                                                    | 96/184 [00:12<00:12,  6.99it/s]Processing training data:  58%|#########################################################################################################################5                                                                                       | 107/184 [00:14<00:11,  6.93it/s]Processing training data:  62%|##################################################################################################################################6                                                                              | 115/184 [00:15<00:10,  6.75it/s]Processing training data:  67%|###########################################################################################################################################7                                                                     | 123/184 [00:16<00:07,  7.82it/s]Processing training data:  70%|##################################################################################################################################################5                                                              | 129/184 [00:16<00:06,  8.30it/s]Processing training data:  74%|##########################################################################################################################################################4                                                      | 136/184 [00:18<00:07,  6.84it/s]Processing training data:  79%|####################################################################################################################################################################7                                            | 145/184 [00:19<00:04,  7.85it/s]Processing training data:  80%|######################################################################################################################################################################9                                          | 147/184 [00:19<00:05,  7.09it/s]Processing training data:  83%|#############################################################################################################################################################################7                                   | 153/184 [00:20<00:03,  8.11it/s]Processing training data:  85%|##################################################################################################################################################################################3                              | 157/184 [00:20<00:03,  7.85it/s]Processing training data:  87%|#####################################################################################################################################################################################7                           | 160/184 [00:21<00:03,  6.34it/s]Processing training data:  90%|###########################################################################################################################################################################################4                     | 165/184 [00:22<00:02,  7.06it/s]Processing training data:  92%|#################################################################################################################################################################################################                | 170/184 [00:22<00:01,  8.37it/s]Processing training data:  93%|##################################################################################################################################################################################################2              | 171/184 [00:22<00:01,  6.84it/s]Processing training data:  95%|######################################################################################################################################################################################################7          | 175/184 [00:23<00:01,  7.55it/s]Processing training data:  96%|#########################################################################################################################################################################################################        | 177/184 [00:23<00:01,  6.30it/s]Processing training data:  99%|###############################################################################################################################################################################################################8 | 183/184 [00:24<00:00,  8.71it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:24<00:00,  7.26it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:24<00:00,  7.48it/s]
2025-11-12 23:22:59,431 - INFO - Computing normalization statistics from training data...
2025-11-12 23:22:59,711 - INFO - Normalization stats computed:
2025-11-12 23:22:59,711 - INFO -   Mean: -0.659142
2025-11-12 23:22:59,711 - INFO -   Std: 1.985841
2025-11-12 23:22:59,711 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold7\normalization_stats.json
2025-11-12 23:22:59,730 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:22:59,738 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold7\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.46it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:09, 16.69it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.69it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.69it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:02<00:07, 16.83it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.67it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.76it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.84it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.77it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:05<00:05, 16.80it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.69it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.58it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.58it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.54it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.50it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.49it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.54it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.62it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 17.01it/s]
2025-11-12 23:23:10,813 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:23:10,819 - INFO - Loaded normalization statistics:
2025-11-12 23:23:10,819 - INFO -   Mean: -0.659142
2025-11-12 23:23:10,819 - INFO -   Std: 1.985841
2025-11-12 23:23:10,819 - INFO - Split train already completed, skipping
2025-11-12 23:23:10,819 - INFO - Processing test split...
2025-11-12 23:23:10,819 - INFO - Need to process 44/44 sequences for test
2025-11-12 23:23:10,819 - INFO - Processing 44 sequences from 10 unique files
2025-11-12 23:23:10,819 - INFO - Average 4.4 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/44 [00:00<?, ?it/s]Processing test:   2%|#####                                                                                                                                                                                                                        | 1/44 [00:00<00:26,  1.65it/s]2025-11-12 23:23:11,427 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold7\test_dataset.h5
2025-11-12 23:23:12,671 - INFO - Progress: 206/228 (90.4%) - ETA: 0.1 minutes
Processing test:  52%|###################################################################################################################                                                                                                         | 23/44 [00:03<00:02,  7.55it/s]Processing test:  61%|#######################################################################################################################################                                                                                     | 27/44 [00:03<00:02,  7.89it/s]Processing test:  66%|#################################################################################################################################################                                                                           | 29/44 [00:04<00:02,  5.38it/s]Processing test:  70%|###########################################################################################################################################################                                                                 | 31/44 [00:05<00:03,  4.32it/s]2025-11-12 23:23:17,291 - INFO - Progress: 218/228 (95.6%) - ETA: 0.0 minutes
Processing test:  80%|###############################################################################################################################################################################                                             | 35/44 [00:06<00:02,  4.03it/s]Processing test:  84%|#########################################################################################################################################################################################                                   | 37/44 [00:07<00:01,  3.94it/s]Processing test:  91%|########################################################################################################################################################################################################                    | 40/44 [00:08<00:01,  3.81it/s]Processing test:  98%|#######################################################################################################################################################################################################################     | 43/44 [00:08<00:00,  4.52it/s]Processing test: 100%|############################################################################################################################################################################################################################| 44/44 [00:09<00:00,  4.23it/s]2025-11-12 23:23:20,448 - INFO - Progress: 228/228 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|############################################################################################################################################################################################################################| 44/44 [00:09<00:00,  4.57it/s]
2025-11-12 23:23:20,461 - INFO - Validating final datasets...
2025-11-12 23:23:20,468 - INFO - train dataset validation:
2025-11-12 23:23:20,468 - INFO -   - Segments: 184
2025-11-12 23:23:20,468 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:23:20,468 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:23:20,469 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:23:20,473 - INFO - test dataset validation:
2025-11-12 23:23:20,473 - INFO -   - Segments: 44
2025-11-12 23:23:20,474 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:23:20,474 - INFO -   - Classes: 22 preictal, 22 interictal
2025-11-12 23:23:20,474 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:23:20,474 - INFO - ============================================================
2025-11-12 23:23:20,474 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:23:20,474 - INFO - Total time: 0.8 minutes
2025-11-12 23:23:20,474 - INFO - Processed segments: 228
2025-11-12 23:23:20,474 - INFO - Average rate: 5.0 segments/second
2025-11-12 23:23:20,474 - INFO - ============================================================
✅ Fold 7 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 8/19
============================================================
2025-11-12 23:23:20,491 - INFO - ============================================================
2025-11-12 23:23:20,491 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:23:20,491 - INFO - ============================================================
2025-11-12 23:23:20,491 - INFO - Output prefix: chb15_fold8
2025-11-12 23:23:20,491 - INFO - EEG Preprocessor initialized
2025-11-12 23:23:20,491 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:23:20,491 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:23:20,491 - INFO - Segment duration: 5 seconds
2025-11-12 23:23:20,491 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:23:20,491 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:23:20,491 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:23:20,491 - INFO - Loading segments from chb15_fold8_sequences_prediction.json
2025-11-12 23:23:20,501 - INFO - Loaded 228 total sequences
2025-11-12 23:23:20,501 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:23:20,501 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:23:20,501 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:23:20,501 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:23:20,501 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:23:20,501 - INFO - test: 44 sequences (22 preictal, 22 interictal)
2025-11-12 23:23:20,513 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:23:20,513 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:23:20,513 - INFO - test: kept 22 preictal and 22 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:23:20,525 - INFO - ============================================================
2025-11-12 23:23:20,525 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:23:20,525 - INFO - ============================================================
2025-11-12 23:23:20,525 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:23:20,525 - INFO - Processing 184 sequences from 28 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:00<01:39,  1.84it/s]Processing training data:   4%|#########1                                                                                                                                                                                                         | 8/184 [00:02<00:45,  3.84it/s]Processing training data:  11%|######################8                                                                                                                                                                                           | 20/184 [00:02<00:18,  8.68it/s]Processing training data:  14%|############################5                                                                                                                                                                                     | 25/184 [00:03<00:21,  7.40it/s]Processing training data:  18%|######################################8                                                                                                                                                                           | 34/184 [00:05<00:23,  6.48it/s]Processing training data:  26%|#####################################################6                                                                                                                                                            | 47/184 [00:05<00:13,  9.81it/s]Processing training data:  29%|#############################################################6                                                                                                                                                    | 54/184 [00:07<00:16,  7.69it/s]Processing training data:  36%|############################################################################4                                                                                                                                     | 67/184 [00:07<00:11, 10.55it/s]Processing training data:  40%|###################################################################################3                                                                                                                              | 73/184 [00:08<00:10, 10.68it/s]Processing training data:  42%|#######################################################################################8                                                                                                                          | 77/184 [00:08<00:10, 10.22it/s]Processing training data:  43%|###########################################################################################3                                                                                                                      | 80/184 [00:10<00:16,  6.26it/s]Processing training data:  49%|#######################################################################################################8                                                                                                          | 91/184 [00:11<00:11,  7.99it/s]Processing training data:  53%|###############################################################################################################8                                                                                                  | 98/184 [00:11<00:09,  8.91it/s]Processing training data:  58%|########################################################################################################################4                                                                                        | 106/184 [00:12<00:07, 10.54it/s]Processing training data:  59%|##########################################################################################################################6                                                                                      | 108/184 [00:13<00:12,  6.08it/s]Processing training data:  65%|#######################################################################################################################################1                                                                         | 119/184 [00:15<00:10,  6.44it/s]Processing training data:  74%|##########################################################################################################################################################4                                                      | 136/184 [00:15<00:04, 10.87it/s]Processing training data:  75%|############################################################################################################################################################7                                                    | 138/184 [00:16<00:04,  9.31it/s]Processing training data:  79%|#####################################################################################################################################################################8                                           | 146/184 [00:18<00:05,  7.56it/s]Processing training data:  83%|#############################################################################################################################################################################7                                   | 153/184 [00:18<00:04,  7.55it/s]Processing training data:  87%|#####################################################################################################################################################################################7                           | 160/184 [00:19<00:02,  8.07it/s]Processing training data:  89%|##########################################################################################################################################################################################2                      | 164/184 [00:20<00:02,  8.11it/s]Processing training data:  92%|###############################################################################################################################################################################################9                 | 169/184 [00:21<00:02,  6.37it/s]Processing training data:  95%|#####################################################################################################################################################################################################6           | 174/184 [00:21<00:01,  7.14it/s]Processing training data:  96%|#########################################################################################################################################################################################################        | 177/184 [00:22<00:01,  6.98it/s]Processing training data:  98%|############################################################################################################################################################################################################4    | 180/184 [00:22<00:00,  7.11it/s]Processing training data:  99%|##############################################################################################################################################################################################################7  | 182/184 [00:23<00:00,  5.90it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  5.86it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.74it/s]
2025-11-12 23:23:44,285 - INFO - Computing normalization statistics from training data...
2025-11-12 23:23:44,560 - INFO - Normalization stats computed:
2025-11-12 23:23:44,560 - INFO -   Mean: -0.717612
2025-11-12 23:23:44,560 - INFO -   Std: 2.012710
2025-11-12 23:23:44,560 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold8\normalization_stats.json
2025-11-12 23:23:44,579 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:23:44,587 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold8\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.53it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 16.29it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.11it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.24it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.30it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.29it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:07, 16.25it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.08it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.20it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.27it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.29it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.32it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.36it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.52it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.68it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.78it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.89it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.98it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 16.85it/s]
2025-11-12 23:23:55,767 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:23:55,774 - INFO - Loaded normalization statistics:
2025-11-12 23:23:55,774 - INFO -   Mean: -0.717612
2025-11-12 23:23:55,774 - INFO -   Std: 2.012710
2025-11-12 23:23:55,774 - INFO - Split train already completed, skipping
2025-11-12 23:23:55,774 - INFO - Processing test split...
2025-11-12 23:23:55,774 - INFO - Need to process 44/44 sequences for test
2025-11-12 23:23:55,774 - INFO - Processing 44 sequences from 10 unique files
2025-11-12 23:23:55,774 - INFO - Average 4.4 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/44 [00:00<?, ?it/s]Processing test:   2%|#####                                                                                                                                                                                                                        | 1/44 [00:00<00:26,  1.61it/s]2025-11-12 23:23:56,395 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold8\test_dataset.h5
2025-11-12 23:23:57,611 - INFO - Progress: 206/228 (90.4%) - ETA: 0.1 minutes
Processing test:  52%|###################################################################################################################                                                                                                         | 23/44 [00:03<00:02,  7.21it/s]Processing test:  57%|#############################################################################################################################                                                                                               | 25/44 [00:04<00:03,  5.12it/s]Processing test:  68%|######################################################################################################################################################                                                                      | 30/44 [00:05<00:02,  5.51it/s]Processing test:  73%|################################################################################################################################################################                                                            | 32/44 [00:06<00:02,  4.44it/s]2025-11-12 23:24:02,810 - INFO - Progress: 218/228 (95.6%) - ETA: 0.0 minutes
Processing test:  80%|###############################################################################################################################################################################                                             | 35/44 [00:07<00:02,  3.96it/s]Processing test:  82%|####################################################################################################################################################################################                                        | 36/44 [00:08<00:02,  2.99it/s]Processing test:  95%|##################################################################################################################################################################################################################          | 42/44 [00:08<00:00,  4.82it/s]Processing test:  98%|#######################################################################################################################################################################################################################     | 43/44 [00:09<00:00,  4.52it/s]Processing test: 100%|############################################################################################################################################################################################################################| 44/44 [00:09<00:00,  4.18it/s]2025-11-12 23:24:05,863 - INFO - Progress: 228/228 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|############################################################################################################################################################################################################################| 44/44 [00:10<00:00,  4.36it/s]
2025-11-12 23:24:05,875 - INFO - Validating final datasets...
2025-11-12 23:24:05,883 - INFO - train dataset validation:
2025-11-12 23:24:05,883 - INFO -   - Segments: 184
2025-11-12 23:24:05,883 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:24:05,883 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:24:05,883 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:24:05,888 - INFO - test dataset validation:
2025-11-12 23:24:05,888 - INFO -   - Segments: 44
2025-11-12 23:24:05,888 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:24:05,888 - INFO -   - Classes: 22 preictal, 22 interictal
2025-11-12 23:24:05,888 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:24:05,889 - INFO - ============================================================
2025-11-12 23:24:05,889 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:24:05,889 - INFO - Total time: 0.8 minutes
2025-11-12 23:24:05,889 - INFO - Processed segments: 228
2025-11-12 23:24:05,889 - INFO - Average rate: 5.0 segments/second
2025-11-12 23:24:05,889 - INFO - ============================================================
✅ Fold 8 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 9/19
============================================================
2025-11-12 23:24:05,906 - INFO - ============================================================
2025-11-12 23:24:05,906 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:24:05,906 - INFO - ============================================================
2025-11-12 23:24:05,906 - INFO - Output prefix: chb15_fold9
2025-11-12 23:24:05,906 - INFO - EEG Preprocessor initialized
2025-11-12 23:24:05,906 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:24:05,906 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:24:05,906 - INFO - Segment duration: 5 seconds
2025-11-12 23:24:05,906 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:24:05,906 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:24:05,906 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:24:05,906 - INFO - Loading segments from chb15_fold9_sequences_prediction.json
2025-11-12 23:24:05,916 - INFO - Loaded 224 total sequences
2025-11-12 23:24:05,916 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:24:05,916 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:24:05,916 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:24:05,916 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:24:05,916 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:24:05,916 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-12 23:24:05,928 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:24:05,929 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:24:05,929 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:24:05,941 - INFO - ============================================================
2025-11-12 23:24:05,941 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:24:05,941 - INFO - ============================================================
2025-11-12 23:24:05,941 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:24:05,941 - INFO - Processing 184 sequences from 27 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<04:19,  1.42s/it]Processing training data:   6%|############5                                                                                                                                                                                                     | 11/184 [00:02<00:41,  4.20it/s]Processing training data:   8%|#################1                                                                                                                                                                                                | 15/184 [00:03<00:32,  5.18it/s]Processing training data:  10%|#####################6                                                                                                                                                                                            | 19/184 [00:04<00:42,  3.92it/s]Processing training data:  17%|###################################3                                                                                                                                                                              | 31/184 [00:06<00:27,  5.61it/s]Processing training data:  24%|##################################################2                                                                                                                                                               | 44/184 [00:06<00:15,  8.89it/s]Processing training data:  27%|#########################################################                                                                                                                                                         | 50/184 [00:08<00:20,  6.65it/s]Processing training data:  34%|#######################################################################9                                                                                                                                          | 63/184 [00:10<00:16,  7.17it/s]Processing training data:  44%|############################################################################################4                                                                                                                     | 81/184 [00:10<00:09, 11.22it/s]Processing training data:  49%|######################################################################################################7                                                                                                           | 90/184 [00:11<00:08, 11.03it/s]Processing training data:  52%|############################################################################################################4                                                                                                     | 95/184 [00:12<00:08, 10.67it/s]Processing training data:  55%|##################################################################################################################7                                                                                              | 101/184 [00:13<00:11,  7.50it/s]Processing training data:  62%|#################################################################################################################################4                                                                               | 114/184 [00:14<00:06, 10.69it/s]Processing training data:  64%|####################################################################################################################################8                                                                            | 117/184 [00:15<00:07,  8.43it/s]Processing training data:  68%|###############################################################################################################################################1                                                                 | 126/184 [00:15<00:05,  9.97it/s]Processing training data:  72%|#####################################################################################################################################################9                                                           | 132/184 [00:16<00:05,  8.86it/s]Processing training data:  75%|############################################################################################################################################################7                                                    | 138/184 [00:17<00:05,  9.17it/s]Processing training data:  78%|##################################################################################################################################################################4                                              | 143/184 [00:17<00:04,  9.52it/s]Processing training data:  80%|########################################################################################################################################################################1                                        | 148/184 [00:18<00:04,  8.67it/s]Processing training data:  82%|##########################################################################################################################################################################3                                      | 150/184 [00:19<00:06,  5.03it/s]Processing training data:  87%|#####################################################################################################################################################################################7                           | 160/184 [00:20<00:03,  7.68it/s]Processing training data:  90%|############################################################################################################################################################################################5                    | 166/184 [00:21<00:02,  8.33it/s]Processing training data:  92%|###############################################################################################################################################################################################9                 | 169/184 [00:21<00:01,  7.90it/s]Processing training data:  96%|#######################################################################################################################################################################################################9         | 176/184 [00:22<00:00,  8.79it/s]Processing training data:  98%|############################################################################################################################################################################################################4    | 180/184 [00:22<00:00,  9.10it/s]Processing training data:  99%|##############################################################################################################################################################################################################7  | 182/184 [00:23<00:00,  7.43it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.05it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.83it/s]
2025-11-12 23:24:29,451 - INFO - Computing normalization statistics from training data...
2025-11-12 23:24:29,730 - INFO - Normalization stats computed:
2025-11-12 23:24:29,730 - INFO -   Mean: -0.750140
2025-11-12 23:24:29,730 - INFO -   Std: 1.995463
2025-11-12 23:24:29,730 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold9\normalization_stats.json
2025-11-12 23:24:29,748 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:24:29,757 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold9\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.26it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:09, 16.40it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.46it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.48it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.47it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.34it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.36it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.41it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.36it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.38it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.37it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.40it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.29it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.41it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.47it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.57it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.74it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.83it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 16.86it/s]
2025-11-12 23:24:40,916 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:24:40,922 - INFO - Loaded normalization statistics:
2025-11-12 23:24:40,922 - INFO -   Mean: -0.750140
2025-11-12 23:24:40,922 - INFO -   Std: 1.995463
2025-11-12 23:24:40,922 - INFO - Split train already completed, skipping
2025-11-12 23:24:40,922 - INFO - Processing test split...
2025-11-12 23:24:40,922 - INFO - Need to process 40/40 sequences for test
2025-11-12 23:24:40,922 - INFO - Processing 40 sequences from 11 unique files
2025-11-12 23:24:40,922 - INFO - Average 3.6 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/40 [00:00<?, ?it/s]Processing test:   2%|#####5                                                                                                                                                                                                                       | 1/40 [00:00<00:22,  1.71it/s]2025-11-12 23:24:41,509 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold9\test_dataset.h5
2025-11-12 23:24:42,625 - INFO - Progress: 204/224 (91.1%) - ETA: 0.1 minutes
Processing test:  52%|###################################################################################################################5                                                                                                        | 21/40 [00:02<00:01,  9.81it/s]Processing test:  60%|####################################################################################################################################                                                                                        | 24/40 [00:02<00:01,  9.59it/s]Processing test:  62%|#########################################################################################################################################5                                                                                  | 25/40 [00:02<00:01,  8.15it/s]Processing test:  65%|###############################################################################################################################################                                                                             | 26/40 [00:04<00:02,  4.75it/s]Processing test:  72%|###############################################################################################################################################################5                                                            | 29/40 [00:05<00:02,  4.01it/s]2025-11-12 23:24:46,653 - INFO - Progress: 216/224 (96.4%) - ETA: 0.0 minutes
Processing test:  82%|#####################################################################################################################################################################################5                                      | 33/40 [00:06<00:02,  3.32it/s]Processing test:  88%|################################################################################################################################################################################################5                           | 35/40 [00:07<00:01,  3.55it/s]Processing test:  92%|###########################################################################################################################################################################################################5                | 37/40 [00:07<00:00,  3.88it/s]Processing test:  95%|#################################################################################################################################################################################################################           | 38/40 [00:07<00:00,  3.70it/s]Processing test:  98%|######################################################################################################################################################################################################################5     | 39/40 [00:08<00:00,  2.73it/s]Processing test: 100%|############################################################################################################################################################################################################################| 40/40 [00:08<00:00,  4.67it/s]
2025-11-12 23:24:49,980 - INFO - Validating final datasets...
2025-11-12 23:24:49,988 - INFO - train dataset validation:
2025-11-12 23:24:49,988 - INFO -   - Segments: 184
2025-11-12 23:24:49,988 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:24:49,988 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:24:49,988 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:24:49,994 - INFO - test dataset validation:
2025-11-12 23:24:49,994 - INFO -   - Segments: 40
2025-11-12 23:24:49,994 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:24:49,994 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-12 23:24:49,994 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:24:49,994 - INFO - ============================================================
2025-11-12 23:24:49,994 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:24:49,994 - INFO - Total time: 0.7 minutes
2025-11-12 23:24:49,994 - INFO - Processed segments: 224
2025-11-12 23:24:49,994 - INFO - Average rate: 5.1 segments/second
2025-11-12 23:24:49,994 - INFO - ============================================================
✅ Fold 9 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 10/19
============================================================
2025-11-12 23:24:50,011 - INFO - ============================================================
2025-11-12 23:24:50,011 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:24:50,011 - INFO - ============================================================
2025-11-12 23:24:50,011 - INFO - Output prefix: chb15_fold10
2025-11-12 23:24:50,012 - INFO - EEG Preprocessor initialized
2025-11-12 23:24:50,012 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:24:50,012 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:24:50,012 - INFO - Segment duration: 5 seconds
2025-11-12 23:24:50,012 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:24:50,012 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:24:50,012 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:24:50,012 - INFO - Loading segments from chb15_fold10_sequences_prediction.json
2025-11-12 23:24:50,022 - INFO - Loaded 226 total sequences
2025-11-12 23:24:50,022 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:24:50,022 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:24:50,022 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:24:50,022 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:24:50,022 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:24:50,022 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-12 23:24:50,034 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:24:50,035 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:24:50,035 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:24:50,046 - INFO - ============================================================
2025-11-12 23:24:50,047 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:24:50,047 - INFO - ============================================================
2025-11-12 23:24:50,047 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:24:50,047 - INFO - Processing 184 sequences from 29 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:00<01:50,  1.66it/s]Processing training data:   4%|#########1                                                                                                                                                                                                         | 8/184 [00:02<00:43,  4.09it/s]Processing training data:  10%|####################5                                                                                                                                                                                             | 18/184 [00:02<00:20,  8.11it/s]Processing training data:  12%|#########################1                                                                                                                                                                                        | 22/184 [00:03<00:27,  5.98it/s]Processing training data:  16%|#################################                                                                                                                                                                                 | 29/184 [00:05<00:29,  5.18it/s]Processing training data:  30%|###############################################################9                                                                                                                                                  | 56/184 [00:06<00:10, 11.82it/s]Processing training data:  35%|#########################################################################                                                                                                                                         | 64/184 [00:06<00:09, 12.99it/s]Processing training data:  36%|############################################################################4                                                                                                                                     | 67/184 [00:07<00:10, 11.29it/s]Processing training data:  39%|##################################################################################1                                                                                                                               | 72/184 [00:08<00:14,  7.66it/s]Processing training data:  47%|##################################################################################################1                                                                                                               | 86/184 [00:09<00:08, 11.01it/s]Processing training data:  51%|##########################################################################################################1                                                                                                       | 93/184 [00:10<00:09,  9.15it/s]Processing training data:  57%|######################################################################################################################1                                                                                          | 104/184 [00:10<00:06, 11.93it/s]Processing training data:  59%|###########################################################################################################################8                                                                                     | 109/184 [00:11<00:07,  9.82it/s]Processing training data:  61%|###############################################################################################################################2                                                                                 | 112/184 [00:13<00:11,  6.33it/s]Processing training data:  66%|#########################################################################################################################################4                                                                       | 121/184 [00:13<00:07,  8.64it/s]Processing training data:  67%|############################################################################################################################################8                                                                    | 124/184 [00:14<00:07,  8.16it/s]Processing training data:  68%|###############################################################################################################################################1                                                                 | 126/184 [00:15<00:12,  4.73it/s]Processing training data:  75%|############################################################################################################################################################7                                                    | 138/184 [00:16<00:05,  8.53it/s]Processing training data:  76%|###############################################################################################################################################################                                                  | 140/184 [00:16<00:05,  7.40it/s]Processing training data:  78%|##################################################################################################################################################################4                                              | 143/184 [00:17<00:05,  7.15it/s]Processing training data:  79%|#####################################################################################################################################################################8                                           | 146/184 [00:17<00:05,  6.47it/s]Processing training data:  83%|#############################################################################################################################################################################7                                   | 153/184 [00:18<00:03,  9.06it/s]Processing training data:  84%|################################################################################################################################################################################                                 | 155/184 [00:19<00:04,  6.42it/s]Processing training data:  86%|####################################################################################################################################################################################6                            | 159/184 [00:20<00:05,  4.66it/s]Processing training data:  92%|#################################################################################################################################################################################################                | 170/184 [00:21<00:01,  7.64it/s]Processing training data:  95%|#####################################################################################################################################################################################################6           | 174/184 [00:21<00:01,  7.34it/s]Processing training data:  97%|###########################################################################################################################################################################################################3     | 179/184 [00:23<00:00,  5.55it/s]Processing training data:  99%|###############################################################################################################################################################################################################8 | 183/184 [00:23<00:00,  6.35it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  5.81it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.67it/s]
2025-11-12 23:25:14,039 - INFO - Computing normalization statistics from training data...
2025-11-12 23:25:14,314 - INFO - Normalization stats computed:
2025-11-12 23:25:14,314 - INFO -   Mean: -0.773573
2025-11-12 23:25:14,315 - INFO -   Std: 2.032656
2025-11-12 23:25:14,315 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold10\normalization_stats.json
2025-11-12 23:25:14,333 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:25:14,341 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold10\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.63it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 15.96it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.21it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.34it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.42it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.48it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.53it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.56it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.60it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.59it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.59it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.58it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.49it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.57it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.68it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.74it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.83it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.86it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 16.96it/s]
2025-11-12 23:25:25,435 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:25:25,442 - INFO - Loaded normalization statistics:
2025-11-12 23:25:25,442 - INFO -   Mean: -0.773573
2025-11-12 23:25:25,442 - INFO -   Std: 2.032656
2025-11-12 23:25:25,442 - INFO - Split train already completed, skipping
2025-11-12 23:25:25,442 - INFO - Processing test split...
2025-11-12 23:25:25,442 - INFO - Need to process 42/42 sequences for test
2025-11-12 23:25:25,442 - INFO - Processing 42 sequences from 12 unique files
2025-11-12 23:25:25,442 - INFO - Average 3.5 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/42 [00:00<?, ?it/s]Processing test:   2%|#####2                                                                                                                                                                                                                       | 1/42 [00:00<00:24,  1.65it/s]2025-11-12 23:25:26,049 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold10\test_dataset.h5
2025-11-12 23:25:27,252 - INFO - Progress: 205/226 (90.7%) - ETA: 0.1 minutes
Processing test:  52%|###################################################################################################################2                                                                                                        | 22/42 [00:03<00:02,  7.52it/s]Processing test:  62%|########################################################################################################################################1                                                                                   | 26/42 [00:03<00:02,  6.69it/s]Processing test:  69%|#######################################################################################################################################################9                                                                    | 29/42 [00:04<00:02,  5.75it/s]2025-11-12 23:25:30,794 - INFO - Progress: 215/226 (95.1%) - ETA: 0.0 minutes
Processing test:  76%|#######################################################################################################################################################################6                                                    | 32/42 [00:06<00:02,  4.43it/s]Processing test:  83%|#######################################################################################################################################################################################3                                    | 35/42 [00:06<00:01,  5.01it/s]Processing test:  86%|############################################################################################################################################################################################5                               | 36/42 [00:06<00:01,  4.62it/s]Processing test:  88%|#################################################################################################################################################################################################8                          | 37/42 [00:07<00:01,  4.37it/s]Processing test:  90%|#######################################################################################################################################################################################################                     | 38/42 [00:07<00:01,  3.36it/s]Processing test:  95%|#################################################################################################################################################################################################################5          | 40/42 [00:08<00:00,  3.82it/s]Processing test:  98%|######################################################################################################################################################################################################################7     | 41/42 [00:08<00:00,  3.60it/s]2025-11-12 23:25:34,540 - INFO - Progress: 225/226 (99.6%) - ETA: 0.0 minutes
Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:09<00:00,  2.41it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:09<00:00,  4.46it/s]
2025-11-12 23:25:34,956 - INFO - Validating final datasets...
2025-11-12 23:25:34,964 - INFO - train dataset validation:
2025-11-12 23:25:34,964 - INFO -   - Segments: 184
2025-11-12 23:25:34,964 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:25:34,964 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:25:34,964 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:25:34,969 - INFO - test dataset validation:
2025-11-12 23:25:34,969 - INFO -   - Segments: 42
2025-11-12 23:25:34,969 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:25:34,969 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-12 23:25:34,969 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:25:34,969 - INFO - ============================================================
2025-11-12 23:25:34,969 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:25:34,969 - INFO - Total time: 0.7 minutes
2025-11-12 23:25:34,969 - INFO - Processed segments: 226
2025-11-12 23:25:34,969 - INFO - Average rate: 5.0 segments/second
2025-11-12 23:25:34,969 - INFO - ============================================================
✅ Fold 10 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 11/19
============================================================
2025-11-12 23:25:34,986 - INFO - ============================================================
2025-11-12 23:25:34,986 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:25:34,986 - INFO - ============================================================
2025-11-12 23:25:34,986 - INFO - Output prefix: chb15_fold11
2025-11-12 23:25:34,986 - INFO - EEG Preprocessor initialized
2025-11-12 23:25:34,986 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:25:34,986 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:25:34,986 - INFO - Segment duration: 5 seconds
2025-11-12 23:25:34,986 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:25:34,986 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:25:34,986 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:25:34,986 - INFO - Loading segments from chb15_fold11_sequences_prediction.json
2025-11-12 23:25:34,996 - INFO - Loaded 222 total sequences
2025-11-12 23:25:34,996 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:25:34,996 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:25:34,996 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:25:34,996 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:25:34,996 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:25:34,996 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-12 23:25:35,008 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:25:35,008 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:25:35,008 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:25:35,020 - INFO - ============================================================
2025-11-12 23:25:35,020 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:25:35,020 - INFO - ============================================================
2025-11-12 23:25:35,020 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:25:35,020 - INFO - Processing 184 sequences from 27 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<04:52,  1.60s/it]Processing training data:  14%|############################5                                                                                                                                                                                     | 25/184 [00:03<00:16,  9.64it/s]Processing training data:  20%|##########################################2                                                                                                                                                                       | 37/184 [00:03<00:12, 12.20it/s]Processing training data:  24%|###################################################3                                                                                                                                                              | 45/184 [00:05<00:15,  8.86it/s]Processing training data:  28%|##########################################################2                                                                                                                                                       | 51/184 [00:05<00:14,  8.97it/s]Processing training data:  30%|##############################################################7                                                                                                                                                   | 55/184 [00:06<00:18,  6.99it/s]Processing training data:  34%|#######################################################################9                                                                                                                                          | 63/184 [00:08<00:19,  6.18it/s]Processing training data:  40%|####################################################################################4                                                                                                                             | 74/184 [00:09<00:12,  8.65it/s]Processing training data:  42%|#########################################################################################                                                                                                                         | 78/184 [00:09<00:12,  8.37it/s]Processing training data:  46%|###############################################################################################8                                                                                                                  | 84/184 [00:10<00:11,  8.81it/s]Processing training data:  47%|###################################################################################################2                                                                                                              | 87/184 [00:10<00:11,  8.17it/s]Processing training data:  49%|#######################################################################################################8                                                                                                          | 91/184 [00:11<00:11,  7.98it/s]Processing training data:  52%|#############################################################################################################5                                                                                                    | 96/184 [00:12<00:11,  7.36it/s]Processing training data:  55%|###################################################################################################################8                                                                                             | 102/184 [00:13<00:14,  5.66it/s]Processing training data:  62%|#################################################################################################################################4                                                                               | 114/184 [00:15<00:10,  6.63it/s]Processing training data:  66%|##########################################################################################################################################5                                                                      | 122/184 [00:16<00:10,  6.04it/s]Processing training data:  70%|##################################################################################################################################################5                                                              | 129/184 [00:17<00:09,  6.01it/s]Processing training data:  75%|############################################################################################################################################################7                                                    | 138/184 [00:18<00:05,  7.85it/s]Processing training data:  78%|##################################################################################################################################################################4                                              | 143/184 [00:19<00:06,  5.90it/s]Processing training data:  85%|#################################################################################################################################################################################1                               | 156/184 [00:20<00:03,  8.78it/s]Processing training data:  86%|####################################################################################################################################################################################6                            | 159/184 [00:21<00:03,  8.00it/s]Processing training data:  90%|###########################################################################################################################################################################################4                     | 165/184 [00:21<00:02,  7.74it/s]Processing training data:  93%|##################################################################################################################################################################################################2              | 171/184 [00:22<00:01,  8.84it/s]Processing training data:  94%|####################################################################################################################################################################################################5            | 173/184 [00:22<00:01,  7.55it/s]Processing training data:  97%|##########################################################################################################################################################################################################1      | 178/184 [00:23<00:00,  7.87it/s]Processing training data:  98%|############################################################################################################################################################################################################4    | 180/184 [00:23<00:00,  7.00it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:24<00:00,  7.85it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:24<00:00,  7.56it/s]
2025-11-12 23:25:59,364 - INFO - Computing normalization statistics from training data...
2025-11-12 23:25:59,640 - INFO - Normalization stats computed:
2025-11-12 23:25:59,640 - INFO -   Mean: -0.762403
2025-11-12 23:25:59,640 - INFO -   Std: 2.003053
2025-11-12 23:25:59,640 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold11\normalization_stats.json
2025-11-12 23:25:59,659 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:25:59,667 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold11\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.06it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:09, 16.44it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.54it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.62it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.64it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.62it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.64it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.68it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.67it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.68it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.66it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.68it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.68it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.81it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:08<00:02, 16.90it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.96it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 17.01it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 17.03it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 17.13it/s]
2025-11-12 23:26:10,656 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:26:10,662 - INFO - Loaded normalization statistics:
2025-11-12 23:26:10,662 - INFO -   Mean: -0.762403
2025-11-12 23:26:10,662 - INFO -   Std: 2.003053
2025-11-12 23:26:10,662 - INFO - Split train already completed, skipping
2025-11-12 23:26:10,662 - INFO - Processing test split...
2025-11-12 23:26:10,662 - INFO - Need to process 38/38 sequences for test
2025-11-12 23:26:10,662 - INFO - Processing 38 sequences from 9 unique files
2025-11-12 23:26:10,662 - INFO - Average 4.2 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/38 [00:00<?, ?it/s]Processing test:   3%|#####8                                                                                                                                                                                                                       | 1/38 [00:00<00:21,  1.70it/s]2025-11-12 23:26:11,251 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold11\test_dataset.h5
2025-11-12 23:26:12,302 - INFO - Progress: 203/222 (91.4%) - ETA: 0.1 minutes
Processing test:  53%|###################################################################################################################7                                                                                                        | 20/38 [00:02<00:02,  7.39it/s]Processing test:  71%|############################################################################################################################################################3                                                               | 27/38 [00:03<00:01,  9.42it/s]Processing test:  76%|#######################################################################################################################################################################8                                                    | 29/38 [00:03<00:01,  8.43it/s]2025-11-12 23:26:14,837 - INFO - Progress: 213/222 (95.9%) - ETA: 0.0 minutes
Processing test:  79%|#############################################################################################################################################################################6                                              | 30/38 [00:05<00:01,  4.48it/s]Processing test:  89%|####################################################################################################################################################################################################8                       | 34/38 [00:05<00:00,  4.84it/s]Processing test:  95%|################################################################################################################################################################################################################4           | 36/38 [00:06<00:00,  4.99it/s]Processing test:  97%|######################################################################################################################################################################################################################2     | 37/38 [00:06<00:00,  4.63it/s]Processing test: 100%|############################################################################################################################################################################################################################| 38/38 [00:06<00:00,  4.25it/s]Processing test: 100%|############################################################################################################################################################################################################################| 38/38 [00:06<00:00,  5.63it/s]
2025-11-12 23:26:17,932 - INFO - Validating final datasets...
2025-11-12 23:26:17,940 - INFO - train dataset validation:
2025-11-12 23:26:17,940 - INFO -   - Segments: 184
2025-11-12 23:26:17,940 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:26:17,940 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:26:17,940 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:26:17,945 - INFO - test dataset validation:
2025-11-12 23:26:17,945 - INFO -   - Segments: 38
2025-11-12 23:26:17,945 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:26:17,945 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-12 23:26:17,945 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:26:17,945 - INFO - ============================================================
2025-11-12 23:26:17,945 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:26:17,945 - INFO - Total time: 0.7 minutes
2025-11-12 23:26:17,945 - INFO - Processed segments: 222
2025-11-12 23:26:17,945 - INFO - Average rate: 5.2 segments/second
2025-11-12 23:26:17,945 - INFO - ============================================================
✅ Fold 11 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 12/19
============================================================
2025-11-12 23:26:17,962 - INFO - ============================================================
2025-11-12 23:26:17,963 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:26:17,963 - INFO - ============================================================
2025-11-12 23:26:17,963 - INFO - Output prefix: chb15_fold12
2025-11-12 23:26:17,963 - INFO - EEG Preprocessor initialized
2025-11-12 23:26:17,963 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:26:17,963 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:26:17,963 - INFO - Segment duration: 5 seconds
2025-11-12 23:26:17,963 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:26:17,963 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:26:17,963 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:26:17,963 - INFO - Loading segments from chb15_fold12_sequences_prediction.json
2025-11-12 23:26:17,973 - INFO - Loaded 226 total sequences
2025-11-12 23:26:17,973 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:26:17,973 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:26:17,973 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:26:17,973 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:26:17,973 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:26:17,973 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-12 23:26:17,985 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:26:17,986 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:26:17,986 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:26:17,997 - INFO - ============================================================
2025-11-12 23:26:17,997 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:26:17,997 - INFO - ============================================================
2025-11-12 23:26:17,997 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:26:17,998 - INFO - Processing 184 sequences from 27 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:00<01:32,  1.99it/s]Processing training data:   5%|##########3                                                                                                                                                                                                        | 9/184 [00:01<00:31,  5.54it/s]Processing training data:  10%|#####################6                                                                                                                                                                                            | 19/184 [00:02<00:18,  8.74it/s]Processing training data:  14%|############################5                                                                                                                                                                                     | 25/184 [00:03<00:20,  7.90it/s]Processing training data:  17%|###################################3                                                                                                                                                                              | 31/184 [00:04<00:26,  5.83it/s]Processing training data:  27%|#######################################################9                                                                                                                                                          | 49/184 [00:05<00:11, 11.30it/s]Processing training data:  29%|#############################################################6                                                                                                                                                    | 54/184 [00:07<00:16,  7.68it/s]Processing training data:  33%|#####################################################################6                                                                                                                                            | 61/184 [00:08<00:19,  6.47it/s]Processing training data:  40%|###################################################################################3                                                                                                                              | 73/184 [00:10<00:15,  7.03it/s]Processing training data:  46%|#################################################################################################                                                                                                                 | 85/184 [00:11<00:13,  7.32it/s]Processing training data:  55%|###################################################################################################################8                                                                                             | 102/184 [00:11<00:07, 11.25it/s]Processing training data:  57%|######################################################################################################################1                                                                                          | 104/184 [00:13<00:10,  7.35it/s]Processing training data:  61%|###############################################################################################################################2                                                                                 | 112/184 [00:14<00:08,  8.58it/s]Processing training data:  63%|###################################################################################################################################7                                                                             | 116/184 [00:14<00:07,  8.88it/s]Processing training data:  64%|######################################################################################################################################                                                                           | 118/184 [00:14<00:08,  7.77it/s]Processing training data:  68%|#############################################################################################################################################9                                                                   | 125/184 [00:16<00:08,  6.57it/s]Processing training data:  73%|#########################################################################################################################################################3                                                       | 135/184 [00:16<00:05,  9.00it/s]Processing training data:  75%|############################################################################################################################################################7                                                    | 138/184 [00:17<00:05,  8.18it/s]Processing training data:  78%|###################################################################################################################################################################5                                             | 144/184 [00:17<00:04,  9.05it/s]Processing training data:  79%|#####################################################################################################################################################################8                                           | 146/184 [00:19<00:07,  5.11it/s]Processing training data:  85%|##################################################################################################################################################################################3                              | 157/184 [00:20<00:04,  6.58it/s]Processing training data:  90%|###########################################################################################################################################################################################4                     | 165/184 [00:21<00:02,  8.49it/s]Processing training data:  91%|#############################################################################################################################################################################################6                   | 167/184 [00:21<00:02,  7.33it/s]Processing training data:  95%|#####################################################################################################################################################################################################6           | 174/184 [00:22<00:01,  8.29it/s]Processing training data:  97%|##########################################################################################################################################################################################################1      | 178/184 [00:22<00:00,  8.63it/s]Processing training data:  98%|############################################################################################################################################################################################################4    | 180/184 [00:23<00:00,  7.18it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  8.02it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.78it/s]
2025-11-12 23:26:41,664 - INFO - Computing normalization statistics from training data...
2025-11-12 23:26:41,940 - INFO - Normalization stats computed:
2025-11-12 23:26:41,940 - INFO -   Mean: -0.796480
2025-11-12 23:26:41,940 - INFO -   Std: 1.996653
2025-11-12 23:26:41,940 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold12\normalization_stats.json
2025-11-12 23:26:41,959 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:26:41,967 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold12\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.71it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:09, 16.81it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.89it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.79it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:02<00:08, 16.74it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.72it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.80it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.83it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.83it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:05<00:04, 16.90it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.87it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.90it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.83it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.78it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:08<00:02, 16.96it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 17.04it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 17.15it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 17.20it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 17.30it/s]
2025-11-12 23:26:52,850 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:26:52,856 - INFO - Loaded normalization statistics:
2025-11-12 23:26:52,856 - INFO -   Mean: -0.796480
2025-11-12 23:26:52,856 - INFO -   Std: 1.996653
2025-11-12 23:26:52,857 - INFO - Split train already completed, skipping
2025-11-12 23:26:52,857 - INFO - Processing test split...
2025-11-12 23:26:52,857 - INFO - Need to process 42/42 sequences for test
2025-11-12 23:26:52,857 - INFO - Processing 42 sequences from 10 unique files
2025-11-12 23:26:52,857 - INFO - Average 4.2 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/42 [00:00<?, ?it/s]Processing test:   2%|#####2                                                                                                                                                                                                                       | 1/42 [00:01<00:55,  1.35s/it]Processing test:  14%|###############################5                                                                                                                                                                                             | 6/42 [00:01<00:09,  3.81it/s]Processing test:  19%|##########################################                                                                                                                                                                                   | 8/42 [00:02<00:09,  3.54it/s]2025-11-12 23:26:55,407 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold12\test_dataset.h5
2025-11-12 23:26:56,968 - INFO - Progress: 212/226 (93.8%) - ETA: 0.0 minutes
Processing test:  69%|#######################################################################################################################################################9                                                                    | 29/42 [00:05<00:02,  5.95it/s]Processing test:  81%|##################################################################################################################################################################################                                          | 34/42 [00:05<00:01,  6.73it/s]Processing test:  86%|############################################################################################################################################################################################5                               | 36/42 [00:06<00:00,  6.56it/s]Processing test:  88%|#################################################################################################################################################################################################8                          | 37/42 [00:07<00:01,  4.80it/s]2025-11-12 23:27:00,776 - INFO - Progress: 223/226 (98.7%) - ETA: 0.0 minutes
Processing test:  95%|#################################################################################################################################################################################################################5          | 40/42 [00:08<00:00,  4.24it/s]Processing test:  98%|######################################################################################################################################################################################################################7     | 41/42 [00:08<00:00,  4.08it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:08<00:00,  3.88it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:08<00:00,  4.72it/s]
2025-11-12 23:27:01,963 - INFO - Validating final datasets...
2025-11-12 23:27:01,970 - INFO - train dataset validation:
2025-11-12 23:27:01,970 - INFO -   - Segments: 184
2025-11-12 23:27:01,970 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:27:01,970 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:27:01,970 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:27:01,975 - INFO - test dataset validation:
2025-11-12 23:27:01,975 - INFO -   - Segments: 42
2025-11-12 23:27:01,975 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:27:01,975 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-12 23:27:01,975 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:27:01,975 - INFO - ============================================================
2025-11-12 23:27:01,975 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:27:01,975 - INFO - Total time: 0.7 minutes
2025-11-12 23:27:01,975 - INFO - Processed segments: 226
2025-11-12 23:27:01,975 - INFO - Average rate: 5.1 segments/second
2025-11-12 23:27:01,975 - INFO - ============================================================
✅ Fold 12 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 13/19
============================================================
2025-11-12 23:27:01,992 - INFO - ============================================================
2025-11-12 23:27:01,992 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:27:01,992 - INFO - ============================================================
2025-11-12 23:27:01,992 - INFO - Output prefix: chb15_fold13
2025-11-12 23:27:01,992 - INFO - EEG Preprocessor initialized
2025-11-12 23:27:01,992 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:27:01,992 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:27:01,992 - INFO - Segment duration: 5 seconds
2025-11-12 23:27:01,992 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:27:01,992 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:27:01,992 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:27:01,993 - INFO - Loading segments from chb15_fold13_sequences_prediction.json
2025-11-12 23:27:02,002 - INFO - Loaded 224 total sequences
2025-11-12 23:27:02,002 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:27:02,002 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:27:02,002 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:27:02,002 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:27:02,002 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:27:02,002 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-12 23:27:02,014 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:27:02,014 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:27:02,014 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:27:02,026 - INFO - ============================================================
2025-11-12 23:27:02,026 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:27:02,026 - INFO - ============================================================
2025-11-12 23:27:02,026 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:27:02,026 - INFO - Processing 184 sequences from 29 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<04:50,  1.59s/it]Processing training data:   7%|#############6                                                                                                                                                                                                    | 12/184 [00:03<00:38,  4.45it/s]Processing training data:  14%|############################5                                                                                                                                                                                     | 25/184 [00:03<00:17,  8.92it/s]Processing training data:  16%|##################################2                                                                                                                                                                               | 30/184 [00:05<00:25,  5.98it/s]Processing training data:  23%|#################################################                                                                                                                                                                 | 43/184 [00:06<00:18,  7.63it/s]Processing training data:  28%|###########################################################3                                                                                                                                                      | 52/184 [00:08<00:19,  6.68it/s]Processing training data:  34%|#######################################################################9                                                                                                                                          | 63/184 [00:08<00:13,  8.83it/s]Processing training data:  37%|#############################################################################6                                                                                                                                    | 68/184 [00:09<00:12,  9.10it/s]Processing training data:  39%|#################################################################################                                                                                                                                 | 71/184 [00:09<00:13,  8.19it/s]Processing training data:  43%|###########################################################################################3                                                                                                                      | 80/184 [00:10<00:10, 10.15it/s]Processing training data:  46%|###############################################################################################8                                                                                                                  | 84/184 [00:10<00:10,  9.80it/s]Processing training data:  48%|####################################################################################################4                                                                                                             | 88/184 [00:12<00:15,  6.09it/s]Processing training data:  55%|###################################################################################################################8                                                                                             | 102/184 [00:12<00:08,  9.98it/s]Processing training data:  57%|#######################################################################################################################2                                                                                         | 105/184 [00:14<00:12,  6.20it/s]Processing training data:  61%|################################################################################################################################3                                                                                | 113/184 [00:15<00:08,  7.94it/s]Processing training data:  63%|###################################################################################################################################7                                                                             | 116/184 [00:16<00:13,  5.23it/s]Processing training data:  80%|######################################################################################################################################################################9                                          | 147/184 [00:17<00:02, 15.08it/s]Processing training data:  82%|###########################################################################################################################################################################5                                     | 151/184 [00:17<00:02, 13.30it/s]Processing training data:  84%|##############################################################################################################################################################################9                                  | 154/184 [00:18<00:02, 11.11it/s]Processing training data:  85%|#################################################################################################################################################################################1                               | 156/184 [00:18<00:02,  9.87it/s]Processing training data:  86%|###################################################################################################################################################################################4                             | 158/184 [00:19<00:03,  8.05it/s]Processing training data:  87%|#####################################################################################################################################################################################7                           | 160/184 [00:19<00:03,  6.53it/s]Processing training data:  89%|#########################################################################################################################################################################################1                       | 163/184 [00:21<00:04,  4.79it/s]Processing training data:  92%|#################################################################################################################################################################################################                | 170/184 [00:21<00:01,  7.18it/s]Processing training data:  93%|###################################################################################################################################################################################################3             | 172/184 [00:21<00:01,  6.61it/s]Processing training data:  95%|#####################################################################################################################################################################################################6           | 174/184 [00:22<00:01,  5.61it/s]Processing training data:  98%|############################################################################################################################################################################################################4    | 180/184 [00:22<00:00,  7.60it/s]Processing training data:  99%|##############################################################################################################################################################################################################7  | 182/184 [00:23<00:00,  6.91it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  6.59it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.77it/s]
2025-11-12 23:27:25,707 - INFO - Computing normalization statistics from training data...
2025-11-12 23:27:25,992 - INFO - Normalization stats computed:
2025-11-12 23:27:25,992 - INFO -   Mean: -0.779370
2025-11-12 23:27:25,992 - INFO -   Std: 2.027603
2025-11-12 23:27:25,992 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold13\normalization_stats.json
2025-11-12 23:27:26,011 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:27:26,019 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold13\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:11, 15.70it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 16.11it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.30it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.17it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.29it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.32it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.32it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.39it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.38it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.44it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.39it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.22it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.25it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.37it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.44it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.48it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.48it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.64it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 16.75it/s]
2025-11-12 23:27:37,259 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:27:37,264 - INFO - Loaded normalization statistics:
2025-11-12 23:27:37,264 - INFO -   Mean: -0.779370
2025-11-12 23:27:37,264 - INFO -   Std: 2.027603
2025-11-12 23:27:37,264 - INFO - Split train already completed, skipping
2025-11-12 23:27:37,264 - INFO - Processing test split...
2025-11-12 23:27:37,264 - INFO - Need to process 40/40 sequences for test
2025-11-12 23:27:37,264 - INFO - Processing 40 sequences from 8 unique files
2025-11-12 23:27:37,265 - INFO - Average 5.0 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/40 [00:00<?, ?it/s]Processing test:   2%|#####5                                                                                                                                                                                                                       | 1/40 [00:01<00:46,  1.20s/it]Processing test:  12%|###########################6                                                                                                                                                                                                 | 5/40 [00:01<00:10,  3.23it/s]2025-11-12 23:27:39,081 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold13\test_dataset.h5
2025-11-12 23:27:40,486 - INFO - Progress: 208/224 (92.9%) - ETA: 0.0 minutes
Processing test:  62%|#########################################################################################################################################5                                                                                  | 25/40 [00:04<00:02,  6.58it/s]Processing test:  72%|###############################################################################################################################################################5                                                            | 29/40 [00:05<00:01,  5.96it/s]Processing test:  82%|#####################################################################################################################################################################################5                                      | 33/40 [00:06<00:01,  5.44it/s]2025-11-12 23:27:44,177 - INFO - Progress: 219/224 (97.8%) - ETA: 0.0 minutes
Processing test:  90%|######################################################################################################################################################################################################                      | 36/40 [00:07<00:00,  4.52it/s]Processing test:  95%|#################################################################################################################################################################################################################           | 38/40 [00:07<00:00,  4.68it/s]Processing test:  98%|######################################################################################################################################################################################################################5     | 39/40 [00:08<00:00,  4.27it/s]Processing test: 100%|############################################################################################################################################################################################################################| 40/40 [00:08<00:00,  4.92it/s]
2025-11-12 23:27:45,717 - INFO - Validating final datasets...
2025-11-12 23:27:45,724 - INFO - train dataset validation:
2025-11-12 23:27:45,724 - INFO -   - Segments: 184
2025-11-12 23:27:45,724 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:27:45,724 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:27:45,724 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:27:45,729 - INFO - test dataset validation:
2025-11-12 23:27:45,729 - INFO -   - Segments: 40
2025-11-12 23:27:45,729 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:27:45,729 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-12 23:27:45,729 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:27:45,729 - INFO - ============================================================
2025-11-12 23:27:45,729 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:27:45,729 - INFO - Total time: 0.7 minutes
2025-11-12 23:27:45,729 - INFO - Processed segments: 224
2025-11-12 23:27:45,729 - INFO - Average rate: 5.1 segments/second
2025-11-12 23:27:45,729 - INFO - ============================================================
✅ Fold 13 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 14/19
============================================================
2025-11-12 23:27:45,746 - INFO - ============================================================
2025-11-12 23:27:45,746 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:27:45,746 - INFO - ============================================================
2025-11-12 23:27:45,746 - INFO - Output prefix: chb15_fold14
2025-11-12 23:27:45,746 - INFO - EEG Preprocessor initialized
2025-11-12 23:27:45,746 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:27:45,746 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:27:45,747 - INFO - Segment duration: 5 seconds
2025-11-12 23:27:45,747 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:27:45,747 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:27:45,747 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:27:45,747 - INFO - Loading segments from chb15_fold14_sequences_prediction.json
2025-11-12 23:27:45,755 - INFO - Loaded 214 total sequences
2025-11-12 23:27:45,755 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:27:45,756 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:27:45,756 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:27:45,756 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:27:45,756 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:27:45,756 - INFO - test: 30 sequences (15 preictal, 15 interictal)
2025-11-12 23:27:45,767 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:27:45,767 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:27:45,767 - INFO - test: kept 15 preictal and 15 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:27:45,779 - INFO - ============================================================
2025-11-12 23:27:45,779 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:27:45,779 - INFO - ============================================================
2025-11-12 23:27:45,779 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:27:45,779 - INFO - Processing 184 sequences from 29 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:00<01:47,  1.70it/s]Processing training data:   5%|###########4                                                                                                                                                                                                      | 10/184 [00:01<00:16, 10.48it/s]Processing training data:   8%|#################1                                                                                                                                                                                                | 15/184 [00:02<00:30,  5.50it/s]Processing training data:  14%|#############################6                                                                                                                                                                                    | 26/184 [00:03<00:19,  8.28it/s]Processing training data:  16%|##################################2                                                                                                                                                                               | 30/184 [00:04<00:25,  6.02it/s]Processing training data:  22%|#############################################6                                                                                                                                                                    | 40/184 [00:05<00:16,  8.88it/s]Processing training data:  24%|##################################################2                                                                                                                                                               | 44/184 [00:06<00:23,  5.90it/s]Processing training data:  29%|#############################################################6                                                                                                                                                    | 54/184 [00:07<00:14,  8.89it/s]Processing training data:  30%|###############################################################9                                                                                                                                                  | 56/184 [00:08<00:23,  5.43it/s]Processing training data:  40%|###################################################################################3                                                                                                                              | 73/184 [00:10<00:14,  7.63it/s]Processing training data:  49%|######################################################################################################7                                                                                                           | 90/184 [00:11<00:10,  9.18it/s]Processing training data:  54%|################################################################################################################9                                                                                                 | 99/184 [00:12<00:08, 10.58it/s]Processing training data:  56%|####################################################################################################################9                                                                                            | 103/184 [00:12<00:07, 10.16it/s]Processing training data:  58%|########################################################################################################################4                                                                                        | 106/184 [00:13<00:08,  9.20it/s]Processing training data:  60%|##############################################################################################################################                                                                                   | 111/184 [00:13<00:07,  9.23it/s]Processing training data:  64%|####################################################################################################################################8                                                                            | 117/184 [00:15<00:10,  6.69it/s]Processing training data:  71%|###################################################################################################################################################6                                                             | 130/184 [00:15<00:05, 10.57it/s]Processing training data:  72%|#######################################################################################################################################################                                                          | 133/184 [00:16<00:06,  8.34it/s]Processing training data:  74%|##########################################################################################################################################################4                                                      | 136/184 [00:17<00:09,  5.33it/s]Processing training data:  80%|########################################################################################################################################################################1                                        | 148/184 [00:19<00:05,  6.91it/s]Processing training data:  86%|####################################################################################################################################################################################6                            | 159/184 [00:19<00:02,  9.28it/s]Processing training data:  91%|#############################################################################################################################################################################################6                   | 167/184 [00:20<00:01, 11.16it/s]Processing training data:  92%|###############################################################################################################################################################################################9                 | 169/184 [00:20<00:01,  9.32it/s]Processing training data:  93%|###################################################################################################################################################################################################3             | 172/184 [00:21<00:01,  8.21it/s]Processing training data:  96%|#########################################################################################################################################################################################################        | 177/184 [00:21<00:00,  9.34it/s]Processing training data:  97%|###########################################################################################################################################################################################################3     | 179/184 [00:22<00:00,  6.61it/s]Processing training data:  99%|##############################################################################################################################################################################################################7  | 182/184 [00:22<00:00,  6.42it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  6.28it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.91it/s]
2025-11-12 23:28:09,050 - INFO - Computing normalization statistics from training data...
2025-11-12 23:28:09,329 - INFO - Normalization stats computed:
2025-11-12 23:28:09,329 - INFO -   Mean: -0.776770
2025-11-12 23:28:09,329 - INFO -   Std: 1.997010
2025-11-12 23:28:09,329 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold14\normalization_stats.json
2025-11-12 23:28:09,347 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:28:09,356 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold14\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.69it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 16.17it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.32it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.45it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.51it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.59it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.60it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.41it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.16it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.33it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.47it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.53it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.61it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.75it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.87it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.97it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 17.00it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.96it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 17.00it/s]
2025-11-12 23:28:20,424 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:28:20,431 - INFO - Loaded normalization statistics:
2025-11-12 23:28:20,431 - INFO -   Mean: -0.776770
2025-11-12 23:28:20,431 - INFO -   Std: 1.997010
2025-11-12 23:28:20,431 - INFO - Split train already completed, skipping
2025-11-12 23:28:20,431 - INFO - Processing test split...
2025-11-12 23:28:20,431 - INFO - Need to process 30/30 sequences for test
2025-11-12 23:28:20,431 - INFO - Processing 30 sequences from 11 unique files
2025-11-12 23:28:20,431 - INFO - Average 2.7 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/30 [00:00<?, ?it/s]Processing test:   3%|#######3                                                                                                                                                                                                                     | 1/30 [00:00<00:07,  3.63it/s]Processing test:   7%|##############7                                                                                                                                                                                                              | 2/30 [00:00<00:10,  2.65it/s]2025-11-12 23:28:21,157 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold14\test_dataset.h5
2025-11-12 23:28:21,801 - INFO - Progress: 195/214 (91.1%) - ETA: 0.1 minutes
Processing test:  40%|########################################################################################                                                                                                                                    | 12/30 [00:02<00:03,  4.64it/s]Processing test:  53%|#####################################################################################################################3                                                                                                      | 16/30 [00:03<00:02,  5.65it/s]Processing test:  70%|##########################################################################################################################################################                                                                  | 21/30 [00:03<00:01,  6.14it/s]2025-11-12 23:28:24,846 - INFO - Progress: 206/214 (96.3%) - ETA: 0.0 minutes
Processing test:  77%|########################################################################################################################################################################6                                                   | 23/30 [00:04<00:01,  4.53it/s]Processing test:  80%|################################################################################################################################################################################                                            | 24/30 [00:05<00:01,  3.73it/s]Processing test:  87%|##############################################################################################################################################################################################6                             | 26/30 [00:05<00:00,  4.03it/s]Processing test:  90%|######################################################################################################################################################################################################                      | 27/30 [00:06<00:00,  3.83it/s]Processing test:  93%|#############################################################################################################################################################################################################3              | 28/30 [00:06<00:00,  2.91it/s]Processing test: 100%|############################################################################################################################################################################################################################| 30/30 [00:07<00:00,  3.48it/s]Processing test: 100%|############################################################################################################################################################################################################################| 30/30 [00:07<00:00,  4.16it/s]
2025-11-12 23:28:28,104 - INFO - Validating final datasets...
2025-11-12 23:28:28,112 - INFO - train dataset validation:
2025-11-12 23:28:28,112 - INFO -   - Segments: 184
2025-11-12 23:28:28,112 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:28:28,112 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:28:28,112 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:28:28,117 - INFO - test dataset validation:
2025-11-12 23:28:28,117 - INFO -   - Segments: 30
2025-11-12 23:28:28,117 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:28:28,117 - INFO -   - Classes: 15 preictal, 15 interictal
2025-11-12 23:28:28,117 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:28:28,117 - INFO - ============================================================
2025-11-12 23:28:28,117 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:28:28,117 - INFO - Total time: 0.7 minutes
2025-11-12 23:28:28,117 - INFO - Processed segments: 214
2025-11-12 23:28:28,117 - INFO - Average rate: 5.1 segments/second
2025-11-12 23:28:28,117 - INFO - ============================================================
✅ Fold 14 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 15/19
============================================================
2025-11-12 23:28:28,135 - INFO - ============================================================
2025-11-12 23:28:28,135 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:28:28,135 - INFO - ============================================================
2025-11-12 23:28:28,135 - INFO - Output prefix: chb15_fold15
2025-11-12 23:28:28,135 - INFO - EEG Preprocessor initialized
2025-11-12 23:28:28,135 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:28:28,135 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:28:28,135 - INFO - Segment duration: 5 seconds
2025-11-12 23:28:28,135 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:28:28,135 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:28:28,135 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:28:28,135 - INFO - Loading segments from chb15_fold15_sequences_prediction.json
2025-11-12 23:28:28,145 - INFO - Loaded 230 total sequences
2025-11-12 23:28:28,145 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:28:28,145 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:28:28,145 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:28:28,145 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:28:28,145 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:28:28,145 - INFO - test: 46 sequences (23 preictal, 23 interictal)
2025-11-12 23:28:28,159 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:28:28,159 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:28:28,159 - INFO - test: kept 23 preictal and 23 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:28:28,177 - INFO - ============================================================
2025-11-12 23:28:28,177 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:28:28,177 - INFO - ============================================================
2025-11-12 23:28:28,177 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:28:28,178 - INFO - Processing 184 sequences from 28 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:00<02:30,  1.22it/s]Processing training data:   4%|########                                                                                                                                                                                                           | 7/184 [00:02<00:58,  3.04it/s]Processing training data:  13%|###########################3                                                                                                                                                                                      | 24/184 [00:04<00:23,  6.79it/s]Processing training data:  20%|#########################################                                                                                                                                                                         | 36/184 [00:05<00:20,  7.19it/s]Processing training data:  31%|#################################################################                                                                                                                                                 | 57/184 [00:06<00:09, 12.91it/s]Processing training data:  33%|#####################################################################6                                                                                                                                            | 61/184 [00:07<00:11, 10.33it/s]Processing training data:  38%|##############################################################################7                                                                                                                                   | 69/184 [00:07<00:09, 11.64it/s]Processing training data:  40%|###################################################################################3                                                                                                                              | 73/184 [00:09<00:14,  7.48it/s]Processing training data:  45%|##############################################################################################7                                                                                                                   | 83/184 [00:09<00:10,  9.66it/s]Processing training data:  49%|######################################################################################################7                                                                                                           | 90/184 [00:09<00:08, 10.68it/s]Processing training data:  52%|############################################################################################################4                                                                                                     | 95/184 [00:11<00:10,  8.17it/s]Processing training data:  55%|###################################################################################################################8                                                                                             | 102/184 [00:12<00:12,  6.54it/s]Processing training data:  64%|####################################################################################################################################8                                                                            | 117/184 [00:14<00:08,  7.69it/s]Processing training data:  71%|###################################################################################################################################################6                                                             | 130/184 [00:14<00:05, 10.30it/s]Processing training data:  73%|#########################################################################################################################################################3                                                       | 135/184 [00:16<00:06,  7.48it/s]Processing training data:  79%|#####################################################################################################################################################################8                                           | 146/184 [00:16<00:03,  9.81it/s]Processing training data:  80%|########################################################################################################################################################################1                                        | 148/184 [00:17<00:04,  7.66it/s]Processing training data:  82%|###########################################################################################################################################################################5                                     | 151/184 [00:18<00:04,  7.10it/s]Processing training data:  85%|##################################################################################################################################################################################3                              | 157/184 [00:18<00:03,  8.39it/s]Processing training data:  86%|####################################################################################################################################################################################6                            | 159/184 [00:19<00:03,  7.26it/s]Processing training data:  89%|##########################################################################################################################################################################################2                      | 164/184 [00:19<00:02,  7.80it/s]Processing training data:  91%|##############################################################################################################################################################################################8                  | 168/184 [00:21<00:03,  5.19it/s]Processing training data:  93%|###################################################################################################################################################################################################3             | 172/184 [00:21<00:02,  5.49it/s]Processing training data:  95%|#####################################################################################################################################################################################################6           | 174/184 [00:22<00:01,  5.10it/s]Processing training data:  97%|###########################################################################################################################################################################################################3     | 179/184 [00:22<00:00,  6.44it/s]Processing training data:  99%|##############################################################################################################################################################################################################7  | 182/184 [00:23<00:00,  6.86it/s]Processing training data:  99%|###############################################################################################################################################################################################################8 | 183/184 [00:23<00:00,  5.99it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  5.22it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.68it/s]
2025-11-12 23:28:52,141 - INFO - Computing normalization statistics from training data...
2025-11-12 23:28:52,406 - INFO - Normalization stats computed:
2025-11-12 23:28:52,406 - INFO -   Mean: -0.739364
2025-11-12 23:28:52,406 - INFO -   Std: 2.005452
2025-11-12 23:28:52,406 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold15\normalization_stats.json
2025-11-12 23:28:52,425 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:28:52,433 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold15\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.93it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:09, 16.46it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.37it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.31it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.36it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.43it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.47it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.49it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.52it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.52it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.53it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.53it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.53it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.56it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.65it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.77it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.75it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.74it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 16.93it/s]
2025-11-12 23:29:03,550 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:29:03,557 - INFO - Loaded normalization statistics:
2025-11-12 23:29:03,557 - INFO -   Mean: -0.739364
2025-11-12 23:29:03,557 - INFO -   Std: 2.005452
2025-11-12 23:29:03,557 - INFO - Split train already completed, skipping
2025-11-12 23:29:03,557 - INFO - Processing test split...
2025-11-12 23:29:03,557 - INFO - Need to process 46/46 sequences for test
2025-11-12 23:29:03,557 - INFO - Processing 46 sequences from 13 unique files
2025-11-12 23:29:03,557 - INFO - Average 3.5 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/46 [00:00<?, ?it/s]Processing test:   2%|####8                                                                                                                                                                                                                        | 1/46 [00:00<00:14,  3.03it/s]Processing test:   4%|#########6                                                                                                                                                                                                                   | 2/46 [00:00<00:22,  1.96it/s]2025-11-12 23:29:04,525 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold15\test_dataset.h5
2025-11-12 23:29:05,858 - INFO - Progress: 208/230 (90.4%) - ETA: 0.1 minutes
Processing test:  54%|#######################################################################################################################5                                                                                                    | 25/46 [00:03<00:02,  8.00it/s]Processing test:  61%|#####################################################################################################################################9                                                                                      | 28/46 [00:04<00:02,  6.45it/s]Processing test:  67%|####################################################################################################################################################2                                                                       | 31/46 [00:04<00:02,  6.74it/s]Processing test:  70%|#########################################################################################################################################################                                                                   | 32/46 [00:05<00:02,  5.54it/s]2025-11-12 23:29:09,424 - INFO - Progress: 218/230 (94.8%) - ETA: 0.0 minutes
Processing test:  76%|#######################################################################################################################################################################3                                                    | 35/46 [00:06<00:02,  4.26it/s]Processing test:  80%|################################################################################################################################################################################9                                           | 37/46 [00:06<00:02,  4.48it/s]Processing test:  83%|#####################################################################################################################################################################################7                                      | 38/46 [00:07<00:01,  4.21it/s]Processing test:  85%|##########################################################################################################################################################################################5                                 | 39/46 [00:07<00:02,  3.11it/s]Processing test:  89%|####################################################################################################################################################################################################                        | 41/46 [00:09<00:02,  2.44it/s]Processing test:  96%|##################################################################################################################################################################################################################4         | 44/46 [00:10<00:00,  2.67it/s]2025-11-12 23:29:14,361 - INFO - Progress: 229/230 (99.6%) - ETA: 0.0 minutes
Processing test: 100%|############################################################################################################################################################################################################################| 46/46 [00:11<00:00,  2.47it/s]Processing test: 100%|############################################################################################################################################################################################################################| 46/46 [00:11<00:00,  4.13it/s]
2025-11-12 23:29:14,778 - INFO - Validating final datasets...
2025-11-12 23:29:14,786 - INFO - train dataset validation:
2025-11-12 23:29:14,786 - INFO -   - Segments: 184
2025-11-12 23:29:14,786 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:29:14,786 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:29:14,786 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:29:14,791 - INFO - test dataset validation:
2025-11-12 23:29:14,791 - INFO -   - Segments: 46
2025-11-12 23:29:14,791 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:29:14,791 - INFO -   - Classes: 23 preictal, 23 interictal
2025-11-12 23:29:14,791 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:29:14,791 - INFO - ============================================================
2025-11-12 23:29:14,791 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:29:14,791 - INFO - Total time: 0.8 minutes
2025-11-12 23:29:14,791 - INFO - Processed segments: 230
2025-11-12 23:29:14,791 - INFO - Average rate: 4.9 segments/second
2025-11-12 23:29:14,791 - INFO - ============================================================
✅ Fold 15 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 16/19
============================================================
2025-11-12 23:29:14,808 - INFO - ============================================================
2025-11-12 23:29:14,808 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:29:14,808 - INFO - ============================================================
2025-11-12 23:29:14,808 - INFO - Output prefix: chb15_fold16
2025-11-12 23:29:14,808 - INFO - EEG Preprocessor initialized
2025-11-12 23:29:14,808 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:29:14,808 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:29:14,808 - INFO - Segment duration: 5 seconds
2025-11-12 23:29:14,808 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:29:14,808 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:29:14,808 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:29:14,808 - INFO - Loading segments from chb15_fold16_sequences_prediction.json
2025-11-12 23:29:14,818 - INFO - Loaded 226 total sequences
2025-11-12 23:29:14,818 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:29:14,818 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:29:14,818 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:29:14,818 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:29:14,818 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:29:14,818 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-12 23:29:14,830 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:29:14,830 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:29:14,830 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:29:14,842 - INFO - ============================================================
2025-11-12 23:29:14,842 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:29:14,842 - INFO - ============================================================
2025-11-12 23:29:14,842 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:29:14,842 - INFO - Processing 184 sequences from 29 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:00<01:46,  1.72it/s]Processing training data:   3%|######8                                                                                                                                                                                                            | 6/184 [00:02<01:03,  2.79it/s]Processing training data:  10%|#####################6                                                                                                                                                                                            | 19/184 [00:03<00:29,  5.59it/s]Processing training data:  16%|##################################2                                                                                                                                                                               | 30/184 [00:04<00:19,  7.73it/s]Processing training data:  20%|#########################################                                                                                                                                                                         | 36/184 [00:06<00:24,  6.00it/s]Processing training data:  26%|#####################################################6                                                                                                                                                            | 47/184 [00:07<00:19,  6.90it/s]Processing training data:  29%|#############################################################6                                                                                                                                                    | 54/184 [00:08<00:16,  7.82it/s]Processing training data:  31%|#################################################################                                                                                                                                                 | 57/184 [00:08<00:16,  7.65it/s]Processing training data:  33%|####################################################################4                                                                                                                                             | 60/184 [00:10<00:25,  4.89it/s]Processing training data:  39%|##################################################################################1                                                                                                                               | 72/184 [00:11<00:18,  5.92it/s]Processing training data:  49%|######################################################################################################7                                                                                                           | 90/184 [00:13<00:12,  7.78it/s]Processing training data:  53%|##############################################################################################################7                                                                                                   | 97/184 [00:13<00:09,  8.71it/s]Processing training data:  56%|####################################################################################################################9                                                                                            | 103/184 [00:15<00:11,  7.01it/s]Processing training data:  64%|####################################################################################################################################8                                                                            | 117/184 [00:16<00:07,  8.54it/s]Processing training data:  68%|#############################################################################################################################################9                                                                   | 125/184 [00:17<00:07,  8.10it/s]Processing training data:  73%|########################################################################################################################################################2                                                        | 134/184 [00:18<00:04, 10.09it/s]Processing training data:  74%|##########################################################################################################################################################4                                                      | 136/184 [00:18<00:05,  8.65it/s]Processing training data:  77%|#################################################################################################################################################################2                                               | 142/184 [00:19<00:04,  9.60it/s]Processing training data:  79%|#####################################################################################################################################################################8                                           | 146/184 [00:19<00:03,  9.68it/s]Processing training data:  80%|########################################################################################################################################################################1                                        | 148/184 [00:20<00:05,  7.10it/s]Processing training data:  83%|#############################################################################################################################################################################7                                   | 153/184 [00:20<00:04,  7.55it/s]Processing training data:  85%|##################################################################################################################################################################################3                              | 157/184 [00:21<00:03,  7.62it/s]Processing training data:  88%|######################################################################################################################################################################################8                          | 161/184 [00:21<00:03,  7.37it/s]Processing training data:  92%|###############################################################################################################################################################################################9                 | 169/184 [00:22<00:01, 10.07it/s]Processing training data:  93%|##################################################################################################################################################################################################2              | 171/184 [00:22<00:01,  8.22it/s]Processing training data:  96%|#######################################################################################################################################################################################################9         | 176/184 [00:23<00:00,  9.11it/s]Processing training data:  97%|##########################################################################################################################################################################################################1      | 178/184 [00:23<00:00,  7.57it/s]Processing training data:  99%|##############################################################################################################################################################################################################7  | 182/184 [00:24<00:00,  8.39it/s]Processing training data:  99%|###############################################################################################################################################################################################################8 | 183/184 [00:24<00:00,  6.48it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:24<00:00,  7.47it/s]
2025-11-12 23:29:39,466 - INFO - Computing normalization statistics from training data...
2025-11-12 23:29:39,744 - INFO - Normalization stats computed:
2025-11-12 23:29:39,745 - INFO -   Mean: -0.746077
2025-11-12 23:29:39,745 - INFO -   Std: 2.004109
2025-11-12 23:29:39,745 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold16\normalization_stats.json
2025-11-12 23:29:39,763 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:29:39,771 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold16\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.69it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:09, 16.80it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.81it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.83it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:02<00:07, 16.85it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.77it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.72it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.56it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.66it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:05<00:05, 16.74it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.78it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.66it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.52it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.53it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:08<00:02, 16.64it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.75it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.87it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.98it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 17.13it/s]
2025-11-12 23:29:50,763 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:29:50,770 - INFO - Loaded normalization statistics:
2025-11-12 23:29:50,770 - INFO -   Mean: -0.746077
2025-11-12 23:29:50,770 - INFO -   Std: 2.004109
2025-11-12 23:29:50,770 - INFO - Split train already completed, skipping
2025-11-12 23:29:50,770 - INFO - Processing test split...
2025-11-12 23:29:50,770 - INFO - Need to process 42/42 sequences for test
2025-11-12 23:29:50,770 - INFO - Processing 42 sequences from 10 unique files
2025-11-12 23:29:50,770 - INFO - Average 4.2 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/42 [00:00<?, ?it/s]Processing test:   2%|#####2                                                                                                                                                                                                                       | 1/42 [00:00<00:24,  1.70it/s]Processing test:   7%|###############7                                                                                                                                                                                                             | 3/42 [00:01<00:14,  2.64it/s]2025-11-12 23:29:51,970 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold16\test_dataset.h5
2025-11-12 23:29:53,308 - INFO - Progress: 207/226 (91.6%) - ETA: 0.1 minutes
Processing test:  57%|#############################################################################################################################7                                                                                              | 24/42 [00:03<00:02,  7.21it/s]Processing test:  69%|#######################################################################################################################################################9                                                                    | 29/42 [00:04<00:02,  6.43it/s]Processing test:  76%|#######################################################################################################################################################################6                                                    | 32/42 [00:05<00:01,  5.44it/s]2025-11-12 23:29:57,023 - INFO - Progress: 217/226 (96.0%) - ETA: 0.0 minutes
Processing test:  81%|##################################################################################################################################################################################                                          | 34/42 [00:06<00:01,  4.01it/s]Processing test:  88%|#################################################################################################################################################################################################8                          | 37/42 [00:07<00:01,  4.59it/s]Processing test:  90%|#######################################################################################################################################################################################################                     | 38/42 [00:08<00:01,  3.79it/s]Processing test:  98%|######################################################################################################################################################################################################################7     | 41/42 [00:08<00:00,  4.55it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:08<00:00,  4.23it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:08<00:00,  4.82it/s]
2025-11-12 23:30:00,024 - INFO - Validating final datasets...
2025-11-12 23:30:00,032 - INFO - train dataset validation:
2025-11-12 23:30:00,032 - INFO -   - Segments: 184
2025-11-12 23:30:00,032 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:30:00,032 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:30:00,032 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:30:00,036 - INFO - test dataset validation:
2025-11-12 23:30:00,036 - INFO -   - Segments: 42
2025-11-12 23:30:00,036 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:30:00,036 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-12 23:30:00,036 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:30:00,037 - INFO - ============================================================
2025-11-12 23:30:00,037 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:30:00,037 - INFO - Total time: 0.8 minutes
2025-11-12 23:30:00,037 - INFO - Processed segments: 226
2025-11-12 23:30:00,037 - INFO - Average rate: 5.0 segments/second
2025-11-12 23:30:00,037 - INFO - ============================================================
✅ Fold 16 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 17/19
============================================================
2025-11-12 23:30:00,054 - INFO - ============================================================
2025-11-12 23:30:00,054 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:30:00,054 - INFO - ============================================================
2025-11-12 23:30:00,054 - INFO - Output prefix: chb15_fold17
2025-11-12 23:30:00,054 - INFO - EEG Preprocessor initialized
2025-11-12 23:30:00,054 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:30:00,054 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:30:00,054 - INFO - Segment duration: 5 seconds
2025-11-12 23:30:00,054 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:30:00,054 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:30:00,054 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:30:00,054 - INFO - Loading segments from chb15_fold17_sequences_prediction.json
2025-11-12 23:30:00,064 - INFO - Loaded 226 total sequences
2025-11-12 23:30:00,064 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:30:00,064 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:30:00,064 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:30:00,064 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:30:00,064 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:30:00,064 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-12 23:30:00,076 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:30:00,076 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:30:00,076 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:30:00,088 - INFO - ============================================================
2025-11-12 23:30:00,088 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:30:00,088 - INFO - ============================================================
2025-11-12 23:30:00,088 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:30:00,088 - INFO - Processing 184 sequences from 29 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<03:42,  1.22s/it]Processing training data:   7%|##############8                                                                                                                                                                                                   | 13/184 [00:02<00:23,  7.25it/s]Processing training data:  11%|######################8                                                                                                                                                                                           | 20/184 [00:02<00:18,  8.81it/s]Processing training data:  15%|###############################9                                                                                                                                                                                  | 28/184 [00:04<00:23,  6.73it/s]Processing training data:  21%|############################################5                                                                                                                                                                     | 39/184 [00:05<00:20,  6.92it/s]Processing training data:  27%|#########################################################                                                                                                                                                         | 50/184 [00:07<00:18,  7.10it/s]Processing training data:  33%|####################################################################4                                                                                                                                             | 60/184 [00:08<00:18,  6.81it/s]Processing training data:  38%|###############################################################################8                                                                                                                                  | 70/184 [00:09<00:13,  8.56it/s]Processing training data:  41%|######################################################################################7                                                                                                                           | 76/184 [00:10<00:12,  8.88it/s]Processing training data:  44%|############################################################################################4                                                                                                                     | 81/184 [00:11<00:14,  7.25it/s]Processing training data:  48%|####################################################################################################4                                                                                                             | 88/184 [00:12<00:15,  6.27it/s]Processing training data:  53%|###############################################################################################################8                                                                                                  | 98/184 [00:13<00:10,  8.17it/s]Processing training data:  55%|##################################################################################################################7                                                                                              | 101/184 [00:14<00:14,  5.79it/s]Processing training data:  62%|##################################################################################################################################6                                                                              | 115/184 [00:15<00:07,  9.19it/s]Processing training data:  64%|######################################################################################################################################                                                                           | 118/184 [00:15<00:07,  8.50it/s]Processing training data:  67%|###########################################################################################################################################7                                                                     | 123/184 [00:16<00:07,  7.67it/s]Processing training data:  70%|##################################################################################################################################################5                                                              | 129/184 [00:18<00:09,  6.01it/s]Processing training data:  73%|#########################################################################################################################################################3                                                       | 135/184 [00:18<00:07,  6.82it/s]Processing training data:  77%|#################################################################################################################################################################2                                               | 142/184 [00:20<00:07,  5.87it/s]Processing training data:  85%|#################################################################################################################################################################################1                               | 156/184 [00:20<00:03,  9.20it/s]Processing training data:  88%|######################################################################################################################################################################################8                          | 161/184 [00:21<00:02,  9.61it/s]Processing training data:  89%|#########################################################################################################################################################################################1                       | 163/184 [00:21<00:02,  8.87it/s]Processing training data:  90%|###########################################################################################################################################################################################4                     | 165/184 [00:22<00:02,  7.41it/s]Processing training data:  94%|####################################################################################################################################################################################################5            | 173/184 [00:22<00:01,  9.78it/s]Processing training data:  96%|#########################################################################################################################################################################################################        | 177/184 [00:23<00:00,  8.90it/s]Processing training data:  98%|#############################################################################################################################################################################################################5   | 181/184 [00:23<00:00,  9.36it/s]Processing training data:  99%|###############################################################################################################################################################################################################8 | 183/184 [00:24<00:00,  6.87it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:24<00:00,  6.00it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:24<00:00,  7.42it/s]
2025-11-12 23:30:24,899 - INFO - Computing normalization statistics from training data...
2025-11-12 23:30:25,175 - INFO - Normalization stats computed:
2025-11-12 23:30:25,175 - INFO -   Mean: -0.720012
2025-11-12 23:30:25,175 - INFO -   Std: 2.001756
2025-11-12 23:30:25,175 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold17\normalization_stats.json
2025-11-12 23:30:25,202 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:30:25,213 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold17\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.75it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 16.22it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.39it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.37it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.43it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.48it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.41it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.28it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.28it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.34it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.41it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.41it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.35it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.30it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.26it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.28it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.17it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:11<00:00, 16.22it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:11<00:00, 16.68it/s]
2025-11-12 23:30:36,507 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:30:36,513 - INFO - Loaded normalization statistics:
2025-11-12 23:30:36,514 - INFO -   Mean: -0.720012
2025-11-12 23:30:36,514 - INFO -   Std: 2.001756
2025-11-12 23:30:36,514 - INFO - Split train already completed, skipping
2025-11-12 23:30:36,514 - INFO - Processing test split...
2025-11-12 23:30:36,514 - INFO - Need to process 42/42 sequences for test
2025-11-12 23:30:36,514 - INFO - Processing 42 sequences from 10 unique files
2025-11-12 23:30:36,514 - INFO - Average 4.2 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/42 [00:00<?, ?it/s]Processing test:   2%|#####2                                                                                                                                                                                                                       | 1/42 [00:00<00:24,  1.65it/s]2025-11-12 23:30:37,122 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold17\test_dataset.h5
2025-11-12 23:30:38,331 - INFO - Progress: 205/226 (90.7%) - ETA: 0.1 minutes
Processing test:  52%|###################################################################################################################2                                                                                                        | 22/42 [00:03<00:02,  7.48it/s]Processing test:  64%|#############################################################################################################################################4                                                                              | 27/42 [00:03<00:01,  7.79it/s]Processing test:  69%|#######################################################################################################################################################9                                                                    | 29/42 [00:04<00:02,  5.82it/s]Processing test:  74%|##################################################################################################################################################################3                                                         | 31/42 [00:05<00:02,  4.04it/s]2025-11-12 23:30:43,224 - INFO - Progress: 218/226 (96.5%) - ETA: 0.0 minutes
Processing test:  83%|#######################################################################################################################################################################################3                                    | 35/42 [00:07<00:01,  3.91it/s]Processing test:  86%|############################################################################################################################################################################################5                               | 36/42 [00:07<00:01,  3.81it/s]Processing test:  88%|#################################################################################################################################################################################################8                          | 37/42 [00:07<00:01,  3.33it/s]Processing test:  95%|#################################################################################################################################################################################################################5          | 40/42 [00:08<00:00,  3.83it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:08<00:00,  4.13it/s]Processing test: 100%|############################################################################################################################################################################################################################| 42/42 [00:08<00:00,  4.73it/s]
2025-11-12 23:30:45,865 - INFO - Validating final datasets...
2025-11-12 23:30:45,873 - INFO - train dataset validation:
2025-11-12 23:30:45,873 - INFO -   - Segments: 184
2025-11-12 23:30:45,873 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:30:45,873 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:30:45,874 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:30:45,879 - INFO - test dataset validation:
2025-11-12 23:30:45,879 - INFO -   - Segments: 42
2025-11-12 23:30:45,879 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:30:45,879 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-12 23:30:45,879 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:30:45,879 - INFO - ============================================================
2025-11-12 23:30:45,879 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:30:45,879 - INFO - Total time: 0.8 minutes
2025-11-12 23:30:45,879 - INFO - Processed segments: 226
2025-11-12 23:30:45,879 - INFO - Average rate: 4.9 segments/second
2025-11-12 23:30:45,879 - INFO - ============================================================
✅ Fold 17 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 18/19
============================================================
2025-11-12 23:30:45,904 - INFO - ============================================================
2025-11-12 23:30:45,904 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:30:45,904 - INFO - ============================================================
2025-11-12 23:30:45,904 - INFO - Output prefix: chb15_fold18
2025-11-12 23:30:45,904 - INFO - EEG Preprocessor initialized
2025-11-12 23:30:45,904 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:30:45,904 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:30:45,904 - INFO - Segment duration: 5 seconds
2025-11-12 23:30:45,904 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:30:45,904 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:30:45,904 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:30:45,904 - INFO - Loading segments from chb15_fold18_sequences_prediction.json
2025-11-12 23:30:45,914 - INFO - Loaded 224 total sequences
2025-11-12 23:30:45,914 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:30:45,915 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:30:45,915 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:30:45,915 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:30:45,915 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:30:45,915 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-12 23:30:45,926 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:30:45,927 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:30:45,927 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:30:45,939 - INFO - ============================================================
2025-11-12 23:30:45,939 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:30:45,940 - INFO - ============================================================
2025-11-12 23:30:45,940 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:30:45,940 - INFO - Processing 184 sequences from 28 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:00<01:41,  1.80it/s]Processing training data:   4%|#########1                                                                                                                                                                                                         | 8/184 [00:02<00:44,  3.98it/s]Processing training data:  14%|#############################6                                                                                                                                                                                    | 26/184 [00:02<00:11, 13.83it/s]Processing training data:  16%|#################################                                                                                                                                                                                 | 29/184 [00:03<00:21,  7.23it/s]Processing training data:  21%|###########################################3                                                                                                                                                                      | 38/184 [00:05<00:22,  6.57it/s]Processing training data:  27%|#########################################################                                                                                                                                                         | 50/184 [00:07<00:19,  6.97it/s]Processing training data:  33%|####################################################################4                                                                                                                                             | 60/184 [00:07<00:14,  8.36it/s]Processing training data:  35%|#########################################################################                                                                                                                                         | 64/184 [00:09<00:20,  5.97it/s]Processing training data:  42%|#########################################################################################                                                                                                                         | 78/184 [00:09<00:11,  9.51it/s]Processing training data:  43%|###########################################################################################3                                                                                                                      | 80/184 [00:11<00:17,  6.01it/s]Processing training data:  49%|#######################################################################################################8                                                                                                          | 91/184 [00:12<00:13,  6.99it/s]Processing training data:  57%|#######################################################################################################################2                                                                                         | 105/184 [00:13<00:09,  8.51it/s]Processing training data:  62%|##################################################################################################################################6                                                                              | 115/184 [00:14<00:06, 10.08it/s]Processing training data:  66%|##########################################################################################################################################5                                                                      | 122/184 [00:14<00:05, 10.85it/s]Processing training data:  68%|###############################################################################################################################################1                                                                 | 126/184 [00:15<00:05,  9.78it/s]Processing training data:  72%|#######################################################################################################################################################                                                          | 133/184 [00:16<00:06,  8.37it/s]Processing training data:  77%|#################################################################################################################################################################2                                               | 142/184 [00:18<00:05,  7.18it/s]Processing training data:  80%|######################################################################################################################################################################9                                          | 147/184 [00:18<00:04,  7.54it/s]Processing training data:  83%|#############################################################################################################################################################################7                                   | 153/184 [00:19<00:03,  8.13it/s]Processing training data:  85%|##################################################################################################################################################################################3                              | 157/184 [00:19<00:03,  8.21it/s]Processing training data:  86%|####################################################################################################################################################################################6                            | 159/184 [00:20<00:03,  6.94it/s]Processing training data:  90%|############################################################################################################################################################################################5                    | 166/184 [00:20<00:02,  8.76it/s]Processing training data:  92%|###############################################################################################################################################################################################9                 | 169/184 [00:21<00:01,  8.14it/s]Processing training data:  95%|#####################################################################################################################################################################################################6           | 174/184 [00:21<00:01,  8.81it/s]Processing training data:  96%|#######################################################################################################################################################################################################9         | 176/184 [00:22<00:01,  6.21it/s]Processing training data:  98%|############################################################################################################################################################################################################4    | 180/184 [00:23<00:00,  7.10it/s]Processing training data:  99%|##############################################################################################################################################################################################################7  | 182/184 [00:23<00:00,  6.71it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  6.47it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.72it/s]
2025-11-12 23:31:09,765 - INFO - Computing normalization statistics from training data...
2025-11-12 23:31:10,033 - INFO - Normalization stats computed:
2025-11-12 23:31:10,033 - INFO -   Mean: -0.743425
2025-11-12 23:31:10,034 - INFO -   Std: 1.995163
2025-11-12 23:31:10,034 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold18\normalization_stats.json
2025-11-12 23:31:10,052 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:31:10,060 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold18\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.18it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:10, 16.29it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.43it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.48it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.48it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.50it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.55it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.58it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.56it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.58it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.58it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.57it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.59it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.75it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.89it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 17.00it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 17.03it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 17.09it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 17.08it/s]
2025-11-12 23:31:21,082 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:31:21,088 - INFO - Loaded normalization statistics:
2025-11-12 23:31:21,088 - INFO -   Mean: -0.743425
2025-11-12 23:31:21,088 - INFO -   Std: 1.995163
2025-11-12 23:31:21,088 - INFO - Split train already completed, skipping
2025-11-12 23:31:21,088 - INFO - Processing test split...
2025-11-12 23:31:21,089 - INFO - Need to process 40/40 sequences for test
2025-11-12 23:31:21,089 - INFO - Processing 40 sequences from 9 unique files
2025-11-12 23:31:21,089 - INFO - Average 4.4 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/40 [00:00<?, ?it/s]Processing test:   2%|#####5                                                                                                                                                                                                                       | 1/40 [00:00<00:22,  1.74it/s]2025-11-12 23:31:21,665 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold18\test_dataset.h5
2025-11-12 23:31:22,796 - INFO - Progress: 204/224 (91.1%) - ETA: 0.1 minutes
Processing test:  52%|###################################################################################################################5                                                                                                        | 21/40 [00:02<00:02,  7.71it/s]Processing test:  65%|###############################################################################################################################################                                                                             | 26/40 [00:03<00:01,  7.74it/s]Processing test:  70%|##########################################################################################################################################################                                                                  | 28/40 [00:04<00:01,  6.30it/s]2025-11-12 23:31:25,963 - INFO - Progress: 215/224 (96.0%) - ETA: 0.0 minutes
Processing test:  80%|################################################################################################################################################################################                                            | 32/40 [00:06<00:02,  3.89it/s]Processing test:  90%|######################################################################################################################################################################################################                      | 36/40 [00:06<00:00,  4.77it/s]Processing test:  92%|###########################################################################################################################################################################################################5                | 37/40 [00:07<00:00,  4.52it/s]Processing test:  95%|#################################################################################################################################################################################################################           | 38/40 [00:07<00:00,  4.22it/s]Processing test:  98%|######################################################################################################################################################################################################################5     | 39/40 [00:08<00:00,  3.04it/s]Processing test: 100%|############################################################################################################################################################################################################################| 40/40 [00:08<00:00,  4.85it/s]
2025-11-12 23:31:29,872 - INFO - Validating final datasets...
2025-11-12 23:31:29,880 - INFO - train dataset validation:
2025-11-12 23:31:29,880 - INFO -   - Segments: 184
2025-11-12 23:31:29,880 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:31:29,880 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:31:29,880 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:31:29,885 - INFO - test dataset validation:
2025-11-12 23:31:29,885 - INFO -   - Segments: 40
2025-11-12 23:31:29,885 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:31:29,885 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-12 23:31:29,885 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:31:29,885 - INFO - ============================================================
2025-11-12 23:31:29,886 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:31:29,886 - INFO - Total time: 0.7 minutes
2025-11-12 23:31:29,886 - INFO - Processed segments: 224
2025-11-12 23:31:29,886 - INFO - Average rate: 5.1 segments/second
2025-11-12 23:31:29,886 - INFO - ============================================================
✅ Fold 18 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 19/19
============================================================
2025-11-12 23:31:29,904 - INFO - ============================================================
2025-11-12 23:31:29,904 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-12 23:31:29,904 - INFO - ============================================================
2025-11-12 23:31:29,904 - INFO - Output prefix: chb15_fold19
2025-11-12 23:31:29,904 - INFO - EEG Preprocessor initialized
2025-11-12 23:31:29,904 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-12 23:31:29,904 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-12 23:31:29,904 - INFO - Segment duration: 5 seconds
2025-11-12 23:31:29,904 - INFO - Note: Channel validation performed during segmentation phase
2025-11-12 23:31:29,904 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-12 23:31:29,904 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-12 23:31:29,904 - INFO - Loading segments from chb15_fold19_sequences_prediction.json
2025-11-12 23:31:29,915 - INFO - Loaded 232 total sequences
2025-11-12 23:31:29,915 - INFO - Channel validation (from segmentation): 40/40 files valid
2025-11-12 23:31:29,915 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-12 23:31:29,915 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-12 23:31:29,916 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-12 23:31:29,916 - INFO - train: 184 sequences (92 preictal, 92 interictal)
2025-11-12 23:31:29,916 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-12 23:31:29,928 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-12 23:31:29,928 - INFO - train: kept 92 preictal and 92 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:31:29,928 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-12 23:31:29,940 - INFO - ============================================================
2025-11-12 23:31:29,940 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-12 23:31:29,940 - INFO - ============================================================
2025-11-12 23:31:29,940 - INFO - Processing 184 training samples to compute normalization stats...
2025-11-12 23:31:29,941 - INFO - Processing 184 sequences from 27 unique files
Processing training data:   0%|                                                                                                                                                                                                                           | 0/184 [00:00<?, ?it/s]Processing training data:   1%|#1                                                                                                                                                                                                                 | 1/184 [00:01<05:01,  1.65s/it]Processing training data:   8%|###############9                                                                                                                                                                                                  | 14/184 [00:02<00:20,  8.11it/s]Processing training data:   9%|##################2                                                                                                                                                                                               | 16/184 [00:03<00:40,  4.16it/s]Processing training data:  15%|##############################8                                                                                                                                                                                   | 27/184 [00:04<00:20,  7.49it/s]Processing training data:  18%|#####################################6                                                                                                                                                                            | 33/184 [00:06<00:26,  5.67it/s]Processing training data:  26%|######################################################7                                                                                                                                                           | 48/184 [00:07<00:16,  8.39it/s]Processing training data:  29%|#############################################################6                                                                                                                                                    | 54/184 [00:08<00:20,  6.49it/s]Processing training data:  36%|###########################################################################3                                                                                                                                      | 66/184 [00:09<00:12,  9.39it/s]Processing training data:  37%|#############################################################################6                                                                                                                                    | 68/184 [00:09<00:14,  8.15it/s]Processing training data:  40%|###################################################################################3                                                                                                                              | 73/184 [00:11<00:18,  5.98it/s]Processing training data:  46%|#################################################################################################                                                                                                                 | 85/184 [00:12<00:15,  6.60it/s]Processing training data:  59%|##########################################################################################################################6                                                                                      | 108/184 [00:13<00:05, 12.79it/s]Processing training data:  62%|#################################################################################################################################4                                                                               | 114/184 [00:14<00:06, 11.28it/s]Processing training data:  65%|#######################################################################################################################################1                                                                         | 119/184 [00:14<00:05, 11.47it/s]Processing training data:  66%|#########################################################################################################################################4                                                                       | 121/184 [00:15<00:06,  9.61it/s]Processing training data:  68%|###############################################################################################################################################1                                                                 | 126/184 [00:16<00:08,  6.74it/s]Processing training data:  74%|##########################################################################################################################################################4                                                      | 136/184 [00:17<00:05,  8.98it/s]Processing training data:  76%|###############################################################################################################################################################                                                  | 140/184 [00:17<00:04,  9.14it/s]Processing training data:  77%|#################################################################################################################################################################2                                               | 142/184 [00:18<00:07,  5.53it/s]Processing training data:  84%|################################################################################################################################################################################                                 | 155/184 [00:19<00:03,  9.28it/s]Processing training data:  86%|####################################################################################################################################################################################6                            | 159/184 [00:19<00:02,  8.89it/s]Processing training data:  89%|#########################################################################################################################################################################################1                       | 163/184 [00:20<00:02,  7.61it/s]Processing training data:  91%|##############################################################################################################################################################################################8                  | 168/184 [00:21<00:02,  7.84it/s]Processing training data:  93%|###################################################################################################################################################################################################3             | 172/184 [00:21<00:01,  7.95it/s]Processing training data:  97%|##########################################################################################################################################################################################################1      | 178/184 [00:22<00:00,  8.76it/s]Processing training data:  99%|##############################################################################################################################################################################################################7  | 182/184 [00:22<00:00,  9.22it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  8.37it/s]Processing training data: 100%|#################################################################################################################################################################################################################| 184/184 [00:23<00:00,  7.97it/s]
2025-11-12 23:31:53,025 - INFO - Computing normalization statistics from training data...
2025-11-12 23:31:53,308 - INFO - Normalization stats computed:
2025-11-12 23:31:53,308 - INFO -   Mean: -0.788069
2025-11-12 23:31:53,308 - INFO -   Std: 2.013778
2025-11-12 23:31:53,308 - INFO -   Saved to: preprocessing\checkpoints\chb15_fold19\normalization_stats.json
2025-11-12 23:31:53,327 - INFO - Applying normalization and saving 184 training sequences...
Normalizing and saving training data:   0%|                                                                                                                                                                                                               | 0/184 [00:00<?, ?it/s]2025-11-12 23:31:53,336 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold19\train_dataset.h5
Normalizing and saving training data:   5%|##########7                                                                                                                                                                                           | 10/184 [00:00<00:10, 16.94it/s]Normalizing and saving training data:  11%|#####################5                                                                                                                                                                                | 20/184 [00:01<00:09, 16.43it/s]Normalizing and saving training data:  16%|################################2                                                                                                                                                                     | 30/184 [00:01<00:09, 16.43it/s]Normalizing and saving training data:  22%|###########################################                                                                                                                                                           | 40/184 [00:02<00:08, 16.29it/s]Normalizing and saving training data:  27%|#####################################################8                                                                                                                                                | 50/184 [00:03<00:08, 16.42it/s]Normalizing and saving training data:  33%|################################################################5                                                                                                                                     | 60/184 [00:03<00:07, 16.48it/s]Normalizing and saving training data:  38%|###########################################################################3                                                                                                                          | 70/184 [00:04<00:06, 16.54it/s]Normalizing and saving training data:  43%|######################################################################################                                                                                                                | 80/184 [00:04<00:06, 16.55it/s]Normalizing and saving training data:  49%|################################################################################################8                                                                                                     | 90/184 [00:05<00:05, 16.54it/s]Normalizing and saving training data:  54%|###########################################################################################################                                                                                          | 100/184 [00:06<00:05, 16.56it/s]Normalizing and saving training data:  60%|#####################################################################################################################7                                                                               | 110/184 [00:06<00:04, 16.59it/s]Normalizing and saving training data:  65%|################################################################################################################################4                                                                    | 120/184 [00:07<00:03, 16.53it/s]Normalizing and saving training data:  71%|###########################################################################################################################################1                                                         | 130/184 [00:07<00:03, 16.55it/s]Normalizing and saving training data:  76%|#####################################################################################################################################################8                                               | 140/184 [00:08<00:02, 16.66it/s]Normalizing and saving training data:  82%|################################################################################################################################################################5                                    | 150/184 [00:09<00:02, 16.72it/s]Normalizing and saving training data:  87%|###########################################################################################################################################################################3                         | 160/184 [00:09<00:01, 16.79it/s]Normalizing and saving training data:  92%|######################################################################################################################################################################################               | 170/184 [00:10<00:00, 16.82it/s]Normalizing and saving training data:  98%|################################################################################################################################################################################################7    | 180/184 [00:10<00:00, 16.90it/s]Normalizing and saving training data: 100%|#####################################################################################################################################################################################################| 184/184 [00:10<00:00, 17.00it/s]
2025-11-12 23:32:04,408 - INFO - Training data processing completed during stats computation phase
2025-11-12 23:32:04,414 - INFO - Loaded normalization statistics:
2025-11-12 23:32:04,414 - INFO -   Mean: -0.788069
2025-11-12 23:32:04,414 - INFO -   Std: 2.013778
2025-11-12 23:32:04,414 - INFO - Split train already completed, skipping
2025-11-12 23:32:04,414 - INFO - Processing test split...
2025-11-12 23:32:04,415 - INFO - Need to process 48/48 sequences for test
2025-11-12 23:32:04,415 - INFO - Processing 48 sequences from 11 unique files
2025-11-12 23:32:04,415 - INFO - Average 4.4 sequences per file
Processing test:   0%|                                                                                                                                                                                                                                     | 0/48 [00:00<?, ?it/s]Processing test:   2%|####6                                                                                                                                                                                                                        | 1/48 [00:00<00:28,  1.64it/s]2025-11-12 23:32:05,025 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb15_fold19\test_dataset.h5
2025-11-12 23:32:06,431 - INFO - Progress: 208/232 (89.7%) - ETA: 0.1 minutes
Processing test:  52%|##################################################################################################################5                                                                                                         | 25/48 [00:02<00:02, 10.41it/s]Processing test:  56%|###########################################################################################################################7                                                                                                | 27/48 [00:03<00:03,  6.87it/s]Processing test:  62%|#########################################################################################################################################5                                                                                  | 30/48 [00:04<00:02,  6.14it/s]Processing test:  67%|##################################################################################################################################################6                                                                         | 32/48 [00:05<00:03,  4.05it/s]2025-11-12 23:32:10,965 - INFO - Progress: 219/232 (94.4%) - ETA: 0.0 minutes
Processing test:  75%|#####################################################################################################################################################################                                                       | 36/48 [00:07<00:03,  3.35it/s]Processing test:  81%|##################################################################################################################################################################################7                                         | 39/48 [00:07<00:02,  3.86it/s]Processing test:  85%|###########################################################################################################################################################################################9                                | 41/48 [00:08<00:01,  4.11it/s]Processing test:  88%|################################################################################################################################################################################################5                           | 42/48 [00:09<00:01,  3.10it/s]2025-11-12 23:32:14,274 - INFO - Progress: 229/232 (98.7%) - ETA: 0.0 minutes
Processing test:  96%|##################################################################################################################################################################################################################8         | 46/48 [00:10<00:00,  3.48it/s]Processing test:  98%|#######################################################################################################################################################################################################################4    | 47/48 [00:10<00:00,  3.03it/s]Processing test: 100%|############################################################################################################################################################################################################################| 48/48 [00:10<00:00,  4.44it/s]
2025-11-12 23:32:15,439 - INFO - Validating final datasets...
2025-11-12 23:32:15,447 - INFO - train dataset validation:
2025-11-12 23:32:15,447 - INFO -   - Segments: 184
2025-11-12 23:32:15,447 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:32:15,447 - INFO -   - Classes: 92 preictal, 92 interictal
2025-11-12 23:32:15,447 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:32:15,452 - INFO - test dataset validation:
2025-11-12 23:32:15,452 - INFO -   - Segments: 48
2025-11-12 23:32:15,452 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-12 23:32:15,452 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-12 23:32:15,452 - INFO -   - Balance: 50.0% preictal
2025-11-12 23:32:15,452 - INFO - ============================================================
2025-11-12 23:32:15,452 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-12 23:32:15,452 - INFO - Total time: 0.8 minutes
2025-11-12 23:32:15,452 - INFO - Processed segments: 232
2025-11-12 23:32:15,452 - INFO - Average rate: 5.1 segments/second
2025-11-12 23:32:15,452 - INFO - ============================================================
✅ Fold 19 preprocessing completed successfully!

============================================================
✅ BATCH PREPROCESSING COMPLETED!
✅ Processed 20 folds for patient chb15
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 20 folds for patient chb15
============================================================

============================================================
TRAINING FOLD 0/19
============================================================
Using dataset prefix: chb15_fold0
Loading datasets from: preprocessing\data\chb15_fold0
Saving models to: model\chb15_fold0
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.6990, std=2.0063
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6328, 4.1259]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 0): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.7346, grad_norm=1.454, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:49,  4.47s/it, loss=0.7346, grad_norm=1.454, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:49,  4.47s/it, loss=0.7275, grad_norm=1.625, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:19,  1.90s/it, loss=0.7275, grad_norm=1.625, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:19,  1.90s/it, loss=0.6924, grad_norm=1.166, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:09,  1.08s/it, loss=0.6924, grad_norm=1.166, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:09,  1.08s/it, loss=0.6996, grad_norm=1.239, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.43it/s, loss=0.6996, grad_norm=1.239, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.43it/s, loss=0.6856, grad_norm=1.202, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.06it/s, loss=0.6856, grad_norm=1.202, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:05<00:03,  2.06it/s, loss=0.6959, grad_norm=1.425, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:05<00:02,  2.79it/s, loss=0.6959, grad_norm=1.425, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:05<00:02,  2.79it/s, loss=0.6862, grad_norm=1.070, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:05<00:01,  3.61it/s, loss=0.6862, grad_norm=1.070, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:05<00:01,  3.61it/s, loss=0.6907, grad_norm=1.300, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:05<00:00,  4.46it/s, loss=0.6907, grad_norm=1.300, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:05<00:00,  4.46it/s, loss=0.6968, grad_norm=1.181, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.31it/s, loss=0.6968, grad_norm=1.181, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.31it/s, loss=0.7098, grad_norm=1.194, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.08it/s, loss=0.7098, grad_norm=1.194, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.08it/s, loss=0.6855, grad_norm=1.143, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.78it/s, loss=0.6855, grad_norm=1.143, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.78it/s, loss=0.6833, grad_norm=1.512, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:06<00:00,  1.93it/s, loss=0.6833, grad_norm=1.512, lr=0.000010]

Epoch 1/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6990, Acc: 0.4511, Precision: 0.4646, Recall: 0.6413, F1: 0.5388, AUC: 0.4192
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6919, grad_norm=1.203, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.96s/it, loss=0.6919, grad_norm=1.203, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.96s/it, loss=0.7005, grad_norm=1.243, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.70s/it, loss=0.7005, grad_norm=1.243, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.70s/it, loss=0.6822, grad_norm=1.125, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6822, grad_norm=1.125, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.7015, grad_norm=1.213, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.7015, grad_norm=1.213, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6878, grad_norm=1.260, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6878, grad_norm=1.260, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.7045, grad_norm=1.196, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.7045, grad_norm=1.196, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6781, grad_norm=1.377, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6781, grad_norm=1.377, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6868, grad_norm=1.185, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.6868, grad_norm=1.185, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.6953, grad_norm=1.175, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.60it/s, loss=0.6953, grad_norm=1.175, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.60it/s, loss=0.6819, grad_norm=1.299, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.39it/s, loss=0.6819, grad_norm=1.299, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.39it/s, loss=0.6938, grad_norm=1.238, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.6938, grad_norm=1.238, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.6734, grad_norm=1.566, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6734, grad_norm=1.566, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6898, Acc: 0.5163, Precision: 0.5122, Recall: 0.6848, F1: 0.5860, AUC: 0.5561
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6822, grad_norm=1.402, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6822, grad_norm=1.402, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6868, grad_norm=1.263, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6868, grad_norm=1.263, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6881, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6881, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6781, grad_norm=1.226, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6781, grad_norm=1.226, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6914, grad_norm=1.212, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6914, grad_norm=1.212, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.7027, grad_norm=1.388, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.7027, grad_norm=1.388, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6802, grad_norm=1.269, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6802, grad_norm=1.269, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6863, grad_norm=1.229, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6863, grad_norm=1.229, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6886, grad_norm=1.288, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.6886, grad_norm=1.288, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.6797, grad_norm=1.475, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.41it/s, loss=0.6797, grad_norm=1.475, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.41it/s, loss=0.7122, grad_norm=1.461, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.08it/s, loss=0.7122, grad_norm=1.461, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.08it/s, loss=0.6778, grad_norm=1.797, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6778, grad_norm=1.797, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6879, Acc: 0.5489, Precision: 0.5360, Recall: 0.7283, F1: 0.6175, AUC: 0.5659
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6866, grad_norm=1.312, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6866, grad_norm=1.312, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6624, grad_norm=1.352, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6624, grad_norm=1.352, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6727, grad_norm=1.427, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6727, grad_norm=1.427, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6673, grad_norm=1.208, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6673, grad_norm=1.208, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6486, grad_norm=1.232, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6486, grad_norm=1.232, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6789, grad_norm=1.236, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6789, grad_norm=1.236, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6882, grad_norm=1.479, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6882, grad_norm=1.479, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6957, grad_norm=1.297, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6957, grad_norm=1.297, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6617, grad_norm=1.309, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.6617, grad_norm=1.309, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.6722, grad_norm=1.344, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6722, grad_norm=1.344, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.42it/s, loss=0.6953, grad_norm=1.879, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.6953, grad_norm=1.879, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.6707, grad_norm=2.139, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6707, grad_norm=2.139, lr=0.000010]

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6750, Acc: 0.6196, Precision: 0.5917, Recall: 0.7717, F1: 0.6698, AUC: 0.6918
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6821, grad_norm=1.761, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.96s/it, loss=0.6821, grad_norm=1.761, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.96s/it, loss=0.6752, grad_norm=1.690, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.70s/it, loss=0.6752, grad_norm=1.690, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.70s/it, loss=0.6655, grad_norm=1.451, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6655, grad_norm=1.451, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.7031, grad_norm=1.473, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.7031, grad_norm=1.473, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6468, grad_norm=1.461, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6468, grad_norm=1.461, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6479, grad_norm=1.300, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6479, grad_norm=1.300, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6441, grad_norm=1.376, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6441, grad_norm=1.376, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6525, grad_norm=1.524, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.6525, grad_norm=1.524, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.6599, grad_norm=1.493, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.62it/s, loss=0.6599, grad_norm=1.493, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.62it/s, loss=0.6430, grad_norm=1.512, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.39it/s, loss=0.6430, grad_norm=1.512, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.39it/s, loss=0.6537, grad_norm=1.629, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.03it/s, loss=0.6537, grad_norm=1.629, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.03it/s, loss=0.6892, grad_norm=2.446, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.11it/s, loss=0.6892, grad_norm=2.446, lr=0.000010]

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6636, Acc: 0.6522, Precision: 0.6400, Recall: 0.6957, F1: 0.6667, AUC: 0.7318
------------------------------------------------------------
Training curves saved to model\chb15_fold0\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold0
============================================================
✅ Fold 0 training completed successfully!

============================================================
TRAINING FOLD 1/19
============================================================
Using dataset prefix: chb15_fold1
Loading datasets from: preprocessing\data\chb15_fold1
Saving models to: model\chb15_fold1
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7261, std=2.0020
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6314, 4.1179]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 1): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6877, grad_norm=1.594, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6877, grad_norm=1.594, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.7006, grad_norm=1.383, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.7006, grad_norm=1.383, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6975, grad_norm=1.174, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6975, grad_norm=1.174, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6973, grad_norm=1.269, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6973, grad_norm=1.269, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6791, grad_norm=1.461, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6791, grad_norm=1.461, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6983, grad_norm=1.405, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6983, grad_norm=1.405, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6756, grad_norm=1.206, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.83it/s, loss=0.6756, grad_norm=1.206, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.83it/s, loss=0.7052, grad_norm=1.278, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.68it/s, loss=0.7052, grad_norm=1.278, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.68it/s, loss=0.7054, grad_norm=1.299, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.50it/s, loss=0.7054, grad_norm=1.299, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.50it/s, loss=0.7095, grad_norm=1.312, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.18it/s, loss=0.7095, grad_norm=1.312, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.18it/s, loss=0.7135, grad_norm=1.346, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.76it/s, loss=0.7135, grad_norm=1.346, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.76it/s, loss=0.7069, grad_norm=1.837, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.08it/s, loss=0.7069, grad_norm=1.837, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6980, Acc: 0.4565, Precision: 0.4750, Recall: 0.8261, F1: 0.6032, AUC: 0.4357
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.7141, grad_norm=1.397, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.7141, grad_norm=1.397, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6996, grad_norm=1.201, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6996, grad_norm=1.201, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6976, grad_norm=1.225, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6976, grad_norm=1.225, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6957, grad_norm=1.227, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6957, grad_norm=1.227, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6808, grad_norm=1.406, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.6808, grad_norm=1.406, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.7021, grad_norm=1.231, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.7021, grad_norm=1.231, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6912, grad_norm=1.154, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6912, grad_norm=1.154, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6849, grad_norm=1.293, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6849, grad_norm=1.293, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6922, grad_norm=1.217, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6922, grad_norm=1.217, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6887, grad_norm=1.043, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.44it/s, loss=0.6887, grad_norm=1.043, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.44it/s, loss=0.6959, grad_norm=1.275, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6959, grad_norm=1.275, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.7020, grad_norm=1.760, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.7020, grad_norm=1.760, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6954, Acc: 0.4674, Precision: 0.4786, Recall: 0.7283, F1: 0.5776, AUC: 0.4729
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6938, grad_norm=1.198, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.95s/it, loss=0.6938, grad_norm=1.198, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.95s/it, loss=0.6906, grad_norm=1.196, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6906, grad_norm=1.196, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6857, grad_norm=1.192, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6857, grad_norm=1.192, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6885, grad_norm=1.114, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6885, grad_norm=1.114, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6895, grad_norm=1.361, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6895, grad_norm=1.361, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6960, grad_norm=1.392, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6960, grad_norm=1.392, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6931, grad_norm=1.124, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6931, grad_norm=1.124, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6789, grad_norm=1.223, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6789, grad_norm=1.223, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6842, grad_norm=1.242, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.6842, grad_norm=1.242, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.7098, grad_norm=1.405, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.43it/s, loss=0.7098, grad_norm=1.405, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.43it/s, loss=0.6919, grad_norm=1.185, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.6919, grad_norm=1.185, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.6925, grad_norm=1.833, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6925, grad_norm=1.833, lr=0.000010]

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6912, Acc: 0.5109, Precision: 0.5104, Recall: 0.5326, F1: 0.5213, AUC: 0.5514
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6769, grad_norm=1.732, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.04s/it, loss=0.6769, grad_norm=1.732, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.04s/it, loss=0.6917, grad_norm=1.233, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6917, grad_norm=1.233, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6878, grad_norm=1.687, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6878, grad_norm=1.687, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6893, grad_norm=1.163, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6893, grad_norm=1.163, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6813, grad_norm=1.302, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.22it/s, loss=0.6813, grad_norm=1.302, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.22it/s, loss=0.6880, grad_norm=1.261, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  3.00it/s, loss=0.6880, grad_norm=1.261, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  3.00it/s, loss=0.6745, grad_norm=1.335, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.85it/s, loss=0.6745, grad_norm=1.335, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.85it/s, loss=0.6809, grad_norm=1.275, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6809, grad_norm=1.275, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6842, grad_norm=1.117, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.55it/s, loss=0.6842, grad_norm=1.117, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.55it/s, loss=0.6918, grad_norm=1.433, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.32it/s, loss=0.6918, grad_norm=1.433, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.32it/s, loss=0.6748, grad_norm=1.305, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.00it/s, loss=0.6748, grad_norm=1.305, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.00it/s, loss=0.6963, grad_norm=2.054, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.07it/s, loss=0.6963, grad_norm=2.054, lr=0.000010]

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6848, Acc: 0.6304, Precision: 0.6500, Recall: 0.5652, F1: 0.6047, AUC: 0.6830
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6816, grad_norm=1.154, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.07s/it, loss=0.6816, grad_norm=1.154, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.07s/it, loss=0.6950, grad_norm=1.267, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.74s/it, loss=0.6950, grad_norm=1.267, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.74s/it, loss=0.6786, grad_norm=1.344, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.00it/s, loss=0.6786, grad_norm=1.344, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.00it/s, loss=0.6731, grad_norm=1.204, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.55it/s, loss=0.6731, grad_norm=1.204, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.55it/s, loss=0.6808, grad_norm=1.304, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.22it/s, loss=0.6808, grad_norm=1.304, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.22it/s, loss=0.6774, grad_norm=1.389, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.99it/s, loss=0.6774, grad_norm=1.389, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.99it/s, loss=0.6924, grad_norm=1.582, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.84it/s, loss=0.6924, grad_norm=1.582, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.84it/s, loss=0.6775, grad_norm=1.526, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6775, grad_norm=1.526, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6685, grad_norm=1.382, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.60it/s, loss=0.6685, grad_norm=1.382, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.60it/s, loss=0.6829, grad_norm=1.515, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.37it/s, loss=0.6829, grad_norm=1.515, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.37it/s, loss=0.6700, grad_norm=1.400, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.03it/s, loss=0.6700, grad_norm=1.400, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.03it/s, loss=0.6800, grad_norm=2.055, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.08it/s, loss=0.6800, grad_norm=2.055, lr=0.000010]

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6798, Acc: 0.6087, Precision: 0.6190, Recall: 0.5652, F1: 0.5909, AUC: 0.7154
------------------------------------------------------------
Training curves saved to model\chb15_fold1\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold1
============================================================
✅ Fold 1 training completed successfully!

============================================================
TRAINING FOLD 2/19
============================================================
Using dataset prefix: chb15_fold2
Loading datasets from: preprocessing\data\chb15_fold2
Saving models to: model\chb15_fold2
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7786, std=2.0184
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5596, 4.1446]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 2): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6883, grad_norm=1.142, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.95s/it, loss=0.6883, grad_norm=1.142, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.95s/it, loss=0.6990, grad_norm=1.159, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6990, grad_norm=1.159, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6896, grad_norm=1.156, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6896, grad_norm=1.156, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6990, grad_norm=1.087, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6990, grad_norm=1.087, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6847, grad_norm=1.201, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6847, grad_norm=1.201, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.7021, grad_norm=1.074, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.7021, grad_norm=1.074, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.7068, grad_norm=1.328, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.7068, grad_norm=1.328, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.7057, grad_norm=1.169, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.7057, grad_norm=1.169, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.6977, grad_norm=1.045, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.60it/s, loss=0.6977, grad_norm=1.045, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.60it/s, loss=0.6916, grad_norm=1.127, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.35it/s, loss=0.6916, grad_norm=1.127, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6899, grad_norm=1.163, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6899, grad_norm=1.163, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6829, grad_norm=1.541, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6829, grad_norm=1.541, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6948, Acc: 0.5000, Precision: 0.5000, Recall: 0.7391, F1: 0.5965, AUC: 0.4648
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6940, grad_norm=1.304, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6940, grad_norm=1.304, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6817, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6817, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6945, grad_norm=1.090, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6945, grad_norm=1.090, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.7010, grad_norm=1.292, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.7010, grad_norm=1.292, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6994, grad_norm=1.418, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6994, grad_norm=1.418, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6943, grad_norm=1.105, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6943, grad_norm=1.105, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6936, grad_norm=1.284, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6936, grad_norm=1.284, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.7038, grad_norm=1.231, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.7038, grad_norm=1.231, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6954, grad_norm=1.125, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.60it/s, loss=0.6954, grad_norm=1.125, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.60it/s, loss=0.6923, grad_norm=1.085, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.38it/s, loss=0.6923, grad_norm=1.085, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.38it/s, loss=0.6880, grad_norm=1.041, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.6880, grad_norm=1.041, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.6990, grad_norm=1.567, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6990, grad_norm=1.567, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6948, Acc: 0.4837, Precision: 0.4835, Recall: 0.4783, F1: 0.4809, AUC: 0.4689
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6858, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.92s/it, loss=0.6858, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.92s/it, loss=0.6875, grad_norm=1.079, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6875, grad_norm=1.079, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6869, grad_norm=1.053, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6869, grad_norm=1.053, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6754, grad_norm=1.082, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6754, grad_norm=1.082, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6880, grad_norm=1.092, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6880, grad_norm=1.092, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6893, grad_norm=1.189, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6893, grad_norm=1.189, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6817, grad_norm=1.116, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6817, grad_norm=1.116, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6831, grad_norm=1.013, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6831, grad_norm=1.013, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6883, grad_norm=1.094, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6883, grad_norm=1.094, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6955, grad_norm=1.122, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.40it/s, loss=0.6955, grad_norm=1.122, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.40it/s, loss=0.6880, grad_norm=1.163, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.08it/s, loss=0.6880, grad_norm=1.163, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.08it/s, loss=0.6898, grad_norm=1.599, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6898, grad_norm=1.599, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6866, Acc: 0.5978, Precision: 0.5804, Recall: 0.7065, F1: 0.6373, AUC: 0.6680
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6992, grad_norm=1.391, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.91s/it, loss=0.6992, grad_norm=1.391, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.91s/it, loss=0.6860, grad_norm=1.070, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6860, grad_norm=1.070, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6864, grad_norm=1.130, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6864, grad_norm=1.130, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6864, grad_norm=1.109, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6864, grad_norm=1.109, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6885, grad_norm=1.247, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6885, grad_norm=1.247, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6837, grad_norm=1.063, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6837, grad_norm=1.063, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6799, grad_norm=1.125, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6799, grad_norm=1.125, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6880, grad_norm=1.205, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6880, grad_norm=1.205, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6927, grad_norm=1.142, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.6927, grad_norm=1.142, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.6769, grad_norm=1.189, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6769, grad_norm=1.189, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6876, grad_norm=1.219, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.07it/s, loss=0.6876, grad_norm=1.219, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6880, grad_norm=1.601, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6880, grad_norm=1.601, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6869, Acc: 0.5652, Precision: 0.5566, Recall: 0.6413, F1: 0.5960, AUC: 0.6256
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6763, grad_norm=1.139, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.92s/it, loss=0.6763, grad_norm=1.139, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.92s/it, loss=0.6854, grad_norm=1.379, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6854, grad_norm=1.379, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6862, grad_norm=1.471, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6862, grad_norm=1.471, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6754, grad_norm=1.172, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6754, grad_norm=1.172, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6768, grad_norm=1.264, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6768, grad_norm=1.264, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6847, grad_norm=1.119, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6847, grad_norm=1.119, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6755, grad_norm=1.202, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6755, grad_norm=1.202, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6860, grad_norm=1.234, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6860, grad_norm=1.234, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6841, grad_norm=1.250, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6841, grad_norm=1.250, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6682, grad_norm=1.285, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.45it/s, loss=0.6682, grad_norm=1.285, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.45it/s, loss=0.6785, grad_norm=1.192, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.6785, grad_norm=1.192, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.7035, grad_norm=1.933, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.7035, grad_norm=1.933, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6817, Acc: 0.6522, Precision: 0.6094, Recall: 0.8478, F1: 0.7091, AUC: 0.7105
------------------------------------------------------------
Training curves saved to model\chb15_fold2\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold2
============================================================
✅ Fold 2 training completed successfully!

============================================================
TRAINING FOLD 3/19
============================================================
Using dataset prefix: chb15_fold3
Loading datasets from: preprocessing\data\chb15_fold3
Saving models to: model\chb15_fold3
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7693, std=2.0298
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5328, 4.1148]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 3): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6748, grad_norm=1.311, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.91s/it, loss=0.6748, grad_norm=1.311, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.91s/it, loss=0.6981, grad_norm=1.301, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6981, grad_norm=1.301, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.7061, grad_norm=1.366, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.7061, grad_norm=1.366, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6730, grad_norm=1.332, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6730, grad_norm=1.332, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6705, grad_norm=1.335, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6705, grad_norm=1.335, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6967, grad_norm=1.304, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6967, grad_norm=1.304, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.7037, grad_norm=1.393, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.7037, grad_norm=1.393, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6804, grad_norm=1.332, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6804, grad_norm=1.332, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6923, grad_norm=1.302, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6923, grad_norm=1.302, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6983, grad_norm=1.306, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6983, grad_norm=1.306, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.7069, grad_norm=1.475, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.07it/s, loss=0.7069, grad_norm=1.475, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.7130, grad_norm=1.853, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.7130, grad_norm=1.853, lr=0.000010]

Epoch 1/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6928, Acc: 0.5217, Precision: 0.7000, Recall: 0.0761, F1: 0.1373, AUC: 0.5536
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7173, grad_norm=1.507, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.7173, grad_norm=1.507, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6986, grad_norm=1.382, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:03<00:16,  1.66s/it, loss=0.6986, grad_norm=1.382, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.66s/it, loss=0.7033, grad_norm=1.340, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.7033, grad_norm=1.340, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6885, grad_norm=1.305, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6885, grad_norm=1.305, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6881, grad_norm=1.330, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.31it/s, loss=0.6881, grad_norm=1.330, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.31it/s, loss=0.6884, grad_norm=1.300, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6884, grad_norm=1.300, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6848, grad_norm=1.248, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.97it/s, loss=0.6848, grad_norm=1.248, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.97it/s, loss=0.6858, grad_norm=1.299, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6858, grad_norm=1.299, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6752, grad_norm=1.440, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6752, grad_norm=1.440, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.7036, grad_norm=1.434, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.7036, grad_norm=1.434, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6759, grad_norm=1.440, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.17it/s, loss=0.6759, grad_norm=1.440, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.17it/s, loss=0.6805, grad_norm=1.800, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6805, grad_norm=1.800, lr=0.000010]

Epoch 2/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6908, Acc: 0.5272, Precision: 0.5385, Recall: 0.3804, F1: 0.4459, AUC: 0.5371
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6979, grad_norm=1.434, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.89s/it, loss=0.6979, grad_norm=1.434, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.89s/it, loss=0.6916, grad_norm=1.293, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:03<00:16,  1.67s/it, loss=0.6916, grad_norm=1.293, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6735, grad_norm=1.339, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6735, grad_norm=1.339, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6863, grad_norm=1.292, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6863, grad_norm=1.292, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6965, grad_norm=1.337, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6965, grad_norm=1.337, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6911, grad_norm=1.305, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6911, grad_norm=1.305, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6966, grad_norm=1.472, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.98it/s, loss=0.6966, grad_norm=1.472, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.98it/s, loss=0.6682, grad_norm=1.317, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6682, grad_norm=1.317, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6876, grad_norm=1.284, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.6876, grad_norm=1.284, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.6745, grad_norm=1.440, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6745, grad_norm=1.440, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6865, grad_norm=1.322, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.19it/s, loss=0.6865, grad_norm=1.322, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.19it/s, loss=0.7345, grad_norm=2.307, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.7345, grad_norm=2.307, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6904, Acc: 0.6033, Precision: 0.6203, Recall: 0.5326, F1: 0.5731, AUC: 0.5984
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6750, grad_norm=1.394, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6750, grad_norm=1.394, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6779, grad_norm=1.221, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6779, grad_norm=1.221, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6994, grad_norm=1.483, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6994, grad_norm=1.483, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6799, grad_norm=1.559, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6799, grad_norm=1.559, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.7040, grad_norm=1.518, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.7040, grad_norm=1.518, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6823, grad_norm=1.673, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6823, grad_norm=1.673, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6992, grad_norm=1.491, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6992, grad_norm=1.491, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6860, grad_norm=1.415, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.85it/s, loss=0.6860, grad_norm=1.415, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.85it/s, loss=0.6997, grad_norm=1.416, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6997, grad_norm=1.416, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6863, grad_norm=1.488, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.55it/s, loss=0.6863, grad_norm=1.488, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.55it/s, loss=0.6880, grad_norm=1.551, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.23it/s, loss=0.6880, grad_norm=1.551, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.23it/s, loss=0.6466, grad_norm=1.927, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6466, grad_norm=1.927, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6854, Acc: 0.5924, Precision: 0.6133, Recall: 0.5000, F1: 0.5509, AUC: 0.6007
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6874, grad_norm=1.443, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.91s/it, loss=0.6874, grad_norm=1.443, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.91s/it, loss=0.6808, grad_norm=1.482, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6808, grad_norm=1.482, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6893, grad_norm=1.660, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6893, grad_norm=1.660, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6779, grad_norm=1.507, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6779, grad_norm=1.507, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6715, grad_norm=1.484, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6715, grad_norm=1.484, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6587, grad_norm=1.470, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6587, grad_norm=1.470, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6636, grad_norm=1.415, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6636, grad_norm=1.415, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6812, grad_norm=1.576, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.87it/s, loss=0.6812, grad_norm=1.576, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.87it/s, loss=0.6697, grad_norm=1.604, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6697, grad_norm=1.604, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6525, grad_norm=1.612, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.51it/s, loss=0.6525, grad_norm=1.612, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.51it/s, loss=0.6658, grad_norm=1.621, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.18it/s, loss=0.6658, grad_norm=1.621, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.18it/s, loss=0.6616, grad_norm=2.285, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6616, grad_norm=2.285, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6717, Acc: 0.6630, Precision: 0.7679, Recall: 0.4674, F1: 0.5811, AUC: 0.7271
------------------------------------------------------------
Training curves saved to model\chb15_fold3\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold3
============================================================
✅ Fold 3 training completed successfully!

============================================================
TRAINING FOLD 4/19
============================================================
Using dataset prefix: chb15_fold4
Loading datasets from: preprocessing\data\chb15_fold4
Saving models to: model\chb15_fold4
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.8223, std=2.0052
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5745, 4.1773]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 4): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6922, grad_norm=1.187, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6922, grad_norm=1.187, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.7041, grad_norm=1.202, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.7041, grad_norm=1.202, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6894, grad_norm=1.236, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6894, grad_norm=1.236, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.7276, grad_norm=1.558, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.7276, grad_norm=1.558, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6854, grad_norm=1.133, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6854, grad_norm=1.133, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6975, grad_norm=1.160, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6975, grad_norm=1.160, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6941, grad_norm=1.014, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6941, grad_norm=1.014, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6888, grad_norm=1.182, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6888, grad_norm=1.182, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.7154, grad_norm=1.237, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.67it/s, loss=0.7154, grad_norm=1.237, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.67it/s, loss=0.7186, grad_norm=1.324, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.7186, grad_norm=1.324, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6983, grad_norm=1.084, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.07it/s, loss=0.6983, grad_norm=1.084, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6942, grad_norm=1.637, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6942, grad_norm=1.637, lr=0.000010]

Epoch 1/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.7005, Acc: 0.4511, Precision: 0.4731, Recall: 0.8587, F1: 0.6100, AUC: 0.4134
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6688, grad_norm=1.275, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.86s/it, loss=0.6688, grad_norm=1.275, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.86s/it, loss=0.6943, grad_norm=1.090, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:03<00:16,  1.66s/it, loss=0.6943, grad_norm=1.090, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.66s/it, loss=0.7116, grad_norm=1.282, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.7116, grad_norm=1.282, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6789, grad_norm=1.008, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6789, grad_norm=1.008, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6883, grad_norm=1.075, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6883, grad_norm=1.075, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6909, grad_norm=1.089, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6909, grad_norm=1.089, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6944, grad_norm=1.059, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6944, grad_norm=1.059, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6843, grad_norm=1.135, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.6843, grad_norm=1.135, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.6763, grad_norm=1.116, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6763, grad_norm=1.116, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6793, grad_norm=1.063, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.35it/s, loss=0.6793, grad_norm=1.063, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.35it/s, loss=0.6991, grad_norm=1.086, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.01it/s, loss=0.6991, grad_norm=1.086, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6802, grad_norm=1.575, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6802, grad_norm=1.575, lr=0.000010]

Epoch 2/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6872, Acc: 0.5380, Precision: 0.5252, Recall: 0.7935, F1: 0.6320, AUC: 0.6244
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6883, grad_norm=1.057, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6883, grad_norm=1.057, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6809, grad_norm=1.171, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6809, grad_norm=1.171, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6823, grad_norm=1.125, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6823, grad_norm=1.125, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6836, grad_norm=1.059, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6836, grad_norm=1.059, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6854, grad_norm=1.072, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6854, grad_norm=1.072, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6847, grad_norm=1.119, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6847, grad_norm=1.119, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6986, grad_norm=1.220, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6986, grad_norm=1.220, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6755, grad_norm=1.107, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6755, grad_norm=1.107, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6872, grad_norm=1.098, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6872, grad_norm=1.098, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6937, grad_norm=1.244, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.40it/s, loss=0.6937, grad_norm=1.244, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.40it/s, loss=0.6775, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6775, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6700, grad_norm=1.509, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6700, grad_norm=1.509, lr=0.000010]

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6840, Acc: 0.6141, Precision: 0.6082, Recall: 0.6413, F1: 0.6243, AUC: 0.6393
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7068, grad_norm=1.129, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.7068, grad_norm=1.129, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.6716, grad_norm=1.213, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6716, grad_norm=1.213, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6878, grad_norm=1.139, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6878, grad_norm=1.139, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6971, grad_norm=1.337, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6971, grad_norm=1.337, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6648, grad_norm=1.169, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6648, grad_norm=1.169, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6821, grad_norm=1.206, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6821, grad_norm=1.206, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6772, grad_norm=1.228, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6772, grad_norm=1.228, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6903, grad_norm=1.125, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6903, grad_norm=1.125, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6919, grad_norm=1.197, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.6919, grad_norm=1.197, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.6829, grad_norm=1.032, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6829, grad_norm=1.032, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.46it/s, loss=0.6791, grad_norm=1.218, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.6791, grad_norm=1.218, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.6941, grad_norm=1.907, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6941, grad_norm=1.907, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6855, Acc: 0.6033, Precision: 0.6118, Recall: 0.5652, F1: 0.5876, AUC: 0.6259
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6937, grad_norm=1.461, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.91s/it, loss=0.6937, grad_norm=1.461, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.91s/it, loss=0.6917, grad_norm=1.315, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6917, grad_norm=1.315, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6747, grad_norm=1.321, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6747, grad_norm=1.321, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6710, grad_norm=1.319, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6710, grad_norm=1.319, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6733, grad_norm=1.280, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6733, grad_norm=1.280, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6869, grad_norm=1.270, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6869, grad_norm=1.270, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6759, grad_norm=1.112, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6759, grad_norm=1.112, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6693, grad_norm=1.235, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6693, grad_norm=1.235, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6704, grad_norm=1.362, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6704, grad_norm=1.362, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6871, grad_norm=1.415, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.36it/s, loss=0.6871, grad_norm=1.415, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.36it/s, loss=0.6878, grad_norm=1.433, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.94it/s, loss=0.6878, grad_norm=1.433, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.94it/s, loss=0.6971, grad_norm=2.005, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6971, grad_norm=2.005, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6816, Acc: 0.6413, Precision: 0.6204, Recall: 0.7283, F1: 0.6700, AUC: 0.6922
------------------------------------------------------------
Training curves saved to model\chb15_fold4\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold4
============================================================
✅ Fold 4 training completed successfully!

============================================================
TRAINING FOLD 5/19
============================================================
Using dataset prefix: chb15_fold5
Loading datasets from: preprocessing\data\chb15_fold5
Saving models to: model\chb15_fold5
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.6832, std=1.9928
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6787, 4.1500]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 5): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6802, grad_norm=1.144, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.6802, grad_norm=1.144, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.7079, grad_norm=1.220, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.7079, grad_norm=1.220, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6871, grad_norm=1.058, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6871, grad_norm=1.058, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.7108, grad_norm=1.258, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.7108, grad_norm=1.258, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6736, grad_norm=1.254, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6736, grad_norm=1.254, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6791, grad_norm=1.259, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.00it/s, loss=0.6791, grad_norm=1.259, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.00it/s, loss=0.6876, grad_norm=1.030, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.84it/s, loss=0.6876, grad_norm=1.030, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.84it/s, loss=0.6937, grad_norm=1.142, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.73it/s, loss=0.6937, grad_norm=1.142, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.73it/s, loss=0.6986, grad_norm=1.163, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.58it/s, loss=0.6986, grad_norm=1.163, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.58it/s, loss=0.6940, grad_norm=1.017, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6940, grad_norm=1.017, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6915, grad_norm=1.033, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6915, grad_norm=1.033, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6966, grad_norm=1.415, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.09it/s, loss=0.6966, grad_norm=1.415, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6917, Acc: 0.5109, Precision: 0.5060, Recall: 0.9239, F1: 0.6538, AUC: 0.5885
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6961, grad_norm=1.129, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.6961, grad_norm=1.129, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.7024, grad_norm=1.231, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.7024, grad_norm=1.231, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6909, grad_norm=1.156, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6909, grad_norm=1.156, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6805, grad_norm=1.107, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6805, grad_norm=1.107, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6952, grad_norm=1.068, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6952, grad_norm=1.068, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6800, grad_norm=1.057, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6800, grad_norm=1.057, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6888, grad_norm=1.107, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6888, grad_norm=1.107, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6862, grad_norm=1.260, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6862, grad_norm=1.260, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6904, grad_norm=1.150, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6904, grad_norm=1.150, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6929, grad_norm=1.048, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.40it/s, loss=0.6929, grad_norm=1.048, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.40it/s, loss=0.6957, grad_norm=1.297, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.87it/s, loss=0.6957, grad_norm=1.297, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.87it/s, loss=0.6957, grad_norm=1.592, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.09it/s, loss=0.6957, grad_norm=1.592, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6912, Acc: 0.5435, Precision: 0.5377, Recall: 0.6196, F1: 0.5758, AUC: 0.5476
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6940, grad_norm=1.101, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.98s/it, loss=0.6940, grad_norm=1.101, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.98s/it, loss=0.7028, grad_norm=1.145, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.70s/it, loss=0.7028, grad_norm=1.145, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.70s/it, loss=0.6826, grad_norm=1.059, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6826, grad_norm=1.059, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6995, grad_norm=1.089, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6995, grad_norm=1.089, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6947, grad_norm=1.035, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6947, grad_norm=1.035, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6838, grad_norm=1.062, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6838, grad_norm=1.062, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6879, grad_norm=1.057, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6879, grad_norm=1.057, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6911, grad_norm=1.111, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6911, grad_norm=1.111, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6891, grad_norm=1.212, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6891, grad_norm=1.212, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6929, grad_norm=1.191, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.47it/s, loss=0.6929, grad_norm=1.191, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.47it/s, loss=0.6935, grad_norm=1.111, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.14it/s, loss=0.6935, grad_norm=1.111, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.14it/s, loss=0.6861, grad_norm=1.435, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.11it/s, loss=0.6861, grad_norm=1.435, lr=0.000010]

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6915, Acc: 0.5217, Precision: 0.5192, Recall: 0.5870, F1: 0.5510, AUC: 0.5357
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6947, grad_norm=1.164, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6947, grad_norm=1.164, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6826, grad_norm=1.083, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6826, grad_norm=1.083, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6795, grad_norm=1.114, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6795, grad_norm=1.114, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6793, grad_norm=1.224, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6793, grad_norm=1.224, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6766, grad_norm=1.112, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6766, grad_norm=1.112, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6863, grad_norm=1.189, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6863, grad_norm=1.189, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6969, grad_norm=1.328, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6969, grad_norm=1.328, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6742, grad_norm=1.161, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6742, grad_norm=1.161, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6784, grad_norm=1.235, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.73it/s, loss=0.6784, grad_norm=1.235, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.73it/s, loss=0.6684, grad_norm=1.110, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6684, grad_norm=1.110, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6937, grad_norm=1.315, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.18it/s, loss=0.6937, grad_norm=1.315, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.18it/s, loss=0.6929, grad_norm=2.175, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6929, grad_norm=2.175, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6836, Acc: 0.6196, Precision: 0.6100, Recall: 0.6630, F1: 0.6354, AUC: 0.6646
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6806, grad_norm=1.192, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6806, grad_norm=1.192, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6840, grad_norm=1.199, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6840, grad_norm=1.199, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6773, grad_norm=1.220, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6773, grad_norm=1.220, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6879, grad_norm=1.432, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6879, grad_norm=1.432, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6715, grad_norm=1.300, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.31it/s, loss=0.6715, grad_norm=1.300, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.31it/s, loss=0.6643, grad_norm=1.363, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6643, grad_norm=1.363, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6732, grad_norm=1.508, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.97it/s, loss=0.6732, grad_norm=1.508, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.97it/s, loss=0.6823, grad_norm=1.479, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.87it/s, loss=0.6823, grad_norm=1.479, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.87it/s, loss=0.6706, grad_norm=1.473, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6706, grad_norm=1.473, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6665, grad_norm=1.459, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.52it/s, loss=0.6665, grad_norm=1.459, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.52it/s, loss=0.6696, grad_norm=1.804, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.20it/s, loss=0.6696, grad_norm=1.804, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.20it/s, loss=0.6852, grad_norm=2.104, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6852, grad_norm=2.104, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6761, Acc: 0.6630, Precision: 0.6974, Recall: 0.5761, F1: 0.6310, AUC: 0.7300
------------------------------------------------------------
Training curves saved to model\chb15_fold5\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold5
============================================================
✅ Fold 5 training completed successfully!

============================================================
TRAINING FOLD 6/19
============================================================
Using dataset prefix: chb15_fold6
Loading datasets from: preprocessing\data\chb15_fold6
Saving models to: model\chb15_fold6
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7357, std=2.0057
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6162, 4.1393]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 6): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7120, grad_norm=1.292, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.96s/it, loss=0.7120, grad_norm=1.292, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.96s/it, loss=0.6735, grad_norm=1.336, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.70s/it, loss=0.6735, grad_norm=1.336, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.70s/it, loss=0.7075, grad_norm=1.290, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.7075, grad_norm=1.290, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6763, grad_norm=1.168, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6763, grad_norm=1.168, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.7000, grad_norm=1.194, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.7000, grad_norm=1.194, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6984, grad_norm=1.271, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6984, grad_norm=1.271, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.7120, grad_norm=1.165, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.7120, grad_norm=1.165, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6757, grad_norm=1.448, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6757, grad_norm=1.448, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.7245, grad_norm=1.506, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.7245, grad_norm=1.506, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.6751, grad_norm=1.262, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6751, grad_norm=1.262, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.42it/s, loss=0.6981, grad_norm=1.220, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6981, grad_norm=1.220, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6952, grad_norm=1.766, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.11it/s, loss=0.6952, grad_norm=1.766, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6957, Acc: 0.5000, Precision: 0.5000, Recall: 0.8696, F1: 0.6349, AUC: 0.4629
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6827, grad_norm=1.264, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.89s/it, loss=0.6827, grad_norm=1.264, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.89s/it, loss=0.6841, grad_norm=1.128, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6841, grad_norm=1.128, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6816, grad_norm=1.132, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6816, grad_norm=1.132, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.7052, grad_norm=1.163, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.7052, grad_norm=1.163, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6934, grad_norm=1.275, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6934, grad_norm=1.275, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6877, grad_norm=1.238, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6877, grad_norm=1.238, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6855, grad_norm=1.039, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6855, grad_norm=1.039, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6870, grad_norm=1.300, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6870, grad_norm=1.300, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6914, grad_norm=1.154, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6914, grad_norm=1.154, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6975, grad_norm=1.489, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6975, grad_norm=1.489, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6922, grad_norm=1.251, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.10it/s, loss=0.6922, grad_norm=1.251, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.6986, grad_norm=1.852, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6986, grad_norm=1.852, lr=0.000010]

Epoch 2/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6906, Acc: 0.5109, Precision: 0.5074, Recall: 0.7500, F1: 0.6053, AUC: 0.5683
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6761, grad_norm=1.273, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6761, grad_norm=1.273, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6854, grad_norm=1.100, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:03<00:16,  1.66s/it, loss=0.6854, grad_norm=1.100, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.66s/it, loss=0.6815, grad_norm=1.102, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6815, grad_norm=1.102, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6884, grad_norm=1.186, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6884, grad_norm=1.186, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6817, grad_norm=1.234, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6817, grad_norm=1.234, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6816, grad_norm=1.209, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6816, grad_norm=1.209, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6832, grad_norm=1.178, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.97it/s, loss=0.6832, grad_norm=1.178, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.97it/s, loss=0.6918, grad_norm=1.119, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.85it/s, loss=0.6918, grad_norm=1.119, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.85it/s, loss=0.6790, grad_norm=1.098, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.73it/s, loss=0.6790, grad_norm=1.098, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.73it/s, loss=0.6811, grad_norm=1.129, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6811, grad_norm=1.129, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6795, grad_norm=1.096, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.18it/s, loss=0.6795, grad_norm=1.096, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.18it/s, loss=0.6963, grad_norm=1.661, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6963, grad_norm=1.661, lr=0.000010]

Epoch 3/5 Complete (5.9s) [LR: 0.000010]
Train - Loss: 0.6838, Acc: 0.6196, Precision: 0.5982, Recall: 0.7283, F1: 0.6569, AUC: 0.6914
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6889, grad_norm=1.215, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.92s/it, loss=0.6889, grad_norm=1.215, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.92s/it, loss=0.6944, grad_norm=1.395, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6944, grad_norm=1.395, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6782, grad_norm=1.120, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6782, grad_norm=1.120, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6936, grad_norm=1.230, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6936, grad_norm=1.230, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6778, grad_norm=1.137, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6778, grad_norm=1.137, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6762, grad_norm=1.202, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6762, grad_norm=1.202, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6787, grad_norm=1.193, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6787, grad_norm=1.193, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6875, grad_norm=1.169, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6875, grad_norm=1.169, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6752, grad_norm=1.155, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.68it/s, loss=0.6752, grad_norm=1.155, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.68it/s, loss=0.6965, grad_norm=1.161, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.45it/s, loss=0.6965, grad_norm=1.161, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.45it/s, loss=0.6802, grad_norm=1.274, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.6802, grad_norm=1.274, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.6982, grad_norm=2.098, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6982, grad_norm=2.098, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6855, Acc: 0.5707, Precision: 0.5765, Recall: 0.5326, F1: 0.5537, AUC: 0.6242
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6835, grad_norm=1.389, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.94s/it, loss=0.6835, grad_norm=1.389, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.94s/it, loss=0.6759, grad_norm=1.350, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6759, grad_norm=1.350, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6764, grad_norm=1.387, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6764, grad_norm=1.387, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6733, grad_norm=1.393, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6733, grad_norm=1.393, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6785, grad_norm=1.537, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.6785, grad_norm=1.537, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.6818, grad_norm=1.423, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6818, grad_norm=1.423, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6833, grad_norm=1.524, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6833, grad_norm=1.524, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6636, grad_norm=1.340, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6636, grad_norm=1.340, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6737, grad_norm=1.446, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6737, grad_norm=1.446, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6603, grad_norm=1.392, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.41it/s, loss=0.6603, grad_norm=1.392, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.41it/s, loss=0.6682, grad_norm=1.576, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6682, grad_norm=1.576, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6622, grad_norm=2.343, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6622, grad_norm=2.343, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6734, Acc: 0.6957, Precision: 0.6800, Recall: 0.7391, F1: 0.7083, AUC: 0.7656
------------------------------------------------------------
Training curves saved to model\chb15_fold6\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold6
============================================================
✅ Fold 6 training completed successfully!

============================================================
TRAINING FOLD 7/19
============================================================
Using dataset prefix: chb15_fold7
Loading datasets from: preprocessing\data\chb15_fold7
Saving models to: model\chb15_fold7
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.6591, std=1.9858
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.7109, 4.1511]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 7): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6813, grad_norm=1.054, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.91s/it, loss=0.6813, grad_norm=1.054, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.91s/it, loss=0.6994, grad_norm=1.098, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6994, grad_norm=1.098, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.7149, grad_norm=1.219, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.7149, grad_norm=1.219, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6843, grad_norm=1.184, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6843, grad_norm=1.184, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6897, grad_norm=1.040, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6897, grad_norm=1.040, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6788, grad_norm=1.144, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6788, grad_norm=1.144, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.7105, grad_norm=1.253, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.7105, grad_norm=1.253, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6933, grad_norm=0.932, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.6933, grad_norm=0.932, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.6952, grad_norm=1.051, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.6952, grad_norm=1.051, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.6869, grad_norm=1.046, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.53it/s, loss=0.6869, grad_norm=1.046, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.53it/s, loss=0.7095, grad_norm=1.299, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.16it/s, loss=0.7095, grad_norm=1.299, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.16it/s, loss=0.6839, grad_norm=1.552, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6839, grad_norm=1.552, lr=0.000010]

Epoch 1/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6940, Acc: 0.5054, Precision: 0.6000, Recall: 0.0326, F1: 0.0619, AUC: 0.4985
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6912, grad_norm=1.057, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6912, grad_norm=1.057, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6805, grad_norm=1.218, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6805, grad_norm=1.218, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6905, grad_norm=0.918, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6905, grad_norm=0.918, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6988, grad_norm=1.120, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6988, grad_norm=1.120, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6925, grad_norm=0.961, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6925, grad_norm=0.961, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6867, grad_norm=0.964, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.96it/s, loss=0.6867, grad_norm=0.964, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.96it/s, loss=0.7079, grad_norm=1.108, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.81it/s, loss=0.7079, grad_norm=1.108, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.81it/s, loss=0.6982, grad_norm=1.000, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.69it/s, loss=0.6982, grad_norm=1.000, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.69it/s, loss=0.6904, grad_norm=0.953, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.55it/s, loss=0.6904, grad_norm=0.953, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.55it/s, loss=0.6774, grad_norm=1.011, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.34it/s, loss=0.6774, grad_norm=1.011, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.34it/s, loss=0.6979, grad_norm=1.095, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.6979, grad_norm=1.095, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.6766, grad_norm=1.396, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.09it/s, loss=0.6766, grad_norm=1.396, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6907, Acc: 0.5000, Precision: 0.5000, Recall: 0.1848, F1: 0.2698, AUC: 0.5495
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6908, grad_norm=1.112, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.6908, grad_norm=1.112, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.6703, grad_norm=1.306, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6703, grad_norm=1.306, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6871, grad_norm=1.066, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6871, grad_norm=1.066, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6908, grad_norm=1.113, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6908, grad_norm=1.113, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.7039, grad_norm=0.982, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.7039, grad_norm=0.982, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6844, grad_norm=1.292, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6844, grad_norm=1.292, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6862, grad_norm=1.039, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6862, grad_norm=1.039, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6783, grad_norm=1.017, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.85it/s, loss=0.6783, grad_norm=1.017, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.85it/s, loss=0.6902, grad_norm=1.170, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.74it/s, loss=0.6902, grad_norm=1.170, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.74it/s, loss=0.6775, grad_norm=1.098, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.57it/s, loss=0.6775, grad_norm=1.098, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.57it/s, loss=0.6978, grad_norm=1.092, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.23it/s, loss=0.6978, grad_norm=1.092, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.23it/s, loss=0.6835, grad_norm=1.465, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6835, grad_norm=1.465, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6867, Acc: 0.5598, Precision: 0.6667, Recall: 0.2391, F1: 0.3520, AUC: 0.6509
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7060, grad_norm=1.048, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.91s/it, loss=0.7060, grad_norm=1.048, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.91s/it, loss=0.6741, grad_norm=1.026, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6741, grad_norm=1.026, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.7034, grad_norm=1.261, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.7034, grad_norm=1.261, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6823, grad_norm=1.074, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6823, grad_norm=1.074, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6817, grad_norm=1.119, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6817, grad_norm=1.119, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6829, grad_norm=1.206, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6829, grad_norm=1.206, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6662, grad_norm=1.039, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6662, grad_norm=1.039, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6751, grad_norm=1.090, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.87it/s, loss=0.6751, grad_norm=1.090, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.87it/s, loss=0.6738, grad_norm=1.311, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6738, grad_norm=1.311, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6703, grad_norm=1.231, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6703, grad_norm=1.231, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6939, grad_norm=1.150, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.21it/s, loss=0.6939, grad_norm=1.150, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.21it/s, loss=0.6773, grad_norm=1.685, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6773, grad_norm=1.685, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6822, Acc: 0.5707, Precision: 0.6066, Recall: 0.4022, F1: 0.4837, AUC: 0.6766
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6839, grad_norm=1.192, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.92s/it, loss=0.6839, grad_norm=1.192, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.92s/it, loss=0.6997, grad_norm=1.309, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6997, grad_norm=1.309, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6786, grad_norm=1.056, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6786, grad_norm=1.056, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6854, grad_norm=1.278, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6854, grad_norm=1.278, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6808, grad_norm=1.164, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6808, grad_norm=1.164, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6758, grad_norm=1.226, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6758, grad_norm=1.226, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6896, grad_norm=1.325, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6896, grad_norm=1.325, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6783, grad_norm=1.286, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6783, grad_norm=1.286, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6705, grad_norm=1.331, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.6705, grad_norm=1.331, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.6723, grad_norm=1.234, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.54it/s, loss=0.6723, grad_norm=1.234, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.54it/s, loss=0.6870, grad_norm=1.290, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.20it/s, loss=0.6870, grad_norm=1.290, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.20it/s, loss=0.6694, grad_norm=1.779, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6694, grad_norm=1.779, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6809, Acc: 0.6250, Precision: 0.7091, Recall: 0.4239, F1: 0.5306, AUC: 0.6821
------------------------------------------------------------
Training curves saved to model\chb15_fold7\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold7
============================================================
✅ Fold 7 training completed successfully!

============================================================
TRAINING FOLD 8/19
============================================================
Using dataset prefix: chb15_fold8
Loading datasets from: preprocessing\data\chb15_fold8
Saving models to: model\chb15_fold8
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7176, std=2.0127
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6056, 4.1158]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 8): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6928, grad_norm=1.087, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.92s/it, loss=0.6928, grad_norm=1.087, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.92s/it, loss=0.6888, grad_norm=1.005, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6888, grad_norm=1.005, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.7019, grad_norm=1.100, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.7019, grad_norm=1.100, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6978, grad_norm=1.091, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6978, grad_norm=1.091, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6978, grad_norm=1.105, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6978, grad_norm=1.105, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6882, grad_norm=0.908, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6882, grad_norm=0.908, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.7019, grad_norm=0.983, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.7019, grad_norm=0.983, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6928, grad_norm=1.028, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.6928, grad_norm=1.028, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.7030, grad_norm=1.038, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.7030, grad_norm=1.038, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6854, grad_norm=1.262, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.37it/s, loss=0.6854, grad_norm=1.262, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.37it/s, loss=0.6969, grad_norm=0.986, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6969, grad_norm=0.986, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6875, grad_norm=1.389, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6875, grad_norm=1.389, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6945, Acc: 0.4728, Precision: 0.4390, Recall: 0.1957, F1: 0.2707, AUC: 0.4701
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6992, grad_norm=0.905, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.98s/it, loss=0.6992, grad_norm=0.905, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.98s/it, loss=0.6970, grad_norm=1.047, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6970, grad_norm=1.047, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6975, grad_norm=0.917, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6975, grad_norm=0.917, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6946, grad_norm=0.889, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6946, grad_norm=0.889, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6778, grad_norm=0.893, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.6778, grad_norm=0.893, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.6907, grad_norm=0.922, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6907, grad_norm=0.922, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6881, grad_norm=0.918, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.87it/s, loss=0.6881, grad_norm=0.918, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.87it/s, loss=0.6993, grad_norm=0.950, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.6993, grad_norm=0.950, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.7074, grad_norm=0.983, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.7074, grad_norm=0.983, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6895, grad_norm=0.944, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.36it/s, loss=0.6895, grad_norm=0.944, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.36it/s, loss=0.6866, grad_norm=1.042, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.00it/s, loss=0.6866, grad_norm=1.042, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.00it/s, loss=0.6963, grad_norm=1.424, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6963, grad_norm=1.424, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6937, Acc: 0.4457, Precision: 0.4038, Recall: 0.2283, F1: 0.2917, AUC: 0.4894
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6944, grad_norm=0.974, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.6944, grad_norm=0.974, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.6886, grad_norm=0.992, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6886, grad_norm=0.992, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.7001, grad_norm=0.969, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.7001, grad_norm=0.969, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6813, grad_norm=1.071, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6813, grad_norm=1.071, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6825, grad_norm=1.026, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6825, grad_norm=1.026, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6829, grad_norm=0.980, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6829, grad_norm=0.980, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6781, grad_norm=0.949, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6781, grad_norm=0.949, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6775, grad_norm=0.964, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6775, grad_norm=0.964, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6944, grad_norm=1.163, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.62it/s, loss=0.6944, grad_norm=1.163, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.62it/s, loss=0.6926, grad_norm=1.015, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.41it/s, loss=0.6926, grad_norm=1.015, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.41it/s, loss=0.7065, grad_norm=1.105, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.7065, grad_norm=1.105, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.6667, grad_norm=1.422, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.11it/s, loss=0.6667, grad_norm=1.422, lr=0.000010]

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6871, Acc: 0.5815, Precision: 0.6471, Recall: 0.3587, F1: 0.4615, AUC: 0.6089
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6755, grad_norm=1.227, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  4.00s/it, loss=0.6755, grad_norm=1.227, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  4.00s/it, loss=0.6852, grad_norm=1.031, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6852, grad_norm=1.031, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6882, grad_norm=1.143, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6882, grad_norm=1.143, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6777, grad_norm=1.233, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6777, grad_norm=1.233, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6985, grad_norm=1.208, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6985, grad_norm=1.208, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6737, grad_norm=1.038, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6737, grad_norm=1.038, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6970, grad_norm=1.092, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.87it/s, loss=0.6970, grad_norm=1.092, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.87it/s, loss=0.6696, grad_norm=1.078, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6696, grad_norm=1.078, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6868, grad_norm=1.068, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.60it/s, loss=0.6868, grad_norm=1.068, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.60it/s, loss=0.6888, grad_norm=1.177, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6888, grad_norm=1.177, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.42it/s, loss=0.6874, grad_norm=1.054, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6874, grad_norm=1.054, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6845, grad_norm=1.726, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6845, grad_norm=1.726, lr=0.000010]

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6844, Acc: 0.6087, Precision: 0.7632, Recall: 0.3152, F1: 0.4462, AUC: 0.6664
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7087, grad_norm=1.411, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.95s/it, loss=0.7087, grad_norm=1.411, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.95s/it, loss=0.6609, grad_norm=1.348, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6609, grad_norm=1.348, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6712, grad_norm=1.361, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6712, grad_norm=1.361, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6930, grad_norm=1.273, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6930, grad_norm=1.273, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6889, grad_norm=1.493, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6889, grad_norm=1.493, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6670, grad_norm=1.215, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6670, grad_norm=1.215, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6793, grad_norm=1.344, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6793, grad_norm=1.344, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6732, grad_norm=1.263, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6732, grad_norm=1.263, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6871, grad_norm=1.303, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6871, grad_norm=1.303, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6794, grad_norm=1.271, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6794, grad_norm=1.271, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.46it/s, loss=0.6726, grad_norm=1.187, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6726, grad_norm=1.187, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6870, grad_norm=1.844, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6870, grad_norm=1.844, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6807, Acc: 0.6685, Precision: 0.6914, Recall: 0.6087, F1: 0.6474, AUC: 0.7081
------------------------------------------------------------
Training curves saved to model\chb15_fold8\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold8
============================================================
✅ Fold 8 training completed successfully!

============================================================
TRAINING FOLD 9/19
============================================================
Using dataset prefix: chb15_fold9
Loading datasets from: preprocessing\data\chb15_fold9
Saving models to: model\chb15_fold9
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7501, std=1.9955
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6377, 4.1767]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 9): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6970, grad_norm=0.913, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:45,  4.09s/it, loss=0.6970, grad_norm=0.913, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:45,  4.09s/it, loss=0.6937, grad_norm=1.062, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.75s/it, loss=0.6937, grad_norm=1.062, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.75s/it, loss=0.6978, grad_norm=1.041, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:09,  1.00s/it, loss=0.6978, grad_norm=1.041, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:09,  1.00s/it, loss=0.6943, grad_norm=0.921, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.54it/s, loss=0.6943, grad_norm=0.921, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.54it/s, loss=0.6928, grad_norm=0.915, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.20it/s, loss=0.6928, grad_norm=0.915, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.20it/s, loss=0.6840, grad_norm=1.030, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.97it/s, loss=0.6840, grad_norm=1.030, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.97it/s, loss=0.6907, grad_norm=0.881, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.81it/s, loss=0.6907, grad_norm=0.881, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.81it/s, loss=0.7073, grad_norm=1.006, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.69it/s, loss=0.7073, grad_norm=1.006, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.69it/s, loss=0.7065, grad_norm=1.274, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.57it/s, loss=0.7065, grad_norm=1.274, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.57it/s, loss=0.6920, grad_norm=0.916, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6920, grad_norm=0.916, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6857, grad_norm=0.957, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6857, grad_norm=0.957, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.7040, grad_norm=1.393, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.06it/s, loss=0.7040, grad_norm=1.393, lr=0.000010]

Epoch 1/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6955, Acc: 0.4837, Precision: 0.4615, Recall: 0.1957, F1: 0.2748, AUC: 0.4659
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6882, grad_norm=0.933, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6882, grad_norm=0.933, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6983, grad_norm=0.944, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6983, grad_norm=0.944, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6811, grad_norm=0.939, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6811, grad_norm=0.939, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.7026, grad_norm=0.924, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.7026, grad_norm=0.924, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6874, grad_norm=0.893, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6874, grad_norm=0.893, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6902, grad_norm=0.900, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6902, grad_norm=0.900, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6970, grad_norm=0.990, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6970, grad_norm=0.990, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6933, grad_norm=0.929, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.73it/s, loss=0.6933, grad_norm=0.929, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.73it/s, loss=0.6890, grad_norm=0.907, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6890, grad_norm=0.907, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.59it/s, loss=0.6871, grad_norm=0.962, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.38it/s, loss=0.6871, grad_norm=0.962, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.38it/s, loss=0.6983, grad_norm=1.058, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6983, grad_norm=1.058, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6902, grad_norm=1.245, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6902, grad_norm=1.245, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6919, Acc: 0.5326, Precision: 0.5833, Recall: 0.2283, F1: 0.3281, AUC: 0.5241
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6974, grad_norm=1.060, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6974, grad_norm=1.060, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6881, grad_norm=0.992, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6881, grad_norm=0.992, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.7006, grad_norm=0.896, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.7006, grad_norm=0.896, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6909, grad_norm=0.850, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6909, grad_norm=0.850, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6870, grad_norm=0.904, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6870, grad_norm=0.904, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6931, grad_norm=0.900, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6931, grad_norm=0.900, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6816, grad_norm=0.967, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6816, grad_norm=0.967, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6897, grad_norm=0.860, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6897, grad_norm=0.860, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6813, grad_norm=0.906, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6813, grad_norm=0.906, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6856, grad_norm=0.984, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6856, grad_norm=0.984, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.50it/s, loss=0.6793, grad_norm=1.012, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.20it/s, loss=0.6793, grad_norm=1.012, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.20it/s, loss=0.6677, grad_norm=1.345, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6677, grad_norm=1.345, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6869, Acc: 0.5815, Precision: 0.6271, Recall: 0.4022, F1: 0.4901, AUC: 0.6144
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7006, grad_norm=1.142, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.89s/it, loss=0.7006, grad_norm=1.142, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.89s/it, loss=0.6823, grad_norm=0.875, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6823, grad_norm=0.875, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6879, grad_norm=0.901, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6879, grad_norm=0.901, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6852, grad_norm=0.924, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6852, grad_norm=0.924, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6895, grad_norm=0.883, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6895, grad_norm=0.883, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6905, grad_norm=0.895, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6905, grad_norm=0.895, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6914, grad_norm=0.880, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6914, grad_norm=0.880, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6858, grad_norm=0.990, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.6858, grad_norm=0.990, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.6877, grad_norm=0.924, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6877, grad_norm=0.924, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6850, grad_norm=0.925, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.49it/s, loss=0.6850, grad_norm=0.925, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.49it/s, loss=0.6844, grad_norm=0.936, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.15it/s, loss=0.6844, grad_norm=0.936, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.15it/s, loss=0.6796, grad_norm=1.414, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6796, grad_norm=1.414, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6875, Acc: 0.5761, Precision: 0.5833, Recall: 0.5326, F1: 0.5568, AUC: 0.6127
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6695, grad_norm=0.968, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.91s/it, loss=0.6695, grad_norm=0.968, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.91s/it, loss=0.6878, grad_norm=0.910, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6878, grad_norm=0.910, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6883, grad_norm=0.991, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6883, grad_norm=0.991, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6860, grad_norm=0.979, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6860, grad_norm=0.979, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6766, grad_norm=1.034, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6766, grad_norm=1.034, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6704, grad_norm=1.086, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6704, grad_norm=1.086, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6772, grad_norm=0.989, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6772, grad_norm=0.989, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6719, grad_norm=1.125, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6719, grad_norm=1.125, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6769, grad_norm=1.102, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6769, grad_norm=1.102, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6840, grad_norm=1.099, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.35it/s, loss=0.6840, grad_norm=1.099, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6696, grad_norm=1.029, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.02it/s, loss=0.6696, grad_norm=1.029, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.02it/s, loss=0.6637, grad_norm=1.871, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6637, grad_norm=1.871, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6768, Acc: 0.6793, Precision: 0.7391, Recall: 0.5543, F1: 0.6335, AUC: 0.7526
------------------------------------------------------------
Training curves saved to model\chb15_fold9\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold9
============================================================
✅ Fold 9 training completed successfully!

============================================================
TRAINING FOLD 10/19
============================================================
Using dataset prefix: chb15_fold10
Loading datasets from: preprocessing\data\chb15_fold10
Saving models to: model\chb15_fold10
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7736, std=2.0327
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5230, 4.1091]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 10): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6850, grad_norm=1.027, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.05s/it, loss=0.6850, grad_norm=1.027, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.05s/it, loss=0.7065, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.7065, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6960, grad_norm=1.116, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6960, grad_norm=1.116, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6840, grad_norm=1.025, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6840, grad_norm=1.025, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6914, grad_norm=1.039, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6914, grad_norm=1.039, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6717, grad_norm=1.182, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.97it/s, loss=0.6717, grad_norm=1.182, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.97it/s, loss=0.7089, grad_norm=1.134, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.80it/s, loss=0.7089, grad_norm=1.134, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.80it/s, loss=0.6997, grad_norm=1.087, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.68it/s, loss=0.6997, grad_norm=1.087, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.68it/s, loss=0.6942, grad_norm=1.138, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.52it/s, loss=0.6942, grad_norm=1.138, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.52it/s, loss=0.7153, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.29it/s, loss=0.7153, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.29it/s, loss=0.6916, grad_norm=1.094, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.00it/s, loss=0.6916, grad_norm=1.094, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.00it/s, loss=0.6945, grad_norm=1.428, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.07it/s, loss=0.6945, grad_norm=1.428, lr=0.000010]

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6949, Acc: 0.4728, Precision: 0.4419, Recall: 0.2065, F1: 0.2815, AUC: 0.4825
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6932, grad_norm=1.038, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.6932, grad_norm=1.038, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.6802, grad_norm=1.131, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6802, grad_norm=1.131, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6847, grad_norm=1.193, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6847, grad_norm=1.193, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6820, grad_norm=0.946, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6820, grad_norm=0.946, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6802, grad_norm=1.141, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6802, grad_norm=1.141, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6805, grad_norm=0.979, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6805, grad_norm=0.979, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6797, grad_norm=1.026, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.85it/s, loss=0.6797, grad_norm=1.026, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.85it/s, loss=0.7069, grad_norm=1.069, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.7069, grad_norm=1.069, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6874, grad_norm=1.020, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6874, grad_norm=1.020, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.59it/s, loss=0.6944, grad_norm=1.033, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.39it/s, loss=0.6944, grad_norm=1.033, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.39it/s, loss=0.6823, grad_norm=1.007, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6823, grad_norm=1.007, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6945, grad_norm=1.439, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.09it/s, loss=0.6945, grad_norm=1.439, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6872, Acc: 0.5652, Precision: 0.5682, Recall: 0.5435, F1: 0.5556, AUC: 0.6128
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6889, grad_norm=1.073, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.92s/it, loss=0.6889, grad_norm=1.073, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.92s/it, loss=0.7180, grad_norm=1.235, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.7180, grad_norm=1.235, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6748, grad_norm=1.050, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6748, grad_norm=1.050, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6773, grad_norm=1.068, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6773, grad_norm=1.068, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6890, grad_norm=1.019, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6890, grad_norm=1.019, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6848, grad_norm=1.289, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6848, grad_norm=1.289, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6964, grad_norm=1.112, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6964, grad_norm=1.112, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6787, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6787, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6782, grad_norm=1.045, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6782, grad_norm=1.045, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6865, grad_norm=1.165, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.38it/s, loss=0.6865, grad_norm=1.165, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.38it/s, loss=0.6798, grad_norm=1.096, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6798, grad_norm=1.096, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6925, grad_norm=1.692, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6925, grad_norm=1.692, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6871, Acc: 0.5489, Precision: 0.5360, Recall: 0.7283, F1: 0.6175, AUC: 0.5897
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6813, grad_norm=1.091, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6813, grad_norm=1.091, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6779, grad_norm=1.259, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6779, grad_norm=1.259, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6737, grad_norm=1.091, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6737, grad_norm=1.091, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6976, grad_norm=1.208, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6976, grad_norm=1.208, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.7176, grad_norm=1.279, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.7176, grad_norm=1.279, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6801, grad_norm=1.168, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6801, grad_norm=1.168, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.7244, grad_norm=1.682, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.7244, grad_norm=1.682, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6764, grad_norm=1.223, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6764, grad_norm=1.223, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6605, grad_norm=1.028, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6605, grad_norm=1.028, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6643, grad_norm=1.145, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6643, grad_norm=1.145, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6603, grad_norm=1.145, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.11it/s, loss=0.6603, grad_norm=1.145, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.11it/s, loss=0.6787, grad_norm=1.725, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6787, grad_norm=1.725, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6827, Acc: 0.5870, Precision: 0.5667, Recall: 0.7391, F1: 0.6415, AUC: 0.6202
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6559, grad_norm=1.304, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6559, grad_norm=1.304, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6662, grad_norm=1.210, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6662, grad_norm=1.210, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6613, grad_norm=1.202, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6613, grad_norm=1.202, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6884, grad_norm=1.379, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6884, grad_norm=1.379, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6637, grad_norm=1.355, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6637, grad_norm=1.355, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6689, grad_norm=1.356, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6689, grad_norm=1.356, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6682, grad_norm=1.238, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6682, grad_norm=1.238, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6617, grad_norm=1.385, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6617, grad_norm=1.385, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6741, grad_norm=1.385, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6741, grad_norm=1.385, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6656, grad_norm=1.495, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.40it/s, loss=0.6656, grad_norm=1.495, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.40it/s, loss=0.6643, grad_norm=1.397, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.04it/s, loss=0.6643, grad_norm=1.397, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.7097, grad_norm=2.425, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.7097, grad_norm=2.425, lr=0.000010]

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6707, Acc: 0.6685, Precision: 0.6742, Recall: 0.6522, F1: 0.6630, AUC: 0.7233
------------------------------------------------------------
Training curves saved to model\chb15_fold10\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold10
============================================================
✅ Fold 10 training completed successfully!

============================================================
TRAINING FOLD 11/19
============================================================
Using dataset prefix: chb15_fold11
Loading datasets from: preprocessing\data\chb15_fold11
Saving models to: model\chb15_fold11
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7624, std=2.0031
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6102, 4.1539]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 11): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6938, grad_norm=1.058, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.00s/it, loss=0.6938, grad_norm=1.058, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.00s/it, loss=0.6912, grad_norm=0.961, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6912, grad_norm=0.961, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6766, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6766, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6997, grad_norm=1.076, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6997, grad_norm=1.076, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6960, grad_norm=1.075, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6960, grad_norm=1.075, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6931, grad_norm=1.193, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6931, grad_norm=1.193, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6907, grad_norm=1.080, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6907, grad_norm=1.080, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6920, grad_norm=1.156, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6920, grad_norm=1.156, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6910, grad_norm=1.161, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.57it/s, loss=0.6910, grad_norm=1.161, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.57it/s, loss=0.7012, grad_norm=1.304, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.34it/s, loss=0.7012, grad_norm=1.304, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.34it/s, loss=0.6993, grad_norm=1.117, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.02it/s, loss=0.6993, grad_norm=1.117, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.02it/s, loss=0.7062, grad_norm=1.847, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.08it/s, loss=0.7062, grad_norm=1.847, lr=0.000010]

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6942, Acc: 0.4946, Precision: 0.4783, Recall: 0.1196, F1: 0.1913, AUC: 0.4923
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6817, grad_norm=1.159, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.99s/it, loss=0.6817, grad_norm=1.159, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.99s/it, loss=0.6820, grad_norm=1.171, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6820, grad_norm=1.171, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6935, grad_norm=1.155, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6935, grad_norm=1.155, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6827, grad_norm=1.157, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6827, grad_norm=1.157, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6877, grad_norm=1.117, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6877, grad_norm=1.117, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6889, grad_norm=1.170, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6889, grad_norm=1.170, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6909, grad_norm=1.486, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6909, grad_norm=1.486, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6886, grad_norm=1.187, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6886, grad_norm=1.187, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6868, grad_norm=1.247, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.67it/s, loss=0.6868, grad_norm=1.247, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.67it/s, loss=0.6936, grad_norm=1.120, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.47it/s, loss=0.6936, grad_norm=1.120, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.47it/s, loss=0.6842, grad_norm=1.209, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.15it/s, loss=0.6842, grad_norm=1.209, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.15it/s, loss=0.6803, grad_norm=1.555, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6803, grad_norm=1.555, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6867, Acc: 0.5870, Precision: 0.6290, Recall: 0.4239, F1: 0.5065, AUC: 0.6316
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6835, grad_norm=1.109, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.92s/it, loss=0.6835, grad_norm=1.109, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.92s/it, loss=0.6882, grad_norm=1.351, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6882, grad_norm=1.351, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6913, grad_norm=1.281, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6913, grad_norm=1.281, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6889, grad_norm=1.144, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6889, grad_norm=1.144, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6773, grad_norm=1.210, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6773, grad_norm=1.210, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6807, grad_norm=1.140, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6807, grad_norm=1.140, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6807, grad_norm=1.019, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6807, grad_norm=1.019, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6987, grad_norm=1.286, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6987, grad_norm=1.286, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6955, grad_norm=1.407, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.67it/s, loss=0.6955, grad_norm=1.407, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.67it/s, loss=0.6683, grad_norm=1.113, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.39it/s, loss=0.6683, grad_norm=1.113, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.39it/s, loss=0.7010, grad_norm=1.153, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.08it/s, loss=0.7010, grad_norm=1.153, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.08it/s, loss=0.6859, grad_norm=1.545, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6859, grad_norm=1.545, lr=0.000010]

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6867, Acc: 0.5598, Precision: 0.5407, Recall: 0.7935, F1: 0.6432, AUC: 0.6157
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6903, grad_norm=1.305, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6903, grad_norm=1.305, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6704, grad_norm=1.158, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6704, grad_norm=1.158, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6891, grad_norm=1.142, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6891, grad_norm=1.142, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6941, grad_norm=1.214, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6941, grad_norm=1.214, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.7051, grad_norm=1.739, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.7051, grad_norm=1.739, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.7064, grad_norm=1.291, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.7064, grad_norm=1.291, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6895, grad_norm=1.245, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6895, grad_norm=1.245, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6868, grad_norm=1.386, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6868, grad_norm=1.386, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6820, grad_norm=1.074, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6820, grad_norm=1.074, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.7022, grad_norm=1.345, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.44it/s, loss=0.7022, grad_norm=1.345, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.44it/s, loss=0.6739, grad_norm=1.421, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.13it/s, loss=0.6739, grad_norm=1.421, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.13it/s, loss=0.6801, grad_norm=1.685, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6801, grad_norm=1.685, lr=0.000010]

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6892, Acc: 0.5380, Precision: 0.5294, Recall: 0.6848, F1: 0.5972, AUC: 0.5698
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7025, grad_norm=1.277, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.91s/it, loss=0.7025, grad_norm=1.277, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.91s/it, loss=0.6857, grad_norm=1.292, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6857, grad_norm=1.292, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6914, grad_norm=1.324, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6914, grad_norm=1.324, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6825, grad_norm=1.266, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6825, grad_norm=1.266, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6565, grad_norm=1.262, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6565, grad_norm=1.262, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6780, grad_norm=1.442, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6780, grad_norm=1.442, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6779, grad_norm=1.448, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6779, grad_norm=1.448, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6792, grad_norm=1.392, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6792, grad_norm=1.392, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.74it/s, loss=0.6542, grad_norm=1.341, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.58it/s, loss=0.6542, grad_norm=1.341, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.58it/s, loss=0.6763, grad_norm=1.269, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.34it/s, loss=0.6763, grad_norm=1.269, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.34it/s, loss=0.6719, grad_norm=1.416, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.6719, grad_norm=1.416, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.7077, grad_norm=2.142, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.7077, grad_norm=2.142, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6803, Acc: 0.6467, Precision: 0.6337, Recall: 0.6957, F1: 0.6632, AUC: 0.7050
------------------------------------------------------------
Training curves saved to model\chb15_fold11\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold11
============================================================
✅ Fold 11 training completed successfully!

============================================================
TRAINING FOLD 12/19
============================================================
Using dataset prefix: chb15_fold12
Loading datasets from: preprocessing\data\chb15_fold12
Saving models to: model\chb15_fold12
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7965, std=1.9967
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6112, 4.0738]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 12): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6962, grad_norm=1.196, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6962, grad_norm=1.196, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6822, grad_norm=1.270, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6822, grad_norm=1.270, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.7182, grad_norm=1.568, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.7182, grad_norm=1.568, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.7077, grad_norm=1.309, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.7077, grad_norm=1.309, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6848, grad_norm=1.086, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6848, grad_norm=1.086, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6794, grad_norm=1.307, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.00it/s, loss=0.6794, grad_norm=1.307, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.00it/s, loss=0.7023, grad_norm=1.230, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.7023, grad_norm=1.230, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6930, grad_norm=1.325, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.73it/s, loss=0.6930, grad_norm=1.325, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.73it/s, loss=0.7068, grad_norm=1.200, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.7068, grad_norm=1.200, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.59it/s, loss=0.6905, grad_norm=1.193, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6905, grad_norm=1.193, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6893, grad_norm=1.203, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6893, grad_norm=1.203, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6891, grad_norm=1.552, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.08it/s, loss=0.6891, grad_norm=1.552, lr=0.000010]

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6950, Acc: 0.5109, Precision: 0.5833, Recall: 0.0761, F1: 0.1346, AUC: 0.4637
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6855, grad_norm=1.172, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.00s/it, loss=0.6855, grad_norm=1.172, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.00s/it, loss=0.7009, grad_norm=1.218, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.7009, grad_norm=1.218, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6964, grad_norm=1.178, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6964, grad_norm=1.178, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6853, grad_norm=1.198, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6853, grad_norm=1.198, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6795, grad_norm=1.052, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6795, grad_norm=1.052, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6961, grad_norm=1.151, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6961, grad_norm=1.151, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.7036, grad_norm=1.194, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.87it/s, loss=0.7036, grad_norm=1.194, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.87it/s, loss=0.6950, grad_norm=1.153, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6950, grad_norm=1.153, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6798, grad_norm=1.600, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6798, grad_norm=1.600, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6953, grad_norm=1.181, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.44it/s, loss=0.6953, grad_norm=1.181, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.44it/s, loss=0.7017, grad_norm=1.282, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.13it/s, loss=0.7017, grad_norm=1.282, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.13it/s, loss=0.6990, grad_norm=1.692, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6990, grad_norm=1.692, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6932, Acc: 0.5109, Precision: 0.5250, Recall: 0.2283, F1: 0.3182, AUC: 0.5067
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6931, grad_norm=1.060, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.6931, grad_norm=1.060, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.6980, grad_norm=1.270, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6980, grad_norm=1.270, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6914, grad_norm=1.112, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6914, grad_norm=1.112, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6909, grad_norm=1.263, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6909, grad_norm=1.263, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6868, grad_norm=1.076, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6868, grad_norm=1.076, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6863, grad_norm=1.108, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6863, grad_norm=1.108, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6917, grad_norm=1.104, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6917, grad_norm=1.104, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6807, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6807, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6889, grad_norm=1.266, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6889, grad_norm=1.266, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6809, grad_norm=1.178, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6809, grad_norm=1.178, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.46it/s, loss=0.6873, grad_norm=1.159, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6873, grad_norm=1.159, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6839, grad_norm=1.616, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6839, grad_norm=1.616, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6883, Acc: 0.5707, Precision: 0.5844, Recall: 0.4891, F1: 0.5325, AUC: 0.6120
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6969, grad_norm=1.355, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6969, grad_norm=1.355, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6882, grad_norm=1.245, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6882, grad_norm=1.245, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6796, grad_norm=1.053, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6796, grad_norm=1.053, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6821, grad_norm=1.504, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6821, grad_norm=1.504, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6830, grad_norm=1.322, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6830, grad_norm=1.322, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6949, grad_norm=1.493, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6949, grad_norm=1.493, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6779, grad_norm=1.289, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6779, grad_norm=1.289, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6761, grad_norm=1.294, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.87it/s, loss=0.6761, grad_norm=1.294, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.87it/s, loss=0.6989, grad_norm=1.446, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6989, grad_norm=1.446, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6761, grad_norm=1.326, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.44it/s, loss=0.6761, grad_norm=1.326, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.44it/s, loss=0.6915, grad_norm=1.340, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.12it/s, loss=0.6915, grad_norm=1.340, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.6790, grad_norm=1.857, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6790, grad_norm=1.857, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6853, Acc: 0.5924, Precision: 0.6889, Recall: 0.3370, F1: 0.4526, AUC: 0.6707
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6904, grad_norm=1.489, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.07s/it, loss=0.6904, grad_norm=1.489, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.07s/it, loss=0.6956, grad_norm=1.278, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.74s/it, loss=0.6956, grad_norm=1.278, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.74s/it, loss=0.6859, grad_norm=1.312, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.00it/s, loss=0.6859, grad_norm=1.312, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.00it/s, loss=0.6726, grad_norm=1.419, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.55it/s, loss=0.6726, grad_norm=1.419, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.55it/s, loss=0.6854, grad_norm=1.389, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.21it/s, loss=0.6854, grad_norm=1.389, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.21it/s, loss=0.6665, grad_norm=1.381, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.98it/s, loss=0.6665, grad_norm=1.381, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.98it/s, loss=0.6647, grad_norm=1.415, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.83it/s, loss=0.6647, grad_norm=1.415, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.83it/s, loss=0.6797, grad_norm=1.494, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.70it/s, loss=0.6797, grad_norm=1.494, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.70it/s, loss=0.6561, grad_norm=1.462, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.54it/s, loss=0.6561, grad_norm=1.462, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.54it/s, loss=0.6555, grad_norm=1.351, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.29it/s, loss=0.6555, grad_norm=1.351, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.29it/s, loss=0.6706, grad_norm=1.420, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.97it/s, loss=0.6706, grad_norm=1.420, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.97it/s, loss=0.6620, grad_norm=2.165, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.06it/s, loss=0.6620, grad_norm=2.165, lr=0.000010]

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6737, Acc: 0.7337, Precision: 0.8413, Recall: 0.5761, F1: 0.6839, AUC: 0.7983
------------------------------------------------------------
Training curves saved to model\chb15_fold12\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold12
============================================================
✅ Fold 12 training completed successfully!

============================================================
TRAINING FOLD 13/19
============================================================
Using dataset prefix: chb15_fold13
Loading datasets from: preprocessing\data\chb15_fold13
Saving models to: model\chb15_fold13
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7794, std=2.0276
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5339, 4.1209]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 13): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.7097, grad_norm=1.394, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.04s/it, loss=0.7097, grad_norm=1.394, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.04s/it, loss=0.6955, grad_norm=1.157, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6955, grad_norm=1.157, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6936, grad_norm=1.122, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6936, grad_norm=1.122, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6822, grad_norm=1.047, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6822, grad_norm=1.047, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.7082, grad_norm=1.123, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.7082, grad_norm=1.123, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6938, grad_norm=1.080, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6938, grad_norm=1.080, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6909, grad_norm=1.087, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6909, grad_norm=1.087, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.7014, grad_norm=1.220, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.7014, grad_norm=1.220, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6939, grad_norm=1.103, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6939, grad_norm=1.103, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6827, grad_norm=1.044, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.43it/s, loss=0.6827, grad_norm=1.044, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.43it/s, loss=0.6843, grad_norm=1.327, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.6843, grad_norm=1.327, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.7115, grad_norm=1.538, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.09it/s, loss=0.7115, grad_norm=1.538, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6956, Acc: 0.5326, Precision: 0.5268, Recall: 0.6413, F1: 0.5784, AUC: 0.4680
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6895, grad_norm=1.497, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.6895, grad_norm=1.497, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.7024, grad_norm=0.862, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.7024, grad_norm=0.862, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6922, grad_norm=1.079, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6922, grad_norm=1.079, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6870, grad_norm=1.076, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6870, grad_norm=1.076, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6868, grad_norm=1.101, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6868, grad_norm=1.101, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6975, grad_norm=0.981, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.6975, grad_norm=0.981, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.08it/s, loss=0.7010, grad_norm=1.231, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.7010, grad_norm=1.231, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6849, grad_norm=0.992, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.6849, grad_norm=0.992, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.6856, grad_norm=1.007, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6856, grad_norm=1.007, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6932, grad_norm=1.011, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6932, grad_norm=1.011, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.46it/s, loss=0.6853, grad_norm=1.071, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.02it/s, loss=0.6853, grad_norm=1.071, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.02it/s, loss=0.6982, grad_norm=1.450, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6982, grad_norm=1.450, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6920, Acc: 0.5489, Precision: 0.5354, Recall: 0.7391, F1: 0.6210, AUC: 0.5454
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6881, grad_norm=1.016, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.88s/it, loss=0.6881, grad_norm=1.016, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.88s/it, loss=0.6976, grad_norm=1.004, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:03<00:16,  1.66s/it, loss=0.6976, grad_norm=1.004, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.66s/it, loss=0.6970, grad_norm=1.052, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6970, grad_norm=1.052, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.7122, grad_norm=1.242, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.7122, grad_norm=1.242, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.7011, grad_norm=1.063, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.31it/s, loss=0.7011, grad_norm=1.063, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.31it/s, loss=0.6860, grad_norm=1.030, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.11it/s, loss=0.6860, grad_norm=1.030, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.11it/s, loss=0.6902, grad_norm=1.294, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.98it/s, loss=0.6902, grad_norm=1.294, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.98it/s, loss=0.6807, grad_norm=1.152, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6807, grad_norm=1.152, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.86it/s, loss=0.6906, grad_norm=0.988, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.74it/s, loss=0.6906, grad_norm=0.988, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.74it/s, loss=0.6893, grad_norm=1.170, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.38it/s, loss=0.6893, grad_norm=1.170, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.38it/s, loss=0.6884, grad_norm=0.971, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.07it/s, loss=0.6884, grad_norm=0.971, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6966, grad_norm=1.455, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6966, grad_norm=1.455, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6931, Acc: 0.5109, Precision: 0.5100, Recall: 0.5543, F1: 0.5312, AUC: 0.5123
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6943, grad_norm=1.146, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.89s/it, loss=0.6943, grad_norm=1.146, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.89s/it, loss=0.6809, grad_norm=1.066, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6809, grad_norm=1.066, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6756, grad_norm=1.055, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6756, grad_norm=1.055, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6945, grad_norm=1.081, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6945, grad_norm=1.081, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6816, grad_norm=1.081, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6816, grad_norm=1.081, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6871, grad_norm=1.036, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6871, grad_norm=1.036, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6948, grad_norm=1.005, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6948, grad_norm=1.005, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6870, grad_norm=1.097, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6870, grad_norm=1.097, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6809, grad_norm=1.024, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6809, grad_norm=1.024, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6888, grad_norm=1.353, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.39it/s, loss=0.6888, grad_norm=1.353, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.39it/s, loss=0.6820, grad_norm=1.064, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.04it/s, loss=0.6820, grad_norm=1.064, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.04it/s, loss=0.6939, grad_norm=1.210, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6939, grad_norm=1.210, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6868, Acc: 0.5489, Precision: 0.5738, Recall: 0.3804, F1: 0.4575, AUC: 0.6135
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6995, grad_norm=1.100, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6995, grad_norm=1.100, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6932, grad_norm=0.973, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6932, grad_norm=0.973, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6871, grad_norm=1.081, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6871, grad_norm=1.081, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6925, grad_norm=0.999, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6925, grad_norm=0.999, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6738, grad_norm=1.021, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6738, grad_norm=1.021, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6827, grad_norm=1.135, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6827, grad_norm=1.135, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6783, grad_norm=1.062, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6783, grad_norm=1.062, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6887, grad_norm=1.382, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6887, grad_norm=1.382, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6902, grad_norm=1.104, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.56it/s, loss=0.6902, grad_norm=1.104, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.56it/s, loss=0.6763, grad_norm=1.147, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.36it/s, loss=0.6763, grad_norm=1.147, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.36it/s, loss=0.6893, grad_norm=1.096, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.05it/s, loss=0.6893, grad_norm=1.096, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.05it/s, loss=0.6809, grad_norm=1.405, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6809, grad_norm=1.405, lr=0.000010]

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6860, Acc: 0.5707, Precision: 0.5765, Recall: 0.5326, F1: 0.5537, AUC: 0.6339
------------------------------------------------------------
Training curves saved to model\chb15_fold13\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold13
============================================================
✅ Fold 13 training completed successfully!

============================================================
TRAINING FOLD 14/19
============================================================
Using dataset prefix: chb15_fold14
Loading datasets from: preprocessing\data\chb15_fold14
Saving models to: model\chb15_fold14
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7768, std=1.9970
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6200, 4.0738]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 14): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6898, grad_norm=1.128, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.05s/it, loss=0.6898, grad_norm=1.128, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.05s/it, loss=0.6980, grad_norm=1.113, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6980, grad_norm=1.113, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.7004, grad_norm=1.269, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.7004, grad_norm=1.269, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6901, grad_norm=1.048, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.55it/s, loss=0.6901, grad_norm=1.048, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.55it/s, loss=0.6902, grad_norm=1.053, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.21it/s, loss=0.6902, grad_norm=1.053, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.21it/s, loss=0.6853, grad_norm=1.140, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.97it/s, loss=0.6853, grad_norm=1.140, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  2.97it/s, loss=0.6985, grad_norm=1.116, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.80it/s, loss=0.6985, grad_norm=1.116, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.80it/s, loss=0.6949, grad_norm=1.154, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.68it/s, loss=0.6949, grad_norm=1.154, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.68it/s, loss=0.7074, grad_norm=1.133, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.53it/s, loss=0.7074, grad_norm=1.133, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.53it/s, loss=0.6952, grad_norm=1.115, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.33it/s, loss=0.6952, grad_norm=1.115, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.33it/s, loss=0.6980, grad_norm=1.106, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6980, grad_norm=1.106, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6921, grad_norm=1.480, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.07it/s, loss=0.6921, grad_norm=1.480, lr=0.000010]

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6950, Acc: 0.4946, Precision: 0.4935, Recall: 0.4130, F1: 0.4497, AUC: 0.4712
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6893, grad_norm=1.121, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.6893, grad_norm=1.121, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.6809, grad_norm=1.111, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6809, grad_norm=1.111, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6803, grad_norm=1.466, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6803, grad_norm=1.466, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6918, grad_norm=1.076, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6918, grad_norm=1.076, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.7020, grad_norm=1.069, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.7020, grad_norm=1.069, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6772, grad_norm=1.005, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  3.00it/s, loss=0.6772, grad_norm=1.005, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  3.00it/s, loss=0.7008, grad_norm=1.085, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.84it/s, loss=0.7008, grad_norm=1.085, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.84it/s, loss=0.6985, grad_norm=1.199, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6985, grad_norm=1.199, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6885, grad_norm=1.046, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6885, grad_norm=1.046, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.59it/s, loss=0.6824, grad_norm=1.114, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.37it/s, loss=0.6824, grad_norm=1.114, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.37it/s, loss=0.6806, grad_norm=1.100, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.08it/s, loss=0.6806, grad_norm=1.100, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.08it/s, loss=0.6844, grad_norm=1.610, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.09it/s, loss=0.6844, grad_norm=1.610, lr=0.000010]

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6881, Acc: 0.5761, Precision: 0.6167, Recall: 0.4022, F1: 0.4868, AUC: 0.6154
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6798, grad_norm=1.159, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.6798, grad_norm=1.159, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.6937, grad_norm=1.133, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6937, grad_norm=1.133, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6846, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6846, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6905, grad_norm=1.089, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6905, grad_norm=1.089, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6784, grad_norm=1.267, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6784, grad_norm=1.267, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6847, grad_norm=1.131, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6847, grad_norm=1.131, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6768, grad_norm=1.101, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6768, grad_norm=1.101, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6949, grad_norm=1.125, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6949, grad_norm=1.125, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6822, grad_norm=1.097, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.6822, grad_norm=1.097, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.7122, grad_norm=1.437, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.40it/s, loss=0.7122, grad_norm=1.437, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.40it/s, loss=0.6667, grad_norm=1.189, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6667, grad_norm=1.189, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.7041, grad_norm=1.995, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.7041, grad_norm=1.995, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6874, Acc: 0.5435, Precision: 0.5714, Recall: 0.3478, F1: 0.4324, AUC: 0.6081
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6735, grad_norm=1.146, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6735, grad_norm=1.146, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6954, grad_norm=1.462, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6954, grad_norm=1.462, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6921, grad_norm=1.153, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6921, grad_norm=1.153, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6918, grad_norm=1.174, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6918, grad_norm=1.174, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6833, grad_norm=1.224, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6833, grad_norm=1.224, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6989, grad_norm=1.275, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6989, grad_norm=1.275, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6963, grad_norm=1.204, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6963, grad_norm=1.204, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.7010, grad_norm=1.630, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.82it/s, loss=0.7010, grad_norm=1.630, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.82it/s, loss=0.6756, grad_norm=1.233, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.68it/s, loss=0.6756, grad_norm=1.233, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.68it/s, loss=0.6742, grad_norm=1.197, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6742, grad_norm=1.197, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6715, grad_norm=1.142, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.11it/s, loss=0.6715, grad_norm=1.142, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.11it/s, loss=0.6809, grad_norm=1.773, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6809, grad_norm=1.773, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6862, Acc: 0.5707, Precision: 0.5670, Recall: 0.5978, F1: 0.5820, AUC: 0.5900
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6832, grad_norm=1.422, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6832, grad_norm=1.422, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6881, grad_norm=1.184, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6881, grad_norm=1.184, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6871, grad_norm=1.208, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6871, grad_norm=1.208, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6691, grad_norm=1.193, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6691, grad_norm=1.193, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6583, grad_norm=1.236, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6583, grad_norm=1.236, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6771, grad_norm=1.289, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6771, grad_norm=1.289, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6715, grad_norm=1.425, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6715, grad_norm=1.425, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6860, grad_norm=1.339, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6860, grad_norm=1.339, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6732, grad_norm=1.198, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6732, grad_norm=1.198, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6941, grad_norm=1.440, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.41it/s, loss=0.6941, grad_norm=1.440, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.41it/s, loss=0.6637, grad_norm=1.372, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6637, grad_norm=1.372, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6927, grad_norm=2.343, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.09it/s, loss=0.6927, grad_norm=2.343, lr=0.000010]

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6787, Acc: 0.6413, Precision: 0.6204, Recall: 0.7283, F1: 0.6700, AUC: 0.6873
------------------------------------------------------------
Training curves saved to model\chb15_fold14\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold14
============================================================
✅ Fold 14 training completed successfully!

============================================================
TRAINING FOLD 15/19
============================================================
Using dataset prefix: chb15_fold15
Loading datasets from: preprocessing\data\chb15_fold15
Saving models to: model\chb15_fold15
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7394, std=2.0055
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6150, 4.1477]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 15): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6891, grad_norm=1.120, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.95s/it, loss=0.6891, grad_norm=1.120, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.95s/it, loss=0.7050, grad_norm=1.285, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.7050, grad_norm=1.285, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.7000, grad_norm=1.118, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.7000, grad_norm=1.118, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6983, grad_norm=1.163, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6983, grad_norm=1.163, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6868, grad_norm=1.291, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6868, grad_norm=1.291, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6920, grad_norm=0.994, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6920, grad_norm=0.994, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6894, grad_norm=1.122, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6894, grad_norm=1.122, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6842, grad_norm=1.197, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6842, grad_norm=1.197, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6952, grad_norm=1.251, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6952, grad_norm=1.251, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.72it/s, loss=0.6832, grad_norm=1.062, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.52it/s, loss=0.6832, grad_norm=1.062, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.52it/s, loss=0.6817, grad_norm=1.068, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.15it/s, loss=0.6817, grad_norm=1.068, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.15it/s, loss=0.7273, grad_norm=2.006, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.7273, grad_norm=2.006, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6943, Acc: 0.4837, Precision: 0.4776, Recall: 0.3478, F1: 0.4025, AUC: 0.5151
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6637, grad_norm=1.316, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6637, grad_norm=1.316, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6894, grad_norm=1.150, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:03<00:16,  1.66s/it, loss=0.6894, grad_norm=1.150, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.66s/it, loss=0.6889, grad_norm=1.239, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6889, grad_norm=1.239, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6856, grad_norm=1.262, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6856, grad_norm=1.262, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6984, grad_norm=1.097, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.31it/s, loss=0.6984, grad_norm=1.097, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.31it/s, loss=0.6956, grad_norm=1.223, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.12it/s, loss=0.6956, grad_norm=1.223, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.12it/s, loss=0.6972, grad_norm=1.138, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.99it/s, loss=0.6972, grad_norm=1.138, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.99it/s, loss=0.6998, grad_norm=1.080, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.90it/s, loss=0.6998, grad_norm=1.080, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.90it/s, loss=0.6892, grad_norm=1.316, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.76it/s, loss=0.6892, grad_norm=1.316, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.76it/s, loss=0.6842, grad_norm=1.149, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.54it/s, loss=0.6842, grad_norm=1.149, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.54it/s, loss=0.6976, grad_norm=1.741, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.17it/s, loss=0.6976, grad_norm=1.741, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.17it/s, loss=0.6953, grad_norm=1.603, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6953, grad_norm=1.603, lr=0.000010]

Epoch 2/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6904, Acc: 0.5163, Precision: 0.5600, Recall: 0.1522, F1: 0.2393, AUC: 0.5685
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6764, grad_norm=1.118, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.91s/it, loss=0.6764, grad_norm=1.118, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.91s/it, loss=0.6861, grad_norm=1.424, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6861, grad_norm=1.424, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6749, grad_norm=1.199, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6749, grad_norm=1.199, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6877, grad_norm=1.080, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6877, grad_norm=1.080, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6969, grad_norm=1.369, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6969, grad_norm=1.369, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6889, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6889, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.10it/s, loss=0.6941, grad_norm=1.184, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.97it/s, loss=0.6941, grad_norm=1.184, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.97it/s, loss=0.7005, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.7005, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.7044, grad_norm=1.445, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.7044, grad_norm=1.445, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.6777, grad_norm=1.013, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.45it/s, loss=0.6777, grad_norm=1.013, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.45it/s, loss=0.6875, grad_norm=1.125, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.07it/s, loss=0.6875, grad_norm=1.125, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6810, grad_norm=1.778, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6810, grad_norm=1.778, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6880, Acc: 0.5761, Precision: 0.6129, Recall: 0.4130, F1: 0.4935, AUC: 0.6086
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6873, grad_norm=1.223, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6873, grad_norm=1.223, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6844, grad_norm=1.154, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6844, grad_norm=1.154, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6886, grad_norm=1.111, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6886, grad_norm=1.111, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6736, grad_norm=1.094, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6736, grad_norm=1.094, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6895, grad_norm=1.202, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6895, grad_norm=1.202, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6701, grad_norm=1.069, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6701, grad_norm=1.069, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6941, grad_norm=1.183, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6941, grad_norm=1.183, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.86it/s, loss=0.6813, grad_norm=1.392, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.73it/s, loss=0.6813, grad_norm=1.392, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.73it/s, loss=0.6964, grad_norm=1.472, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6964, grad_norm=1.472, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.59it/s, loss=0.6895, grad_norm=1.233, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.34it/s, loss=0.6895, grad_norm=1.233, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.34it/s, loss=0.6763, grad_norm=1.151, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.03it/s, loss=0.6763, grad_norm=1.151, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.03it/s, loss=0.6686, grad_norm=1.755, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.09it/s, loss=0.6686, grad_norm=1.755, lr=0.000010]

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6833, Acc: 0.5978, Precision: 0.6047, Recall: 0.5652, F1: 0.5843, AUC: 0.6614
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6841, grad_norm=1.223, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.6841, grad_norm=1.223, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.6699, grad_norm=1.240, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6699, grad_norm=1.240, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6692, grad_norm=1.195, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6692, grad_norm=1.195, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6860, grad_norm=1.202, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6860, grad_norm=1.202, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.59it/s, loss=0.6709, grad_norm=1.231, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6709, grad_norm=1.231, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.27it/s, loss=0.6730, grad_norm=1.326, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6730, grad_norm=1.326, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6817, grad_norm=1.513, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6817, grad_norm=1.513, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6693, grad_norm=1.402, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6693, grad_norm=1.402, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6726, grad_norm=1.399, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6726, grad_norm=1.399, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6699, grad_norm=1.556, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6699, grad_norm=1.556, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.42it/s, loss=0.6728, grad_norm=1.519, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.6728, grad_norm=1.519, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.07it/s, loss=0.7105, grad_norm=2.425, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.7105, grad_norm=2.425, lr=0.000010]

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6775, Acc: 0.6685, Precision: 0.6476, Recall: 0.7391, F1: 0.6904, AUC: 0.7287
------------------------------------------------------------
Training curves saved to model\chb15_fold15\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold15
============================================================
✅ Fold 15 training completed successfully!

============================================================
TRAINING FOLD 16/19
============================================================
Using dataset prefix: chb15_fold16
Loading datasets from: preprocessing\data\chb15_fold16
Saving models to: model\chb15_fold16
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7461, std=2.0041
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6154, 4.1560]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 16): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.7077, grad_norm=1.221, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.7077, grad_norm=1.221, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6877, grad_norm=1.225, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6877, grad_norm=1.225, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6916, grad_norm=1.185, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6916, grad_norm=1.185, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6975, grad_norm=1.649, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6975, grad_norm=1.649, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6947, grad_norm=1.151, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6947, grad_norm=1.151, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6969, grad_norm=1.194, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6969, grad_norm=1.194, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.02it/s, loss=0.6870, grad_norm=1.167, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.6870, grad_norm=1.167, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.89it/s, loss=0.7105, grad_norm=1.578, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.7105, grad_norm=1.578, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.7138, grad_norm=1.249, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.7138, grad_norm=1.249, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.61it/s, loss=0.6866, grad_norm=1.164, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.39it/s, loss=0.6866, grad_norm=1.164, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.39it/s, loss=0.6954, grad_norm=1.173, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6954, grad_norm=1.173, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6886, grad_norm=1.609, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.09it/s, loss=0.6886, grad_norm=1.609, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6965, Acc: 0.5272, Precision: 0.5207, Recall: 0.6848, F1: 0.5915, AUC: 0.4527
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6916, grad_norm=1.255, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6916, grad_norm=1.255, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6733, grad_norm=1.387, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6733, grad_norm=1.387, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6921, grad_norm=0.999, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6921, grad_norm=0.999, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6799, grad_norm=1.245, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6799, grad_norm=1.245, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6918, grad_norm=1.201, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6918, grad_norm=1.201, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6872, grad_norm=1.234, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6872, grad_norm=1.234, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6911, grad_norm=1.143, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6911, grad_norm=1.143, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.95it/s, loss=0.6968, grad_norm=1.288, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.82it/s, loss=0.6968, grad_norm=1.288, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.82it/s, loss=0.6848, grad_norm=1.221, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.68it/s, loss=0.6848, grad_norm=1.221, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.68it/s, loss=0.6801, grad_norm=1.205, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.44it/s, loss=0.6801, grad_norm=1.205, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.44it/s, loss=0.7071, grad_norm=1.333, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.10it/s, loss=0.7071, grad_norm=1.333, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.7088, grad_norm=1.889, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.7088, grad_norm=1.889, lr=0.000010]

Epoch 2/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6904, Acc: 0.5489, Precision: 0.5484, Recall: 0.5543, F1: 0.5514, AUC: 0.5816
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6934, grad_norm=1.235, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.89s/it, loss=0.6934, grad_norm=1.235, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.89s/it, loss=0.6901, grad_norm=1.308, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6901, grad_norm=1.308, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6948, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6948, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6989, grad_norm=1.174, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6989, grad_norm=1.174, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6864, grad_norm=1.023, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6864, grad_norm=1.023, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6835, grad_norm=1.170, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6835, grad_norm=1.170, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6730, grad_norm=1.208, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6730, grad_norm=1.208, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6809, grad_norm=1.124, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.6809, grad_norm=1.124, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.76it/s, loss=0.6909, grad_norm=1.371, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6909, grad_norm=1.371, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6844, grad_norm=1.253, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.43it/s, loss=0.6844, grad_norm=1.253, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.43it/s, loss=0.6852, grad_norm=1.131, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.6852, grad_norm=1.131, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.10it/s, loss=0.6873, grad_norm=1.669, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6873, grad_norm=1.669, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6874, Acc: 0.5924, Precision: 0.6133, Recall: 0.5000, F1: 0.5509, AUC: 0.6205
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6871, grad_norm=1.059, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6871, grad_norm=1.059, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.02s/it, loss=0.6850, grad_norm=1.494, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6850, grad_norm=1.494, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.7057, grad_norm=1.271, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.7057, grad_norm=1.271, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6821, grad_norm=1.409, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6821, grad_norm=1.409, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6860, grad_norm=1.223, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.22it/s, loss=0.6860, grad_norm=1.223, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.22it/s, loss=0.6781, grad_norm=1.255, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  3.00it/s, loss=0.6781, grad_norm=1.255, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  3.00it/s, loss=0.6813, grad_norm=1.432, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.85it/s, loss=0.6813, grad_norm=1.432, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.85it/s, loss=0.6717, grad_norm=1.303, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6717, grad_norm=1.303, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.72it/s, loss=0.6960, grad_norm=1.250, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.56it/s, loss=0.6960, grad_norm=1.250, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.56it/s, loss=0.6825, grad_norm=1.420, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.34it/s, loss=0.6825, grad_norm=1.420, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.34it/s, loss=0.6869, grad_norm=1.291, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.03it/s, loss=0.6869, grad_norm=1.291, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.03it/s, loss=0.6780, grad_norm=1.853, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.08it/s, loss=0.6780, grad_norm=1.853, lr=0.000010]

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6850, Acc: 0.5978, Precision: 0.6023, Recall: 0.5761, F1: 0.5889, AUC: 0.6300
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6749, grad_norm=1.408, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6749, grad_norm=1.408, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6835, grad_norm=1.125, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:03<00:16,  1.66s/it, loss=0.6835, grad_norm=1.125, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.66s/it, loss=0.6716, grad_norm=1.274, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6716, grad_norm=1.274, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6640, grad_norm=1.257, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6640, grad_norm=1.257, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6827, grad_norm=1.347, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6827, grad_norm=1.347, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6824, grad_norm=1.360, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6824, grad_norm=1.360, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6983, grad_norm=1.409, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6983, grad_norm=1.409, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6721, grad_norm=1.353, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.6721, grad_norm=1.353, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.84it/s, loss=0.6729, grad_norm=1.629, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.6729, grad_norm=1.629, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.71it/s, loss=0.6847, grad_norm=1.331, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.49it/s, loss=0.6847, grad_norm=1.331, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.49it/s, loss=0.6612, grad_norm=1.427, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.13it/s, loss=0.6612, grad_norm=1.427, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.13it/s, loss=0.6666, grad_norm=2.190, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6666, grad_norm=2.190, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6762, Acc: 0.7011, Precision: 0.7033, Recall: 0.6957, F1: 0.6995, AUC: 0.7522
------------------------------------------------------------
Training curves saved to model\chb15_fold16\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold16
============================================================
✅ Fold 16 training completed successfully!

============================================================
TRAINING FOLD 17/19
============================================================
Using dataset prefix: chb15_fold17
Loading datasets from: preprocessing\data\chb15_fold17
Saving models to: model\chb15_fold17
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7200, std=2.0018
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6350, 4.1395]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 17): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7013, grad_norm=1.673, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.7013, grad_norm=1.673, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.6929, grad_norm=1.135, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6929, grad_norm=1.135, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6887, grad_norm=1.423, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.6887, grad_norm=1.423, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.03it/s, loss=0.7069, grad_norm=1.265, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.7069, grad_norm=1.265, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6904, grad_norm=1.149, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6904, grad_norm=1.149, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6937, grad_norm=1.099, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.6937, grad_norm=1.099, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.06it/s, loss=0.7278, grad_norm=1.633, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.7278, grad_norm=1.633, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.7322, grad_norm=1.655, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.82it/s, loss=0.7322, grad_norm=1.655, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.82it/s, loss=0.6924, grad_norm=1.172, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6924, grad_norm=1.172, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.7031, grad_norm=1.267, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.52it/s, loss=0.7031, grad_norm=1.267, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.52it/s, loss=0.6831, grad_norm=1.339, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.19it/s, loss=0.6831, grad_norm=1.339, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.19it/s, loss=0.6733, grad_norm=1.432, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6733, grad_norm=1.432, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6988, Acc: 0.4674, Precision: 0.4826, Recall: 0.9022, F1: 0.6288, AUC: 0.3946
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6829, grad_norm=1.181, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6829, grad_norm=1.181, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6886, grad_norm=1.169, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:03<00:16,  1.66s/it, loss=0.6886, grad_norm=1.169, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.66s/it, loss=0.7017, grad_norm=1.150, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.7017, grad_norm=1.150, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.7019, grad_norm=1.120, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.7019, grad_norm=1.120, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6867, grad_norm=1.077, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6867, grad_norm=1.077, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6880, grad_norm=1.119, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6880, grad_norm=1.119, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6989, grad_norm=1.133, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6989, grad_norm=1.133, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.96it/s, loss=0.6907, grad_norm=1.194, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.85it/s, loss=0.6907, grad_norm=1.194, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.85it/s, loss=0.7001, grad_norm=1.173, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.73it/s, loss=0.7001, grad_norm=1.173, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.73it/s, loss=0.7134, grad_norm=1.720, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.55it/s, loss=0.7134, grad_norm=1.720, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.55it/s, loss=0.6830, grad_norm=1.090, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.21it/s, loss=0.6830, grad_norm=1.090, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.21it/s, loss=0.6698, grad_norm=1.644, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6698, grad_norm=1.644, lr=0.000010]

Epoch 2/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6921, Acc: 0.5054, Precision: 0.5031, Recall: 0.8913, F1: 0.6431, AUC: 0.5214
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6976, grad_norm=1.136, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.89s/it, loss=0.6976, grad_norm=1.136, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.89s/it, loss=0.6757, grad_norm=1.188, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6757, grad_norm=1.188, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6916, grad_norm=1.210, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6916, grad_norm=1.210, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6900, grad_norm=1.106, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6900, grad_norm=1.106, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6849, grad_norm=1.163, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6849, grad_norm=1.163, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6937, grad_norm=1.258, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6937, grad_norm=1.258, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6845, grad_norm=1.064, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6845, grad_norm=1.064, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.92it/s, loss=0.6806, grad_norm=1.103, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6806, grad_norm=1.103, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6952, grad_norm=1.163, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6952, grad_norm=1.163, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6756, grad_norm=1.077, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.41it/s, loss=0.6756, grad_norm=1.077, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.41it/s, loss=0.6827, grad_norm=1.120, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.14it/s, loss=0.6827, grad_norm=1.120, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.14it/s, loss=0.6759, grad_norm=1.517, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6759, grad_norm=1.517, lr=0.000010]

Epoch 3/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6857, Acc: 0.5870, Precision: 0.5625, Recall: 0.7826, F1: 0.6545, AUC: 0.6474
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6813, grad_norm=1.129, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6813, grad_norm=1.129, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6912, grad_norm=1.098, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6912, grad_norm=1.098, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6802, grad_norm=1.208, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6802, grad_norm=1.208, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6826, grad_norm=1.204, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6826, grad_norm=1.204, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.7001, grad_norm=1.150, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.7001, grad_norm=1.150, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6876, grad_norm=1.294, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6876, grad_norm=1.294, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.04it/s, loss=0.6761, grad_norm=1.077, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6761, grad_norm=1.077, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.90it/s, loss=0.6890, grad_norm=1.195, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6890, grad_norm=1.195, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.78it/s, loss=0.6689, grad_norm=1.158, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.6689, grad_norm=1.158, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.6827, grad_norm=1.405, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.45it/s, loss=0.6827, grad_norm=1.405, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.45it/s, loss=0.7040, grad_norm=1.262, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.13it/s, loss=0.7040, grad_norm=1.262, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.13it/s, loss=0.6836, grad_norm=1.837, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.12it/s, loss=0.6836, grad_norm=1.837, lr=0.000010]

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6856, Acc: 0.5598, Precision: 0.5579, Recall: 0.5761, F1: 0.5668, AUC: 0.6049
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7050, grad_norm=1.354, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.99s/it, loss=0.7050, grad_norm=1.354, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.99s/it, loss=0.6625, grad_norm=1.120, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6625, grad_norm=1.120, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6672, grad_norm=1.102, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6672, grad_norm=1.102, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6904, grad_norm=1.380, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6904, grad_norm=1.380, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6751, grad_norm=1.132, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6751, grad_norm=1.132, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6567, grad_norm=1.231, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6567, grad_norm=1.231, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6994, grad_norm=1.445, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.87it/s, loss=0.6994, grad_norm=1.445, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.87it/s, loss=0.6737, grad_norm=1.336, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.6737, grad_norm=1.336, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.6677, grad_norm=1.246, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6677, grad_norm=1.246, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6744, grad_norm=1.285, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6744, grad_norm=1.285, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.42it/s, loss=0.6486, grad_norm=1.311, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6486, grad_norm=1.311, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6637, grad_norm=1.939, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6637, grad_norm=1.939, lr=0.000010]

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6737, Acc: 0.6630, Precision: 0.6974, Recall: 0.5761, F1: 0.6310, AUC: 0.7289
------------------------------------------------------------
Training curves saved to model\chb15_fold17\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold17
============================================================
✅ Fold 17 training completed successfully!

============================================================
TRAINING FOLD 18/19
============================================================
Using dataset prefix: chb15_fold18
Loading datasets from: preprocessing\data\chb15_fold18
Saving models to: model\chb15_fold18
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7434, std=1.9952
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6419, 4.1401]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 18): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6784, grad_norm=1.440, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.6784, grad_norm=1.440, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.7013, grad_norm=1.008, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.7013, grad_norm=1.008, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6949, grad_norm=0.988, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6949, grad_norm=0.988, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.7139, grad_norm=1.521, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.7139, grad_norm=1.521, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6951, grad_norm=1.073, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6951, grad_norm=1.073, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6944, grad_norm=1.102, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6944, grad_norm=1.102, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6868, grad_norm=1.102, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6868, grad_norm=1.102, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6925, grad_norm=1.075, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6925, grad_norm=1.075, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.77it/s, loss=0.6933, grad_norm=1.033, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6933, grad_norm=1.033, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.63it/s, loss=0.6858, grad_norm=1.130, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.40it/s, loss=0.6858, grad_norm=1.130, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.40it/s, loss=0.6793, grad_norm=1.020, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6793, grad_norm=1.020, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.06it/s, loss=0.6665, grad_norm=1.934, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.10it/s, loss=0.6665, grad_norm=1.934, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6902, Acc: 0.5109, Precision: 0.5060, Recall: 0.9130, F1: 0.6512, AUC: 0.5638
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6846, grad_norm=1.053, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.6846, grad_norm=1.053, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.01s/it, loss=0.7244, grad_norm=1.214, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.7244, grad_norm=1.214, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.72s/it, loss=0.6934, grad_norm=1.075, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6934, grad_norm=1.075, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6886, grad_norm=1.051, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.6886, grad_norm=1.051, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.57it/s, loss=0.7039, grad_norm=0.978, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.7039, grad_norm=0.978, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.24it/s, loss=0.6761, grad_norm=1.130, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6761, grad_norm=1.130, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6923, grad_norm=0.940, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6923, grad_norm=0.940, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6967, grad_norm=1.064, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.6967, grad_norm=1.064, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.6853, grad_norm=1.166, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6853, grad_norm=1.166, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.7006, grad_norm=1.020, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.37it/s, loss=0.7006, grad_norm=1.020, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.37it/s, loss=0.6856, grad_norm=1.030, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.99it/s, loss=0.6856, grad_norm=1.030, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  6.99it/s, loss=0.6714, grad_norm=1.555, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.08it/s, loss=0.6714, grad_norm=1.555, lr=0.000010]

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6919, Acc: 0.5435, Precision: 0.5278, Recall: 0.8261, F1: 0.6441, AUC: 0.5276
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6932, grad_norm=0.936, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.6932, grad_norm=0.936, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.03s/it, loss=0.6862, grad_norm=1.120, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6862, grad_norm=1.120, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6962, grad_norm=1.019, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6962, grad_norm=1.019, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6828, grad_norm=1.027, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6828, grad_norm=1.027, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6915, grad_norm=1.026, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6915, grad_norm=1.026, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6898, grad_norm=0.944, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6898, grad_norm=0.944, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.01it/s, loss=0.6844, grad_norm=0.958, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6844, grad_norm=0.958, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6782, grad_norm=1.084, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.6782, grad_norm=1.084, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.75it/s, loss=0.6837, grad_norm=1.021, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.59it/s, loss=0.6837, grad_norm=1.021, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.59it/s, loss=0.6938, grad_norm=1.008, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.33it/s, loss=0.6938, grad_norm=1.008, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.33it/s, loss=0.6963, grad_norm=1.135, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.00it/s, loss=0.6963, grad_norm=1.135, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.00it/s, loss=0.6586, grad_norm=1.744, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.08it/s, loss=0.6586, grad_norm=1.744, lr=0.000010]

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6862, Acc: 0.5707, Precision: 0.5474, Recall: 0.8152, F1: 0.6550, AUC: 0.6158
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6712, grad_norm=1.021, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.94s/it, loss=0.6712, grad_norm=1.021, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.94s/it, loss=0.6905, grad_norm=1.068, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6905, grad_norm=1.068, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.69s/it, loss=0.6931, grad_norm=0.900, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6931, grad_norm=0.900, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6888, grad_norm=1.100, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6888, grad_norm=1.100, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.60it/s, loss=0.6843, grad_norm=1.053, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6843, grad_norm=1.053, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.26it/s, loss=0.6982, grad_norm=1.133, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6982, grad_norm=1.133, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.05it/s, loss=0.6776, grad_norm=1.266, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6776, grad_norm=1.266, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.91it/s, loss=0.6859, grad_norm=1.040, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6859, grad_norm=1.040, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6836, grad_norm=1.072, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6836, grad_norm=1.072, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.70it/s, loss=0.6773, grad_norm=1.191, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.43it/s, loss=0.6773, grad_norm=1.191, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.43it/s, loss=0.6677, grad_norm=1.143, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6677, grad_norm=1.143, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.09it/s, loss=0.6784, grad_norm=1.646, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6784, grad_norm=1.646, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6830, Acc: 0.5924, Precision: 0.5603, Recall: 0.8587, F1: 0.6781, AUC: 0.6569
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.7104, grad_norm=1.476, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  3.93s/it, loss=0.7104, grad_norm=1.476, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  3.93s/it, loss=0.6831, grad_norm=1.184, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6831, grad_norm=1.184, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.68s/it, loss=0.6896, grad_norm=1.228, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6896, grad_norm=1.228, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6640, grad_norm=1.367, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6640, grad_norm=1.367, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6886, grad_norm=1.129, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6886, grad_norm=1.129, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.7052, grad_norm=1.185, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.7052, grad_norm=1.185, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6602, grad_norm=1.284, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6602, grad_norm=1.284, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6821, grad_norm=1.197, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6821, grad_norm=1.197, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6853, grad_norm=1.200, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6853, grad_norm=1.200, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6972, grad_norm=1.450, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.6972, grad_norm=1.450, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.46it/s, loss=0.6928, grad_norm=1.164, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.13it/s, loss=0.6928, grad_norm=1.164, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.13it/s, loss=0.6819, grad_norm=1.899, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6819, grad_norm=1.899, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6867, Acc: 0.5543, Precision: 0.5373, Recall: 0.7826, F1: 0.6372, AUC: 0.6055
------------------------------------------------------------
Training curves saved to model\chb15_fold18\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold18
============================================================
✅ Fold 18 training completed successfully!

============================================================
TRAINING FOLD 19/19
============================================================
Using dataset prefix: chb15_fold19
Loading datasets from: preprocessing\data\chb15_fold19
Saving models to: model\chb15_fold19
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7881, std=2.0138
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5676, 4.1100]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 19): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6823, grad_norm=1.269, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:43,  4.00s/it, loss=0.6823, grad_norm=1.269, lr=0.000010]Training Epoch 1/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:43,  4.00s/it, loss=0.6947, grad_norm=1.211, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6947, grad_norm=1.211, lr=0.000010]Training Epoch 1/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.71s/it, loss=0.6895, grad_norm=1.469, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6895, grad_norm=1.469, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.02it/s, loss=0.6951, grad_norm=1.364, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.6951, grad_norm=1.364, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.58it/s, loss=0.7121, grad_norm=1.308, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.7121, grad_norm=1.308, lr=0.000010]Training Epoch 1/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.25it/s, loss=0.6912, grad_norm=1.345, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6912, grad_norm=1.345, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.03it/s, loss=0.6917, grad_norm=1.161, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6917, grad_norm=1.161, lr=0.000010]Training Epoch 1/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.88it/s, loss=0.6877, grad_norm=1.215, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.6877, grad_norm=1.215, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.79it/s, loss=0.7029, grad_norm=1.507, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.7029, grad_norm=1.507, lr=0.000010]Training Epoch 1/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.66it/s, loss=0.7025, grad_norm=1.294, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.46it/s, loss=0.7025, grad_norm=1.294, lr=0.000010]Training Epoch 1/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.46it/s, loss=0.6763, grad_norm=1.290, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.6763, grad_norm=1.290, lr=0.000010]Training Epoch 1/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.12it/s, loss=0.7421, grad_norm=2.251, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.11it/s, loss=0.7421, grad_norm=2.251, lr=0.000010]

Epoch 1/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6973, Acc: 0.5054, Precision: 0.5036, Recall: 0.7609, F1: 0.6061, AUC: 0.4911
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6827, grad_norm=1.273, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.90s/it, loss=0.6827, grad_norm=1.273, lr=0.000010]Training Epoch 2/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.90s/it, loss=0.6886, grad_norm=1.153, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6886, grad_norm=1.153, lr=0.000010]Training Epoch 2/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6879, grad_norm=1.159, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6879, grad_norm=1.159, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.04it/s, loss=0.6821, grad_norm=1.182, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6821, grad_norm=1.182, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.60it/s, loss=0.6959, grad_norm=1.263, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6959, grad_norm=1.263, lr=0.000010]Training Epoch 2/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.28it/s, loss=0.6980, grad_norm=1.204, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6980, grad_norm=1.204, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.07it/s, loss=0.6964, grad_norm=1.132, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.6964, grad_norm=1.132, lr=0.000010]Training Epoch 2/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.93it/s, loss=0.7035, grad_norm=1.160, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.7035, grad_norm=1.160, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.80it/s, loss=0.6965, grad_norm=1.156, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.6965, grad_norm=1.156, lr=0.000010]Training Epoch 2/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.64it/s, loss=0.7006, grad_norm=1.133, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.7006, grad_norm=1.133, lr=0.000010]Training Epoch 2/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.42it/s, loss=0.6987, grad_norm=1.271, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.08it/s, loss=0.6987, grad_norm=1.271, lr=0.000010]Training Epoch 2/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.08it/s, loss=0.6827, grad_norm=1.643, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.13it/s, loss=0.6827, grad_norm=1.643, lr=0.000010]

Epoch 2/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6928, Acc: 0.4891, Precision: 0.4921, Recall: 0.6739, F1: 0.5688, AUC: 0.5067
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/12 [00:04<?, ?it/s, loss=0.6908, grad_norm=1.434, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.04s/it, loss=0.6908, grad_norm=1.434, lr=0.000010]Training Epoch 3/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:44,  4.04s/it, loss=0.6957, grad_norm=1.158, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6957, grad_norm=1.158, lr=0.000010]Training Epoch 3/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:17,  1.73s/it, loss=0.6851, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6851, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.01it/s, loss=0.6970, grad_norm=1.340, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6970, grad_norm=1.340, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:05,  1.56it/s, loss=0.6868, grad_norm=1.097, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.6868, grad_norm=1.097, lr=0.000010]Training Epoch 3/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.23it/s, loss=0.7038, grad_norm=1.312, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  3.00it/s, loss=0.7038, grad_norm=1.312, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:02,  3.00it/s, loss=0.6975, grad_norm=1.279, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.84it/s, loss=0.6975, grad_norm=1.279, lr=0.000010]Training Epoch 3/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.84it/s, loss=0.7064, grad_norm=1.475, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.71it/s, loss=0.7064, grad_norm=1.475, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.71it/s, loss=0.6840, grad_norm=1.332, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.55it/s, loss=0.6840, grad_norm=1.332, lr=0.000010]Training Epoch 3/5:  75%|###################################################################################################################################2                                           | 9/12 [00:05<00:00,  5.55it/s, loss=0.6867, grad_norm=1.202, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6867, grad_norm=1.202, lr=0.000010]Training Epoch 3/5:  83%|#################################################################################################################################################                             | 10/12 [00:05<00:00,  6.35it/s, loss=0.6873, grad_norm=1.250, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6873, grad_norm=1.250, lr=0.000010]Training Epoch 3/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.01it/s, loss=0.6763, grad_norm=1.635, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.07it/s, loss=0.6763, grad_norm=1.635, lr=0.000010]

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6914, Acc: 0.5217, Precision: 0.5435, Recall: 0.2717, F1: 0.3623, AUC: 0.5227
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6804, grad_norm=1.217, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.89s/it, loss=0.6804, grad_norm=1.217, lr=0.000010]Training Epoch 4/5:   8%|##############5                                                                                                                                                                | 1/12 [00:04<00:42,  3.89s/it, loss=0.6774, grad_norm=1.185, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6774, grad_norm=1.185, lr=0.000010]Training Epoch 4/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.67s/it, loss=0.6750, grad_norm=1.140, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6750, grad_norm=1.140, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6854, grad_norm=1.260, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6854, grad_norm=1.260, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.61it/s, loss=0.6923, grad_norm=1.345, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6923, grad_norm=1.345, lr=0.000010]Training Epoch 4/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.29it/s, loss=0.6802, grad_norm=1.193, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6802, grad_norm=1.193, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.7006, grad_norm=1.400, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.7006, grad_norm=1.400, lr=0.000010]Training Epoch 4/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6765, grad_norm=1.294, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6765, grad_norm=1.294, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.81it/s, loss=0.6790, grad_norm=1.330, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6790, grad_norm=1.330, lr=0.000010]Training Epoch 4/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.65it/s, loss=0.6814, grad_norm=1.324, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.41it/s, loss=0.6814, grad_norm=1.324, lr=0.000010]Training Epoch 4/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.41it/s, loss=0.6868, grad_norm=1.353, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.05it/s, loss=0.6868, grad_norm=1.353, lr=0.000010]Training Epoch 4/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.05it/s, loss=0.6883, grad_norm=2.003, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.14it/s, loss=0.6883, grad_norm=2.003, lr=0.000010]

Epoch 4/5 Complete (6.0s) [LR: 0.000010]
Train - Loss: 0.6836, Acc: 0.5924, Precision: 0.6667, Recall: 0.3696, F1: 0.4755, AUC: 0.6717
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/12 [00:03<?, ?it/s, loss=0.6575, grad_norm=1.265, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6575, grad_norm=1.265, lr=0.000010]Training Epoch 5/5:   8%|##############5                                                                                                                                                                | 1/12 [00:03<00:42,  3.87s/it, loss=0.6783, grad_norm=1.233, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:03<00:16,  1.66s/it, loss=0.6783, grad_norm=1.233, lr=0.000010]Training Epoch 5/5:  17%|#############################1                                                                                                                                                 | 2/12 [00:04<00:16,  1.66s/it, loss=0.6821, grad_norm=1.390, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6821, grad_norm=1.390, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 3/12 [00:04<00:08,  1.05it/s, loss=0.6767, grad_norm=1.418, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6767, grad_norm=1.418, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 4/12 [00:04<00:04,  1.62it/s, loss=0.6646, grad_norm=1.359, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6646, grad_norm=1.359, lr=0.000010]Training Epoch 5/5:  42%|########################################################################9                                                                                                      | 5/12 [00:04<00:03,  2.30it/s, loss=0.6811, grad_norm=1.284, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6811, grad_norm=1.284, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 6/12 [00:04<00:01,  3.09it/s, loss=0.6803, grad_norm=1.331, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6803, grad_norm=1.331, lr=0.000010]Training Epoch 5/5:  58%|######################################################################################################                                                                         | 7/12 [00:04<00:01,  3.94it/s, loss=0.6881, grad_norm=1.303, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6881, grad_norm=1.303, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################6                                                          | 8/12 [00:04<00:00,  4.83it/s, loss=0.6789, grad_norm=1.429, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6789, grad_norm=1.429, lr=0.000010]Training Epoch 5/5:  75%|###################################################################################################################################2                                           | 9/12 [00:04<00:00,  5.69it/s, loss=0.6639, grad_norm=1.413, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.44it/s, loss=0.6639, grad_norm=1.413, lr=0.000010]Training Epoch 5/5:  83%|#################################################################################################################################################                             | 10/12 [00:04<00:00,  6.44it/s, loss=0.6865, grad_norm=1.707, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:04<00:00,  7.08it/s, loss=0.6865, grad_norm=1.707, lr=0.000010]Training Epoch 5/5:  92%|###############################################################################################################################################################5              | 11/12 [00:05<00:00,  7.08it/s, loss=0.6842, grad_norm=2.071, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 12/12 [00:05<00:00,  2.15it/s, loss=0.6842, grad_norm=2.071, lr=0.000010]

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6768, Acc: 0.6522, Precision: 0.7188, Recall: 0.5000, F1: 0.5897, AUC: 0.7610
------------------------------------------------------------
Training curves saved to model\chb15_fold19\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold19
============================================================
✅ Fold 19 training completed successfully!

============================================================
✅ BATCH TRAINING COMPLETED!
✅ Trained models for 20 folds for patient chb15
============================================================
============================================================
============================================================
BATCH EVALUATION: ALL FOLDS
BATCH EVALUATION: ALL FOLDS
Evaluating 20 folds for patient chb15
Evaluating 20 folds for patient chb15
============================================================
============================================================
Using CUDA: NVIDIA GeForce RTX 3090 Ti
Using CUDA: NVIDIA GeForce RTX 3090 Ti

============================================================
============================================================

EVALUATING FOLD 0/19
EVALUATING FOLD 0/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold0
Dataset prefix: chb15_fold0
Using test dataset: preprocessing\data\chb15_fold0\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold0\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold0\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold0\test_dataset.h5...
  - Normalization: z-score, mean=-0.6990, std=2.0063
  - Normalization: z-score, mean=-0.6990, std=2.0063
Loaded test dataset: 34 samples
Loaded test dataset: 34 samples
  - Spectrogram shape: torch.Size([34, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([34, 30, 18, 50, 10])
  - Value range: [-5.6328, 4.2417]
  - Value range: [-5.6328, 4.2417]
  - Class distribution: tensor([17, 17])
  - Class distribution: tensor([17, 17])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold0\epoch_005.pth...
Loading model checkpoint from model\chb15_fold0\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:  33%|############################################################################6                                                                                                                                                         | 1/3 [00:00<00:00,  3.91it/s]Testing:  33%|############################################################################6                                                                                                                                                         | 1/3 [00:00<00:00,  3.91it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00,  9.30it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00,  9.30it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7412
Loss:      0.7412
Accuracy:  0.1765 (17.65%)
Accuracy:  0.1765 (17.65%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.0000
AUC-ROC:   0.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         6        11
Actual Interictal         6        11
       Preictal        17         0
       Preictal        17         0

Class Distribution:
Class Distribution:

True Interictal (0): 17 samples
True Interictal (0): 17 samples
True Preictal (1):   17 samples
True Preictal (1):   17 samples
Pred Interictal (0): 23 samples
Pred Interictal (0): 23 samples
Pred Preictal (1):   11 samples
Pred Preictal (1):   11 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.2609    0.3529    0.3000        17
    Preictal     0.0000    0.0000    0.0000        17

    accuracy                         0.1765        34
   macro avg     0.1304    0.1765    0.1500        34
weighted avg     0.1304    0.1765    0.1500        34
              precision    recall  f1-score   support

  Interictal     0.2609    0.3529    0.3000        17
    Preictal     0.0000    0.0000    0.0000        17

    accuracy                         0.1765        34
   macro avg     0.1304    0.1765    0.1500        34
weighted avg     0.1304    0.1765    0.1500        34



✅ Results saved to model\chb15_fold0\test_results.json
✅ Results saved to model\chb15_fold0\test_results.json


============================================================
============================================================

EVALUATING FOLD 1/19
EVALUATING FOLD 1/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold1
Dataset prefix: chb15_fold1
Using test dataset: preprocessing\data\chb15_fold1\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold1\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold1\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold1\test_dataset.h5...
  - Normalization: z-score, mean=-0.7261, std=2.0020
  - Normalization: z-score, mean=-0.7261, std=2.0020
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.6313, 3.8113]
  - Value range: [-5.6313, 3.8113]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold1\epoch_005.pth...
Loading model checkpoint from model\chb15_fold1\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 25.94it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 25.94it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 25.86it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 25.86it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6906
Loss:      0.6906
Accuracy:  0.4750 (47.50%)
Accuracy:  0.4750 (47.50%)
Precision: 0.4706
Precision: 0.4706
Recall:    0.4000
Recall:    0.4000
F1 Score:  0.4324
F1 Score:  0.4324
AUC-ROC:   0.5325
AUC-ROC:   0.5325

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        11         9
Actual Interictal        11         9
       Preictal        12         8
       Preictal        12         8

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 23 samples
Pred Interictal (0): 23 samples
Pred Preictal (1):   17 samples
Pred Preictal (1):   17 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4783    0.5500    0.5116        20
    Preictal     0.4706    0.4000    0.4324        20

    accuracy                         0.4750        40
   macro avg     0.4744    0.4750    0.4720        40
weighted avg     0.4744    0.4750    0.4720        40
              precision    recall  f1-score   support

  Interictal     0.4783    0.5500    0.5116        20
    Preictal     0.4706    0.4000    0.4324        20

    accuracy                         0.4750        40
   macro avg     0.4744    0.4750    0.4720        40
weighted avg     0.4744    0.4750    0.4720        40



✅ Results saved to model\chb15_fold1\test_results.json
✅ Results saved to model\chb15_fold1\test_results.json


============================================================
============================================================

EVALUATING FOLD 2/19
EVALUATING FOLD 2/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold2
Dataset prefix: chb15_fold2
Using test dataset: preprocessing\data\chb15_fold2\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold2\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold2\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold2\test_dataset.h5...
  - Normalization: z-score, mean=-0.7786, std=2.0184
  - Normalization: z-score, mean=-0.7786, std=2.0184
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.5596, 3.7526]
  - Value range: [-5.5596, 3.7526]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold2\epoch_005.pth...
Loading model checkpoint from model\chb15_fold2\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.51it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.51it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.40it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.40it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6874
Loss:      0.6874
Accuracy:  0.5909 (59.09%)
Accuracy:  0.5909 (59.09%)
Precision: 0.5500
Precision: 0.5500
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.7097
F1 Score:  0.7097
AUC-ROC:   0.7252
AUC-ROC:   0.7252

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         4        18
Actual Interictal         4        18
       Preictal         0        22
       Preictal         0        22

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 4 samples
Pred Interictal (0): 4 samples
Pred Preictal (1):   40 samples
Pred Preictal (1):   40 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.1818    0.3077        22
    Preictal     0.5500    1.0000    0.7097        22

    accuracy                         0.5909        44
   macro avg     0.7750    0.5909    0.5087        44
weighted avg     0.7750    0.5909    0.5087        44
              precision    recall  f1-score   support

  Interictal     1.0000    0.1818    0.3077        22
    Preictal     0.5500    1.0000    0.7097        22

    accuracy                         0.5909        44
   macro avg     0.7750    0.5909    0.5087        44
weighted avg     0.7750    0.5909    0.5087        44



✅ Results saved to model\chb15_fold2\test_results.json
✅ Results saved to model\chb15_fold2\test_results.json


============================================================
============================================================

EVALUATING FOLD 3/19
EVALUATING FOLD 3/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold3
Dataset prefix: chb15_fold3
Using test dataset: preprocessing\data\chb15_fold3\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold3\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold3\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold3\test_dataset.h5...
  - Normalization: z-score, mean=-0.7693, std=2.0298
  - Normalization: z-score, mean=-0.7693, std=2.0298
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.5326, 3.9160]
  - Value range: [-5.5326, 3.9160]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold3\epoch_005.pth...
Loading model checkpoint from model\chb15_fold3\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 28.72it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 28.72it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 28.61it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 28.61it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7056
Loss:      0.7056
Accuracy:  0.3913 (39.13%)
Accuracy:  0.3913 (39.13%)
Precision: 0.3333
Precision: 0.3333
Recall:    0.2174
Recall:    0.2174
F1 Score:  0.2632
F1 Score:  0.2632
AUC-ROC:   0.4253
AUC-ROC:   0.4253

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        13        10
Actual Interictal        13        10
       Preictal        18         5
       Preictal        18         5

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 31 samples
Pred Interictal (0): 31 samples
Pred Preictal (1):   15 samples
Pred Preictal (1):   15 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4194    0.5652    0.4815        23
    Preictal     0.3333    0.2174    0.2632        23

    accuracy                         0.3913        46
   macro avg     0.3763    0.3913    0.3723        46
weighted avg     0.3763    0.3913    0.3723        46
              precision    recall  f1-score   support

  Interictal     0.4194    0.5652    0.4815        23
    Preictal     0.3333    0.2174    0.2632        23

    accuracy                         0.3913        46
   macro avg     0.3763    0.3913    0.3723        46
weighted avg     0.3763    0.3913    0.3723        46



✅ Results saved to model\chb15_fold3\test_results.json
✅ Results saved to model\chb15_fold3\test_results.json


============================================================
============================================================

EVALUATING FOLD 4/19
EVALUATING FOLD 4/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold4
Dataset prefix: chb15_fold4
Using test dataset: preprocessing\data\chb15_fold4\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold4\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold4\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold4\test_dataset.h5...
  - Normalization: z-score, mean=-0.8223, std=2.0052
  - Normalization: z-score, mean=-0.8223, std=2.0052
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.5745, 4.0460]
  - Value range: [-5.5745, 4.0460]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold4\epoch_005.pth...
Loading model checkpoint from model\chb15_fold4\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 31.78it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 31.78it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7060
Loss:      0.7060
Accuracy:  0.1579 (15.79%)
Accuracy:  0.1579 (15.79%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.1357
AUC-ROC:   0.1357

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         6        13
Actual Interictal         6        13
       Preictal        19         0
       Preictal        19         0

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 25 samples
Pred Interictal (0): 25 samples
Pred Preictal (1):   13 samples
Pred Preictal (1):   13 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.2400    0.3158    0.2727        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.1579        38
   macro avg     0.1200    0.1579    0.1364        38
weighted avg     0.1200    0.1579    0.1364        38
              precision    recall  f1-score   support

  Interictal     0.2400    0.3158    0.2727        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.1579        38
   macro avg     0.1200    0.1579    0.1364        38
weighted avg     0.1200    0.1579    0.1364        38



✅ Results saved to model\chb15_fold4\test_results.json
✅ Results saved to model\chb15_fold4\test_results.json


============================================================
============================================================

EVALUATING FOLD 5/19
EVALUATING FOLD 5/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold5
Dataset prefix: chb15_fold5
Using test dataset: preprocessing\data\chb15_fold5\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold5\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold5\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold5\test_dataset.h5...
  - Normalization: z-score, mean=-0.6832, std=1.9928
  - Normalization: z-score, mean=-0.6832, std=1.9928
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.6787, 3.7882]
  - Value range: [-5.6787, 3.7882]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold5\epoch_005.pth...
Loading model checkpoint from model\chb15_fold5\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 36.33it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 36.33it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7023
Loss:      0.7023
Accuracy:  0.3684 (36.84%)
Accuracy:  0.3684 (36.84%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.2078
AUC-ROC:   0.2078

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         5
Actual Interictal        14         5
       Preictal        19         0
       Preictal        19         0

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 33 samples
Pred Interictal (0): 33 samples
Pred Preictal (1):   5 samples
Pred Preictal (1):   5 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4242    0.7368    0.5385        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.3684        38
   macro avg     0.2121    0.3684    0.2692        38
weighted avg     0.2121    0.3684    0.2692        38
              precision    recall  f1-score   support

  Interictal     0.4242    0.7368    0.5385        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.3684        38
   macro avg     0.2121    0.3684    0.2692        38
weighted avg     0.2121    0.3684    0.2692        38



✅ Results saved to model\chb15_fold5\test_results.json
✅ Results saved to model\chb15_fold5\test_results.json


============================================================
============================================================

EVALUATING FOLD 6/19
EVALUATING FOLD 6/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold6
Dataset prefix: chb15_fold6
Using test dataset: preprocessing\data\chb15_fold6\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold6\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold6\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold6\test_dataset.h5...
  - Normalization: z-score, mean=-0.7357, std=2.0057
  - Normalization: z-score, mean=-0.7357, std=2.0057
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.6161, 4.0881]
  - Value range: [-5.6161, 4.0881]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold6\epoch_005.pth...
Loading model checkpoint from model\chb15_fold6\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 27.20it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 27.20it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 27.09it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 27.09it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7030
Loss:      0.7030
Accuracy:  0.4783 (47.83%)
Accuracy:  0.4783 (47.83%)
Precision: 0.4839
Precision: 0.4839
Recall:    0.6522
Recall:    0.6522
F1 Score:  0.5556
F1 Score:  0.5556
AUC-ROC:   0.4197
AUC-ROC:   0.4197

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         7        16
Actual Interictal         7        16
       Preictal         8        15
       Preictal         8        15

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 15 samples
Pred Interictal (0): 15 samples
Pred Preictal (1):   31 samples
Pred Preictal (1):   31 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4667    0.3043    0.3684        23
    Preictal     0.4839    0.6522    0.5556        23

    accuracy                         0.4783        46
   macro avg     0.4753    0.4783    0.4620        46
weighted avg     0.4753    0.4783    0.4620        46
              precision    recall  f1-score   support

  Interictal     0.4667    0.3043    0.3684        23
    Preictal     0.4839    0.6522    0.5556        23

    accuracy                         0.4783        46
   macro avg     0.4753    0.4783    0.4620        46
weighted avg     0.4753    0.4783    0.4620        46



✅ Results saved to model\chb15_fold6\test_results.json
✅ Results saved to model\chb15_fold6\test_results.json


============================================================
============================================================

EVALUATING FOLD 7/19
EVALUATING FOLD 7/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold7
Dataset prefix: chb15_fold7
Using test dataset: preprocessing\data\chb15_fold7\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold7\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold7\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold7\test_dataset.h5...
  - Normalization: z-score, mean=-0.6591, std=1.9858
  - Normalization: z-score, mean=-0.6591, std=1.9858
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.7109, 3.9322]
  - Value range: [-5.7109, 3.9322]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold7\epoch_005.pth...
Loading model checkpoint from model\chb15_fold7\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.66it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.66it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7076
Loss:      0.7076
Accuracy:  0.4545 (45.45%)
Accuracy:  0.4545 (45.45%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.1281
AUC-ROC:   0.1281

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        20         2
Actual Interictal        20         2
       Preictal        22         0
       Preictal        22         0

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 42 samples
Pred Interictal (0): 42 samples
Pred Preictal (1):   2 samples
Pred Preictal (1):   2 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4762    0.9091    0.6250        22
    Preictal     0.0000    0.0000    0.0000        22

    accuracy                         0.4545        44
   macro avg     0.2381    0.4545    0.3125        44
weighted avg     0.2381    0.4545    0.3125        44
              precision    recall  f1-score   support

  Interictal     0.4762    0.9091    0.6250        22
    Preictal     0.0000    0.0000    0.0000        22

    accuracy                         0.4545        44
   macro avg     0.2381    0.4545    0.3125        44
weighted avg     0.2381    0.4545    0.3125        44



✅ Results saved to model\chb15_fold7\test_results.json
✅ Results saved to model\chb15_fold7\test_results.json


============================================================
============================================================

EVALUATING FOLD 8/19
EVALUATING FOLD 8/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold8
Dataset prefix: chb15_fold8
Using test dataset: preprocessing\data\chb15_fold8\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold8\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold8\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold8\test_dataset.h5...
  - Normalization: z-score, mean=-0.7176, std=2.0127
  - Normalization: z-score, mean=-0.7176, std=2.0127
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.6056, 3.8115]
  - Value range: [-5.6056, 3.8115]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold8\epoch_005.pth...
Loading model checkpoint from model\chb15_fold8\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.42it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.42it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6967
Loss:      0.6967
Accuracy:  0.6364 (63.64%)
Accuracy:  0.6364 (63.64%)
Precision: 0.5789
Precision: 0.5789
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.7333
F1 Score:  0.7333
AUC-ROC:   0.5640
AUC-ROC:   0.5640

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         6        16
Actual Interictal         6        16
       Preictal         0        22
       Preictal         0        22

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 6 samples
Pred Interictal (0): 6 samples
Pred Preictal (1):   38 samples
Pred Preictal (1):   38 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.2727    0.4286        22
    Preictal     0.5789    1.0000    0.7333        22

    accuracy                         0.6364        44
   macro avg     0.7895    0.6364    0.5810        44
weighted avg     0.7895    0.6364    0.5810        44
              precision    recall  f1-score   support

  Interictal     1.0000    0.2727    0.4286        22
    Preictal     0.5789    1.0000    0.7333        22

    accuracy                         0.6364        44
   macro avg     0.7895    0.6364    0.5810        44
weighted avg     0.7895    0.6364    0.5810        44



✅ Results saved to model\chb15_fold8\test_results.json
✅ Results saved to model\chb15_fold8\test_results.json


============================================================
============================================================

EVALUATING FOLD 9/19
EVALUATING FOLD 9/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold9
Dataset prefix: chb15_fold9
Using test dataset: preprocessing\data\chb15_fold9\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold9\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold9\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold9\test_dataset.h5...
  - Normalization: z-score, mean=-0.7501, std=1.9955
  - Normalization: z-score, mean=-0.7501, std=1.9955
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.6372, 4.0987]
  - Value range: [-5.6372, 4.0987]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold9\epoch_005.pth...
Loading model checkpoint from model\chb15_fold9\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:  67%|#########################################################################################################################################################3                                                                            | 2/3 [00:00<00:00, 19.63it/s]Testing:  67%|#########################################################################################################################################################3                                                                            | 2/3 [00:00<00:00, 19.63it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 24.46it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 24.46it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7006
Loss:      0.7006
Accuracy:  0.6250 (62.50%)
Accuracy:  0.6250 (62.50%)
Precision: 0.5758
Precision: 0.5758
Recall:    0.9500
Recall:    0.9500
F1 Score:  0.7170
F1 Score:  0.7170
AUC-ROC:   0.5100
AUC-ROC:   0.5100

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         6        14
Actual Interictal         6        14
       Preictal         1        19
       Preictal         1        19

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 7 samples
Pred Interictal (0): 7 samples
Pred Preictal (1):   33 samples
Pred Preictal (1):   33 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.8571    0.3000    0.4444        20
    Preictal     0.5758    0.9500    0.7170        20

    accuracy                         0.6250        40
   macro avg     0.7165    0.6250    0.5807        40
weighted avg     0.7165    0.6250    0.5807        40
              precision    recall  f1-score   support

  Interictal     0.8571    0.3000    0.4444        20
    Preictal     0.5758    0.9500    0.7170        20

    accuracy                         0.6250        40
   macro avg     0.7165    0.6250    0.5807        40
weighted avg     0.7165    0.6250    0.5807        40



✅ Results saved to model\chb15_fold9\test_results.json
✅ Results saved to model\chb15_fold9\test_results.json


============================================================
============================================================

EVALUATING FOLD 10/19
EVALUATING FOLD 10/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold10
Dataset prefix: chb15_fold10
Using test dataset: preprocessing\data\chb15_fold10\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold10\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold10\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold10\test_dataset.h5...
  - Normalization: z-score, mean=-0.7736, std=2.0327
  - Normalization: z-score, mean=-0.7736, std=2.0327
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.5230, 3.8576]
  - Value range: [-5.5230, 3.8576]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold10\epoch_005.pth...
Loading model checkpoint from model\chb15_fold10\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 33.54it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 33.54it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7172
Loss:      0.7172
Accuracy:  0.4048 (40.48%)
Accuracy:  0.4048 (40.48%)
Precision: 0.3889
Precision: 0.3889
Recall:    0.3333
Recall:    0.3333
F1 Score:  0.3590
F1 Score:  0.3590
AUC-ROC:   0.4399
AUC-ROC:   0.4399

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        10        11
Actual Interictal        10        11
       Preictal        14         7
       Preictal        14         7

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 24 samples
Pred Interictal (0): 24 samples
Pred Preictal (1):   18 samples
Pred Preictal (1):   18 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4167    0.4762    0.4444        21
    Preictal     0.3889    0.3333    0.3590        21

    accuracy                         0.4048        42
   macro avg     0.4028    0.4048    0.4017        42
weighted avg     0.4028    0.4048    0.4017        42
              precision    recall  f1-score   support

  Interictal     0.4167    0.4762    0.4444        21
    Preictal     0.3889    0.3333    0.3590        21

    accuracy                         0.4048        42
   macro avg     0.4028    0.4048    0.4017        42
weighted avg     0.4028    0.4048    0.4017        42



✅ Results saved to model\chb15_fold10\test_results.json
✅ Results saved to model\chb15_fold10\test_results.json


============================================================
============================================================

EVALUATING FOLD 11/19
EVALUATING FOLD 11/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold11
Dataset prefix: chb15_fold11
Using test dataset: preprocessing\data\chb15_fold11\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold11\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold11\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold11\test_dataset.h5...
  - Normalization: z-score, mean=-0.7624, std=2.0031
  - Normalization: z-score, mean=-0.7624, std=2.0031
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.6102, 4.0893]
  - Value range: [-5.6102, 4.0893]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold11\epoch_005.pth...
Loading model checkpoint from model\chb15_fold11\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.55it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 32.55it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6967
Loss:      0.6967
Accuracy:  0.4474 (44.74%)
Accuracy:  0.4474 (44.74%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.2161
AUC-ROC:   0.2161

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        17         2
Actual Interictal        17         2
       Preictal        19         0
       Preictal        19         0

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 36 samples
Pred Interictal (0): 36 samples
Pred Preictal (1):   2 samples
Pred Preictal (1):   2 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4722    0.8947    0.6182        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.4474        38
   macro avg     0.2361    0.4474    0.3091        38
weighted avg     0.2361    0.4474    0.3091        38
              precision    recall  f1-score   support

  Interictal     0.4722    0.8947    0.6182        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.4474        38
   macro avg     0.2361    0.4474    0.3091        38
weighted avg     0.2361    0.4474    0.3091        38



✅ Results saved to model\chb15_fold11\test_results.json
✅ Results saved to model\chb15_fold11\test_results.json


============================================================
============================================================

EVALUATING FOLD 12/19
EVALUATING FOLD 12/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold12
Dataset prefix: chb15_fold12
Using test dataset: preprocessing\data\chb15_fold12\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold12\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold12\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold12\test_dataset.h5...
  - Normalization: z-score, mean=-0.7965, std=1.9967
  - Normalization: z-score, mean=-0.7965, std=1.9967
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.6111, 4.1946]
  - Value range: [-5.6111, 4.1946]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold12\epoch_005.pth...
Loading model checkpoint from model\chb15_fold12\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.24it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.24it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7695
Loss:      0.7695
Accuracy:  0.5000 (50.00%)
Accuracy:  0.5000 (50.00%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.0000
AUC-ROC:   0.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        21         0
Actual Interictal        21         0
       Preictal        21         0
       Preictal        21         0

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 42 samples
Pred Interictal (0): 42 samples
Pred Preictal (1):   0 samples
Pred Preictal (1):   0 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        21
    Preictal     0.0000    0.0000    0.0000        21

    accuracy                         0.5000        42
   macro avg     0.2500    0.5000    0.3333        42
weighted avg     0.2500    0.5000    0.3333        42
              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        21
    Preictal     0.0000    0.0000    0.0000        21

    accuracy                         0.5000        42
   macro avg     0.2500    0.5000    0.3333        42
weighted avg     0.2500    0.5000    0.3333        42



✅ Results saved to model\chb15_fold12\test_results.json
✅ Results saved to model\chb15_fold12\test_results.json


============================================================
============================================================

EVALUATING FOLD 13/19
EVALUATING FOLD 13/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold13
Dataset prefix: chb15_fold13
Using test dataset: preprocessing\data\chb15_fold13\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold13\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold13\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold13\test_dataset.h5...
  - Normalization: z-score, mean=-0.7794, std=2.0276
  - Normalization: z-score, mean=-0.7794, std=2.0276
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.5339, 3.9561]
  - Value range: [-5.5339, 3.9561]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold13\epoch_005.pth...
Loading model checkpoint from model\chb15_fold13\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.41it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.41it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6901
Loss:      0.6901
Accuracy:  0.5000 (50.00%)
Accuracy:  0.5000 (50.00%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.6325
AUC-ROC:   0.6325

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        20         0
Actual Interictal        20         0
       Preictal        20         0
       Preictal        20         0

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 40 samples
Pred Interictal (0): 40 samples
Pred Preictal (1):   0 samples
Pred Preictal (1):   0 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        20
    Preictal     0.0000    0.0000    0.0000        20

    accuracy                         0.5000        40
   macro avg     0.2500    0.5000    0.3333        40
weighted avg     0.2500    0.5000    0.3333        40
              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        20
    Preictal     0.0000    0.0000    0.0000        20

    accuracy                         0.5000        40
   macro avg     0.2500    0.5000    0.3333        40
weighted avg     0.2500    0.5000    0.3333        40



✅ Results saved to model\chb15_fold13\test_results.json
✅ Results saved to model\chb15_fold13\test_results.json


============================================================
============================================================

EVALUATING FOLD 14/19
EVALUATING FOLD 14/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold14
Dataset prefix: chb15_fold14
Using test dataset: preprocessing\data\chb15_fold14\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold14\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold14\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold14\test_dataset.h5...
  - Normalization: z-score, mean=-0.7768, std=1.9970
  - Normalization: z-score, mean=-0.7768, std=1.9970
Loaded test dataset: 30 samples
Loaded test dataset: 30 samples
  - Spectrogram shape: torch.Size([30, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([30, 30, 18, 50, 10])
  - Value range: [-5.6165, 3.8339]
  - Value range: [-5.6165, 3.8339]
  - Class distribution: tensor([15, 15])
  - Class distribution: tensor([15, 15])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold14\epoch_005.pth...
Loading model checkpoint from model\chb15_fold14\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/2 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/2 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 2/2 [00:00<00:00, 21.94it/s]Testing: 100%|######################################################################################################################################################################################################################################| 2/2 [00:00<00:00, 21.94it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6914
Loss:      0.6914
Accuracy:  0.6333 (63.33%)
Accuracy:  0.6333 (63.33%)
Precision: 0.6250
Precision: 0.6250
Recall:    0.6667
Recall:    0.6667
F1 Score:  0.6452
F1 Score:  0.6452
AUC-ROC:   0.6400
AUC-ROC:   0.6400

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         9         6
Actual Interictal         9         6
       Preictal         5        10
       Preictal         5        10

Class Distribution:
Class Distribution:

True Interictal (0): 15 samples
True Interictal (0): 15 samples
True Preictal (1):   15 samples
True Preictal (1):   15 samples
Pred Interictal (0): 14 samples
Pred Interictal (0): 14 samples
Pred Preictal (1):   16 samples
Pred Preictal (1):   16 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.6429    0.6000    0.6207        15
    Preictal     0.6250    0.6667    0.6452        15

    accuracy                         0.6333        30
   macro avg     0.6339    0.6333    0.6329        30
weighted avg     0.6339    0.6333    0.6329        30
              precision    recall  f1-score   support

  Interictal     0.6429    0.6000    0.6207        15
    Preictal     0.6250    0.6667    0.6452        15

    accuracy                         0.6333        30
   macro avg     0.6339    0.6333    0.6329        30
weighted avg     0.6339    0.6333    0.6329        30



✅ Results saved to model\chb15_fold14\test_results.json
✅ Results saved to model\chb15_fold14\test_results.json


============================================================
============================================================

EVALUATING FOLD 15/19
EVALUATING FOLD 15/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold15
Dataset prefix: chb15_fold15
Using test dataset: preprocessing\data\chb15_fold15\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold15\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold15\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold15\test_dataset.h5...
  - Normalization: z-score, mean=-0.7394, std=2.0055
  - Normalization: z-score, mean=-0.7394, std=2.0055
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.6150, 3.8171]
  - Value range: [-5.6150, 3.8171]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold15\epoch_005.pth...
Loading model checkpoint from model\chb15_fold15\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.69it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.69it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6987
Loss:      0.6987
Accuracy:  0.3913 (39.13%)
Accuracy:  0.3913 (39.13%)
Precision: 0.2222
Precision: 0.2222
Recall:    0.0870
Recall:    0.0870
F1 Score:  0.1250
F1 Score:  0.1250
AUC-ROC:   0.4045
AUC-ROC:   0.4045

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        16         7
Actual Interictal        16         7
       Preictal        21         2
       Preictal        21         2

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 37 samples
Pred Interictal (0): 37 samples
Pred Preictal (1):   9 samples
Pred Preictal (1):   9 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4324    0.6957    0.5333        23
    Preictal     0.2222    0.0870    0.1250        23

    accuracy                         0.3913        46
   macro avg     0.3273    0.3913    0.3292        46
weighted avg     0.3273    0.3913    0.3292        46
              precision    recall  f1-score   support

  Interictal     0.4324    0.6957    0.5333        23
    Preictal     0.2222    0.0870    0.1250        23

    accuracy                         0.3913        46
   macro avg     0.3273    0.3913    0.3292        46
weighted avg     0.3273    0.3913    0.3292        46



✅ Results saved to model\chb15_fold15\test_results.json
✅ Results saved to model\chb15_fold15\test_results.json


============================================================
============================================================

EVALUATING FOLD 16/19
EVALUATING FOLD 16/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold16
Dataset prefix: chb15_fold16
Using test dataset: preprocessing\data\chb15_fold16\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold16\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold16\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold16\test_dataset.h5...
  - Normalization: z-score, mean=-0.7461, std=2.0041
  - Normalization: z-score, mean=-0.7461, std=2.0041
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.6153, 3.8155]
  - Value range: [-5.6153, 3.8155]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold16\epoch_005.pth...
Loading model checkpoint from model\chb15_fold16\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 33.87it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 33.87it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6945
Loss:      0.6945
Accuracy:  0.4524 (45.24%)
Accuracy:  0.4524 (45.24%)
Precision: 0.4500
Precision: 0.4500
Recall:    0.4286
Recall:    0.4286
F1 Score:  0.4390
F1 Score:  0.4390
AUC-ROC:   0.4943
AUC-ROC:   0.4943

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        10        11
Actual Interictal        10        11
       Preictal        12         9
       Preictal        12         9

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 22 samples
Pred Interictal (0): 22 samples
Pred Preictal (1):   20 samples
Pred Preictal (1):   20 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4545    0.4762    0.4651        21
    Preictal     0.4500    0.4286    0.4390        21

    accuracy                         0.4524        42
   macro avg     0.4523    0.4524    0.4521        42
weighted avg     0.4523    0.4524    0.4521        42
              precision    recall  f1-score   support

  Interictal     0.4545    0.4762    0.4651        21
    Preictal     0.4500    0.4286    0.4390        21

    accuracy                         0.4524        42
   macro avg     0.4523    0.4524    0.4521        42
weighted avg     0.4523    0.4524    0.4521        42



✅ Results saved to model\chb15_fold16\test_results.json
✅ Results saved to model\chb15_fold16\test_results.json


============================================================
============================================================

EVALUATING FOLD 17/19
EVALUATING FOLD 17/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold17
Dataset prefix: chb15_fold17
Using test dataset: preprocessing\data\chb15_fold17\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold17\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold17\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold17\test_dataset.h5...
  - Normalization: z-score, mean=-0.7200, std=2.0018
  - Normalization: z-score, mean=-0.7200, std=2.0018
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.6350, 3.9236]
  - Value range: [-5.6350, 3.9236]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold17\epoch_005.pth...
Loading model checkpoint from model\chb15_fold17\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.09it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.09it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7177
Loss:      0.7177
Accuracy:  0.5000 (50.00%)
Accuracy:  0.5000 (50.00%)
Precision: 0.5000
Precision: 0.5000
Recall:    0.6667
Recall:    0.6667
F1 Score:  0.5714
F1 Score:  0.5714
AUC-ROC:   0.4490
AUC-ROC:   0.4490

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         7        14
Actual Interictal         7        14
       Preictal         7        14
       Preictal         7        14

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 14 samples
Pred Interictal (0): 14 samples
Pred Preictal (1):   28 samples
Pred Preictal (1):   28 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5000    0.3333    0.4000        21
    Preictal     0.5000    0.6667    0.5714        21

    accuracy                         0.5000        42
   macro avg     0.5000    0.5000    0.4857        42
weighted avg     0.5000    0.5000    0.4857        42
              precision    recall  f1-score   support

  Interictal     0.5000    0.3333    0.4000        21
    Preictal     0.5000    0.6667    0.5714        21

    accuracy                         0.5000        42
   macro avg     0.5000    0.5000    0.4857        42
weighted avg     0.5000    0.5000    0.4857        42



✅ Results saved to model\chb15_fold17\test_results.json
✅ Results saved to model\chb15_fold17\test_results.json


============================================================
============================================================

EVALUATING FOLD 18/19
EVALUATING FOLD 18/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold18
Dataset prefix: chb15_fold18
Using test dataset: preprocessing\data\chb15_fold18\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold18\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold18\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold18\test_dataset.h5...
  - Normalization: z-score, mean=-0.7434, std=1.9952
  - Normalization: z-score, mean=-0.7434, std=1.9952
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.6418, 4.0024]
  - Value range: [-5.6418, 4.0024]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold18\epoch_005.pth...
Loading model checkpoint from model\chb15_fold18\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.25it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.25it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6956
Loss:      0.6956
Accuracy:  0.5500 (55.00%)
Accuracy:  0.5500 (55.00%)
Precision: 0.5385
Precision: 0.5385
Recall:    0.7000
Recall:    0.7000
F1 Score:  0.6087
F1 Score:  0.6087
AUC-ROC:   0.5200
AUC-ROC:   0.5200

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         8        12
Actual Interictal         8        12
       Preictal         6        14
       Preictal         6        14

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 14 samples
Pred Interictal (0): 14 samples
Pred Preictal (1):   26 samples
Pred Preictal (1):   26 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5714    0.4000    0.4706        20
    Preictal     0.5385    0.7000    0.6087        20

    accuracy                         0.5500        40
   macro avg     0.5549    0.5500    0.5396        40
weighted avg     0.5549    0.5500    0.5396        40
              precision    recall  f1-score   support

  Interictal     0.5714    0.4000    0.4706        20
    Preictal     0.5385    0.7000    0.6087        20

    accuracy                         0.5500        40
   macro avg     0.5549    0.5500    0.5396        40
weighted avg     0.5549    0.5500    0.5396        40



✅ Results saved to model\chb15_fold18\test_results.json
✅ Results saved to model\chb15_fold18\test_results.json


============================================================
============================================================

EVALUATING FOLD 19/19
EVALUATING FOLD 19/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold19
Dataset prefix: chb15_fold19
Using test dataset: preprocessing\data\chb15_fold19\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold19\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold19\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold19\test_dataset.h5...
  - Normalization: z-score, mean=-0.7881, std=2.0138
  - Normalization: z-score, mean=-0.7881, std=2.0138
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-5.5676, 3.9876]
  - Value range: [-5.5676, 3.9876]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold19\epoch_005.pth...
Loading model checkpoint from model\chb15_fold19\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.18it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.18it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.07it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.07it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6888
Loss:      0.6888
Accuracy:  0.4583 (45.83%)
Accuracy:  0.4583 (45.83%)
Precision: 0.4167
Precision: 0.4167
Recall:    0.2083
Recall:    0.2083
F1 Score:  0.2778
F1 Score:  0.2778
AUC-ROC:   0.6076
AUC-ROC:   0.6076

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        17         7
Actual Interictal        17         7
       Preictal        19         5
       Preictal        19         5

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 36 samples
Pred Interictal (0): 36 samples
Pred Preictal (1):   12 samples
Pred Preictal (1):   12 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4722    0.7083    0.5667        24
    Preictal     0.4167    0.2083    0.2778        24

    accuracy                         0.4583        48
   macro avg     0.4444    0.4583    0.4222        48
weighted avg     0.4444    0.4583    0.4222        48
              precision    recall  f1-score   support

  Interictal     0.4722    0.7083    0.5667        24
    Preictal     0.4167    0.2083    0.2778        24

    accuracy                         0.4583        48
   macro avg     0.4444    0.4583    0.4222        48
weighted avg     0.4444    0.4583    0.4222        48



✅ Results saved to model\chb15_fold19\test_results.json
✅ Results saved to model\chb15_fold19\test_results.json


============================================================
============================================================

BATCH EVALUATION SUMMARY
BATCH EVALUATION SUMMARY
============================================================
============================================================
Folds evaluated: 20/20
Folds evaluated: 20/20

Mean metrics (across folds):
Mean metrics (across folds):

  Accuracy:  0.4596 (±0.1248)
  Accuracy:  0.4596 (±0.1248)
  Precision: 0.3067 (±0.2410)
  Precision: 0.3067 (±0.2410)
  Recall:    0.3655 (±0.3597)
  Recall:    0.3655 (±0.3597)
  F1 Score:  0.3219 (±0.2807)
  F1 Score:  0.3219 (±0.2807)
  AUC-ROC:   0.4026 (±0.2097)
  AUC-ROC:   0.4026 (±0.2097)

✅ Batch results saved to model\batch_test_results.json
✅ Batch results saved to model\batch_test_results.json

============================================================
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 20 folds for patient chb15
============================================================

============================================================
TRAINING FOLD 0/19
============================================================
Using dataset prefix: chb15_fold0
Loading datasets from: preprocessing\data\chb15_fold0
Saving models to: model\chb15_fold0
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.6990, std=2.0063
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6328, 4.1259]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 0): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6992, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:51,  4.64s/it, loss=0.6992, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:51,  4.64s/it, loss=0.6908, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:19,  1.98s/it, loss=0.6908, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:19,  1.98s/it, loss=0.6791, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:10,  1.12s/it, loss=0.6791, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:10,  1.12s/it, loss=0.6969, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.39it/s, loss=0.6969, gradTraining Epoch 1/5:  33%|3| 4/12 [00:05<00:05,  1.39it/s, loss=0.6882, gradTraining Epoch 1/5:  42%|4| 5/12 [00:05<00:03,  2.00it/s, loss=0.6882, gradTraining Epoch 1/5:  42%|4| 5/12 [00:05<00:03,  2.00it/s, loss=0.6796, gradTraining Epoch 1/5:  50%|5| 6/12 [00:05<00:02,  2.73it/s, loss=0.6796, gradTraining Epoch 1/5:  50%|5| 6/12 [00:05<00:02,  2.73it/s, loss=0.7002, gradTraining Epoch 1/5:  58%|5| 7/12 [00:05<00:01,  3.55it/s, loss=0.7002, gradTraining Epoch 1/5:  58%|5| 7/12 [00:05<00:01,  3.55it/s, loss=0.7117, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.42it/s, loss=0.7117, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.42it/s, loss=0.6738, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.26it/s, loss=0.6738, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.26it/s, loss=0.6922, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.07it/s, loss=0.6922, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.07it/s, loss=0.6923, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.78it/s, loss=0.6923, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.78it/s, loss=0.6934, graTraining Epoch 1/5: 100%|#| 12/12 [00:06<00:00,  1.86it/s, loss=0.6934, gra

Epoch 1/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6914, Acc: 0.4837, Precision: 0.4211, Recall: 0.0870, F1: 0.1441, AUC: 0.5554
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7005, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:45,  4.09s/it, loss=0.7005, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:45,  4.09s/it, loss=0.7006, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.7006, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6785, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6785, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6923, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6923, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6954, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.6954, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.6900, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6900, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6999, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6999, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6902, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.65it/s, loss=0.6902, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.65it/s, loss=0.6773, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.47it/s, loss=0.6773, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.47it/s, loss=0.6916, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.22it/s, loss=0.6916, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.22it/s, loss=0.6807, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.80it/s, loss=0.6807, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.80it/s, loss=0.6682, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.03it/s, loss=0.6682, gra

Epoch 2/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6888, Acc: 0.5707, Precision: 0.6066, Recall: 0.4022, F1: 0.4837, AUC: 0.5763
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6859, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:45,  4.13s/it, loss=0.6859, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:45,  4.13s/it, loss=0.6907, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.6907, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.6842, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6842, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6834, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6834, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6890, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.16it/s, loss=0.6890, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.16it/s, loss=0.6954, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.91it/s, loss=0.6954, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.91it/s, loss=0.6888, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.73it/s, loss=0.6888, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.73it/s, loss=0.6864, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.59it/s, loss=0.6864, gradTraining Epoch 3/5:  67%|6| 8/12 [00:05<00:00,  4.59it/s, loss=0.6847, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.08it/s, loss=0.6847, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.08it/s, loss=0.6719, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.90it/s, loss=0.6719, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.90it/s, loss=0.6797, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.61it/s, loss=0.6797, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.61it/s, loss=0.6601, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.02it/s, loss=0.6601, gra

Epoch 3/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6833, Acc: 0.5870, Precision: 0.5769, Recall: 0.6522, F1: 0.6122, AUC: 0.6398
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6749, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:45,  4.16s/it, loss=0.6749, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:45,  4.16s/it, loss=0.6863, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6863, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6636, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.03s/it, loss=0.6636, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.03s/it, loss=0.6693, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.49it/s, loss=0.6693, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.49it/s, loss=0.6741, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.13it/s, loss=0.6741, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.13it/s, loss=0.6688, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.89it/s, loss=0.6688, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.89it/s, loss=0.6905, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.73it/s, loss=0.6905, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.73it/s, loss=0.6781, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.59it/s, loss=0.6781, gradTraining Epoch 4/5:  67%|6| 8/12 [00:05<00:00,  4.59it/s, loss=0.6756, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.44it/s, loss=0.6756, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.44it/s, loss=0.6993, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.23it/s, loss=0.6993, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.23it/s, loss=0.6853, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.6853, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.6962, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.02it/s, loss=0.6962, gra

Epoch 4/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6802, Acc: 0.6413, Precision: 0.6161, Recall: 0.7500, F1: 0.6765, AUC: 0.6919
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6695, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:03<00:43,  3.97s/it, loss=0.6695, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:43,  3.97s/it, loss=0.6819, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.70s/it, loss=0.6819, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.70s/it, loss=0.6663, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.6663, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.6794, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.58it/s, loss=0.6794, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.58it/s, loss=0.6542, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.26it/s, loss=0.6542, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.26it/s, loss=0.6675, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.04it/s, loss=0.6675, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.04it/s, loss=0.6742, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.89it/s, loss=0.6742, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.89it/s, loss=0.6655, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.77it/s, loss=0.6655, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.77it/s, loss=0.6846, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.62it/s, loss=0.6846, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.62it/s, loss=0.6642, gradTraining Epoch 5/5:  83%|8| 10/12 [00:04<00:00,  6.38it/s, loss=0.6642, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.38it/s, loss=0.6575, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.03it/s, loss=0.6575, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.03it/s, loss=0.6792, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.11it/s, loss=0.6792, gra

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6703, Acc: 0.6848, Precision: 0.6604, Recall: 0.7609, F1: 0.7071, AUC: 0.7357
------------------------------------------------------------
Training curves saved to model\chb15_fold0\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold0
============================================================
✅ Fold 0 training completed successfully!

============================================================
TRAINING FOLD 1/19
============================================================
Using dataset prefix: chb15_fold1
Loading datasets from: preprocessing\data\chb15_fold1
Saving models to: model\chb15_fold1
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7261, std=2.0020
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6314, 4.1179]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 1): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6859, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.09s/it, loss=0.6859, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.09s/it, loss=0.6860, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6860, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6975, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.6975, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.7052, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.7052, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6990, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6990, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.7014, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.7014, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6905, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6905, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6858, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6858, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6804, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.51it/s, loss=0.6804, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.51it/s, loss=0.6995, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.26it/s, loss=0.6995, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.26it/s, loss=0.6937, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.88it/s, loss=0.6937, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.88it/s, loss=0.6721, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.06it/s, loss=0.6721, gra

Epoch 1/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6914, Acc: 0.5109, Precision: 0.5100, Recall: 0.5543, F1: 0.5312, AUC: 0.5365
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6890, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.00s/it, loss=0.6890, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.00s/it, loss=0.6812, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6812, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6917, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6917, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6864, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6864, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6871, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6871, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6879, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6879, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6928, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.80it/s, loss=0.6928, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.80it/s, loss=0.6898, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.65it/s, loss=0.6898, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.65it/s, loss=0.6952, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.45it/s, loss=0.6952, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.45it/s, loss=0.6915, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.19it/s, loss=0.6915, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.19it/s, loss=0.6939, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.90it/s, loss=0.6939, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.90it/s, loss=0.7090, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.7090, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6913, Acc: 0.5326, Precision: 0.5536, Recall: 0.3370, F1: 0.4189, AUC: 0.5679
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6847, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6847, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6908, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6908, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6808, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6808, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6841, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6841, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6894, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6894, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6911, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6911, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6876, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6876, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6832, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6832, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6772, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6772, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6834, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6834, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6902, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6902, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6904, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6904, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6861, Acc: 0.6033, Precision: 0.6092, Recall: 0.5761, F1: 0.5922, AUC: 0.6388
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6880, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6880, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6955, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6955, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6879, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6879, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6850, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6850, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6890, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6890, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6804, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6804, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6873, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6873, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6851, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6851, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6797, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6797, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.56it/s, loss=0.6946, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.38it/s, loss=0.6946, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.38it/s, loss=0.6688, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  7.07it/s, loss=0.6688, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  7.07it/s, loss=0.6640, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6640, gra

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6838, Acc: 0.6087, Precision: 0.5806, Recall: 0.7826, F1: 0.6667, AUC: 0.6654
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6812, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:03<00:43,  3.94s/it, loss=0.6812, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:43,  3.94s/it, loss=0.6879, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:16,  1.69s/it, loss=0.6879, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:16,  1.69s/it, loss=0.6697, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6697, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6856, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.60it/s, loss=0.6856, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.60it/s, loss=0.6760, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6760, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6721, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.06it/s, loss=0.6721, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.06it/s, loss=0.6718, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.92it/s, loss=0.6718, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.92it/s, loss=0.6791, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.81it/s, loss=0.6791, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.81it/s, loss=0.6854, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.67it/s, loss=0.6854, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.67it/s, loss=0.6680, gradTraining Epoch 5/5:  83%|8| 10/12 [00:04<00:00,  6.45it/s, loss=0.6680, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.45it/s, loss=0.6819, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.13it/s, loss=0.6819, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.13it/s, loss=0.6725, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.13it/s, loss=0.6725, gra

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6776, Acc: 0.6630, Precision: 0.6339, Recall: 0.7717, F1: 0.6961, AUC: 0.7222
------------------------------------------------------------
Training curves saved to model\chb15_fold1\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold1
============================================================
✅ Fold 1 training completed successfully!

============================================================
TRAINING FOLD 2/19
============================================================
Using dataset prefix: chb15_fold2
Loading datasets from: preprocessing\data\chb15_fold2
Saving models to: model\chb15_fold2
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7786, std=2.0184
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5596, 4.1446]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 2): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6923, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6923, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6956, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6956, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6848, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6848, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6896, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6896, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.7087, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.7087, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6845, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6845, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6877, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6877, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6920, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6920, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6884, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.51it/s, loss=0.6884, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.51it/s, loss=0.7004, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.7004, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.7058, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.7058, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.6899, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.06it/s, loss=0.6899, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6933, Acc: 0.5380, Precision: 0.5778, Recall: 0.2826, F1: 0.3796, AUC: 0.5204
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6841, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6841, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6798, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6798, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.7124, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.7124, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6905, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6905, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6923, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6923, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6921, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6921, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.7071, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.7071, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.7031, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.7031, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6988, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.55it/s, loss=0.6988, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.55it/s, loss=0.6826, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.6826, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.7238, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.81it/s, loss=0.7238, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.81it/s, loss=0.6945, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6945, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6968, Acc: 0.4783, Precision: 0.4615, Recall: 0.2609, F1: 0.3333, AUC: 0.4448
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6968, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6968, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6947, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6947, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6862, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6862, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6814, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6814, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6932, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6932, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6960, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6960, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.7036, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.7036, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6842, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6842, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6927, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6927, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6804, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.26it/s, loss=0.6804, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.26it/s, loss=0.6941, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6941, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6747, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6747, gra

Epoch 3/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6898, Acc: 0.5000, Precision: 0.5000, Recall: 0.5000, F1: 0.5000, AUC: 0.5408
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6711, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:03<00:41,  3.81s/it, loss=0.6711, gradTraining Epoch 4/5:   8%| | 1/12 [00:03<00:41,  3.81s/it, loss=0.6813, gradTraining Epoch 4/5:  17%|1| 2/12 [00:03<00:16,  1.64s/it, loss=0.6813, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:16,  1.64s/it, loss=0.6732, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.06it/s, loss=0.6732, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.06it/s, loss=0.6717, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:04,  1.64it/s, loss=0.6717, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:04,  1.64it/s, loss=0.6791, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.33it/s, loss=0.6791, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.33it/s, loss=0.6737, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.12it/s, loss=0.6737, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.12it/s, loss=0.6784, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.99it/s, loss=0.6784, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.99it/s, loss=0.6812, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.85it/s, loss=0.6812, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.85it/s, loss=0.6758, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.69it/s, loss=0.6758, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.69it/s, loss=0.6912, gradTraining Epoch 4/5:  83%|8| 10/12 [00:04<00:00,  6.44it/s, loss=0.6912, graTraining Epoch 4/5:  83%|8| 10/12 [00:04<00:00,  6.44it/s, loss=0.6883, graTraining Epoch 4/5:  92%|9| 11/12 [00:04<00:00,  7.09it/s, loss=0.6883, graTraining Epoch 4/5:  92%|9| 11/12 [00:04<00:00,  7.09it/s, loss=0.6790, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.17it/s, loss=0.6790, gra

Epoch 4/5 Complete (5.9s) [LR: 0.000010]
Train - Loss: 0.6787, Acc: 0.6630, Precision: 0.6471, Recall: 0.7174, F1: 0.6804, AUC: 0.7228
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6803, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6803, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6861, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6861, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6963, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6963, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6852, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6852, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6940, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.6940, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.6804, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6804, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6838, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.79it/s, loss=0.6838, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.79it/s, loss=0.6727, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6727, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6849, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.51it/s, loss=0.6849, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.51it/s, loss=0.6814, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6814, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6772, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.93it/s, loss=0.6772, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.93it/s, loss=0.6643, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6643, gra

Epoch 5/5 Complete (6.4s) [LR: 0.000005]
Train - Loss: 0.6822, Acc: 0.6250, Precision: 0.6575, Recall: 0.5217, F1: 0.5818, AUC: 0.6578
------------------------------------------------------------
Training curves saved to model\chb15_fold2\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold2
============================================================
✅ Fold 2 training completed successfully!

============================================================
TRAINING FOLD 3/19
============================================================
Using dataset prefix: chb15_fold3
Loading datasets from: preprocessing\data\chb15_fold3
Saving models to: model\chb15_fold3
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7693, std=2.0298
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5328, 4.1148]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 3): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6844, grad_norm=0.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6844, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6899, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6899, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6895, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6895, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6887, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6887, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6999, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.16it/s, loss=0.6999, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.16it/s, loss=0.6914, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.6914, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.7027, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.73it/s, loss=0.7027, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.73it/s, loss=0.6954, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.61it/s, loss=0.6954, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.61it/s, loss=0.6972, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.45it/s, loss=0.6972, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.45it/s, loss=0.7062, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.20it/s, loss=0.7062, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.20it/s, loss=0.6959, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.86it/s, loss=0.6959, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.86it/s, loss=0.7194, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.05it/s, loss=0.7194, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6967, Acc: 0.4837, Precision: 0.4872, Recall: 0.6196, F1: 0.5455, AUC: 0.4770
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6833, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:03<00:43,  3.99s/it, loss=0.6833, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:43,  3.99s/it, loss=0.6671, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.71s/it, loss=0.6671, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.71s/it, loss=0.6834, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6834, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6779, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6779, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6744, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6744, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6995, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6995, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.7083, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.7083, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6811, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6811, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6926, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.25it/s, loss=0.6926, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.25it/s, loss=0.7059, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.01it/s, loss=0.7059, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.01it/s, loss=0.6828, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.70it/s, loss=0.6828, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.70it/s, loss=0.6912, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6912, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6873, Acc: 0.5435, Precision: 0.5256, Recall: 0.8913, F1: 0.6613, AUC: 0.6099
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6841, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6841, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6968, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6968, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6867, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6867, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6814, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6814, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6738, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6738, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6885, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.93it/s, loss=0.6885, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.93it/s, loss=0.6982, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.68it/s, loss=0.6982, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.68it/s, loss=0.6795, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.40it/s, loss=0.6795, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.40it/s, loss=0.6874, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.23it/s, loss=0.6874, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.23it/s, loss=0.7067, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.83it/s, loss=0.7067, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.83it/s, loss=0.6760, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.33it/s, loss=0.6760, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.33it/s, loss=0.7112, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.05it/s, loss=0.7112, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6892, Acc: 0.5109, Precision: 0.5079, Recall: 0.6957, F1: 0.5872, AUC: 0.5799
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6862, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:03<00:43,  3.97s/it, loss=0.6862, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:43,  3.97s/it, loss=0.6826, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:16,  1.70s/it, loss=0.6826, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:16,  1.70s/it, loss=0.6923, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.6923, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.6952, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.58it/s, loss=0.6952, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.58it/s, loss=0.6924, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.26it/s, loss=0.6924, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.26it/s, loss=0.6776, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.03it/s, loss=0.6776, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.03it/s, loss=0.6801, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.90it/s, loss=0.6801, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.90it/s, loss=0.6821, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.79it/s, loss=0.6821, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.79it/s, loss=0.6968, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.65it/s, loss=0.6968, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.65it/s, loss=0.6807, gradTraining Epoch 4/5:  83%|8| 10/12 [00:04<00:00,  6.43it/s, loss=0.6807, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.43it/s, loss=0.6867, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  7.11it/s, loss=0.6867, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  7.11it/s, loss=0.6657, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.11it/s, loss=0.6657, gra

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6849, Acc: 0.5489, Precision: 0.5372, Recall: 0.7065, F1: 0.6103, AUC: 0.6083
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6820, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6820, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6675, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6675, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6752, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6752, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6959, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6959, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6770, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6770, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6616, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6616, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6773, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6773, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6761, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6761, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6942, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.58it/s, loss=0.6942, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.58it/s, loss=0.6705, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.38it/s, loss=0.6705, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.38it/s, loss=0.6855, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6855, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6782, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6782, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6784, Acc: 0.6793, Precision: 0.6774, Recall: 0.6848, F1: 0.6811, AUC: 0.7302
------------------------------------------------------------
Training curves saved to model\chb15_fold3\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold3
============================================================
✅ Fold 3 training completed successfully!

============================================================
TRAINING FOLD 4/19
============================================================
Using dataset prefix: chb15_fold4
Loading datasets from: preprocessing\data\chb15_fold4
Saving models to: model\chb15_fold4
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.8223, std=2.0052
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5745, 4.1773]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 4): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6895, grad_norm=0.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6895, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6981, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6981, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6984, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6984, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6912, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6912, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6818, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6818, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6937, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6937, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6893, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6893, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6939, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6939, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6999, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6999, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6882, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.6882, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.6969, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.89it/s, loss=0.6969, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.89it/s, loss=0.6904, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.06it/s, loss=0.6904, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6926, Acc: 0.5000, Precision: 0.5000, Recall: 0.4457, F1: 0.4713, AUC: 0.5137
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6932, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6932, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6877, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6877, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6942, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6942, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.7001, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.7001, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6861, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.6861, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.6913, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.6913, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.6895, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.66it/s, loss=0.6895, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.66it/s, loss=0.6884, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.39it/s, loss=0.6884, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.39it/s, loss=0.6839, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.17it/s, loss=0.6839, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.17it/s, loss=0.6960, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  5.81it/s, loss=0.6960, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  5.81it/s, loss=0.6975, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.32it/s, loss=0.6975, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.32it/s, loss=0.6853, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.04it/s, loss=0.6853, gra

Epoch 2/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6911, Acc: 0.5326, Precision: 0.5366, Recall: 0.4783, F1: 0.5057, AUC: 0.5461
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6974, grad_norm=0.Training Epoch 3/5:   8%| | 1/12 [00:04<00:45,  4.12s/it, loss=0.6974, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:45,  4.12s/it, loss=0.6971, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6971, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6923, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6923, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6898, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.52it/s, loss=0.6898, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.52it/s, loss=0.6724, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.16it/s, loss=0.6724, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.16it/s, loss=0.6905, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.93it/s, loss=0.6905, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.93it/s, loss=0.6760, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.76it/s, loss=0.6760, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.76it/s, loss=0.7030, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.63it/s, loss=0.7030, gradTraining Epoch 3/5:  67%|6| 8/12 [00:05<00:00,  4.63it/s, loss=0.6811, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.33it/s, loss=0.6811, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.33it/s, loss=0.6884, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.93it/s, loss=0.6884, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  5.93it/s, loss=0.6833, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.64it/s, loss=0.6833, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.64it/s, loss=0.6952, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.03it/s, loss=0.6952, gra

Epoch 3/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6889, Acc: 0.5109, Precision: 0.5147, Recall: 0.3804, F1: 0.4375, AUC: 0.5712
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6762, grad_norm=0.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6762, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6889, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6889, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6896, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6896, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6984, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6984, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6709, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6709, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6940, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6940, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6950, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.76it/s, loss=0.6950, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.76it/s, loss=0.6953, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.49it/s, loss=0.6953, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.49it/s, loss=0.6820, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.17it/s, loss=0.6820, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.17it/s, loss=0.6829, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.75it/s, loss=0.6829, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.75it/s, loss=0.6852, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.23it/s, loss=0.6852, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.23it/s, loss=0.6816, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.03it/s, loss=0.6816, gra

Epoch 4/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6867, Acc: 0.5978, Precision: 0.6216, Recall: 0.5000, F1: 0.5542, AUC: 0.6027
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6768, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:03<00:43,  3.96s/it, loss=0.6768, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:43,  3.96s/it, loss=0.6674, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:16,  1.70s/it, loss=0.6674, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:16,  1.70s/it, loss=0.6838, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.6838, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.6744, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.58it/s, loss=0.6744, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.58it/s, loss=0.6899, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.25it/s, loss=0.6899, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.25it/s, loss=0.6676, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.04it/s, loss=0.6676, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.04it/s, loss=0.6597, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.89it/s, loss=0.6597, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.89it/s, loss=0.6856, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.76it/s, loss=0.6856, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.76it/s, loss=0.6833, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.61it/s, loss=0.6833, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.61it/s, loss=0.6724, gradTraining Epoch 5/5:  83%|8| 10/12 [00:04<00:00,  6.34it/s, loss=0.6724, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.7034, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.97it/s, loss=0.7034, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.97it/s, loss=0.6981, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.11it/s, loss=0.6981, gra

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6802, Acc: 0.6630, Precision: 0.6667, Recall: 0.6522, F1: 0.6593, AUC: 0.6998
------------------------------------------------------------
Training curves saved to model\chb15_fold4\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold4
============================================================
✅ Fold 4 training completed successfully!

============================================================
TRAINING FOLD 5/19
============================================================
Using dataset prefix: chb15_fold5
Loading datasets from: preprocessing\data\chb15_fold5
Saving models to: model\chb15_fold5
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.6832, std=1.9928
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6787, 4.1500]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 5): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6797, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.09s/it, loss=0.6797, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.09s/it, loss=0.6864, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.6864, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.7004, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.7004, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6819, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.50it/s, loss=0.6819, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.50it/s, loss=0.7174, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.11it/s, loss=0.7174, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.11it/s, loss=0.6997, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.81it/s, loss=0.6997, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.81it/s, loss=0.6923, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.60it/s, loss=0.6923, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.60it/s, loss=0.7375, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.48it/s, loss=0.7375, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.48it/s, loss=0.7076, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.35it/s, loss=0.7076, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.35it/s, loss=0.6599, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  5.99it/s, loss=0.6599, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  5.99it/s, loss=0.7156, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.41it/s, loss=0.7156, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.41it/s, loss=0.6507, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.01it/s, loss=0.6507, gra

Epoch 1/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6941, Acc: 0.5000, Precision: 0.5000, Recall: 0.9783, F1: 0.6618, AUC: 0.4904
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7235, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.7235, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6860, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6860, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.7049, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.7049, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.7077, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.7077, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6735, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6735, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6847, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6847, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.7023, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.7023, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6890, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6890, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6857, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6857, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6942, gradTraining Epoch 2/5:  83%|8| 10/12 [00:04<00:00,  6.36it/s, loss=0.6942, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.36it/s, loss=0.6721, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6721, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6793, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6793, gra

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6919, Acc: 0.5272, Precision: 0.5152, Recall: 0.9239, F1: 0.6615, AUC: 0.5261
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6725, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6725, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6849, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6849, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6962, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6962, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6990, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6990, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6776, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6776, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6718, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6718, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6737, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6737, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.7078, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.7078, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6774, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.58it/s, loss=0.6774, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.58it/s, loss=0.7164, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.21it/s, loss=0.7164, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.21it/s, loss=0.7267, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.89it/s, loss=0.7267, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.89it/s, loss=0.6586, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6586, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6886, Acc: 0.5217, Precision: 0.5123, Recall: 0.9022, F1: 0.6535, AUC: 0.5603
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7017, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.7017, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6728, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6728, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6888, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6888, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6744, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6744, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6669, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6669, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6846, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6846, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6783, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6783, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6829, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.64it/s, loss=0.6829, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.64it/s, loss=0.6733, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.30it/s, loss=0.6733, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.30it/s, loss=0.6781, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.89it/s, loss=0.6781, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  5.89it/s, loss=0.6754, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.36it/s, loss=0.6754, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.36it/s, loss=0.6944, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.04it/s, loss=0.6944, gra

Epoch 4/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6810, Acc: 0.6087, Precision: 0.5725, Recall: 0.8587, F1: 0.6870, AUC: 0.6881
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6727, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6727, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6782, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6782, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6801, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6801, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6938, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6938, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6882, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6882, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6669, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6669, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6702, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.70it/s, loss=0.6702, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.70it/s, loss=0.6919, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.54it/s, loss=0.6919, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.54it/s, loss=0.6672, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.21it/s, loss=0.6672, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.21it/s, loss=0.6536, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  5.92it/s, loss=0.6536, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  5.92it/s, loss=0.6762, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.42it/s, loss=0.6762, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.42it/s, loss=0.6672, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.04it/s, loss=0.6672, gra

Epoch 5/5 Complete (6.3s) [LR: 0.000005]
Train - Loss: 0.6755, Acc: 0.6359, Precision: 0.6087, Recall: 0.7609, F1: 0.6763, AUC: 0.6819
------------------------------------------------------------
Training curves saved to model\chb15_fold5\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold5
============================================================
✅ Fold 5 training completed successfully!

============================================================
TRAINING FOLD 6/19
============================================================
Using dataset prefix: chb15_fold6
Loading datasets from: preprocessing\data\chb15_fold6
Saving models to: model\chb15_fold6
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7357, std=2.0057
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6162, 4.1393]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 6): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6990, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.17s/it, loss=0.6990, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.17s/it, loss=0.6943, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6943, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6919, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6919, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6905, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6905, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6978, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.6978, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.6888, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.93it/s, loss=0.6888, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.93it/s, loss=0.6912, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.76it/s, loss=0.6912, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.76it/s, loss=0.6874, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.62it/s, loss=0.6874, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.62it/s, loss=0.6912, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.45it/s, loss=0.6912, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.45it/s, loss=0.6867, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.20it/s, loss=0.6867, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.20it/s, loss=0.6954, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.87it/s, loss=0.6954, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.87it/s, loss=0.6860, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.03it/s, loss=0.6860, gra

Epoch 1/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6917, Acc: 0.5054, Precision: 0.5068, Recall: 0.4022, F1: 0.4485, AUC: 0.5338
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6801, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6801, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6948, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6948, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6896, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6896, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6979, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6979, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6859, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6859, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6951, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6951, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6983, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6983, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6862, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6862, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6899, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.54it/s, loss=0.6899, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.54it/s, loss=0.6884, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.30it/s, loss=0.6884, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.30it/s, loss=0.6922, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6922, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6898, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6898, gra

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6907, Acc: 0.5543, Precision: 0.5581, Recall: 0.5217, F1: 0.5393, AUC: 0.5724
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6902, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.08s/it, loss=0.6902, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.08s/it, loss=0.6899, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6899, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6804, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6804, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6851, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6851, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6885, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6885, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6681, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6681, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.7060, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.7060, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6826, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6826, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6735, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.54it/s, loss=0.6735, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.54it/s, loss=0.7021, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.7021, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.6898, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.6898, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.6912, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6912, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6873, Acc: 0.5978, Precision: 0.6500, Recall: 0.4239, F1: 0.5132, AUC: 0.6297
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6963, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6963, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6999, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6999, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6893, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6893, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6996, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6996, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6879, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6879, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.7128, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.7128, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6917, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6917, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.7058, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.7058, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6847, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.46it/s, loss=0.6847, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.46it/s, loss=0.6879, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.16it/s, loss=0.6879, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.16it/s, loss=0.6926, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.79it/s, loss=0.6926, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.79it/s, loss=0.6874, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.05it/s, loss=0.6874, gra

Epoch 4/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6946, Acc: 0.5000, Precision: 0.5000, Recall: 0.3696, F1: 0.4250, AUC: 0.4848
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6728, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6728, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6712, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6712, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6788, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6788, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6812, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6812, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6798, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6798, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6713, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6713, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6978, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6978, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6947, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6947, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6841, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.55it/s, loss=0.6841, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.55it/s, loss=0.6716, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.35it/s, loss=0.6716, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.35it/s, loss=0.6850, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6850, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6886, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6886, gra

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6814, Acc: 0.6413, Precision: 0.7407, Recall: 0.4348, F1: 0.5479, AUC: 0.7027
------------------------------------------------------------
Training curves saved to model\chb15_fold6\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold6
============================================================
✅ Fold 6 training completed successfully!

============================================================
TRAINING FOLD 7/19
============================================================
Using dataset prefix: chb15_fold7
Loading datasets from: preprocessing\data\chb15_fold7
Saving models to: model\chb15_fold7
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.6591, std=1.9858
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.7109, 4.1511]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 7): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6925, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6925, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.7038, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.7038, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6890, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6890, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6976, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6976, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6951, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6951, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6917, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6917, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.7137, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.7137, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6927, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.63it/s, loss=0.6927, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.63it/s, loss=0.6855, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.47it/s, loss=0.6855, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.47it/s, loss=0.6945, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.26it/s, loss=0.6945, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.26it/s, loss=0.6928, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.6928, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.6988, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6988, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6957, Acc: 0.5000, Precision: 0.5000, Recall: 0.8696, F1: 0.6349, AUC: 0.4500
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6876, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6876, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6896, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6896, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6971, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6971, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6915, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6915, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6918, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6918, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6894, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6894, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6872, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6872, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6875, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6875, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6923, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.55it/s, loss=0.6923, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.55it/s, loss=0.6994, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6994, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6966, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6966, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6880, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6880, gra

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6915, Acc: 0.5326, Precision: 0.5227, Recall: 0.7500, F1: 0.6161, AUC: 0.5523
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6928, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6928, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6922, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6922, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6915, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6915, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6934, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6934, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6830, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6830, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6853, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6853, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6867, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6867, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6914, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6914, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6861, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6861, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.57it/s, loss=0.6928, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6928, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6892, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.6892, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.6774, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6774, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6885, Acc: 0.5761, Precision: 0.6094, Recall: 0.4239, F1: 0.5000, AUC: 0.5912
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6857, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:03<00:43,  3.93s/it, loss=0.6857, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:43,  3.93s/it, loss=0.6774, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:16,  1.68s/it, loss=0.6774, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:16,  1.68s/it, loss=0.6881, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6881, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6824, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.60it/s, loss=0.6824, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.60it/s, loss=0.6700, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6700, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6716, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.07it/s, loss=0.6716, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.07it/s, loss=0.6850, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.91it/s, loss=0.6850, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.91it/s, loss=0.6989, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.77it/s, loss=0.6989, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.77it/s, loss=0.6802, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.60it/s, loss=0.6802, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.60it/s, loss=0.6783, gradTraining Epoch 4/5:  83%|8| 10/12 [00:04<00:00,  6.38it/s, loss=0.6783, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.38it/s, loss=0.6927, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  7.01it/s, loss=0.6927, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  7.01it/s, loss=0.6896, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.12it/s, loss=0.6896, gra

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6833, Acc: 0.5652, Precision: 0.6304, Recall: 0.3152, F1: 0.4203, AUC: 0.6548
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6742, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6742, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6723, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6723, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6758, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6758, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6779, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6779, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6751, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6751, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6661, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6661, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6814, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6814, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.7088, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.7088, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6861, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.32it/s, loss=0.6861, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.32it/s, loss=0.6502, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.05it/s, loss=0.6502, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.05it/s, loss=0.6710, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.79it/s, loss=0.6710, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.79it/s, loss=0.6951, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6951, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6778, Acc: 0.5870, Precision: 0.5769, Recall: 0.6522, F1: 0.6122, AUC: 0.6853
------------------------------------------------------------
Training curves saved to model\chb15_fold7\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold7
============================================================
✅ Fold 7 training completed successfully!

============================================================
TRAINING FOLD 8/19
============================================================
Using dataset prefix: chb15_fold8
Loading datasets from: preprocessing\data\chb15_fold8
Saving models to: model\chb15_fold8
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7176, std=2.0127
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6056, 4.1158]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 8): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6997, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6997, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6877, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6877, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6837, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6837, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6881, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6881, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6936, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6936, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6980, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6980, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6901, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6901, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.7032, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.7032, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6947, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.50it/s, loss=0.6947, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.50it/s, loss=0.7065, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.7065, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.6924, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6924, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6782, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6782, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6930, Acc: 0.5326, Precision: 0.5259, Recall: 0.6630, F1: 0.5865, AUC: 0.5131
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6882, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6882, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6834, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6834, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.7059, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.7059, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6855, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6855, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6926, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6926, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6914, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6914, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6841, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6841, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.7060, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.7060, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6999, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.55it/s, loss=0.6999, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.55it/s, loss=0.6881, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.32it/s, loss=0.6881, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.32it/s, loss=0.6853, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6853, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6951, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6951, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6921, Acc: 0.5489, Precision: 0.5484, Recall: 0.5543, F1: 0.5514, AUC: 0.5351
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6705, grad_norm=0.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.08s/it, loss=0.6705, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.08s/it, loss=0.6728, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6728, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6825, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.6825, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.7020, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.7020, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6953, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.6953, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.6939, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6939, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.95it/s, loss=0.6800, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.80it/s, loss=0.6800, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.80it/s, loss=0.6946, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.66it/s, loss=0.6946, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.66it/s, loss=0.6971, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.51it/s, loss=0.6971, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.51it/s, loss=0.6999, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6999, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6920, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6920, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6869, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.05it/s, loss=0.6869, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6890, Acc: 0.5435, Precision: 0.5541, Recall: 0.4457, F1: 0.4940, AUC: 0.5629
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6984, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6984, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6921, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6921, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6967, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6967, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6986, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6986, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6806, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6806, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6974, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6974, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6875, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6875, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6901, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6901, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6743, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.54it/s, loss=0.6743, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.54it/s, loss=0.6798, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.24it/s, loss=0.6798, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.24it/s, loss=0.6799, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.6799, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.6743, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6743, gra

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6875, Acc: 0.5707, Precision: 0.5942, Recall: 0.4457, F1: 0.5093, AUC: 0.5849
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6950, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6950, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.07s/it, loss=0.6929, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6929, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6973, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6973, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6971, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6971, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6875, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6875, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6802, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6802, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6718, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6718, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6753, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6753, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6781, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.53it/s, loss=0.6781, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.53it/s, loss=0.6703, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.6703, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.6799, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.01it/s, loss=0.6799, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.01it/s, loss=0.6804, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6804, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6838, Acc: 0.5598, Precision: 0.5591, Recall: 0.5652, F1: 0.5622, AUC: 0.6424
------------------------------------------------------------
Training curves saved to model\chb15_fold8\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold8
============================================================
✅ Fold 8 training completed successfully!

============================================================
TRAINING FOLD 9/19
============================================================
Using dataset prefix: chb15_fold9
Loading datasets from: preprocessing\data\chb15_fold9
Saving models to: model\chb15_fold9
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7501, std=1.9955
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6377, 4.1767]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 9): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6982, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.09s/it, loss=0.6982, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.09s/it, loss=0.7013, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.7013, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6927, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6927, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6885, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6885, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.7011, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.7011, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6858, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6858, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6865, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6865, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.7059, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.7059, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.7065, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.7065, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.7046, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.7046, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6852, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  7.01it/s, loss=0.6852, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  7.01it/s, loss=0.6811, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6811, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6948, Acc: 0.4783, Precision: 0.4783, Recall: 0.4783, F1: 0.4783, AUC: 0.4714
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6871, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6871, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6955, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6955, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6864, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6864, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6814, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6814, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6831, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6831, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6836, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6836, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6848, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6848, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6767, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6767, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6856, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.58it/s, loss=0.6856, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.58it/s, loss=0.7020, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.37it/s, loss=0.7020, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.37it/s, loss=0.6912, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6912, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6932, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6932, gra

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6875, Acc: 0.5815, Precision: 0.6056, Recall: 0.4674, F1: 0.5276, AUC: 0.6128
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6963, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6963, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6842, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6842, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6852, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6852, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6775, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6775, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6960, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6960, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6800, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6800, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6715, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6715, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6865, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6865, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6875, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.54it/s, loss=0.6875, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.54it/s, loss=0.6799, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.30it/s, loss=0.6799, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.30it/s, loss=0.6822, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.93it/s, loss=0.6822, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.93it/s, loss=0.6856, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6856, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6844, Acc: 0.6250, Precision: 0.6420, Recall: 0.5652, F1: 0.6012, AUC: 0.6560
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6869, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.09s/it, loss=0.6869, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.09s/it, loss=0.6768, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6768, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6746, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.6746, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:09,  1.00s/it, loss=0.6985, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6985, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6790, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6790, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6696, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6696, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6672, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6672, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6923, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6923, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6738, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6738, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6841, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6841, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6777, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6777, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6901, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6901, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6809, Acc: 0.6087, Precision: 0.6250, Recall: 0.5435, F1: 0.5814, AUC: 0.6796
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6731, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6731, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.06s/it, loss=0.6559, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6559, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6786, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6786, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6875, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6875, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6591, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6591, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6895, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6895, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6702, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6702, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6731, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6731, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6752, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.50it/s, loss=0.6752, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.50it/s, loss=0.6778, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.6778, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.6476, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.86it/s, loss=0.6476, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.86it/s, loss=0.6979, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.06it/s, loss=0.6979, gra

Epoch 5/5 Complete (6.3s) [LR: 0.000005]
Train - Loss: 0.6738, Acc: 0.6957, Precision: 0.7045, Recall: 0.6739, F1: 0.6889, AUC: 0.7376
------------------------------------------------------------
Training curves saved to model\chb15_fold9\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold9
============================================================
✅ Fold 9 training completed successfully!

============================================================
TRAINING FOLD 10/19
============================================================
Using dataset prefix: chb15_fold10
Loading datasets from: preprocessing\data\chb15_fold10
Saving models to: model\chb15_fold10
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7736, std=2.0327
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5230, 4.1091]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 10): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7102, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.7102, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6895, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6895, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6903, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6903, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6954, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6954, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.7024, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.7024, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6826, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6826, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6867, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6867, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.82it/s, loss=0.6951, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6951, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.7123, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.53it/s, loss=0.7123, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.53it/s, loss=0.6975, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.30it/s, loss=0.6975, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.30it/s, loss=0.6988, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.99it/s, loss=0.6988, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.99it/s, loss=0.7030, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.7030, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6970, Acc: 0.4783, Precision: 0.4630, Recall: 0.2717, F1: 0.3425, AUC: 0.4401
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6996, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.08s/it, loss=0.6996, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.08s/it, loss=0.7005, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.7005, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.75s/it, loss=0.6857, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6857, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6733, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6733, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.54it/s, loss=0.6881, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6881, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6926, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6926, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.97it/s, loss=0.6899, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6899, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6951, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6951, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6935, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.51it/s, loss=0.6935, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.51it/s, loss=0.6984, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  5.77it/s, loss=0.6984, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  5.77it/s, loss=0.7000, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.48it/s, loss=0.7000, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.48it/s, loss=0.6979, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.05it/s, loss=0.6979, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6929, Acc: 0.5707, Precision: 0.6444, Recall: 0.3152, F1: 0.4234, AUC: 0.5155
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7039, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.7039, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6802, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6802, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6973, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6973, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6995, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6995, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6838, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6838, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6892, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6892, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.7046, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.77it/s, loss=0.7046, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.77it/s, loss=0.6924, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.52it/s, loss=0.6924, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.52it/s, loss=0.6987, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.32it/s, loss=0.6987, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.32it/s, loss=0.6874, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.07it/s, loss=0.6874, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.07it/s, loss=0.6878, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.72it/s, loss=0.6878, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.72it/s, loss=0.7174, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.06it/s, loss=0.7174, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6952, Acc: 0.4620, Precision: 0.4632, Recall: 0.4783, F1: 0.4706, AUC: 0.4693
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6876, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6876, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6779, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6779, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6884, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6884, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6914, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6914, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6946, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6946, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6843, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6843, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6871, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6871, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6765, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6765, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6926, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.54it/s, loss=0.6926, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.54it/s, loss=0.6934, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.35it/s, loss=0.6934, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.35it/s, loss=0.6806, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6806, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6954, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6954, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6875, Acc: 0.5924, Precision: 0.5691, Recall: 0.7609, F1: 0.6512, AUC: 0.6479
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6895, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6895, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6783, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6783, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6910, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6910, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6820, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6820, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6874, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6874, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6750, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6750, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6734, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6734, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6745, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6745, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6860, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.51it/s, loss=0.6860, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.51it/s, loss=0.6884, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.24it/s, loss=0.6884, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.24it/s, loss=0.6701, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.88it/s, loss=0.6701, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.88it/s, loss=0.6714, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6714, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6806, Acc: 0.6630, Precision: 0.6744, Recall: 0.6304, F1: 0.6517, AUC: 0.7267
------------------------------------------------------------
Training curves saved to model\chb15_fold10\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold10
============================================================
✅ Fold 10 training completed successfully!

============================================================
TRAINING FOLD 11/19
============================================================
Using dataset prefix: chb15_fold11
Loading datasets from: preprocessing\data\chb15_fold11
Saving models to: model\chb15_fold11
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7624, std=2.0031
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6102, 4.1539]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 11): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.7102, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:03<00:43,  3.94s/it, loss=0.7102, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:43,  3.94s/it, loss=0.6980, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.70s/it, loss=0.6980, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.70s/it, loss=0.6884, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6884, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6888, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.58it/s, loss=0.6888, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.58it/s, loss=0.7007, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.25it/s, loss=0.7007, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.25it/s, loss=0.6864, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:01,  3.03it/s, loss=0.6864, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:01,  3.03it/s, loss=0.6992, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.88it/s, loss=0.6992, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.88it/s, loss=0.6788, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.76it/s, loss=0.6788, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.76it/s, loss=0.7046, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.36it/s, loss=0.7046, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.36it/s, loss=0.6996, gradTraining Epoch 1/5:  83%|8| 10/12 [00:04<00:00,  6.06it/s, loss=0.6996, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.06it/s, loss=0.7073, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.75it/s, loss=0.7073, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.75it/s, loss=0.6798, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6798, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6951, Acc: 0.4783, Precision: 0.4865, Recall: 0.7826, F1: 0.6000, AUC: 0.4507
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6865, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:03<00:42,  3.89s/it, loss=0.6865, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:42,  3.89s/it, loss=0.7003, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:16,  1.67s/it, loss=0.7003, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:16,  1.67s/it, loss=0.6885, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.05it/s, loss=0.6885, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.05it/s, loss=0.6898, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:04,  1.61it/s, loss=0.6898, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:04,  1.61it/s, loss=0.6887, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.26it/s, loss=0.6887, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.26it/s, loss=0.6861, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6861, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.00it/s, loss=0.6859, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6859, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6928, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.74it/s, loss=0.6928, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.74it/s, loss=0.6938, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.53it/s, loss=0.6938, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.53it/s, loss=0.6897, gradTraining Epoch 2/5:  83%|8| 10/12 [00:04<00:00,  6.29it/s, loss=0.6897, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.29it/s, loss=0.6916, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6916, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6959, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.12it/s, loss=0.6959, gra

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6908, Acc: 0.5163, Precision: 0.5118, Recall: 0.7065, F1: 0.5936, AUC: 0.5810
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6928, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6928, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6913, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6913, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6809, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6809, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.7000, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.7000, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.7057, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.7057, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6811, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6811, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6960, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6960, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6799, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6799, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6798, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6798, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.57it/s, loss=0.6920, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.6920, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.6912, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6912, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6864, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6864, gra

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6898, Acc: 0.5652, Precision: 0.5469, Recall: 0.7609, F1: 0.6364, AUC: 0.5945
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6872, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6872, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6852, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6852, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6943, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6943, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6970, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6970, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6948, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6948, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6887, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6887, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6850, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6850, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6990, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6990, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6718, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6718, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.56it/s, loss=0.6891, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6891, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6892, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6892, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6806, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6806, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6885, Acc: 0.5761, Precision: 0.5593, Recall: 0.7174, F1: 0.6286, AUC: 0.5886
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6867, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6867, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6951, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6951, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6783, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6783, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6818, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6818, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6742, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6742, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6847, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6847, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6812, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6812, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.7012, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.7012, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6808, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.55it/s, loss=0.6808, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.55it/s, loss=0.6875, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.32it/s, loss=0.6875, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.32it/s, loss=0.6753, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6753, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6986, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6986, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6855, Acc: 0.5978, Precision: 0.5865, Recall: 0.6630, F1: 0.6224, AUC: 0.6587
------------------------------------------------------------
Training curves saved to model\chb15_fold11\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold11
============================================================
✅ Fold 11 training completed successfully!

============================================================
TRAINING FOLD 12/19
============================================================
Using dataset prefix: chb15_fold12
Loading datasets from: preprocessing\data\chb15_fold12
Saving models to: model\chb15_fold12
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7965, std=1.9967
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6112, 4.0738]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 12): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6960, grad_norm=0.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6960, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6955, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6955, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6932, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6932, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6940, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6940, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6886, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6886, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6820, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6820, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.7036, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.7036, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6944, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6944, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.69it/s, loss=0.6867, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6867, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6918, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.29it/s, loss=0.6918, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.29it/s, loss=0.6926, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.6926, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.7039, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.7039, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6935, Acc: 0.5217, Precision: 0.5189, Recall: 0.5978, F1: 0.5556, AUC: 0.5232
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6948, grad_norm=0.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6948, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6875, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6875, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6890, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6890, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.7028, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.7028, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6738, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6738, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6952, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6952, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6993, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6993, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6939, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6939, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6949, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6949, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.57it/s, loss=0.6975, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.6975, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.7027, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.7027, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.7042, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.7042, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6946, Acc: 0.4837, Precision: 0.4795, Recall: 0.3804, F1: 0.4242, AUC: 0.4735
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7017, grad_norm=0.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.7017, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6834, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6834, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6906, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6906, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6906, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6906, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.7047, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.7047, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6841, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6841, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.98it/s, loss=0.6929, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6929, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6820, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.66it/s, loss=0.6820, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.66it/s, loss=0.6975, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6975, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6864, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.6864, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.6888, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.92it/s, loss=0.6888, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.92it/s, loss=0.6835, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6835, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6905, Acc: 0.5109, Precision: 0.5152, Recall: 0.3696, F1: 0.4304, AUC: 0.5573
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6851, grad_norm=0.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6851, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6867, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6867, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6908, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6908, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6971, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6971, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6914, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6914, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6988, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6988, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6770, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6770, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6857, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6857, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6793, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.54it/s, loss=0.6793, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.54it/s, loss=0.6814, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.30it/s, loss=0.6814, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.30it/s, loss=0.7011, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.7011, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.7049, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.7049, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6899, Acc: 0.5489, Precision: 0.5464, Recall: 0.5761, F1: 0.5608, AUC: 0.5787
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6862, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6862, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6734, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6734, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6946, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6946, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6757, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6757, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6652, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6652, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6845, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6845, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6843, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6843, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6702, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6702, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6778, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.55it/s, loss=0.6778, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.55it/s, loss=0.6903, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6903, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6946, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.93it/s, loss=0.6946, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.93it/s, loss=0.6798, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6798, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6814, Acc: 0.6250, Precision: 0.6716, Recall: 0.4891, F1: 0.5660, AUC: 0.7051
------------------------------------------------------------
Training curves saved to model\chb15_fold12\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold12
============================================================
✅ Fold 12 training completed successfully!

============================================================
TRAINING FOLD 13/19
============================================================
Using dataset prefix: chb15_fold13
Loading datasets from: preprocessing\data\chb15_fold13
Saving models to: model\chb15_fold13
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7794, std=2.0276
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5339, 4.1209]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 13): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6935, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.17s/it, loss=0.6935, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.17s/it, loss=0.6863, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6863, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6951, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6951, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6814, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.52it/s, loss=0.6814, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.52it/s, loss=0.7112, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.7112, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.18it/s, loss=0.7201, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.94it/s, loss=0.7201, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.94it/s, loss=0.6906, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.79it/s, loss=0.6906, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.79it/s, loss=0.6972, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.67it/s, loss=0.6972, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.67it/s, loss=0.6950, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6950, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6783, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6783, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6933, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.99it/s, loss=0.6933, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.99it/s, loss=0.6991, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.04it/s, loss=0.6991, gra

Epoch 1/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6951, Acc: 0.4946, Precision: 0.4800, Recall: 0.1304, F1: 0.2051, AUC: 0.4746
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6845, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6845, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6892, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6892, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6911, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6911, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6912, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6912, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6997, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6997, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6967, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6967, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6928, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6928, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.78it/s, loss=0.6983, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.64it/s, loss=0.6983, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.64it/s, loss=0.6790, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6790, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6973, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.6973, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.6983, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.6983, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.6812, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6812, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6916, Acc: 0.5054, Precision: 0.5152, Recall: 0.1848, F1: 0.2720, AUC: 0.5539
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6925, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:03<00:42,  3.89s/it, loss=0.6925, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:42,  3.89s/it, loss=0.6915, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:16,  1.67s/it, loss=0.6915, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:16,  1.67s/it, loss=0.6976, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6976, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6895, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:04,  1.61it/s, loss=0.6895, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:04,  1.61it/s, loss=0.6973, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6973, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6937, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.05it/s, loss=0.6937, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.05it/s, loss=0.6722, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.90it/s, loss=0.6722, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.90it/s, loss=0.6946, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.78it/s, loss=0.6946, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.78it/s, loss=0.6774, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.61it/s, loss=0.6774, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.61it/s, loss=0.6946, gradTraining Epoch 3/5:  83%|8| 10/12 [00:04<00:00,  6.36it/s, loss=0.6946, graTraining Epoch 3/5:  83%|8| 10/12 [00:04<00:00,  6.36it/s, loss=0.6915, graTraining Epoch 3/5:  92%|9| 11/12 [00:04<00:00,  7.00it/s, loss=0.6915, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.7021, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.12it/s, loss=0.7021, gra

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6912, Acc: 0.4946, Precision: 0.4889, Recall: 0.2391, F1: 0.3212, AUC: 0.5564
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6939, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6939, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6934, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6934, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6844, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6844, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6911, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6911, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6727, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6727, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6893, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6893, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6838, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6838, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6908, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6908, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.70it/s, loss=0.6951, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.54it/s, loss=0.6951, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.54it/s, loss=0.6824, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.29it/s, loss=0.6824, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.29it/s, loss=0.6808, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.99it/s, loss=0.6808, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.99it/s, loss=0.7056, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.7056, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6886, Acc: 0.5435, Precision: 0.5571, Recall: 0.4239, F1: 0.4815, AUC: 0.5955
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6879, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6879, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6950, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6950, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6825, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6825, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6883, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6883, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6723, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6723, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6892, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6892, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6800, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6800, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6927, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6927, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6875, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6875, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.57it/s, loss=0.6661, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6661, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6857, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6857, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6907, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6907, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6848, Acc: 0.5815, Precision: 0.5926, Recall: 0.5217, F1: 0.5549, AUC: 0.6518
------------------------------------------------------------
Training curves saved to model\chb15_fold13\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold13
============================================================
✅ Fold 13 training completed successfully!

============================================================
TRAINING FOLD 14/19
============================================================
Using dataset prefix: chb15_fold14
Loading datasets from: preprocessing\data\chb15_fold14
Saving models to: model\chb15_fold14
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7768, std=1.9970
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6200, 4.0738]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 14): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6813, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.13s/it, loss=0.6813, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.13s/it, loss=0.7022, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.7022, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.6868, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6868, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6947, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6947, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.7178, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.7178, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.6995, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6995, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6935, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6935, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6837, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.66it/s, loss=0.6837, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.66it/s, loss=0.6867, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6867, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6932, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.6932, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.7031, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.7031, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6863, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.05it/s, loss=0.6863, gra

Epoch 1/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6941, Acc: 0.5761, Precision: 0.5565, Recall: 0.7500, F1: 0.6389, AUC: 0.5005
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6925, grad_norm=0.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6925, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6969, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6969, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6967, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6967, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6909, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6909, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6934, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6934, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6990, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6990, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6929, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.77it/s, loss=0.6929, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.77it/s, loss=0.6724, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.61it/s, loss=0.6724, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.61it/s, loss=0.6750, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.40it/s, loss=0.6750, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.40it/s, loss=0.6866, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.12it/s, loss=0.6866, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.12it/s, loss=0.6898, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.76it/s, loss=0.6898, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.76it/s, loss=0.6925, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6925, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6899, Acc: 0.5000, Precision: 0.5000, Recall: 0.5109, F1: 0.5054, AUC: 0.5483
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6901, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6901, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6900, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6900, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6935, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6935, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6857, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6857, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6972, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6972, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.20it/s, loss=0.6937, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6937, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.7059, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.7059, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6991, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.66it/s, loss=0.6991, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.66it/s, loss=0.6733, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6733, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.7022, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.7022, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.6715, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.92it/s, loss=0.6715, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.92it/s, loss=0.6905, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.05it/s, loss=0.6905, gra

Epoch 3/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6911, Acc: 0.5543, Precision: 0.5510, Recall: 0.5870, F1: 0.5684, AUC: 0.5597
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6957, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:03<00:43,  3.97s/it, loss=0.6957, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:43,  3.97s/it, loss=0.6813, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.70s/it, loss=0.6813, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.70s/it, loss=0.6879, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6879, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6811, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6811, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6863, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.25it/s, loss=0.6863, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.25it/s, loss=0.6855, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6855, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6854, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.87it/s, loss=0.6854, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.87it/s, loss=0.6627, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6627, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6887, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6887, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6776, gradTraining Epoch 4/5:  83%|8| 10/12 [00:04<00:00,  6.33it/s, loss=0.6776, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.6955, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.97it/s, loss=0.6955, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.97it/s, loss=0.7281, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.7281, gra

Epoch 4/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6880, Acc: 0.5543, Precision: 0.5347, Recall: 0.8370, F1: 0.6525, AUC: 0.6106
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6755, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6755, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6787, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6787, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6880, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6880, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6867, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6867, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6822, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6822, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6706, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6706, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6821, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6821, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6583, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.75it/s, loss=0.6583, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.75it/s, loss=0.6806, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.49it/s, loss=0.6806, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.49it/s, loss=0.6906, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6906, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6650, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6650, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.96it/s, loss=0.6663, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6663, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6770, Acc: 0.6196, Precision: 0.5932, Recall: 0.7609, F1: 0.6667, AUC: 0.6946
------------------------------------------------------------
Training curves saved to model\chb15_fold14\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold14
============================================================
✅ Fold 14 training completed successfully!

============================================================
TRAINING FOLD 15/19
============================================================
Using dataset prefix: chb15_fold15
Loading datasets from: preprocessing\data\chb15_fold15
Saving models to: model\chb15_fold15
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7394, std=2.0055
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6150, 4.1477]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 15): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6864, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.00s/it, loss=0.6864, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:44,  4.00s/it, loss=0.7141, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.7141, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6921, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6921, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6931, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6931, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6927, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.24it/s, loss=0.6927, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.24it/s, loss=0.6941, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:01,  3.02it/s, loss=0.6941, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:01,  3.02it/s, loss=0.6896, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.88it/s, loss=0.6896, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.88it/s, loss=0.7053, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.76it/s, loss=0.7053, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.76it/s, loss=0.6902, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.63it/s, loss=0.6902, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.63it/s, loss=0.6888, gradTraining Epoch 1/5:  83%|8| 10/12 [00:04<00:00,  6.41it/s, loss=0.6888, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.41it/s, loss=0.6972, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6972, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6876, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.10it/s, loss=0.6876, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6943, Acc: 0.4946, Precision: 0.4872, Recall: 0.2065, F1: 0.2901, AUC: 0.4718
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.7031, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.00s/it, loss=0.7031, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.00s/it, loss=0.6893, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6893, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.7058, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.7058, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6893, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6893, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6949, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6949, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6883, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6883, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.7013, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.7013, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6921, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6921, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6960, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6960, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6860, gradTraining Epoch 2/5:  83%|8| 10/12 [00:04<00:00,  6.31it/s, loss=0.6860, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.31it/s, loss=0.6888, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6888, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.7023, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.7023, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6948, Acc: 0.4891, Precision: 0.4808, Recall: 0.2717, F1: 0.3472, AUC: 0.4910
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6836, grad_norm=0.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6836, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6946, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6946, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6840, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6840, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6919, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6919, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6789, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6789, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6839, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6839, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6883, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6883, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6825, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6825, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6862, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6862, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.56it/s, loss=0.6999, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.32it/s, loss=0.6999, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.32it/s, loss=0.6827, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6827, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.98it/s, loss=0.6965, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6965, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6877, Acc: 0.6467, Precision: 0.6667, Recall: 0.5870, F1: 0.6243, AUC: 0.6506
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6847, grad_norm=0.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6847, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6827, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6827, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6826, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6826, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6964, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6964, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6872, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6872, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6933, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6933, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6851, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6851, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6897, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6897, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6858, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.50it/s, loss=0.6858, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.50it/s, loss=0.6983, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.26it/s, loss=0.6983, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.26it/s, loss=0.6979, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.92it/s, loss=0.6979, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.92it/s, loss=0.6830, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6830, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6889, Acc: 0.5761, Precision: 0.5814, Recall: 0.5435, F1: 0.5618, AUC: 0.5803
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6898, grad_norm=0.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6898, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6835, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6835, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6679, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6679, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6855, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6855, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6787, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6787, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6767, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6767, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6833, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6833, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6870, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6870, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6761, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6761, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.57it/s, loss=0.6935, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.37it/s, loss=0.6935, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.37it/s, loss=0.6854, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.02it/s, loss=0.6854, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.02it/s, loss=0.6998, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6998, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6839, Acc: 0.6087, Precision: 0.6136, Recall: 0.5870, F1: 0.6000, AUC: 0.6776
------------------------------------------------------------
Training curves saved to model\chb15_fold15\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold15
============================================================
✅ Fold 15 training completed successfully!

============================================================
TRAINING FOLD 16/19
============================================================
Using dataset prefix: chb15_fold16
Loading datasets from: preprocessing\data\chb15_fold16
Saving models to: model\chb15_fold16
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7461, std=2.0041
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6154, 4.1560]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 16): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6841, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:03<00:43,  3.96s/it, loss=0.6841, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:43,  3.96s/it, loss=0.6934, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:16,  1.70s/it, loss=0.6934, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:16,  1.70s/it, loss=0.7059, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.7059, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.7193, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.59it/s, loss=0.7193, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.59it/s, loss=0.6851, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.26it/s, loss=0.6851, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.26it/s, loss=0.6948, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:01,  3.04it/s, loss=0.6948, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:01,  3.04it/s, loss=0.6922, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.90it/s, loss=0.6922, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.90it/s, loss=0.6966, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.77it/s, loss=0.6966, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.77it/s, loss=0.7062, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.61it/s, loss=0.7062, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.61it/s, loss=0.7047, gradTraining Epoch 1/5:  83%|8| 10/12 [00:04<00:00,  6.38it/s, loss=0.7047, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.38it/s, loss=0.6948, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  7.08it/s, loss=0.6948, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  7.08it/s, loss=0.6794, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.11it/s, loss=0.6794, gra

Epoch 1/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6964, Acc: 0.4674, Precision: 0.3500, Recall: 0.0761, F1: 0.1250, AUC: 0.4409
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6794, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:03<00:43,  3.94s/it, loss=0.6794, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:43,  3.94s/it, loss=0.6909, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:16,  1.69s/it, loss=0.6909, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:16,  1.69s/it, loss=0.7102, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.7102, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.03it/s, loss=0.6914, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.59it/s, loss=0.6914, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.59it/s, loss=0.6966, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.27it/s, loss=0.6966, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.27it/s, loss=0.7053, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.06it/s, loss=0.7053, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.06it/s, loss=0.7103, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.91it/s, loss=0.7103, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.91it/s, loss=0.6857, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.78it/s, loss=0.6857, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.78it/s, loss=0.6819, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.61it/s, loss=0.6819, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.61it/s, loss=0.6920, gradTraining Epoch 2/5:  83%|8| 10/12 [00:04<00:00,  6.41it/s, loss=0.6920, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.41it/s, loss=0.7002, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.7002, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6949, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.12it/s, loss=0.6949, gra

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6949, Acc: 0.4837, Precision: 0.4545, Recall: 0.1630, F1: 0.2400, AUC: 0.4973
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6861, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6861, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6881, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6881, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6847, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6847, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.7030, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.7030, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6966, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6966, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6974, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6974, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6944, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6944, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6922, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.74it/s, loss=0.6922, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.74it/s, loss=0.6830, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6830, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6904, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.6904, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.28it/s, loss=0.6823, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.6823, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.91it/s, loss=0.6865, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6865, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6904, Acc: 0.5272, Precision: 0.5294, Recall: 0.4891, F1: 0.5085, AUC: 0.5497
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6817, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6817, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6920, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6920, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6919, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6919, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.7007, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.7007, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6907, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6907, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6904, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6904, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6907, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6907, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6875, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.74it/s, loss=0.6875, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.74it/s, loss=0.6940, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.60it/s, loss=0.6940, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.60it/s, loss=0.6882, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.35it/s, loss=0.6882, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.35it/s, loss=0.6852, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.6852, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.6800, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6800, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6894, Acc: 0.5435, Precision: 0.5339, Recall: 0.6848, F1: 0.6000, AUC: 0.5805
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6860, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:03<00:42,  3.90s/it, loss=0.6860, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:42,  3.90s/it, loss=0.6875, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:16,  1.67s/it, loss=0.6875, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:16,  1.67s/it, loss=0.6767, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6767, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6779, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:04,  1.61it/s, loss=0.6779, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:04,  1.61it/s, loss=0.6780, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.29it/s, loss=0.6780, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.29it/s, loss=0.7015, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.08it/s, loss=0.7015, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.08it/s, loss=0.6879, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.92it/s, loss=0.6879, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.92it/s, loss=0.6826, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.80it/s, loss=0.6826, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.80it/s, loss=0.6760, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.66it/s, loss=0.6760, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.66it/s, loss=0.6838, gradTraining Epoch 5/5:  83%|8| 10/12 [00:04<00:00,  6.38it/s, loss=0.6838, graTraining Epoch 5/5:  83%|8| 10/12 [00:04<00:00,  6.38it/s, loss=0.6928, graTraining Epoch 5/5:  92%|9| 11/12 [00:04<00:00,  7.07it/s, loss=0.6928, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.07it/s, loss=0.6827, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.13it/s, loss=0.6827, gra

Epoch 5/5 Complete (6.0s) [LR: 0.000005]
Train - Loss: 0.6844, Acc: 0.5924, Precision: 0.5825, Recall: 0.6522, F1: 0.6154, AUC: 0.6582
------------------------------------------------------------
Training curves saved to model\chb15_fold16\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold16
============================================================
✅ Fold 16 training completed successfully!

============================================================
TRAINING FOLD 17/19
============================================================
Using dataset prefix: chb15_fold17
Loading datasets from: preprocessing\data\chb15_fold17
Saving models to: model\chb15_fold17
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7200, std=2.0018
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6350, 4.1395]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 17): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6871, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.13s/it, loss=0.6871, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.13s/it, loss=0.6889, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.6889, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.77s/it, loss=0.6975, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6975, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6746, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.52it/s, loss=0.6746, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.52it/s, loss=0.6978, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.6978, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.17it/s, loss=0.7053, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.92it/s, loss=0.7053, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.92it/s, loss=0.6921, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.75it/s, loss=0.6921, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.75it/s, loss=0.6879, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.63it/s, loss=0.6879, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.63it/s, loss=0.7027, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.50it/s, loss=0.7027, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.50it/s, loss=0.6933, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.6933, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.27it/s, loss=0.7043, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.97it/s, loss=0.7043, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.97it/s, loss=0.6856, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.04it/s, loss=0.6856, gra

Epoch 1/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6931, Acc: 0.5000, Precision: 0.5000, Recall: 0.9457, F1: 0.6541, AUC: 0.5286
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6836, grad_norm=0.Training Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6836, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6749, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6749, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6902, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6902, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.7124, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.7124, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6834, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6834, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6751, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6751, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.7065, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.7065, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6955, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6955, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6940, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6940, gradTraining Epoch 2/5:  75%|7| 9/12 [00:05<00:00,  5.57it/s, loss=0.6865, gradTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6865, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.7004, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.7004, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.00it/s, loss=0.6945, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6945, gra

Epoch 2/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6914, Acc: 0.5163, Precision: 0.5091, Recall: 0.9130, F1: 0.6537, AUC: 0.5561
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6967, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6967, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6928, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6928, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.7004, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.7004, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6854, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6854, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6742, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6742, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6964, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6964, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6920, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6920, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6690, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6690, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6854, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.41it/s, loss=0.6854, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.41it/s, loss=0.6866, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.18it/s, loss=0.6866, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.18it/s, loss=0.6751, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.87it/s, loss=0.6751, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.87it/s, loss=0.6824, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6824, gra

Epoch 3/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6864, Acc: 0.5435, Precision: 0.5253, Recall: 0.9022, F1: 0.6640, AUC: 0.6132
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6896, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6896, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.03s/it, loss=0.6844, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6844, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.7066, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.7066, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6738, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6738, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6924, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6924, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.22it/s, loss=0.6828, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6828, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6699, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6699, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6882, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6882, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6655, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6655, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.56it/s, loss=0.6709, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.6709, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.33it/s, loss=0.6899, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6899, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.94it/s, loss=0.6728, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.08it/s, loss=0.6728, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6823, Acc: 0.5543, Precision: 0.5410, Recall: 0.7174, F1: 0.6168, AUC: 0.6161
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6676, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:03<00:43,  3.91s/it, loss=0.6676, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:43,  3.91s/it, loss=0.6648, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:16,  1.68s/it, loss=0.6648, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:16,  1.68s/it, loss=0.6695, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6695, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6832, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.60it/s, loss=0.6832, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.60it/s, loss=0.6724, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6724, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6713, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.06it/s, loss=0.6713, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.06it/s, loss=0.7027, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.7027, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.85it/s, loss=0.6556, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6556, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.73it/s, loss=0.6500, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6500, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6683, gradTraining Epoch 5/5:  83%|8| 10/12 [00:04<00:00,  6.34it/s, loss=0.6683, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6533, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.6533, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.95it/s, loss=0.6760, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.12it/s, loss=0.6760, gra

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6696, Acc: 0.6413, Precision: 0.6102, Recall: 0.7826, F1: 0.6857, AUC: 0.7349
------------------------------------------------------------
Training curves saved to model\chb15_fold17\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold17
============================================================
✅ Fold 17 training completed successfully!

============================================================
TRAINING FOLD 18/19
============================================================
Using dataset prefix: chb15_fold18
Loading datasets from: preprocessing\data\chb15_fold18
Saving models to: model\chb15_fold18
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7434, std=1.9952
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.6419, 4.1401]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 18): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6869, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.15s/it, loss=0.6869, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.15s/it, loss=0.6948, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6948, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.78s/it, loss=0.6878, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.6878, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.02s/it, loss=0.7010, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.7010, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.51it/s, loss=0.6839, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.15it/s, loss=0.6839, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.15it/s, loss=0.7101, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.7101, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.90it/s, loss=0.6964, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.69it/s, loss=0.6964, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.69it/s, loss=0.6908, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.51it/s, loss=0.6908, gradTraining Epoch 1/5:  67%|6| 8/12 [00:05<00:00,  4.51it/s, loss=0.6790, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.30it/s, loss=0.6790, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.30it/s, loss=0.6991, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.02it/s, loss=0.6991, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.02it/s, loss=0.6948, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.74it/s, loss=0.6948, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.74it/s, loss=0.7078, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.02it/s, loss=0.7078, gra

Epoch 1/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6944, Acc: 0.5109, Precision: 0.5455, Recall: 0.1304, F1: 0.2105, AUC: 0.5176
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.7040, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:03<00:41,  3.80s/it, loss=0.7040, gradTraining Epoch 2/5:   8%| | 1/12 [00:03<00:41,  3.80s/it, loss=0.7011, gradTraining Epoch 2/5:  17%|1| 2/12 [00:03<00:16,  1.63s/it, loss=0.7011, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:16,  1.63s/it, loss=0.6914, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.06it/s, loss=0.6914, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.06it/s, loss=0.7101, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:04,  1.63it/s, loss=0.7101, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:04,  1.63it/s, loss=0.6797, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.32it/s, loss=0.6797, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.32it/s, loss=0.6897, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.12it/s, loss=0.6897, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.12it/s, loss=0.6914, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.98it/s, loss=0.6914, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.98it/s, loss=0.6997, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.85it/s, loss=0.6997, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.85it/s, loss=0.6977, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.70it/s, loss=0.6977, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.70it/s, loss=0.6870, gradTraining Epoch 2/5:  83%|8| 10/12 [00:04<00:00,  6.49it/s, loss=0.6870, graTraining Epoch 2/5:  83%|8| 10/12 [00:04<00:00,  6.49it/s, loss=0.7017, graTraining Epoch 2/5:  92%|9| 11/12 [00:04<00:00,  7.16it/s, loss=0.7017, graTraining Epoch 2/5:  92%|9| 11/12 [00:04<00:00,  7.16it/s, loss=0.6744, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.17it/s, loss=0.6744, gra

Epoch 2/5 Complete (5.9s) [LR: 0.000010]
Train - Loss: 0.6940, Acc: 0.5054, Precision: 0.5056, Recall: 0.4891, F1: 0.4972, AUC: 0.4909
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6940, grad_norm=1.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6940, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.01s/it, loss=0.6917, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6917, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6824, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6824, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6944, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6944, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6859, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.24it/s, loss=0.6859, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.24it/s, loss=0.6778, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6778, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:01,  3.01it/s, loss=0.6900, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6900, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6959, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6959, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6833, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6833, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6849, gradTraining Epoch 3/5:  83%|8| 10/12 [00:04<00:00,  6.36it/s, loss=0.6849, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.36it/s, loss=0.6824, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.87it/s, loss=0.6824, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  6.87it/s, loss=0.6731, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6731, gra

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6863, Acc: 0.5543, Precision: 0.5463, Recall: 0.6413, F1: 0.5900, AUC: 0.5844
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.7113, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:03<00:43,  3.91s/it, loss=0.7113, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:43,  3.91s/it, loss=0.6843, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:16,  1.67s/it, loss=0.6843, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:16,  1.67s/it, loss=0.6867, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6867, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.7092, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:04,  1.61it/s, loss=0.7092, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:04,  1.61it/s, loss=0.6885, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.29it/s, loss=0.6885, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.29it/s, loss=0.6852, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.09it/s, loss=0.6852, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:01,  3.09it/s, loss=0.6996, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.94it/s, loss=0.6996, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.94it/s, loss=0.6872, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.84it/s, loss=0.6872, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.84it/s, loss=0.6705, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.71it/s, loss=0.6705, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.71it/s, loss=0.6877, gradTraining Epoch 4/5:  83%|8| 10/12 [00:04<00:00,  6.50it/s, loss=0.6877, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.50it/s, loss=0.6790, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.63it/s, loss=0.6790, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.63it/s, loss=0.6637, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.12it/s, loss=0.6637, gra

Epoch 4/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6877, Acc: 0.5326, Precision: 0.5283, Recall: 0.6087, F1: 0.5657, AUC: 0.5647
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6673, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6673, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6834, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6834, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.72s/it, loss=0.6853, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6853, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.02it/s, loss=0.6930, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6930, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.57it/s, loss=0.6841, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.24it/s, loss=0.6841, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.24it/s, loss=0.6948, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.02it/s, loss=0.6948, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:01,  3.02it/s, loss=0.6862, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.88it/s, loss=0.6862, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.88it/s, loss=0.6805, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.77it/s, loss=0.6805, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.77it/s, loss=0.6906, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.63it/s, loss=0.6906, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.63it/s, loss=0.6767, gradTraining Epoch 5/5:  83%|8| 10/12 [00:04<00:00,  6.43it/s, loss=0.6767, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.43it/s, loss=0.6654, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.13it/s, loss=0.6654, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  7.13it/s, loss=0.6871, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.10it/s, loss=0.6871, gra

Epoch 5/5 Complete (6.1s) [LR: 0.000005]
Train - Loss: 0.6829, Acc: 0.5978, Precision: 0.5818, Recall: 0.6957, F1: 0.6337, AUC: 0.6461
------------------------------------------------------------
Training curves saved to model\chb15_fold18\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold18
============================================================
✅ Fold 18 training completed successfully!

============================================================
TRAINING FOLD 19/19
============================================================
Using dataset prefix: chb15_fold19
Loading datasets from: preprocessing\data\chb15_fold19
Saving models to: model\chb15_fold19
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=-0.7881, std=2.0138
Loaded train dataset: 184 samples
  - Spectrogram shape: torch.Size([184, 30, 18, 50, 10])
  - Value range: [-5.5676, 4.1100]
  - Class distribution: tensor([92, 92])
LOOCV Mode (Fold 19): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/19 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6904, grad_norm=1.Training Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.10s/it, loss=0.6904, gradTraining Epoch 1/5:   8%| | 1/12 [00:04<00:45,  4.10s/it, loss=0.6918, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.6918, gradTraining Epoch 1/5:  17%|1| 2/12 [00:04<00:17,  1.76s/it, loss=0.6823, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6823, gradTraining Epoch 1/5:  25%|2| 3/12 [00:04<00:09,  1.01s/it, loss=0.6891, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.6891, gradTraining Epoch 1/5:  33%|3| 4/12 [00:04<00:05,  1.53it/s, loss=0.7062, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.7062, gradTraining Epoch 1/5:  42%|4| 5/12 [00:04<00:03,  2.19it/s, loss=0.6873, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6873, gradTraining Epoch 1/5:  50%|5| 6/12 [00:04<00:02,  2.96it/s, loss=0.6964, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.6964, gradTraining Epoch 1/5:  58%|5| 7/12 [00:04<00:01,  3.81it/s, loss=0.7028, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.7028, gradTraining Epoch 1/5:  67%|6| 8/12 [00:04<00:00,  4.68it/s, loss=0.6911, gradTraining Epoch 1/5:  75%|7| 9/12 [00:04<00:00,  5.52it/s, loss=0.6911, gradTraining Epoch 1/5:  75%|7| 9/12 [00:05<00:00,  5.52it/s, loss=0.6858, gradTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.29it/s, loss=0.6858, graTraining Epoch 1/5:  83%|8| 10/12 [00:05<00:00,  6.29it/s, loss=0.6834, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.90it/s, loss=0.6834, graTraining Epoch 1/5:  92%|9| 11/12 [00:05<00:00,  6.90it/s, loss=0.7061, graTraining Epoch 1/5: 100%|#| 12/12 [00:05<00:00,  2.06it/s, loss=0.7061, gra

Epoch 1/5 Complete (6.3s) [LR: 0.000010]
Train - Loss: 0.6927, Acc: 0.5217, Precision: 0.5833, Recall: 0.1522, F1: 0.2414, AUC: 0.5468
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/12 [00:03<?, ?it/s, loss=0.6856, grad_norm=1.Training Epoch 2/5:   8%| | 1/12 [00:03<00:42,  3.91s/it, loss=0.6856, gradTraining Epoch 2/5:   8%| | 1/12 [00:04<00:42,  3.91s/it, loss=0.7012, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:16,  1.68s/it, loss=0.7012, gradTraining Epoch 2/5:  17%|1| 2/12 [00:04<00:16,  1.68s/it, loss=0.6903, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6903, gradTraining Epoch 2/5:  25%|2| 3/12 [00:04<00:08,  1.04it/s, loss=0.6899, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:04,  1.60it/s, loss=0.6899, gradTraining Epoch 2/5:  33%|3| 4/12 [00:04<00:04,  1.60it/s, loss=0.6889, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6889, gradTraining Epoch 2/5:  42%|4| 5/12 [00:04<00:03,  2.28it/s, loss=0.6915, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.06it/s, loss=0.6915, gradTraining Epoch 2/5:  50%|5| 6/12 [00:04<00:01,  3.06it/s, loss=0.7022, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.92it/s, loss=0.7022, gradTraining Epoch 2/5:  58%|5| 7/12 [00:04<00:01,  3.92it/s, loss=0.6908, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.81it/s, loss=0.6908, gradTraining Epoch 2/5:  67%|6| 8/12 [00:04<00:00,  4.81it/s, loss=0.6876, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.65it/s, loss=0.6876, gradTraining Epoch 2/5:  75%|7| 9/12 [00:04<00:00,  5.65it/s, loss=0.6893, gradTraining Epoch 2/5:  83%|8| 10/12 [00:04<00:00,  6.40it/s, loss=0.6893, graTraining Epoch 2/5:  83%|8| 10/12 [00:05<00:00,  6.40it/s, loss=0.6877, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6877, graTraining Epoch 2/5:  92%|9| 11/12 [00:05<00:00,  7.05it/s, loss=0.6879, graTraining Epoch 2/5: 100%|#| 12/12 [00:05<00:00,  2.13it/s, loss=0.6879, gra

Epoch 2/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6911, Acc: 0.5489, Precision: 0.5818, Recall: 0.3478, F1: 0.4354, AUC: 0.5467
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6767, grad_norm=0.Training Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6767, gradTraining Epoch 3/5:   8%| | 1/12 [00:04<00:44,  4.02s/it, loss=0.6834, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6834, gradTraining Epoch 3/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6783, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6783, gradTraining Epoch 3/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6998, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6998, gradTraining Epoch 3/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6977, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6977, gradTraining Epoch 3/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6887, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6887, gradTraining Epoch 3/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6868, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6868, gradTraining Epoch 3/5:  58%|5| 7/12 [00:04<00:01,  3.84it/s, loss=0.6794, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6794, gradTraining Epoch 3/5:  67%|6| 8/12 [00:04<00:00,  4.72it/s, loss=0.6916, gradTraining Epoch 3/5:  75%|7| 9/12 [00:04<00:00,  5.54it/s, loss=0.6916, gradTraining Epoch 3/5:  75%|7| 9/12 [00:05<00:00,  5.54it/s, loss=0.6943, gradTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6943, graTraining Epoch 3/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6765, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  7.02it/s, loss=0.6765, graTraining Epoch 3/5:  92%|9| 11/12 [00:05<00:00,  7.02it/s, loss=0.6848, graTraining Epoch 3/5: 100%|#| 12/12 [00:05<00:00,  2.09it/s, loss=0.6848, gra

Epoch 3/5 Complete (6.1s) [LR: 0.000010]
Train - Loss: 0.6865, Acc: 0.5707, Precision: 0.5730, Recall: 0.5543, F1: 0.5635, AUC: 0.6209
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6951, grad_norm=1.Training Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6951, gradTraining Epoch 4/5:   8%| | 1/12 [00:04<00:44,  4.05s/it, loss=0.6790, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6790, gradTraining Epoch 4/5:  17%|1| 2/12 [00:04<00:17,  1.74s/it, loss=0.6781, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.6781, gradTraining Epoch 4/5:  25%|2| 3/12 [00:04<00:08,  1.00it/s, loss=0.7006, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.7006, gradTraining Epoch 4/5:  33%|3| 4/12 [00:04<00:05,  1.55it/s, loss=0.6861, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6861, gradTraining Epoch 4/5:  42%|4| 5/12 [00:04<00:03,  2.21it/s, loss=0.6791, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6791, gradTraining Epoch 4/5:  50%|5| 6/12 [00:04<00:02,  2.99it/s, loss=0.6942, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.6942, gradTraining Epoch 4/5:  58%|5| 7/12 [00:04<00:01,  3.83it/s, loss=0.7018, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.7018, gradTraining Epoch 4/5:  67%|6| 8/12 [00:04<00:00,  4.71it/s, loss=0.6834, gradTraining Epoch 4/5:  75%|7| 9/12 [00:04<00:00,  5.56it/s, loss=0.6834, gradTraining Epoch 4/5:  75%|7| 9/12 [00:05<00:00,  5.56it/s, loss=0.6741, gradTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6741, graTraining Epoch 4/5:  83%|8| 10/12 [00:05<00:00,  6.34it/s, loss=0.6749, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.89it/s, loss=0.6749, graTraining Epoch 4/5:  92%|9| 11/12 [00:05<00:00,  6.89it/s, loss=0.6694, graTraining Epoch 4/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6694, gra

Epoch 4/5 Complete (6.2s) [LR: 0.000010]
Train - Loss: 0.6847, Acc: 0.6033, Precision: 0.6338, Recall: 0.4891, F1: 0.5521, AUC: 0.6529
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/12 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/12 [00:04<?, ?it/s, loss=0.6848, grad_norm=1.Training Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6848, gradTraining Epoch 5/5:   8%| | 1/12 [00:04<00:44,  4.04s/it, loss=0.6773, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6773, gradTraining Epoch 5/5:  17%|1| 2/12 [00:04<00:17,  1.73s/it, loss=0.6694, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6694, gradTraining Epoch 5/5:  25%|2| 3/12 [00:04<00:08,  1.01it/s, loss=0.6840, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6840, gradTraining Epoch 5/5:  33%|3| 4/12 [00:04<00:05,  1.56it/s, loss=0.6691, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6691, gradTraining Epoch 5/5:  42%|4| 5/12 [00:04<00:03,  2.23it/s, loss=0.6738, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6738, gradTraining Epoch 5/5:  50%|5| 6/12 [00:04<00:02,  3.00it/s, loss=0.6599, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6599, gradTraining Epoch 5/5:  58%|5| 7/12 [00:04<00:01,  3.86it/s, loss=0.6652, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.74it/s, loss=0.6652, gradTraining Epoch 5/5:  67%|6| 8/12 [00:04<00:00,  4.74it/s, loss=0.6699, gradTraining Epoch 5/5:  75%|7| 9/12 [00:04<00:00,  5.57it/s, loss=0.6699, gradTraining Epoch 5/5:  75%|7| 9/12 [00:05<00:00,  5.57it/s, loss=0.6806, gradTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.6806, graTraining Epoch 5/5:  83%|8| 10/12 [00:05<00:00,  6.25it/s, loss=0.6908, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.90it/s, loss=0.6908, graTraining Epoch 5/5:  92%|9| 11/12 [00:05<00:00,  6.90it/s, loss=0.6731, graTraining Epoch 5/5: 100%|#| 12/12 [00:05<00:00,  2.07it/s, loss=0.6731, gra

Epoch 5/5 Complete (6.2s) [LR: 0.000005]
Train - Loss: 0.6748, Acc: 0.6793, Precision: 0.6988, Recall: 0.6304, F1: 0.6629, AUC: 0.7693
------------------------------------------------------------
Training curves saved to model\chb15_fold19\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb15_fold19
============================================================
✅ Fold 19 training completed successfully!

============================================================
✅ BATCH TRAINING COMPLETED!
✅ Trained models for 20 folds for patient chb15
============================================================
============================================================
============================================================
BATCH EVALUATION: ALL FOLDS
BATCH EVALUATION: ALL FOLDS
Evaluating 20 folds for patient chb15
Evaluating 20 folds for patient chb15
============================================================
============================================================
Using CUDA: NVIDIA GeForce RTX 3090 Ti
Using CUDA: NVIDIA GeForce RTX 3090 Ti

============================================================
============================================================

EVALUATING FOLD 0/19
EVALUATING FOLD 0/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold0
Dataset prefix: chb15_fold0
Using test dataset: preprocessing\data\chb15_fold0\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold0\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold0\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold0\test_dataset.h5...
  - Normalization: z-score, mean=-0.6990, std=2.0063
  - Normalization: z-score, mean=-0.6990, std=2.0063
Loaded test dataset: 34 samples
Loaded test dataset: 34 samples
  - Spectrogram shape: torch.Size([34, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([34, 30, 18, 50, 10])
  - Value range: [-5.6328, 4.2417]
  - Value range: [-5.6328, 4.2417]
  - Class distribution: tensor([17, 17])
  - Class distribution: tensor([17, 17])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold0\epoch_005.pth...
Loading model checkpoint from model\chb15_fold0\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:  33%|##########3                    | 1/3 [00:00<00:00,  3.69it/s]Testing:  33%|##########3                    | 1/3 [00:00<00:00,  3.69it/s]Testing: 100%|###############################| 3/3 [00:00<00:00,  8.62it/s]Testing: 100%|###############################| 3/3 [00:00<00:00,  8.62it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7240
Loss:      0.7240
Accuracy:  0.2059 (20.59%)
Accuracy:  0.2059 (20.59%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.0000
AUC-ROC:   0.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         7        10
Actual Interictal         7        10
       Preictal        17         0
       Preictal        17         0

Class Distribution:
Class Distribution:

True Interictal (0): 17 samples
True Interictal (0): 17 samples
True Preictal (1):   17 samples
True Preictal (1):   17 samples
Pred Interictal (0): 24 samples
Pred Interictal (0): 24 samples
Pred Preictal (1):   10 samples
Pred Preictal (1):   10 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.2917    0.4118    0.3415        17
    Preictal     0.0000    0.0000    0.0000        17

    accuracy                         0.2059        34
   macro avg     0.1458    0.2059    0.1707        34
weighted avg     0.1458    0.2059    0.1707        34
              precision    recall  f1-score   support

  Interictal     0.2917    0.4118    0.3415        17
    Preictal     0.0000    0.0000    0.0000        17

    accuracy                         0.2059        34
   macro avg     0.1458    0.2059    0.1707        34
weighted avg     0.1458    0.2059    0.1707        34



✅ Results saved to model\chb15_fold0\test_results.json
✅ Results saved to model\chb15_fold0\test_results.json


============================================================
============================================================

EVALUATING FOLD 1/19
EVALUATING FOLD 1/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold1
Dataset prefix: chb15_fold1
Using test dataset: preprocessing\data\chb15_fold1\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold1\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold1\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold1\test_dataset.h5...
  - Normalization: z-score, mean=-0.7261, std=2.0020
  - Normalization: z-score, mean=-0.7261, std=2.0020
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.6313, 3.8113]
  - Value range: [-5.6313, 3.8113]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold1\epoch_005.pth...
Loading model checkpoint from model\chb15_fold1\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.88it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.88it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.79it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 28.79it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6846
Loss:      0.6846
Accuracy:  0.7750 (77.50%)
Accuracy:  0.7750 (77.50%)
Precision: 0.7619
Precision: 0.7619
Recall:    0.8000
Recall:    0.8000
F1 Score:  0.7805
F1 Score:  0.7805
AUC-ROC:   0.7875
AUC-ROC:   0.7875

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        15         5
Actual Interictal        15         5
       Preictal         4        16
       Preictal         4        16

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 19 samples
Pred Interictal (0): 19 samples
Pred Preictal (1):   21 samples
Pred Preictal (1):   21 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.7895    0.7500    0.7692        20
    Preictal     0.7619    0.8000    0.7805        20

    accuracy                         0.7750        40
   macro avg     0.7757    0.7750    0.7749        40
weighted avg     0.7757    0.7750    0.7749        40
              precision    recall  f1-score   support

  Interictal     0.7895    0.7500    0.7692        20
    Preictal     0.7619    0.8000    0.7805        20

    accuracy                         0.7750        40
   macro avg     0.7757    0.7750    0.7749        40
weighted avg     0.7757    0.7750    0.7749        40



✅ Results saved to model\chb15_fold1\test_results.json
✅ Results saved to model\chb15_fold1\test_results.json


============================================================
============================================================

EVALUATING FOLD 2/19
EVALUATING FOLD 2/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold2
Dataset prefix: chb15_fold2
Using test dataset: preprocessing\data\chb15_fold2\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold2\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold2\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold2\test_dataset.h5...
  - Normalization: z-score, mean=-0.7786, std=2.0184
  - Normalization: z-score, mean=-0.7786, std=2.0184
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.5596, 3.7526]
  - Value range: [-5.5596, 3.7526]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold2\epoch_005.pth...
Loading model checkpoint from model\chb15_fold2\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.64it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.64it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.56it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.56it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6881
Loss:      0.6881
Accuracy:  0.4091 (40.91%)
Accuracy:  0.4091 (40.91%)
Precision: 0.3000
Precision: 0.3000
Recall:    0.1364
Recall:    0.1364
F1 Score:  0.1875
F1 Score:  0.1875
AUC-ROC:   0.5950
AUC-ROC:   0.5950

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        15         7
Actual Interictal        15         7
       Preictal        19         3
       Preictal        19         3

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 34 samples
Pred Interictal (0): 34 samples
Pred Preictal (1):   10 samples
Pred Preictal (1):   10 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4412    0.6818    0.5357        22
    Preictal     0.3000    0.1364    0.1875        22

    accuracy                         0.4091        44
   macro avg     0.3706    0.4091    0.3616        44
weighted avg     0.3706    0.4091    0.3616        44
              precision    recall  f1-score   support

  Interictal     0.4412    0.6818    0.5357        22
    Preictal     0.3000    0.1364    0.1875        22

    accuracy                         0.4091        44
   macro avg     0.3706    0.4091    0.3616        44
weighted avg     0.3706    0.4091    0.3616        44



✅ Results saved to model\chb15_fold2\test_results.json
✅ Results saved to model\chb15_fold2\test_results.json


============================================================
============================================================

EVALUATING FOLD 3/19
EVALUATING FOLD 3/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold3
Dataset prefix: chb15_fold3
Using test dataset: preprocessing\data\chb15_fold3\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold3\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold3\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold3\test_dataset.h5...
  - Normalization: z-score, mean=-0.7693, std=2.0298
  - Normalization: z-score, mean=-0.7693, std=2.0298
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.5326, 3.9160]
  - Value range: [-5.5326, 3.9160]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold3\epoch_005.pth...
Loading model checkpoint from model\chb15_fold3\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.89it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.89it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.81it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 27.81it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7019
Loss:      0.7019
Accuracy:  0.3696 (36.96%)
Accuracy:  0.3696 (36.96%)
Precision: 0.3929
Precision: 0.3929
Recall:    0.4783
Recall:    0.4783
F1 Score:  0.4314
F1 Score:  0.4314
AUC-ROC:   0.3497
AUC-ROC:   0.3497

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         6        17
Actual Interictal         6        17
       Preictal        12        11
       Preictal        12        11

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 18 samples
Pred Interictal (0): 18 samples
Pred Preictal (1):   28 samples
Pred Preictal (1):   28 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.3333    0.2609    0.2927        23
    Preictal     0.3929    0.4783    0.4314        23

    accuracy                         0.3696        46
   macro avg     0.3631    0.3696    0.3620        46
weighted avg     0.3631    0.3696    0.3620        46
              precision    recall  f1-score   support

  Interictal     0.3333    0.2609    0.2927        23
    Preictal     0.3929    0.4783    0.4314        23

    accuracy                         0.3696        46
   macro avg     0.3631    0.3696    0.3620        46
weighted avg     0.3631    0.3696    0.3620        46



✅ Results saved to model\chb15_fold3\test_results.json
✅ Results saved to model\chb15_fold3\test_results.json


============================================================
============================================================

EVALUATING FOLD 4/19
EVALUATING FOLD 4/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold4
Dataset prefix: chb15_fold4
Using test dataset: preprocessing\data\chb15_fold4\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold4\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold4\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold4\test_dataset.h5...
  - Normalization: z-score, mean=-0.8223, std=2.0052
  - Normalization: z-score, mean=-0.8223, std=2.0052
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.5745, 4.0460]
  - Value range: [-5.5745, 4.0460]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold4\epoch_005.pth...
Loading model checkpoint from model\chb15_fold4\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.56it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.56it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.48it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.48it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7037
Loss:      0.7037
Accuracy:  0.3684 (36.84%)
Accuracy:  0.3684 (36.84%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.0803
AUC-ROC:   0.0803

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         5
Actual Interictal        14         5
       Preictal        19         0
       Preictal        19         0

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 33 samples
Pred Interictal (0): 33 samples
Pred Preictal (1):   5 samples
Pred Preictal (1):   5 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4242    0.7368    0.5385        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.3684        38
   macro avg     0.2121    0.3684    0.2692        38
weighted avg     0.2121    0.3684    0.2692        38
              precision    recall  f1-score   support

  Interictal     0.4242    0.7368    0.5385        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.3684        38
   macro avg     0.2121    0.3684    0.2692        38
weighted avg     0.2121    0.3684    0.2692        38



✅ Results saved to model\chb15_fold4\test_results.json
✅ Results saved to model\chb15_fold4\test_results.json


============================================================
============================================================

EVALUATING FOLD 5/19
EVALUATING FOLD 5/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold5
Dataset prefix: chb15_fold5
Using test dataset: preprocessing\data\chb15_fold5\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold5\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold5\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold5\test_dataset.h5...
  - Normalization: z-score, mean=-0.6832, std=1.9928
  - Normalization: z-score, mean=-0.6832, std=1.9928
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.6787, 3.7882]
  - Value range: [-5.6787, 3.7882]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold5\epoch_005.pth...
Loading model checkpoint from model\chb15_fold5\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 36.14it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 36.14it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7138
Loss:      0.7138
Accuracy:  0.1579 (15.79%)
Accuracy:  0.1579 (15.79%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.1080
AUC-ROC:   0.1080

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         6        13
Actual Interictal         6        13
       Preictal        19         0
       Preictal        19         0

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 25 samples
Pred Interictal (0): 25 samples
Pred Preictal (1):   13 samples
Pred Preictal (1):   13 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.2400    0.3158    0.2727        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.1579        38
   macro avg     0.1200    0.1579    0.1364        38
weighted avg     0.1200    0.1579    0.1364        38
              precision    recall  f1-score   support

  Interictal     0.2400    0.3158    0.2727        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.1579        38
   macro avg     0.1200    0.1579    0.1364        38
weighted avg     0.1200    0.1579    0.1364        38



✅ Results saved to model\chb15_fold5\test_results.json
✅ Results saved to model\chb15_fold5\test_results.json


============================================================
============================================================

EVALUATING FOLD 6/19
EVALUATING FOLD 6/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold6
Dataset prefix: chb15_fold6
Using test dataset: preprocessing\data\chb15_fold6\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold6\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold6\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold6\test_dataset.h5...
  - Normalization: z-score, mean=-0.7357, std=2.0057
  - Normalization: z-score, mean=-0.7357, std=2.0057
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.6161, 4.0881]
  - Value range: [-5.6161, 4.0881]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold6\epoch_005.pth...
Loading model checkpoint from model\chb15_fold6\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 31.69it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 31.69it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6875
Loss:      0.6875
Accuracy:  0.4783 (47.83%)
Accuracy:  0.4783 (47.83%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.7977
AUC-ROC:   0.7977

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        22         1
Actual Interictal        22         1
       Preictal        23         0
       Preictal        23         0

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 45 samples
Pred Interictal (0): 45 samples
Pred Preictal (1):   1 samples
Pred Preictal (1):   1 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4889    0.9565    0.6471        23
    Preictal     0.0000    0.0000    0.0000        23

    accuracy                         0.4783        46
   macro avg     0.2444    0.4783    0.3235        46
weighted avg     0.2444    0.4783    0.3235        46
              precision    recall  f1-score   support

  Interictal     0.4889    0.9565    0.6471        23
    Preictal     0.0000    0.0000    0.0000        23

    accuracy                         0.4783        46
   macro avg     0.2444    0.4783    0.3235        46
weighted avg     0.2444    0.4783    0.3235        46



✅ Results saved to model\chb15_fold6\test_results.json
✅ Results saved to model\chb15_fold6\test_results.json


============================================================
============================================================

EVALUATING FOLD 7/19
EVALUATING FOLD 7/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold7
Dataset prefix: chb15_fold7
Using test dataset: preprocessing\data\chb15_fold7\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold7\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold7\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold7\test_dataset.h5...
  - Normalization: z-score, mean=-0.6591, std=1.9858
  - Normalization: z-score, mean=-0.6591, std=1.9858
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.7109, 3.9322]
  - Value range: [-5.7109, 3.9322]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold7\epoch_005.pth...
Loading model checkpoint from model\chb15_fold7\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:  67%|####################6          | 2/3 [00:00<00:00, 15.14it/s]Testing:  67%|####################6          | 2/3 [00:00<00:00, 15.14it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 17.29it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 17.29it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7420
Loss:      0.7420
Accuracy:  0.2273 (22.73%)
Accuracy:  0.2273 (22.73%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.1095
AUC-ROC:   0.1095

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        10        12
Actual Interictal        10        12
       Preictal        22         0
       Preictal        22         0

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 32 samples
Pred Interictal (0): 32 samples
Pred Preictal (1):   12 samples
Pred Preictal (1):   12 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.3125    0.4545    0.3704        22
    Preictal     0.0000    0.0000    0.0000        22

    accuracy                         0.2273        44
   macro avg     0.1562    0.2273    0.1852        44
weighted avg     0.1562    0.2273    0.1852        44
              precision    recall  f1-score   support

  Interictal     0.3125    0.4545    0.3704        22
    Preictal     0.0000    0.0000    0.0000        22

    accuracy                         0.2273        44
   macro avg     0.1562    0.2273    0.1852        44
weighted avg     0.1562    0.2273    0.1852        44



✅ Results saved to model\chb15_fold7\test_results.json
✅ Results saved to model\chb15_fold7\test_results.json


============================================================
============================================================

EVALUATING FOLD 8/19
EVALUATING FOLD 8/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold8
Dataset prefix: chb15_fold8
Using test dataset: preprocessing\data\chb15_fold8\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold8\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold8\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold8\test_dataset.h5...
  - Normalization: z-score, mean=-0.7176, std=2.0127
  - Normalization: z-score, mean=-0.7176, std=2.0127
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.6056, 3.8115]
  - Value range: [-5.6056, 3.8115]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold8\epoch_005.pth...
Loading model checkpoint from model\chb15_fold8\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.62it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.62it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6887
Loss:      0.6887
Accuracy:  0.8182 (81.82%)
Accuracy:  0.8182 (81.82%)
Precision: 0.7333
Precision: 0.7333
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.8462
F1 Score:  0.8462
AUC-ROC:   0.7665
AUC-ROC:   0.7665

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         8
Actual Interictal        14         8
       Preictal         0        22
       Preictal         0        22

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 14 samples
Pred Interictal (0): 14 samples
Pred Preictal (1):   30 samples
Pred Preictal (1):   30 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.6364    0.7778        22
    Preictal     0.7333    1.0000    0.8462        22

    accuracy                         0.8182        44
   macro avg     0.8667    0.8182    0.8120        44
weighted avg     0.8667    0.8182    0.8120        44
              precision    recall  f1-score   support

  Interictal     1.0000    0.6364    0.7778        22
    Preictal     0.7333    1.0000    0.8462        22

    accuracy                         0.8182        44
   macro avg     0.8667    0.8182    0.8120        44
weighted avg     0.8667    0.8182    0.8120        44



✅ Results saved to model\chb15_fold8\test_results.json
✅ Results saved to model\chb15_fold8\test_results.json


============================================================
============================================================

EVALUATING FOLD 9/19
EVALUATING FOLD 9/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold9
Dataset prefix: chb15_fold9
Using test dataset: preprocessing\data\chb15_fold9\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold9\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold9\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold9\test_dataset.h5...
  - Normalization: z-score, mean=-0.7501, std=1.9955
  - Normalization: z-score, mean=-0.7501, std=1.9955
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.6372, 4.0987]
  - Value range: [-5.6372, 4.0987]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold9\epoch_005.pth...
Loading model checkpoint from model\chb15_fold9\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.41it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.41it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6768
Loss:      0.6768
Accuracy:  0.7500 (75.00%)
Accuracy:  0.7500 (75.00%)
Precision: 0.6667
Precision: 0.6667
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.8000
F1 Score:  0.8000
AUC-ROC:   0.7650
AUC-ROC:   0.7650

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        10        10
Actual Interictal        10        10
       Preictal         0        20
       Preictal         0        20

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 10 samples
Pred Interictal (0): 10 samples
Pred Preictal (1):   30 samples
Pred Preictal (1):   30 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.5000    0.6667        20
    Preictal     0.6667    1.0000    0.8000        20

    accuracy                         0.7500        40
   macro avg     0.8333    0.7500    0.7333        40
weighted avg     0.8333    0.7500    0.7333        40
              precision    recall  f1-score   support

  Interictal     1.0000    0.5000    0.6667        20
    Preictal     0.6667    1.0000    0.8000        20

    accuracy                         0.7500        40
   macro avg     0.8333    0.7500    0.7333        40
weighted avg     0.8333    0.7500    0.7333        40



✅ Results saved to model\chb15_fold9\test_results.json
✅ Results saved to model\chb15_fold9\test_results.json


============================================================
============================================================

EVALUATING FOLD 10/19
EVALUATING FOLD 10/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold10
Dataset prefix: chb15_fold10
Using test dataset: preprocessing\data\chb15_fold10\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold10\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold10\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold10\test_dataset.h5...
  - Normalization: z-score, mean=-0.7736, std=2.0327
  - Normalization: z-score, mean=-0.7736, std=2.0327
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.5230, 3.8576]
  - Value range: [-5.5230, 3.8576]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold10\epoch_005.pth...
Loading model checkpoint from model\chb15_fold10\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.91it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.91it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6806
Loss:      0.6806
Accuracy:  0.8333 (83.33%)
Accuracy:  0.8333 (83.33%)
Precision: 0.7500
Precision: 0.7500
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.8571
F1 Score:  0.8571
AUC-ROC:   0.8866
AUC-ROC:   0.8866

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         7
Actual Interictal        14         7
       Preictal         0        21
       Preictal         0        21

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 14 samples
Pred Interictal (0): 14 samples
Pred Preictal (1):   28 samples
Pred Preictal (1):   28 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.6667    0.8000        21
    Preictal     0.7500    1.0000    0.8571        21

    accuracy                         0.8333        42
   macro avg     0.8750    0.8333    0.8286        42
weighted avg     0.8750    0.8333    0.8286        42
              precision    recall  f1-score   support

  Interictal     1.0000    0.6667    0.8000        21
    Preictal     0.7500    1.0000    0.8571        21

    accuracy                         0.8333        42
   macro avg     0.8750    0.8333    0.8286        42
weighted avg     0.8750    0.8333    0.8286        42



✅ Results saved to model\chb15_fold10\test_results.json
✅ Results saved to model\chb15_fold10\test_results.json


============================================================
============================================================

EVALUATING FOLD 11/19
EVALUATING FOLD 11/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold11
Dataset prefix: chb15_fold11
Using test dataset: preprocessing\data\chb15_fold11\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold11\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold11\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold11\test_dataset.h5...
  - Normalization: z-score, mean=-0.7624, std=2.0031
  - Normalization: z-score, mean=-0.7624, std=2.0031
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.6102, 4.0893]
  - Value range: [-5.6102, 4.0893]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold11\epoch_005.pth...
Loading model checkpoint from model\chb15_fold11\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.45it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.45it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.37it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.37it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6954
Loss:      0.6954
Accuracy:  0.3684 (36.84%)
Accuracy:  0.3684 (36.84%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.3878
AUC-ROC:   0.3878

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         5
Actual Interictal        14         5
       Preictal        19         0
       Preictal        19         0

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 33 samples
Pred Interictal (0): 33 samples
Pred Preictal (1):   5 samples
Pred Preictal (1):   5 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4242    0.7368    0.5385        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.3684        38
   macro avg     0.2121    0.3684    0.2692        38
weighted avg     0.2121    0.3684    0.2692        38
              precision    recall  f1-score   support

  Interictal     0.4242    0.7368    0.5385        19
    Preictal     0.0000    0.0000    0.0000        19

    accuracy                         0.3684        38
   macro avg     0.2121    0.3684    0.2692        38
weighted avg     0.2121    0.3684    0.2692        38



✅ Results saved to model\chb15_fold11\test_results.json
✅ Results saved to model\chb15_fold11\test_results.json


============================================================
============================================================

EVALUATING FOLD 12/19
EVALUATING FOLD 12/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold12
Dataset prefix: chb15_fold12
Using test dataset: preprocessing\data\chb15_fold12\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold12\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold12\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold12\test_dataset.h5...
  - Normalization: z-score, mean=-0.7965, std=1.9967
  - Normalization: z-score, mean=-0.7965, std=1.9967
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.6111, 4.1946]
  - Value range: [-5.6111, 4.1946]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold12\epoch_005.pth...
Loading model checkpoint from model\chb15_fold12\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.30it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.30it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.21it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.21it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7197
Loss:      0.7197
Accuracy:  0.5000 (50.00%)
Accuracy:  0.5000 (50.00%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.0000
AUC-ROC:   0.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        21         0
Actual Interictal        21         0
       Preictal        21         0
       Preictal        21         0

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 42 samples
Pred Interictal (0): 42 samples
Pred Preictal (1):   0 samples
Pred Preictal (1):   0 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        21
    Preictal     0.0000    0.0000    0.0000        21

    accuracy                         0.5000        42
   macro avg     0.2500    0.5000    0.3333        42
weighted avg     0.2500    0.5000    0.3333        42
              precision    recall  f1-score   support

  Interictal     0.5000    1.0000    0.6667        21
    Preictal     0.0000    0.0000    0.0000        21

    accuracy                         0.5000        42
   macro avg     0.2500    0.5000    0.3333        42
weighted avg     0.2500    0.5000    0.3333        42



✅ Results saved to model\chb15_fold12\test_results.json
✅ Results saved to model\chb15_fold12\test_results.json


============================================================
============================================================

EVALUATING FOLD 13/19
EVALUATING FOLD 13/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold13
Dataset prefix: chb15_fold13
Using test dataset: preprocessing\data\chb15_fold13\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold13\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold13\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold13\test_dataset.h5...
  - Normalization: z-score, mean=-0.7794, std=2.0276
  - Normalization: z-score, mean=-0.7794, std=2.0276
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.5339, 3.9561]
  - Value range: [-5.5339, 3.9561]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold13\epoch_005.pth...
Loading model checkpoint from model\chb15_fold13\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.59it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.59it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6931
Loss:      0.6931
Accuracy:  0.3750 (37.50%)
Accuracy:  0.3750 (37.50%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.4500
AUC-ROC:   0.4500

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        15         5
Actual Interictal        15         5
       Preictal        20         0
       Preictal        20         0

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 35 samples
Pred Interictal (0): 35 samples
Pred Preictal (1):   5 samples
Pred Preictal (1):   5 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4286    0.7500    0.5455        20
    Preictal     0.0000    0.0000    0.0000        20

    accuracy                         0.3750        40
   macro avg     0.2143    0.3750    0.2727        40
weighted avg     0.2143    0.3750    0.2727        40
              precision    recall  f1-score   support

  Interictal     0.4286    0.7500    0.5455        20
    Preictal     0.0000    0.0000    0.0000        20

    accuracy                         0.3750        40
   macro avg     0.2143    0.3750    0.2727        40
weighted avg     0.2143    0.3750    0.2727        40



✅ Results saved to model\chb15_fold13\test_results.json
✅ Results saved to model\chb15_fold13\test_results.json


============================================================
============================================================

EVALUATING FOLD 14/19
EVALUATING FOLD 14/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold14
Dataset prefix: chb15_fold14
Using test dataset: preprocessing\data\chb15_fold14\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold14\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold14\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold14\test_dataset.h5...
  - Normalization: z-score, mean=-0.7768, std=1.9970
  - Normalization: z-score, mean=-0.7768, std=1.9970
Loaded test dataset: 30 samples
Loaded test dataset: 30 samples
  - Spectrogram shape: torch.Size([30, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([30, 30, 18, 50, 10])
  - Value range: [-5.6165, 3.8339]
  - Value range: [-5.6165, 3.8339]
  - Class distribution: tensor([15, 15])
  - Class distribution: tensor([15, 15])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold14\epoch_005.pth...
Loading model checkpoint from model\chb15_fold14\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/2 [00:00<?, ?it/s]Testing:   0%|                                       | 0/2 [00:00<?, ?it/s]Testing: 100%|###############################| 2/2 [00:00<00:00, 29.72it/s]Testing: 100%|###############################| 2/2 [00:00<00:00, 29.72it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6899
Loss:      0.6899
Accuracy:  0.4667 (46.67%)
Accuracy:  0.4667 (46.67%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.5911
AUC-ROC:   0.5911

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         1
Actual Interictal        14         1
       Preictal        15         0
       Preictal        15         0

Class Distribution:
Class Distribution:

True Interictal (0): 15 samples
True Interictal (0): 15 samples
True Preictal (1):   15 samples
True Preictal (1):   15 samples
Pred Interictal (0): 29 samples
Pred Interictal (0): 29 samples
Pred Preictal (1):   1 samples
Pred Preictal (1):   1 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.4828    0.9333    0.6364        15
    Preictal     0.0000    0.0000    0.0000        15

    accuracy                         0.4667        30
   macro avg     0.2414    0.4667    0.3182        30
weighted avg     0.2414    0.4667    0.3182        30
              precision    recall  f1-score   support

  Interictal     0.4828    0.9333    0.6364        15
    Preictal     0.0000    0.0000    0.0000        15

    accuracy                         0.4667        30
   macro avg     0.2414    0.4667    0.3182        30
weighted avg     0.2414    0.4667    0.3182        30



✅ Results saved to model\chb15_fold14\test_results.json
✅ Results saved to model\chb15_fold14\test_results.json


============================================================
============================================================

EVALUATING FOLD 15/19
EVALUATING FOLD 15/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold15
Dataset prefix: chb15_fold15
Using test dataset: preprocessing\data\chb15_fold15\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold15\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold15\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold15\test_dataset.h5...
  - Normalization: z-score, mean=-0.7394, std=2.0055
  - Normalization: z-score, mean=-0.7394, std=2.0055
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.6150, 3.8171]
  - Value range: [-5.6150, 3.8171]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold15\epoch_005.pth...
Loading model checkpoint from model\chb15_fold15\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 31.19it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 31.19it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6929
Loss:      0.6929
Accuracy:  0.6087 (60.87%)
Accuracy:  0.6087 (60.87%)
Precision: 0.6087
Precision: 0.6087
Recall:    0.6087
Recall:    0.6087
F1 Score:  0.6087
F1 Score:  0.6087
AUC-ROC:   0.5577
AUC-ROC:   0.5577

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        14         9
Actual Interictal        14         9
       Preictal         9        14
       Preictal         9        14

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 23 samples
Pred Interictal (0): 23 samples
Pred Preictal (1):   23 samples
Pred Preictal (1):   23 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.6087    0.6087    0.6087        23
    Preictal     0.6087    0.6087    0.6087        23

    accuracy                         0.6087        46
   macro avg     0.6087    0.6087    0.6087        46
weighted avg     0.6087    0.6087    0.6087        46
              precision    recall  f1-score   support

  Interictal     0.6087    0.6087    0.6087        23
    Preictal     0.6087    0.6087    0.6087        23

    accuracy                         0.6087        46
   macro avg     0.6087    0.6087    0.6087        46
weighted avg     0.6087    0.6087    0.6087        46



✅ Results saved to model\chb15_fold15\test_results.json
✅ Results saved to model\chb15_fold15\test_results.json


============================================================
============================================================

EVALUATING FOLD 16/19
EVALUATING FOLD 16/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold16
Dataset prefix: chb15_fold16
Using test dataset: preprocessing\data\chb15_fold16\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold16\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold16\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold16\test_dataset.h5...
  - Normalization: z-score, mean=-0.7461, std=2.0041
  - Normalization: z-score, mean=-0.7461, std=2.0041
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.6153, 3.8155]
  - Value range: [-5.6153, 3.8155]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold16\epoch_005.pth...
Loading model checkpoint from model\chb15_fold16\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.10it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.10it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6946
Loss:      0.6946
Accuracy:  0.3333 (33.33%)
Accuracy:  0.3333 (33.33%)
Precision: 0.2308
Precision: 0.2308
Recall:    0.1429
Recall:    0.1429
F1 Score:  0.1765
F1 Score:  0.1765
AUC-ROC:   0.4150
AUC-ROC:   0.4150

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        11        10
Actual Interictal        11        10
       Preictal        18         3
       Preictal        18         3

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 29 samples
Pred Interictal (0): 29 samples
Pred Preictal (1):   13 samples
Pred Preictal (1):   13 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.3793    0.5238    0.4400        21
    Preictal     0.2308    0.1429    0.1765        21

    accuracy                         0.3333        42
   macro avg     0.3050    0.3333    0.3082        42
weighted avg     0.3050    0.3333    0.3082        42
              precision    recall  f1-score   support

  Interictal     0.3793    0.5238    0.4400        21
    Preictal     0.2308    0.1429    0.1765        21

    accuracy                         0.3333        42
   macro avg     0.3050    0.3333    0.3082        42
weighted avg     0.3050    0.3333    0.3082        42



✅ Results saved to model\chb15_fold16\test_results.json
✅ Results saved to model\chb15_fold16\test_results.json


============================================================
============================================================

EVALUATING FOLD 17/19
EVALUATING FOLD 17/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold17
Dataset prefix: chb15_fold17
Using test dataset: preprocessing\data\chb15_fold17\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold17\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold17\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold17\test_dataset.h5...
  - Normalization: z-score, mean=-0.7200, std=2.0018
  - Normalization: z-score, mean=-0.7200, std=2.0018
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.6350, 3.9236]
  - Value range: [-5.6350, 3.9236]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold17\epoch_005.pth...
Loading model checkpoint from model\chb15_fold17\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.12it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 32.12it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.7368
Loss:      0.7368
Accuracy:  0.5000 (50.00%)
Accuracy:  0.5000 (50.00%)
Precision: 0.5000
Precision: 0.5000
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.6667
F1 Score:  0.6667
AUC-ROC:   0.3560
AUC-ROC:   0.3560

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         0        21
Actual Interictal         0        21
       Preictal         0        21
       Preictal         0        21

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 0 samples
Pred Interictal (0): 0 samples
Pred Preictal (1):   42 samples
Pred Preictal (1):   42 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.0000    0.0000    0.0000        21
    Preictal     0.5000    1.0000    0.6667        21

    accuracy                         0.5000        42
   macro avg     0.2500    0.5000    0.3333        42
weighted avg     0.2500    0.5000    0.3333        42
              precision    recall  f1-score   support

  Interictal     0.0000    0.0000    0.0000        21
    Preictal     0.5000    1.0000    0.6667        21

    accuracy                         0.5000        42
   macro avg     0.2500    0.5000    0.3333        42
weighted avg     0.2500    0.5000    0.3333        42



✅ Results saved to model\chb15_fold17\test_results.json
✅ Results saved to model\chb15_fold17\test_results.json


============================================================
============================================================

EVALUATING FOLD 18/19
EVALUATING FOLD 18/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold18
Dataset prefix: chb15_fold18
Using test dataset: preprocessing\data\chb15_fold18\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold18\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold18\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold18\test_dataset.h5...
  - Normalization: z-score, mean=-0.7434, std=1.9952
  - Normalization: z-score, mean=-0.7434, std=1.9952
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.6418, 4.0024]
  - Value range: [-5.6418, 4.0024]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold18\epoch_005.pth...
Loading model checkpoint from model\chb15_fold18\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.23it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.23it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6916
Loss:      0.6916
Accuracy:  0.7250 (72.50%)
Accuracy:  0.7250 (72.50%)
Precision: 0.6452
Precision: 0.6452
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.7843
F1 Score:  0.7843
AUC-ROC:   0.7850
AUC-ROC:   0.7850

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         9        11
Actual Interictal         9        11
       Preictal         0        20
       Preictal         0        20

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 9 samples
Pred Interictal (0): 9 samples
Pred Preictal (1):   31 samples
Pred Preictal (1):   31 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.4500    0.6207        20
    Preictal     0.6452    1.0000    0.7843        20

    accuracy                         0.7250        40
   macro avg     0.8226    0.7250    0.7025        40
weighted avg     0.8226    0.7250    0.7025        40
              precision    recall  f1-score   support

  Interictal     1.0000    0.4500    0.6207        20
    Preictal     0.6452    1.0000    0.7843        20

    accuracy                         0.7250        40
   macro avg     0.8226    0.7250    0.7025        40
weighted avg     0.8226    0.7250    0.7025        40



✅ Results saved to model\chb15_fold18\test_results.json
✅ Results saved to model\chb15_fold18\test_results.json


============================================================
============================================================

EVALUATING FOLD 19/19
EVALUATING FOLD 19/19
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb15_fold19
Dataset prefix: chb15_fold19
Using test dataset: preprocessing\data\chb15_fold19\test_dataset.h5
Using test dataset: preprocessing\data\chb15_fold19\test_dataset.h5
Loading test dataset from preprocessing\data\chb15_fold19\test_dataset.h5...
Loading test dataset from preprocessing\data\chb15_fold19\test_dataset.h5...
  - Normalization: z-score, mean=-0.7881, std=2.0138
  - Normalization: z-score, mean=-0.7881, std=2.0138
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-5.5676, 3.9876]
  - Value range: [-5.5676, 3.9876]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb15_fold19\epoch_005.pth...
Loading model checkpoint from model\chb15_fold19\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.97it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.97it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.6873
Loss:      0.6873
Accuracy:  0.5208 (52.08%)
Accuracy:  0.5208 (52.08%)
Precision: 0.5161
Precision: 0.5161
Recall:    0.6667
Recall:    0.6667
F1 Score:  0.5818
F1 Score:  0.5818
AUC-ROC:   0.6285
AUC-ROC:   0.6285

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal         9        15
Actual Interictal         9        15
       Preictal         8        16
       Preictal         8        16

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 17 samples
Pred Interictal (0): 17 samples
Pred Preictal (1):   31 samples
Pred Preictal (1):   31 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.5294    0.3750    0.4390        24
    Preictal     0.5161    0.6667    0.5818        24

    accuracy                         0.5208        48
   macro avg     0.5228    0.5208    0.5104        48
weighted avg     0.5228    0.5208    0.5104        48
              precision    recall  f1-score   support

  Interictal     0.5294    0.3750    0.4390        24
    Preictal     0.5161    0.6667    0.5818        24

    accuracy                         0.5208        48
   macro avg     0.5228    0.5208    0.5104        48
weighted avg     0.5228    0.5208    0.5104        48



✅ Results saved to model\chb15_fold19\test_results.json
✅ Results saved to model\chb15_fold19\test_results.json


============================================================
============================================================

BATCH EVALUATION SUMMARY
BATCH EVALUATION SUMMARY
============================================================
============================================================
Folds evaluated: 20/20
Folds evaluated: 20/20

Mean metrics (across folds):
Mean metrics (across folds):

  Accuracy:  0.4895 (±0.1992)
  Accuracy:  0.4895 (±0.1992)
  Precision: 0.3053 (±0.3051)
  Precision: 0.3053 (±0.3051)
  Recall:    0.3916 (±0.4275)
  Recall:    0.3916 (±0.4275)
  F1 Score:  0.3360 (±0.3509)
  F1 Score:  0.3360 (±0.3509)
  AUC-ROC:   0.4709 (±0.2838)
  AUC-ROC:   0.4709 (±0.2838)

✅ Batch results saved to model\batch_test_results.json
✅ Batch results saved to model\batch_test_results.json

============================================================
============================================================
