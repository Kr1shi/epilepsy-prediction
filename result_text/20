============================================================
BATCH PROCESSING: ALL FOLDS
Processing 8 folds for patient chb20
============================================================

Configuration:
  - Task mode: PREDICTION (preictal vs interictal)
  - LOOCV Mode: ENABLED
  - Sequence length: 30 segments
  - Sequence duration: 150s (2.5 min)
  - Stride: 5 segments (83% overlap)
  - Segment duration: 5s
  - Preictal window: 10 min
  - Interictal buffer: 120 min
  - Channel validation: ENABLED
  - Target channels: 18 channels
============================================================

Extracting sequences from patient chb20...
Patient chb20: 590 sequences (145 preictal, 445 interictal)

============================================================
PROCESSING FOLD 0/7
============================================================
Output prefix: chb20_fold0
LOOCV Fold 0: Test seizure=0, Train seizures=[1, 2, 3, 4, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 513
  - Preictal sequences: 145
  - Interictal sequences: 368
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb20: 513 total (145 preictal, 368 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 223 total (0 preictal, 223 interictal)
train: 290 total (145 preictal, 145 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 269.7s (4.5 min)
Class balance: 145/368 = 0.39

=== SPLIT BALANCING SUMMARY ===
train: 145 preictal, 145 interictal (dropped 0 preictal, 77 interictal)
test: Skipped balancing due to missing class

Sequences saved to chb20_fold0_sequences_prediction.json
File size: 0.85 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 29
Files with valid channels: 29
Files with invalid channels: 0

✅ Fold 0 completed successfully!
✅ Sequences saved to chb20_fold0_sequences_prediction.json

============================================================
PROCESSING FOLD 1/7
============================================================
Output prefix: chb20_fold1
LOOCV Fold 1: Test seizure=1, Train seizures=[0, 2, 3, 4, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 290
  - Preictal sequences: 145
  - Interictal sequences: 145
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb20: 290 total (145 preictal, 145 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 246 total (123 preictal, 123 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 269.7s (4.5 min)
Class balance: 145/145 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 123 preictal, 123 interictal (dropped 0 preictal, 99 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 201 interictal)

Sequences saved to chb20_fold1_sequences_prediction.json
File size: 0.49 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 29
Files with valid channels: 29
Files with invalid channels: 0

✅ Fold 1 completed successfully!
✅ Sequences saved to chb20_fold1_sequences_prediction.json

============================================================
PROCESSING FOLD 2/7
============================================================
Output prefix: chb20_fold2
LOOCV Fold 2: Test seizure=2, Train seizures=[0, 1, 3, 4, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 290
  - Preictal sequences: 145
  - Interictal sequences: 145
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb20: 290 total (145 preictal, 145 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 242 total (121 preictal, 121 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 269.7s (4.5 min)
Class balance: 145/145 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 121 preictal, 121 interictal (dropped 0 preictal, 101 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 199 interictal)

Sequences saved to chb20_fold2_sequences_prediction.json
File size: 0.49 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 29
Files with valid channels: 29
Files with invalid channels: 0

✅ Fold 2 completed successfully!
✅ Sequences saved to chb20_fold2_sequences_prediction.json

============================================================
PROCESSING FOLD 3/7
============================================================
Output prefix: chb20_fold3
LOOCV Fold 3: Test seizure=3, Train seizures=[0, 1, 2, 4, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 290
  - Preictal sequences: 145
  - Interictal sequences: 145
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb20: 290 total (145 preictal, 145 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 252 total (126 preictal, 126 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 269.7s (4.5 min)
Class balance: 145/145 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 126 preictal, 126 interictal (dropped 0 preictal, 96 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 204 interictal)

Sequences saved to chb20_fold3_sequences_prediction.json
File size: 0.49 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 29
Files with valid channels: 29
Files with invalid channels: 0

✅ Fold 3 completed successfully!
✅ Sequences saved to chb20_fold3_sequences_prediction.json

============================================================
PROCESSING FOLD 4/7
============================================================
Output prefix: chb20_fold4
LOOCV Fold 4: Test seizure=4, Train seizures=[0, 1, 2, 3, 5, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 290
  - Preictal sequences: 145
  - Interictal sequences: 145
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb20: 290 total (145 preictal, 145 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 30 total (15 preictal, 15 interictal)
train: 260 total (130 preictal, 130 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 269.7s (4.5 min)
Class balance: 145/145 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 130 preictal, 130 interictal (dropped 0 preictal, 92 interictal)
test: 15 preictal, 15 interictal (dropped 0 preictal, 208 interictal)

Sequences saved to chb20_fold4_sequences_prediction.json
File size: 0.49 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 29
Files with valid channels: 29
Files with invalid channels: 0

✅ Fold 4 completed successfully!
✅ Sequences saved to chb20_fold4_sequences_prediction.json

============================================================
PROCESSING FOLD 5/7
============================================================
Output prefix: chb20_fold5
LOOCV Fold 5: Test seizure=5, Train seizures=[0, 1, 2, 3, 4, 6, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 290
  - Preictal sequences: 145
  - Interictal sequences: 145
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb20: 290 total (145 preictal, 145 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 246 total (123 preictal, 123 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 269.7s (4.5 min)
Class balance: 145/145 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 123 preictal, 123 interictal (dropped 0 preictal, 99 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 201 interictal)

Sequences saved to chb20_fold5_sequences_prediction.json
File size: 0.49 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 29
Files with valid channels: 29
Files with invalid channels: 0

✅ Fold 5 completed successfully!
✅ Sequences saved to chb20_fold5_sequences_prediction.json

============================================================
PROCESSING FOLD 6/7
============================================================
Output prefix: chb20_fold6
LOOCV Fold 6: Test seizure=6, Train seizures=[0, 1, 2, 3, 4, 5, 7]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 290
  - Preictal sequences: 145
  - Interictal sequences: 145
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb20: 290 total (145 preictal, 145 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 244 total (122 preictal, 122 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 269.7s (4.5 min)
Class balance: 145/145 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 122 preictal, 122 interictal (dropped 0 preictal, 100 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 200 interictal)

Sequences saved to chb20_fold6_sequences_prediction.json
File size: 0.49 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 29
Files with valid channels: 29
Files with invalid channels: 0

✅ Fold 6 completed successfully!
✅ Sequences saved to chb20_fold6_sequences_prediction.json

============================================================
PROCESSING FOLD 7/7
============================================================
Output prefix: chb20_fold7
LOOCV Fold 7: Test seizure=7, Train seizures=[0, 1, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 290
  - Preictal sequences: 145
  - Interictal sequences: 145
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb20: 290 total (145 preictal, 145 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 250 total (125 preictal, 125 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 269.7s (4.5 min)
Class balance: 145/145 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 125 preictal, 125 interictal (dropped 0 preictal, 97 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 203 interictal)

Sequences saved to chb20_fold7_sequences_prediction.json
File size: 0.49 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 29
Files with valid channels: 29
Files with invalid channels: 0

✅ Fold 7 completed successfully!
✅ Sequences saved to chb20_fold7_sequences_prediction.json

============================================================
✅ BATCH PROCESSING COMPLETED!
✅ Processed 8 folds for patient chb20
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 8 folds for patient chb20
============================================================

============================================================
PREPROCESSING FOLD 0/7
============================================================
2025-11-20 18:11:24,925 - INFO - ============================================================
2025-11-20 18:11:24,925 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 18:11:24,925 - INFO - ============================================================
2025-11-20 18:11:24,925 - INFO - Output prefix: chb20_fold0
2025-11-20 18:11:24,925 - INFO - EEG Preprocessor initialized
2025-11-20 18:11:24,925 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 18:11:24,925 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 18:11:24,925 - INFO - Segment duration: 5 seconds
2025-11-20 18:11:24,925 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 18:11:24,925 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 18:11:24,925 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 18:11:24,925 - INFO - Loading segments from chb20_fold0_sequences_prediction.json
2025-11-20 18:11:24,943 - INFO - Loaded 513 total sequences
2025-11-20 18:11:24,943 - INFO - Channel validation (from segmentation): 29/29 files valid
2025-11-20 18:11:24,943 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 18:11:24,943 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 18:11:24,943 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 18:11:24,943 - INFO - train: 290 sequences (145 preictal, 145 interictal)
2025-11-20 18:11:24,943 - INFO - test: 223 sequences (0 preictal, 223 interictal)
2025-11-20 18:11:24,970 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 18:11:24,970 - INFO - train: kept 145 preictal and 145 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:11:24,970 - WARNING - test: Skipped balancing due to missing class
2025-11-20 18:11:24,997 - INFO - ============================================================
2025-11-20 18:11:24,997 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 18:11:24,997 - INFO - ============================================================
2025-11-20 18:11:24,997 - INFO - Processing 290 training samples to compute normalization stats...
2025-11-20 18:11:24,997 - INFO - Processing 290 sequences from 26 unique files
Processing training data:   0%|                    | 0/290 [00:00<?, ?it/s]Processing training data:   0%|            | 1/290 [00:02<13:14,  2.75s/it]Processing training data:   3%|3           | 8/290 [00:03<01:55,  2.44it/s]Processing training data:   6%|6          | 16/290 [00:05<01:14,  3.69it/s]Processing training data:  14%|#5         | 40/290 [00:06<00:24, 10.13it/s]Processing training data:  22%|##3        | 63/290 [00:07<00:18, 12.47it/s]Processing training data:  25%|##7        | 72/290 [00:08<00:20, 10.79it/s]Processing training data:  41%|####      | 118/290 [00:10<00:09, 18.37it/s]Processing training data:  44%|####3     | 127/290 [00:12<00:12, 12.99it/s]Processing training data:  47%|####6     | 135/290 [00:13<00:13, 11.46it/s]Processing training data:  58%|#####7    | 167/290 [00:13<00:06, 18.45it/s]Processing training data:  64%|######4   | 187/290 [00:15<00:06, 15.36it/s]Processing training data:  68%|######7   | 197/290 [00:17<00:07, 11.81it/s]Processing training data:  70%|#######   | 203/290 [00:19<00:09,  8.91it/s]Processing training data:  74%|#######3  | 214/290 [00:20<00:09,  8.30it/s]Processing training data:  77%|#######6  | 222/290 [00:22<00:09,  6.97it/s]Processing training data:  81%|########  | 234/290 [00:23<00:07,  7.56it/s]Processing training data:  83%|########3 | 241/290 [00:24<00:06,  7.92it/s]Processing training data:  85%|########4 | 246/290 [00:26<00:07,  6.16it/s]Processing training data:  87%|########6 | 251/290 [00:27<00:07,  5.17it/s]Processing training data:  89%|########8 | 257/290 [00:29<00:06,  4.84it/s]Processing training data:  90%|######### | 262/290 [00:30<00:06,  4.55it/s]Processing training data:  91%|#########1| 265/290 [00:32<00:06,  3.64it/s]Processing training data:  93%|#########3| 271/290 [00:34<00:05,  3.54it/s]Processing training data:  96%|#########5| 278/290 [00:35<00:03,  3.60it/s]Processing training data:  98%|#########8| 285/290 [00:36<00:00,  5.05it/s]Processing training data:  99%|#########8| 287/290 [00:37<00:00,  3.74it/s]Processing training data: 100%|##########| 290/290 [00:37<00:00,  7.67it/s]
2025-11-20 18:12:02,796 - INFO - Computing normalization statistics from training data...
2025-11-20 18:12:03,306 - INFO - Normalization stats computed:
2025-11-20 18:12:03,306 - INFO -   Mean: 0.218548
2025-11-20 18:12:03,306 - INFO -   Std: 2.159055
2025-11-20 18:12:03,306 - INFO -   Saved to: preprocessing\checkpoints\chb20_fold0\normalization_stats.json
2025-11-20 18:12:03,369 - INFO - Applying normalization and saving 290 training sequences...
Normalizing and saving training data:   0%|        | 0/290 [00:00<?, ?it/s]2025-11-20 18:12:03,379 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold0\train_dataset.h5
Normalizing and saving training data:   3%| | 10/290 [00:00<00:18, 14.90it/Normalizing and saving training data:   7%| | 20/290 [00:01<00:18, 14.88it/Normalizing and saving training data:  10%|1| 30/290 [00:02<00:17, 14.92it/Normalizing and saving training data:  14%|1| 40/290 [00:02<00:16, 14.93it/Normalizing and saving training data:  17%|1| 50/290 [00:03<00:15, 15.02it/Normalizing and saving training data:  21%|2| 60/290 [00:04<00:15, 15.05it/Normalizing and saving training data:  24%|2| 70/290 [00:04<00:14, 15.10it/Normalizing and saving training data:  28%|2| 80/290 [00:05<00:13, 15.13it/Normalizing and saving training data:  31%|3| 90/290 [00:05<00:13, 15.18it/Normalizing and saving training data:  34%|3| 100/290 [00:06<00:12, 15.18itNormalizing and saving training data:  38%|3| 110/290 [00:07<00:11, 15.17itNormalizing and saving training data:  41%|4| 120/290 [00:07<00:11, 15.18itNormalizing and saving training data:  45%|4| 130/290 [00:08<00:10, 15.20itNormalizing and saving training data:  48%|4| 140/290 [00:09<00:09, 15.17itNormalizing and saving training data:  52%|5| 150/290 [00:09<00:09, 15.16itNormalizing and saving training data:  55%|5| 160/290 [00:10<00:08, 15.15itNormalizing and saving training data:  59%|5| 170/290 [00:11<00:07, 15.15itNormalizing and saving training data:  62%|6| 180/290 [00:11<00:07, 15.12itNormalizing and saving training data:  66%|6| 190/290 [00:12<00:06, 15.10itNormalizing and saving training data:  69%|6| 200/290 [00:13<00:05, 15.07itNormalizing and saving training data:  72%|7| 210/290 [00:13<00:05, 15.02itNormalizing and saving training data:  76%|7| 220/290 [00:14<00:04, 15.02itNormalizing and saving training data:  79%|7| 230/290 [00:15<00:03, 15.02itNormalizing and saving training data:  83%|8| 240/290 [00:15<00:03, 14.99itNormalizing and saving training data:  86%|8| 250/290 [00:16<00:02, 14.97itNormalizing and saving training data:  90%|8| 260/290 [00:17<00:02, 14.99itNormalizing and saving training data:  93%|9| 270/290 [00:17<00:01, 14.86itNormalizing and saving training data:  97%|9| 280/290 [00:18<00:00, 14.92itNormalizing and saving training data: 100%|#| 290/290 [00:19<00:00, 14.97itNormalizing and saving training data: 100%|#| 290/290 [00:19<00:00, 15.05it
2025-11-20 18:12:22,660 - INFO - Training data processing completed during stats computation phase
2025-11-20 18:12:22,667 - INFO - Loaded normalization statistics:
2025-11-20 18:12:22,667 - INFO -   Mean: 0.218548
2025-11-20 18:12:22,667 - INFO -   Std: 2.159055
2025-11-20 18:12:22,667 - INFO - Split train already completed, skipping
2025-11-20 18:12:22,667 - INFO - Processing test split...
2025-11-20 18:12:22,667 - INFO - Need to process 223/223 sequences for test
2025-11-20 18:12:22,667 - INFO - Processing 223 sequences from 21 unique files
2025-11-20 18:12:22,667 - INFO - Average 10.6 sequences per file
Processing test:   0%|                             | 0/223 [00:00<?, ?it/s]Processing test:   0%|                     | 1/223 [00:01<06:25,  1.74s/it]2025-11-20 18:12:24,407 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold0\test_dataset.h5
2025-11-20 18:12:25,296 - INFO - Progress: 304/513 (59.3%) - ETA: 0.7 minutes
Processing test:   7%|#3                  | 15/223 [00:04<00:54,  3.83it/s]2025-11-20 18:12:27,979 - INFO - Progress: 319/513 (62.2%) - ETA: 0.6 minutes
Processing test:  13%|##6                 | 30/223 [00:07<00:42,  4.56it/s]2025-11-20 18:12:30,595 - INFO - Progress: 330/513 (64.3%) - ETA: 0.6 minutes
Processing test:  18%|###6                | 41/223 [00:09<00:39,  4.58it/s]2025-11-20 18:12:33,106 - INFO - Progress: 343/513 (66.9%) - ETA: 0.6 minutes
Processing test:  24%|####8               | 54/223 [00:12<00:36,  4.69it/s]2025-11-20 18:12:35,773 - INFO - Progress: 356/513 (69.4%) - ETA: 0.5 minutes
Processing test:  30%|######              | 67/223 [00:14<00:31,  4.93it/s]2025-11-20 18:12:38,047 - INFO - Progress: 367/513 (71.5%) - ETA: 0.5 minutes
Processing test:  35%|######9             | 78/223 [00:17<00:30,  4.79it/s]2025-11-20 18:12:40,683 - INFO - Progress: 381/513 (74.3%) - ETA: 0.4 minutes
Processing test:  41%|########2           | 92/223 [00:19<00:26,  5.03it/s]Processing test:  45%|########5          | 100/223 [00:21<00:25,  4.87it/s]2025-11-20 18:12:45,453 - INFO - Progress: 402/513 (78.4%) - ETA: 0.4 minutes
Processing test:  51%|#########6         | 113/223 [00:24<00:23,  4.63it/s]2025-11-20 18:12:47,980 - INFO - Progress: 414/513 (80.7%) - ETA: 0.3 minutes
Processing test:  56%|##########6        | 125/223 [00:27<00:21,  4.61it/s]2025-11-20 18:12:50,748 - INFO - Progress: 428/513 (83.4%) - ETA: 0.3 minutes
Processing test:  62%|###########8       | 139/223 [00:29<00:16,  4.95it/s]Processing test:  66%|############6      | 148/223 [00:31<00:15,  5.00it/s]2025-11-20 18:12:55,233 - INFO - Progress: 447/513 (87.1%) - ETA: 0.2 minutes
Processing test:  71%|#############4     | 158/223 [00:34<00:14,  4.36it/s]2025-11-20 18:12:57,844 - INFO - Progress: 459/513 (89.5%) - ETA: 0.2 minutes
Processing test:  76%|##############4    | 170/223 [00:37<00:12,  4.41it/s]2025-11-20 18:13:00,374 - INFO - Progress: 469/513 (91.4%) - ETA: 0.1 minutes
Processing test:  81%|###############3   | 180/223 [00:39<00:09,  4.35it/s]2025-11-20 18:13:02,824 - INFO - Progress: 480/513 (93.6%) - ETA: 0.1 minutes
Processing test:  86%|################2  | 191/223 [00:41<00:07,  4.42it/s]2025-11-20 18:13:05,276 - INFO - Progress: 492/513 (95.9%) - ETA: 0.1 minutes
Processing test:  91%|#################2 | 203/223 [00:43<00:04,  4.81it/s]Processing test:  95%|#################9 | 211/223 [00:45<00:02,  4.78it/s]2025-11-20 18:13:09,450 - INFO - Progress: 511/513 (99.6%) - ETA: 0.0 minutes
Processing test: 100%|##################9| 222/223 [00:47<00:00,  5.34it/s]Processing test: 100%|###################| 223/223 [00:47<00:00,  5.40it/s]Processing test: 100%|###################| 223/223 [00:47<00:00,  4.72it/s]
2025-11-20 18:13:10,101 - INFO - Validating final datasets...
2025-11-20 18:13:10,110 - INFO - train dataset validation:
2025-11-20 18:13:10,110 - INFO -   - Segments: 290
2025-11-20 18:13:10,110 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:13:10,110 - INFO -   - Classes: 145 preictal, 145 interictal
2025-11-20 18:13:10,110 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:13:10,116 - INFO - test dataset validation:
2025-11-20 18:13:10,116 - INFO -   - Segments: 223
2025-11-20 18:13:10,116 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:13:10,116 - INFO -   - Classes: 0 preictal, 223 interictal
2025-11-20 18:13:10,116 - INFO -   - Balance: 0.0% preictal
2025-11-20 18:13:10,116 - INFO - ============================================================
2025-11-20 18:13:10,116 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 18:13:10,116 - INFO - Total time: 1.8 minutes
2025-11-20 18:13:10,116 - INFO - Processed segments: 513
2025-11-20 18:13:10,116 - INFO - Average rate: 4.9 segments/second
2025-11-20 18:13:10,116 - INFO - ============================================================
✅ Fold 0 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 1/7
============================================================
2025-11-20 18:13:10,189 - INFO - ============================================================
2025-11-20 18:13:10,190 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 18:13:10,190 - INFO - ============================================================
2025-11-20 18:13:10,190 - INFO - Output prefix: chb20_fold1
2025-11-20 18:13:10,190 - INFO - EEG Preprocessor initialized
2025-11-20 18:13:10,190 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 18:13:10,190 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 18:13:10,190 - INFO - Segment duration: 5 seconds
2025-11-20 18:13:10,190 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 18:13:10,190 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 18:13:10,190 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 18:13:10,190 - INFO - Loading segments from chb20_fold1_sequences_prediction.json
2025-11-20 18:13:10,201 - INFO - Loaded 290 total sequences
2025-11-20 18:13:10,201 - INFO - Channel validation (from segmentation): 29/29 files valid
2025-11-20 18:13:10,201 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 18:13:10,202 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 18:13:10,202 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 18:13:10,202 - INFO - train: 246 sequences (123 preictal, 123 interictal)
2025-11-20 18:13:10,202 - INFO - test: 44 sequences (22 preictal, 22 interictal)
2025-11-20 18:13:10,218 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 18:13:10,218 - INFO - train: kept 123 preictal and 123 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:13:10,218 - INFO - test: kept 22 preictal and 22 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:13:10,233 - INFO - ============================================================
2025-11-20 18:13:10,234 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 18:13:10,234 - INFO - ============================================================
2025-11-20 18:13:10,234 - INFO - Processing 246 training samples to compute normalization stats...
2025-11-20 18:13:10,234 - INFO - Processing 246 sequences from 26 unique files
Processing training data:   0%|                    | 0/246 [00:00<?, ?it/s]Processing training data:   0%|            | 1/246 [00:01<04:27,  1.09s/it]Processing training data:  13%|#4         | 33/246 [00:02<00:12, 16.67it/s]Processing training data:  17%|#8         | 41/246 [00:03<00:19, 10.39it/s]Processing training data:  20%|##1        | 48/246 [00:05<00:24,  8.20it/s]Processing training data:  23%|##5        | 57/246 [00:05<00:19,  9.67it/s]Processing training data:  31%|###4       | 77/246 [00:07<00:15, 10.90it/s]Processing training data:  36%|###9       | 89/246 [00:08<00:15,  9.99it/s]Processing training data:  38%|####1      | 93/246 [00:09<00:16,  9.41it/s]Processing training data:  47%|####7     | 116/246 [00:10<00:10, 12.58it/s]Processing training data:  57%|#####6    | 140/246 [00:11<00:07, 15.09it/s]Processing training data:  59%|#####8    | 145/246 [00:12<00:07, 13.68it/s]Processing training data:  69%|######8   | 169/246 [00:14<00:05, 13.85it/s]Processing training data:  70%|#######   | 173/246 [00:15<00:07,  9.42it/s]Processing training data:  74%|#######3  | 181/246 [00:17<00:07,  8.53it/s]Processing training data:  76%|#######6  | 187/246 [00:18<00:08,  6.93it/s]Processing training data:  79%|#######8  | 194/246 [00:20<00:08,  6.45it/s]Processing training data:  82%|########1 | 201/246 [00:21<00:08,  5.53it/s]Processing training data:  84%|########3 | 206/246 [00:23<00:08,  4.80it/s]Processing training data:  86%|########6 | 212/246 [00:25<00:07,  4.55it/s]Processing training data:  88%|########8 | 217/246 [00:25<00:06,  4.68it/s]Processing training data:  89%|########9 | 220/246 [00:26<00:05,  5.04it/s]Processing training data:  90%|######### | 222/246 [00:26<00:04,  5.54it/s]Processing training data:  91%|######### | 223/246 [00:27<00:05,  4.35it/s]Processing training data:  92%|#########1| 226/246 [00:29<00:06,  3.01it/s]Processing training data:  96%|#########6| 237/246 [00:30<00:01,  4.64it/s]Processing training data:  99%|#########8| 243/246 [00:32<00:00,  4.39it/s]Processing training data: 100%|##########| 246/246 [00:32<00:00,  7.68it/s]
2025-11-20 18:13:42,268 - INFO - Computing normalization statistics from training data...
2025-11-20 18:13:42,672 - INFO - Normalization stats computed:
2025-11-20 18:13:42,672 - INFO -   Mean: 0.210372
2025-11-20 18:13:42,672 - INFO -   Std: 2.165354
2025-11-20 18:13:42,672 - INFO -   Saved to: preprocessing\checkpoints\chb20_fold1\normalization_stats.json
2025-11-20 18:13:42,718 - INFO - Applying normalization and saving 246 training sequences...
Normalizing and saving training data:   0%|        | 0/246 [00:00<?, ?it/s]2025-11-20 18:13:42,729 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold1\train_dataset.h5
Normalizing and saving training data:   4%| | 10/246 [00:00<00:15, 15.66it/Normalizing and saving training data:   8%| | 20/246 [00:01<00:14, 15.63it/Normalizing and saving training data:  12%|1| 30/246 [00:01<00:13, 15.63it/Normalizing and saving training data:  16%|1| 40/246 [00:02<00:13, 15.63it/Normalizing and saving training data:  20%|2| 50/246 [00:03<00:12, 15.62it/Normalizing and saving training data:  24%|2| 60/246 [00:03<00:11, 15.65it/Normalizing and saving training data:  28%|2| 70/246 [00:04<00:11, 15.69it/Normalizing and saving training data:  33%|3| 80/246 [00:05<00:10, 15.72it/Normalizing and saving training data:  37%|3| 90/246 [00:05<00:09, 15.65it/Normalizing and saving training data:  41%|4| 100/246 [00:06<00:09, 15.68itNormalizing and saving training data:  45%|4| 110/246 [00:07<00:08, 15.69itNormalizing and saving training data:  49%|4| 120/246 [00:07<00:08, 15.74itNormalizing and saving training data:  53%|5| 130/246 [00:08<00:07, 15.72itNormalizing and saving training data:  57%|5| 140/246 [00:08<00:06, 15.69itNormalizing and saving training data:  61%|6| 150/246 [00:09<00:06, 15.65itNormalizing and saving training data:  65%|6| 160/246 [00:10<00:05, 15.64itNormalizing and saving training data:  69%|6| 170/246 [00:10<00:04, 15.61itNormalizing and saving training data:  73%|7| 180/246 [00:11<00:04, 15.60itNormalizing and saving training data:  77%|7| 190/246 [00:12<00:03, 15.59itNormalizing and saving training data:  81%|8| 200/246 [00:12<00:02, 15.58itNormalizing and saving training data:  85%|8| 210/246 [00:13<00:02, 15.58itNormalizing and saving training data:  89%|8| 220/246 [00:14<00:01, 15.57itNormalizing and saving training data:  93%|9| 230/246 [00:14<00:01, 15.45itNormalizing and saving training data:  98%|9| 240/246 [00:15<00:00, 15.49itNormalizing and saving training data: 100%|#| 246/246 [00:15<00:00, 16.00it
2025-11-20 18:13:58,497 - INFO - Training data processing completed during stats computation phase
2025-11-20 18:13:58,505 - INFO - Loaded normalization statistics:
2025-11-20 18:13:58,505 - INFO -   Mean: 0.210372
2025-11-20 18:13:58,505 - INFO -   Std: 2.165354
2025-11-20 18:13:58,505 - INFO - Split train already completed, skipping
2025-11-20 18:13:58,505 - INFO - Processing test split...
2025-11-20 18:13:58,505 - INFO - Need to process 44/44 sequences for test
2025-11-20 18:13:58,506 - INFO - Processing 44 sequences from 13 unique files
2025-11-20 18:13:58,506 - INFO - Average 3.4 sequences per file
Processing test:   0%|                              | 0/44 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/44 [00:01<01:01,  1.42s/it]Processing test:   9%|##                    | 4/44 [00:02<00:17,  2.24it/s]2025-11-20 18:14:00,583 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold1\test_dataset.h5
2025-11-20 18:14:02,102 - INFO - Progress: 271/290 (93.4%) - ETA: 0.1 minutes
Processing test:  59%|############4        | 26/44 [00:03<00:02,  8.14it/s]Processing test:  61%|############8        | 27/44 [00:04<00:02,  6.04it/s]Processing test:  66%|#############8       | 29/44 [00:06<00:03,  3.81it/s]Processing test:  73%|###############2     | 32/44 [00:06<00:02,  4.32it/s]Processing test:  75%|###############7     | 33/44 [00:07<00:03,  3.41it/s]Processing test:  80%|################7    | 35/44 [00:08<00:03,  2.99it/s]2025-11-20 18:14:08,072 - INFO - Progress: 283/290 (97.6%) - ETA: 0.0 minutes
Processing test:  86%|##################1  | 38/44 [00:09<00:02,  2.90it/s]Processing test:  89%|##################6  | 39/44 [00:11<00:02,  2.26it/s]Processing test:  95%|#################### | 42/44 [00:11<00:00,  3.02it/s]Processing test:  98%|####################5| 43/44 [00:11<00:00,  2.99it/s]Processing test: 100%|#####################| 44/44 [00:12<00:00,  2.90it/s]Processing test: 100%|#####################| 44/44 [00:12<00:00,  3.62it/s]
2025-11-20 18:14:11,125 - INFO - Validating final datasets...
2025-11-20 18:14:11,133 - INFO - train dataset validation:
2025-11-20 18:14:11,133 - INFO -   - Segments: 246
2025-11-20 18:14:11,133 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:14:11,133 - INFO -   - Classes: 123 preictal, 123 interictal
2025-11-20 18:14:11,133 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:14:11,139 - INFO - test dataset validation:
2025-11-20 18:14:11,139 - INFO -   - Segments: 44
2025-11-20 18:14:11,139 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:14:11,139 - INFO -   - Classes: 22 preictal, 22 interictal
2025-11-20 18:14:11,139 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:14:11,139 - INFO - ============================================================
2025-11-20 18:14:11,139 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 18:14:11,139 - INFO - Total time: 1.0 minutes
2025-11-20 18:14:11,139 - INFO - Processed segments: 290
2025-11-20 18:14:11,139 - INFO - Average rate: 4.8 segments/second
2025-11-20 18:14:11,139 - INFO - ============================================================
✅ Fold 1 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 2/7
============================================================
2025-11-20 18:14:11,203 - INFO - ============================================================
2025-11-20 18:14:11,203 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 18:14:11,203 - INFO - ============================================================
2025-11-20 18:14:11,203 - INFO - Output prefix: chb20_fold2
2025-11-20 18:14:11,203 - INFO - EEG Preprocessor initialized
2025-11-20 18:14:11,203 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 18:14:11,203 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 18:14:11,203 - INFO - Segment duration: 5 seconds
2025-11-20 18:14:11,203 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 18:14:11,203 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 18:14:11,203 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 18:14:11,203 - INFO - Loading segments from chb20_fold2_sequences_prediction.json
2025-11-20 18:14:11,214 - INFO - Loaded 290 total sequences
2025-11-20 18:14:11,215 - INFO - Channel validation (from segmentation): 29/29 files valid
2025-11-20 18:14:11,215 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 18:14:11,215 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 18:14:11,215 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 18:14:11,215 - INFO - train: 242 sequences (121 preictal, 121 interictal)
2025-11-20 18:14:11,215 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-20 18:14:11,230 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 18:14:11,231 - INFO - train: kept 121 preictal and 121 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:14:11,231 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:14:11,246 - INFO - ============================================================
2025-11-20 18:14:11,246 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 18:14:11,246 - INFO - ============================================================
2025-11-20 18:14:11,246 - INFO - Processing 242 training samples to compute normalization stats...
2025-11-20 18:14:11,246 - INFO - Processing 242 sequences from 26 unique files
Processing training data:   0%|                    | 0/242 [00:00<?, ?it/s]Processing training data:   0%|            | 1/242 [00:01<06:29,  1.62s/it]Processing training data:   2%|2           | 5/242 [00:03<02:10,  1.82it/s]Processing training data:   6%|6          | 14/242 [00:04<01:03,  3.59it/s]Processing training data:   8%|9          | 20/242 [00:05<00:55,  4.02it/s]Processing training data:  18%|##         | 44/242 [00:06<00:18, 10.78it/s]Processing training data:  28%|###        | 67/242 [00:06<00:08, 19.83it/s]Processing training data:  31%|###3       | 74/242 [00:08<00:16, 10.33it/s]Processing training data:  33%|###5       | 79/242 [00:10<00:20,  7.95it/s]Processing training data:  34%|###7       | 83/242 [00:10<00:20,  7.83it/s]Processing training data:  43%|####2     | 103/242 [00:12<00:13, 10.33it/s]Processing training data:  44%|####3     | 106/242 [00:13<00:17,  7.97it/s]Processing training data:  57%|#####7    | 138/242 [00:14<00:06, 15.93it/s]Processing training data:  66%|######6   | 160/242 [00:15<00:05, 15.85it/s]Processing training data:  69%|######9   | 167/242 [00:17<00:06, 11.49it/s]Processing training data:  72%|#######1  | 174/242 [00:17<00:06, 10.92it/s]Processing training data:  74%|#######3  | 179/242 [00:19<00:07,  7.93it/s]Processing training data:  77%|#######7  | 187/242 [00:21<00:07,  6.89it/s]Processing training data:  80%|########  | 194/242 [00:22<00:08,  5.72it/s]Processing training data:  83%|########2 | 200/242 [00:24<00:08,  4.85it/s]Processing training data:  86%|########6 | 209/242 [00:26<00:06,  5.36it/s]Processing training data:  88%|########8 | 213/242 [00:27<00:06,  4.41it/s]Processing training data:  91%|######### | 220/242 [00:29<00:04,  4.52it/s]Processing training data:  95%|#########4| 229/242 [00:30<00:02,  5.03it/s]Processing training data:  98%|#########7| 236/242 [00:31<00:01,  5.70it/s]Processing training data:  99%|#########8| 239/242 [00:32<00:00,  4.54it/s]Processing training data: 100%|##########| 242/242 [00:32<00:00,  7.34it/s]
2025-11-20 18:14:44,238 - INFO - Computing normalization statistics from training data...
2025-11-20 18:14:44,667 - INFO - Normalization stats computed:
2025-11-20 18:14:44,667 - INFO -   Mean: 0.226727
2025-11-20 18:14:44,667 - INFO -   Std: 2.156253
2025-11-20 18:14:44,667 - INFO -   Saved to: preprocessing\checkpoints\chb20_fold2\normalization_stats.json
2025-11-20 18:14:44,713 - INFO - Applying normalization and saving 242 training sequences...
Normalizing and saving training data:   0%|        | 0/242 [00:00<?, ?it/s]2025-11-20 18:14:44,723 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold2\train_dataset.h5
Normalizing and saving training data:   4%| | 10/242 [00:00<00:14, 15.75it/Normalizing and saving training data:   8%| | 20/242 [00:01<00:14, 15.68it/Normalizing and saving training data:  12%|1| 30/242 [00:01<00:13, 15.62it/Normalizing and saving training data:  17%|1| 40/242 [00:02<00:12, 15.66it/Normalizing and saving training data:  21%|2| 50/242 [00:03<00:12, 15.72it/Normalizing and saving training data:  25%|2| 60/242 [00:03<00:11, 15.70it/Normalizing and saving training data:  29%|2| 70/242 [00:04<00:10, 15.76it/Normalizing and saving training data:  33%|3| 80/242 [00:05<00:10, 15.77it/Normalizing and saving training data:  37%|3| 90/242 [00:05<00:09, 15.80it/Normalizing and saving training data:  41%|4| 100/242 [00:06<00:09, 15.72itNormalizing and saving training data:  45%|4| 110/242 [00:06<00:08, 15.77itNormalizing and saving training data:  50%|4| 120/242 [00:07<00:07, 15.80itNormalizing and saving training data:  54%|5| 130/242 [00:08<00:07, 15.79itNormalizing and saving training data:  58%|5| 140/242 [00:08<00:06, 15.75itNormalizing and saving training data:  62%|6| 150/242 [00:09<00:05, 15.72itNormalizing and saving training data:  66%|6| 160/242 [00:10<00:05, 15.69itNormalizing and saving training data:  70%|7| 170/242 [00:10<00:04, 15.68itNormalizing and saving training data:  74%|7| 180/242 [00:11<00:03, 15.66itNormalizing and saving training data:  79%|7| 190/242 [00:12<00:03, 15.64itNormalizing and saving training data:  83%|8| 200/242 [00:12<00:02, 15.65itNormalizing and saving training data:  87%|8| 210/242 [00:13<00:02, 15.63itNormalizing and saving training data:  91%|9| 220/242 [00:14<00:01, 15.60itNormalizing and saving training data:  95%|9| 230/242 [00:14<00:00, 15.59itNormalizing and saving training data:  99%|9| 240/242 [00:15<00:00, 15.61itNormalizing and saving training data: 100%|#| 242/242 [00:15<00:00, 15.82it
2025-11-20 18:15:00,176 - INFO - Training data processing completed during stats computation phase
2025-11-20 18:15:00,182 - INFO - Loaded normalization statistics:
2025-11-20 18:15:00,183 - INFO -   Mean: 0.226727
2025-11-20 18:15:00,183 - INFO -   Std: 2.156253
2025-11-20 18:15:00,183 - INFO - Split train already completed, skipping
2025-11-20 18:15:00,183 - INFO - Processing test split...
2025-11-20 18:15:00,183 - INFO - Need to process 48/48 sequences for test
2025-11-20 18:15:00,183 - INFO - Processing 48 sequences from 14 unique files
2025-11-20 18:15:00,183 - INFO - Average 3.4 sequences per file
Processing test:   0%|                              | 0/48 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/48 [00:01<01:13,  1.57s/it]Processing test:   6%|#3                    | 3/48 [00:02<00:36,  1.22it/s]Processing test:  12%|##7                   | 6/48 [00:04<00:28,  1.47it/s]Processing test:  19%|####1                 | 9/48 [00:05<00:22,  1.75it/s]2025-11-20 18:15:05,983 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold2\test_dataset.h5
2025-11-20 18:15:06,660 - INFO - Progress: 253/290 (87.2%) - ETA: 0.1 minutes
Processing test:  25%|#####2               | 12/48 [00:07<00:19,  1.89it/s]2025-11-20 18:15:08,858 - INFO - Progress: 277/290 (95.5%) - ETA: 0.0 minutes
Processing test:  75%|###############7     | 36/48 [00:09<00:02,  5.41it/s]Processing test:  81%|#################    | 39/48 [00:10<00:01,  5.69it/s]Processing test:  83%|#################5   | 40/48 [00:10<00:01,  5.31it/s]Processing test:  85%|#################9   | 41/48 [00:10<00:01,  4.97it/s]Processing test:  88%|##################3  | 42/48 [00:11<00:01,  3.57it/s]Processing test:  92%|###################2 | 44/48 [00:12<00:01,  3.84it/s]Processing test:  94%|###################6 | 45/48 [00:12<00:00,  3.24it/s]2025-11-20 18:15:13,802 - INFO - Progress: 288/290 (99.3%) - ETA: 0.0 minutes
Processing test:  98%|####################5| 47/48 [00:13<00:00,  2.71it/s]Processing test: 100%|#####################| 48/48 [00:14<00:00,  2.69it/s]Processing test: 100%|#####################| 48/48 [00:14<00:00,  3.34it/s]
2025-11-20 18:15:14,712 - INFO - Validating final datasets...
2025-11-20 18:15:14,720 - INFO - train dataset validation:
2025-11-20 18:15:14,720 - INFO -   - Segments: 242
2025-11-20 18:15:14,720 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:15:14,720 - INFO -   - Classes: 121 preictal, 121 interictal
2025-11-20 18:15:14,720 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:15:14,725 - INFO - test dataset validation:
2025-11-20 18:15:14,725 - INFO -   - Segments: 48
2025-11-20 18:15:14,725 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:15:14,725 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-20 18:15:14,725 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:15:14,725 - INFO - ============================================================
2025-11-20 18:15:14,725 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 18:15:14,725 - INFO - Total time: 1.1 minutes
2025-11-20 18:15:14,725 - INFO - Processed segments: 290
2025-11-20 18:15:14,725 - INFO - Average rate: 4.6 segments/second
2025-11-20 18:15:14,725 - INFO - ============================================================
✅ Fold 2 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 3/7
============================================================
2025-11-20 18:15:14,788 - INFO - ============================================================
2025-11-20 18:15:14,788 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 18:15:14,788 - INFO - ============================================================
2025-11-20 18:15:14,788 - INFO - Output prefix: chb20_fold3
2025-11-20 18:15:14,788 - INFO - EEG Preprocessor initialized
2025-11-20 18:15:14,788 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 18:15:14,788 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 18:15:14,788 - INFO - Segment duration: 5 seconds
2025-11-20 18:15:14,788 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 18:15:14,788 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 18:15:14,788 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 18:15:14,788 - INFO - Loading segments from chb20_fold3_sequences_prediction.json
2025-11-20 18:15:14,800 - INFO - Loaded 290 total sequences
2025-11-20 18:15:14,800 - INFO - Channel validation (from segmentation): 29/29 files valid
2025-11-20 18:15:14,800 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 18:15:14,800 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 18:15:14,800 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 18:15:14,800 - INFO - train: 252 sequences (126 preictal, 126 interictal)
2025-11-20 18:15:14,800 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-20 18:15:14,815 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 18:15:14,816 - INFO - train: kept 126 preictal and 126 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:15:14,816 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:15:14,831 - INFO - ============================================================
2025-11-20 18:15:14,831 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 18:15:14,831 - INFO - ============================================================
2025-11-20 18:15:14,831 - INFO - Processing 252 training samples to compute normalization stats...
2025-11-20 18:15:14,831 - INFO - Processing 252 sequences from 25 unique files
Processing training data:   0%|                    | 0/252 [00:00<?, ?it/s]Processing training data:   0%|            | 1/252 [00:00<02:45,  1.51it/s]Processing training data:  10%|#          | 24/252 [00:01<00:17, 13.28it/s]Processing training data:  12%|#3         | 30/252 [00:02<00:16, 13.41it/s]Processing training data:  14%|#5         | 35/252 [00:03<00:23,  9.35it/s]Processing training data:  27%|##9        | 67/252 [00:03<00:08, 22.68it/s]Processing training data:  35%|###7       | 87/252 [00:05<00:07, 20.74it/s]Processing training data:  38%|####1      | 96/252 [00:06<00:10, 14.23it/s]Processing training data:  40%|####      | 102/252 [00:08<00:16,  9.27it/s]Processing training data:  44%|####3     | 110/252 [00:10<00:18,  7.53it/s]Processing training data:  48%|####8     | 121/252 [00:11<00:16,  8.18it/s]Processing training data:  66%|######6   | 167/252 [00:12<00:05, 15.79it/s]Processing training data:  68%|######8   | 172/252 [00:14<00:07, 11.42it/s]Processing training data:  71%|#######1  | 180/252 [00:15<00:06, 10.78it/s]Processing training data:  73%|#######2  | 183/252 [00:16<00:08,  7.95it/s]Processing training data:  75%|#######5  | 189/252 [00:18<00:09,  6.50it/s]Processing training data:  77%|#######7  | 195/252 [00:19<00:09,  5.97it/s]Processing training data:  79%|#######8  | 198/252 [00:21<00:11,  4.65it/s]Processing training data:  81%|########1 | 205/252 [00:21<00:07,  6.10it/s]Processing training data:  82%|########2 | 207/252 [00:23<00:11,  4.09it/s]Processing training data:  85%|########4 | 213/252 [00:24<00:09,  4.00it/s]Processing training data:  87%|########6 | 218/252 [00:26<00:08,  3.90it/s]Processing training data:  90%|########9 | 226/252 [00:28<00:06,  4.06it/s]Processing training data:  93%|#########3| 235/252 [00:29<00:03,  5.16it/s]Processing training data:  96%|#########5| 241/252 [00:30<00:02,  4.54it/s]Processing training data:  98%|#########7| 246/252 [00:32<00:01,  4.01it/s]Processing training data: 100%|##########| 252/252 [00:32<00:00,  7.76it/s]
2025-11-20 18:15:47,302 - INFO - Computing normalization statistics from training data...
2025-11-20 18:15:47,770 - INFO - Normalization stats computed:
2025-11-20 18:15:47,770 - INFO -   Mean: 0.244970
2025-11-20 18:15:47,770 - INFO -   Std: 2.133853
2025-11-20 18:15:47,770 - INFO -   Saved to: preprocessing\checkpoints\chb20_fold3\normalization_stats.json
2025-11-20 18:15:47,816 - INFO - Applying normalization and saving 252 training sequences...
Normalizing and saving training data:   0%|        | 0/252 [00:00<?, ?it/s]2025-11-20 18:15:47,827 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold3\train_dataset.h5
Normalizing and saving training data:   4%| | 10/252 [00:00<00:15, 15.77it/Normalizing and saving training data:   8%| | 20/252 [00:01<00:14, 15.60it/Normalizing and saving training data:  12%|1| 30/252 [00:01<00:14, 15.67it/Normalizing and saving training data:  16%|1| 40/252 [00:02<00:13, 15.64it/Normalizing and saving training data:  20%|1| 50/252 [00:03<00:12, 15.67it/Normalizing and saving training data:  24%|2| 60/252 [00:03<00:12, 15.73it/Normalizing and saving training data:  28%|2| 70/252 [00:04<00:11, 15.72it/Normalizing and saving training data:  32%|3| 80/252 [00:05<00:10, 15.77it/Normalizing and saving training data:  36%|3| 90/252 [00:05<00:10, 15.77it/Normalizing and saving training data:  40%|3| 100/252 [00:06<00:09, 15.79itNormalizing and saving training data:  44%|4| 110/252 [00:06<00:08, 15.80itNormalizing and saving training data:  48%|4| 120/252 [00:07<00:08, 15.81itNormalizing and saving training data:  52%|5| 130/252 [00:08<00:07, 15.79itNormalizing and saving training data:  56%|5| 140/252 [00:08<00:07, 15.73itNormalizing and saving training data:  60%|5| 150/252 [00:09<00:06, 15.70itNormalizing and saving training data:  63%|6| 160/252 [00:10<00:05, 15.65itNormalizing and saving training data:  67%|6| 170/252 [00:10<00:05, 15.65itNormalizing and saving training data:  71%|7| 180/252 [00:11<00:04, 15.63itNormalizing and saving training data:  75%|7| 190/252 [00:12<00:03, 15.59itNormalizing and saving training data:  79%|7| 200/252 [00:12<00:03, 15.60itNormalizing and saving training data:  83%|8| 210/252 [00:13<00:02, 15.60itNormalizing and saving training data:  87%|8| 220/252 [00:14<00:02, 15.62itNormalizing and saving training data:  91%|9| 230/252 [00:14<00:01, 15.63itNormalizing and saving training data:  95%|9| 240/252 [00:15<00:00, 15.56itNormalizing and saving training data:  99%|9| 250/252 [00:15<00:00, 15.50itNormalizing and saving training data: 100%|#| 252/252 [00:15<00:00, 15.78it
2025-11-20 18:16:03,947 - INFO - Training data processing completed during stats computation phase
2025-11-20 18:16:03,955 - INFO - Loaded normalization statistics:
2025-11-20 18:16:03,955 - INFO -   Mean: 0.244970
2025-11-20 18:16:03,955 - INFO -   Std: 2.133853
2025-11-20 18:16:03,955 - INFO - Split train already completed, skipping
2025-11-20 18:16:03,955 - INFO - Processing test split...
2025-11-20 18:16:03,955 - INFO - Need to process 38/38 sequences for test
2025-11-20 18:16:03,955 - INFO - Processing 38 sequences from 12 unique files
2025-11-20 18:16:03,955 - INFO - Average 3.2 sequences per file
Processing test:   0%|                              | 0/38 [00:00<?, ?it/s]Processing test:   3%|5                     | 1/38 [00:00<00:23,  1.55it/s]2025-11-20 18:16:04,603 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold3\test_dataset.h5
2025-11-20 18:16:05,773 - INFO - Progress: 271/290 (93.4%) - ETA: 0.1 minutes
Processing test:  53%|###########          | 20/38 [00:02<00:02,  7.36it/s]Processing test:  58%|############1        | 22/38 [00:03<00:02,  6.02it/s]Processing test:  66%|#############8       | 25/38 [00:04<00:02,  5.46it/s]Processing test:  71%|##############9      | 27/38 [00:05<00:02,  4.55it/s]Processing test:  76%|################     | 29/38 [00:05<00:01,  4.76it/s]2025-11-20 18:16:10,095 - INFO - Progress: 281/290 (96.9%) - ETA: 0.0 minutes
Processing test:  79%|################5    | 30/38 [00:06<00:02,  2.78it/s]Processing test:  84%|#################6   | 32/38 [00:07<00:01,  3.19it/s]Processing test:  87%|##################2  | 33/38 [00:07<00:01,  3.09it/s]Processing test:  89%|##################7  | 34/38 [00:08<00:01,  2.44it/s]Processing test:  95%|###################8 | 36/38 [00:09<00:00,  2.66it/s]Processing test: 100%|#####################| 38/38 [00:09<00:00,  3.17it/s]Processing test: 100%|#####################| 38/38 [00:09<00:00,  4.01it/s]
2025-11-20 18:16:14,025 - INFO - Validating final datasets...
2025-11-20 18:16:14,034 - INFO - train dataset validation:
2025-11-20 18:16:14,034 - INFO -   - Segments: 252
2025-11-20 18:16:14,034 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:16:14,034 - INFO -   - Classes: 126 preictal, 126 interictal
2025-11-20 18:16:14,034 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:16:14,039 - INFO - test dataset validation:
2025-11-20 18:16:14,039 - INFO -   - Segments: 38
2025-11-20 18:16:14,039 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:16:14,039 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-20 18:16:14,039 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:16:14,039 - INFO - ============================================================
2025-11-20 18:16:14,039 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 18:16:14,039 - INFO - Total time: 1.0 minutes
2025-11-20 18:16:14,039 - INFO - Processed segments: 290
2025-11-20 18:16:14,039 - INFO - Average rate: 4.9 segments/second
2025-11-20 18:16:14,039 - INFO - ============================================================
✅ Fold 3 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 4/7
============================================================
2025-11-20 18:16:14,104 - INFO - ============================================================
2025-11-20 18:16:14,104 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 18:16:14,104 - INFO - ============================================================
2025-11-20 18:16:14,104 - INFO - Output prefix: chb20_fold4
2025-11-20 18:16:14,105 - INFO - EEG Preprocessor initialized
2025-11-20 18:16:14,105 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 18:16:14,105 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 18:16:14,105 - INFO - Segment duration: 5 seconds
2025-11-20 18:16:14,105 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 18:16:14,105 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 18:16:14,105 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 18:16:14,105 - INFO - Loading segments from chb20_fold4_sequences_prediction.json
2025-11-20 18:16:14,116 - INFO - Loaded 290 total sequences
2025-11-20 18:16:14,116 - INFO - Channel validation (from segmentation): 29/29 files valid
2025-11-20 18:16:14,116 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 18:16:14,116 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 18:16:14,117 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 18:16:14,117 - INFO - train: 260 sequences (130 preictal, 130 interictal)
2025-11-20 18:16:14,117 - INFO - test: 30 sequences (15 preictal, 15 interictal)
2025-11-20 18:16:14,132 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 18:16:14,132 - INFO - train: kept 130 preictal and 130 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:16:14,132 - INFO - test: kept 15 preictal and 15 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:16:14,148 - INFO - ============================================================
2025-11-20 18:16:14,148 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 18:16:14,148 - INFO - ============================================================
2025-11-20 18:16:14,148 - INFO - Processing 260 training samples to compute normalization stats...
2025-11-20 18:16:14,148 - INFO - Processing 260 sequences from 26 unique files
Processing training data:   0%|                    | 0/260 [00:00<?, ?it/s]Processing training data:   0%|            | 1/260 [00:01<06:31,  1.51s/it]Processing training data:   3%|3           | 7/260 [00:02<01:22,  3.05it/s]Processing training data:  20%|##2        | 53/260 [00:04<00:12, 16.06it/s]Processing training data:  24%|##6        | 62/260 [00:04<00:12, 15.30it/s]Processing training data:  33%|###5       | 85/260 [00:06<00:10, 16.42it/s]Processing training data:  35%|###8       | 92/260 [00:07<00:14, 11.30it/s]Processing training data:  38%|####1      | 98/260 [00:08<00:14, 11.53it/s]Processing training data:  45%|####5     | 118/260 [00:08<00:08, 16.09it/s]Processing training data:  53%|#####2    | 137/260 [00:10<00:08, 13.67it/s]Processing training data:  55%|#####5    | 143/260 [00:12<00:11,  9.77it/s]Processing training data:  58%|#####8    | 152/260 [00:14<00:13,  7.90it/s]Processing training data:  62%|######1   | 161/260 [00:15<00:13,  7.48it/s]Processing training data:  65%|######5   | 169/260 [00:17<00:13,  6.66it/s]Processing training data:  67%|######6   | 174/260 [00:18<00:14,  5.87it/s]Processing training data:  70%|#######   | 182/260 [00:19<00:13,  5.77it/s]Processing training data:  72%|#######1  | 186/260 [00:20<00:12,  6.06it/s]Processing training data:  72%|#######2  | 188/260 [00:21<00:13,  5.45it/s]Processing training data:  81%|########  | 210/260 [00:22<00:05,  8.64it/s]Processing training data:  84%|########3 | 218/260 [00:24<00:05,  7.54it/s]Processing training data:  87%|########6 | 225/260 [00:26<00:05,  6.20it/s]Processing training data:  89%|########9 | 232/260 [00:27<00:05,  5.39it/s]Processing training data:  93%|#########3| 243/260 [00:29<00:02,  6.44it/s]Processing training data:  95%|#########5| 247/260 [00:30<00:02,  5.72it/s]Processing training data:  97%|#########6| 252/260 [00:30<00:01,  6.87it/s]Processing training data:  98%|#########7| 254/260 [00:31<00:01,  5.80it/s]Processing training data:  98%|#########8| 256/260 [00:32<00:01,  3.87it/s]Processing training data: 100%|##########| 260/260 [00:32<00:00,  7.95it/s]
2025-11-20 18:16:46,845 - INFO - Computing normalization statistics from training data...
2025-11-20 18:16:47,296 - INFO - Normalization stats computed:
2025-11-20 18:16:47,296 - INFO -   Mean: 0.269514
2025-11-20 18:16:47,297 - INFO -   Std: 2.143370
2025-11-20 18:16:47,297 - INFO -   Saved to: preprocessing\checkpoints\chb20_fold4\normalization_stats.json
2025-11-20 18:16:47,344 - INFO - Applying normalization and saving 260 training sequences...
Normalizing and saving training data:   0%|        | 0/260 [00:00<?, ?it/s]2025-11-20 18:16:47,355 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold4\train_dataset.h5
Normalizing and saving training data:   4%| | 10/260 [00:00<00:15, 15.74it/Normalizing and saving training data:   8%| | 20/260 [00:01<00:15, 15.38it/Normalizing and saving training data:  12%|1| 30/260 [00:01<00:14, 15.50it/Normalizing and saving training data:  15%|1| 40/260 [00:02<00:14, 15.63it/Normalizing and saving training data:  19%|1| 50/260 [00:03<00:13, 15.70it/Normalizing and saving training data:  23%|2| 60/260 [00:03<00:12, 15.64it/Normalizing and saving training data:  27%|2| 70/260 [00:04<00:12, 15.71it/Normalizing and saving training data:  31%|3| 80/260 [00:05<00:11, 15.71it/Normalizing and saving training data:  35%|3| 90/260 [00:05<00:10, 15.75it/Normalizing and saving training data:  38%|3| 100/260 [00:06<00:10, 15.76itNormalizing and saving training data:  42%|4| 110/260 [00:07<00:09, 15.78itNormalizing and saving training data:  46%|4| 120/260 [00:07<00:08, 15.78itNormalizing and saving training data:  50%|5| 130/260 [00:08<00:08, 15.79itNormalizing and saving training data:  54%|5| 140/260 [00:08<00:07, 15.70itNormalizing and saving training data:  58%|5| 150/260 [00:09<00:07, 15.69itNormalizing and saving training data:  62%|6| 160/260 [00:10<00:06, 15.65itNormalizing and saving training data:  65%|6| 170/260 [00:10<00:05, 15.64itNormalizing and saving training data:  69%|6| 180/260 [00:11<00:05, 15.64itNormalizing and saving training data:  73%|7| 190/260 [00:12<00:04, 15.61itNormalizing and saving training data:  77%|7| 200/260 [00:12<00:03, 15.57itNormalizing and saving training data:  81%|8| 210/260 [00:13<00:03, 15.58itNormalizing and saving training data:  85%|8| 220/260 [00:14<00:02, 15.58itNormalizing and saving training data:  88%|8| 230/260 [00:14<00:01, 15.58itNormalizing and saving training data:  92%|9| 240/260 [00:15<00:01, 15.61itNormalizing and saving training data:  96%|9| 250/260 [00:15<00:00, 15.60itNormalizing and saving training data: 100%|#| 260/260 [00:16<00:00, 15.51itNormalizing and saving training data: 100%|#| 260/260 [00:16<00:00, 15.64it
2025-11-20 18:17:03,987 - INFO - Training data processing completed during stats computation phase
2025-11-20 18:17:03,994 - INFO - Loaded normalization statistics:
2025-11-20 18:17:03,994 - INFO -   Mean: 0.269514
2025-11-20 18:17:03,994 - INFO -   Std: 2.143370
2025-11-20 18:17:03,994 - INFO - Split train already completed, skipping
2025-11-20 18:17:03,994 - INFO - Processing test split...
2025-11-20 18:17:03,994 - INFO - Need to process 30/30 sequences for test
2025-11-20 18:17:03,994 - INFO - Processing 30 sequences from 12 unique files
2025-11-20 18:17:03,994 - INFO - Average 2.5 sequences per file
Processing test:   0%|                              | 0/30 [00:00<?, ?it/s]Processing test:   3%|7                     | 1/30 [00:01<00:40,  1.41s/it]Processing test:  10%|##2                   | 3/30 [00:01<00:15,  1.79it/s]2025-11-20 18:17:05,925 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold4\test_dataset.h5
2025-11-20 18:17:06,661 - INFO - Progress: 272/290 (93.8%) - ETA: 0.1 minutes
Processing test:  43%|#########1           | 13/30 [00:03<00:03,  4.69it/s]Processing test:  50%|##########5          | 15/30 [00:03<00:03,  4.78it/s]Processing test:  53%|###########2         | 16/30 [00:04<00:04,  3.20it/s]Processing test:  60%|############6        | 18/30 [00:05<00:03,  3.58it/s]Processing test:  63%|#############3       | 19/30 [00:05<00:03,  3.27it/s]2025-11-20 18:17:10,356 - INFO - Progress: 283/290 (97.6%) - ETA: 0.0 minutes
Processing test:  80%|################8    | 24/30 [00:06<00:01,  3.94it/s]Processing test:  83%|#################5   | 25/30 [00:07<00:01,  3.72it/s]Processing test:  87%|##################2  | 26/30 [00:07<00:01,  3.25it/s]Processing test:  93%|###################6 | 28/30 [00:07<00:00,  3.66it/s]Processing test:  97%|####################3| 29/30 [00:08<00:00,  2.87it/s]Processing test: 100%|#####################| 30/30 [00:08<00:00,  3.46it/s]
2025-11-20 18:17:13,135 - INFO - Validating final datasets...
2025-11-20 18:17:13,143 - INFO - train dataset validation:
2025-11-20 18:17:13,144 - INFO -   - Segments: 260
2025-11-20 18:17:13,144 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:17:13,144 - INFO -   - Classes: 130 preictal, 130 interictal
2025-11-20 18:17:13,144 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:17:13,149 - INFO - test dataset validation:
2025-11-20 18:17:13,149 - INFO -   - Segments: 30
2025-11-20 18:17:13,149 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:17:13,149 - INFO -   - Classes: 15 preictal, 15 interictal
2025-11-20 18:17:13,149 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:17:13,149 - INFO - ============================================================
2025-11-20 18:17:13,149 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 18:17:13,149 - INFO - Total time: 1.0 minutes
2025-11-20 18:17:13,149 - INFO - Processed segments: 290
2025-11-20 18:17:13,149 - INFO - Average rate: 4.9 segments/second
2025-11-20 18:17:13,149 - INFO - ============================================================
✅ Fold 4 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 5/7
============================================================
2025-11-20 18:17:13,216 - INFO - ============================================================
2025-11-20 18:17:13,216 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 18:17:13,216 - INFO - ============================================================
2025-11-20 18:17:13,216 - INFO - Output prefix: chb20_fold5
2025-11-20 18:17:13,216 - INFO - EEG Preprocessor initialized
2025-11-20 18:17:13,216 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 18:17:13,216 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 18:17:13,216 - INFO - Segment duration: 5 seconds
2025-11-20 18:17:13,216 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 18:17:13,217 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 18:17:13,217 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 18:17:13,217 - INFO - Loading segments from chb20_fold5_sequences_prediction.json
2025-11-20 18:17:13,228 - INFO - Loaded 290 total sequences
2025-11-20 18:17:13,228 - INFO - Channel validation (from segmentation): 29/29 files valid
2025-11-20 18:17:13,228 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 18:17:13,228 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 18:17:13,228 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 18:17:13,228 - INFO - train: 246 sequences (123 preictal, 123 interictal)
2025-11-20 18:17:13,228 - INFO - test: 44 sequences (22 preictal, 22 interictal)
2025-11-20 18:17:13,244 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 18:17:13,244 - INFO - train: kept 123 preictal and 123 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:17:13,244 - INFO - test: kept 22 preictal and 22 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:17:13,260 - INFO - ============================================================
2025-11-20 18:17:13,260 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 18:17:13,260 - INFO - ============================================================
2025-11-20 18:17:13,260 - INFO - Processing 246 training samples to compute normalization stats...
2025-11-20 18:17:13,260 - INFO - Processing 246 sequences from 25 unique files
Processing training data:   0%|                    | 0/246 [00:00<?, ?it/s]Processing training data:   0%|            | 1/246 [00:01<05:09,  1.26s/it]Processing training data:  10%|#1         | 25/246 [00:02<00:21, 10.14it/s]Processing training data:  13%|#4         | 33/246 [00:03<00:23,  9.19it/s]Processing training data:  32%|###5       | 79/246 [00:04<00:07, 23.85it/s]Processing training data:  33%|###6       | 82/246 [00:05<00:08, 18.87it/s]Processing training data:  43%|####2     | 105/246 [00:06<00:08, 17.07it/s]Processing training data:  46%|####5     | 112/246 [00:07<00:07, 16.84it/s]Processing training data:  50%|####9     | 122/246 [00:08<00:10, 12.21it/s]Processing training data:  52%|#####2    | 128/246 [00:10<00:12,  9.59it/s]Processing training data:  54%|#####4    | 134/246 [00:10<00:11,  9.84it/s]Processing training data:  63%|######2   | 154/246 [00:12<00:08, 10.40it/s]Processing training data:  66%|######5   | 162/246 [00:13<00:09,  8.61it/s]Processing training data:  68%|######8   | 168/246 [00:15<00:12,  6.49it/s]Processing training data:  72%|#######1  | 177/246 [00:17<00:11,  5.93it/s]Processing training data:  75%|#######4  | 184/246 [00:19<00:11,  5.63it/s]Processing training data:  77%|#######6  | 189/246 [00:20<00:11,  4.99it/s]Processing training data:  79%|#######9  | 195/246 [00:22<00:11,  4.46it/s]Processing training data:  83%|########2 | 203/246 [00:24<00:09,  4.53it/s]Processing training data:  85%|########4 | 208/246 [00:25<00:09,  4.00it/s]Processing training data:  87%|########7 | 215/246 [00:27<00:07,  3.94it/s]Processing training data:  90%|######### | 222/246 [00:28<00:05,  4.64it/s]Processing training data:  92%|#########1| 226/246 [00:30<00:05,  3.99it/s]Processing training data:  95%|#########5| 234/246 [00:30<00:02,  5.79it/s]Processing training data:  96%|#########5| 236/246 [00:31<00:02,  4.29it/s]Processing training data:  97%|#########7| 239/246 [00:33<00:01,  3.65it/s]Processing training data: 100%|##########| 246/246 [00:33<00:00,  7.42it/s]
2025-11-20 18:17:46,407 - INFO - Computing normalization statistics from training data...
2025-11-20 18:17:46,860 - INFO - Normalization stats computed:
2025-11-20 18:17:46,860 - INFO -   Mean: 0.227177
2025-11-20 18:17:46,860 - INFO -   Std: 2.157964
2025-11-20 18:17:46,860 - INFO -   Saved to: preprocessing\checkpoints\chb20_fold5\normalization_stats.json
2025-11-20 18:17:46,906 - INFO - Applying normalization and saving 246 training sequences...
Normalizing and saving training data:   0%|        | 0/246 [00:00<?, ?it/s]2025-11-20 18:17:46,916 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold5\train_dataset.h5
Normalizing and saving training data:   4%| | 10/246 [00:00<00:14, 15.81it/Normalizing and saving training data:   8%| | 20/246 [00:01<00:14, 15.67it/Normalizing and saving training data:  12%|1| 30/246 [00:01<00:13, 15.63it/Normalizing and saving training data:  16%|1| 40/246 [00:02<00:13, 15.38it/Normalizing and saving training data:  20%|2| 50/246 [00:03<00:12, 15.54it/Normalizing and saving training data:  24%|2| 60/246 [00:03<00:11, 15.59it/Normalizing and saving training data:  28%|2| 70/246 [00:04<00:11, 15.67it/Normalizing and saving training data:  33%|3| 80/246 [00:05<00:10, 15.71it/Normalizing and saving training data:  37%|3| 90/246 [00:05<00:09, 15.77it/Normalizing and saving training data:  41%|4| 100/246 [00:06<00:09, 15.80itNormalizing and saving training data:  45%|4| 110/246 [00:07<00:08, 15.83itNormalizing and saving training data:  49%|4| 120/246 [00:07<00:07, 15.82itNormalizing and saving training data:  53%|5| 130/246 [00:08<00:07, 15.82itNormalizing and saving training data:  57%|5| 140/246 [00:08<00:06, 15.79itNormalizing and saving training data:  61%|6| 150/246 [00:09<00:06, 15.72itNormalizing and saving training data:  65%|6| 160/246 [00:10<00:05, 15.67itNormalizing and saving training data:  69%|6| 170/246 [00:10<00:04, 15.62itNormalizing and saving training data:  73%|7| 180/246 [00:11<00:04, 15.58itNormalizing and saving training data:  77%|7| 190/246 [00:12<00:03, 15.58itNormalizing and saving training data:  81%|8| 200/246 [00:12<00:02, 15.59itNormalizing and saving training data:  85%|8| 210/246 [00:13<00:02, 15.57itNormalizing and saving training data:  89%|8| 220/246 [00:14<00:01, 15.60itNormalizing and saving training data:  93%|9| 230/246 [00:14<00:01, 15.63itNormalizing and saving training data:  98%|9| 240/246 [00:15<00:00, 15.64itNormalizing and saving training data: 100%|#| 246/246 [00:15<00:00, 16.05it
2025-11-20 18:18:02,637 - INFO - Training data processing completed during stats computation phase
2025-11-20 18:18:02,644 - INFO - Loaded normalization statistics:
2025-11-20 18:18:02,644 - INFO -   Mean: 0.227177
2025-11-20 18:18:02,644 - INFO -   Std: 2.157964
2025-11-20 18:18:02,644 - INFO - Split train already completed, skipping
2025-11-20 18:18:02,644 - INFO - Processing test split...
2025-11-20 18:18:02,644 - INFO - Need to process 44/44 sequences for test
2025-11-20 18:18:02,645 - INFO - Processing 44 sequences from 14 unique files
2025-11-20 18:18:02,645 - INFO - Average 3.1 sequences per file
Processing test:   0%|                              | 0/44 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/44 [00:00<00:28,  1.49it/s]2025-11-20 18:18:03,318 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold5\test_dataset.h5
2025-11-20 18:18:04,651 - INFO - Progress: 268/290 (92.4%) - ETA: 0.1 minutes
Processing test:  52%|##########9          | 23/44 [00:02<00:01, 10.52it/s]Processing test:  55%|###########4         | 24/44 [00:02<00:02,  8.98it/s]Processing test:  57%|###########9         | 25/44 [00:03<00:02,  7.58it/s]Processing test:  59%|############4        | 26/44 [00:03<00:03,  5.00it/s]Processing test:  64%|#############3       | 28/44 [00:05<00:04,  3.22it/s]Processing test:  70%|##############7      | 31/44 [00:05<00:03,  3.59it/s]2025-11-20 18:18:09,220 - INFO - Progress: 278/290 (95.9%) - ETA: 0.0 minutes
Processing test:  75%|###############7     | 33/44 [00:07<00:04,  2.30it/s]Processing test:  82%|#################1   | 36/44 [00:08<00:02,  3.02it/s]Processing test:  84%|#################6   | 37/44 [00:09<00:03,  1.94it/s]Processing test:  91%|###################  | 40/44 [00:10<00:01,  2.69it/s]Processing test:  93%|###################5 | 41/44 [00:10<00:01,  2.73it/s]Processing test:  95%|#################### | 42/44 [00:12<00:01,  1.65it/s]2025-11-20 18:18:15,659 - INFO - Progress: 289/290 (99.7%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 44/44 [00:13<00:00,  1.74it/s]Processing test: 100%|#####################| 44/44 [00:13<00:00,  3.30it/s]
2025-11-20 18:18:16,094 - INFO - Validating final datasets...
2025-11-20 18:18:16,102 - INFO - train dataset validation:
2025-11-20 18:18:16,102 - INFO -   - Segments: 246
2025-11-20 18:18:16,102 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:18:16,102 - INFO -   - Classes: 123 preictal, 123 interictal
2025-11-20 18:18:16,102 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:18:16,108 - INFO - test dataset validation:
2025-11-20 18:18:16,108 - INFO -   - Segments: 44
2025-11-20 18:18:16,108 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:18:16,108 - INFO -   - Classes: 22 preictal, 22 interictal
2025-11-20 18:18:16,108 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:18:16,108 - INFO - ============================================================
2025-11-20 18:18:16,108 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 18:18:16,108 - INFO - Total time: 1.0 minutes
2025-11-20 18:18:16,108 - INFO - Processed segments: 290
2025-11-20 18:18:16,108 - INFO - Average rate: 4.6 segments/second
2025-11-20 18:18:16,108 - INFO - ============================================================
✅ Fold 5 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 6/7
============================================================
2025-11-20 18:18:16,171 - INFO - ============================================================
2025-11-20 18:18:16,171 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 18:18:16,171 - INFO - ============================================================
2025-11-20 18:18:16,171 - INFO - Output prefix: chb20_fold6
2025-11-20 18:18:16,171 - INFO - EEG Preprocessor initialized
2025-11-20 18:18:16,171 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 18:18:16,171 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 18:18:16,171 - INFO - Segment duration: 5 seconds
2025-11-20 18:18:16,171 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 18:18:16,171 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 18:18:16,171 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 18:18:16,172 - INFO - Loading segments from chb20_fold6_sequences_prediction.json
2025-11-20 18:18:16,183 - INFO - Loaded 290 total sequences
2025-11-20 18:18:16,183 - INFO - Channel validation (from segmentation): 29/29 files valid
2025-11-20 18:18:16,184 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 18:18:16,184 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 18:18:16,184 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 18:18:16,184 - INFO - train: 244 sequences (122 preictal, 122 interictal)
2025-11-20 18:18:16,184 - INFO - test: 46 sequences (23 preictal, 23 interictal)
2025-11-20 18:18:16,199 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 18:18:16,199 - INFO - train: kept 122 preictal and 122 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:18:16,199 - INFO - test: kept 23 preictal and 23 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:18:16,215 - INFO - ============================================================
2025-11-20 18:18:16,215 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 18:18:16,215 - INFO - ============================================================
2025-11-20 18:18:16,215 - INFO - Processing 244 training samples to compute normalization stats...
2025-11-20 18:18:16,215 - INFO - Processing 244 sequences from 25 unique files
Processing training data:   0%|                    | 0/244 [00:00<?, ?it/s]Processing training data:   0%|            | 1/244 [00:01<05:59,  1.48s/it]Processing training data:   2%|2           | 6/244 [00:02<01:40,  2.36it/s]Processing training data:   6%|6          | 14/244 [00:03<00:51,  4.43it/s]Processing training data:  19%|##         | 46/244 [00:05<00:14, 13.36it/s]Processing training data:  38%|####1      | 92/244 [00:06<00:07, 19.86it/s]Processing training data:  40%|####4      | 98/244 [00:07<00:07, 18.38it/s]Processing training data:  48%|####8     | 118/244 [00:07<00:05, 21.30it/s]Processing training data:  50%|####9     | 121/244 [00:09<00:08, 14.12it/s]Processing training data:  59%|#####9    | 145/244 [00:09<00:05, 17.36it/s]Processing training data:  61%|######    | 148/244 [00:11<00:08, 11.38it/s]Processing training data:  64%|######4   | 157/244 [00:13<00:09,  9.10it/s]Processing training data:  68%|######8   | 166/244 [00:14<00:10,  7.73it/s]Processing training data:  70%|#######   | 171/244 [00:15<00:10,  7.03it/s]Processing training data:  71%|#######   | 173/244 [00:17<00:13,  5.19it/s]Processing training data:  73%|#######3  | 179/244 [00:19<00:14,  4.45it/s]Processing training data:  77%|#######7  | 188/244 [00:20<00:11,  4.83it/s]Processing training data:  82%|########1 | 199/244 [00:20<00:05,  7.63it/s]Processing training data:  83%|########2 | 202/244 [00:22<00:07,  5.63it/s]Processing training data:  86%|########6 | 210/244 [00:23<00:06,  5.33it/s]Processing training data:  88%|########7 | 214/244 [00:25<00:06,  4.84it/s]Processing training data:  91%|######### | 221/244 [00:26<00:05,  4.54it/s]Processing training data:  94%|#########4| 230/244 [00:27<00:02,  5.76it/s]Processing training data:  95%|#########5| 232/244 [00:29<00:02,  4.34it/s]Processing training data:  96%|#########6| 235/244 [00:30<00:02,  3.36it/s]Processing training data:  99%|#########8| 241/244 [00:31<00:00,  4.28it/s]Processing training data: 100%|##########| 244/244 [00:31<00:00,  7.73it/s]
2025-11-20 18:18:47,778 - INFO - Computing normalization statistics from training data...
2025-11-20 18:18:48,201 - INFO - Normalization stats computed:
2025-11-20 18:18:48,201 - INFO -   Mean: 0.174930
2025-11-20 18:18:48,201 - INFO -   Std: 2.171758
2025-11-20 18:18:48,201 - INFO -   Saved to: preprocessing\checkpoints\chb20_fold6\normalization_stats.json
2025-11-20 18:18:48,246 - INFO - Applying normalization and saving 244 training sequences...
Normalizing and saving training data:   0%|        | 0/244 [00:00<?, ?it/s]2025-11-20 18:18:48,255 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold6\train_dataset.h5
Normalizing and saving training data:   4%| | 10/244 [00:00<00:14, 16.08it/Normalizing and saving training data:   8%| | 20/244 [00:01<00:14, 15.80it/Normalizing and saving training data:  12%|1| 30/244 [00:01<00:13, 15.78it/Normalizing and saving training data:  16%|1| 40/244 [00:02<00:12, 15.81it/Normalizing and saving training data:  20%|2| 50/244 [00:03<00:12, 15.83it/Normalizing and saving training data:  25%|2| 60/244 [00:03<00:11, 15.84it/Normalizing and saving training data:  29%|2| 70/244 [00:04<00:10, 15.84it/Normalizing and saving training data:  33%|3| 80/244 [00:05<00:10, 15.82it/Normalizing and saving training data:  37%|3| 90/244 [00:05<00:09, 15.74it/Normalizing and saving training data:  41%|4| 100/244 [00:06<00:09, 15.74itNormalizing and saving training data:  45%|4| 110/244 [00:06<00:08, 15.79itNormalizing and saving training data:  49%|4| 120/244 [00:07<00:07, 15.81itNormalizing and saving training data:  53%|5| 130/244 [00:08<00:07, 15.80itNormalizing and saving training data:  57%|5| 140/244 [00:08<00:06, 15.73itNormalizing and saving training data:  61%|6| 150/244 [00:09<00:05, 15.67itNormalizing and saving training data:  66%|6| 160/244 [00:10<00:05, 15.63itNormalizing and saving training data:  70%|6| 170/244 [00:10<00:04, 15.61itNormalizing and saving training data:  74%|7| 180/244 [00:11<00:04, 15.61itNormalizing and saving training data:  78%|7| 190/244 [00:12<00:03, 15.57itNormalizing and saving training data:  82%|8| 200/244 [00:12<00:02, 15.58itNormalizing and saving training data:  86%|8| 210/244 [00:13<00:02, 15.53itNormalizing and saving training data:  90%|9| 220/244 [00:14<00:01, 15.58itNormalizing and saving training data:  94%|9| 230/244 [00:14<00:00, 15.61itNormalizing and saving training data:  98%|9| 240/244 [00:15<00:00, 15.64itNormalizing and saving training data: 100%|#| 244/244 [00:15<00:00, 15.96it
2025-11-20 18:19:03,816 - INFO - Training data processing completed during stats computation phase
2025-11-20 18:19:03,824 - INFO - Loaded normalization statistics:
2025-11-20 18:19:03,824 - INFO -   Mean: 0.174930
2025-11-20 18:19:03,824 - INFO -   Std: 2.171758
2025-11-20 18:19:03,824 - INFO - Split train already completed, skipping
2025-11-20 18:19:03,824 - INFO - Processing test split...
2025-11-20 18:19:03,824 - INFO - Need to process 46/46 sequences for test
2025-11-20 18:19:03,824 - INFO - Processing 46 sequences from 13 unique files
2025-11-20 18:19:03,824 - INFO - Average 3.5 sequences per file
Processing test:   0%|                              | 0/46 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/46 [00:01<00:46,  1.03s/it]Processing test:   9%|#9                    | 4/46 [00:01<00:15,  2.63it/s]2025-11-20 18:19:05,542 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold6\test_dataset.h5
2025-11-20 18:19:07,113 - INFO - Progress: 270/290 (93.1%) - ETA: 0.1 minutes
Processing test:  59%|############3        | 27/46 [00:03<00:02,  8.80it/s]Processing test:  61%|############7        | 28/46 [00:04<00:02,  6.84it/s]Processing test:  65%|#############6       | 30/46 [00:06<00:03,  4.23it/s]Processing test:  74%|###############5     | 34/46 [00:06<00:02,  5.15it/s]Processing test:  76%|###############9     | 35/46 [00:07<00:03,  3.21it/s]2025-11-20 18:19:12,519 - INFO - Progress: 283/290 (97.6%) - ETA: 0.0 minutes
Processing test:  87%|##################2  | 40/46 [00:08<00:01,  3.80it/s]Processing test:  89%|##################7  | 41/46 [00:10<00:02,  2.34it/s]Processing test:  93%|###################6 | 43/46 [00:11<00:01,  2.66it/s]Processing test:  96%|#################### | 44/46 [00:11<00:00,  2.74it/s]Processing test:  98%|####################5| 45/46 [00:11<00:00,  2.71it/s]Processing test: 100%|#####################| 46/46 [00:12<00:00,  2.67it/s]Processing test: 100%|#####################| 46/46 [00:12<00:00,  3.77it/s]
2025-11-20 18:19:16,490 - INFO - Validating final datasets...
2025-11-20 18:19:16,499 - INFO - train dataset validation:
2025-11-20 18:19:16,499 - INFO -   - Segments: 244
2025-11-20 18:19:16,499 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:19:16,499 - INFO -   - Classes: 122 preictal, 122 interictal
2025-11-20 18:19:16,499 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:19:16,505 - INFO - test dataset validation:
2025-11-20 18:19:16,505 - INFO -   - Segments: 46
2025-11-20 18:19:16,505 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:19:16,505 - INFO -   - Classes: 23 preictal, 23 interictal
2025-11-20 18:19:16,505 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:19:16,506 - INFO - ============================================================
2025-11-20 18:19:16,506 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 18:19:16,506 - INFO - Total time: 1.0 minutes
2025-11-20 18:19:16,506 - INFO - Processed segments: 290
2025-11-20 18:19:16,506 - INFO - Average rate: 4.8 segments/second
2025-11-20 18:19:16,506 - INFO - ============================================================
✅ Fold 6 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 7/7
============================================================
2025-11-20 18:19:16,572 - INFO - ============================================================
2025-11-20 18:19:16,572 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-20 18:19:16,572 - INFO - ============================================================
2025-11-20 18:19:16,572 - INFO - Output prefix: chb20_fold7
2025-11-20 18:19:16,572 - INFO - EEG Preprocessor initialized
2025-11-20 18:19:16,573 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-20 18:19:16,573 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-20 18:19:16,573 - INFO - Segment duration: 5 seconds
2025-11-20 18:19:16,573 - INFO - Note: Channel validation performed during segmentation phase
2025-11-20 18:19:16,573 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-20 18:19:16,573 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-20 18:19:16,573 - INFO - Loading segments from chb20_fold7_sequences_prediction.json
2025-11-20 18:19:16,586 - INFO - Loaded 290 total sequences
2025-11-20 18:19:16,586 - INFO - Channel validation (from segmentation): 29/29 files valid
2025-11-20 18:19:16,586 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-20 18:19:16,586 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-20 18:19:16,586 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-20 18:19:16,586 - INFO - train: 250 sequences (125 preictal, 125 interictal)
2025-11-20 18:19:16,586 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-20 18:19:16,602 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-20 18:19:16,602 - INFO - train: kept 125 preictal and 125 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:19:16,603 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-20 18:19:16,618 - INFO - ============================================================
2025-11-20 18:19:16,618 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-20 18:19:16,618 - INFO - ============================================================
2025-11-20 18:19:16,618 - INFO - Processing 250 training samples to compute normalization stats...
2025-11-20 18:19:16,619 - INFO - Processing 250 sequences from 24 unique files
Processing training data:   0%|                    | 0/250 [00:00<?, ?it/s]Processing training data:   0%|            | 1/250 [00:01<06:36,  1.59s/it]Processing training data:   4%|4          | 11/250 [00:02<00:51,  4.61it/s]Processing training data:   6%|7          | 16/250 [00:03<00:43,  5.43it/s]Processing training data:  16%|#7         | 39/250 [00:04<00:17, 11.82it/s]Processing training data:  28%|###1       | 71/250 [00:05<00:09, 18.14it/s]Processing training data:  47%|####6     | 117/250 [00:07<00:05, 22.20it/s]Processing training data:  49%|####9     | 123/250 [00:08<00:08, 15.86it/s]Processing training data:  51%|#####1    | 128/250 [00:10<00:11, 10.82it/s]Processing training data:  54%|#####4    | 135/250 [00:11<00:12,  9.47it/s]Processing training data:  56%|#####6    | 141/250 [00:13<00:13,  7.99it/s]Processing training data:  58%|#####8    | 146/250 [00:14<00:16,  6.32it/s]Processing training data:  62%|######1   | 154/250 [00:15<00:14,  6.56it/s]Processing training data:  64%|######4   | 161/250 [00:17<00:15,  5.88it/s]Processing training data:  67%|######6   | 167/250 [00:18<00:13,  6.15it/s]Processing training data:  68%|######8   | 171/250 [00:19<00:16,  4.94it/s]Processing training data:  71%|#######   | 177/250 [00:21<00:15,  4.64it/s]Processing training data:  73%|#######3  | 183/250 [00:22<00:15,  4.41it/s]Processing training data:  77%|#######7  | 193/250 [00:24<00:11,  5.09it/s]Processing training data:  80%|########  | 200/250 [00:25<00:09,  5.20it/s]Processing training data:  90%|########9 | 224/250 [00:27<00:03,  8.47it/s]Processing training data:  93%|#########2| 232/250 [00:28<00:02,  7.19it/s]Processing training data:  96%|#########5| 239/250 [00:30<00:01,  6.15it/s]Processing training data:  98%|#########8| 245/250 [00:31<00:00,  6.38it/s]Processing training data:  99%|#########9| 248/250 [00:32<00:00,  6.10it/s]Processing training data: 100%|##########| 250/250 [00:32<00:00,  7.81it/s]
2025-11-20 18:19:48,625 - INFO - Computing normalization statistics from training data...
2025-11-20 18:19:49,070 - INFO - Normalization stats computed:
2025-11-20 18:19:49,070 - INFO -   Mean: 0.232300
2025-11-20 18:19:49,070 - INFO -   Std: 2.153029
2025-11-20 18:19:49,070 - INFO -   Saved to: preprocessing\checkpoints\chb20_fold7\normalization_stats.json
2025-11-20 18:19:49,117 - INFO - Applying normalization and saving 250 training sequences...
Normalizing and saving training data:   0%|        | 0/250 [00:00<?, ?it/s]2025-11-20 18:19:49,125 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold7\train_dataset.h5
Normalizing and saving training data:   4%| | 10/250 [00:00<00:15, 15.84it/Normalizing and saving training data:   8%| | 20/250 [00:01<00:14, 15.61it/Normalizing and saving training data:  12%|1| 30/250 [00:01<00:14, 15.47it/Normalizing and saving training data:  16%|1| 40/250 [00:02<00:13, 15.54it/Normalizing and saving training data:  20%|2| 50/250 [00:03<00:12, 15.58it/Normalizing and saving training data:  24%|2| 60/250 [00:03<00:12, 15.61it/Normalizing and saving training data:  28%|2| 70/250 [00:04<00:11, 15.62it/Normalizing and saving training data:  32%|3| 80/250 [00:05<00:10, 15.62it/Normalizing and saving training data:  36%|3| 90/250 [00:05<00:10, 15.60it/Normalizing and saving training data:  40%|4| 100/250 [00:06<00:09, 15.56itNormalizing and saving training data:  44%|4| 110/250 [00:07<00:08, 15.65itNormalizing and saving training data:  48%|4| 120/250 [00:07<00:08, 15.72itNormalizing and saving training data:  52%|5| 130/250 [00:08<00:07, 15.74itNormalizing and saving training data:  56%|5| 140/250 [00:08<00:07, 15.65itNormalizing and saving training data:  60%|6| 150/250 [00:09<00:06, 15.62itNormalizing and saving training data:  64%|6| 160/250 [00:10<00:05, 15.62itNormalizing and saving training data:  68%|6| 170/250 [00:10<00:05, 15.63itNormalizing and saving training data:  72%|7| 180/250 [00:11<00:04, 15.60itNormalizing and saving training data:  76%|7| 190/250 [00:12<00:03, 15.58itNormalizing and saving training data:  80%|8| 200/250 [00:12<00:03, 15.57itNormalizing and saving training data:  84%|8| 210/250 [00:13<00:02, 15.60itNormalizing and saving training data:  88%|8| 220/250 [00:14<00:01, 15.61itNormalizing and saving training data:  92%|9| 230/250 [00:14<00:01, 15.57itNormalizing and saving training data:  96%|9| 240/250 [00:15<00:00, 15.61itNormalizing and saving training data: 100%|#| 250/250 [00:16<00:00, 15.61itNormalizing and saving training data: 100%|#| 250/250 [00:16<00:00, 15.61it
2025-11-20 18:20:05,146 - INFO - Training data processing completed during stats computation phase
2025-11-20 18:20:05,153 - INFO - Loaded normalization statistics:
2025-11-20 18:20:05,153 - INFO -   Mean: 0.232300
2025-11-20 18:20:05,153 - INFO -   Std: 2.153029
2025-11-20 18:20:05,153 - INFO - Split train already completed, skipping
2025-11-20 18:20:05,153 - INFO - Processing test split...
2025-11-20 18:20:05,153 - INFO - Need to process 40/40 sequences for test
2025-11-20 18:20:05,154 - INFO - Processing 40 sequences from 14 unique files
2025-11-20 18:20:05,154 - INFO - Average 2.9 sequences per file
Processing test:   0%|                              | 0/40 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/40 [00:00<00:13,  2.89it/s]Processing test:   5%|#1                    | 2/40 [00:00<00:17,  2.12it/s]2025-11-20 18:20:06,062 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb20_fold7\test_dataset.h5
2025-11-20 18:20:07,346 - INFO - Progress: 271/290 (93.4%) - ETA: 0.1 minutes
Processing test:  55%|###########5         | 22/40 [00:03<00:02,  7.04it/s]Processing test:  62%|#############1       | 25/40 [00:04<00:02,  5.70it/s]Processing test:  70%|##############7      | 28/40 [00:04<00:02,  5.99it/s]Processing test:  72%|###############2     | 29/40 [00:05<00:01,  5.51it/s]Processing test:  75%|###############7     | 30/40 [00:05<00:02,  4.93it/s]Processing test:  78%|################2    | 31/40 [00:06<00:03,  2.65it/s]2025-11-20 18:20:13,051 - INFO - Progress: 283/290 (97.6%) - ETA: 0.0 minutes
Processing test:  85%|#################8   | 34/40 [00:09<00:03,  1.92it/s]Processing test:  90%|##################9  | 36/40 [00:09<00:01,  2.28it/s]Processing test:  92%|###################4 | 37/40 [00:10<00:01,  2.35it/s]Processing test:  95%|###################9 | 38/40 [00:10<00:00,  2.48it/s]Processing test:  98%|####################4| 39/40 [00:10<00:00,  2.51it/s]Processing test: 100%|#####################| 40/40 [00:11<00:00,  2.53it/s]Processing test: 100%|#####################| 40/40 [00:11<00:00,  3.59it/s]
2025-11-20 18:20:16,765 - INFO - Validating final datasets...
2025-11-20 18:20:16,773 - INFO - train dataset validation:
2025-11-20 18:20:16,773 - INFO -   - Segments: 250
2025-11-20 18:20:16,773 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:20:16,773 - INFO -   - Classes: 125 preictal, 125 interictal
2025-11-20 18:20:16,773 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:20:16,778 - INFO - test dataset validation:
2025-11-20 18:20:16,778 - INFO -   - Segments: 40
2025-11-20 18:20:16,778 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-20 18:20:16,778 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-20 18:20:16,778 - INFO -   - Balance: 50.0% preictal
2025-11-20 18:20:16,778 - INFO - ============================================================
2025-11-20 18:20:16,778 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-20 18:20:16,778 - INFO - Total time: 1.0 minutes
2025-11-20 18:20:16,778 - INFO - Processed segments: 290
2025-11-20 18:20:16,778 - INFO - Average rate: 4.8 segments/second
2025-11-20 18:20:16,779 - INFO - ============================================================
✅ Fold 7 preprocessing completed successfully!

============================================================
✅ BATCH PREPROCESSING COMPLETED!
✅ Processed 8 folds for patient chb20
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 8 folds for patient chb20
============================================================

============================================================
TRAINING FOLD 0/7
============================================================
Using dataset prefix: chb20_fold0
Loading datasets from: preprocessing\data\chb20_fold0
Saving models to: model\chb20_fold0
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2185, std=2.1591
Loaded train dataset: 290 samples
  - Spectrogram shape: torch.Size([290, 30, 18, 50, 10])
  - Value range: [-5.6592, 3.8740]
  - Class distribution: tensor([145, 145])
LOOCV Mode (Fold 0): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/19 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/19 [00:04<?, ?it/s, loss=0.6885, grad_norm=1.134, lr=0.000010]Training Epoch 1/5:   5%|#########2                                                                                                                                                                     | 1/19 [00:04<01:16,  4.25s/it, loss=0.6885, grad_norm=1.134, lr=0.000010]Training Epoch 1/5:   5%|#########2                                                                                                                                                                     | 1/19 [00:04<01:16,  4.25s/it, loss=0.6823, grad_norm=1.095, lr=0.000010]Training Epoch 1/5:  11%|##################4                                                                                                                                                            | 2/19 [00:04<00:30,  1.82s/it, loss=0.6823, grad_norm=1.095, lr=0.000010]Training Epoch 1/5:  11%|##################4                                                                                                                                                            | 2/19 [00:04<00:30,  1.82s/it, loss=0.7098, grad_norm=1.238, lr=0.000010]Training Epoch 1/5:  16%|###########################6                                                                                                                                                   | 3/19 [00:04<00:16,  1.04s/it, loss=0.7098, grad_norm=1.238, lr=0.000010]Training Epoch 1/5:  16%|###########################6                                                                                                                                                   | 3/19 [00:04<00:16,  1.04s/it, loss=0.6698, grad_norm=1.061, lr=0.000010]Training Epoch 1/5:  21%|####################################8                                                                                                                                          | 4/19 [00:04<00:10,  1.49it/s, loss=0.6698, grad_norm=1.061, lr=0.000010]Training Epoch 1/5:  21%|####################################8                                                                                                                                          | 4/19 [00:04<00:10,  1.49it/s, loss=0.6892, grad_norm=1.026, lr=0.000010]Training Epoch 1/5:  26%|##############################################                                                                                                                                 | 5/19 [00:04<00:06,  2.13it/s, loss=0.6892, grad_norm=1.026, lr=0.000010]Training Epoch 1/5:  26%|##############################################                                                                                                                                 | 5/19 [00:04<00:06,  2.13it/s, loss=0.6873, grad_norm=1.085, lr=0.000010]Training Epoch 1/5:  32%|#######################################################2                                                                                                                       | 6/19 [00:04<00:04,  2.89it/s, loss=0.6873, grad_norm=1.085, lr=0.000010]Training Epoch 1/5:  32%|#######################################################2                                                                                                                       | 6/19 [00:04<00:04,  2.89it/s, loss=0.6814, grad_norm=1.132, lr=0.000010]Training Epoch 1/5:  37%|################################################################4                                                                                                              | 7/19 [00:04<00:03,  3.72it/s, loss=0.6814, grad_norm=1.132, lr=0.000010]Training Epoch 1/5:  37%|################################################################4                                                                                                              | 7/19 [00:05<00:03,  3.72it/s, loss=0.7084, grad_norm=1.357, lr=0.000010]Training Epoch 1/5:  42%|#########################################################################6                                                                                                     | 8/19 [00:05<00:02,  4.58it/s, loss=0.7084, grad_norm=1.357, lr=0.000010]Training Epoch 1/5:  42%|#########################################################################6                                                                                                     | 8/19 [00:05<00:02,  4.58it/s, loss=0.6624, grad_norm=1.176, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################8                                                                                            | 9/19 [00:05<00:01,  5.42it/s, loss=0.6624, grad_norm=1.176, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################8                                                                                            | 9/19 [00:05<00:01,  5.42it/s, loss=0.7063, grad_norm=1.370, lr=0.000010]Training Epoch 1/5:  53%|###########################################################################################5                                                                                  | 10/19 [00:05<00:01,  6.18it/s, loss=0.7063, grad_norm=1.370, lr=0.000010]Training Epoch 1/5:  53%|###########################################################################################5                                                                                  | 10/19 [00:05<00:01,  6.18it/s, loss=0.6677, grad_norm=1.064, lr=0.000010]Training Epoch 1/5:  58%|####################################################################################################7                                                                         | 11/19 [00:05<00:01,  6.85it/s, loss=0.6677, grad_norm=1.064, lr=0.000010]Training Epoch 1/5:  58%|####################################################################################################7                                                                         | 11/19 [00:05<00:01,  6.85it/s, loss=0.6583, grad_norm=1.155, lr=0.000010]Training Epoch 1/5:  63%|#############################################################################################################8                                                                | 12/19 [00:05<00:00,  7.41it/s, loss=0.6583, grad_norm=1.155, lr=0.000010]Training Epoch 1/5:  63%|#############################################################################################################8                                                                | 12/19 [00:05<00:00,  7.41it/s, loss=0.6664, grad_norm=1.083, lr=0.000010]Training Epoch 1/5:  68%|#######################################################################################################################                                                       | 13/19 [00:05<00:00,  7.86it/s, loss=0.6664, grad_norm=1.083, lr=0.000010]Training Epoch 1/5:  68%|#######################################################################################################################                                                       | 13/19 [00:05<00:00,  7.86it/s, loss=0.6509, grad_norm=1.189, lr=0.000010]Training Epoch 1/5:  74%|################################################################################################################################2                                             | 14/19 [00:05<00:00,  8.19it/s, loss=0.6509, grad_norm=1.189, lr=0.000010]Training Epoch 1/5:  74%|################################################################################################################################2                                             | 14/19 [00:05<00:00,  8.19it/s, loss=0.6707, grad_norm=1.200, lr=0.000010]Training Epoch 1/5:  79%|#########################################################################################################################################3                                    | 15/19 [00:05<00:00,  8.45it/s, loss=0.6707, grad_norm=1.200, lr=0.000010]Training Epoch 1/5:  79%|#########################################################################################################################################3                                    | 15/19 [00:05<00:00,  8.45it/s, loss=0.6442, grad_norm=1.224, lr=0.000010]Training Epoch 1/5:  84%|##################################################################################################################################################5                           | 16/19 [00:05<00:00,  8.70it/s, loss=0.6442, grad_norm=1.224, lr=0.000010]Training Epoch 1/5:  84%|##################################################################################################################################################5                           | 16/19 [00:06<00:00,  8.70it/s, loss=0.6526, grad_norm=1.200, lr=0.000010]Training Epoch 1/5:  89%|###########################################################################################################################################################6                  | 17/19 [00:06<00:00,  8.86it/s, loss=0.6526, grad_norm=1.200, lr=0.000010]Training Epoch 1/5:  89%|###########################################################################################################################################################6                  | 17/19 [00:06<00:00,  8.86it/s, loss=0.6486, grad_norm=1.254, lr=0.000010]Training Epoch 1/5:  95%|####################################################################################################################################################################8         | 18/19 [00:06<00:00,  8.94it/s, loss=0.6486, grad_norm=1.254, lr=0.000010]Training Epoch 1/5:  95%|####################################################################################################################################################################8         | 18/19 [00:06<00:00,  8.94it/s, loss=0.7163, grad_norm=3.905, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 19/19 [00:06<00:00,  2.81it/s, loss=0.7163, grad_norm=3.905, lr=0.000010]

Epoch 1/5 Complete (7.2s) [LR: 0.000010]
Train - Loss: 0.6769, Acc: 0.5828, Precision: 0.8750, Recall: 0.1931, F1: 0.3164, AUC: 0.7753
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/19 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/19 [00:04<?, ?it/s, loss=0.6247, grad_norm=1.221, lr=0.000010]Training Epoch 2/5:   5%|#########2                                                                                                                                                                     | 1/19 [00:04<01:13,  4.11s/it, loss=0.6247, grad_norm=1.221, lr=0.000010]Training Epoch 2/5:   5%|#########2                                                                                                                                                                     | 1/19 [00:04<01:13,  4.11s/it, loss=0.6475, grad_norm=1.184, lr=0.000010]Training Epoch 2/5:  11%|##################4                                                                                                                                                            | 2/19 [00:04<00:29,  1.76s/it, loss=0.6475, grad_norm=1.184, lr=0.000010]Training Epoch 2/5:  11%|##################4                                                                                                                                                            | 2/19 [00:04<00:29,  1.76s/it, loss=0.6309, grad_norm=1.085, lr=0.000010]Training Epoch 2/5:  16%|###########################6                                                                                                                                                   | 3/19 [00:04<00:16,  1.01s/it, loss=0.6309, grad_norm=1.085, lr=0.000010]Training Epoch 2/5:  16%|###########################6                                                                                                                                                   | 3/19 [00:04<00:16,  1.01s/it, loss=0.6172, grad_norm=1.158, lr=0.000010]Training Epoch 2/5:  21%|####################################8                                                                                                                                          | 4/19 [00:04<00:09,  1.52it/s, loss=0.6172, grad_norm=1.158, lr=0.000010]Training Epoch 2/5:  21%|####################################8                                                                                                                                          | 4/19 [00:04<00:09,  1.52it/s, loss=0.6306, grad_norm=1.347, lr=0.000010]Training Epoch 2/5:  26%|##############################################                                                                                                                                 | 5/19 [00:04<00:06,  2.14it/s, loss=0.6306, grad_norm=1.347, lr=0.000010]Training Epoch 2/5:  26%|##############################################                                                                                                                                 | 5/19 [00:04<00:06,  2.14it/s, loss=0.6157, grad_norm=1.387, lr=0.000010]Training Epoch 2/5:  32%|#######################################################2                                                                                                                       | 6/19 [00:04<00:04,  2.89it/s, loss=0.6157, grad_norm=1.387, lr=0.000010]Training Epoch 2/5:  32%|#######################################################2                                                                                                                       | 6/19 [00:04<00:04,  2.89it/s, loss=0.6160, grad_norm=1.228, lr=0.000010]Training Epoch 2/5:  37%|################################################################4                                                                                                              | 7/19 [00:04<00:03,  3.71it/s, loss=0.6160, grad_norm=1.228, lr=0.000010]Training Epoch 2/5:  37%|################################################################4                                                                                                              | 7/19 [00:04<00:03,  3.71it/s, loss=0.5984, grad_norm=1.094, lr=0.000010]Training Epoch 2/5:  42%|#########################################################################6                                                                                                     | 8/19 [00:04<00:02,  4.52it/s, loss=0.5984, grad_norm=1.094, lr=0.000010]Training Epoch 2/5:  42%|#########################################################################6                                                                                                     | 8/19 [00:05<00:02,  4.52it/s, loss=0.6081, grad_norm=1.209, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################8                                                                                            | 9/19 [00:05<00:01,  5.22it/s, loss=0.6081, grad_norm=1.209, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################8                                                                                            | 9/19 [00:05<00:01,  5.22it/s, loss=0.5931, grad_norm=1.084, lr=0.000010]Training Epoch 2/5:  53%|###########################################################################################5                                                                                  | 10/19 [00:05<00:01,  5.81it/s, loss=0.5931, grad_norm=1.084, lr=0.000010]Training Epoch 2/5:  53%|###########################################################################################5                                                                                  | 10/19 [00:05<00:01,  5.81it/s, loss=0.5904, grad_norm=1.169, lr=0.000010]Training Epoch 2/5:  58%|####################################################################################################7                                                                         | 11/19 [00:05<00:01,  6.30it/s, loss=0.5904, grad_norm=1.169, lr=0.000010]Training Epoch 2/5:  58%|####################################################################################################7                                                                         | 11/19 [00:05<00:01,  6.30it/s, loss=0.5722, grad_norm=1.084, lr=0.000010]Training Epoch 2/5:  63%|#############################################################################################################8                                                                | 12/19 [00:05<00:01,  6.71it/s, loss=0.5722, grad_norm=1.084, lr=0.000010]Training Epoch 2/5:  63%|#############################################################################################################8                                                                | 12/19 [00:05<00:01,  6.71it/s, loss=0.5838, grad_norm=1.185, lr=0.000010]Training Epoch 2/5:  68%|#######################################################################################################################                                                       | 13/19 [00:05<00:00,  6.85it/s, loss=0.5838, grad_norm=1.185, lr=0.000010]Training Epoch 2/5:  68%|#######################################################################################################################                                                       | 13/19 [00:05<00:00,  6.85it/s, loss=0.5687, grad_norm=1.046, lr=0.000010]Training Epoch 2/5:  74%|################################################################################################################################2                                             | 14/19 [00:05<00:00,  7.09it/s, loss=0.5687, grad_norm=1.046, lr=0.000010]Training Epoch 2/5:  74%|################################################################################################################################2                                             | 14/19 [00:05<00:00,  7.09it/s, loss=0.5375, grad_norm=1.159, lr=0.000010]Training Epoch 2/5:  79%|#########################################################################################################################################3                                    | 15/19 [00:05<00:00,  7.11it/s, loss=0.5375, grad_norm=1.159, lr=0.000010]Training Epoch 2/5:  79%|#########################################################################################################################################3                                    | 15/19 [00:05<00:00,  7.11it/s, loss=0.5097, grad_norm=1.124, lr=0.000010]Training Epoch 2/5:  84%|##################################################################################################################################################5                           | 16/19 [00:05<00:00,  7.28it/s, loss=0.5097, grad_norm=1.124, lr=0.000010]Training Epoch 2/5:  84%|##################################################################################################################################################5                           | 16/19 [00:06<00:00,  7.28it/s, loss=0.4952, grad_norm=1.141, lr=0.000010]Training Epoch 2/5:  89%|###########################################################################################################################################################6                  | 17/19 [00:06<00:00,  7.41it/s, loss=0.4952, grad_norm=1.141, lr=0.000010]Training Epoch 2/5:  89%|###########################################################################################################################################################6                  | 17/19 [00:06<00:00,  7.41it/s, loss=0.4943, grad_norm=1.115, lr=0.000010]Training Epoch 2/5:  95%|####################################################################################################################################################################8         | 18/19 [00:06<00:00,  7.52it/s, loss=0.4943, grad_norm=1.115, lr=0.000010]Training Epoch 2/5:  95%|####################################################################################################################################################################8         | 18/19 [00:06<00:00,  7.52it/s, loss=0.5956, grad_norm=2.521, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 19/19 [00:06<00:00,  2.73it/s, loss=0.5956, grad_norm=2.521, lr=0.000010]

Epoch 2/5 Complete (7.4s) [LR: 0.000010]
Train - Loss: 0.5858, Acc: 0.9138, Precision: 0.8846, Recall: 0.9517, F1: 0.9169, AUC: 0.9341
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.5183, grad_norm=1.Training Epoch 3/5:   5%| | 1/19 [00:04<01:14,  4.15s/it, loss=0.5183, gradTraining Epoch 3/5:   5%| | 1/19 [00:04<01:14,  4.15s/it, loss=0.4994, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:30,  1.78s/it, loss=0.4994, gradTraining Epoch 3/5:  11%|1| 2/19 [00:04<00:30,  1.78s/it, loss=0.5113, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.5113, gradTraining Epoch 3/5:  16%|1| 3/19 [00:04<00:16,  1.01s/it, loss=0.5379, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:10,  1.48it/s, loss=0.5379, gradTraining Epoch 3/5:  21%|2| 4/19 [00:04<00:10,  1.48it/s, loss=0.5464, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.12it/s, loss=0.5464, gradTraining Epoch 3/5:  26%|2| 5/19 [00:04<00:06,  2.12it/s, loss=0.5141, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.86it/s, loss=0.5141, gradTraining Epoch 3/5:  32%|3| 6/19 [00:04<00:04,  2.86it/s, loss=0.4629, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.69it/s, loss=0.4629, gradTraining Epoch 3/5:  37%|3| 7/19 [00:04<00:03,  3.69it/s, loss=0.4110, gradTraining Epoch 3/5:  42%|4| 8/19 [00:04<00:02,  4.56it/s, loss=0.4110, gradTraining Epoch 3/5:  42%|4| 8/19 [00:05<00:02,  4.56it/s, loss=0.4479, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.40it/s, loss=0.4479, gradTraining Epoch 3/5:  47%|4| 9/19 [00:05<00:01,  5.40it/s, loss=0.4353, gradTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.15it/s, loss=0.4353, graTraining Epoch 3/5:  53%|5| 10/19 [00:05<00:01,  6.15it/s, loss=0.4347, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.85it/s, loss=0.4347, graTraining Epoch 3/5:  58%|5| 11/19 [00:05<00:01,  6.85it/s, loss=0.4288, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.42it/s, loss=0.4288, graTraining Epoch 3/5:  63%|6| 12/19 [00:05<00:00,  7.42it/s, loss=0.3685, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.84it/s, loss=0.3685, graTraining Epoch 3/5:  68%|6| 13/19 [00:05<00:00,  7.84it/s, loss=0.4309, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.17it/s, loss=0.4309, graTraining Epoch 3/5:  74%|7| 14/19 [00:05<00:00,  8.17it/s, loss=0.3742, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.50it/s, loss=0.3742, graTraining Epoch 3/5:  79%|7| 15/19 [00:05<00:00,  8.50it/s, loss=0.3291, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.72it/s, loss=0.3291, graTraining Epoch 3/5:  84%|8| 16/19 [00:05<00:00,  8.72it/s, loss=0.3808, graTraining Epoch 3/5:  89%|8| 17/19 [00:05<00:00,  8.87it/s, loss=0.3808, graTraining Epoch 3/5:  89%|8| 17/19 [00:06<00:00,  8.87it/s, loss=0.4372, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  8.95it/s, loss=0.4372, graTraining Epoch 3/5:  95%|9| 18/19 [00:06<00:00,  8.95it/s, loss=1.0001, graTraining Epoch 3/5: 100%|#| 19/19 [00:06<00:00,  2.84it/s, loss=1.0001, gra

Epoch 3/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.4773, Acc: 0.9241, Precision: 0.8773, Recall: 0.9862, F1: 0.9286, AUC: 0.9390
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.3042, grad_norm=0.Training Epoch 4/5:   5%| | 1/19 [00:04<01:23,  4.63s/it, loss=0.3042, gradTraining Epoch 4/5:   5%| | 1/19 [00:04<01:23,  4.63s/it, loss=0.4423, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:33,  1.97s/it, loss=0.4423, gradTraining Epoch 4/5:  11%|1| 2/19 [00:04<00:33,  1.97s/it, loss=0.2910, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:17,  1.12s/it, loss=0.2910, gradTraining Epoch 4/5:  16%|1| 3/19 [00:04<00:17,  1.12s/it, loss=0.5363, gradTraining Epoch 4/5:  21%|2| 4/19 [00:04<00:10,  1.39it/s, loss=0.5363, gradTraining Epoch 4/5:  21%|2| 4/19 [00:05<00:10,  1.39it/s, loss=0.2386, gradTraining Epoch 4/5:  26%|2| 5/19 [00:05<00:06,  2.00it/s, loss=0.2386, gradTraining Epoch 4/5:  26%|2| 5/19 [00:05<00:06,  2.00it/s, loss=0.4751, gradTraining Epoch 4/5:  32%|3| 6/19 [00:05<00:04,  2.72it/s, loss=0.4751, gradTraining Epoch 4/5:  32%|3| 6/19 [00:05<00:04,  2.72it/s, loss=0.3002, gradTraining Epoch 4/5:  37%|3| 7/19 [00:05<00:03,  3.53it/s, loss=0.3002, gradTraining Epoch 4/5:  37%|3| 7/19 [00:05<00:03,  3.53it/s, loss=0.3113, gradTraining Epoch 4/5:  42%|4| 8/19 [00:05<00:02,  4.24it/s, loss=0.3113, gradTraining Epoch 4/5:  42%|4| 8/19 [00:05<00:02,  4.24it/s, loss=0.4041, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:02,  4.94it/s, loss=0.4041, gradTraining Epoch 4/5:  47%|4| 9/19 [00:05<00:02,  4.94it/s, loss=0.4077, gradTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  5.62it/s, loss=0.4077, graTraining Epoch 4/5:  53%|5| 10/19 [00:05<00:01,  5.62it/s, loss=0.2833, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.30it/s, loss=0.2833, graTraining Epoch 4/5:  58%|5| 11/19 [00:05<00:01,  6.30it/s, loss=0.2068, graTraining Epoch 4/5:  63%|6| 12/19 [00:05<00:01,  6.86it/s, loss=0.2068, graTraining Epoch 4/5:  63%|6| 12/19 [00:06<00:01,  6.86it/s, loss=0.3054, graTraining Epoch 4/5:  68%|6| 13/19 [00:06<00:00,  7.39it/s, loss=0.3054, graTraining Epoch 4/5:  68%|6| 13/19 [00:06<00:00,  7.39it/s, loss=0.2660, graTraining Epoch 4/5:  74%|7| 14/19 [00:06<00:00,  7.81it/s, loss=0.2660, graTraining Epoch 4/5:  74%|7| 14/19 [00:06<00:00,  7.81it/s, loss=0.3058, graTraining Epoch 4/5:  79%|7| 15/19 [00:06<00:00,  8.20it/s, loss=0.3058, graTraining Epoch 4/5:  79%|7| 15/19 [00:06<00:00,  8.20it/s, loss=0.2565, graTraining Epoch 4/5:  84%|8| 16/19 [00:06<00:00,  8.51it/s, loss=0.2565, graTraining Epoch 4/5:  84%|8| 16/19 [00:06<00:00,  8.51it/s, loss=0.2128, graTraining Epoch 4/5:  89%|8| 17/19 [00:06<00:00,  8.73it/s, loss=0.2128, graTraining Epoch 4/5:  89%|8| 17/19 [00:06<00:00,  8.73it/s, loss=0.1994, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.91it/s, loss=0.1994, graTraining Epoch 4/5:  95%|9| 18/19 [00:06<00:00,  8.91it/s, loss=0.9544, graTraining Epoch 4/5: 100%|#| 19/19 [00:07<00:00,  2.64it/s, loss=0.9544, gra

Epoch 4/5 Complete (7.6s) [LR: 0.000010]
Train - Loss: 0.3527, Acc: 0.9276, Precision: 0.8827, Recall: 0.9862, F1: 0.9316, AUC: 0.9423
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/19 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/19 [00:04<?, ?it/s, loss=0.1840, grad_norm=0.Training Epoch 5/5:   5%| | 1/19 [00:04<01:16,  4.27s/it, loss=0.1840, gradTraining Epoch 5/5:   5%| | 1/19 [00:04<01:16,  4.27s/it, loss=0.2751, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:31,  1.84s/it, loss=0.2751, gradTraining Epoch 5/5:  11%|1| 2/19 [00:04<00:31,  1.84s/it, loss=0.4048, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:17,  1.07s/it, loss=0.4048, gradTraining Epoch 5/5:  16%|1| 3/19 [00:04<00:17,  1.07s/it, loss=0.1896, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:10,  1.43it/s, loss=0.1896, gradTraining Epoch 5/5:  21%|2| 4/19 [00:04<00:10,  1.43it/s, loss=0.3010, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.04it/s, loss=0.3010, gradTraining Epoch 5/5:  26%|2| 5/19 [00:04<00:06,  2.04it/s, loss=0.2701, gradTraining Epoch 5/5:  32%|3| 6/19 [00:04<00:04,  2.77it/s, loss=0.2701, gradTraining Epoch 5/5:  32%|3| 6/19 [00:05<00:04,  2.77it/s, loss=0.2622, gradTraining Epoch 5/5:  37%|3| 7/19 [00:05<00:03,  3.59it/s, loss=0.2622, gradTraining Epoch 5/5:  37%|3| 7/19 [00:05<00:03,  3.59it/s, loss=0.1781, gradTraining Epoch 5/5:  42%|4| 8/19 [00:05<00:02,  4.46it/s, loss=0.1781, gradTraining Epoch 5/5:  42%|4| 8/19 [00:05<00:02,  4.46it/s, loss=0.1502, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.33it/s, loss=0.1502, gradTraining Epoch 5/5:  47%|4| 9/19 [00:05<00:01,  5.33it/s, loss=0.2625, gradTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.13it/s, loss=0.2625, graTraining Epoch 5/5:  53%|5| 10/19 [00:05<00:01,  6.13it/s, loss=0.1531, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.78it/s, loss=0.1531, graTraining Epoch 5/5:  58%|5| 11/19 [00:05<00:01,  6.78it/s, loss=0.2998, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.37it/s, loss=0.2998, graTraining Epoch 5/5:  63%|6| 12/19 [00:05<00:00,  7.37it/s, loss=0.2937, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.80it/s, loss=0.2937, graTraining Epoch 5/5:  68%|6| 13/19 [00:05<00:00,  7.80it/s, loss=0.1552, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.51it/s, loss=0.1552, graTraining Epoch 5/5:  74%|7| 14/19 [00:05<00:00,  7.51it/s, loss=0.1854, graTraining Epoch 5/5:  79%|7| 15/19 [00:05<00:00,  7.36it/s, loss=0.1854, graTraining Epoch 5/5:  79%|7| 15/19 [00:06<00:00,  7.36it/s, loss=0.1094, graTraining Epoch 5/5:  84%|8| 16/19 [00:06<00:00,  7.24it/s, loss=0.1094, graTraining Epoch 5/5:  84%|8| 16/19 [00:06<00:00,  7.24it/s, loss=0.0920, graTraining Epoch 5/5:  89%|8| 17/19 [00:06<00:00,  7.74it/s, loss=0.0920, graTraining Epoch 5/5:  89%|8| 17/19 [00:06<00:00,  7.74it/s, loss=0.1571, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  8.14it/s, loss=0.1571, graTraining Epoch 5/5:  95%|9| 18/19 [00:06<00:00,  8.14it/s, loss=0.8645, graTraining Epoch 5/5: 100%|#| 19/19 [00:06<00:00,  2.74it/s, loss=0.8645, gra

Epoch 5/5 Complete (7.3s) [LR: 0.000005]
Train - Loss: 0.2520, Acc: 0.9310, Precision: 0.8834, Recall: 0.9931, F1: 0.9351, AUC: 0.9832
------------------------------------------------------------
Training curves saved to model\chb20_fold0\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb20_fold0
============================================================
✅ Fold 0 training completed successfully!

============================================================
TRAINING FOLD 1/7
============================================================
Using dataset prefix: chb20_fold1
Loading datasets from: preprocessing\data\chb20_fold1
Saving models to: model\chb20_fold1
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2104, std=2.1654
Loaded train dataset: 246 samples
  - Spectrogram shape: torch.Size([246, 30, 18, 50, 10])
  - Value range: [-5.6390, 3.8616]
  - Class distribution: tensor([123, 123])
LOOCV Mode (Fold 1): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6948, grad_norm=1.Training Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.01s/it, loss=0.6948, gradTraining Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.01s/it, loss=0.6835, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.6835, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.6881, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6881, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.7021, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.7021, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.6936, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6936, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6956, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.99it/s, loss=0.6956, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.99it/s, loss=0.6895, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.83it/s, loss=0.6895, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.83it/s, loss=0.7033, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.56it/s, loss=0.7033, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.56it/s, loss=0.6687, gradTraining Epoch 1/5:  56%|5| 9/16 [00:04<00:01,  5.29it/s, loss=0.6687, gradTraining Epoch 1/5:  56%|5| 9/16 [00:05<00:01,  5.29it/s, loss=0.6665, gradTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.09it/s, loss=0.6665, graTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.09it/s, loss=0.7002, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.73it/s, loss=0.7002, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.73it/s, loss=0.6726, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.08it/s, loss=0.6726, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.08it/s, loss=0.6905, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.24it/s, loss=0.6905, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.24it/s, loss=0.6734, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  7.53it/s, loss=0.6734, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  7.53it/s, loss=0.6694, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  7.90it/s, loss=0.6694, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  7.90it/s, loss=0.6596, graTraining Epoch 1/5: 100%|#| 16/16 [00:06<00:00,  2.54it/s, loss=0.6596, gra

Epoch 1/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6845, Acc: 0.5813, Precision: 0.5633, Recall: 0.7236, F1: 0.6335, AUC: 0.6320
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.6475, grad_norm=1.Training Epoch 2/5:   6%| | 1/16 [00:03<00:59,  3.98s/it, loss=0.6475, gradTraining Epoch 2/5:   6%| | 1/16 [00:04<00:59,  3.98s/it, loss=0.6591, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:23,  1.70s/it, loss=0.6591, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:23,  1.70s/it, loss=0.6883, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6883, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.6548, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.58it/s, loss=0.6548, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.58it/s, loss=0.6587, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:04,  2.25it/s, loss=0.6587, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:04,  2.25it/s, loss=0.6551, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  3.03it/s, loss=0.6551, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  3.03it/s, loss=0.6607, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.6607, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.6423, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.61it/s, loss=0.6423, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.61it/s, loss=0.6357, gradTraining Epoch 2/5:  56%|5| 9/16 [00:04<00:01,  5.46it/s, loss=0.6357, gradTraining Epoch 2/5:  56%|5| 9/16 [00:04<00:01,  5.46it/s, loss=0.6270, gradTraining Epoch 2/5:  62%|6| 10/16 [00:04<00:00,  6.25it/s, loss=0.6270, graTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.25it/s, loss=0.6316, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.90it/s, loss=0.6316, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.90it/s, loss=0.6011, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.43it/s, loss=0.6011, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.43it/s, loss=0.6080, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.86it/s, loss=0.6080, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.86it/s, loss=0.6280, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.26it/s, loss=0.6280, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.26it/s, loss=0.6294, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.60it/s, loss=0.6294, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.60it/s, loss=0.5987, graTraining Epoch 2/5: 100%|#| 16/16 [00:06<00:00,  2.58it/s, loss=0.5987, gra

Epoch 2/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6391, Acc: 0.8293, Precision: 0.7613, Recall: 0.9593, F1: 0.8489, AUC: 0.9296
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6030, grad_norm=1.Training Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.05s/it, loss=0.6030, gradTraining Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.05s/it, loss=0.5434, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.74s/it, loss=0.5434, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.74s/it, loss=0.5859, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.5859, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.5752, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.5752, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.5890, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.5890, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.5282, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.96it/s, loss=0.5282, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.96it/s, loss=0.5881, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.82it/s, loss=0.5881, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.82it/s, loss=0.4919, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.70it/s, loss=0.4919, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.70it/s, loss=0.4820, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.58it/s, loss=0.4820, gradTraining Epoch 3/5:  56%|5| 9/16 [00:05<00:01,  5.58it/s, loss=0.5466, gradTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.40it/s, loss=0.5466, graTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.40it/s, loss=0.5351, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  7.12it/s, loss=0.5351, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  7.12it/s, loss=0.4948, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.64it/s, loss=0.4948, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.64it/s, loss=0.4547, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  8.06it/s, loss=0.4547, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  8.06it/s, loss=0.4736, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.36it/s, loss=0.4736, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.36it/s, loss=0.4470, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.69it/s, loss=0.4470, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.69it/s, loss=0.4763, graTraining Epoch 3/5: 100%|#| 16/16 [00:06<00:00,  2.58it/s, loss=0.4763, gra

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5259, Acc: 0.9024, Precision: 0.8367, Recall: 1.0000, F1: 0.9111, AUC: 0.9458
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.3667, grad_norm=1.Training Epoch 4/5:   6%| | 1/16 [00:04<01:03,  4.24s/it, loss=0.3667, gradTraining Epoch 4/5:   6%| | 1/16 [00:04<01:03,  4.24s/it, loss=0.4912, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:25,  1.82s/it, loss=0.4912, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:25,  1.82s/it, loss=0.6767, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:13,  1.04s/it, loss=0.6767, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:13,  1.04s/it, loss=0.4527, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:08,  1.49it/s, loss=0.4527, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:08,  1.49it/s, loss=0.3323, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:05,  2.13it/s, loss=0.3323, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:05,  2.13it/s, loss=0.4249, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.88it/s, loss=0.4249, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.88it/s, loss=0.2999, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.70it/s, loss=0.2999, gradTraining Epoch 4/5:  44%|4| 7/16 [00:05<00:02,  3.70it/s, loss=0.4024, gradTraining Epoch 4/5:  50%|5| 8/16 [00:05<00:01,  4.57it/s, loss=0.4024, gradTraining Epoch 4/5:  50%|5| 8/16 [00:05<00:01,  4.57it/s, loss=0.3906, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.38it/s, loss=0.3906, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.38it/s, loss=0.2686, gradTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.15it/s, loss=0.2686, graTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.15it/s, loss=0.3326, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.78it/s, loss=0.3326, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.78it/s, loss=0.4000, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.00it/s, loss=0.4000, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.00it/s, loss=0.3985, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.37it/s, loss=0.3985, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.37it/s, loss=0.3224, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  7.80it/s, loss=0.3224, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  7.80it/s, loss=0.3135, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.14it/s, loss=0.3135, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.14it/s, loss=0.3025, graTraining Epoch 4/5: 100%|#| 16/16 [00:06<00:00,  2.41it/s, loss=0.3025, gra

Epoch 4/5 Complete (7.1s) [LR: 0.000010]
Train - Loss: 0.3860, Acc: 0.9146, Precision: 0.8864, Recall: 0.9512, F1: 0.9176, AUC: 0.9656
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.2476, grad_norm=1.Training Epoch 5/5:   6%| | 1/16 [00:04<01:08,  4.58s/it, loss=0.2476, gradTraining Epoch 5/5:   6%| | 1/16 [00:04<01:08,  4.58s/it, loss=0.3432, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:27,  1.95s/it, loss=0.3432, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:27,  1.95s/it, loss=0.2448, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:14,  1.11s/it, loss=0.2448, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:14,  1.11s/it, loss=0.2910, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:08,  1.40it/s, loss=0.2910, gradTraining Epoch 5/5:  25%|2| 4/16 [00:05<00:08,  1.40it/s, loss=0.2653, gradTraining Epoch 5/5:  31%|3| 5/16 [00:05<00:05,  2.00it/s, loss=0.2653, gradTraining Epoch 5/5:  31%|3| 5/16 [00:05<00:05,  2.00it/s, loss=0.1983, gradTraining Epoch 5/5:  38%|3| 6/16 [00:05<00:03,  2.72it/s, loss=0.1983, gradTraining Epoch 5/5:  38%|3| 6/16 [00:05<00:03,  2.72it/s, loss=0.2433, gradTraining Epoch 5/5:  44%|4| 7/16 [00:05<00:02,  3.53it/s, loss=0.2433, gradTraining Epoch 5/5:  44%|4| 7/16 [00:05<00:02,  3.53it/s, loss=0.2457, gradTraining Epoch 5/5:  50%|5| 8/16 [00:05<00:01,  4.39it/s, loss=0.2457, gradTraining Epoch 5/5:  50%|5| 8/16 [00:05<00:01,  4.39it/s, loss=0.2468, gradTraining Epoch 5/5:  56%|5| 9/16 [00:05<00:01,  5.20it/s, loss=0.2468, gradTraining Epoch 5/5:  56%|5| 9/16 [00:05<00:01,  5.20it/s, loss=0.1919, gradTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.01it/s, loss=0.1919, graTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.01it/s, loss=0.2065, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.70it/s, loss=0.2065, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.70it/s, loss=0.1663, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.28it/s, loss=0.1663, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.28it/s, loss=0.1898, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.79it/s, loss=0.1898, graTraining Epoch 5/5:  81%|8| 13/16 [00:06<00:00,  7.79it/s, loss=0.1532, graTraining Epoch 5/5:  88%|8| 14/16 [00:06<00:00,  8.11it/s, loss=0.1532, graTraining Epoch 5/5:  88%|8| 14/16 [00:06<00:00,  8.11it/s, loss=0.1216, graTraining Epoch 5/5:  94%|9| 15/16 [00:06<00:00,  8.36it/s, loss=0.1216, graTraining Epoch 5/5:  94%|9| 15/16 [00:06<00:00,  8.36it/s, loss=0.0993, graTraining Epoch 5/5: 100%|#| 16/16 [00:06<00:00,  2.37it/s, loss=0.0993, gra

Epoch 5/5 Complete (7.2s) [LR: 0.000005]
Train - Loss: 0.2159, Acc: 0.9675, Precision: 0.9389, Recall: 1.0000, F1: 0.9685, AUC: 0.9953
------------------------------------------------------------
Training curves saved to model\chb20_fold1\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb20_fold1
============================================================
✅ Fold 1 training completed successfully!

============================================================
TRAINING FOLD 2/7
============================================================
Using dataset prefix: chb20_fold2
Loading datasets from: preprocessing\data\chb20_fold2
Saving models to: model\chb20_fold2
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2267, std=2.1563
Loaded train dataset: 242 samples
  - Spectrogram shape: torch.Size([242, 30, 18, 50, 10])
  - Value range: [-5.6704, 3.8469]
  - Class distribution: tensor([121, 121])
LOOCV Mode (Fold 2): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6886, grad_norm=1.Training Epoch 1/5:   6%| | 1/16 [00:04<01:01,  4.09s/it, loss=0.6886, gradTraining Epoch 1/5:   6%| | 1/16 [00:04<01:01,  4.09s/it, loss=0.6893, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.75s/it, loss=0.6893, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.75s/it, loss=0.6946, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.00it/s, loss=0.6946, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.00it/s, loss=0.6926, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.54it/s, loss=0.6926, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.54it/s, loss=0.6755, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.21it/s, loss=0.6755, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.21it/s, loss=0.6830, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.96it/s, loss=0.6830, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.96it/s, loss=0.6849, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.81it/s, loss=0.6849, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.81it/s, loss=0.6858, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.67it/s, loss=0.6858, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.67it/s, loss=0.6834, gradTraining Epoch 1/5:  56%|5| 9/16 [00:04<00:01,  5.52it/s, loss=0.6834, gradTraining Epoch 1/5:  56%|5| 9/16 [00:05<00:01,  5.52it/s, loss=0.6648, gradTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.32it/s, loss=0.6648, graTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.32it/s, loss=0.6530, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  7.00it/s, loss=0.6530, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  7.00it/s, loss=0.6639, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.51it/s, loss=0.6639, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.51it/s, loss=0.6607, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.95it/s, loss=0.6607, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.95it/s, loss=0.7125, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.28it/s, loss=0.7125, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.28it/s, loss=0.6789, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.25it/s, loss=0.6789, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.25it/s, loss=0.6336, graTraining Epoch 1/5: 100%|#| 16/16 [00:06<00:00,  2.56it/s, loss=0.6336, gra

Epoch 1/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6778, Acc: 0.6860, Precision: 0.6510, Recall: 0.8017, F1: 0.7185, AUC: 0.7201
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6544, grad_norm=1.Training Epoch 2/5:   6%| | 1/16 [00:04<01:02,  4.17s/it, loss=0.6544, gradTraining Epoch 2/5:   6%| | 1/16 [00:04<01:02,  4.17s/it, loss=0.6511, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.79s/it, loss=0.6511, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.79s/it, loss=0.6505, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.6505, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.6353, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.51it/s, loss=0.6353, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.51it/s, loss=0.6554, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.15it/s, loss=0.6554, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.15it/s, loss=0.6275, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.91it/s, loss=0.6275, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.91it/s, loss=0.6181, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.74it/s, loss=0.6181, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.74it/s, loss=0.6048, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.56it/s, loss=0.6048, gradTraining Epoch 2/5:  50%|5| 8/16 [00:05<00:01,  4.56it/s, loss=0.6242, gradTraining Epoch 2/5:  56%|5| 9/16 [00:05<00:01,  5.43it/s, loss=0.6242, gradTraining Epoch 2/5:  56%|5| 9/16 [00:05<00:01,  5.43it/s, loss=0.5874, gradTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.20it/s, loss=0.5874, graTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.20it/s, loss=0.5892, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.93it/s, loss=0.5892, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.93it/s, loss=0.5823, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.56it/s, loss=0.5823, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.56it/s, loss=0.5881, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  8.02it/s, loss=0.5881, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  8.02it/s, loss=0.5639, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.35it/s, loss=0.5639, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.35it/s, loss=0.5500, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.51it/s, loss=0.5500, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.51it/s, loss=0.7136, graTraining Epoch 2/5: 100%|#| 16/16 [00:06<00:00,  2.52it/s, loss=0.7136, gra

Epoch 2/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6185, Acc: 0.8967, Precision: 0.8429, Recall: 0.9752, F1: 0.9042, AUC: 0.9633
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.5696, grad_norm=1.Training Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.06s/it, loss=0.5696, gradTraining Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.06s/it, loss=0.5246, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.74s/it, loss=0.5246, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.74s/it, loss=0.5478, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.00it/s, loss=0.5478, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.00it/s, loss=0.5520, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.5520, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.5087, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.21it/s, loss=0.5087, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.21it/s, loss=0.5515, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.98it/s, loss=0.5515, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.98it/s, loss=0.4728, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.82it/s, loss=0.4728, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.82it/s, loss=0.4700, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.68it/s, loss=0.4700, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.68it/s, loss=0.4740, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.54it/s, loss=0.4740, gradTraining Epoch 3/5:  56%|5| 9/16 [00:05<00:01,  5.54it/s, loss=0.4438, gradTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.32it/s, loss=0.4438, graTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.32it/s, loss=0.4543, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.97it/s, loss=0.4543, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.97it/s, loss=0.4249, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.54it/s, loss=0.4249, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.54it/s, loss=0.5138, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.96it/s, loss=0.5138, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.96it/s, loss=0.4669, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.30it/s, loss=0.4669, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.30it/s, loss=0.3586, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.55it/s, loss=0.3586, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.55it/s, loss=0.7417, graTraining Epoch 3/5: 100%|#| 16/16 [00:06<00:00,  2.58it/s, loss=0.7417, gra

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5047, Acc: 0.9215, Precision: 0.8696, Recall: 0.9917, F1: 0.9266, AUC: 0.9640
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.4062, grad_norm=1.Training Epoch 4/5:   6%| | 1/16 [00:04<01:00,  4.04s/it, loss=0.4062, gradTraining Epoch 4/5:   6%| | 1/16 [00:04<01:00,  4.04s/it, loss=0.3386, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.3386, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.4245, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.4245, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.4293, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.4293, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.3612, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.3612, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.4107, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.4107, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.3574, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.84it/s, loss=0.3574, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.84it/s, loss=0.3618, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.3618, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.3420, gradTraining Epoch 4/5:  56%|5| 9/16 [00:04<00:01,  5.59it/s, loss=0.3420, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.59it/s, loss=0.3086, gradTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.37it/s, loss=0.3086, graTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.37it/s, loss=0.3293, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  7.04it/s, loss=0.3293, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  7.04it/s, loss=0.3334, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.59it/s, loss=0.3334, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.59it/s, loss=0.3606, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  8.04it/s, loss=0.3606, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  8.04it/s, loss=0.2868, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.37it/s, loss=0.2868, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.37it/s, loss=0.2997, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.65it/s, loss=0.2997, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.65it/s, loss=0.6951, graTraining Epoch 4/5: 100%|#| 16/16 [00:06<00:00,  2.59it/s, loss=0.6951, gra

Epoch 4/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.3778, Acc: 0.9215, Precision: 0.8643, Recall: 1.0000, F1: 0.9272, AUC: 0.9641
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/16 [00:03<?, ?it/s, loss=0.2264, grad_norm=0.Training Epoch 5/5:   6%| | 1/16 [00:03<00:59,  3.94s/it, loss=0.2264, gradTraining Epoch 5/5:   6%| | 1/16 [00:04<00:59,  3.94s/it, loss=0.2187, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:23,  1.69s/it, loss=0.2187, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:23,  1.69s/it, loss=0.2319, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.03it/s, loss=0.2319, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.03it/s, loss=0.2818, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.59it/s, loss=0.2818, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.59it/s, loss=0.2563, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.27it/s, loss=0.2563, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.27it/s, loss=0.3881, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.06it/s, loss=0.3881, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.06it/s, loss=0.1842, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.90it/s, loss=0.1842, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.90it/s, loss=0.2679, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.78it/s, loss=0.2679, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.78it/s, loss=0.2528, gradTraining Epoch 5/5:  56%|5| 9/16 [00:04<00:01,  5.63it/s, loss=0.2528, gradTraining Epoch 5/5:  56%|5| 9/16 [00:04<00:01,  5.63it/s, loss=0.1561, gradTraining Epoch 5/5:  62%|6| 10/16 [00:04<00:00,  6.40it/s, loss=0.1561, graTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.40it/s, loss=0.2634, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  7.08it/s, loss=0.2634, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  7.08it/s, loss=0.2002, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.64it/s, loss=0.2002, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.64it/s, loss=0.1552, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  8.06it/s, loss=0.1552, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  8.06it/s, loss=0.1653, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.39it/s, loss=0.1653, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.39it/s, loss=0.1599, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.63it/s, loss=0.1599, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.63it/s, loss=0.1610, graTraining Epoch 5/5: 100%|#| 16/16 [00:06<00:00,  2.64it/s, loss=0.1610, gra

Epoch 5/5 Complete (6.5s) [LR: 0.000005]
Train - Loss: 0.2231, Acc: 0.9711, Precision: 0.9453, Recall: 1.0000, F1: 0.9719, AUC: 0.9766
------------------------------------------------------------
Training curves saved to model\chb20_fold2\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb20_fold2
============================================================
✅ Fold 2 training completed successfully!

============================================================
TRAINING FOLD 3/7
============================================================
Using dataset prefix: chb20_fold3
Loading datasets from: preprocessing\data\chb20_fold3
Saving models to: model\chb20_fold3
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2450, std=2.1339
Loaded train dataset: 252 samples
  - Spectrogram shape: torch.Size([252, 30, 18, 50, 10])
  - Value range: [-5.7384, 3.8302]
  - Class distribution: tensor([126, 126])
LOOCV Mode (Fold 3): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6950, grad_norm=1.Training Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.01s/it, loss=0.6950, gradTraining Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.01s/it, loss=0.7042, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.7042, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.7029, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.7029, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6919, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.6919, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.6803, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6803, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.6757, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.97it/s, loss=0.6757, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.97it/s, loss=0.6740, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.80it/s, loss=0.6740, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.80it/s, loss=0.6893, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.63it/s, loss=0.6893, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.63it/s, loss=0.7003, gradTraining Epoch 1/5:  56%|5| 9/16 [00:04<00:01,  5.44it/s, loss=0.7003, gradTraining Epoch 1/5:  56%|5| 9/16 [00:05<00:01,  5.44it/s, loss=0.6617, gradTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.17it/s, loss=0.6617, graTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.17it/s, loss=0.6784, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.79it/s, loss=0.6784, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.79it/s, loss=0.6800, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.29it/s, loss=0.6800, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.29it/s, loss=0.6542, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.78it/s, loss=0.6542, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.78it/s, loss=0.6865, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.20it/s, loss=0.6865, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.20it/s, loss=0.6633, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.51it/s, loss=0.6633, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.51it/s, loss=0.6464, graTraining Epoch 1/5: 100%|#| 16/16 [00:06<00:00,  2.56it/s, loss=0.6464, gra

Epoch 1/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6803, Acc: 0.6230, Precision: 0.6202, Recall: 0.6349, F1: 0.6275, AUC: 0.6902
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6724, grad_norm=1.Training Epoch 2/5:   6%| | 1/16 [00:04<01:01,  4.10s/it, loss=0.6724, gradTraining Epoch 2/5:   6%| | 1/16 [00:04<01:01,  4.10s/it, loss=0.6374, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.6374, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.6402, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.00s/it, loss=0.6402, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.00s/it, loss=0.6571, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.54it/s, loss=0.6571, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.54it/s, loss=0.6291, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.20it/s, loss=0.6291, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.20it/s, loss=0.6282, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.97it/s, loss=0.6282, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.97it/s, loss=0.6304, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.80it/s, loss=0.6304, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.80it/s, loss=0.6107, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.66it/s, loss=0.6107, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.66it/s, loss=0.5875, gradTraining Epoch 2/5:  56%|5| 9/16 [00:04<00:01,  5.50it/s, loss=0.5875, gradTraining Epoch 2/5:  56%|5| 9/16 [00:05<00:01,  5.50it/s, loss=0.6064, gradTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.28it/s, loss=0.6064, graTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.28it/s, loss=0.5866, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.96it/s, loss=0.5866, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.96it/s, loss=0.5856, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.48it/s, loss=0.5856, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.48it/s, loss=0.5555, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.94it/s, loss=0.5555, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.94it/s, loss=0.6121, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.28it/s, loss=0.6121, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  8.28it/s, loss=0.5384, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.49it/s, loss=0.5384, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.49it/s, loss=0.5747, graTraining Epoch 2/5: 100%|#| 16/16 [00:06<00:00,  2.53it/s, loss=0.5747, gra

Epoch 2/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6095, Acc: 0.9206, Precision: 0.8786, Recall: 0.9762, F1: 0.9248, AUC: 0.9531
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.5520, grad_norm=1.Training Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.02s/it, loss=0.5520, gradTraining Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.02s/it, loss=0.5044, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.5044, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.5008, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.5008, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.5026, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.5026, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.57it/s, loss=0.4948, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.4948, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.4412, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.4412, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.5582, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.86it/s, loss=0.5582, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.86it/s, loss=0.4745, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.71it/s, loss=0.4745, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.71it/s, loss=0.4568, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.59it/s, loss=0.4568, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.59it/s, loss=0.5249, gradTraining Epoch 3/5:  62%|6| 10/16 [00:04<00:00,  6.38it/s, loss=0.5249, graTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.38it/s, loss=0.5288, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  7.04it/s, loss=0.5288, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  7.04it/s, loss=0.4854, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.54it/s, loss=0.4854, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.54it/s, loss=0.4262, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.97it/s, loss=0.4262, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.97it/s, loss=0.5101, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.34it/s, loss=0.5101, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.34it/s, loss=0.4807, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.55it/s, loss=0.4807, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.55it/s, loss=0.3587, graTraining Epoch 3/5: 100%|#| 16/16 [00:06<00:00,  2.58it/s, loss=0.3587, gra

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.4875, Acc: 0.9365, Precision: 0.8929, Recall: 0.9921, F1: 0.9398, AUC: 0.9524
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.3482, grad_norm=0.Training Epoch 4/5:   6%| | 1/16 [00:04<01:00,  4.04s/it, loss=0.3482, gradTraining Epoch 4/5:   6%| | 1/16 [00:04<01:00,  4.04s/it, loss=0.6272, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.6272, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.3516, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.3516, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.3180, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.3180, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.4023, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.4023, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.3826, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  3.01it/s, loss=0.3826, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  3.01it/s, loss=0.3785, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.3785, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.85it/s, loss=0.4065, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.4065, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.73it/s, loss=0.3594, gradTraining Epoch 4/5:  56%|5| 9/16 [00:04<00:01,  5.56it/s, loss=0.3594, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.56it/s, loss=0.3228, gradTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.32it/s, loss=0.3228, graTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.32it/s, loss=0.3318, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.98it/s, loss=0.3318, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.98it/s, loss=0.3109, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.51it/s, loss=0.3109, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.51it/s, loss=0.2801, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.80it/s, loss=0.2801, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.80it/s, loss=0.3538, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.19it/s, loss=0.3538, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.19it/s, loss=0.1983, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.47it/s, loss=0.1983, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.47it/s, loss=0.2623, graTraining Epoch 4/5: 100%|#| 16/16 [00:06<00:00,  2.56it/s, loss=0.2623, gra

Epoch 4/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.3521, Acc: 0.9127, Precision: 0.8824, Recall: 0.9524, F1: 0.9160, AUC: 0.9562
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.3503, grad_norm=0.Training Epoch 5/5:   6%| | 1/16 [00:04<01:01,  4.10s/it, loss=0.3503, gradTraining Epoch 5/5:   6%| | 1/16 [00:04<01:01,  4.10s/it, loss=0.2723, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.2723, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.1722, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:13,  1.00s/it, loss=0.1722, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:13,  1.00s/it, loss=0.2146, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.54it/s, loss=0.2146, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.54it/s, loss=0.1762, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.1762, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.3195, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  2.89it/s, loss=0.3195, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  2.89it/s, loss=0.1402, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.71it/s, loss=0.1402, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.71it/s, loss=0.1853, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.34it/s, loss=0.1853, gradTraining Epoch 5/5:  50%|5| 8/16 [00:05<00:01,  4.34it/s, loss=0.3016, gradTraining Epoch 5/5:  56%|5| 9/16 [00:05<00:01,  5.17it/s, loss=0.3016, gradTraining Epoch 5/5:  56%|5| 9/16 [00:05<00:01,  5.17it/s, loss=0.3832, gradTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:01,  5.94it/s, loss=0.3832, graTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:01,  5.94it/s, loss=0.1800, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.67it/s, loss=0.1800, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.67it/s, loss=0.3340, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.29it/s, loss=0.3340, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.29it/s, loss=0.1413, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.80it/s, loss=0.1413, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.80it/s, loss=0.1124, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.21it/s, loss=0.1124, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.21it/s, loss=0.0982, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.48it/s, loss=0.0982, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.48it/s, loss=0.1640, graTraining Epoch 5/5: 100%|#| 16/16 [00:06<00:00,  2.51it/s, loss=0.1640, gra

Epoch 5/5 Complete (6.8s) [LR: 0.000005]
Train - Loss: 0.2216, Acc: 0.9563, Precision: 0.9197, Recall: 1.0000, F1: 0.9582, AUC: 0.9841
------------------------------------------------------------
Training curves saved to model\chb20_fold3\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb20_fold3
============================================================
✅ Fold 3 training completed successfully!

============================================================
TRAINING FOLD 4/7
============================================================
Using dataset prefix: chb20_fold4
Loading datasets from: preprocessing\data\chb20_fold4
Saving models to: model\chb20_fold4
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2695, std=2.1434
Loaded train dataset: 260 samples
  - Spectrogram shape: torch.Size([260, 30, 18, 50, 10])
  - Value range: [-5.7244, 3.9741]
  - Class distribution: tensor([130, 130])
LOOCV Mode (Fold 4): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.6822, grad_norm=0.Training Epoch 1/5:   6%| | 1/17 [00:04<01:06,  4.16s/it, loss=0.6822, gradTraining Epoch 1/5:   6%| | 1/17 [00:04<01:06,  4.16s/it, loss=0.6957, gradTraining Epoch 1/5:  12%|1| 2/17 [00:04<00:26,  1.79s/it, loss=0.6957, gradTraining Epoch 1/5:  12%|1| 2/17 [00:04<00:26,  1.79s/it, loss=0.7047, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:14,  1.02s/it, loss=0.7047, gradTraining Epoch 1/5:  18%|1| 3/17 [00:04<00:14,  1.02s/it, loss=0.6864, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.51it/s, loss=0.6864, gradTraining Epoch 1/5:  24%|2| 4/17 [00:04<00:08,  1.51it/s, loss=0.7001, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.16it/s, loss=0.7001, gradTraining Epoch 1/5:  29%|2| 5/17 [00:04<00:05,  2.16it/s, loss=0.6826, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  2.86it/s, loss=0.6826, gradTraining Epoch 1/5:  35%|3| 6/17 [00:04<00:03,  2.86it/s, loss=0.6866, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.70it/s, loss=0.6866, gradTraining Epoch 1/5:  41%|4| 7/17 [00:04<00:02,  3.70it/s, loss=0.6783, gradTraining Epoch 1/5:  47%|4| 8/17 [00:04<00:01,  4.57it/s, loss=0.6783, gradTraining Epoch 1/5:  47%|4| 8/17 [00:05<00:01,  4.57it/s, loss=0.6872, gradTraining Epoch 1/5:  53%|5| 9/17 [00:05<00:01,  5.44it/s, loss=0.6872, gradTraining Epoch 1/5:  53%|5| 9/17 [00:05<00:01,  5.44it/s, loss=0.6865, gradTraining Epoch 1/5:  59%|5| 10/17 [00:05<00:01,  6.05it/s, loss=0.6865, graTraining Epoch 1/5:  59%|5| 10/17 [00:05<00:01,  6.05it/s, loss=0.6798, graTraining Epoch 1/5:  65%|6| 11/17 [00:05<00:00,  6.70it/s, loss=0.6798, graTraining Epoch 1/5:  65%|6| 11/17 [00:05<00:00,  6.70it/s, loss=0.6762, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.32it/s, loss=0.6762, graTraining Epoch 1/5:  71%|7| 12/17 [00:05<00:00,  7.32it/s, loss=0.6636, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  7.79it/s, loss=0.6636, graTraining Epoch 1/5:  76%|7| 13/17 [00:05<00:00,  7.79it/s, loss=0.6813, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  7.97it/s, loss=0.6813, graTraining Epoch 1/5:  82%|8| 14/17 [00:05<00:00,  7.97it/s, loss=0.6668, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.06it/s, loss=0.6668, graTraining Epoch 1/5:  88%|8| 15/17 [00:05<00:00,  8.06it/s, loss=0.6549, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.40it/s, loss=0.6549, graTraining Epoch 1/5:  94%|9| 16/17 [00:05<00:00,  8.40it/s, loss=0.6669, graTraining Epoch 1/5: 100%|#| 17/17 [00:06<00:00,  2.59it/s, loss=0.6669, gra

Epoch 1/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.6812, Acc: 0.6308, Precision: 0.8148, Recall: 0.3385, F1: 0.4783, AUC: 0.7273
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.6479, grad_norm=1.Training Epoch 2/5:   6%| | 1/17 [00:04<01:04,  4.01s/it, loss=0.6479, gradTraining Epoch 2/5:   6%| | 1/17 [00:04<01:04,  4.01s/it, loss=0.6632, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:25,  1.72s/it, loss=0.6632, gradTraining Epoch 2/5:  12%|1| 2/17 [00:04<00:25,  1.72s/it, loss=0.6561, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:13,  1.02it/s, loss=0.6561, gradTraining Epoch 2/5:  18%|1| 3/17 [00:04<00:13,  1.02it/s, loss=0.6569, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.56it/s, loss=0.6569, gradTraining Epoch 2/5:  24%|2| 4/17 [00:04<00:08,  1.56it/s, loss=0.6434, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.23it/s, loss=0.6434, gradTraining Epoch 2/5:  29%|2| 5/17 [00:04<00:05,  2.23it/s, loss=0.6401, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  2.99it/s, loss=0.6401, gradTraining Epoch 2/5:  35%|3| 6/17 [00:04<00:03,  2.99it/s, loss=0.6287, gradTraining Epoch 2/5:  41%|4| 7/17 [00:04<00:02,  3.84it/s, loss=0.6287, gradTraining Epoch 2/5:  41%|4| 7/17 [00:04<00:02,  3.84it/s, loss=0.6342, gradTraining Epoch 2/5:  47%|4| 8/17 [00:04<00:01,  4.71it/s, loss=0.6342, gradTraining Epoch 2/5:  47%|4| 8/17 [00:04<00:01,  4.71it/s, loss=0.6140, gradTraining Epoch 2/5:  53%|5| 9/17 [00:04<00:01,  5.57it/s, loss=0.6140, gradTraining Epoch 2/5:  53%|5| 9/17 [00:05<00:01,  5.57it/s, loss=0.5983, gradTraining Epoch 2/5:  59%|5| 10/17 [00:05<00:01,  6.34it/s, loss=0.5983, graTraining Epoch 2/5:  59%|5| 10/17 [00:05<00:01,  6.34it/s, loss=0.5910, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  6.99it/s, loss=0.5910, graTraining Epoch 2/5:  65%|6| 11/17 [00:05<00:00,  6.99it/s, loss=0.5722, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  7.57it/s, loss=0.5722, graTraining Epoch 2/5:  71%|7| 12/17 [00:05<00:00,  7.57it/s, loss=0.5911, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  7.97it/s, loss=0.5911, graTraining Epoch 2/5:  76%|7| 13/17 [00:05<00:00,  7.97it/s, loss=0.6004, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  8.30it/s, loss=0.6004, graTraining Epoch 2/5:  82%|8| 14/17 [00:05<00:00,  8.30it/s, loss=0.5633, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  8.54it/s, loss=0.5633, graTraining Epoch 2/5:  88%|8| 15/17 [00:05<00:00,  8.54it/s, loss=0.5397, graTraining Epoch 2/5:  94%|9| 16/17 [00:05<00:00,  8.71it/s, loss=0.5397, graTraining Epoch 2/5:  94%|9| 16/17 [00:05<00:00,  8.71it/s, loss=0.5719, graTraining Epoch 2/5: 100%|#| 17/17 [00:06<00:00,  2.70it/s, loss=0.5719, gra

Epoch 2/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6125, Acc: 0.9231, Precision: 0.9583, Recall: 0.8846, F1: 0.9200, AUC: 0.9857
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.5522, grad_norm=0.Training Epoch 3/5:   6%| | 1/17 [00:04<01:05,  4.12s/it, loss=0.5522, gradTraining Epoch 3/5:   6%| | 1/17 [00:04<01:05,  4.12s/it, loss=0.5270, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:26,  1.77s/it, loss=0.5270, gradTraining Epoch 3/5:  12%|1| 2/17 [00:04<00:26,  1.77s/it, loss=0.4849, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:14,  1.01s/it, loss=0.4849, gradTraining Epoch 3/5:  18%|1| 3/17 [00:04<00:14,  1.01s/it, loss=0.5052, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.53it/s, loss=0.5052, gradTraining Epoch 3/5:  24%|2| 4/17 [00:04<00:08,  1.53it/s, loss=0.4937, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.18it/s, loss=0.4937, gradTraining Epoch 3/5:  29%|2| 5/17 [00:04<00:05,  2.18it/s, loss=0.4839, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  2.95it/s, loss=0.4839, gradTraining Epoch 3/5:  35%|3| 6/17 [00:04<00:03,  2.95it/s, loss=0.4647, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.79it/s, loss=0.4647, gradTraining Epoch 3/5:  41%|4| 7/17 [00:04<00:02,  3.79it/s, loss=0.4670, gradTraining Epoch 3/5:  47%|4| 8/17 [00:04<00:01,  4.65it/s, loss=0.4670, gradTraining Epoch 3/5:  47%|4| 8/17 [00:05<00:01,  4.65it/s, loss=0.4964, gradTraining Epoch 3/5:  53%|5| 9/17 [00:05<00:01,  5.51it/s, loss=0.4964, gradTraining Epoch 3/5:  53%|5| 9/17 [00:05<00:01,  5.51it/s, loss=0.4081, gradTraining Epoch 3/5:  59%|5| 10/17 [00:05<00:01,  6.29it/s, loss=0.4081, graTraining Epoch 3/5:  59%|5| 10/17 [00:05<00:01,  6.29it/s, loss=0.4515, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  6.68it/s, loss=0.4515, graTraining Epoch 3/5:  65%|6| 11/17 [00:05<00:00,  6.68it/s, loss=0.4907, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  6.98it/s, loss=0.4907, graTraining Epoch 3/5:  71%|7| 12/17 [00:05<00:00,  6.98it/s, loss=0.4285, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  7.54it/s, loss=0.4285, graTraining Epoch 3/5:  76%|7| 13/17 [00:05<00:00,  7.54it/s, loss=0.4148, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  7.95it/s, loss=0.4148, graTraining Epoch 3/5:  82%|8| 14/17 [00:05<00:00,  7.95it/s, loss=0.4816, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  7.99it/s, loss=0.4816, graTraining Epoch 3/5:  88%|8| 15/17 [00:05<00:00,  7.99it/s, loss=0.3965, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.24it/s, loss=0.3965, graTraining Epoch 3/5:  94%|9| 16/17 [00:05<00:00,  8.24it/s, loss=0.3931, graTraining Epoch 3/5: 100%|#| 17/17 [00:06<00:00,  2.63it/s, loss=0.3931, gra

Epoch 3/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.4671, Acc: 0.9615, Precision: 0.9286, Recall: 1.0000, F1: 0.9630, AUC: 0.9717
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.3237, grad_norm=1.Training Epoch 4/5:   6%| | 1/17 [00:04<01:05,  4.10s/it, loss=0.3237, gradTraining Epoch 4/5:   6%| | 1/17 [00:04<01:05,  4.10s/it, loss=0.3292, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:26,  1.75s/it, loss=0.3292, gradTraining Epoch 4/5:  12%|1| 2/17 [00:04<00:26,  1.75s/it, loss=0.3648, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:14,  1.00s/it, loss=0.3648, gradTraining Epoch 4/5:  18%|1| 3/17 [00:04<00:14,  1.00s/it, loss=0.3366, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.54it/s, loss=0.3366, gradTraining Epoch 4/5:  24%|2| 4/17 [00:04<00:08,  1.54it/s, loss=0.3990, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.18it/s, loss=0.3990, gradTraining Epoch 4/5:  29%|2| 5/17 [00:04<00:05,  2.18it/s, loss=0.3272, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  2.93it/s, loss=0.3272, gradTraining Epoch 4/5:  35%|3| 6/17 [00:04<00:03,  2.93it/s, loss=0.3427, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.76it/s, loss=0.3427, gradTraining Epoch 4/5:  41%|4| 7/17 [00:04<00:02,  3.76it/s, loss=0.2610, gradTraining Epoch 4/5:  47%|4| 8/17 [00:04<00:01,  4.63it/s, loss=0.2610, gradTraining Epoch 4/5:  47%|4| 8/17 [00:04<00:01,  4.63it/s, loss=0.3150, gradTraining Epoch 4/5:  53%|5| 9/17 [00:04<00:01,  5.45it/s, loss=0.3150, gradTraining Epoch 4/5:  53%|5| 9/17 [00:05<00:01,  5.45it/s, loss=0.2177, gradTraining Epoch 4/5:  59%|5| 10/17 [00:05<00:01,  6.03it/s, loss=0.2177, graTraining Epoch 4/5:  59%|5| 10/17 [00:05<00:01,  6.03it/s, loss=0.2409, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  6.76it/s, loss=0.2409, graTraining Epoch 4/5:  65%|6| 11/17 [00:05<00:00,  6.76it/s, loss=0.2227, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  7.35it/s, loss=0.2227, graTraining Epoch 4/5:  71%|7| 12/17 [00:05<00:00,  7.35it/s, loss=0.2281, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.48it/s, loss=0.2281, graTraining Epoch 4/5:  76%|7| 13/17 [00:05<00:00,  7.48it/s, loss=0.1890, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  7.60it/s, loss=0.1890, graTraining Epoch 4/5:  82%|8| 14/17 [00:05<00:00,  7.60it/s, loss=0.3292, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  7.87it/s, loss=0.3292, graTraining Epoch 4/5:  88%|8| 15/17 [00:05<00:00,  7.87it/s, loss=0.2368, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.23it/s, loss=0.2368, graTraining Epoch 4/5:  94%|9| 16/17 [00:05<00:00,  8.23it/s, loss=0.2174, graTraining Epoch 4/5: 100%|#| 17/17 [00:06<00:00,  2.63it/s, loss=0.2174, gra

Epoch 4/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.2871, Acc: 0.9615, Precision: 0.9286, Recall: 1.0000, F1: 0.9630, AUC: 0.9864
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/17 [00:04<?, ?it/s, loss=0.1521, grad_norm=0.Training Epoch 5/5:   6%| | 1/17 [00:04<01:04,  4.04s/it, loss=0.1521, gradTraining Epoch 5/5:   6%| | 1/17 [00:04<01:04,  4.04s/it, loss=0.2378, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:25,  1.73s/it, loss=0.2378, gradTraining Epoch 5/5:  12%|1| 2/17 [00:04<00:25,  1.73s/it, loss=0.1712, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.1712, gradTraining Epoch 5/5:  18%|1| 3/17 [00:04<00:13,  1.01it/s, loss=0.1225, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.55it/s, loss=0.1225, gradTraining Epoch 5/5:  24%|2| 4/17 [00:04<00:08,  1.55it/s, loss=0.2585, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.20it/s, loss=0.2585, gradTraining Epoch 5/5:  29%|2| 5/17 [00:04<00:05,  2.20it/s, loss=0.1276, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  2.90it/s, loss=0.1276, gradTraining Epoch 5/5:  35%|3| 6/17 [00:04<00:03,  2.90it/s, loss=0.1889, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.73it/s, loss=0.1889, gradTraining Epoch 5/5:  41%|4| 7/17 [00:04<00:02,  3.73it/s, loss=0.1691, gradTraining Epoch 5/5:  47%|4| 8/17 [00:04<00:01,  4.59it/s, loss=0.1691, gradTraining Epoch 5/5:  47%|4| 8/17 [00:04<00:01,  4.59it/s, loss=0.1220, gradTraining Epoch 5/5:  53%|5| 9/17 [00:04<00:01,  5.45it/s, loss=0.1220, gradTraining Epoch 5/5:  53%|5| 9/17 [00:05<00:01,  5.45it/s, loss=0.1052, gradTraining Epoch 5/5:  59%|5| 10/17 [00:05<00:01,  6.22it/s, loss=0.1052, graTraining Epoch 5/5:  59%|5| 10/17 [00:05<00:01,  6.22it/s, loss=0.1369, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.91it/s, loss=0.1369, graTraining Epoch 5/5:  65%|6| 11/17 [00:05<00:00,  6.91it/s, loss=0.1315, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.44it/s, loss=0.1315, graTraining Epoch 5/5:  71%|7| 12/17 [00:05<00:00,  7.44it/s, loss=0.1359, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.88it/s, loss=0.1359, graTraining Epoch 5/5:  76%|7| 13/17 [00:05<00:00,  7.88it/s, loss=0.0672, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.27it/s, loss=0.0672, graTraining Epoch 5/5:  82%|8| 14/17 [00:05<00:00,  8.27it/s, loss=0.1366, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.34it/s, loss=0.1366, graTraining Epoch 5/5:  88%|8| 15/17 [00:05<00:00,  8.34it/s, loss=0.2138, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.54it/s, loss=0.2138, graTraining Epoch 5/5:  94%|9| 16/17 [00:05<00:00,  8.54it/s, loss=0.0729, graTraining Epoch 5/5: 100%|#| 17/17 [00:06<00:00,  2.67it/s, loss=0.0729, gra

Epoch 5/5 Complete (6.8s) [LR: 0.000005]
Train - Loss: 0.1500, Acc: 0.9692, Precision: 0.9552, Recall: 0.9846, F1: 0.9697, AUC: 0.9964
------------------------------------------------------------
Training curves saved to model\chb20_fold4\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb20_fold4
============================================================
✅ Fold 4 training completed successfully!

============================================================
TRAINING FOLD 5/7
============================================================
Using dataset prefix: chb20_fold5
Loading datasets from: preprocessing\data\chb20_fold5
Saving models to: model\chb20_fold5
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2272, std=2.1580
Loaded train dataset: 246 samples
  - Spectrogram shape: torch.Size([246, 30, 18, 50, 10])
  - Value range: [-5.6661, 3.8756]
  - Class distribution: tensor([123, 123])
LOOCV Mode (Fold 5): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6975, grad_norm=1.Training Epoch 1/5:   6%| | 1/16 [00:04<01:01,  4.12s/it, loss=0.6975, gradTraining Epoch 1/5:   6%| | 1/16 [00:04<01:01,  4.12s/it, loss=0.6919, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.6919, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.6953, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.6953, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.6828, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.53it/s, loss=0.6828, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.53it/s, loss=0.6879, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:05,  2.19it/s, loss=0.6879, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:05,  2.19it/s, loss=0.6911, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.95it/s, loss=0.6911, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.95it/s, loss=0.6931, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.79it/s, loss=0.6931, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.79it/s, loss=0.6865, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.65it/s, loss=0.6865, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.65it/s, loss=0.6757, gradTraining Epoch 1/5:  56%|5| 9/16 [00:04<00:01,  5.54it/s, loss=0.6757, gradTraining Epoch 1/5:  56%|5| 9/16 [00:05<00:01,  5.54it/s, loss=0.6866, gradTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.33it/s, loss=0.6866, graTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.33it/s, loss=0.6784, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.99it/s, loss=0.6784, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.99it/s, loss=0.6690, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.53it/s, loss=0.6690, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.53it/s, loss=0.6728, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.59it/s, loss=0.6728, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.59it/s, loss=0.6830, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  7.58it/s, loss=0.6830, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  7.58it/s, loss=0.6739, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  7.67it/s, loss=0.6739, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  7.67it/s, loss=0.6805, graTraining Epoch 1/5: 100%|#| 16/16 [00:06<00:00,  2.53it/s, loss=0.6805, gra

Epoch 1/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6841, Acc: 0.6382, Precision: 0.6232, Recall: 0.6992, F1: 0.6590, AUC: 0.6850
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6689, grad_norm=1.Training Epoch 2/5:   6%| | 1/16 [00:04<01:02,  4.14s/it, loss=0.6689, gradTraining Epoch 2/5:   6%| | 1/16 [00:04<01:02,  4.14s/it, loss=0.6570, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.77s/it, loss=0.6570, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.77s/it, loss=0.6492, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.6492, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.6438, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.50it/s, loss=0.6438, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.50it/s, loss=0.6318, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.15it/s, loss=0.6318, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.15it/s, loss=0.6489, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.90it/s, loss=0.6489, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.90it/s, loss=0.6303, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.73it/s, loss=0.6303, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.73it/s, loss=0.6329, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.48it/s, loss=0.6329, gradTraining Epoch 2/5:  50%|5| 8/16 [00:05<00:01,  4.48it/s, loss=0.6194, gradTraining Epoch 2/5:  56%|5| 9/16 [00:05<00:01,  5.34it/s, loss=0.6194, gradTraining Epoch 2/5:  56%|5| 9/16 [00:05<00:01,  5.34it/s, loss=0.6363, gradTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.15it/s, loss=0.6363, graTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.15it/s, loss=0.5924, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.84it/s, loss=0.5924, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.84it/s, loss=0.6029, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.14it/s, loss=0.6029, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.14it/s, loss=0.5873, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.57it/s, loss=0.5873, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.57it/s, loss=0.6233, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  7.98it/s, loss=0.6233, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  7.98it/s, loss=0.5834, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.31it/s, loss=0.5834, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.31it/s, loss=0.5379, graTraining Epoch 2/5: 100%|#| 16/16 [00:06<00:00,  2.51it/s, loss=0.5379, gra

Epoch 2/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6216, Acc: 0.9228, Precision: 0.8824, Recall: 0.9756, F1: 0.9266, AUC: 0.9267
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.5208, grad_norm=1.Training Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.00s/it, loss=0.5208, gradTraining Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.00s/it, loss=0.5301, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.5301, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.6177, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6177, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.4894, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.4894, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.5393, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.5393, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:04,  2.23it/s, loss=0.4984, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.97it/s, loss=0.4984, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.97it/s, loss=0.5060, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.76it/s, loss=0.5060, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.76it/s, loss=0.4639, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.62it/s, loss=0.4639, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.62it/s, loss=0.5086, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.48it/s, loss=0.5086, gradTraining Epoch 3/5:  56%|5| 9/16 [00:05<00:01,  5.48it/s, loss=0.4873, gradTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.28it/s, loss=0.4873, graTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.28it/s, loss=0.4296, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.70it/s, loss=0.4296, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.70it/s, loss=0.5396, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.27it/s, loss=0.5396, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.27it/s, loss=0.4742, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.74it/s, loss=0.4742, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.74it/s, loss=0.4229, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.13it/s, loss=0.4229, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.13it/s, loss=0.4609, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.37it/s, loss=0.4609, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.37it/s, loss=0.4748, graTraining Epoch 3/5: 100%|#| 16/16 [00:06<00:00,  2.57it/s, loss=0.4748, gra

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.4977, Acc: 0.9431, Precision: 0.8978, Recall: 1.0000, F1: 0.9462, AUC: 0.9553
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.4284, grad_norm=1.Training Epoch 4/5:   6%| | 1/16 [00:04<01:02,  4.14s/it, loss=0.4284, gradTraining Epoch 4/5:   6%| | 1/16 [00:04<01:02,  4.14s/it, loss=0.3761, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.77s/it, loss=0.3761, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.77s/it, loss=0.4486, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.4486, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.4569, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.52it/s, loss=0.4569, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.52it/s, loss=0.3052, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:05,  2.16it/s, loss=0.3052, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:05,  2.16it/s, loss=0.3816, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.92it/s, loss=0.3816, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.92it/s, loss=0.3390, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.75it/s, loss=0.3390, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.75it/s, loss=0.2608, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.51it/s, loss=0.2608, gradTraining Epoch 4/5:  50%|5| 8/16 [00:05<00:01,  4.51it/s, loss=0.3306, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.32it/s, loss=0.3306, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.32it/s, loss=0.2811, gradTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.08it/s, loss=0.2811, graTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.08it/s, loss=0.3113, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.80it/s, loss=0.3113, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.80it/s, loss=0.2067, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.36it/s, loss=0.2067, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.36it/s, loss=0.2036, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.85it/s, loss=0.2036, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.85it/s, loss=0.3834, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.22it/s, loss=0.3834, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  8.22it/s, loss=0.3307, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.46it/s, loss=0.3307, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.46it/s, loss=0.2576, graTraining Epoch 4/5: 100%|#| 16/16 [00:06<00:00,  2.52it/s, loss=0.2576, gra

Epoch 4/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.3314, Acc: 0.9472, Precision: 0.9044, Recall: 1.0000, F1: 0.9498, AUC: 0.9581
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.2652, grad_norm=0.Training Epoch 5/5:   6%| | 1/16 [00:04<01:00,  4.02s/it, loss=0.2652, gradTraining Epoch 5/5:   6%| | 1/16 [00:04<01:00,  4.02s/it, loss=0.1879, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.1879, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.1604, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.1604, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.1646, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.1646, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.56it/s, loss=0.2266, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.2266, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:04,  2.22it/s, loss=0.2804, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.2804, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  3.00it/s, loss=0.3294, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.84it/s, loss=0.3294, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.84it/s, loss=0.2188, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.70it/s, loss=0.2188, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.70it/s, loss=0.3191, gradTraining Epoch 5/5:  56%|5| 9/16 [00:04<00:01,  5.52it/s, loss=0.3191, gradTraining Epoch 5/5:  56%|5| 9/16 [00:05<00:01,  5.52it/s, loss=0.3786, gradTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.19it/s, loss=0.3786, graTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.19it/s, loss=0.3517, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.90it/s, loss=0.3517, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.90it/s, loss=0.1314, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.48it/s, loss=0.1314, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.48it/s, loss=0.1553, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.84it/s, loss=0.1553, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.84it/s, loss=0.1713, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.09it/s, loss=0.1713, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.09it/s, loss=0.2437, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.37it/s, loss=0.2437, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.37it/s, loss=0.3477, graTraining Epoch 5/5: 100%|#| 16/16 [00:06<00:00,  2.57it/s, loss=0.3477, gra

Epoch 5/5 Complete (6.6s) [LR: 0.000005]
Train - Loss: 0.2457, Acc: 0.9268, Precision: 0.8889, Recall: 0.9756, F1: 0.9302, AUC: 0.9658
------------------------------------------------------------
Training curves saved to model\chb20_fold5\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb20_fold5
============================================================
✅ Fold 5 training completed successfully!

============================================================
TRAINING FOLD 6/7
============================================================
Using dataset prefix: chb20_fold6
Loading datasets from: preprocessing\data\chb20_fold6
Saving models to: model\chb20_fold6
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.1749, std=2.1718
Loaded train dataset: 244 samples
  - Spectrogram shape: torch.Size([244, 30, 18, 50, 10])
  - Value range: [-5.6060, 3.8933]
  - Class distribution: tensor([122, 122])
LOOCV Mode (Fold 6): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6977, grad_norm=1.Training Epoch 1/5:   6%| | 1/16 [00:04<01:02,  4.15s/it, loss=0.6977, gradTraining Epoch 1/5:   6%| | 1/16 [00:04<01:02,  4.15s/it, loss=0.6880, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.78s/it, loss=0.6880, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.78s/it, loss=0.6943, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.6943, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.6743, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.52it/s, loss=0.6743, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.52it/s, loss=0.6924, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.6924, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.6949, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.94it/s, loss=0.6949, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.94it/s, loss=0.6873, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.73it/s, loss=0.6873, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.73it/s, loss=0.6842, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.55it/s, loss=0.6842, gradTraining Epoch 1/5:  50%|5| 8/16 [00:05<00:01,  4.55it/s, loss=0.6680, gradTraining Epoch 1/5:  56%|5| 9/16 [00:05<00:01,  5.41it/s, loss=0.6680, gradTraining Epoch 1/5:  56%|5| 9/16 [00:05<00:01,  5.41it/s, loss=0.6723, gradTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.20it/s, loss=0.6723, graTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:00,  6.20it/s, loss=0.6951, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.84it/s, loss=0.6951, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.84it/s, loss=0.6998, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.08it/s, loss=0.6998, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.08it/s, loss=0.6924, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.61it/s, loss=0.6924, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.61it/s, loss=0.6635, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.04it/s, loss=0.6635, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  8.04it/s, loss=0.6744, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.36it/s, loss=0.6744, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.36it/s, loss=0.6743, graTraining Epoch 1/5: 100%|#| 16/16 [00:06<00:00,  2.51it/s, loss=0.6743, gra

Epoch 1/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6846, Acc: 0.5164, Precision: 0.6667, Recall: 0.0656, F1: 0.1194, AUC: 0.6852
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6584, grad_norm=1.Training Epoch 2/5:   6%| | 1/16 [00:04<01:02,  4.15s/it, loss=0.6584, gradTraining Epoch 2/5:   6%| | 1/16 [00:04<01:02,  4.15s/it, loss=0.6701, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.78s/it, loss=0.6701, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.78s/it, loss=0.6512, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.6512, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.6450, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.52it/s, loss=0.6450, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.52it/s, loss=0.6541, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.17it/s, loss=0.6541, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.17it/s, loss=0.6673, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.94it/s, loss=0.6673, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.94it/s, loss=0.6557, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.77it/s, loss=0.6557, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.77it/s, loss=0.6395, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.62it/s, loss=0.6395, gradTraining Epoch 2/5:  50%|5| 8/16 [00:05<00:01,  4.62it/s, loss=0.6567, gradTraining Epoch 2/5:  56%|5| 9/16 [00:05<00:01,  5.49it/s, loss=0.6567, gradTraining Epoch 2/5:  56%|5| 9/16 [00:05<00:01,  5.49it/s, loss=0.6288, gradTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.16it/s, loss=0.6288, graTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.16it/s, loss=0.6146, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.86it/s, loss=0.6146, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.86it/s, loss=0.6100, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.42it/s, loss=0.6100, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.42it/s, loss=0.6410, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.58it/s, loss=0.6410, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.58it/s, loss=0.6157, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  7.59it/s, loss=0.6157, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  7.59it/s, loss=0.6258, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  7.80it/s, loss=0.6258, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  7.80it/s, loss=0.5998, graTraining Epoch 2/5: 100%|#| 16/16 [00:06<00:00,  2.50it/s, loss=0.5998, gra

Epoch 2/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6396, Acc: 0.8402, Precision: 0.8609, Recall: 0.8115, F1: 0.8354, AUC: 0.9335
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.5919, grad_norm=1.Training Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.01s/it, loss=0.5919, gradTraining Epoch 3/5:   6%| | 1/16 [00:04<01:00,  4.01s/it, loss=0.5735, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.5735, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.72s/it, loss=0.5652, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.5652, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:12,  1.02it/s, loss=0.5790, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.53it/s, loss=0.5790, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.53it/s, loss=0.5655, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.5655, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.5560, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.94it/s, loss=0.5560, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.94it/s, loss=0.5844, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.78it/s, loss=0.5844, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.78it/s, loss=0.5713, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.57it/s, loss=0.5713, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.57it/s, loss=0.4943, gradTraining Epoch 3/5:  56%|5| 9/16 [00:04<00:01,  5.34it/s, loss=0.4943, gradTraining Epoch 3/5:  56%|5| 9/16 [00:05<00:01,  5.34it/s, loss=0.5382, gradTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.14it/s, loss=0.5382, graTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.14it/s, loss=0.5404, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.82it/s, loss=0.5404, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.82it/s, loss=0.5358, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.20it/s, loss=0.5358, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.20it/s, loss=0.4850, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.40it/s, loss=0.4850, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.40it/s, loss=0.4794, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  7.83it/s, loss=0.4794, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  7.83it/s, loss=0.4518, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.27it/s, loss=0.4518, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.27it/s, loss=0.5331, graTraining Epoch 3/5: 100%|#| 16/16 [00:06<00:00,  2.55it/s, loss=0.5331, gra

Epoch 3/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.5403, Acc: 0.9098, Precision: 0.8472, Recall: 1.0000, F1: 0.9173, AUC: 0.9532
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.4913, grad_norm=1.Training Epoch 4/5:   6%| | 1/16 [00:04<01:01,  4.13s/it, loss=0.4913, gradTraining Epoch 4/5:   6%| | 1/16 [00:04<01:01,  4.13s/it, loss=0.4571, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.78s/it, loss=0.4571, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.78s/it, loss=0.4447, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.4447, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:13,  1.02s/it, loss=0.4134, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:08,  1.50it/s, loss=0.4134, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:08,  1.50it/s, loss=0.4723, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:05,  2.14it/s, loss=0.4723, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:05,  2.14it/s, loss=0.4028, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.88it/s, loss=0.4028, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.88it/s, loss=0.3434, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.71it/s, loss=0.3434, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.71it/s, loss=0.3853, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.58it/s, loss=0.3853, gradTraining Epoch 4/5:  50%|5| 8/16 [00:05<00:01,  4.58it/s, loss=0.3402, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.44it/s, loss=0.3402, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.44it/s, loss=0.4341, gradTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.22it/s, loss=0.4341, graTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.22it/s, loss=0.3427, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.89it/s, loss=0.3427, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.89it/s, loss=0.3887, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.17it/s, loss=0.3887, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.17it/s, loss=0.3613, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.70it/s, loss=0.3613, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.70it/s, loss=0.3339, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  7.92it/s, loss=0.3339, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  7.92it/s, loss=0.4496, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  7.80it/s, loss=0.4496, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  7.80it/s, loss=0.3068, graTraining Epoch 4/5: 100%|#| 16/16 [00:06<00:00,  2.49it/s, loss=0.3068, gra

Epoch 4/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.3980, Acc: 0.9303, Precision: 0.8832, Recall: 0.9918, F1: 0.9344, AUC: 0.9692
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.3120, grad_norm=1.Training Epoch 5/5:   6%| | 1/16 [00:04<01:02,  4.17s/it, loss=0.3120, gradTraining Epoch 5/5:   6%| | 1/16 [00:04<01:02,  4.17s/it, loss=0.2689, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:24,  1.78s/it, loss=0.2689, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:24,  1.78s/it, loss=0.2435, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:13,  1.03s/it, loss=0.2435, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:13,  1.03s/it, loss=0.2817, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:08,  1.47it/s, loss=0.2817, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:08,  1.47it/s, loss=0.2363, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:05,  2.09it/s, loss=0.2363, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:05,  2.09it/s, loss=0.3250, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  2.77it/s, loss=0.3250, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  2.77it/s, loss=0.2713, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.49it/s, loss=0.2713, gradTraining Epoch 5/5:  44%|4| 7/16 [00:05<00:02,  3.49it/s, loss=0.2429, gradTraining Epoch 5/5:  50%|5| 8/16 [00:05<00:01,  4.30it/s, loss=0.2429, gradTraining Epoch 5/5:  50%|5| 8/16 [00:05<00:01,  4.30it/s, loss=0.2747, gradTraining Epoch 5/5:  56%|5| 9/16 [00:05<00:01,  5.17it/s, loss=0.2747, gradTraining Epoch 5/5:  56%|5| 9/16 [00:05<00:01,  5.17it/s, loss=0.2118, gradTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:01,  5.98it/s, loss=0.2118, graTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:01,  5.98it/s, loss=0.2099, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.59it/s, loss=0.2099, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.59it/s, loss=0.1860, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  6.80it/s, loss=0.1860, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  6.80it/s, loss=0.1394, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.10it/s, loss=0.1394, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.10it/s, loss=0.1619, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  7.61it/s, loss=0.1619, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  7.61it/s, loss=0.1653, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  7.70it/s, loss=0.1653, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  7.70it/s, loss=0.0951, graTraining Epoch 5/5: 100%|#| 16/16 [00:06<00:00,  2.45it/s, loss=0.0951, gra

Epoch 5/5 Complete (6.9s) [LR: 0.000005]
Train - Loss: 0.2266, Acc: 0.9754, Precision: 0.9603, Recall: 0.9918, F1: 0.9758, AUC: 0.9886
------------------------------------------------------------
Training curves saved to model\chb20_fold6\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb20_fold6
============================================================
✅ Fold 6 training completed successfully!

============================================================
TRAINING FOLD 7/7
============================================================
Using dataset prefix: chb20_fold7
Loading datasets from: preprocessing\data\chb20_fold7
Saving models to: model\chb20_fold7
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.2323, std=2.1530
Loaded train dataset: 250 samples
  - Spectrogram shape: torch.Size([250, 30, 18, 50, 10])
  - Value range: [-5.6814, 3.8330]
  - Class distribution: tensor([125, 125])
LOOCV Mode (Fold 7): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/7 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6915, grad_norm=1.Training Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.04s/it, loss=0.6915, gradTraining Epoch 1/5:   6%| | 1/16 [00:04<01:00,  4.04s/it, loss=0.6982, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.6982, gradTraining Epoch 1/5:  12%|1| 2/16 [00:04<00:24,  1.73s/it, loss=0.6916, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6916, gradTraining Epoch 1/5:  19%|1| 3/16 [00:04<00:12,  1.01it/s, loss=0.6936, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.6936, gradTraining Epoch 1/5:  25%|2| 4/16 [00:04<00:07,  1.55it/s, loss=0.6921, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:05,  2.19it/s, loss=0.6921, gradTraining Epoch 1/5:  31%|3| 5/16 [00:04<00:05,  2.19it/s, loss=0.6810, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.96it/s, loss=0.6810, gradTraining Epoch 1/5:  38%|3| 6/16 [00:04<00:03,  2.96it/s, loss=0.7031, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.79it/s, loss=0.7031, gradTraining Epoch 1/5:  44%|4| 7/16 [00:04<00:02,  3.79it/s, loss=0.6860, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.57it/s, loss=0.6860, gradTraining Epoch 1/5:  50%|5| 8/16 [00:04<00:01,  4.57it/s, loss=0.6775, gradTraining Epoch 1/5:  56%|5| 9/16 [00:04<00:01,  5.22it/s, loss=0.6775, gradTraining Epoch 1/5:  56%|5| 9/16 [00:05<00:01,  5.22it/s, loss=0.6768, gradTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:01,  5.99it/s, loss=0.6768, graTraining Epoch 1/5:  62%|6| 10/16 [00:05<00:01,  5.99it/s, loss=0.6833, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.68it/s, loss=0.6833, graTraining Epoch 1/5:  69%|6| 11/16 [00:05<00:00,  6.68it/s, loss=0.6647, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.05it/s, loss=0.6647, graTraining Epoch 1/5:  75%|7| 12/16 [00:05<00:00,  7.05it/s, loss=0.6895, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.28it/s, loss=0.6895, graTraining Epoch 1/5:  81%|8| 13/16 [00:05<00:00,  7.28it/s, loss=0.6646, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  7.70it/s, loss=0.6646, graTraining Epoch 1/5:  88%|8| 14/16 [00:05<00:00,  7.70it/s, loss=0.6696, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.06it/s, loss=0.6696, graTraining Epoch 1/5:  94%|9| 15/16 [00:05<00:00,  8.06it/s, loss=0.6536, graTraining Epoch 1/5: 100%|#| 16/16 [00:06<00:00,  2.52it/s, loss=0.6536, gra

Epoch 1/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6823, Acc: 0.5960, Precision: 0.7727, Recall: 0.2720, F1: 0.4024, AUC: 0.6992
------------------------------------------------------------
Training Epoch 2/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.6720, grad_norm=1.Training Epoch 2/5:   6%| | 1/16 [00:04<01:01,  4.08s/it, loss=0.6720, gradTraining Epoch 2/5:   6%| | 1/16 [00:04<01:01,  4.08s/it, loss=0.6481, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.6481, gradTraining Epoch 2/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.6537, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.6537, gradTraining Epoch 2/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.6490, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.53it/s, loss=0.6490, gradTraining Epoch 2/5:  25%|2| 4/16 [00:04<00:07,  1.53it/s, loss=0.6491, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.19it/s, loss=0.6491, gradTraining Epoch 2/5:  31%|3| 5/16 [00:04<00:05,  2.19it/s, loss=0.6203, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.94it/s, loss=0.6203, gradTraining Epoch 2/5:  38%|3| 6/16 [00:04<00:03,  2.94it/s, loss=0.6212, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.69it/s, loss=0.6212, gradTraining Epoch 2/5:  44%|4| 7/16 [00:04<00:02,  3.69it/s, loss=0.6345, gradTraining Epoch 2/5:  50%|5| 8/16 [00:04<00:01,  4.56it/s, loss=0.6345, gradTraining Epoch 2/5:  50%|5| 8/16 [00:05<00:01,  4.56it/s, loss=0.6206, gradTraining Epoch 2/5:  56%|5| 9/16 [00:05<00:01,  5.41it/s, loss=0.6206, gradTraining Epoch 2/5:  56%|5| 9/16 [00:05<00:01,  5.41it/s, loss=0.6206, gradTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.18it/s, loss=0.6206, graTraining Epoch 2/5:  62%|6| 10/16 [00:05<00:00,  6.18it/s, loss=0.5725, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.89it/s, loss=0.5725, graTraining Epoch 2/5:  69%|6| 11/16 [00:05<00:00,  6.89it/s, loss=0.6008, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.24it/s, loss=0.6008, graTraining Epoch 2/5:  75%|7| 12/16 [00:05<00:00,  7.24it/s, loss=0.6030, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.36it/s, loss=0.6030, graTraining Epoch 2/5:  81%|8| 13/16 [00:05<00:00,  7.36it/s, loss=0.6093, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  7.68it/s, loss=0.6093, graTraining Epoch 2/5:  88%|8| 14/16 [00:05<00:00,  7.68it/s, loss=0.5683, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.06it/s, loss=0.5683, graTraining Epoch 2/5:  94%|9| 15/16 [00:05<00:00,  8.06it/s, loss=0.5538, graTraining Epoch 2/5: 100%|#| 16/16 [00:06<00:00,  2.51it/s, loss=0.5538, gra

Epoch 2/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6186, Acc: 0.9080, Precision: 0.8864, Recall: 0.9360, F1: 0.9105, AUC: 0.9529
------------------------------------------------------------
Training Epoch 3/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.5785, grad_norm=2.Training Epoch 3/5:   6%| | 1/16 [00:04<01:01,  4.12s/it, loss=0.5785, gradTraining Epoch 3/5:   6%| | 1/16 [00:04<01:01,  4.12s/it, loss=0.5399, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.77s/it, loss=0.5399, gradTraining Epoch 3/5:  12%|1| 2/16 [00:04<00:24,  1.77s/it, loss=0.5354, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.5354, gradTraining Epoch 3/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.5346, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.52it/s, loss=0.5346, gradTraining Epoch 3/5:  25%|2| 4/16 [00:04<00:07,  1.52it/s, loss=0.5042, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:05,  2.17it/s, loss=0.5042, gradTraining Epoch 3/5:  31%|3| 5/16 [00:04<00:05,  2.17it/s, loss=0.4475, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.90it/s, loss=0.4475, gradTraining Epoch 3/5:  38%|3| 6/16 [00:04<00:03,  2.90it/s, loss=0.5567, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.68it/s, loss=0.5567, gradTraining Epoch 3/5:  44%|4| 7/16 [00:04<00:02,  3.68it/s, loss=0.4500, gradTraining Epoch 3/5:  50%|5| 8/16 [00:04<00:01,  4.55it/s, loss=0.4500, gradTraining Epoch 3/5:  50%|5| 8/16 [00:05<00:01,  4.55it/s, loss=0.5089, gradTraining Epoch 3/5:  56%|5| 9/16 [00:05<00:01,  5.40it/s, loss=0.5089, gradTraining Epoch 3/5:  56%|5| 9/16 [00:05<00:01,  5.40it/s, loss=0.4740, gradTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.21it/s, loss=0.4740, graTraining Epoch 3/5:  62%|6| 10/16 [00:05<00:00,  6.21it/s, loss=0.4165, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.63it/s, loss=0.4165, graTraining Epoch 3/5:  69%|6| 11/16 [00:05<00:00,  6.63it/s, loss=0.4298, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.25it/s, loss=0.4298, graTraining Epoch 3/5:  75%|7| 12/16 [00:05<00:00,  7.25it/s, loss=0.3612, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.76it/s, loss=0.3612, graTraining Epoch 3/5:  81%|8| 13/16 [00:05<00:00,  7.76it/s, loss=0.4540, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.16it/s, loss=0.4540, graTraining Epoch 3/5:  88%|8| 14/16 [00:05<00:00,  8.16it/s, loss=0.3751, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.20it/s, loss=0.3751, graTraining Epoch 3/5:  94%|9| 15/16 [00:05<00:00,  8.20it/s, loss=0.3556, graTraining Epoch 3/5: 100%|#| 16/16 [00:06<00:00,  2.50it/s, loss=0.3556, gra

Epoch 3/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.4701, Acc: 0.9320, Precision: 0.8803, Recall: 1.0000, F1: 0.9363, AUC: 0.9596
------------------------------------------------------------
Training Epoch 4/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.4060, grad_norm=1.Training Epoch 4/5:   6%| | 1/16 [00:04<01:01,  4.13s/it, loss=0.4060, gradTraining Epoch 4/5:   6%| | 1/16 [00:04<01:01,  4.13s/it, loss=0.3331, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.77s/it, loss=0.3331, gradTraining Epoch 4/5:  12%|1| 2/16 [00:04<00:24,  1.77s/it, loss=0.3563, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.3563, gradTraining Epoch 4/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.2605, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.53it/s, loss=0.2605, gradTraining Epoch 4/5:  25%|2| 4/16 [00:04<00:07,  1.53it/s, loss=0.3493, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.3493, gradTraining Epoch 4/5:  31%|3| 5/16 [00:04<00:05,  2.18it/s, loss=0.3005, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.95it/s, loss=0.3005, gradTraining Epoch 4/5:  38%|3| 6/16 [00:04<00:03,  2.95it/s, loss=0.2994, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.79it/s, loss=0.2994, gradTraining Epoch 4/5:  44%|4| 7/16 [00:04<00:02,  3.79it/s, loss=0.2895, gradTraining Epoch 4/5:  50%|5| 8/16 [00:04<00:01,  4.61it/s, loss=0.2895, gradTraining Epoch 4/5:  50%|5| 8/16 [00:05<00:01,  4.61it/s, loss=0.2636, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.34it/s, loss=0.2636, gradTraining Epoch 4/5:  56%|5| 9/16 [00:05<00:01,  5.34it/s, loss=0.1919, gradTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.12it/s, loss=0.1919, graTraining Epoch 4/5:  62%|6| 10/16 [00:05<00:00,  6.12it/s, loss=0.2519, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.81it/s, loss=0.2519, graTraining Epoch 4/5:  69%|6| 11/16 [00:05<00:00,  6.81it/s, loss=0.3241, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.32it/s, loss=0.3241, graTraining Epoch 4/5:  75%|7| 12/16 [00:05<00:00,  7.32it/s, loss=0.5195, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.46it/s, loss=0.5195, graTraining Epoch 4/5:  81%|8| 13/16 [00:05<00:00,  7.46it/s, loss=0.2513, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  7.91it/s, loss=0.2513, graTraining Epoch 4/5:  88%|8| 14/16 [00:05<00:00,  7.91it/s, loss=0.1962, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.26it/s, loss=0.1962, graTraining Epoch 4/5:  94%|9| 15/16 [00:05<00:00,  8.26it/s, loss=0.2661, graTraining Epoch 4/5: 100%|#| 16/16 [00:06<00:00,  2.50it/s, loss=0.2661, gra

Epoch 4/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.3037, Acc: 0.9480, Precision: 0.9058, Recall: 1.0000, F1: 0.9506, AUC: 0.9615
------------------------------------------------------------
Training Epoch 5/5:   0%|                           | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%| | 0/16 [00:04<?, ?it/s, loss=0.1982, grad_norm=1.Training Epoch 5/5:   6%| | 1/16 [00:04<01:01,  4.11s/it, loss=0.1982, gradTraining Epoch 5/5:   6%| | 1/16 [00:04<01:01,  4.11s/it, loss=0.2514, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.2514, gradTraining Epoch 5/5:  12%|1| 2/16 [00:04<00:24,  1.76s/it, loss=0.1670, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.1670, gradTraining Epoch 5/5:  19%|1| 3/16 [00:04<00:13,  1.01s/it, loss=0.2015, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.51it/s, loss=0.2015, gradTraining Epoch 5/5:  25%|2| 4/16 [00:04<00:07,  1.51it/s, loss=0.2284, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:05,  2.15it/s, loss=0.2284, gradTraining Epoch 5/5:  31%|3| 5/16 [00:04<00:05,  2.15it/s, loss=0.2119, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  2.91it/s, loss=0.2119, gradTraining Epoch 5/5:  38%|3| 6/16 [00:04<00:03,  2.91it/s, loss=0.1079, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.69it/s, loss=0.1079, gradTraining Epoch 5/5:  44%|4| 7/16 [00:04<00:02,  3.69it/s, loss=0.2266, gradTraining Epoch 5/5:  50%|5| 8/16 [00:04<00:01,  4.51it/s, loss=0.2266, gradTraining Epoch 5/5:  50%|5| 8/16 [00:05<00:01,  4.51it/s, loss=0.3145, gradTraining Epoch 5/5:  56%|5| 9/16 [00:05<00:01,  5.37it/s, loss=0.3145, gradTraining Epoch 5/5:  56%|5| 9/16 [00:05<00:01,  5.37it/s, loss=0.1553, gradTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.14it/s, loss=0.1553, graTraining Epoch 5/5:  62%|6| 10/16 [00:05<00:00,  6.14it/s, loss=0.1332, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.78it/s, loss=0.1332, graTraining Epoch 5/5:  69%|6| 11/16 [00:05<00:00,  6.78it/s, loss=0.0921, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.39it/s, loss=0.0921, graTraining Epoch 5/5:  75%|7| 12/16 [00:05<00:00,  7.39it/s, loss=0.2345, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.85it/s, loss=0.2345, graTraining Epoch 5/5:  81%|8| 13/16 [00:05<00:00,  7.85it/s, loss=0.1114, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.23it/s, loss=0.1114, graTraining Epoch 5/5:  88%|8| 14/16 [00:05<00:00,  8.23it/s, loss=0.1044, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.51it/s, loss=0.1044, graTraining Epoch 5/5:  94%|9| 15/16 [00:05<00:00,  8.51it/s, loss=0.1046, graTraining Epoch 5/5: 100%|#| 16/16 [00:06<00:00,  2.52it/s, loss=0.1046, gra

Epoch 5/5 Complete (6.8s) [LR: 0.000005]
Train - Loss: 0.1777, Acc: 0.9600, Precision: 0.9259, Recall: 1.0000, F1: 0.9615, AUC: 0.9833
------------------------------------------------------------
Training curves saved to model\chb20_fold7\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb20_fold7
============================================================
✅ Fold 7 training completed successfully!

============================================================
✅ BATCH TRAINING COMPLETED!
✅ Trained models for 8 folds for patient chb20
============================================================
============================================================
============================================================
BATCH EVALUATION: ALL FOLDS
BATCH EVALUATION: ALL FOLDS
Evaluating 8 folds for patient chb20
Evaluating 8 folds for patient chb20
============================================================
============================================================
Using CUDA: NVIDIA GeForce RTX 3090 Ti
Using CUDA: NVIDIA GeForce RTX 3090 Ti

============================================================
============================================================

EVALUATING FOLD 0/7
EVALUATING FOLD 0/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb20_fold0
Dataset prefix: chb20_fold0
Using test dataset: preprocessing\data\chb20_fold0\test_dataset.h5
Using test dataset: preprocessing\data\chb20_fold0\test_dataset.h5
Loading test dataset from preprocessing\data\chb20_fold0\test_dataset.h5...
Loading test dataset from preprocessing\data\chb20_fold0\test_dataset.h5...
  - Normalization: z-score, mean=0.2185, std=2.1591
  - Normalization: z-score, mean=0.2185, std=2.1591
Loaded test dataset: 223 samples
Loaded test dataset: 223 samples
  - Spectrogram shape: torch.Size([223, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([223, 30, 18, 50, 10])
  - Value range: [-5.6592, 3.9116]
  - Value range: [-5.6592, 3.9116]
  - Class distribution: tensor([223])
  - Class distribution: tensor([223])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb20_fold0\epoch_005.pth...
Loading model checkpoint from model\chb20_fold0\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                      | 0/14 [00:00<?, ?it/s]Testing:   0%|                                      | 0/14 [00:00<?, ?it/s]Testing:   7%|##1                           | 1/14 [00:00<00:02,  4.58it/s]Testing:   7%|##1                           | 1/14 [00:00<00:02,  4.58it/s]Testing:  29%|########5                     | 4/14 [00:00<00:00, 14.12it/s]Testing:  29%|########5                     | 4/14 [00:00<00:00, 14.12it/s]Testing:  57%|#################1            | 8/14 [00:00<00:00, 21.41it/s]Testing:  57%|#################1            | 8/14 [00:00<00:00, 21.41it/s]Testing:  86%|########################8    | 12/14 [00:00<00:00, 25.33it/s]Testing:  86%|########################8    | 12/14 [00:00<00:00, 25.33it/s]Testing: 100%|#############################| 14/14 [00:00<00:00, 21.66it/s]Testing: 100%|#############################| 14/14 [00:00<00:00, 21.66it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0968
Loss:      0.0968
Accuracy:  0.9821 (98.21%)
Accuracy:  0.9821 (98.21%)
Precision: 0.0000
Precision: 0.0000
Recall:    0.0000
Recall:    0.0000
F1 Score:  0.0000
F1 Score:  0.0000
AUC-ROC:   0.0000
AUC-ROC:   0.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal       219         4
Actual Interictal       219         4
       Preictal         0         0
       Preictal         0         0

Class Distribution:
Class Distribution:

True Interictal (0): 223 samples
True Interictal (0): 223 samples
True Preictal (1):   0 samples
True Preictal (1):   0 samples
Pred Interictal (0): 219 samples
Pred Interictal (0): 219 samples
Pred Preictal (1):   4 samples
Pred Preictal (1):   4 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9821    0.9910       223
    Preictal     0.0000    0.0000    0.0000         0

    accuracy                         0.9821       223
   macro avg     0.5000    0.4910    0.4955       223
weighted avg     1.0000    0.9821    0.9910       223
              precision    recall  f1-score   support

  Interictal     1.0000    0.9821    0.9910       223
    Preictal     0.0000    0.0000    0.0000         0

    accuracy                         0.9821       223
   macro avg     0.5000    0.4910    0.4955       223
weighted avg     1.0000    0.9821    0.9910       223



✅ Results saved to model\chb20_fold0\test_results.json
✅ Results saved to model\chb20_fold0\test_results.json


============================================================
============================================================

EVALUATING FOLD 1/7
EVALUATING FOLD 1/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb20_fold1
Dataset prefix: chb20_fold1
Using test dataset: preprocessing\data\chb20_fold1\test_dataset.h5
Using test dataset: preprocessing\data\chb20_fold1\test_dataset.h5
Loading test dataset from preprocessing\data\chb20_fold1\test_dataset.h5...
Loading test dataset from preprocessing\data\chb20_fold1\test_dataset.h5...
  - Normalization: z-score, mean=0.2104, std=2.1654
  - Normalization: z-score, mean=0.2104, std=2.1654
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.6390, 3.7821]
  - Value range: [-5.6390, 3.7821]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb20_fold1\epoch_005.pth...
Loading model checkpoint from model\chb20_fold1\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 31.15it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 31.15it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1924
Loss:      0.1924
Accuracy:  0.9545 (95.45%)
Accuracy:  0.9545 (95.45%)
Precision: 0.9167
Precision: 0.9167
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9565
F1 Score:  0.9565
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        20         2
Actual Interictal        20         2
       Preictal         0        22
       Preictal         0        22

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 20 samples
Pred Interictal (0): 20 samples
Pred Preictal (1):   24 samples
Pred Preictal (1):   24 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9091    0.9524        22
    Preictal     0.9167    1.0000    0.9565        22

    accuracy                         0.9545        44
   macro avg     0.9583    0.9545    0.9545        44
weighted avg     0.9583    0.9545    0.9545        44
              precision    recall  f1-score   support

  Interictal     1.0000    0.9091    0.9524        22
    Preictal     0.9167    1.0000    0.9565        22

    accuracy                         0.9545        44
   macro avg     0.9583    0.9545    0.9545        44
weighted avg     0.9583    0.9545    0.9545        44



✅ Results saved to model\chb20_fold1\test_results.json
✅ Results saved to model\chb20_fold1\test_results.json


============================================================
============================================================

EVALUATING FOLD 2/7
EVALUATING FOLD 2/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb20_fold2
Dataset prefix: chb20_fold2
Using test dataset: preprocessing\data\chb20_fold2\test_dataset.h5
Using test dataset: preprocessing\data\chb20_fold2\test_dataset.h5
Loading test dataset from preprocessing\data\chb20_fold2\test_dataset.h5...
Loading test dataset from preprocessing\data\chb20_fold2\test_dataset.h5...
  - Normalization: z-score, mean=0.2267, std=2.1563
  - Normalization: z-score, mean=0.2267, std=2.1563
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-5.6704, 3.4942]
  - Value range: [-5.6704, 3.4942]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb20_fold2\epoch_005.pth...
Loading model checkpoint from model\chb20_fold2\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.96it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.96it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.88it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 29.88it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1079
Loss:      0.1079
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        24         0
Actual Interictal        24         0
       Preictal         0        24
       Preictal         0        24

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 24 samples
Pred Interictal (0): 24 samples
Pred Preictal (1):   24 samples
Pred Preictal (1):   24 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        24
    Preictal     1.0000    1.0000    1.0000        24

    accuracy                         1.0000        48
   macro avg     1.0000    1.0000    1.0000        48
weighted avg     1.0000    1.0000    1.0000        48
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        24
    Preictal     1.0000    1.0000    1.0000        24

    accuracy                         1.0000        48
   macro avg     1.0000    1.0000    1.0000        48
weighted avg     1.0000    1.0000    1.0000        48



✅ Results saved to model\chb20_fold2\test_results.json
✅ Results saved to model\chb20_fold2\test_results.json


============================================================
============================================================

EVALUATING FOLD 3/7
EVALUATING FOLD 3/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb20_fold3
Dataset prefix: chb20_fold3
Using test dataset: preprocessing\data\chb20_fold3\test_dataset.h5
Using test dataset: preprocessing\data\chb20_fold3\test_dataset.h5
Loading test dataset from preprocessing\data\chb20_fold3\test_dataset.h5...
Loading test dataset from preprocessing\data\chb20_fold3\test_dataset.h5...
  - Normalization: z-score, mean=0.2450, std=2.1339
  - Normalization: z-score, mean=0.2450, std=2.1339
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.7380, 3.9472]
  - Value range: [-5.7380, 3.9472]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb20_fold3\epoch_005.pth...
Loading model checkpoint from model\chb20_fold3\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 33.41it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 33.41it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.2628
Loss:      0.2628
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        19         0
Actual Interictal        19         0
       Preictal         0        19
       Preictal         0        19

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 19 samples
Pred Interictal (0): 19 samples
Pred Preictal (1):   19 samples
Pred Preictal (1):   19 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        19
    Preictal     1.0000    1.0000    1.0000        19

    accuracy                         1.0000        38
   macro avg     1.0000    1.0000    1.0000        38
weighted avg     1.0000    1.0000    1.0000        38
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        19
    Preictal     1.0000    1.0000    1.0000        19

    accuracy                         1.0000        38
   macro avg     1.0000    1.0000    1.0000        38
weighted avg     1.0000    1.0000    1.0000        38



✅ Results saved to model\chb20_fold3\test_results.json
✅ Results saved to model\chb20_fold3\test_results.json


============================================================
============================================================

EVALUATING FOLD 4/7
EVALUATING FOLD 4/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb20_fold4
Dataset prefix: chb20_fold4
Using test dataset: preprocessing\data\chb20_fold4\test_dataset.h5
Using test dataset: preprocessing\data\chb20_fold4\test_dataset.h5
Loading test dataset from preprocessing\data\chb20_fold4\test_dataset.h5...
Loading test dataset from preprocessing\data\chb20_fold4\test_dataset.h5...
  - Normalization: z-score, mean=0.2695, std=2.1434
  - Normalization: z-score, mean=0.2695, std=2.1434
Loaded test dataset: 30 samples
Loaded test dataset: 30 samples
  - Spectrogram shape: torch.Size([30, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([30, 30, 18, 50, 10])
  - Value range: [-5.7127, 3.6212]
  - Value range: [-5.7127, 3.6212]
  - Class distribution: tensor([15, 15])
  - Class distribution: tensor([15, 15])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb20_fold4\epoch_005.pth...
Loading model checkpoint from model\chb20_fold4\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/2 [00:00<?, ?it/s]Testing:   0%|                                       | 0/2 [00:00<?, ?it/s]Testing: 100%|###############################| 2/2 [00:00<00:00, 29.43it/s]Testing: 100%|###############################| 2/2 [00:00<00:00, 29.43it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1693
Loss:      0.1693
Accuracy:  0.9333 (93.33%)
Accuracy:  0.9333 (93.33%)
Precision: 0.8824
Precision: 0.8824
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9375
F1 Score:  0.9375
AUC-ROC:   0.9467
AUC-ROC:   0.9467

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        13         2
Actual Interictal        13         2
       Preictal         0        15
       Preictal         0        15

Class Distribution:
Class Distribution:

True Interictal (0): 15 samples
True Interictal (0): 15 samples
True Preictal (1):   15 samples
True Preictal (1):   15 samples
Pred Interictal (0): 13 samples
Pred Interictal (0): 13 samples
Pred Preictal (1):   17 samples
Pred Preictal (1):   17 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.8667    0.9286        15
    Preictal     0.8824    1.0000    0.9375        15

    accuracy                         0.9333        30
   macro avg     0.9412    0.9333    0.9330        30
weighted avg     0.9412    0.9333    0.9330        30
              precision    recall  f1-score   support

  Interictal     1.0000    0.8667    0.9286        15
    Preictal     0.8824    1.0000    0.9375        15

    accuracy                         0.9333        30
   macro avg     0.9412    0.9333    0.9330        30
weighted avg     0.9412    0.9333    0.9330        30



✅ Results saved to model\chb20_fold4\test_results.json
✅ Results saved to model\chb20_fold4\test_results.json


============================================================
============================================================

EVALUATING FOLD 5/7
EVALUATING FOLD 5/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb20_fold5
Dataset prefix: chb20_fold5
Using test dataset: preprocessing\data\chb20_fold5\test_dataset.h5
Using test dataset: preprocessing\data\chb20_fold5\test_dataset.h5
Loading test dataset from preprocessing\data\chb20_fold5\test_dataset.h5...
Loading test dataset from preprocessing\data\chb20_fold5\test_dataset.h5...
  - Normalization: z-score, mean=0.2272, std=2.1580
  - Normalization: z-score, mean=0.2272, std=2.1580
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.6661, 3.8742]
  - Value range: [-5.6661, 3.8742]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb20_fold5\epoch_005.pth...
Loading model checkpoint from model\chb20_fold5\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 31.84it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 31.84it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1367
Loss:      0.1367
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        22         0
Actual Interictal        22         0
       Preictal         0        22
       Preictal         0        22

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 22 samples
Pred Interictal (0): 22 samples
Pred Preictal (1):   22 samples
Pred Preictal (1):   22 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        22
    Preictal     1.0000    1.0000    1.0000        22

    accuracy                         1.0000        44
   macro avg     1.0000    1.0000    1.0000        44
weighted avg     1.0000    1.0000    1.0000        44
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        22
    Preictal     1.0000    1.0000    1.0000        22

    accuracy                         1.0000        44
   macro avg     1.0000    1.0000    1.0000        44
weighted avg     1.0000    1.0000    1.0000        44



✅ Results saved to model\chb20_fold5\test_results.json
✅ Results saved to model\chb20_fold5\test_results.json


============================================================
============================================================

EVALUATING FOLD 6/7
EVALUATING FOLD 6/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb20_fold6
Dataset prefix: chb20_fold6
Using test dataset: preprocessing\data\chb20_fold6\test_dataset.h5
Using test dataset: preprocessing\data\chb20_fold6\test_dataset.h5
Loading test dataset from preprocessing\data\chb20_fold6\test_dataset.h5...
Loading test dataset from preprocessing\data\chb20_fold6\test_dataset.h5...
  - Normalization: z-score, mean=0.1749, std=2.1718
  - Normalization: z-score, mean=0.1749, std=2.1718
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.6060, 3.5440]
  - Value range: [-5.6060, 3.5440]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb20_fold6\epoch_005.pth...
Loading model checkpoint from model\chb20_fold6\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 30.00it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 30.00it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1510
Loss:      0.1510
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        23         0
Actual Interictal        23         0
       Preictal         0        23
       Preictal         0        23

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 23 samples
Pred Interictal (0): 23 samples
Pred Preictal (1):   23 samples
Pred Preictal (1):   23 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        23
    Preictal     1.0000    1.0000    1.0000        23

    accuracy                         1.0000        46
   macro avg     1.0000    1.0000    1.0000        46
weighted avg     1.0000    1.0000    1.0000        46
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        23
    Preictal     1.0000    1.0000    1.0000        23

    accuracy                         1.0000        46
   macro avg     1.0000    1.0000    1.0000        46
weighted avg     1.0000    1.0000    1.0000        46



✅ Results saved to model\chb20_fold6\test_results.json
✅ Results saved to model\chb20_fold6\test_results.json


============================================================
============================================================

EVALUATING FOLD 7/7
EVALUATING FOLD 7/7
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb20_fold7
Dataset prefix: chb20_fold7
Using test dataset: preprocessing\data\chb20_fold7\test_dataset.h5
Using test dataset: preprocessing\data\chb20_fold7\test_dataset.h5
Loading test dataset from preprocessing\data\chb20_fold7\test_dataset.h5...
Loading test dataset from preprocessing\data\chb20_fold7\test_dataset.h5...
  - Normalization: z-score, mean=0.2323, std=2.1530
  - Normalization: z-score, mean=0.2323, std=2.1530
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.6814, 3.9475]
  - Value range: [-5.6814, 3.9475]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb20_fold7\epoch_005.pth...
Loading model checkpoint from model\chb20_fold7\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing:   0%|                                       | 0/3 [00:00<?, ?it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.01it/s]Testing: 100%|###############################| 3/3 [00:00<00:00, 34.01it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.0955
Loss:      0.0955
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        20         0
Actual Interictal        20         0
       Preictal         0        20
       Preictal         0        20

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 20 samples
Pred Interictal (0): 20 samples
Pred Preictal (1):   20 samples
Pred Preictal (1):   20 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        20
    Preictal     1.0000    1.0000    1.0000        20

    accuracy                         1.0000        40
   macro avg     1.0000    1.0000    1.0000        40
weighted avg     1.0000    1.0000    1.0000        40
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        20
    Preictal     1.0000    1.0000    1.0000        20

    accuracy                         1.0000        40
   macro avg     1.0000    1.0000    1.0000        40
weighted avg     1.0000    1.0000    1.0000        40



✅ Results saved to model\chb20_fold7\test_results.json
✅ Results saved to model\chb20_fold7\test_results.json


============================================================
============================================================

BATCH EVALUATION SUMMARY
BATCH EVALUATION SUMMARY
============================================================
============================================================
Folds evaluated: 8/8
Folds evaluated: 8/8

Mean metrics (across folds):
Mean metrics (across folds):

  Accuracy:  0.9837 (±0.0243)
  Accuracy:  0.9837 (±0.0243)
  Precision: 0.8499 (±0.3241)
  Precision: 0.8499 (±0.3241)
  Recall:    0.8750 (±0.3307)
  Recall:    0.8750 (±0.3307)
  F1 Score:  0.8618 (±0.3265)
  F1 Score:  0.8618 (±0.3265)
  AUC-ROC:   0.8683 (±0.3287)
  AUC-ROC:   0.8683 (±0.3287)

✅ Batch results saved to model\batch_test_results.json
✅ Batch results saved to model\batch_test_results.json

============================================================
============================================================
