============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb23
============================================================

Configuration:
  - Task mode: PREDICTION (preictal vs interictal)
  - LOOCV Mode: ENABLED
  - Sequence length: 30 segments
  - Sequence duration: 150s (2.5 min)
  - Stride: 5 segments (83% overlap)
  - Segment duration: 5s
  - Preictal window: 10 min
  - Interictal buffer: 120 min
  - Channel validation: ENABLED
  - Target channels: 18 channels
============================================================

Extracting sequences from patient chb23...
Patient chb23: 526 sequences (142 preictal, 384 interictal)

============================================================
PROCESSING FOLD 0/6
============================================================
Output prefix: chb23_fold0
LOOCV Fold 0: Test seizure=0, Train seizures=[1, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 284
  - Preictal sequences: 142
  - Interictal sequences: 142
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb23: 284 total (142 preictal, 142 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 42 total (21 preictal, 21 interictal)
train: 242 total (121 preictal, 121 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 260.0s (4.3 min)
Class balance: 142/142 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 121 preictal, 121 interictal (dropped 0 preictal, 71 interictal)
test: 21 preictal, 21 interictal (dropped 0 preictal, 171 interictal)

Sequences saved to chb23_fold0_sequences_prediction.json
File size: 0.48 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 9
Files with valid channels: 9
Files with invalid channels: 0

✅ Fold 0 completed successfully!
✅ Sequences saved to chb23_fold0_sequences_prediction.json

============================================================
PROCESSING FOLD 1/6
============================================================
Output prefix: chb23_fold1
LOOCV Fold 1: Test seizure=1, Train seizures=[0, 2, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 284
  - Preictal sequences: 142
  - Interictal sequences: 142
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb23: 284 total (142 preictal, 142 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 26 total (13 preictal, 13 interictal)
train: 258 total (129 preictal, 129 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 260.0s (4.3 min)
Class balance: 142/142 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 129 preictal, 129 interictal (dropped 0 preictal, 63 interictal)
test: 13 preictal, 13 interictal (dropped 0 preictal, 179 interictal)

Sequences saved to chb23_fold1_sequences_prediction.json
File size: 0.48 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 9
Files with valid channels: 9
Files with invalid channels: 0

✅ Fold 1 completed successfully!
✅ Sequences saved to chb23_fold1_sequences_prediction.json

============================================================
PROCESSING FOLD 2/6
============================================================
Output prefix: chb23_fold2
LOOCV Fold 2: Test seizure=2, Train seizures=[0, 1, 3, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 284
  - Preictal sequences: 142
  - Interictal sequences: 142
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb23: 284 total (142 preictal, 142 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 48 total (24 preictal, 24 interictal)
train: 236 total (118 preictal, 118 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 260.0s (4.3 min)
Class balance: 142/142 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 118 preictal, 118 interictal (dropped 0 preictal, 74 interictal)
test: 24 preictal, 24 interictal (dropped 0 preictal, 168 interictal)

Sequences saved to chb23_fold2_sequences_prediction.json
File size: 0.48 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 9
Files with valid channels: 9
Files with invalid channels: 0

✅ Fold 2 completed successfully!
✅ Sequences saved to chb23_fold2_sequences_prediction.json

============================================================
PROCESSING FOLD 3/6
============================================================
Output prefix: chb23_fold3
LOOCV Fold 3: Test seizure=3, Train seizures=[0, 1, 2, 4, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 284
  - Preictal sequences: 142
  - Interictal sequences: 142
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb23: 284 total (142 preictal, 142 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 40 total (20 preictal, 20 interictal)
train: 244 total (122 preictal, 122 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 260.0s (4.3 min)
Class balance: 142/142 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 122 preictal, 122 interictal (dropped 0 preictal, 70 interictal)
test: 20 preictal, 20 interictal (dropped 0 preictal, 172 interictal)

Sequences saved to chb23_fold3_sequences_prediction.json
File size: 0.48 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 9
Files with valid channels: 9
Files with invalid channels: 0

✅ Fold 3 completed successfully!
✅ Sequences saved to chb23_fold3_sequences_prediction.json

============================================================
PROCESSING FOLD 4/6
============================================================
Output prefix: chb23_fold4
LOOCV Fold 4: Test seizure=4, Train seizures=[0, 1, 2, 3, 5, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 284
  - Preictal sequences: 142
  - Interictal sequences: 142
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb23: 284 total (142 preictal, 142 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 44 total (22 preictal, 22 interictal)
train: 240 total (120 preictal, 120 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 260.0s (4.3 min)
Class balance: 142/142 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 120 preictal, 120 interictal (dropped 0 preictal, 72 interictal)
test: 22 preictal, 22 interictal (dropped 0 preictal, 170 interictal)

Sequences saved to chb23_fold4_sequences_prediction.json
File size: 0.48 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 9
Files with valid channels: 9
Files with invalid channels: 0

✅ Fold 4 completed successfully!
✅ Sequences saved to chb23_fold4_sequences_prediction.json

============================================================
PROCESSING FOLD 5/6
============================================================
Output prefix: chb23_fold5
LOOCV Fold 5: Test seizure=5, Train seizures=[0, 1, 2, 3, 4, 6]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 284
  - Preictal sequences: 142
  - Interictal sequences: 142
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb23: 284 total (142 preictal, 142 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 46 total (23 preictal, 23 interictal)
train: 238 total (119 preictal, 119 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 260.0s (4.3 min)
Class balance: 142/142 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 119 preictal, 119 interictal (dropped 0 preictal, 73 interictal)
test: 23 preictal, 23 interictal (dropped 0 preictal, 169 interictal)

Sequences saved to chb23_fold5_sequences_prediction.json
File size: 0.48 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 9
Files with valid channels: 9
Files with invalid channels: 0

✅ Fold 5 completed successfully!
✅ Sequences saved to chb23_fold5_sequences_prediction.json

============================================================
PROCESSING FOLD 6/6
============================================================
Output prefix: chb23_fold6
LOOCV Fold 6: Test seizure=6, Train seizures=[0, 1, 2, 3, 4, 5]

============================================================
FOLD SPLIT SUMMARY
============================================================

=== OVERALL SUMMARY ===
Task mode: PREDICTION
Total sequences: 284
  - Preictal sequences: 142
  - Interictal sequences: 142
Sequence configuration:
  - Segments per sequence: 30
  - Sequence duration: 150s (2.5 min)
  - Sequence stride: 5 segments (25s)
  - Preictal window: 10 min
  - Interictal buffer: 120 min

=== PER-PATIENT BREAKDOWN ===
Patients processed: 1
chb23: 284 total (142 preictal, 142 interictal)

=== PER-SPLIT BREAKDOWN ===
test: 38 total (19 preictal, 19 interictal)
train: 246 total (123 preictal, 123 interictal)

=== STATISTICS ===
Average time to seizure (preictal): 260.0s (4.3 min)
Class balance: 142/142 = 1.00

=== SPLIT BALANCING SUMMARY ===
train: 123 preictal, 123 interictal (dropped 0 preictal, 69 interictal)
test: 19 preictal, 19 interictal (dropped 0 preictal, 173 interictal)

Sequences saved to chb23_fold6_sequences_prediction.json
File size: 0.48 MB

=== CHANNEL VALIDATION SUMMARY ===
Validation enabled: True
Files checked: 9
Files with valid channels: 9
Files with invalid channels: 0

✅ Fold 6 completed successfully!
✅ Sequences saved to chb23_fold6_sequences_prediction.json

============================================================
✅ BATCH PROCESSING COMPLETED!
✅ Processed 7 folds for patient chb23
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb23
============================================================

============================================================
PREPROCESSING FOLD 0/6
============================================================
2025-11-21 11:14:14,613 - INFO - ============================================================
2025-11-21 11:14:14,613 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-21 11:14:14,613 - INFO - ============================================================
2025-11-21 11:14:14,613 - INFO - Output prefix: chb23_fold0
2025-11-21 11:14:14,613 - INFO - EEG Preprocessor initialized
2025-11-21 11:14:14,613 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-21 11:14:14,613 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-21 11:14:14,613 - INFO - Segment duration: 5 seconds
2025-11-21 11:14:14,613 - INFO - Note: Channel validation performed during segmentation phase
2025-11-21 11:14:14,613 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-21 11:14:14,613 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-21 11:14:14,613 - INFO - Loading segments from chb23_fold0_sequences_prediction.json
2025-11-21 11:14:14,627 - INFO - Loaded 284 total sequences
2025-11-21 11:14:14,627 - INFO - Channel validation (from segmentation): 9/9 files valid
2025-11-21 11:14:14,627 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-21 11:14:14,627 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-21 11:14:14,627 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-21 11:14:14,628 - INFO - train: 242 sequences (121 preictal, 121 interictal)
2025-11-21 11:14:14,628 - INFO - test: 42 sequences (21 preictal, 21 interictal)
2025-11-21 11:14:14,643 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-21 11:14:14,643 - INFO - train: kept 121 preictal and 121 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:14:14,643 - INFO - test: kept 21 preictal and 21 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:14:14,659 - INFO - ============================================================
2025-11-21 11:14:14,659 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-21 11:14:14,659 - INFO - ============================================================
2025-11-21 11:14:14,659 - INFO - Processing 242 training samples to compute normalization stats...
2025-11-21 11:14:14,659 - INFO - Processing 242 sequences from 8 unique files
Processing training data:   0%|                    | 0/242 [00:00<?, ?it/s]Processing training data:   0%|            | 1/242 [00:07<31:06,  7.75s/it]Processing training data:  15%|#6         | 37/242 [00:11<00:53,  3.87it/s]Processing training data:  50%|#####     | 121/242 [00:17<00:14,  8.63it/s]Processing training data:  63%|######3   | 153/242 [00:23<00:11,  7.65it/s]Processing training data:  72%|#######1  | 174/242 [00:25<00:08,  7.72it/s]Processing training data:  85%|########4 | 205/242 [00:27<00:03,  9.43it/s]Processing training data:  88%|########8 | 213/242 [00:33<00:04,  6.00it/s]Processing training data:  98%|#########7| 237/242 [00:33<00:00,  8.38it/s]Processing training data: 100%|##########| 242/242 [00:33<00:00,  7.25it/s]
2025-11-21 11:14:48,020 - INFO - Computing normalization statistics from training data...
2025-11-21 11:14:48,424 - INFO - Normalization stats computed:
2025-11-21 11:14:48,424 - INFO -   Mean: 0.119023
2025-11-21 11:14:48,424 - INFO -   Std: 2.141738
2025-11-21 11:14:48,424 - INFO -   Saved to: preprocessing\checkpoints\chb23_fold0\normalization_stats.json
2025-11-21 11:14:48,449 - INFO - Applying normalization and saving 242 training sequences...
Normalizing and saving training data:   0%|        | 0/242 [00:00<?, ?it/s]2025-11-21 11:14:48,456 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold0\train_dataset.h5
Normalizing and saving training data:   4%| | 10/242 [00:00<00:14, 15.53it/Normalizing and saving training data:   8%| | 20/242 [00:01<00:14, 15.34it/Normalizing and saving training data:  12%|1| 30/242 [00:01<00:14, 15.02it/Normalizing and saving training data:  17%|1| 40/242 [00:02<00:13, 15.10it/Normalizing and saving training data:  21%|2| 50/242 [00:03<00:12, 15.23it/Normalizing and saving training data:  25%|2| 60/242 [00:03<00:11, 15.29it/Normalizing and saving training data:  29%|2| 70/242 [00:04<00:11, 15.25it/Normalizing and saving training data:  33%|3| 80/242 [00:05<00:10, 15.31it/Normalizing and saving training data:  37%|3| 90/242 [00:05<00:09, 15.32it/Normalizing and saving training data:  41%|4| 100/242 [00:06<00:09, 15.30itNormalizing and saving training data:  45%|4| 110/242 [00:07<00:08, 15.33itNormalizing and saving training data:  50%|4| 120/242 [00:07<00:07, 15.29itNormalizing and saving training data:  54%|5| 130/242 [00:08<00:07, 15.28itNormalizing and saving training data:  58%|5| 140/242 [00:09<00:06, 15.46itNormalizing and saving training data:  62%|6| 150/242 [00:09<00:06, 15.18itNormalizing and saving training data:  66%|6| 160/242 [00:10<00:05, 15.42itNormalizing and saving training data:  70%|7| 170/242 [00:11<00:04, 15.50itNormalizing and saving training data:  74%|7| 180/242 [00:11<00:03, 15.52itNormalizing and saving training data:  79%|7| 190/242 [00:12<00:03, 15.65itNormalizing and saving training data:  83%|8| 200/242 [00:12<00:02, 15.72itNormalizing and saving training data:  87%|8| 210/242 [00:13<00:02, 15.80itNormalizing and saving training data:  91%|9| 220/242 [00:14<00:01, 15.82itNormalizing and saving training data:  95%|9| 230/242 [00:14<00:00, 15.83itNormalizing and saving training data:  99%|9| 240/242 [00:15<00:00, 15.86itNormalizing and saving training data: 100%|#| 242/242 [00:15<00:00, 15.61it
2025-11-21 11:15:04,118 - INFO - Training data processing completed during stats computation phase
2025-11-21 11:15:04,125 - INFO - Loaded normalization statistics:
2025-11-21 11:15:04,125 - INFO -   Mean: 0.119023
2025-11-21 11:15:04,125 - INFO -   Std: 2.141738
2025-11-21 11:15:04,125 - INFO - Split train already completed, skipping
2025-11-21 11:15:04,125 - INFO - Processing test split...
2025-11-21 11:15:04,125 - INFO - Need to process 42/42 sequences for test
2025-11-21 11:15:04,125 - INFO - Processing 42 sequences from 5 unique files
2025-11-21 11:15:04,125 - INFO - Average 8.4 sequences per file
Processing test:   0%|                              | 0/42 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/42 [00:00<00:29,  1.38it/s]2025-11-21 11:15:04,852 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold0\test_dataset.h5
2025-11-21 11:15:06,093 - INFO - Progress: 263/284 (92.6%) - ETA: 0.1 minutes
Processing test:  52%|###########          | 22/42 [00:05<00:04,  4.41it/s]Processing test:  67%|##############       | 28/42 [00:07<00:03,  3.83it/s]Processing test:  71%|###############      | 30/42 [00:12<00:06,  1.77it/s]2025-11-21 11:15:17,913 - INFO - Progress: 277/284 (97.5%) - ETA: 0.0 minutes
Processing test:  86%|##################   | 36/42 [00:18<00:04,  1.40it/s]Processing test: 100%|#####################| 42/42 [00:18<00:00,  2.22it/s]
2025-11-21 11:15:23,531 - INFO - Validating final datasets...
2025-11-21 11:15:23,539 - INFO - train dataset validation:
2025-11-21 11:15:23,539 - INFO -   - Segments: 242
2025-11-21 11:15:23,539 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:15:23,539 - INFO -   - Classes: 121 preictal, 121 interictal
2025-11-21 11:15:23,539 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:15:23,544 - INFO - test dataset validation:
2025-11-21 11:15:23,545 - INFO -   - Segments: 42
2025-11-21 11:15:23,545 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:15:23,545 - INFO -   - Classes: 21 preictal, 21 interictal
2025-11-21 11:15:23,545 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:15:23,545 - INFO - ============================================================
2025-11-21 11:15:23,545 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-21 11:15:23,545 - INFO - Total time: 1.1 minutes
2025-11-21 11:15:23,545 - INFO - Processed segments: 284
2025-11-21 11:15:23,545 - INFO - Average rate: 4.1 segments/second
2025-11-21 11:15:23,545 - INFO - ============================================================
✅ Fold 0 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 1/6
============================================================
2025-11-21 11:15:23,569 - INFO - ============================================================
2025-11-21 11:15:23,569 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-21 11:15:23,569 - INFO - ============================================================
2025-11-21 11:15:23,569 - INFO - Output prefix: chb23_fold1
2025-11-21 11:15:23,569 - INFO - EEG Preprocessor initialized
2025-11-21 11:15:23,569 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-21 11:15:23,569 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-21 11:15:23,570 - INFO - Segment duration: 5 seconds
2025-11-21 11:15:23,570 - INFO - Note: Channel validation performed during segmentation phase
2025-11-21 11:15:23,570 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-21 11:15:23,570 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-21 11:15:23,570 - INFO - Loading segments from chb23_fold1_sequences_prediction.json
2025-11-21 11:15:23,582 - INFO - Loaded 284 total sequences
2025-11-21 11:15:23,582 - INFO - Channel validation (from segmentation): 9/9 files valid
2025-11-21 11:15:23,582 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-21 11:15:23,582 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-21 11:15:23,582 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-21 11:15:23,582 - INFO - train: 258 sequences (129 preictal, 129 interictal)
2025-11-21 11:15:23,582 - INFO - test: 26 sequences (13 preictal, 13 interictal)
2025-11-21 11:15:23,598 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-21 11:15:23,598 - INFO - train: kept 129 preictal and 129 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:15:23,598 - INFO - test: kept 13 preictal and 13 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:15:23,617 - INFO - ============================================================
2025-11-21 11:15:23,618 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-21 11:15:23,618 - INFO - ============================================================
2025-11-21 11:15:23,618 - INFO - Processing 258 training samples to compute normalization stats...
2025-11-21 11:15:23,618 - INFO - Processing 258 sequences from 8 unique files
Processing training data:   0%|                    | 0/258 [00:00<?, ?it/s]Processing training data:   0%|            | 1/258 [00:06<27:34,  6.44s/it]Processing training data:  14%|#4         | 35/258 [00:12<01:10,  3.15it/s]Processing training data:  25%|##7        | 65/258 [00:16<00:41,  4.62it/s]Processing training data:  58%|#####7    | 149/258 [00:22<00:12,  8.77it/s]Processing training data:  68%|######8   | 176/258 [00:23<00:07, 10.72it/s]Processing training data:  76%|#######6  | 197/258 [00:24<00:05, 12.03it/s]Processing training data:  86%|########5 | 221/258 [00:29<00:04,  8.40it/s]Processing training data:  96%|#########6| 248/258 [00:31<00:01,  9.57it/s]Processing training data: 100%|##########| 258/258 [00:31<00:00,  8.17it/s]
2025-11-21 11:15:55,214 - INFO - Computing normalization statistics from training data...
2025-11-21 11:15:55,556 - INFO - Normalization stats computed:
2025-11-21 11:15:55,556 - INFO -   Mean: 0.136712
2025-11-21 11:15:55,556 - INFO -   Std: 2.121531
2025-11-21 11:15:55,556 - INFO -   Saved to: preprocessing\checkpoints\chb23_fold1\normalization_stats.json
2025-11-21 11:15:55,581 - INFO - Applying normalization and saving 258 training sequences...
Normalizing and saving training data:   0%|        | 0/258 [00:00<?, ?it/s]2025-11-21 11:15:55,588 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold1\train_dataset.h5
Normalizing and saving training data:   4%| | 10/258 [00:00<00:16, 14.95it/Normalizing and saving training data:   8%| | 20/258 [00:01<00:15, 15.46it/Normalizing and saving training data:  12%|1| 30/258 [00:01<00:14, 15.60it/Normalizing and saving training data:  16%|1| 40/258 [00:02<00:13, 15.64it/Normalizing and saving training data:  19%|1| 50/258 [00:03<00:13, 15.57it/Normalizing and saving training data:  23%|2| 60/258 [00:03<00:12, 15.56it/Normalizing and saving training data:  27%|2| 70/258 [00:04<00:12, 15.61it/Normalizing and saving training data:  31%|3| 80/258 [00:05<00:11, 15.54it/Normalizing and saving training data:  35%|3| 90/258 [00:05<00:10, 15.52it/Normalizing and saving training data:  39%|3| 100/258 [00:06<00:10, 15.48itNormalizing and saving training data:  43%|4| 110/258 [00:07<00:09, 15.47itNormalizing and saving training data:  47%|4| 120/258 [00:07<00:08, 15.44itNormalizing and saving training data:  50%|5| 130/258 [00:08<00:08, 15.54itNormalizing and saving training data:  54%|5| 140/258 [00:09<00:07, 15.50itNormalizing and saving training data:  58%|5| 150/258 [00:09<00:06, 15.48itNormalizing and saving training data:  62%|6| 160/258 [00:10<00:06, 15.50itNormalizing and saving training data:  66%|6| 170/258 [00:10<00:05, 15.49itNormalizing and saving training data:  70%|6| 180/258 [00:11<00:05, 15.53itNormalizing and saving training data:  74%|7| 190/258 [00:12<00:04, 15.51itNormalizing and saving training data:  78%|7| 200/258 [00:12<00:03, 15.43itNormalizing and saving training data:  81%|8| 210/258 [00:13<00:03, 14.14itNormalizing and saving training data:  85%|8| 220/258 [00:14<00:02, 14.33itNormalizing and saving training data:  89%|8| 230/258 [00:15<00:01, 14.65itNormalizing and saving training data:  93%|9| 240/258 [00:15<00:01, 14.72itNormalizing and saving training data:  97%|9| 250/258 [00:16<00:00, 15.01itNormalizing and saving training data: 100%|#| 258/258 [00:16<00:00, 15.75it
2025-11-21 11:16:12,536 - INFO - Training data processing completed during stats computation phase
2025-11-21 11:16:12,543 - INFO - Loaded normalization statistics:
2025-11-21 11:16:12,543 - INFO -   Mean: 0.136712
2025-11-21 11:16:12,543 - INFO -   Std: 2.121531
2025-11-21 11:16:12,543 - INFO - Split train already completed, skipping
2025-11-21 11:16:12,543 - INFO - Processing test split...
2025-11-21 11:16:12,543 - INFO - Need to process 26/26 sequences for test
2025-11-21 11:16:12,544 - INFO - Processing 26 sequences from 5 unique files
2025-11-21 11:16:12,544 - INFO - Average 5.2 sequences per file
Processing test:   0%|                              | 0/26 [00:00<?, ?it/s]Processing test:   4%|8                     | 1/26 [00:00<00:15,  1.60it/s]Processing test:  31%|######7               | 8/26 [00:04<00:08,  2.02it/s]2025-11-21 11:16:16,549 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold1\test_dataset.h5
2025-11-21 11:16:17,534 - INFO - Progress: 271/284 (95.4%) - ETA: 0.0 minutes
Processing test:  54%|###########3         | 14/26 [00:07<00:06,  1.97it/s]Processing test:  69%|##############5      | 18/26 [00:07<00:02,  2.76it/s]2025-11-21 11:16:20,621 - INFO - Progress: 281/284 (98.9%) - ETA: 0.0 minutes
Processing test:  92%|###################3 | 24/26 [00:13<00:01,  1.62it/s]Processing test: 100%|#####################| 26/26 [00:13<00:00,  1.96it/s]
2025-11-21 11:16:26,004 - INFO - Validating final datasets...
2025-11-21 11:16:26,012 - INFO - train dataset validation:
2025-11-21 11:16:26,013 - INFO -   - Segments: 258
2025-11-21 11:16:26,013 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:16:26,013 - INFO -   - Classes: 129 preictal, 129 interictal
2025-11-21 11:16:26,013 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:16:26,018 - INFO - test dataset validation:
2025-11-21 11:16:26,018 - INFO -   - Segments: 26
2025-11-21 11:16:26,018 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:16:26,018 - INFO -   - Classes: 13 preictal, 13 interictal
2025-11-21 11:16:26,018 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:16:26,018 - INFO - ============================================================
2025-11-21 11:16:26,018 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-21 11:16:26,019 - INFO - Total time: 1.0 minutes
2025-11-21 11:16:26,019 - INFO - Processed segments: 284
2025-11-21 11:16:26,019 - INFO - Average rate: 4.5 segments/second
2025-11-21 11:16:26,019 - INFO - ============================================================
✅ Fold 1 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 2/6
============================================================
2025-11-21 11:16:26,044 - INFO - ============================================================
2025-11-21 11:16:26,044 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-21 11:16:26,044 - INFO - ============================================================
2025-11-21 11:16:26,044 - INFO - Output prefix: chb23_fold2
2025-11-21 11:16:26,044 - INFO - EEG Preprocessor initialized
2025-11-21 11:16:26,044 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-21 11:16:26,044 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-21 11:16:26,044 - INFO - Segment duration: 5 seconds
2025-11-21 11:16:26,044 - INFO - Note: Channel validation performed during segmentation phase
2025-11-21 11:16:26,044 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-21 11:16:26,044 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-21 11:16:26,044 - INFO - Loading segments from chb23_fold2_sequences_prediction.json
2025-11-21 11:16:26,055 - INFO - Loaded 284 total sequences
2025-11-21 11:16:26,055 - INFO - Channel validation (from segmentation): 9/9 files valid
2025-11-21 11:16:26,055 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-21 11:16:26,056 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-21 11:16:26,056 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-21 11:16:26,056 - INFO - train: 236 sequences (118 preictal, 118 interictal)
2025-11-21 11:16:26,056 - INFO - test: 48 sequences (24 preictal, 24 interictal)
2025-11-21 11:16:26,071 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-21 11:16:26,071 - INFO - train: kept 118 preictal and 118 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:16:26,071 - INFO - test: kept 24 preictal and 24 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:16:26,086 - INFO - ============================================================
2025-11-21 11:16:26,086 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-21 11:16:26,086 - INFO - ============================================================
2025-11-21 11:16:26,086 - INFO - Processing 236 training samples to compute normalization stats...
2025-11-21 11:16:26,086 - INFO - Processing 236 sequences from 9 unique files
Processing training data:   0%|                    | 0/236 [00:00<?, ?it/s]Processing training data:   0%|            | 1/236 [00:05<20:11,  5.15s/it]Processing training data:  13%|#3         | 30/236 [00:09<00:52,  3.91it/s]Processing training data:  48%|####8     | 114/236 [00:14<00:12,  9.79it/s]Processing training data:  61%|######1   | 145/236 [00:19<00:10,  8.37it/s]Processing training data:  69%|######8   | 162/236 [00:20<00:07,  9.49it/s]Processing training data:  78%|#######7  | 183/236 [00:22<00:05,  9.85it/s]Processing training data:  82%|########2 | 194/236 [00:22<00:03, 11.23it/s]Processing training data:  85%|########4 | 200/236 [00:28<00:07,  5.06it/s]Processing training data:  97%|#########7| 230/236 [00:29<00:00,  8.28it/s]Processing training data: 100%|##########| 236/236 [00:29<00:00,  7.98it/s]
2025-11-21 11:16:55,646 - INFO - Computing normalization statistics from training data...
2025-11-21 11:16:56,000 - INFO - Normalization stats computed:
2025-11-21 11:16:56,000 - INFO -   Mean: 0.148379
2025-11-21 11:16:56,000 - INFO -   Std: 2.112507
2025-11-21 11:16:56,000 - INFO -   Saved to: preprocessing\checkpoints\chb23_fold2\normalization_stats.json
2025-11-21 11:16:56,025 - INFO - Applying normalization and saving 236 training sequences...
Normalizing and saving training data:   0%|        | 0/236 [00:00<?, ?it/s]2025-11-21 11:16:56,033 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold2\train_dataset.h5
Normalizing and saving training data:   4%| | 10/236 [00:00<00:14, 16.09it/Normalizing and saving training data:   8%| | 20/236 [00:01<00:14, 15.12it/Normalizing and saving training data:  13%|1| 30/236 [00:01<00:13, 15.43it/Normalizing and saving training data:  17%|1| 40/236 [00:02<00:12, 15.63it/Normalizing and saving training data:  21%|2| 50/236 [00:03<00:11, 15.72it/Normalizing and saving training data:  25%|2| 60/236 [00:03<00:11, 15.78it/Normalizing and saving training data:  30%|2| 70/236 [00:04<00:10, 15.74it/Normalizing and saving training data:  34%|3| 80/236 [00:05<00:09, 15.79it/Normalizing and saving training data:  38%|3| 90/236 [00:05<00:09, 15.59it/Normalizing and saving training data:  42%|4| 100/236 [00:06<00:08, 15.57itNormalizing and saving training data:  47%|4| 110/236 [00:07<00:08, 15.60itNormalizing and saving training data:  51%|5| 120/236 [00:07<00:07, 15.65itNormalizing and saving training data:  55%|5| 130/236 [00:08<00:06, 15.73itNormalizing and saving training data:  59%|5| 140/236 [00:08<00:06, 15.81itNormalizing and saving training data:  64%|6| 150/236 [00:09<00:05, 15.81itNormalizing and saving training data:  68%|6| 160/236 [00:10<00:04, 15.88itNormalizing and saving training data:  72%|7| 170/236 [00:10<00:04, 15.76itNormalizing and saving training data:  76%|7| 180/236 [00:11<00:03, 15.82itNormalizing and saving training data:  81%|8| 190/236 [00:12<00:02, 15.85itNormalizing and saving training data:  85%|8| 200/236 [00:12<00:02, 15.84itNormalizing and saving training data:  89%|8| 210/236 [00:13<00:01, 15.77itNormalizing and saving training data:  93%|9| 220/236 [00:13<00:01, 15.86itNormalizing and saving training data:  97%|9| 230/236 [00:14<00:00, 15.76itNormalizing and saving training data: 100%|#| 236/236 [00:14<00:00, 16.14it
2025-11-21 11:17:11,051 - INFO - Training data processing completed during stats computation phase
2025-11-21 11:17:11,058 - INFO - Loaded normalization statistics:
2025-11-21 11:17:11,058 - INFO -   Mean: 0.148379
2025-11-21 11:17:11,058 - INFO -   Std: 2.112507
2025-11-21 11:17:11,058 - INFO - Split train already completed, skipping
2025-11-21 11:17:11,058 - INFO - Processing test split...
2025-11-21 11:17:11,058 - INFO - Need to process 48/48 sequences for test
2025-11-21 11:17:11,058 - INFO - Processing 48 sequences from 6 unique files
2025-11-21 11:17:11,058 - INFO - Average 8.0 sequences per file
Processing test:   0%|                              | 0/48 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/48 [00:01<01:30,  1.93s/it]Processing test:   8%|#8                    | 4/48 [00:07<01:26,  1.97s/it]2025-11-21 11:17:18,918 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold2\test_dataset.h5
2025-11-21 11:17:19,704 - INFO - Progress: 249/284 (87.7%) - ETA: 0.1 minutes
Processing test:  29%|######1              | 14/48 [00:09<00:18,  1.85it/s]2025-11-21 11:17:22,141 - INFO - Progress: 273/284 (96.1%) - ETA: 0.0 minutes
Processing test:  79%|################6    | 38/48 [00:14<00:02,  3.50it/s]Processing test:  85%|#################9   | 41/48 [00:18<00:02,  2.33it/s]Processing test:  94%|###################6 | 45/48 [00:20<00:01,  2.29it/s]2025-11-21 11:17:32,440 - INFO - Progress: 284/284 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 48/48 [00:21<00:00,  2.24it/s]
2025-11-21 11:17:32,455 - INFO - Validating final datasets...
2025-11-21 11:17:32,463 - INFO - train dataset validation:
2025-11-21 11:17:32,463 - INFO -   - Segments: 236
2025-11-21 11:17:32,463 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:17:32,463 - INFO -   - Classes: 118 preictal, 118 interictal
2025-11-21 11:17:32,463 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:17:32,468 - INFO - test dataset validation:
2025-11-21 11:17:32,469 - INFO -   - Segments: 48
2025-11-21 11:17:32,469 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:17:32,469 - INFO -   - Classes: 24 preictal, 24 interictal
2025-11-21 11:17:32,469 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:17:32,469 - INFO - ============================================================
2025-11-21 11:17:32,469 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-21 11:17:32,469 - INFO - Total time: 1.1 minutes
2025-11-21 11:17:32,469 - INFO - Processed segments: 284
2025-11-21 11:17:32,469 - INFO - Average rate: 4.3 segments/second
2025-11-21 11:17:32,469 - INFO - ============================================================
✅ Fold 2 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 3/6
============================================================
2025-11-21 11:17:32,492 - INFO - ============================================================
2025-11-21 11:17:32,492 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-21 11:17:32,492 - INFO - ============================================================
2025-11-21 11:17:32,492 - INFO - Output prefix: chb23_fold3
2025-11-21 11:17:32,492 - INFO - EEG Preprocessor initialized
2025-11-21 11:17:32,492 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-21 11:17:32,492 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-21 11:17:32,492 - INFO - Segment duration: 5 seconds
2025-11-21 11:17:32,492 - INFO - Note: Channel validation performed during segmentation phase
2025-11-21 11:17:32,492 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-21 11:17:32,492 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-21 11:17:32,492 - INFO - Loading segments from chb23_fold3_sequences_prediction.json
2025-11-21 11:17:32,503 - INFO - Loaded 284 total sequences
2025-11-21 11:17:32,503 - INFO - Channel validation (from segmentation): 9/9 files valid
2025-11-21 11:17:32,503 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-21 11:17:32,503 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-21 11:17:32,503 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-21 11:17:32,503 - INFO - train: 244 sequences (122 preictal, 122 interictal)
2025-11-21 11:17:32,503 - INFO - test: 40 sequences (20 preictal, 20 interictal)
2025-11-21 11:17:32,519 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-21 11:17:32,520 - INFO - train: kept 122 preictal and 122 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:17:32,520 - INFO - test: kept 20 preictal and 20 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:17:32,535 - INFO - ============================================================
2025-11-21 11:17:32,535 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-21 11:17:32,535 - INFO - ============================================================
2025-11-21 11:17:32,535 - INFO - Processing 244 training samples to compute normalization stats...
2025-11-21 11:17:32,535 - INFO - Processing 244 sequences from 9 unique files
Processing training data:   0%|                    | 0/244 [00:00<?, ?it/s]Processing training data:   0%|            | 1/244 [00:06<25:54,  6.40s/it]Processing training data:  15%|#6         | 37/244 [00:09<00:39,  5.18it/s]Processing training data:  28%|###        | 68/244 [00:11<00:22,  7.90it/s]Processing training data:  54%|#####4    | 132/244 [00:11<00:06, 17.95it/s]Processing training data:  63%|######2   | 153/244 [00:17<00:09, 10.10it/s]Processing training data:  73%|#######2  | 177/244 [00:19<00:06, 10.66it/s]Processing training data:  77%|#######7  | 188/244 [00:24<00:08,  6.41it/s]Processing training data:  88%|########8 | 215/244 [00:30<00:05,  5.55it/s]Processing training data:  98%|#########7| 239/244 [00:31<00:00,  7.76it/s]Processing training data: 100%|##########| 244/244 [00:31<00:00,  7.84it/s]
2025-11-21 11:18:03,638 - INFO - Computing normalization statistics from training data...
2025-11-21 11:18:04,016 - INFO - Normalization stats computed:
2025-11-21 11:18:04,016 - INFO -   Mean: 0.066649
2025-11-21 11:18:04,016 - INFO -   Std: 2.140495
2025-11-21 11:18:04,016 - INFO -   Saved to: preprocessing\checkpoints\chb23_fold3\normalization_stats.json
2025-11-21 11:18:04,042 - INFO - Applying normalization and saving 244 training sequences...
Normalizing and saving training data:   0%|        | 0/244 [00:00<?, ?it/s]2025-11-21 11:18:04,051 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold3\train_dataset.h5
Normalizing and saving training data:   4%| | 10/244 [00:00<00:14, 15.79it/Normalizing and saving training data:   8%| | 20/244 [00:01<00:15, 14.72it/Normalizing and saving training data:  12%|1| 30/244 [00:01<00:14, 15.17it/Normalizing and saving training data:  16%|1| 40/244 [00:02<00:13, 15.30it/Normalizing and saving training data:  20%|2| 50/244 [00:03<00:12, 15.48it/Normalizing and saving training data:  25%|2| 60/244 [00:03<00:11, 15.47it/Normalizing and saving training data:  29%|2| 70/244 [00:04<00:11, 15.44it/Normalizing and saving training data:  33%|3| 80/244 [00:05<00:10, 15.55it/Normalizing and saving training data:  37%|3| 90/244 [00:05<00:09, 15.63it/Normalizing and saving training data:  41%|4| 100/244 [00:06<00:09, 15.60itNormalizing and saving training data:  45%|4| 110/244 [00:07<00:08, 15.65itNormalizing and saving training data:  49%|4| 120/244 [00:07<00:07, 15.67itNormalizing and saving training data:  53%|5| 130/244 [00:08<00:07, 15.69itNormalizing and saving training data:  57%|5| 140/244 [00:09<00:06, 15.66itNormalizing and saving training data:  61%|6| 150/244 [00:09<00:06, 15.62itNormalizing and saving training data:  66%|6| 160/244 [00:10<00:05, 15.52itNormalizing and saving training data:  70%|6| 170/244 [00:10<00:04, 15.52itNormalizing and saving training data:  74%|7| 180/244 [00:11<00:04, 15.55itNormalizing and saving training data:  78%|7| 190/244 [00:12<00:03, 15.52itNormalizing and saving training data:  82%|8| 200/244 [00:12<00:02, 15.22itNormalizing and saving training data:  86%|8| 210/244 [00:13<00:02, 15.13itNormalizing and saving training data:  90%|9| 220/244 [00:14<00:01, 15.07itNormalizing and saving training data:  94%|9| 230/244 [00:14<00:00, 14.96itNormalizing and saving training data:  98%|9| 240/244 [00:15<00:00, 14.93itNormalizing and saving training data: 100%|#| 244/244 [00:15<00:00, 15.62it
2025-11-21 11:18:19,956 - INFO - Training data processing completed during stats computation phase
2025-11-21 11:18:19,962 - INFO - Loaded normalization statistics:
2025-11-21 11:18:19,963 - INFO -   Mean: 0.066649
2025-11-21 11:18:19,963 - INFO -   Std: 2.140495
2025-11-21 11:18:19,963 - INFO - Split train already completed, skipping
2025-11-21 11:18:19,963 - INFO - Processing test split...
2025-11-21 11:18:19,963 - INFO - Need to process 40/40 sequences for test
2025-11-21 11:18:19,963 - INFO - Processing 40 sequences from 5 unique files
2025-11-21 11:18:19,963 - INFO - Average 8.0 sequences per file
Processing test:   0%|                              | 0/40 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/40 [00:05<03:48,  5.86s/it]2025-11-21 11:18:25,827 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold3\test_dataset.h5
2025-11-21 11:18:26,649 - INFO - Progress: 256/284 (90.1%) - ETA: 0.1 minutes
Processing test:  32%|######8              | 13/40 [00:07<00:12,  2.14it/s]2025-11-21 11:18:28,980 - INFO - Progress: 276/284 (97.2%) - ETA: 0.0 minutes
Processing test:  82%|#################3   | 33/40 [00:13<00:02,  2.76it/s]Processing test:  92%|###################4 | 37/40 [00:15<00:01,  2.76it/s]Processing test:  98%|####################4| 39/40 [00:17<00:00,  2.35it/s]Processing test: 100%|#####################| 40/40 [00:17<00:00,  2.30it/s]
2025-11-21 11:18:37,858 - INFO - Validating final datasets...
2025-11-21 11:18:37,866 - INFO - train dataset validation:
2025-11-21 11:18:37,866 - INFO -   - Segments: 244
2025-11-21 11:18:37,866 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:18:37,866 - INFO -   - Classes: 122 preictal, 122 interictal
2025-11-21 11:18:37,866 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:18:37,872 - INFO - test dataset validation:
2025-11-21 11:18:37,872 - INFO -   - Segments: 40
2025-11-21 11:18:37,872 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:18:37,872 - INFO -   - Classes: 20 preictal, 20 interictal
2025-11-21 11:18:37,872 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:18:37,873 - INFO - ============================================================
2025-11-21 11:18:37,873 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-21 11:18:37,873 - INFO - Total time: 1.1 minutes
2025-11-21 11:18:37,873 - INFO - Processed segments: 284
2025-11-21 11:18:37,873 - INFO - Average rate: 4.3 segments/second
2025-11-21 11:18:37,873 - INFO - ============================================================
✅ Fold 3 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 4/6
============================================================
2025-11-21 11:18:37,896 - INFO - ============================================================
2025-11-21 11:18:37,896 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-21 11:18:37,896 - INFO - ============================================================
2025-11-21 11:18:37,896 - INFO - Output prefix: chb23_fold4
2025-11-21 11:18:37,896 - INFO - EEG Preprocessor initialized
2025-11-21 11:18:37,896 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-21 11:18:37,896 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-21 11:18:37,896 - INFO - Segment duration: 5 seconds
2025-11-21 11:18:37,896 - INFO - Note: Channel validation performed during segmentation phase
2025-11-21 11:18:37,896 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-21 11:18:37,896 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-21 11:18:37,897 - INFO - Loading segments from chb23_fold4_sequences_prediction.json
2025-11-21 11:18:37,908 - INFO - Loaded 284 total sequences
2025-11-21 11:18:37,908 - INFO - Channel validation (from segmentation): 9/9 files valid
2025-11-21 11:18:37,908 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-21 11:18:37,908 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-21 11:18:37,908 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-21 11:18:37,908 - INFO - train: 240 sequences (120 preictal, 120 interictal)
2025-11-21 11:18:37,908 - INFO - test: 44 sequences (22 preictal, 22 interictal)
2025-11-21 11:18:37,924 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-21 11:18:37,924 - INFO - train: kept 120 preictal and 120 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:18:37,924 - INFO - test: kept 22 preictal and 22 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:18:37,939 - INFO - ============================================================
2025-11-21 11:18:37,939 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-21 11:18:37,939 - INFO - ============================================================
2025-11-21 11:18:37,939 - INFO - Processing 240 training samples to compute normalization stats...
2025-11-21 11:18:37,939 - INFO - Processing 240 sequences from 9 unique files
Processing training data:   0%|                    | 0/240 [00:00<?, ?it/s]Processing training data:   0%|            | 1/240 [00:03<15:23,  3.86s/it]Processing training data:  26%|##8        | 63/240 [00:08<00:21,  8.40it/s]Processing training data:  36%|###9       | 86/240 [00:11<00:18,  8.55it/s]Processing training data:  49%|####8     | 117/240 [00:17<00:18,  6.65it/s]Processing training data:  64%|######4   | 154/240 [00:18<00:08, 10.18it/s]Processing training data:  73%|#######2  | 175/240 [00:18<00:05, 12.95it/s]Processing training data:  75%|#######5  | 181/240 [00:24<00:09,  6.13it/s]Processing training data:  87%|########6 | 208/240 [00:29<00:05,  5.66it/s]Processing training data:  98%|#########7| 235/240 [00:31<00:00,  7.77it/s]Processing training data: 100%|##########| 240/240 [00:31<00:00,  7.74it/s]
2025-11-21 11:19:08,967 - INFO - Computing normalization statistics from training data...
2025-11-21 11:19:09,359 - INFO - Normalization stats computed:
2025-11-21 11:19:09,359 - INFO -   Mean: 0.177021
2025-11-21 11:19:09,359 - INFO -   Std: 2.118536
2025-11-21 11:19:09,359 - INFO -   Saved to: preprocessing\checkpoints\chb23_fold4\normalization_stats.json
2025-11-21 11:19:09,385 - INFO - Applying normalization and saving 240 training sequences...
Normalizing and saving training data:   0%|        | 0/240 [00:00<?, ?it/s]2025-11-21 11:19:09,392 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold4\train_dataset.h5
Normalizing and saving training data:   4%| | 10/240 [00:00<00:14, 16.21it/Normalizing and saving training data:   8%| | 20/240 [00:01<00:14, 14.78it/Normalizing and saving training data:  12%|1| 30/240 [00:01<00:13, 15.15it/Normalizing and saving training data:  17%|1| 40/240 [00:02<00:13, 15.34it/Normalizing and saving training data:  21%|2| 50/240 [00:03<00:12, 15.36it/Normalizing and saving training data:  25%|2| 60/240 [00:03<00:11, 15.46it/Normalizing and saving training data:  29%|2| 70/240 [00:04<00:11, 15.39it/Normalizing and saving training data:  33%|3| 80/240 [00:05<00:10, 15.41it/Normalizing and saving training data:  38%|3| 90/240 [00:05<00:09, 15.40it/Normalizing and saving training data:  42%|4| 100/240 [00:06<00:09, 15.33itNormalizing and saving training data:  46%|4| 110/240 [00:07<00:08, 15.37itNormalizing and saving training data:  50%|5| 120/240 [00:07<00:07, 15.46itNormalizing and saving training data:  54%|5| 130/240 [00:08<00:07, 15.51itNormalizing and saving training data:  58%|5| 140/240 [00:09<00:06, 15.76itNormalizing and saving training data:  62%|6| 150/240 [00:09<00:05, 15.85itNormalizing and saving training data:  67%|6| 160/240 [00:10<00:05, 15.89itNormalizing and saving training data:  71%|7| 170/240 [00:10<00:04, 15.93itNormalizing and saving training data:  75%|7| 180/240 [00:11<00:03, 16.05itNormalizing and saving training data:  79%|7| 190/240 [00:12<00:03, 16.07itNormalizing and saving training data:  83%|8| 200/240 [00:12<00:02, 16.17itNormalizing and saving training data:  88%|8| 210/240 [00:13<00:01, 16.24itNormalizing and saving training data:  92%|9| 220/240 [00:13<00:01, 16.30itNormalizing and saving training data:  96%|9| 230/240 [00:14<00:00, 16.25itNormalizing and saving training data: 100%|#| 240/240 [00:15<00:00, 16.13itNormalizing and saving training data: 100%|#| 240/240 [00:15<00:00, 15.75it
2025-11-21 11:19:24,634 - INFO - Training data processing completed during stats computation phase
2025-11-21 11:19:24,641 - INFO - Loaded normalization statistics:
2025-11-21 11:19:24,641 - INFO -   Mean: 0.177021
2025-11-21 11:19:24,642 - INFO -   Std: 2.118536
2025-11-21 11:19:24,642 - INFO - Split train already completed, skipping
2025-11-21 11:19:24,642 - INFO - Processing test split...
2025-11-21 11:19:24,642 - INFO - Need to process 44/44 sequences for test
2025-11-21 11:19:24,642 - INFO - Processing 44 sequences from 6 unique files
2025-11-21 11:19:24,642 - INFO - Average 7.3 sequences per file
Processing test:   0%|                              | 0/44 [00:00<?, ?it/s]Processing test:   2%|5                     | 1/44 [00:03<02:36,  3.65s/it]Processing test:  14%|###                   | 6/44 [00:06<00:37,  1.02it/s]2025-11-21 11:19:31,349 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold4\test_dataset.h5
2025-11-21 11:19:32,004 - INFO - Progress: 251/284 (88.4%) - ETA: 0.1 minutes
Processing test:  27%|#####7               | 12/44 [00:08<00:18,  1.74it/s]2025-11-21 11:19:34,491 - INFO - Progress: 273/284 (96.1%) - ETA: 0.0 minutes
Processing test:  77%|################2    | 34/44 [00:10<00:01,  5.09it/s]Processing test:  82%|#################1   | 36/44 [00:14<00:02,  2.71it/s]Processing test:  93%|###################5 | 41/44 [00:20<00:01,  1.80it/s]2025-11-21 11:19:45,513 - INFO - Progress: 284/284 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 44/44 [00:20<00:00,  2.11it/s]
2025-11-21 11:19:45,529 - INFO - Validating final datasets...
2025-11-21 11:19:45,537 - INFO - train dataset validation:
2025-11-21 11:19:45,537 - INFO -   - Segments: 240
2025-11-21 11:19:45,537 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:19:45,537 - INFO -   - Classes: 120 preictal, 120 interictal
2025-11-21 11:19:45,537 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:19:45,542 - INFO - test dataset validation:
2025-11-21 11:19:45,542 - INFO -   - Segments: 44
2025-11-21 11:19:45,542 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:19:45,542 - INFO -   - Classes: 22 preictal, 22 interictal
2025-11-21 11:19:45,542 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:19:45,542 - INFO - ============================================================
2025-11-21 11:19:45,542 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-21 11:19:45,542 - INFO - Total time: 1.1 minutes
2025-11-21 11:19:45,542 - INFO - Processed segments: 284
2025-11-21 11:19:45,542 - INFO - Average rate: 4.2 segments/second
2025-11-21 11:19:45,543 - INFO - ============================================================
✅ Fold 4 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 5/6
============================================================
2025-11-21 11:19:45,565 - INFO - ============================================================
2025-11-21 11:19:45,565 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-21 11:19:45,565 - INFO - ============================================================
2025-11-21 11:19:45,565 - INFO - Output prefix: chb23_fold5
2025-11-21 11:19:45,565 - INFO - EEG Preprocessor initialized
2025-11-21 11:19:45,565 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-21 11:19:45,565 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-21 11:19:45,565 - INFO - Segment duration: 5 seconds
2025-11-21 11:19:45,565 - INFO - Note: Channel validation performed during segmentation phase
2025-11-21 11:19:45,565 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-21 11:19:45,565 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-21 11:19:45,565 - INFO - Loading segments from chb23_fold5_sequences_prediction.json
2025-11-21 11:19:45,577 - INFO - Loaded 284 total sequences
2025-11-21 11:19:45,577 - INFO - Channel validation (from segmentation): 9/9 files valid
2025-11-21 11:19:45,577 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-21 11:19:45,577 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-21 11:19:45,577 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-21 11:19:45,577 - INFO - train: 238 sequences (119 preictal, 119 interictal)
2025-11-21 11:19:45,577 - INFO - test: 46 sequences (23 preictal, 23 interictal)
2025-11-21 11:19:45,593 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-21 11:19:45,593 - INFO - train: kept 119 preictal and 119 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:19:45,593 - INFO - test: kept 23 preictal and 23 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:19:45,609 - INFO - ============================================================
2025-11-21 11:19:45,609 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-21 11:19:45,609 - INFO - ============================================================
2025-11-21 11:19:45,609 - INFO - Processing 238 training samples to compute normalization stats...
2025-11-21 11:19:45,609 - INFO - Processing 238 sequences from 9 unique files
Processing training data:   0%|                    | 0/238 [00:00<?, ?it/s]Processing training data:   0%|            | 1/238 [00:05<21:30,  5.44s/it]Processing training data:  11%|#2         | 27/238 [00:06<00:35,  5.91it/s]Processing training data:  20%|##2        | 48/238 [00:11<00:38,  4.90it/s]Processing training data:  29%|###2       | 70/238 [00:14<00:32,  5.21it/s]Processing training data:  55%|#####5    | 131/238 [00:21<00:14,  7.32it/s]Processing training data:  69%|######8   | 164/238 [00:27<00:11,  6.40it/s]Processing training data:  80%|########  | 191/238 [00:30<00:06,  7.14it/s]Processing training data:  93%|#########3| 222/238 [00:32<00:01,  8.66it/s]Processing training data:  98%|#########7| 233/238 [00:32<00:00,  9.64it/s]Processing training data: 100%|##########| 238/238 [00:32<00:00,  7.27it/s]
2025-11-21 11:20:18,354 - INFO - Computing normalization statistics from training data...
2025-11-21 11:20:18,676 - INFO - Normalization stats computed:
2025-11-21 11:20:18,676 - INFO -   Mean: 0.075834
2025-11-21 11:20:18,676 - INFO -   Std: 2.132910
2025-11-21 11:20:18,676 - INFO -   Saved to: preprocessing\checkpoints\chb23_fold5\normalization_stats.json
2025-11-21 11:20:18,701 - INFO - Applying normalization and saving 238 training sequences...
Normalizing and saving training data:   0%|        | 0/238 [00:00<?, ?it/s]2025-11-21 11:20:18,707 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold5\train_dataset.h5
Normalizing and saving training data:   4%| | 10/238 [00:00<00:14, 15.43it/Normalizing and saving training data:   8%| | 20/238 [00:01<00:13, 15.66it/Normalizing and saving training data:  13%|1| 30/238 [00:01<00:13, 15.79it/Normalizing and saving training data:  17%|1| 40/238 [00:02<00:12, 15.80it/Normalizing and saving training data:  21%|2| 50/238 [00:03<00:11, 15.79it/Normalizing and saving training data:  25%|2| 60/238 [00:03<00:11, 15.76it/Normalizing and saving training data:  29%|2| 70/238 [00:04<00:10, 15.78it/Normalizing and saving training data:  34%|3| 80/238 [00:05<00:09, 15.82it/Normalizing and saving training data:  38%|3| 90/238 [00:05<00:09, 15.75it/Normalizing and saving training data:  42%|4| 100/238 [00:06<00:08, 15.76itNormalizing and saving training data:  46%|4| 110/238 [00:07<00:08, 15.57itNormalizing and saving training data:  50%|5| 120/238 [00:07<00:07, 15.68itNormalizing and saving training data:  55%|5| 130/238 [00:08<00:06, 15.74itNormalizing and saving training data:  59%|5| 140/238 [00:08<00:06, 15.85itNormalizing and saving training data:  63%|6| 150/238 [00:09<00:05, 15.86itNormalizing and saving training data:  67%|6| 160/238 [00:10<00:04, 15.95itNormalizing and saving training data:  71%|7| 170/238 [00:10<00:04, 15.97itNormalizing and saving training data:  76%|7| 180/238 [00:11<00:03, 15.92itNormalizing and saving training data:  80%|7| 190/238 [00:12<00:03, 15.95itNormalizing and saving training data:  84%|8| 200/238 [00:12<00:02, 15.97itNormalizing and saving training data:  88%|8| 210/238 [00:13<00:01, 15.96itNormalizing and saving training data:  92%|9| 220/238 [00:13<00:01, 15.92itNormalizing and saving training data:  97%|9| 230/238 [00:14<00:00, 15.97itNormalizing and saving training data: 100%|#| 238/238 [00:14<00:00, 16.39it
2025-11-21 11:20:33,740 - INFO - Training data processing completed during stats computation phase
2025-11-21 11:20:33,747 - INFO - Loaded normalization statistics:
2025-11-21 11:20:33,747 - INFO -   Mean: 0.075834
2025-11-21 11:20:33,747 - INFO -   Std: 2.132910
2025-11-21 11:20:33,747 - INFO - Split train already completed, skipping
2025-11-21 11:20:33,747 - INFO - Processing test split...
2025-11-21 11:20:33,747 - INFO - Need to process 46/46 sequences for test
2025-11-21 11:20:33,747 - INFO - Processing 46 sequences from 6 unique files
2025-11-21 11:20:33,747 - INFO - Average 7.7 sequences per file
Processing test:   0%|                              | 0/46 [00:00<?, ?it/s]Processing test:   2%|4                     | 1/46 [00:01<00:46,  1.03s/it]2025-11-21 11:20:34,782 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold5\test_dataset.h5
2025-11-21 11:20:36,166 - INFO - Progress: 261/284 (91.9%) - ETA: 0.1 minutes
Processing test:  52%|##########9          | 24/46 [00:05<00:04,  4.52it/s]Processing test:  70%|##############6      | 32/46 [00:09<00:04,  3.18it/s]2025-11-21 11:20:44,191 - INFO - Progress: 274/284 (96.5%) - ETA: 0.0 minutes
Processing test:  80%|################8    | 37/46 [00:11<00:02,  3.11it/s]Processing test:  85%|#################8   | 39/46 [00:16<00:03,  1.77it/s]Processing test:  96%|#################### | 44/46 [00:18<00:01,  1.91it/s]2025-11-21 11:20:52,778 - INFO - Progress: 284/284 (100.0%) - ETA: 0.0 minutes
Processing test: 100%|#####################| 46/46 [00:19<00:00,  2.42it/s]
2025-11-21 11:20:52,793 - INFO - Validating final datasets...
2025-11-21 11:20:52,802 - INFO - train dataset validation:
2025-11-21 11:20:52,802 - INFO -   - Segments: 238
2025-11-21 11:20:52,802 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:20:52,802 - INFO -   - Classes: 119 preictal, 119 interictal
2025-11-21 11:20:52,802 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:20:52,807 - INFO - test dataset validation:
2025-11-21 11:20:52,807 - INFO -   - Segments: 46
2025-11-21 11:20:52,807 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:20:52,807 - INFO -   - Classes: 23 preictal, 23 interictal
2025-11-21 11:20:52,808 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:20:52,808 - INFO - ============================================================
2025-11-21 11:20:52,808 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-21 11:20:52,808 - INFO - Total time: 1.1 minutes
2025-11-21 11:20:52,808 - INFO - Processed segments: 284
2025-11-21 11:20:52,808 - INFO - Average rate: 4.2 segments/second
2025-11-21 11:20:52,808 - INFO - ============================================================
✅ Fold 5 preprocessing completed successfully!

============================================================
PREPROCESSING FOLD 6/6
============================================================
2025-11-21 11:20:52,831 - INFO - ============================================================
2025-11-21 11:20:52,831 - INFO - EEG PREPROCESSING PIPELINE STARTED
2025-11-21 11:20:52,831 - INFO - ============================================================
2025-11-21 11:20:52,831 - INFO - Output prefix: chb23_fold6
2025-11-21 11:20:52,831 - INFO - EEG Preprocessor initialized
2025-11-21 11:20:52,831 - INFO - Target channels: ['C3-P3', 'C4-P4', 'CZ-PZ', 'F3-C3', 'F4-C4', 'F7-T7', 'F8-T8', 'FP1-F3', 'FP1-F7', 'FP2-F4', 'FP2-F8', 'FZ-CZ', 'P3-O1', 'P4-O2', 'P7-O1', 'P8-O2', 'T7-P7', 'T8-P8']
2025-11-21 11:20:52,831 - INFO - Filter settings: 0.5-50 Hz, notch: 60 Hz
2025-11-21 11:20:52,831 - INFO - Segment duration: 5 seconds
2025-11-21 11:20:52,831 - INFO - Note: Channel validation performed during segmentation phase
2025-11-21 11:20:52,831 - INFO - Multiprocessing: Using 10/16 CPU cores for parallel preprocessing
2025-11-21 11:20:52,832 - INFO - MNE parallel filtering: 8 jobs per sequence
2025-11-21 11:20:52,832 - INFO - Loading segments from chb23_fold6_sequences_prediction.json
2025-11-21 11:20:52,843 - INFO - Loaded 284 total sequences
2025-11-21 11:20:52,843 - INFO - Channel validation (from segmentation): 9/9 files valid
2025-11-21 11:20:52,843 - INFO - Using all sequences (channel validation performed during segmentation)
2025-11-21 11:20:52,843 - INFO - Detected pre-assigned splits in segmentation metadata; using them directly.
2025-11-21 11:20:52,843 - INFO - LOOCV Mode: Using 2-split configuration (train/test only) for fold None
2025-11-21 11:20:52,843 - INFO - train: 246 sequences (123 preictal, 123 interictal)
2025-11-21 11:20:52,843 - INFO - test: 38 sequences (19 preictal, 19 interictal)
2025-11-21 11:20:52,859 - INFO - Balancing splits to enforce equal positive/interictal counts per split...
2025-11-21 11:20:52,859 - INFO - train: kept 123 preictal and 123 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:20:52,859 - INFO - test: kept 19 preictal and 19 interictal (dropped 0 preictal, 0 interictal)
2025-11-21 11:20:52,875 - INFO - ============================================================
2025-11-21 11:20:52,875 - INFO - COMPUTING NORMALIZATION STATISTICS AND PROCESSING TRAINING DATA
2025-11-21 11:20:52,875 - INFO - ============================================================
2025-11-21 11:20:52,875 - INFO - Processing 246 training samples to compute normalization stats...
2025-11-21 11:20:52,875 - INFO - Processing 246 sequences from 9 unique files
Processing training data:   0%|                    | 0/246 [00:00<?, ?it/s]Processing training data:   0%|            | 1/246 [00:06<25:43,  6.30s/it]Processing training data:  14%|#5         | 35/246 [00:07<00:31,  6.77it/s]Processing training data:  23%|##5        | 56/246 [00:13<00:42,  4.49it/s]Processing training data:  37%|####       | 90/246 [00:17<00:25,  6.23it/s]Processing training data:  63%|######3   | 155/246 [00:22<00:10,  8.65it/s]Processing training data:  73%|#######3  | 180/246 [00:25<00:07,  8.78it/s]Processing training data:  86%|########5 | 211/246 [00:25<00:02, 12.08it/s]Processing training data:  88%|########8 | 217/246 [00:30<00:04,  6.90it/s]Processing training data:  98%|#########8| 242/246 [00:32<00:00,  8.65it/s]Processing training data: 100%|##########| 246/246 [00:32<00:00,  7.66it/s]
2025-11-21 11:21:25,007 - INFO - Computing normalization statistics from training data...
2025-11-21 11:21:25,397 - INFO - Normalization stats computed:
2025-11-21 11:21:25,397 - INFO -   Mean: 0.080317
2025-11-21 11:21:25,397 - INFO -   Std: 2.155404
2025-11-21 11:21:25,397 - INFO -   Saved to: preprocessing\checkpoints\chb23_fold6\normalization_stats.json
2025-11-21 11:21:25,422 - INFO - Applying normalization and saving 246 training sequences...
Normalizing and saving training data:   0%|        | 0/246 [00:00<?, ?it/s]2025-11-21 11:21:25,429 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold6\train_dataset.h5
Normalizing and saving training data:   4%| | 10/246 [00:00<00:14, 16.46it/Normalizing and saving training data:   8%| | 20/246 [00:01<00:14, 15.74it/Normalizing and saving training data:  12%|1| 30/246 [00:01<00:13, 15.75it/Normalizing and saving training data:  16%|1| 40/246 [00:02<00:13, 15.80it/Normalizing and saving training data:  20%|2| 50/246 [00:03<00:12, 15.83it/Normalizing and saving training data:  24%|2| 60/246 [00:03<00:11, 15.92it/Normalizing and saving training data:  28%|2| 70/246 [00:04<00:11, 15.92it/Normalizing and saving training data:  33%|3| 80/246 [00:05<00:10, 15.98it/Normalizing and saving training data:  37%|3| 90/246 [00:05<00:09, 16.00it/Normalizing and saving training data:  41%|4| 100/246 [00:06<00:09, 15.99itNormalizing and saving training data:  45%|4| 110/246 [00:06<00:08, 15.88itNormalizing and saving training data:  49%|4| 120/246 [00:07<00:07, 15.89itNormalizing and saving training data:  53%|5| 130/246 [00:08<00:07, 15.93itNormalizing and saving training data:  57%|5| 140/246 [00:08<00:06, 16.11itNormalizing and saving training data:  61%|6| 150/246 [00:09<00:05, 16.22itNormalizing and saving training data:  65%|6| 160/246 [00:09<00:05, 16.22itNormalizing and saving training data:  69%|6| 170/246 [00:10<00:04, 16.04itNormalizing and saving training data:  73%|7| 180/246 [00:11<00:04, 16.07itNormalizing and saving training data:  77%|7| 190/246 [00:11<00:03, 16.16itNormalizing and saving training data:  81%|8| 200/246 [00:12<00:02, 16.24itNormalizing and saving training data:  85%|8| 210/246 [00:13<00:02, 16.24itNormalizing and saving training data:  89%|8| 220/246 [00:13<00:01, 16.22itNormalizing and saving training data:  93%|9| 230/246 [00:14<00:00, 16.13itNormalizing and saving training data:  98%|9| 240/246 [00:14<00:00, 16.02itNormalizing and saving training data: 100%|#| 246/246 [00:14<00:00, 16.43it
2025-11-21 11:21:40,785 - INFO - Training data processing completed during stats computation phase
2025-11-21 11:21:40,792 - INFO - Loaded normalization statistics:
2025-11-21 11:21:40,792 - INFO -   Mean: 0.080317
2025-11-21 11:21:40,792 - INFO -   Std: 2.155404
2025-11-21 11:21:40,792 - INFO - Split train already completed, skipping
2025-11-21 11:21:40,792 - INFO - Processing test split...
2025-11-21 11:21:40,792 - INFO - Need to process 38/38 sequences for test
2025-11-21 11:21:40,792 - INFO - Processing 38 sequences from 6 unique files
2025-11-21 11:21:40,792 - INFO - Average 6.3 sequences per file
Processing test:   0%|                              | 0/38 [00:00<?, ?it/s]Processing test:   3%|5                     | 1/38 [00:00<00:29,  1.27it/s]Processing test:   5%|#1                    | 2/38 [00:01<00:35,  1.01it/s]2025-11-21 11:21:42,713 - INFO - Creating new HDF5 file or datasets in: preprocessing\data\chb23_fold6\test_dataset.h5
2025-11-21 11:21:43,933 - INFO - Progress: 266/284 (93.7%) - ETA: 0.1 minutes
Processing test:  55%|###########6         | 21/38 [00:08<00:06,  2.56it/s]Processing test:  79%|################5    | 30/38 [00:08<00:02,  3.95it/s]2025-11-21 11:21:50,422 - INFO - Progress: 276/284 (97.2%) - ETA: 0.0 minutes
Processing test:  84%|#################6   | 32/38 [00:13<00:02,  2.08it/s]Processing test:  92%|###################3 | 35/38 [00:17<00:01,  1.51it/s]Processing test: 100%|#####################| 38/38 [00:17<00:00,  2.12it/s]
2025-11-21 11:21:59,298 - INFO - Validating final datasets...
2025-11-21 11:21:59,306 - INFO - train dataset validation:
2025-11-21 11:21:59,306 - INFO -   - Segments: 246
2025-11-21 11:21:59,307 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:21:59,307 - INFO -   - Classes: 123 preictal, 123 interictal
2025-11-21 11:21:59,307 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:21:59,312 - INFO - test dataset validation:
2025-11-21 11:21:59,312 - INFO -   - Segments: 38
2025-11-21 11:21:59,312 - INFO -   - Spectrogram shape: (30, 18, 50, 10)
2025-11-21 11:21:59,312 - INFO -   - Classes: 19 preictal, 19 interictal
2025-11-21 11:21:59,312 - INFO -   - Balance: 50.0% preictal
2025-11-21 11:21:59,312 - INFO - ============================================================
2025-11-21 11:21:59,312 - INFO - PREPROCESSING COMPLETED SUCCESSFULLY
2025-11-21 11:21:59,312 - INFO - Total time: 1.1 minutes
2025-11-21 11:21:59,312 - INFO - Processed segments: 284
2025-11-21 11:21:59,312 - INFO - Average rate: 4.3 segments/second
2025-11-21 11:21:59,312 - INFO - ============================================================
✅ Fold 6 preprocessing completed successfully!

============================================================
✅ BATCH PREPROCESSING COMPLETED!
✅ Processed 7 folds for patient chb23
============================================================
============================================================
BATCH PROCESSING: ALL FOLDS
Processing 7 folds for patient chb23
============================================================

============================================================
TRAINING FOLD 0/6
============================================================
Using dataset prefix: chb23_fold0
Loading datasets from: preprocessing\data\chb23_fold0
Saving models to: model\chb23_fold0
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.1190, std=2.1417
Loaded train dataset: 242 samples
  - Spectrogram shape: torch.Size([242, 30, 18, 50, 10])
  - Value range: [-5.6585, 3.9074]
  - Class distribution: tensor([121, 121])
LOOCV Mode (Fold 0): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/16 [00:04<?, ?it/s, loss=0.6929, grad_norm=1.221, lr=0.000010]Training Epoch 1/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:03,  4.23s/it, loss=0.6929, grad_norm=1.221, lr=0.000010]Training Epoch 1/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:03,  4.23s/it, loss=0.6892, grad_norm=1.166, lr=0.000010]Training Epoch 1/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:25,  1.81s/it, loss=0.6892, grad_norm=1.166, lr=0.000010]Training Epoch 1/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:25,  1.81s/it, loss=0.6793, grad_norm=1.183, lr=0.000010]Training Epoch 1/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:13,  1.04s/it, loss=0.6793, grad_norm=1.183, lr=0.000010]Training Epoch 1/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:13,  1.04s/it, loss=0.6951, grad_norm=1.294, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:08,  1.49it/s, loss=0.6951, grad_norm=1.294, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:08,  1.49it/s, loss=0.6922, grad_norm=1.250, lr=0.000010]Training Epoch 1/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:05,  2.13it/s, loss=0.6922, grad_norm=1.250, lr=0.000010]Training Epoch 1/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:05,  2.13it/s, loss=0.6785, grad_norm=1.319, lr=0.000010]Training Epoch 1/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.86it/s, loss=0.6785, grad_norm=1.319, lr=0.000010]Training Epoch 1/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.86it/s, loss=0.6773, grad_norm=1.159, lr=0.000010]Training Epoch 1/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.66it/s, loss=0.6773, grad_norm=1.159, lr=0.000010]Training Epoch 1/5:  44%|############################################################################5                                                                                                  | 7/16 [00:05<00:02,  3.66it/s, loss=0.6642, grad_norm=1.171, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:05<00:01,  4.43it/s, loss=0.6642, grad_norm=1.171, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:05<00:01,  4.43it/s, loss=0.6804, grad_norm=1.272, lr=0.000010]Training Epoch 1/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  5.08it/s, loss=0.6804, grad_norm=1.272, lr=0.000010]Training Epoch 1/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  5.08it/s, loss=0.6598, grad_norm=1.302, lr=0.000010]Training Epoch 1/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:01,  5.76it/s, loss=0.6598, grad_norm=1.302, lr=0.000010]Training Epoch 1/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:01,  5.76it/s, loss=0.6983, grad_norm=1.470, lr=0.000010]Training Epoch 1/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.14it/s, loss=0.6983, grad_norm=1.470, lr=0.000010]Training Epoch 1/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.14it/s, loss=0.6542, grad_norm=1.325, lr=0.000010]Training Epoch 1/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  6.41it/s, loss=0.6542, grad_norm=1.325, lr=0.000010]Training Epoch 1/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  6.41it/s, loss=0.6556, grad_norm=1.128, lr=0.000010]Training Epoch 1/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  6.55it/s, loss=0.6556, grad_norm=1.128, lr=0.000010]Training Epoch 1/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  6.55it/s, loss=0.6663, grad_norm=1.177, lr=0.000010]Training Epoch 1/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  6.73it/s, loss=0.6663, grad_norm=1.177, lr=0.000010]Training Epoch 1/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  6.73it/s, loss=0.6571, grad_norm=1.064, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  7.06it/s, loss=0.6571, grad_norm=1.064, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################1          | 15/16 [00:06<00:00,  7.06it/s, loss=0.6599, grad_norm=3.136, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.36it/s, loss=0.6599, grad_norm=3.136, lr=0.000010]

Epoch 1/5 Complete (7.2s) [LR: 0.000010]
Train - Loss: 0.6750, Acc: 0.6157, Precision: 0.5707, Recall: 0.9339, F1: 0.7085, AUC: 0.7193
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/16 [00:04<?, ?it/s, loss=0.6283, grad_norm=1.351, lr=0.000010]Training Epoch 2/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:01,  4.11s/it, loss=0.6283, grad_norm=1.351, lr=0.000010]Training Epoch 2/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:01,  4.11s/it, loss=0.6390, grad_norm=1.338, lr=0.000010]Training Epoch 2/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.76s/it, loss=0.6390, grad_norm=1.338, lr=0.000010]Training Epoch 2/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.76s/it, loss=0.6335, grad_norm=1.184, lr=0.000010]Training Epoch 2/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:13,  1.01s/it, loss=0.6335, grad_norm=1.184, lr=0.000010]Training Epoch 2/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:13,  1.01s/it, loss=0.6484, grad_norm=1.205, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.53it/s, loss=0.6484, grad_norm=1.205, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.53it/s, loss=0.6210, grad_norm=1.498, lr=0.000010]Training Epoch 2/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:05,  2.19it/s, loss=0.6210, grad_norm=1.498, lr=0.000010]Training Epoch 2/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:05,  2.19it/s, loss=0.6623, grad_norm=1.078, lr=0.000010]Training Epoch 2/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.97it/s, loss=0.6623, grad_norm=1.078, lr=0.000010]Training Epoch 2/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.97it/s, loss=0.6496, grad_norm=1.215, lr=0.000010]Training Epoch 2/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.81it/s, loss=0.6496, grad_norm=1.215, lr=0.000010]Training Epoch 2/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.81it/s, loss=0.6354, grad_norm=1.067, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.67it/s, loss=0.6354, grad_norm=1.067, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.67it/s, loss=0.6292, grad_norm=1.137, lr=0.000010]Training Epoch 2/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.49it/s, loss=0.6292, grad_norm=1.137, lr=0.000010]Training Epoch 2/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  5.49it/s, loss=0.6161, grad_norm=1.135, lr=0.000010]Training Epoch 2/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.26it/s, loss=0.6161, grad_norm=1.135, lr=0.000010]Training Epoch 2/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.26it/s, loss=0.6186, grad_norm=1.047, lr=0.000010]Training Epoch 2/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.91it/s, loss=0.6186, grad_norm=1.047, lr=0.000010]Training Epoch 2/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.91it/s, loss=0.6077, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.45it/s, loss=0.6077, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.45it/s, loss=0.6067, grad_norm=1.064, lr=0.000010]Training Epoch 2/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.89it/s, loss=0.6067, grad_norm=1.064, lr=0.000010]Training Epoch 2/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.89it/s, loss=0.6054, grad_norm=1.159, lr=0.000010]Training Epoch 2/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.29it/s, loss=0.6054, grad_norm=1.159, lr=0.000010]Training Epoch 2/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.29it/s, loss=0.6093, grad_norm=1.097, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.54it/s, loss=0.6093, grad_norm=1.097, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.54it/s, loss=0.5501, grad_norm=2.563, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.56it/s, loss=0.5501, grad_norm=2.563, lr=0.000010]

Epoch 2/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6225, Acc: 0.7355, Precision: 0.6592, Recall: 0.9752, F1: 0.7867, AUC: 0.7817
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/16 [00:04<?, ?it/s, loss=0.5693, grad_norm=1.031, lr=0.000010]Training Epoch 3/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:01,  4.08s/it, loss=0.5693, grad_norm=1.031, lr=0.000010]Training Epoch 3/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:01,  4.08s/it, loss=0.5682, grad_norm=1.015, lr=0.000010]Training Epoch 3/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.76s/it, loss=0.5682, grad_norm=1.015, lr=0.000010]Training Epoch 3/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.76s/it, loss=0.5939, grad_norm=1.097, lr=0.000010]Training Epoch 3/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:13,  1.01s/it, loss=0.5939, grad_norm=1.097, lr=0.000010]Training Epoch 3/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:13,  1.01s/it, loss=0.5801, grad_norm=1.054, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.53it/s, loss=0.5801, grad_norm=1.054, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.53it/s, loss=0.6456, grad_norm=2.009, lr=0.000010]Training Epoch 3/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:05,  2.18it/s, loss=0.6456, grad_norm=2.009, lr=0.000010]Training Epoch 3/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:05,  2.18it/s, loss=0.5885, grad_norm=1.015, lr=0.000010]Training Epoch 3/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.94it/s, loss=0.5885, grad_norm=1.015, lr=0.000010]Training Epoch 3/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.94it/s, loss=0.5473, grad_norm=0.951, lr=0.000010]Training Epoch 3/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.77it/s, loss=0.5473, grad_norm=0.951, lr=0.000010]Training Epoch 3/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.77it/s, loss=0.5628, grad_norm=0.965, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.61it/s, loss=0.5628, grad_norm=0.965, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.61it/s, loss=0.5265, grad_norm=1.115, lr=0.000010]Training Epoch 3/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.45it/s, loss=0.5265, grad_norm=1.115, lr=0.000010]Training Epoch 3/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  5.45it/s, loss=0.5928, grad_norm=1.138, lr=0.000010]Training Epoch 3/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.20it/s, loss=0.5928, grad_norm=1.138, lr=0.000010]Training Epoch 3/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.20it/s, loss=0.5695, grad_norm=1.441, lr=0.000010]Training Epoch 3/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.90it/s, loss=0.5695, grad_norm=1.441, lr=0.000010]Training Epoch 3/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.90it/s, loss=0.5478, grad_norm=1.386, lr=0.000010]Training Epoch 3/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.43it/s, loss=0.5478, grad_norm=1.386, lr=0.000010]Training Epoch 3/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.43it/s, loss=0.6138, grad_norm=1.304, lr=0.000010]Training Epoch 3/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.91it/s, loss=0.6138, grad_norm=1.304, lr=0.000010]Training Epoch 3/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.91it/s, loss=0.5725, grad_norm=1.157, lr=0.000010]Training Epoch 3/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.23it/s, loss=0.5725, grad_norm=1.157, lr=0.000010]Training Epoch 3/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.23it/s, loss=0.4632, grad_norm=1.103, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.46it/s, loss=0.4632, grad_norm=1.103, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.46it/s, loss=0.6093, grad_norm=5.464, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.54it/s, loss=0.6093, grad_norm=5.464, lr=0.000010]

Epoch 3/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.5719, Acc: 0.7438, Precision: 0.6725, Recall: 0.9504, F1: 0.7877, AUC: 0.8129
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/16 [00:03<?, ?it/s, loss=0.5014, grad_norm=1.038, lr=0.000010]Training Epoch 4/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:03<00:59,  3.96s/it, loss=0.5014, grad_norm=1.038, lr=0.000010]Training Epoch 4/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<00:59,  3.96s/it, loss=0.5769, grad_norm=1.663, lr=0.000010]Training Epoch 4/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.70s/it, loss=0.5769, grad_norm=1.663, lr=0.000010]Training Epoch 4/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.70s/it, loss=0.5156, grad_norm=1.492, lr=0.000010]Training Epoch 4/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.03it/s, loss=0.5156, grad_norm=1.492, lr=0.000010]Training Epoch 4/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.03it/s, loss=0.5602, grad_norm=1.631, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.58it/s, loss=0.5602, grad_norm=1.631, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.58it/s, loss=0.5781, grad_norm=1.387, lr=0.000010]Training Epoch 4/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.26it/s, loss=0.5781, grad_norm=1.387, lr=0.000010]Training Epoch 4/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.26it/s, loss=0.4678, grad_norm=1.345, lr=0.000010]Training Epoch 4/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.04it/s, loss=0.4678, grad_norm=1.345, lr=0.000010]Training Epoch 4/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.04it/s, loss=0.4606, grad_norm=1.487, lr=0.000010]Training Epoch 4/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.89it/s, loss=0.4606, grad_norm=1.487, lr=0.000010]Training Epoch 4/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.89it/s, loss=0.4025, grad_norm=1.267, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.77it/s, loss=0.4025, grad_norm=1.267, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.77it/s, loss=0.4349, grad_norm=1.345, lr=0.000010]Training Epoch 4/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.62it/s, loss=0.4349, grad_norm=1.345, lr=0.000010]Training Epoch 4/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.62it/s, loss=0.4266, grad_norm=1.733, lr=0.000010]Training Epoch 4/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.37it/s, loss=0.4266, grad_norm=1.733, lr=0.000010]Training Epoch 4/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.37it/s, loss=0.5749, grad_norm=2.337, lr=0.000010]Training Epoch 4/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  7.01it/s, loss=0.5749, grad_norm=2.337, lr=0.000010]Training Epoch 4/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  7.01it/s, loss=0.5082, grad_norm=2.330, lr=0.000010]Training Epoch 4/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.61it/s, loss=0.5082, grad_norm=2.330, lr=0.000010]Training Epoch 4/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.61it/s, loss=0.3609, grad_norm=1.620, lr=0.000010]Training Epoch 4/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.85it/s, loss=0.3609, grad_norm=1.620, lr=0.000010]Training Epoch 4/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.85it/s, loss=0.4473, grad_norm=1.706, lr=0.000010]Training Epoch 4/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.03it/s, loss=0.4473, grad_norm=1.706, lr=0.000010]Training Epoch 4/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.03it/s, loss=0.5006, grad_norm=2.537, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.29it/s, loss=0.5006, grad_norm=2.537, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.29it/s, loss=0.2800, grad_norm=2.726, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.62it/s, loss=0.2800, grad_norm=2.726, lr=0.000010]

Epoch 4/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.4748, Acc: 0.8099, Precision: 0.7246, Recall: 1.0000, F1: 0.8403, AUC: 0.9275
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/16 [00:04<?, ?it/s, loss=0.4370, grad_norm=2.292, lr=0.000010]Training Epoch 5/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:00,  4.05s/it, loss=0.4370, grad_norm=2.292, lr=0.000010]Training Epoch 5/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:00,  4.05s/it, loss=0.4294, grad_norm=1.838, lr=0.000010]Training Epoch 5/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.74s/it, loss=0.4294, grad_norm=1.838, lr=0.000010]Training Epoch 5/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.74s/it, loss=0.4288, grad_norm=2.312, lr=0.000010]Training Epoch 5/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.00it/s, loss=0.4288, grad_norm=2.312, lr=0.000010]Training Epoch 5/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.00it/s, loss=0.3885, grad_norm=2.971, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.53it/s, loss=0.3885, grad_norm=2.971, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.53it/s, loss=0.3518, grad_norm=1.886, lr=0.000010]Training Epoch 5/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:05,  2.16it/s, loss=0.3518, grad_norm=1.886, lr=0.000010]Training Epoch 5/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:05,  2.16it/s, loss=0.4088, grad_norm=3.173, lr=0.000010]Training Epoch 5/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.89it/s, loss=0.4088, grad_norm=3.173, lr=0.000010]Training Epoch 5/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.89it/s, loss=0.2738, grad_norm=1.736, lr=0.000010]Training Epoch 5/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.63it/s, loss=0.2738, grad_norm=1.736, lr=0.000010]Training Epoch 5/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.63it/s, loss=0.3155, grad_norm=2.438, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.33it/s, loss=0.3155, grad_norm=2.438, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:05<00:01,  4.33it/s, loss=0.2830, grad_norm=1.935, lr=0.000010]Training Epoch 5/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  4.97it/s, loss=0.2830, grad_norm=1.935, lr=0.000010]Training Epoch 5/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  4.97it/s, loss=0.2782, grad_norm=1.761, lr=0.000010]Training Epoch 5/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:01,  5.63it/s, loss=0.2782, grad_norm=1.761, lr=0.000010]Training Epoch 5/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:01,  5.63it/s, loss=0.2703, grad_norm=2.167, lr=0.000010]Training Epoch 5/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.11it/s, loss=0.2703, grad_norm=2.167, lr=0.000010]Training Epoch 5/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.11it/s, loss=0.4861, grad_norm=7.466, lr=0.000010]Training Epoch 5/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  6.46it/s, loss=0.4861, grad_norm=7.466, lr=0.000010]Training Epoch 5/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  6.46it/s, loss=0.1991, grad_norm=1.737, lr=0.000010]Training Epoch 5/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  6.74it/s, loss=0.1991, grad_norm=1.737, lr=0.000010]Training Epoch 5/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  6.74it/s, loss=0.2289, grad_norm=2.184, lr=0.000010]Training Epoch 5/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  7.18it/s, loss=0.2289, grad_norm=2.184, lr=0.000010]Training Epoch 5/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  7.18it/s, loss=0.2201, grad_norm=2.956, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  7.61it/s, loss=0.2201, grad_norm=2.956, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  7.61it/s, loss=0.2017, grad_norm=3.182, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.48it/s, loss=0.2017, grad_norm=3.182, lr=0.000010]

Epoch 5/5 Complete (6.9s) [LR: 0.000005]
Train - Loss: 0.3250, Acc: 0.9587, Precision: 0.9512, Recall: 0.9669, F1: 0.9590, AUC: 0.9931
------------------------------------------------------------
Training curves saved to model\chb23_fold0\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb23_fold0
============================================================
✅ Fold 0 training completed successfully!

============================================================
TRAINING FOLD 1/6
============================================================
Using dataset prefix: chb23_fold1
Loading datasets from: preprocessing\data\chb23_fold1
Saving models to: model\chb23_fold1
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.1367, std=2.1215
Loaded train dataset: 258 samples
  - Spectrogram shape: torch.Size([258, 30, 18, 50, 10])
  - Value range: [-5.7207, 3.9711]
  - Class distribution: tensor([129, 129])
LOOCV Mode (Fold 1): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.6968, grad_norm=1.072, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:09,  4.37s/it, loss=0.6968, grad_norm=1.072, lr=0.000010]Training Epoch 1/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:09,  4.37s/it, loss=0.6981, grad_norm=1.021, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:28,  1.87s/it, loss=0.6981, grad_norm=1.021, lr=0.000010]Training Epoch 1/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:28,  1.87s/it, loss=0.6875, grad_norm=1.078, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.07s/it, loss=0.6875, grad_norm=1.078, lr=0.000010]Training Epoch 1/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.07s/it, loss=0.6940, grad_norm=1.103, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.44it/s, loss=0.6940, grad_norm=1.103, lr=0.000010]Training Epoch 1/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.44it/s, loss=0.6958, grad_norm=1.380, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.06it/s, loss=0.6958, grad_norm=1.380, lr=0.000010]Training Epoch 1/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.06it/s, loss=0.6929, grad_norm=1.052, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.79it/s, loss=0.6929, grad_norm=1.052, lr=0.000010]Training Epoch 1/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:05<00:03,  2.79it/s, loss=0.6961, grad_norm=1.012, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.46it/s, loss=0.6961, grad_norm=1.012, lr=0.000010]Training Epoch 1/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.46it/s, loss=0.6906, grad_norm=1.072, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.13it/s, loss=0.6906, grad_norm=1.072, lr=0.000010]Training Epoch 1/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.13it/s, loss=0.6896, grad_norm=1.013, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  4.76it/s, loss=0.6896, grad_norm=1.013, lr=0.000010]Training Epoch 1/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  4.76it/s, loss=0.6882, grad_norm=1.219, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.44it/s, loss=0.6882, grad_norm=1.219, lr=0.000010]Training Epoch 1/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.44it/s, loss=0.6858, grad_norm=1.022, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.10it/s, loss=0.6858, grad_norm=1.022, lr=0.000010]Training Epoch 1/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.10it/s, loss=0.6843, grad_norm=1.284, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  6.68it/s, loss=0.6843, grad_norm=1.284, lr=0.000010]Training Epoch 1/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  6.68it/s, loss=0.6801, grad_norm=0.994, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.25it/s, loss=0.6801, grad_norm=0.994, lr=0.000010]Training Epoch 1/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.25it/s, loss=0.6783, grad_norm=1.404, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.46it/s, loss=0.6783, grad_norm=1.404, lr=0.000010]Training Epoch 1/5:  82%|###############################################################################################################################################2                              | 14/17 [00:06<00:00,  7.46it/s, loss=0.6777, grad_norm=1.061, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:06<00:00,  7.39it/s, loss=0.6777, grad_norm=1.061, lr=0.000010]Training Epoch 1/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:06<00:00,  7.39it/s, loss=0.6824, grad_norm=1.106, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  7.52it/s, loss=0.6824, grad_norm=1.106, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################7          | 16/17 [00:06<00:00,  7.52it/s, loss=0.7000, grad_norm=3.011, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.48it/s, loss=0.7000, grad_norm=3.011, lr=0.000010]

Epoch 1/5 Complete (7.3s) [LR: 0.000010]
Train - Loss: 0.6893, Acc: 0.5620, Precision: 0.5656, Recall: 0.5349, F1: 0.5498, AUC: 0.5843
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/17 [00:03<?, ?it/s, loss=0.6694, grad_norm=1.158, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:03<01:02,  3.93s/it, loss=0.6694, grad_norm=1.158, lr=0.000010]Training Epoch 2/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:02,  3.93s/it, loss=0.6692, grad_norm=1.077, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:25,  1.69s/it, loss=0.6692, grad_norm=1.077, lr=0.000010]Training Epoch 2/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:25,  1.69s/it, loss=0.6655, grad_norm=1.211, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:13,  1.02it/s, loss=0.6655, grad_norm=1.211, lr=0.000010]Training Epoch 2/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:13,  1.02it/s, loss=0.6744, grad_norm=1.093, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.56it/s, loss=0.6744, grad_norm=1.093, lr=0.000010]Training Epoch 2/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.56it/s, loss=0.6817, grad_norm=1.133, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.19it/s, loss=0.6817, grad_norm=1.133, lr=0.000010]Training Epoch 2/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.19it/s, loss=0.6763, grad_norm=1.161, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.97it/s, loss=0.6763, grad_norm=1.161, lr=0.000010]Training Epoch 2/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.97it/s, loss=0.6532, grad_norm=1.077, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.82it/s, loss=0.6532, grad_norm=1.077, lr=0.000010]Training Epoch 2/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.82it/s, loss=0.6662, grad_norm=1.268, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.59it/s, loss=0.6662, grad_norm=1.268, lr=0.000010]Training Epoch 2/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.59it/s, loss=0.6591, grad_norm=1.197, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:04<00:01,  5.23it/s, loss=0.6591, grad_norm=1.197, lr=0.000010]Training Epoch 2/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.23it/s, loss=0.6627, grad_norm=1.133, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.79it/s, loss=0.6627, grad_norm=1.133, lr=0.000010]Training Epoch 2/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  5.79it/s, loss=0.6599, grad_norm=1.164, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.27it/s, loss=0.6599, grad_norm=1.164, lr=0.000010]Training Epoch 2/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.27it/s, loss=0.6699, grad_norm=1.107, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  6.61it/s, loss=0.6699, grad_norm=1.107, lr=0.000010]Training Epoch 2/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  6.61it/s, loss=0.6575, grad_norm=1.195, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.02it/s, loss=0.6575, grad_norm=1.195, lr=0.000010]Training Epoch 2/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.02it/s, loss=0.6281, grad_norm=1.112, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.19it/s, loss=0.6281, grad_norm=1.112, lr=0.000010]Training Epoch 2/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.19it/s, loss=0.6319, grad_norm=1.109, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  7.29it/s, loss=0.6319, grad_norm=1.109, lr=0.000010]Training Epoch 2/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  7.29it/s, loss=0.6271, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  7.37it/s, loss=0.6271, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  7.37it/s, loss=0.7708, grad_norm=3.290, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.63it/s, loss=0.7708, grad_norm=3.290, lr=0.000010]

Epoch 2/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6661, Acc: 0.6899, Precision: 0.7130, Recall: 0.6357, F1: 0.6721, AUC: 0.7945
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/17 [00:03<?, ?it/s, loss=0.6320, grad_norm=1.027, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:03<01:03,  3.99s/it, loss=0.6320, grad_norm=1.027, lr=0.000010]Training Epoch 3/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:03,  3.99s/it, loss=0.6167, grad_norm=1.160, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:25,  1.71s/it, loss=0.6167, grad_norm=1.160, lr=0.000010]Training Epoch 3/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:25,  1.71s/it, loss=0.6718, grad_norm=1.637, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:13,  1.02it/s, loss=0.6718, grad_norm=1.637, lr=0.000010]Training Epoch 3/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:13,  1.02it/s, loss=0.6317, grad_norm=1.268, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.56it/s, loss=0.6317, grad_norm=1.268, lr=0.000010]Training Epoch 3/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.56it/s, loss=0.6081, grad_norm=0.982, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.22it/s, loss=0.6081, grad_norm=0.982, lr=0.000010]Training Epoch 3/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.22it/s, loss=0.6393, grad_norm=1.099, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  3.00it/s, loss=0.6393, grad_norm=1.099, lr=0.000010]Training Epoch 3/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  3.00it/s, loss=0.6140, grad_norm=1.154, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.86it/s, loss=0.6140, grad_norm=1.154, lr=0.000010]Training Epoch 3/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.86it/s, loss=0.6192, grad_norm=1.283, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.70it/s, loss=0.6192, grad_norm=1.283, lr=0.000010]Training Epoch 3/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:01,  4.70it/s, loss=0.6067, grad_norm=1.092, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:04<00:01,  5.43it/s, loss=0.6067, grad_norm=1.092, lr=0.000010]Training Epoch 3/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.43it/s, loss=0.5784, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.22it/s, loss=0.5784, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.22it/s, loss=0.6403, grad_norm=1.286, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.93it/s, loss=0.6403, grad_norm=1.286, lr=0.000010]Training Epoch 3/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.93it/s, loss=0.5990, grad_norm=1.069, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.21it/s, loss=0.5990, grad_norm=1.069, lr=0.000010]Training Epoch 3/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.21it/s, loss=0.5420, grad_norm=1.274, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.33it/s, loss=0.5420, grad_norm=1.274, lr=0.000010]Training Epoch 3/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.33it/s, loss=0.5592, grad_norm=1.189, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.50it/s, loss=0.5592, grad_norm=1.189, lr=0.000010]Training Epoch 3/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  7.50it/s, loss=0.6349, grad_norm=1.373, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  7.77it/s, loss=0.6349, grad_norm=1.373, lr=0.000010]Training Epoch 3/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  7.77it/s, loss=0.5230, grad_norm=1.183, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.09it/s, loss=0.5230, grad_norm=1.183, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.09it/s, loss=0.6824, grad_norm=3.925, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.68it/s, loss=0.6824, grad_norm=3.925, lr=0.000010]

Epoch 3/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6117, Acc: 0.7597, Precision: 0.7006, Recall: 0.9070, F1: 0.7905, AUC: 0.8466
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.5563, grad_norm=1.089, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.24s/it, loss=0.5563, grad_norm=1.089, lr=0.000010]Training Epoch 4/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:07,  4.24s/it, loss=0.5420, grad_norm=1.154, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.83s/it, loss=0.5420, grad_norm=1.154, lr=0.000010]Training Epoch 4/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:27,  1.83s/it, loss=0.5140, grad_norm=1.254, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.5140, grad_norm=1.254, lr=0.000010]Training Epoch 4/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.04s/it, loss=0.5625, grad_norm=1.468, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.5625, grad_norm=1.468, lr=0.000010]Training Epoch 4/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.49it/s, loss=0.5405, grad_norm=0.984, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.5405, grad_norm=0.984, lr=0.000010]Training Epoch 4/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.13it/s, loss=0.5665, grad_norm=1.250, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.89it/s, loss=0.5665, grad_norm=1.250, lr=0.000010]Training Epoch 4/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.89it/s, loss=0.5594, grad_norm=1.337, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.71it/s, loss=0.5594, grad_norm=1.337, lr=0.000010]Training Epoch 4/5:  41%|########################################################################                                                                                                       | 7/17 [00:05<00:02,  3.71it/s, loss=0.5604, grad_norm=1.613, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.56it/s, loss=0.5604, grad_norm=1.613, lr=0.000010]Training Epoch 4/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:01,  4.56it/s, loss=0.5244, grad_norm=1.477, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.42it/s, loss=0.5244, grad_norm=1.477, lr=0.000010]Training Epoch 4/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.42it/s, loss=0.5260, grad_norm=1.445, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.19it/s, loss=0.5260, grad_norm=1.445, lr=0.000010]Training Epoch 4/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.19it/s, loss=0.5270, grad_norm=1.408, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.73it/s, loss=0.5270, grad_norm=1.408, lr=0.000010]Training Epoch 4/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.73it/s, loss=0.4967, grad_norm=1.377, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.31it/s, loss=0.4967, grad_norm=1.377, lr=0.000010]Training Epoch 4/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.31it/s, loss=0.5891, grad_norm=1.799, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.75it/s, loss=0.5891, grad_norm=1.799, lr=0.000010]Training Epoch 4/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.75it/s, loss=0.5465, grad_norm=1.680, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.10it/s, loss=0.5465, grad_norm=1.680, lr=0.000010]Training Epoch 4/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.10it/s, loss=0.4975, grad_norm=1.597, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.37it/s, loss=0.4975, grad_norm=1.597, lr=0.000010]Training Epoch 4/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.37it/s, loss=0.4197, grad_norm=1.631, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.56it/s, loss=0.4197, grad_norm=1.631, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.56it/s, loss=0.6534, grad_norm=4.352, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.59it/s, loss=0.6534, grad_norm=4.352, lr=0.000010]

Epoch 4/5 Complete (7.0s) [LR: 0.000010]
Train - Loss: 0.5401, Acc: 0.7907, Precision: 0.7143, Recall: 0.9690, F1: 0.8224, AUC: 0.9019
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/17 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/17 [00:04<?, ?it/s, loss=0.5067, grad_norm=2.179, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:04,  4.04s/it, loss=0.5067, grad_norm=2.179, lr=0.000010]Training Epoch 5/5:   6%|##########2                                                                                                                                                                    | 1/17 [00:04<01:04,  4.04s/it, loss=0.3921, grad_norm=1.511, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:25,  1.73s/it, loss=0.3921, grad_norm=1.511, lr=0.000010]Training Epoch 5/5:  12%|####################5                                                                                                                                                          | 2/17 [00:04<00:25,  1.73s/it, loss=0.5154, grad_norm=1.817, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.00s/it, loss=0.5154, grad_norm=1.817, lr=0.000010]Training Epoch 5/5:  18%|##############################8                                                                                                                                                | 3/17 [00:04<00:14,  1.00s/it, loss=0.4179, grad_norm=1.804, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.4179, grad_norm=1.804, lr=0.000010]Training Epoch 5/5:  24%|#########################################1                                                                                                                                     | 4/17 [00:04<00:08,  1.52it/s, loss=0.3428, grad_norm=1.262, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.18it/s, loss=0.3428, grad_norm=1.262, lr=0.000010]Training Epoch 5/5:  29%|###################################################4                                                                                                                           | 5/17 [00:04<00:05,  2.18it/s, loss=0.4246, grad_norm=2.238, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.90it/s, loss=0.4246, grad_norm=2.238, lr=0.000010]Training Epoch 5/5:  35%|#############################################################7                                                                                                                 | 6/17 [00:04<00:03,  2.90it/s, loss=0.4374, grad_norm=1.902, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.63it/s, loss=0.4374, grad_norm=1.902, lr=0.000010]Training Epoch 5/5:  41%|########################################################################                                                                                                       | 7/17 [00:04<00:02,  3.63it/s, loss=0.3957, grad_norm=1.781, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:04<00:02,  4.46it/s, loss=0.3957, grad_norm=1.781, lr=0.000010]Training Epoch 5/5:  47%|##################################################################################3                                                                                            | 8/17 [00:05<00:02,  4.46it/s, loss=0.4071, grad_norm=1.953, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.30it/s, loss=0.4071, grad_norm=1.953, lr=0.000010]Training Epoch 5/5:  53%|############################################################################################6                                                                                  | 9/17 [00:05<00:01,  5.30it/s, loss=0.3713, grad_norm=1.914, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.09it/s, loss=0.3713, grad_norm=1.914, lr=0.000010]Training Epoch 5/5:  59%|######################################################################################################3                                                                       | 10/17 [00:05<00:01,  6.09it/s, loss=0.3402, grad_norm=1.551, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.77it/s, loss=0.3402, grad_norm=1.551, lr=0.000010]Training Epoch 5/5:  65%|################################################################################################################5                                                             | 11/17 [00:05<00:00,  6.77it/s, loss=0.4000, grad_norm=2.800, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.39it/s, loss=0.4000, grad_norm=2.800, lr=0.000010]Training Epoch 5/5:  71%|##########################################################################################################################8                                                   | 12/17 [00:05<00:00,  7.39it/s, loss=0.2821, grad_norm=1.212, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.85it/s, loss=0.2821, grad_norm=1.212, lr=0.000010]Training Epoch 5/5:  76%|#####################################################################################################################################                                         | 13/17 [00:05<00:00,  7.85it/s, loss=0.4117, grad_norm=4.249, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.27it/s, loss=0.4117, grad_norm=4.249, lr=0.000010]Training Epoch 5/5:  82%|###############################################################################################################################################2                              | 14/17 [00:05<00:00,  8.27it/s, loss=0.3768, grad_norm=1.706, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.52it/s, loss=0.3768, grad_norm=1.706, lr=0.000010]Training Epoch 5/5:  88%|#########################################################################################################################################################5                    | 15/17 [00:05<00:00,  8.52it/s, loss=0.3497, grad_norm=2.736, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.69it/s, loss=0.3497, grad_norm=2.736, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################7          | 16/17 [00:05<00:00,  8.69it/s, loss=0.6849, grad_norm=4.012, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 17/17 [00:06<00:00,  2.66it/s, loss=0.6849, grad_norm=4.012, lr=0.000010]

Epoch 5/5 Complete (6.8s) [LR: 0.000005]
Train - Loss: 0.4151, Acc: 0.8992, Precision: 0.8652, Recall: 0.9457, F1: 0.9037, AUC: 0.9478
------------------------------------------------------------
Training curves saved to model\chb23_fold1\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb23_fold1
============================================================
✅ Fold 1 training completed successfully!

============================================================
TRAINING FOLD 2/6
============================================================
Using dataset prefix: chb23_fold2
Loading datasets from: preprocessing\data\chb23_fold2
Saving models to: model\chb23_fold2
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.1484, std=2.1125
Loaded train dataset: 236 samples
  - Spectrogram shape: torch.Size([236, 30, 18, 50, 10])
  - Value range: [-5.7507, 3.9476]
  - Class distribution: tensor([118, 118])
LOOCV Mode (Fold 2): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/15 [00:04<?, ?it/s, loss=0.6895, grad_norm=1.023, lr=0.000010]Training Epoch 1/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:57,  4.11s/it, loss=0.6895, grad_norm=1.023, lr=0.000010]Training Epoch 1/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:57,  4.11s/it, loss=0.6839, grad_norm=0.959, lr=0.000010]Training Epoch 1/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.77s/it, loss=0.6839, grad_norm=0.959, lr=0.000010]Training Epoch 1/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.77s/it, loss=0.6929, grad_norm=1.053, lr=0.000010]Training Epoch 1/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.01s/it, loss=0.6929, grad_norm=1.053, lr=0.000010]Training Epoch 1/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.01s/it, loss=0.6920, grad_norm=1.038, lr=0.000010]Training Epoch 1/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.52it/s, loss=0.6920, grad_norm=1.038, lr=0.000010]Training Epoch 1/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.52it/s, loss=0.6877, grad_norm=0.977, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.17it/s, loss=0.6877, grad_norm=0.977, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.17it/s, loss=0.7182, grad_norm=1.307, lr=0.000010]Training Epoch 1/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.93it/s, loss=0.7182, grad_norm=1.307, lr=0.000010]Training Epoch 1/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.93it/s, loss=0.6905, grad_norm=0.971, lr=0.000010]Training Epoch 1/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.78it/s, loss=0.6905, grad_norm=0.971, lr=0.000010]Training Epoch 1/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.78it/s, loss=0.6981, grad_norm=0.946, lr=0.000010]Training Epoch 1/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.62it/s, loss=0.6981, grad_norm=0.946, lr=0.000010]Training Epoch 1/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:05<00:01,  4.62it/s, loss=0.6926, grad_norm=0.988, lr=0.000010]Training Epoch 1/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.45it/s, loss=0.6926, grad_norm=0.988, lr=0.000010]Training Epoch 1/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.45it/s, loss=0.6928, grad_norm=0.933, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.23it/s, loss=0.6928, grad_norm=0.933, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.23it/s, loss=0.6813, grad_norm=0.993, lr=0.000010]Training Epoch 1/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.88it/s, loss=0.6813, grad_norm=0.993, lr=0.000010]Training Epoch 1/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.88it/s, loss=0.6914, grad_norm=1.141, lr=0.000010]Training Epoch 1/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.30it/s, loss=0.6914, grad_norm=1.141, lr=0.000010]Training Epoch 1/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.30it/s, loss=0.6984, grad_norm=0.973, lr=0.000010]Training Epoch 1/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.71it/s, loss=0.6984, grad_norm=0.973, lr=0.000010]Training Epoch 1/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.71it/s, loss=0.6743, grad_norm=1.002, lr=0.000010]Training Epoch 1/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.11it/s, loss=0.6743, grad_norm=1.002, lr=0.000010]Training Epoch 1/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.11it/s, loss=0.6814, grad_norm=1.241, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.36it/s, loss=0.6814, grad_norm=1.241, lr=0.000010]

Epoch 1/5 Complete (6.8s) [LR: 0.000010]
Train - Loss: 0.6910, Acc: 0.5042, Precision: 0.5027, Recall: 0.7797, F1: 0.6113, AUC: 0.5229
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/15 [00:04<?, ?it/s, loss=0.6827, grad_norm=1.079, lr=0.000010]Training Epoch 2/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:59,  4.27s/it, loss=0.6827, grad_norm=1.079, lr=0.000010]Training Epoch 2/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:59,  4.27s/it, loss=0.6772, grad_norm=1.006, lr=0.000010]Training Epoch 2/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:23,  1.83s/it, loss=0.6772, grad_norm=1.006, lr=0.000010]Training Epoch 2/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:23,  1.83s/it, loss=0.6532, grad_norm=0.980, lr=0.000010]Training Epoch 2/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.04s/it, loss=0.6532, grad_norm=0.980, lr=0.000010]Training Epoch 2/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.04s/it, loss=0.6589, grad_norm=1.004, lr=0.000010]Training Epoch 2/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.48it/s, loss=0.6589, grad_norm=1.004, lr=0.000010]Training Epoch 2/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.48it/s, loss=0.6697, grad_norm=1.052, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.13it/s, loss=0.6697, grad_norm=1.052, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.13it/s, loss=0.6588, grad_norm=1.304, lr=0.000010]Training Epoch 2/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.89it/s, loss=0.6588, grad_norm=1.304, lr=0.000010]Training Epoch 2/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.89it/s, loss=0.6629, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.72it/s, loss=0.6629, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  47%|#################################################################################6                                                                                             | 7/15 [00:05<00:02,  3.72it/s, loss=0.6683, grad_norm=1.104, lr=0.000010]Training Epoch 2/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:05<00:01,  4.52it/s, loss=0.6683, grad_norm=1.104, lr=0.000010]Training Epoch 2/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:05<00:01,  4.52it/s, loss=0.6650, grad_norm=0.901, lr=0.000010]Training Epoch 2/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.32it/s, loss=0.6650, grad_norm=0.901, lr=0.000010]Training Epoch 2/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.32it/s, loss=0.6495, grad_norm=1.064, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.10it/s, loss=0.6495, grad_norm=1.064, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.10it/s, loss=0.6459, grad_norm=1.135, lr=0.000010]Training Epoch 2/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.70it/s, loss=0.6459, grad_norm=1.135, lr=0.000010]Training Epoch 2/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.70it/s, loss=0.6667, grad_norm=1.053, lr=0.000010]Training Epoch 2/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  6.94it/s, loss=0.6667, grad_norm=1.053, lr=0.000010]Training Epoch 2/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  6.94it/s, loss=0.6320, grad_norm=1.122, lr=0.000010]Training Epoch 2/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.46it/s, loss=0.6320, grad_norm=1.122, lr=0.000010]Training Epoch 2/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.46it/s, loss=0.6178, grad_norm=0.952, lr=0.000010]Training Epoch 2/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  7.63it/s, loss=0.6178, grad_norm=0.952, lr=0.000010]Training Epoch 2/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  7.63it/s, loss=0.6423, grad_norm=1.134, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  8.02it/s, loss=0.6423, grad_norm=1.134, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.33it/s, loss=0.6423, grad_norm=1.134, lr=0.000010]

Epoch 2/5 Complete (6.9s) [LR: 0.000010]
Train - Loss: 0.6567, Acc: 0.7161, Precision: 0.6759, Recall: 0.8305, F1: 0.7452, AUC: 0.7794
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/15 [00:03<?, ?it/s, loss=0.6390, grad_norm=0.946, lr=0.000010]Training Epoch 3/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:03<00:55,  3.96s/it, loss=0.6390, grad_norm=0.946, lr=0.000010]Training Epoch 3/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:55,  3.96s/it, loss=0.6299, grad_norm=0.967, lr=0.000010]Training Epoch 3/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.70s/it, loss=0.6299, grad_norm=0.967, lr=0.000010]Training Epoch 3/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.70s/it, loss=0.6439, grad_norm=0.940, lr=0.000010]Training Epoch 3/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.03it/s, loss=0.6439, grad_norm=0.940, lr=0.000010]Training Epoch 3/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.03it/s, loss=0.6080, grad_norm=0.977, lr=0.000010]Training Epoch 3/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.59it/s, loss=0.6080, grad_norm=0.977, lr=0.000010]Training Epoch 3/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.59it/s, loss=0.6546, grad_norm=0.998, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.27it/s, loss=0.6546, grad_norm=0.998, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.27it/s, loss=0.6086, grad_norm=0.981, lr=0.000010]Training Epoch 3/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.03it/s, loss=0.6086, grad_norm=0.981, lr=0.000010]Training Epoch 3/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.03it/s, loss=0.6066, grad_norm=0.988, lr=0.000010]Training Epoch 3/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.85it/s, loss=0.6066, grad_norm=0.988, lr=0.000010]Training Epoch 3/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.85it/s, loss=0.5992, grad_norm=1.103, lr=0.000010]Training Epoch 3/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.56it/s, loss=0.5992, grad_norm=1.103, lr=0.000010]Training Epoch 3/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.56it/s, loss=0.5811, grad_norm=1.056, lr=0.000010]Training Epoch 3/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.30it/s, loss=0.5811, grad_norm=1.056, lr=0.000010]Training Epoch 3/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.30it/s, loss=0.6279, grad_norm=1.148, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################                                                          | 10/15 [00:04<00:00,  6.00it/s, loss=0.6279, grad_norm=1.148, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.00it/s, loss=0.6067, grad_norm=1.050, lr=0.000010]Training Epoch 3/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.64it/s, loss=0.6067, grad_norm=1.050, lr=0.000010]Training Epoch 3/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.64it/s, loss=0.5592, grad_norm=1.045, lr=0.000010]Training Epoch 3/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.24it/s, loss=0.5592, grad_norm=1.045, lr=0.000010]Training Epoch 3/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.24it/s, loss=0.5780, grad_norm=1.027, lr=0.000010]Training Epoch 3/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.82it/s, loss=0.5780, grad_norm=1.027, lr=0.000010]Training Epoch 3/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.82it/s, loss=0.6731, grad_norm=1.387, lr=0.000010]Training Epoch 3/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.17it/s, loss=0.6731, grad_norm=1.387, lr=0.000010]Training Epoch 3/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.17it/s, loss=0.6491, grad_norm=1.184, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.46it/s, loss=0.6491, grad_norm=1.184, lr=0.000010]

Epoch 3/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.6177, Acc: 0.7331, Precision: 0.6571, Recall: 0.9746, F1: 0.7850, AUC: 0.8215
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/15 [00:03<?, ?it/s, loss=0.5762, grad_norm=1.010, lr=0.000010]Training Epoch 4/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:03<00:54,  3.92s/it, loss=0.5762, grad_norm=1.010, lr=0.000010]Training Epoch 4/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:54,  3.92s/it, loss=0.5625, grad_norm=1.245, lr=0.000010]Training Epoch 4/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:21,  1.68s/it, loss=0.5625, grad_norm=1.245, lr=0.000010]Training Epoch 4/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:21,  1.68s/it, loss=0.5782, grad_norm=1.164, lr=0.000010]Training Epoch 4/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.04it/s, loss=0.5782, grad_norm=1.164, lr=0.000010]Training Epoch 4/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.04it/s, loss=0.5280, grad_norm=1.035, lr=0.000010]Training Epoch 4/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.57it/s, loss=0.5280, grad_norm=1.035, lr=0.000010]Training Epoch 4/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.57it/s, loss=0.5378, grad_norm=1.169, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.22it/s, loss=0.5378, grad_norm=1.169, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.22it/s, loss=0.5658, grad_norm=1.288, lr=0.000010]Training Epoch 4/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  3.00it/s, loss=0.5658, grad_norm=1.288, lr=0.000010]Training Epoch 4/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  3.00it/s, loss=0.5533, grad_norm=1.412, lr=0.000010]Training Epoch 4/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.87it/s, loss=0.5533, grad_norm=1.412, lr=0.000010]Training Epoch 4/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.87it/s, loss=0.4950, grad_norm=1.222, lr=0.000010]Training Epoch 4/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.74it/s, loss=0.4950, grad_norm=1.222, lr=0.000010]Training Epoch 4/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.74it/s, loss=0.5415, grad_norm=1.448, lr=0.000010]Training Epoch 4/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.61it/s, loss=0.5415, grad_norm=1.448, lr=0.000010]Training Epoch 4/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.61it/s, loss=0.4897, grad_norm=1.069, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################                                                          | 10/15 [00:04<00:00,  6.42it/s, loss=0.4897, grad_norm=1.069, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.42it/s, loss=0.5136, grad_norm=1.343, lr=0.000010]Training Epoch 4/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  7.06it/s, loss=0.5136, grad_norm=1.343, lr=0.000010]Training Epoch 4/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  7.06it/s, loss=0.5068, grad_norm=1.574, lr=0.000010]Training Epoch 4/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.66it/s, loss=0.5068, grad_norm=1.574, lr=0.000010]Training Epoch 4/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.66it/s, loss=0.5425, grad_norm=1.940, lr=0.000010]Training Epoch 4/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  8.10it/s, loss=0.5425, grad_norm=1.940, lr=0.000010]Training Epoch 4/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  8.10it/s, loss=0.4694, grad_norm=1.524, lr=0.000010]Training Epoch 4/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.46it/s, loss=0.4694, grad_norm=1.524, lr=0.000010]Training Epoch 4/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.46it/s, loss=0.5019, grad_norm=1.304, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  2.50it/s, loss=0.5019, grad_norm=1.304, lr=0.000010]

Epoch 4/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.5308, Acc: 0.8008, Precision: 0.7320, Recall: 0.9492, F1: 0.8266, AUC: 0.9293
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/15 [00:04<?, ?it/s, loss=0.4823, grad_norm=1.387, lr=0.000010]Training Epoch 5/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:57,  4.09s/it, loss=0.4823, grad_norm=1.387, lr=0.000010]Training Epoch 5/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:57,  4.09s/it, loss=0.4561, grad_norm=1.429, lr=0.000010]Training Epoch 5/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.75s/it, loss=0.4561, grad_norm=1.429, lr=0.000010]Training Epoch 5/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.75s/it, loss=0.4000, grad_norm=1.324, lr=0.000010]Training Epoch 5/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.00s/it, loss=0.4000, grad_norm=1.324, lr=0.000010]Training Epoch 5/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.00s/it, loss=0.4767, grad_norm=2.053, lr=0.000010]Training Epoch 5/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.54it/s, loss=0.4767, grad_norm=2.053, lr=0.000010]Training Epoch 5/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.54it/s, loss=0.4526, grad_norm=1.898, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.21it/s, loss=0.4526, grad_norm=1.898, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.21it/s, loss=0.4503, grad_norm=2.123, lr=0.000010]Training Epoch 5/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.99it/s, loss=0.4503, grad_norm=2.123, lr=0.000010]Training Epoch 5/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.99it/s, loss=0.4688, grad_norm=2.079, lr=0.000010]Training Epoch 5/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.84it/s, loss=0.4688, grad_norm=2.079, lr=0.000010]Training Epoch 5/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.84it/s, loss=0.4295, grad_norm=2.353, lr=0.000010]Training Epoch 5/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.72it/s, loss=0.4295, grad_norm=2.353, lr=0.000010]Training Epoch 5/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.72it/s, loss=0.3631, grad_norm=1.598, lr=0.000010]Training Epoch 5/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.57it/s, loss=0.3631, grad_norm=1.598, lr=0.000010]Training Epoch 5/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.57it/s, loss=0.3539, grad_norm=1.856, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.41it/s, loss=0.3539, grad_norm=1.856, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.41it/s, loss=0.3882, grad_norm=2.362, lr=0.000010]Training Epoch 5/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  7.11it/s, loss=0.3882, grad_norm=2.362, lr=0.000010]Training Epoch 5/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  7.11it/s, loss=0.3245, grad_norm=1.572, lr=0.000010]Training Epoch 5/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.29it/s, loss=0.3245, grad_norm=1.572, lr=0.000010]Training Epoch 5/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.29it/s, loss=0.4360, grad_norm=3.527, lr=0.000010]Training Epoch 5/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.57it/s, loss=0.4360, grad_norm=3.527, lr=0.000010]Training Epoch 5/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.57it/s, loss=0.4882, grad_norm=2.871, lr=0.000010]Training Epoch 5/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.04it/s, loss=0.4882, grad_norm=2.871, lr=0.000010]Training Epoch 5/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.04it/s, loss=0.2877, grad_norm=1.075, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.43it/s, loss=0.2877, grad_norm=1.075, lr=0.000010]

Epoch 5/5 Complete (6.6s) [LR: 0.000005]
Train - Loss: 0.4172, Acc: 0.8941, Precision: 0.8974, Recall: 0.8898, F1: 0.8936, AUC: 0.9636
------------------------------------------------------------
Training curves saved to model\chb23_fold2\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.6 minutes
Models saved in: model\chb23_fold2
============================================================
✅ Fold 2 training completed successfully!

============================================================
TRAINING FOLD 3/6
============================================================
Using dataset prefix: chb23_fold3
Loading datasets from: preprocessing\data\chb23_fold3
Saving models to: model\chb23_fold3
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.0666, std=2.1405
Loaded train dataset: 244 samples
  - Spectrogram shape: torch.Size([244, 30, 18, 50, 10])
  - Value range: [-5.6373, 3.9250]
  - Class distribution: tensor([122, 122])
LOOCV Mode (Fold 3): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/16 [00:03<?, ?it/s, loss=0.6880, grad_norm=1.080, lr=0.000010]Training Epoch 1/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:03<00:58,  3.92s/it, loss=0.6880, grad_norm=1.080, lr=0.000010]Training Epoch 1/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<00:58,  3.92s/it, loss=0.7091, grad_norm=1.328, lr=0.000010]Training Epoch 1/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.68s/it, loss=0.7091, grad_norm=1.328, lr=0.000010]Training Epoch 1/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.68s/it, loss=0.6765, grad_norm=1.288, lr=0.000010]Training Epoch 1/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.04it/s, loss=0.6765, grad_norm=1.288, lr=0.000010]Training Epoch 1/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.04it/s, loss=0.6845, grad_norm=1.104, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.61it/s, loss=0.6845, grad_norm=1.104, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.61it/s, loss=0.6889, grad_norm=1.042, lr=0.000010]Training Epoch 1/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.29it/s, loss=0.6889, grad_norm=1.042, lr=0.000010]Training Epoch 1/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.29it/s, loss=0.6740, grad_norm=1.039, lr=0.000010]Training Epoch 1/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.09it/s, loss=0.6740, grad_norm=1.039, lr=0.000010]Training Epoch 1/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.09it/s, loss=0.6933, grad_norm=1.222, lr=0.000010]Training Epoch 1/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.97it/s, loss=0.6933, grad_norm=1.222, lr=0.000010]Training Epoch 1/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.97it/s, loss=0.6738, grad_norm=1.204, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.87it/s, loss=0.6738, grad_norm=1.204, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.87it/s, loss=0.6833, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.51it/s, loss=0.6833, grad_norm=1.112, lr=0.000010]Training Epoch 1/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.51it/s, loss=0.6833, grad_norm=1.063, lr=0.000010]Training Epoch 1/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.20it/s, loss=0.6833, grad_norm=1.063, lr=0.000010]Training Epoch 1/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.20it/s, loss=0.6792, grad_norm=1.093, lr=0.000010]Training Epoch 1/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.93it/s, loss=0.6792, grad_norm=1.093, lr=0.000010]Training Epoch 1/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.93it/s, loss=0.6893, grad_norm=1.253, lr=0.000010]Training Epoch 1/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.52it/s, loss=0.6893, grad_norm=1.253, lr=0.000010]Training Epoch 1/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.52it/s, loss=0.6688, grad_norm=1.116, lr=0.000010]Training Epoch 1/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.99it/s, loss=0.6688, grad_norm=1.116, lr=0.000010]Training Epoch 1/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.99it/s, loss=0.6838, grad_norm=1.081, lr=0.000010]Training Epoch 1/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  7.95it/s, loss=0.6838, grad_norm=1.081, lr=0.000010]Training Epoch 1/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  7.95it/s, loss=0.6682, grad_norm=1.117, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  7.87it/s, loss=0.6682, grad_norm=1.117, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  7.87it/s, loss=0.7101, grad_norm=2.342, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.63it/s, loss=0.7101, grad_norm=2.342, lr=0.000010]

Epoch 1/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.6846, Acc: 0.5943, Precision: 0.7018, Recall: 0.3279, F1: 0.4469, AUC: 0.6775
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/16 [00:04<?, ?it/s, loss=0.6661, grad_norm=0.991, lr=0.000010]Training Epoch 2/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:00,  4.02s/it, loss=0.6661, grad_norm=0.991, lr=0.000010]Training Epoch 2/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:00,  4.02s/it, loss=0.6531, grad_norm=1.150, lr=0.000010]Training Epoch 2/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.72s/it, loss=0.6531, grad_norm=1.150, lr=0.000010]Training Epoch 2/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.72s/it, loss=0.6811, grad_norm=1.627, lr=0.000010]Training Epoch 2/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.01it/s, loss=0.6811, grad_norm=1.627, lr=0.000010]Training Epoch 2/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.01it/s, loss=0.6667, grad_norm=1.210, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.56it/s, loss=0.6667, grad_norm=1.210, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.56it/s, loss=0.6503, grad_norm=1.345, lr=0.000010]Training Epoch 2/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.23it/s, loss=0.6503, grad_norm=1.345, lr=0.000010]Training Epoch 2/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.23it/s, loss=0.6527, grad_norm=1.177, lr=0.000010]Training Epoch 2/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.01it/s, loss=0.6527, grad_norm=1.177, lr=0.000010]Training Epoch 2/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.01it/s, loss=0.6655, grad_norm=1.453, lr=0.000010]Training Epoch 2/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.86it/s, loss=0.6655, grad_norm=1.453, lr=0.000010]Training Epoch 2/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.86it/s, loss=0.6465, grad_norm=1.315, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.66it/s, loss=0.6465, grad_norm=1.315, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.66it/s, loss=0.6442, grad_norm=1.211, lr=0.000010]Training Epoch 2/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.52it/s, loss=0.6442, grad_norm=1.211, lr=0.000010]Training Epoch 2/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  5.52it/s, loss=0.6346, grad_norm=1.199, lr=0.000010]Training Epoch 2/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.30it/s, loss=0.6346, grad_norm=1.199, lr=0.000010]Training Epoch 2/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.30it/s, loss=0.6338, grad_norm=1.173, lr=0.000010]Training Epoch 2/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.97it/s, loss=0.6338, grad_norm=1.173, lr=0.000010]Training Epoch 2/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.97it/s, loss=0.6556, grad_norm=1.465, lr=0.000010]Training Epoch 2/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.50it/s, loss=0.6556, grad_norm=1.465, lr=0.000010]Training Epoch 2/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.50it/s, loss=0.6523, grad_norm=1.149, lr=0.000010]Training Epoch 2/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.95it/s, loss=0.6523, grad_norm=1.149, lr=0.000010]Training Epoch 2/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.95it/s, loss=0.6180, grad_norm=1.458, lr=0.000010]Training Epoch 2/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.40it/s, loss=0.6180, grad_norm=1.458, lr=0.000010]Training Epoch 2/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.40it/s, loss=0.6053, grad_norm=1.354, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.61it/s, loss=0.6053, grad_norm=1.354, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.61it/s, loss=0.5852, grad_norm=2.311, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.58it/s, loss=0.5852, grad_norm=2.311, lr=0.000010]

Epoch 2/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6444, Acc: 0.7172, Precision: 0.7227, Recall: 0.7049, F1: 0.7137, AUC: 0.8115
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/16 [00:03<?, ?it/s, loss=0.6141, grad_norm=1.272, lr=0.000010]Training Epoch 3/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:03<00:59,  3.98s/it, loss=0.6141, grad_norm=1.272, lr=0.000010]Training Epoch 3/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<00:59,  3.98s/it, loss=0.5924, grad_norm=1.045, lr=0.000010]Training Epoch 3/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.71s/it, loss=0.5924, grad_norm=1.045, lr=0.000010]Training Epoch 3/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.71s/it, loss=0.6066, grad_norm=1.490, lr=0.000010]Training Epoch 3/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.02it/s, loss=0.6066, grad_norm=1.490, lr=0.000010]Training Epoch 3/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.02it/s, loss=0.6148, grad_norm=1.183, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.57it/s, loss=0.6148, grad_norm=1.183, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.57it/s, loss=0.6030, grad_norm=1.500, lr=0.000010]Training Epoch 3/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.25it/s, loss=0.6030, grad_norm=1.500, lr=0.000010]Training Epoch 3/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.25it/s, loss=0.5648, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.03it/s, loss=0.5648, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.03it/s, loss=0.6223, grad_norm=1.281, lr=0.000010]Training Epoch 3/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.88it/s, loss=0.6223, grad_norm=1.281, lr=0.000010]Training Epoch 3/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.88it/s, loss=0.5439, grad_norm=1.234, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.66it/s, loss=0.5439, grad_norm=1.234, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.66it/s, loss=0.5836, grad_norm=1.237, lr=0.000010]Training Epoch 3/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.33it/s, loss=0.5836, grad_norm=1.237, lr=0.000010]Training Epoch 3/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  5.33it/s, loss=0.5615, grad_norm=1.324, lr=0.000010]Training Epoch 3/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:01,  5.89it/s, loss=0.5615, grad_norm=1.324, lr=0.000010]Training Epoch 3/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:01,  5.89it/s, loss=0.5363, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.33it/s, loss=0.5363, grad_norm=1.149, lr=0.000010]Training Epoch 3/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.33it/s, loss=0.5328, grad_norm=1.210, lr=0.000010]Training Epoch 3/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  6.88it/s, loss=0.5328, grad_norm=1.210, lr=0.000010]Training Epoch 3/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  6.88it/s, loss=0.5054, grad_norm=1.237, lr=0.000010]Training Epoch 3/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.20it/s, loss=0.5054, grad_norm=1.237, lr=0.000010]Training Epoch 3/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.20it/s, loss=0.5236, grad_norm=1.137, lr=0.000010]Training Epoch 3/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  7.66it/s, loss=0.5236, grad_norm=1.137, lr=0.000010]Training Epoch 3/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  7.66it/s, loss=0.5419, grad_norm=1.336, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.07it/s, loss=0.5419, grad_norm=1.336, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.07it/s, loss=0.5873, grad_norm=2.261, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.57it/s, loss=0.5873, grad_norm=2.261, lr=0.000010]

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5709, Acc: 0.8115, Precision: 0.7289, Recall: 0.9918, F1: 0.8403, AUC: 0.8862
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/16 [00:03<?, ?it/s, loss=0.5002, grad_norm=1.362, lr=0.000010]Training Epoch 4/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:03<00:59,  3.99s/it, loss=0.5002, grad_norm=1.362, lr=0.000010]Training Epoch 4/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<00:59,  3.99s/it, loss=0.4903, grad_norm=1.376, lr=0.000010]Training Epoch 4/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.72s/it, loss=0.4903, grad_norm=1.376, lr=0.000010]Training Epoch 4/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.72s/it, loss=0.5033, grad_norm=1.574, lr=0.000010]Training Epoch 4/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.01it/s, loss=0.5033, grad_norm=1.574, lr=0.000010]Training Epoch 4/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.01it/s, loss=0.5215, grad_norm=1.384, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.56it/s, loss=0.5215, grad_norm=1.384, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.56it/s, loss=0.5142, grad_norm=1.535, lr=0.000010]Training Epoch 4/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.20it/s, loss=0.5142, grad_norm=1.535, lr=0.000010]Training Epoch 4/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.20it/s, loss=0.5175, grad_norm=1.877, lr=0.000010]Training Epoch 4/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.95it/s, loss=0.5175, grad_norm=1.877, lr=0.000010]Training Epoch 4/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  2.95it/s, loss=0.4965, grad_norm=1.862, lr=0.000010]Training Epoch 4/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.81it/s, loss=0.4965, grad_norm=1.862, lr=0.000010]Training Epoch 4/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.81it/s, loss=0.4306, grad_norm=1.517, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.67it/s, loss=0.4306, grad_norm=1.517, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.67it/s, loss=0.3884, grad_norm=1.556, lr=0.000010]Training Epoch 4/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.53it/s, loss=0.3884, grad_norm=1.556, lr=0.000010]Training Epoch 4/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  5.53it/s, loss=0.3749, grad_norm=1.326, lr=0.000010]Training Epoch 4/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.31it/s, loss=0.3749, grad_norm=1.326, lr=0.000010]Training Epoch 4/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.31it/s, loss=0.5097, grad_norm=2.539, lr=0.000010]Training Epoch 4/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.98it/s, loss=0.5097, grad_norm=2.539, lr=0.000010]Training Epoch 4/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.98it/s, loss=0.4295, grad_norm=1.161, lr=0.000010]Training Epoch 4/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.56it/s, loss=0.4295, grad_norm=1.161, lr=0.000010]Training Epoch 4/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.56it/s, loss=0.4546, grad_norm=1.701, lr=0.000010]Training Epoch 4/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.99it/s, loss=0.4546, grad_norm=1.701, lr=0.000010]Training Epoch 4/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.99it/s, loss=0.3047, grad_norm=1.472, lr=0.000010]Training Epoch 4/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.30it/s, loss=0.3047, grad_norm=1.472, lr=0.000010]Training Epoch 4/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.30it/s, loss=0.4348, grad_norm=1.915, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.56it/s, loss=0.4348, grad_norm=1.915, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.56it/s, loss=0.4289, grad_norm=3.808, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.59it/s, loss=0.4289, grad_norm=3.808, lr=0.000010]

Epoch 4/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.4562, Acc: 0.8730, Precision: 0.8138, Recall: 0.9672, F1: 0.8839, AUC: 0.9398
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/16 [00:03<?, ?it/s, loss=0.3893, grad_norm=1.736, lr=0.000010]Training Epoch 5/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:03<00:59,  3.93s/it, loss=0.3893, grad_norm=1.736, lr=0.000010]Training Epoch 5/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<00:59,  3.93s/it, loss=0.3452, grad_norm=1.499, lr=0.000010]Training Epoch 5/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.69s/it, loss=0.3452, grad_norm=1.499, lr=0.000010]Training Epoch 5/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.69s/it, loss=0.3376, grad_norm=1.603, lr=0.000010]Training Epoch 5/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.04it/s, loss=0.3376, grad_norm=1.603, lr=0.000010]Training Epoch 5/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.04it/s, loss=0.3228, grad_norm=1.604, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.59it/s, loss=0.3228, grad_norm=1.604, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.59it/s, loss=0.3267, grad_norm=1.669, lr=0.000010]Training Epoch 5/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.27it/s, loss=0.3267, grad_norm=1.669, lr=0.000010]Training Epoch 5/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.27it/s, loss=0.2734, grad_norm=1.808, lr=0.000010]Training Epoch 5/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.06it/s, loss=0.2734, grad_norm=1.808, lr=0.000010]Training Epoch 5/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.06it/s, loss=0.4621, grad_norm=2.815, lr=0.000010]Training Epoch 5/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.92it/s, loss=0.4621, grad_norm=2.815, lr=0.000010]Training Epoch 5/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.92it/s, loss=0.2953, grad_norm=1.277, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.76it/s, loss=0.2953, grad_norm=1.277, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.76it/s, loss=0.2374, grad_norm=1.422, lr=0.000010]Training Epoch 5/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.54it/s, loss=0.2374, grad_norm=1.422, lr=0.000010]Training Epoch 5/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.54it/s, loss=0.3203, grad_norm=2.523, lr=0.000010]Training Epoch 5/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.27it/s, loss=0.3203, grad_norm=2.523, lr=0.000010]Training Epoch 5/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.27it/s, loss=0.2810, grad_norm=1.321, lr=0.000010]Training Epoch 5/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.95it/s, loss=0.2810, grad_norm=1.321, lr=0.000010]Training Epoch 5/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  6.95it/s, loss=0.3102, grad_norm=3.293, lr=0.000010]Training Epoch 5/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.52it/s, loss=0.3102, grad_norm=3.293, lr=0.000010]Training Epoch 5/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.52it/s, loss=0.2210, grad_norm=1.564, lr=0.000010]Training Epoch 5/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.96it/s, loss=0.2210, grad_norm=1.564, lr=0.000010]Training Epoch 5/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.96it/s, loss=0.3226, grad_norm=2.839, lr=0.000010]Training Epoch 5/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.31it/s, loss=0.3226, grad_norm=2.839, lr=0.000010]Training Epoch 5/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.31it/s, loss=0.2438, grad_norm=2.020, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.51it/s, loss=0.2438, grad_norm=2.020, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.51it/s, loss=0.1411, grad_norm=1.705, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.62it/s, loss=0.1411, grad_norm=1.705, lr=0.000010]

Epoch 5/5 Complete (6.5s) [LR: 0.000005]
Train - Loss: 0.3019, Acc: 0.9303, Precision: 0.8777, Recall: 1.0000, F1: 0.9349, AUC: 0.9738
------------------------------------------------------------
Training curves saved to model\chb23_fold3\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb23_fold3
============================================================
✅ Fold 3 training completed successfully!

============================================================
TRAINING FOLD 4/6
============================================================
Using dataset prefix: chb23_fold4
Loading datasets from: preprocessing\data\chb23_fold4
Saving models to: model\chb23_fold4
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.1770, std=2.1185
Loaded train dataset: 240 samples
  - Spectrogram shape: torch.Size([240, 30, 18, 50, 10])
  - Value range: [-5.7478, 3.9228]
  - Class distribution: tensor([120, 120])
LOOCV Mode (Fold 4): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/15 [00:04<?, ?it/s, loss=0.6836, grad_norm=1.127, lr=0.000010]Training Epoch 1/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:57,  4.10s/it, loss=0.6836, grad_norm=1.127, lr=0.000010]Training Epoch 1/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:57,  4.10s/it, loss=0.6988, grad_norm=1.280, lr=0.000010]Training Epoch 1/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.76s/it, loss=0.6988, grad_norm=1.280, lr=0.000010]Training Epoch 1/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.76s/it, loss=0.6932, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.01s/it, loss=0.6932, grad_norm=1.192, lr=0.000010]Training Epoch 1/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.01s/it, loss=0.6847, grad_norm=1.063, lr=0.000010]Training Epoch 1/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.53it/s, loss=0.6847, grad_norm=1.063, lr=0.000010]Training Epoch 1/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.53it/s, loss=0.6915, grad_norm=1.581, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.18it/s, loss=0.6915, grad_norm=1.581, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.18it/s, loss=0.6931, grad_norm=1.082, lr=0.000010]Training Epoch 1/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.93it/s, loss=0.6931, grad_norm=1.082, lr=0.000010]Training Epoch 1/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.93it/s, loss=0.6843, grad_norm=1.114, lr=0.000010]Training Epoch 1/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.77it/s, loss=0.6843, grad_norm=1.114, lr=0.000010]Training Epoch 1/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.77it/s, loss=0.6809, grad_norm=1.124, lr=0.000010]Training Epoch 1/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.60it/s, loss=0.6809, grad_norm=1.124, lr=0.000010]Training Epoch 1/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:05<00:01,  4.60it/s, loss=0.6764, grad_norm=1.085, lr=0.000010]Training Epoch 1/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.44it/s, loss=0.6764, grad_norm=1.085, lr=0.000010]Training Epoch 1/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.44it/s, loss=0.6821, grad_norm=1.072, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.18it/s, loss=0.6821, grad_norm=1.072, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.18it/s, loss=0.6746, grad_norm=1.159, lr=0.000010]Training Epoch 1/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.74it/s, loss=0.6746, grad_norm=1.159, lr=0.000010]Training Epoch 1/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.74it/s, loss=0.6784, grad_norm=1.109, lr=0.000010]Training Epoch 1/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.24it/s, loss=0.6784, grad_norm=1.109, lr=0.000010]Training Epoch 1/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.24it/s, loss=0.6705, grad_norm=1.547, lr=0.000010]Training Epoch 1/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.64it/s, loss=0.6705, grad_norm=1.547, lr=0.000010]Training Epoch 1/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.64it/s, loss=0.6735, grad_norm=1.035, lr=0.000010]Training Epoch 1/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.05it/s, loss=0.6735, grad_norm=1.035, lr=0.000010]Training Epoch 1/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.05it/s, loss=0.6560, grad_norm=1.097, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  8.42it/s, loss=0.6560, grad_norm=1.097, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.39it/s, loss=0.6560, grad_norm=1.097, lr=0.000010]

Epoch 1/5 Complete (6.7s) [LR: 0.000010]
Train - Loss: 0.6815, Acc: 0.5667, Precision: 0.5976, Recall: 0.4083, F1: 0.4851, AUC: 0.6640
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/15 [00:04<?, ?it/s, loss=0.6650, grad_norm=1.065, lr=0.000010]Training Epoch 2/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.01s/it, loss=0.6650, grad_norm=1.065, lr=0.000010]Training Epoch 2/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.01s/it, loss=0.6478, grad_norm=1.092, lr=0.000010]Training Epoch 2/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.72s/it, loss=0.6478, grad_norm=1.092, lr=0.000010]Training Epoch 2/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.72s/it, loss=0.6611, grad_norm=1.111, lr=0.000010]Training Epoch 2/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.01it/s, loss=0.6611, grad_norm=1.111, lr=0.000010]Training Epoch 2/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.01it/s, loss=0.6545, grad_norm=1.166, lr=0.000010]Training Epoch 2/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.56it/s, loss=0.6545, grad_norm=1.166, lr=0.000010]Training Epoch 2/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.56it/s, loss=0.6416, grad_norm=1.144, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.21it/s, loss=0.6416, grad_norm=1.144, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.21it/s, loss=0.6601, grad_norm=1.515, lr=0.000010]Training Epoch 2/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.97it/s, loss=0.6601, grad_norm=1.515, lr=0.000010]Training Epoch 2/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.97it/s, loss=0.6500, grad_norm=1.419, lr=0.000010]Training Epoch 2/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.77it/s, loss=0.6500, grad_norm=1.419, lr=0.000010]Training Epoch 2/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.77it/s, loss=0.6355, grad_norm=1.106, lr=0.000010]Training Epoch 2/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.56it/s, loss=0.6355, grad_norm=1.106, lr=0.000010]Training Epoch 2/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.56it/s, loss=0.6418, grad_norm=1.110, lr=0.000010]Training Epoch 2/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.34it/s, loss=0.6418, grad_norm=1.110, lr=0.000010]Training Epoch 2/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.34it/s, loss=0.6212, grad_norm=1.422, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.09it/s, loss=0.6212, grad_norm=1.422, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.09it/s, loss=0.6195, grad_norm=1.263, lr=0.000010]Training Epoch 2/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.83it/s, loss=0.6195, grad_norm=1.263, lr=0.000010]Training Epoch 2/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.83it/s, loss=0.6159, grad_norm=1.136, lr=0.000010]Training Epoch 2/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.45it/s, loss=0.6159, grad_norm=1.136, lr=0.000010]Training Epoch 2/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.45it/s, loss=0.6633, grad_norm=1.763, lr=0.000010]Training Epoch 2/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.89it/s, loss=0.6633, grad_norm=1.763, lr=0.000010]Training Epoch 2/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.89it/s, loss=0.5801, grad_norm=1.118, lr=0.000010]Training Epoch 2/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.24it/s, loss=0.5801, grad_norm=1.118, lr=0.000010]Training Epoch 2/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.24it/s, loss=0.6027, grad_norm=1.118, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  8.31it/s, loss=0.6027, grad_norm=1.118, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.43it/s, loss=0.6027, grad_norm=1.118, lr=0.000010]

Epoch 2/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6374, Acc: 0.7542, Precision: 0.7103, Recall: 0.8583, F1: 0.7774, AUC: 0.8296
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/15 [00:03<?, ?it/s, loss=0.6382, grad_norm=1.223, lr=0.000010]Training Epoch 3/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:03<00:55,  4.00s/it, loss=0.6382, grad_norm=1.223, lr=0.000010]Training Epoch 3/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:55,  4.00s/it, loss=0.5919, grad_norm=1.088, lr=0.000010]Training Epoch 3/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.71s/it, loss=0.5919, grad_norm=1.088, lr=0.000010]Training Epoch 3/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.71s/it, loss=0.5996, grad_norm=1.114, lr=0.000010]Training Epoch 3/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.02it/s, loss=0.5996, grad_norm=1.114, lr=0.000010]Training Epoch 3/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.02it/s, loss=0.5670, grad_norm=1.347, lr=0.000010]Training Epoch 3/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.57it/s, loss=0.5670, grad_norm=1.347, lr=0.000010]Training Epoch 3/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.57it/s, loss=0.6391, grad_norm=1.303, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.25it/s, loss=0.6391, grad_norm=1.303, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.25it/s, loss=0.5235, grad_norm=1.185, lr=0.000010]Training Epoch 3/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.04it/s, loss=0.5235, grad_norm=1.185, lr=0.000010]Training Epoch 3/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.04it/s, loss=0.5660, grad_norm=1.302, lr=0.000010]Training Epoch 3/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.86it/s, loss=0.5660, grad_norm=1.302, lr=0.000010]Training Epoch 3/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.86it/s, loss=0.5583, grad_norm=1.117, lr=0.000010]Training Epoch 3/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.65it/s, loss=0.5583, grad_norm=1.117, lr=0.000010]Training Epoch 3/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.65it/s, loss=0.5635, grad_norm=1.146, lr=0.000010]Training Epoch 3/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.41it/s, loss=0.5635, grad_norm=1.146, lr=0.000010]Training Epoch 3/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.41it/s, loss=0.5774, grad_norm=1.439, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.15it/s, loss=0.5774, grad_norm=1.439, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.15it/s, loss=0.5326, grad_norm=1.183, lr=0.000010]Training Epoch 3/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.83it/s, loss=0.5326, grad_norm=1.183, lr=0.000010]Training Epoch 3/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.83it/s, loss=0.6528, grad_norm=1.692, lr=0.000010]Training Epoch 3/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.37it/s, loss=0.6528, grad_norm=1.692, lr=0.000010]Training Epoch 3/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.37it/s, loss=0.5969, grad_norm=1.537, lr=0.000010]Training Epoch 3/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.82it/s, loss=0.5969, grad_norm=1.537, lr=0.000010]Training Epoch 3/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.82it/s, loss=0.5162, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.02it/s, loss=0.5162, grad_norm=1.238, lr=0.000010]Training Epoch 3/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.02it/s, loss=0.5365, grad_norm=1.453, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  8.15it/s, loss=0.5365, grad_norm=1.453, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.44it/s, loss=0.5365, grad_norm=1.453, lr=0.000010]

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5773, Acc: 0.8125, Precision: 0.7660, Recall: 0.9000, F1: 0.8276, AUC: 0.8893
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/15 [00:04<?, ?it/s, loss=0.5560, grad_norm=1.534, lr=0.000010]Training Epoch 4/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.05s/it, loss=0.5560, grad_norm=1.534, lr=0.000010]Training Epoch 4/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.05s/it, loss=0.4821, grad_norm=1.480, lr=0.000010]Training Epoch 4/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.75s/it, loss=0.4821, grad_norm=1.480, lr=0.000010]Training Epoch 4/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.75s/it, loss=0.6041, grad_norm=1.551, lr=0.000010]Training Epoch 4/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.01s/it, loss=0.6041, grad_norm=1.551, lr=0.000010]Training Epoch 4/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:12,  1.01s/it, loss=0.5365, grad_norm=1.504, lr=0.000010]Training Epoch 4/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.52it/s, loss=0.5365, grad_norm=1.504, lr=0.000010]Training Epoch 4/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.52it/s, loss=0.4678, grad_norm=1.329, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.17it/s, loss=0.4678, grad_norm=1.329, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.17it/s, loss=0.5024, grad_norm=1.373, lr=0.000010]Training Epoch 4/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.90it/s, loss=0.5024, grad_norm=1.373, lr=0.000010]Training Epoch 4/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.90it/s, loss=0.5426, grad_norm=1.687, lr=0.000010]Training Epoch 4/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.74it/s, loss=0.5426, grad_norm=1.687, lr=0.000010]Training Epoch 4/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.74it/s, loss=0.4635, grad_norm=1.288, lr=0.000010]Training Epoch 4/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.47it/s, loss=0.4635, grad_norm=1.288, lr=0.000010]Training Epoch 4/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:05<00:01,  4.47it/s, loss=0.4504, grad_norm=1.415, lr=0.000010]Training Epoch 4/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.35it/s, loss=0.4504, grad_norm=1.415, lr=0.000010]Training Epoch 4/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.35it/s, loss=0.4418, grad_norm=1.871, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.16it/s, loss=0.4418, grad_norm=1.871, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.16it/s, loss=0.6678, grad_norm=2.826, lr=0.000010]Training Epoch 4/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.93it/s, loss=0.6678, grad_norm=2.826, lr=0.000010]Training Epoch 4/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.93it/s, loss=0.3599, grad_norm=1.297, lr=0.000010]Training Epoch 4/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.48it/s, loss=0.3599, grad_norm=1.297, lr=0.000010]Training Epoch 4/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.48it/s, loss=0.4705, grad_norm=1.888, lr=0.000010]Training Epoch 4/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.96it/s, loss=0.4705, grad_norm=1.888, lr=0.000010]Training Epoch 4/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.96it/s, loss=0.4400, grad_norm=1.240, lr=0.000010]Training Epoch 4/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.35it/s, loss=0.4400, grad_norm=1.240, lr=0.000010]Training Epoch 4/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.35it/s, loss=0.4409, grad_norm=2.767, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  8.65it/s, loss=0.4409, grad_norm=2.767, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.40it/s, loss=0.4409, grad_norm=2.767, lr=0.000010]

Epoch 4/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.4951, Acc: 0.8458, Precision: 0.8168, Recall: 0.8917, F1: 0.8526, AUC: 0.9113
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/15 [00:03<?, ?it/s, loss=0.4280, grad_norm=1.922, lr=0.000010]Training Epoch 5/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:03<00:55,  3.98s/it, loss=0.4280, grad_norm=1.922, lr=0.000010]Training Epoch 5/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:55,  3.98s/it, loss=0.4207, grad_norm=1.799, lr=0.000010]Training Epoch 5/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.70s/it, loss=0.4207, grad_norm=1.799, lr=0.000010]Training Epoch 5/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.70s/it, loss=0.4077, grad_norm=1.989, lr=0.000010]Training Epoch 5/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.03it/s, loss=0.4077, grad_norm=1.989, lr=0.000010]Training Epoch 5/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.03it/s, loss=0.3916, grad_norm=1.983, lr=0.000010]Training Epoch 5/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.58it/s, loss=0.3916, grad_norm=1.983, lr=0.000010]Training Epoch 5/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.58it/s, loss=0.3617, grad_norm=2.065, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.25it/s, loss=0.3617, grad_norm=2.065, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.25it/s, loss=0.3952, grad_norm=1.842, lr=0.000010]Training Epoch 5/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.03it/s, loss=0.3952, grad_norm=1.842, lr=0.000010]Training Epoch 5/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.03it/s, loss=0.3563, grad_norm=2.098, lr=0.000010]Training Epoch 5/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.88it/s, loss=0.3563, grad_norm=2.098, lr=0.000010]Training Epoch 5/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.88it/s, loss=0.3905, grad_norm=1.201, lr=0.000010]Training Epoch 5/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.75it/s, loss=0.3905, grad_norm=1.201, lr=0.000010]Training Epoch 5/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.75it/s, loss=0.2873, grad_norm=1.349, lr=0.000010]Training Epoch 5/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.61it/s, loss=0.2873, grad_norm=1.349, lr=0.000010]Training Epoch 5/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.61it/s, loss=0.3533, grad_norm=2.257, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################                                                          | 10/15 [00:04<00:00,  6.39it/s, loss=0.3533, grad_norm=2.257, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.39it/s, loss=0.3763, grad_norm=2.183, lr=0.000010]Training Epoch 5/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  7.10it/s, loss=0.3763, grad_norm=2.183, lr=0.000010]Training Epoch 5/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  7.10it/s, loss=0.2974, grad_norm=1.688, lr=0.000010]Training Epoch 5/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.63it/s, loss=0.2974, grad_norm=1.688, lr=0.000010]Training Epoch 5/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.63it/s, loss=0.3897, grad_norm=3.482, lr=0.000010]Training Epoch 5/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  8.09it/s, loss=0.3897, grad_norm=3.482, lr=0.000010]Training Epoch 5/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  8.09it/s, loss=0.2681, grad_norm=2.214, lr=0.000010]Training Epoch 5/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.34it/s, loss=0.2681, grad_norm=2.214, lr=0.000010]Training Epoch 5/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.34it/s, loss=0.2933, grad_norm=2.420, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  8.29it/s, loss=0.2933, grad_norm=2.420, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.47it/s, loss=0.2933, grad_norm=2.420, lr=0.000010]

Epoch 5/5 Complete (6.5s) [LR: 0.000005]
Train - Loss: 0.3611, Acc: 0.9083, Precision: 0.8657, Recall: 0.9667, F1: 0.9134, AUC: 0.9649
------------------------------------------------------------
Training curves saved to model\chb23_fold4\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb23_fold4
============================================================
✅ Fold 4 training completed successfully!

============================================================
TRAINING FOLD 5/6
============================================================
Using dataset prefix: chb23_fold5
Loading datasets from: preprocessing\data\chb23_fold5
Saving models to: model\chb23_fold5
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.0758, std=2.1329
Loaded train dataset: 238 samples
  - Spectrogram shape: torch.Size([238, 30, 18, 50, 10])
  - Value range: [-5.6617, 3.9438]
  - Class distribution: tensor([119, 119])
LOOCV Mode (Fold 5): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/15 [00:04<?, ?it/s, loss=0.6981, grad_norm=1.073, lr=0.000010]Training Epoch 1/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.04s/it, loss=0.6981, grad_norm=1.073, lr=0.000010]Training Epoch 1/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.04s/it, loss=0.6933, grad_norm=1.021, lr=0.000010]Training Epoch 1/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.74s/it, loss=0.6933, grad_norm=1.021, lr=0.000010]Training Epoch 1/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.74s/it, loss=0.6980, grad_norm=1.032, lr=0.000010]Training Epoch 1/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.01it/s, loss=0.6980, grad_norm=1.032, lr=0.000010]Training Epoch 1/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.01it/s, loss=0.6831, grad_norm=0.970, lr=0.000010]Training Epoch 1/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.55it/s, loss=0.6831, grad_norm=0.970, lr=0.000010]Training Epoch 1/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.55it/s, loss=0.6896, grad_norm=0.939, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.21it/s, loss=0.6896, grad_norm=0.939, lr=0.000010]Training Epoch 1/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.21it/s, loss=0.6962, grad_norm=1.041, lr=0.000010]Training Epoch 1/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.98it/s, loss=0.6962, grad_norm=1.041, lr=0.000010]Training Epoch 1/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.98it/s, loss=0.6796, grad_norm=0.986, lr=0.000010]Training Epoch 1/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.81it/s, loss=0.6796, grad_norm=0.986, lr=0.000010]Training Epoch 1/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.81it/s, loss=0.6883, grad_norm=1.048, lr=0.000010]Training Epoch 1/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.70it/s, loss=0.6883, grad_norm=1.048, lr=0.000010]Training Epoch 1/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.70it/s, loss=0.6769, grad_norm=1.048, lr=0.000010]Training Epoch 1/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.54it/s, loss=0.6769, grad_norm=1.048, lr=0.000010]Training Epoch 1/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.54it/s, loss=0.6933, grad_norm=1.414, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.30it/s, loss=0.6933, grad_norm=1.414, lr=0.000010]Training Epoch 1/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.30it/s, loss=0.6688, grad_norm=1.037, lr=0.000010]Training Epoch 1/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.95it/s, loss=0.6688, grad_norm=1.037, lr=0.000010]Training Epoch 1/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.95it/s, loss=0.6555, grad_norm=1.023, lr=0.000010]Training Epoch 1/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.49it/s, loss=0.6555, grad_norm=1.023, lr=0.000010]Training Epoch 1/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.49it/s, loss=0.6723, grad_norm=0.931, lr=0.000010]Training Epoch 1/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.93it/s, loss=0.6723, grad_norm=0.931, lr=0.000010]Training Epoch 1/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.93it/s, loss=0.6858, grad_norm=1.263, lr=0.000010]Training Epoch 1/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.32it/s, loss=0.6858, grad_norm=1.263, lr=0.000010]Training Epoch 1/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.32it/s, loss=0.6716, grad_norm=1.013, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  8.75it/s, loss=0.6716, grad_norm=1.013, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.45it/s, loss=0.6716, grad_norm=1.013, lr=0.000010]

Epoch 1/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6834, Acc: 0.5294, Precision: 0.5212, Recall: 0.7227, F1: 0.6056, AUC: 0.6334
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/15 [00:04<?, ?it/s, loss=0.6621, grad_norm=1.062, lr=0.000010]Training Epoch 2/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.03s/it, loss=0.6621, grad_norm=1.062, lr=0.000010]Training Epoch 2/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.03s/it, loss=0.6649, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.73s/it, loss=0.6649, grad_norm=1.029, lr=0.000010]Training Epoch 2/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.73s/it, loss=0.6634, grad_norm=0.994, lr=0.000010]Training Epoch 2/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.01it/s, loss=0.6634, grad_norm=0.994, lr=0.000010]Training Epoch 2/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.01it/s, loss=0.6859, grad_norm=1.399, lr=0.000010]Training Epoch 2/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.54it/s, loss=0.6859, grad_norm=1.399, lr=0.000010]Training Epoch 2/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.54it/s, loss=0.6458, grad_norm=0.957, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.18it/s, loss=0.6458, grad_norm=0.957, lr=0.000010]Training Epoch 2/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.18it/s, loss=0.6261, grad_norm=1.011, lr=0.000010]Training Epoch 2/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.92it/s, loss=0.6261, grad_norm=1.011, lr=0.000010]Training Epoch 2/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:03,  2.92it/s, loss=0.6359, grad_norm=1.282, lr=0.000010]Training Epoch 2/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.75it/s, loss=0.6359, grad_norm=1.282, lr=0.000010]Training Epoch 2/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.75it/s, loss=0.6697, grad_norm=1.076, lr=0.000010]Training Epoch 2/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.62it/s, loss=0.6697, grad_norm=1.076, lr=0.000010]Training Epoch 2/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.62it/s, loss=0.6447, grad_norm=1.050, lr=0.000010]Training Epoch 2/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.47it/s, loss=0.6447, grad_norm=1.050, lr=0.000010]Training Epoch 2/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.47it/s, loss=0.6384, grad_norm=1.014, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.26it/s, loss=0.6384, grad_norm=1.014, lr=0.000010]Training Epoch 2/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.26it/s, loss=0.6226, grad_norm=0.945, lr=0.000010]Training Epoch 2/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.96it/s, loss=0.6226, grad_norm=0.945, lr=0.000010]Training Epoch 2/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.96it/s, loss=0.6101, grad_norm=0.997, lr=0.000010]Training Epoch 2/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.53it/s, loss=0.6101, grad_norm=0.997, lr=0.000010]Training Epoch 2/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.53it/s, loss=0.6597, grad_norm=1.023, lr=0.000010]Training Epoch 2/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  8.00it/s, loss=0.6597, grad_norm=1.023, lr=0.000010]Training Epoch 2/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  8.00it/s, loss=0.6029, grad_norm=0.967, lr=0.000010]Training Epoch 2/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.34it/s, loss=0.6029, grad_norm=0.967, lr=0.000010]Training Epoch 2/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.34it/s, loss=0.6109, grad_norm=1.058, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.43it/s, loss=0.6109, grad_norm=1.058, lr=0.000010]

Epoch 2/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.6429, Acc: 0.7185, Precision: 0.6585, Recall: 0.9076, F1: 0.7633, AUC: 0.7787
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/15 [00:04<?, ?it/s, loss=0.6021, grad_norm=0.956, lr=0.000010]Training Epoch 3/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.02s/it, loss=0.6021, grad_norm=0.956, lr=0.000010]Training Epoch 3/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:56,  4.02s/it, loss=0.6318, grad_norm=0.992, lr=0.000010]Training Epoch 3/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.72s/it, loss=0.6318, grad_norm=0.992, lr=0.000010]Training Epoch 3/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.72s/it, loss=0.5951, grad_norm=0.997, lr=0.000010]Training Epoch 3/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.01it/s, loss=0.5951, grad_norm=0.997, lr=0.000010]Training Epoch 3/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.01it/s, loss=0.6599, grad_norm=1.059, lr=0.000010]Training Epoch 3/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.56it/s, loss=0.6599, grad_norm=1.059, lr=0.000010]Training Epoch 3/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:07,  1.56it/s, loss=0.6169, grad_norm=0.992, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.23it/s, loss=0.6169, grad_norm=0.992, lr=0.000010]Training Epoch 3/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.23it/s, loss=0.5483, grad_norm=1.112, lr=0.000010]Training Epoch 3/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.01it/s, loss=0.5483, grad_norm=1.112, lr=0.000010]Training Epoch 3/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.01it/s, loss=0.5785, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.79it/s, loss=0.5785, grad_norm=1.130, lr=0.000010]Training Epoch 3/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.79it/s, loss=0.6458, grad_norm=1.055, lr=0.000010]Training Epoch 3/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.52it/s, loss=0.6458, grad_norm=1.055, lr=0.000010]Training Epoch 3/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.52it/s, loss=0.5504, grad_norm=1.037, lr=0.000010]Training Epoch 3/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.38it/s, loss=0.5504, grad_norm=1.037, lr=0.000010]Training Epoch 3/5:  60%|#########################################################################################################                                                                      | 9/15 [00:05<00:01,  5.38it/s, loss=0.5714, grad_norm=1.023, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.17it/s, loss=0.5714, grad_norm=1.023, lr=0.000010]Training Epoch 3/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.17it/s, loss=0.5696, grad_norm=1.169, lr=0.000010]Training Epoch 3/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.89it/s, loss=0.5696, grad_norm=1.169, lr=0.000010]Training Epoch 3/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.89it/s, loss=0.5640, grad_norm=1.063, lr=0.000010]Training Epoch 3/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.46it/s, loss=0.5640, grad_norm=1.063, lr=0.000010]Training Epoch 3/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.46it/s, loss=0.5581, grad_norm=1.089, lr=0.000010]Training Epoch 3/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.95it/s, loss=0.5581, grad_norm=1.089, lr=0.000010]Training Epoch 3/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.95it/s, loss=0.5721, grad_norm=1.049, lr=0.000010]Training Epoch 3/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.16it/s, loss=0.5721, grad_norm=1.049, lr=0.000010]Training Epoch 3/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.16it/s, loss=0.4748, grad_norm=1.117, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  8.49it/s, loss=0.4748, grad_norm=1.117, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.43it/s, loss=0.4748, grad_norm=1.117, lr=0.000010]

Epoch 3/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5826, Acc: 0.7689, Precision: 0.6860, Recall: 0.9916, F1: 0.8110, AUC: 0.8723
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/15 [00:03<?, ?it/s, loss=0.5700, grad_norm=1.450, lr=0.000010]Training Epoch 4/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:03<00:54,  3.90s/it, loss=0.5700, grad_norm=1.450, lr=0.000010]Training Epoch 4/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:54,  3.90s/it, loss=0.5729, grad_norm=1.369, lr=0.000010]Training Epoch 4/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:21,  1.67s/it, loss=0.5729, grad_norm=1.369, lr=0.000010]Training Epoch 4/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:21,  1.67s/it, loss=0.4335, grad_norm=1.126, lr=0.000010]Training Epoch 4/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.04it/s, loss=0.4335, grad_norm=1.126, lr=0.000010]Training Epoch 4/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.04it/s, loss=0.4960, grad_norm=1.073, lr=0.000010]Training Epoch 4/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.61it/s, loss=0.4960, grad_norm=1.073, lr=0.000010]Training Epoch 4/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.61it/s, loss=0.4722, grad_norm=1.187, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.29it/s, loss=0.4722, grad_norm=1.187, lr=0.000010]Training Epoch 4/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.29it/s, loss=0.4495, grad_norm=1.421, lr=0.000010]Training Epoch 4/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.01it/s, loss=0.4495, grad_norm=1.421, lr=0.000010]Training Epoch 4/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.01it/s, loss=0.5384, grad_norm=1.699, lr=0.000010]Training Epoch 4/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.78it/s, loss=0.5384, grad_norm=1.699, lr=0.000010]Training Epoch 4/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.78it/s, loss=0.4606, grad_norm=1.620, lr=0.000010]Training Epoch 4/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.66it/s, loss=0.4606, grad_norm=1.620, lr=0.000010]Training Epoch 4/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.66it/s, loss=0.4610, grad_norm=1.591, lr=0.000010]Training Epoch 4/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.50it/s, loss=0.4610, grad_norm=1.591, lr=0.000010]Training Epoch 4/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.50it/s, loss=0.5561, grad_norm=2.546, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################                                                          | 10/15 [00:04<00:00,  6.28it/s, loss=0.5561, grad_norm=2.546, lr=0.000010]Training Epoch 4/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.28it/s, loss=0.4574, grad_norm=2.008, lr=0.000010]Training Epoch 4/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.69it/s, loss=0.4574, grad_norm=2.008, lr=0.000010]Training Epoch 4/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  6.69it/s, loss=0.4052, grad_norm=1.670, lr=0.000010]Training Epoch 4/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.17it/s, loss=0.4052, grad_norm=1.670, lr=0.000010]Training Epoch 4/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.17it/s, loss=0.3971, grad_norm=2.158, lr=0.000010]Training Epoch 4/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.67it/s, loss=0.3971, grad_norm=2.158, lr=0.000010]Training Epoch 4/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  7.67it/s, loss=0.4778, grad_norm=3.039, lr=0.000010]Training Epoch 4/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  7.79it/s, loss=0.4778, grad_norm=3.039, lr=0.000010]Training Epoch 4/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  7.79it/s, loss=0.5572, grad_norm=3.631, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 15/15 [00:05<00:00,  8.08it/s, loss=0.5572, grad_norm=3.631, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.46it/s, loss=0.5572, grad_norm=3.631, lr=0.000010]

Epoch 4/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.4870, Acc: 0.8529, Precision: 0.7958, Recall: 0.9496, F1: 0.8659, AUC: 0.9463
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/15 [00:03<?, ?it/s, loss=0.4591, grad_norm=2.998, lr=0.000010]Training Epoch 5/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:03<00:55,  3.96s/it, loss=0.4591, grad_norm=2.998, lr=0.000010]Training Epoch 5/5:   7%|###########6                                                                                                                                                                   | 1/15 [00:04<00:55,  3.96s/it, loss=0.3515, grad_norm=1.631, lr=0.000010]Training Epoch 5/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.70s/it, loss=0.3515, grad_norm=1.631, lr=0.000010]Training Epoch 5/5:  13%|#######################3                                                                                                                                                       | 2/15 [00:04<00:22,  1.70s/it, loss=0.3247, grad_norm=1.733, lr=0.000010]Training Epoch 5/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.03it/s, loss=0.3247, grad_norm=1.733, lr=0.000010]Training Epoch 5/5:  20%|###################################                                                                                                                                            | 3/15 [00:04<00:11,  1.03it/s, loss=0.3661, grad_norm=1.890, lr=0.000010]Training Epoch 5/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.59it/s, loss=0.3661, grad_norm=1.890, lr=0.000010]Training Epoch 5/5:  27%|##############################################6                                                                                                                                | 4/15 [00:04<00:06,  1.59it/s, loss=0.4543, grad_norm=3.165, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.26it/s, loss=0.4543, grad_norm=3.165, lr=0.000010]Training Epoch 5/5:  33%|##########################################################3                                                                                                                    | 5/15 [00:04<00:04,  2.26it/s, loss=0.3861, grad_norm=2.100, lr=0.000010]Training Epoch 5/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.05it/s, loss=0.3861, grad_norm=2.100, lr=0.000010]Training Epoch 5/5:  40%|######################################################################                                                                                                         | 6/15 [00:04<00:02,  3.05it/s, loss=0.4907, grad_norm=4.232, lr=0.000010]Training Epoch 5/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.92it/s, loss=0.4907, grad_norm=4.232, lr=0.000010]Training Epoch 5/5:  47%|#################################################################################6                                                                                             | 7/15 [00:04<00:02,  3.92it/s, loss=0.2631, grad_norm=1.170, lr=0.000010]Training Epoch 5/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.82it/s, loss=0.2631, grad_norm=1.170, lr=0.000010]Training Epoch 5/5:  53%|#############################################################################################3                                                                                 | 8/15 [00:04<00:01,  4.82it/s, loss=0.3264, grad_norm=1.569, lr=0.000010]Training Epoch 5/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.69it/s, loss=0.3264, grad_norm=1.569, lr=0.000010]Training Epoch 5/5:  60%|#########################################################################################################                                                                      | 9/15 [00:04<00:01,  5.69it/s, loss=0.2183, grad_norm=1.125, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################                                                          | 10/15 [00:04<00:00,  6.44it/s, loss=0.2183, grad_norm=1.125, lr=0.000010]Training Epoch 5/5:  67%|####################################################################################################################                                                          | 10/15 [00:05<00:00,  6.44it/s, loss=0.2595, grad_norm=1.771, lr=0.000010]Training Epoch 5/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  7.06it/s, loss=0.2595, grad_norm=1.771, lr=0.000010]Training Epoch 5/5:  73%|###############################################################################################################################6                                              | 11/15 [00:05<00:00,  7.06it/s, loss=0.2559, grad_norm=2.609, lr=0.000010]Training Epoch 5/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.61it/s, loss=0.2559, grad_norm=2.609, lr=0.000010]Training Epoch 5/5:  80%|###########################################################################################################################################2                                  | 12/15 [00:05<00:00,  7.61it/s, loss=0.2497, grad_norm=1.847, lr=0.000010]Training Epoch 5/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  8.14it/s, loss=0.2497, grad_norm=1.847, lr=0.000010]Training Epoch 5/5:  87%|######################################################################################################################################################8                       | 13/15 [00:05<00:00,  8.14it/s, loss=0.2679, grad_norm=2.622, lr=0.000010]Training Epoch 5/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.47it/s, loss=0.2679, grad_norm=2.622, lr=0.000010]Training Epoch 5/5:  93%|##################################################################################################################################################################4           | 14/15 [00:05<00:00,  8.47it/s, loss=0.4285, grad_norm=5.923, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 15/15 [00:06<00:00,  2.50it/s, loss=0.4285, grad_norm=5.923, lr=0.000010]

Epoch 5/5 Complete (6.4s) [LR: 0.000005]
Train - Loss: 0.3401, Acc: 0.9118, Precision: 0.9083, Recall: 0.9160, F1: 0.9121, AUC: 0.9718
------------------------------------------------------------
Training curves saved to model\chb23_fold5\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb23_fold5
============================================================
✅ Fold 5 training completed successfully!

============================================================
TRAINING FOLD 6/6
============================================================
Using dataset prefix: chb23_fold6
Loading datasets from: preprocessing\data\chb23_fold6
Saving models to: model\chb23_fold6
🚀 CUDA detected: NVIDIA GeForce RTX 3090 Ti
Using device: cuda
  - Normalization: z-score, mean=0.0803, std=2.1554
Loaded train dataset: 246 samples
  - Spectrogram shape: torch.Size([246, 30, 18, 50, 10])
  - Value range: [-5.6047, 3.8740]
  - Class distribution: tensor([123, 123])
LOOCV Mode (Fold 6): No validation set, using training-only evaluation
Model initialized with 41286914 parameters
============================================================
STARTING EEG SEIZURE PREDICTION TRAINING
============================================================
Task mode: PREDICTION (preictal vs interictal)
LOOCV Mode: Fold None/6 (Test seizure: None)
Note: No validation set in LOOCV mode
Training for 5 epochs
Batch size: 16
Learning rate: 1e-05
Device: cuda (NVIDIA GeForce RTX 3090 Ti)
🚀 Using CUDA GPU - maximum performance!
============================================================
Training Epoch 1/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 1/5:   0%|                                                                                                                                                                                       | 0/16 [00:03<?, ?it/s, loss=0.6970, grad_norm=0.985, lr=0.000010]Training Epoch 1/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:03<00:59,  3.99s/it, loss=0.6970, grad_norm=0.985, lr=0.000010]Training Epoch 1/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<00:59,  3.99s/it, loss=0.7006, grad_norm=1.254, lr=0.000010]Training Epoch 1/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.71s/it, loss=0.7006, grad_norm=1.254, lr=0.000010]Training Epoch 1/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.71s/it, loss=0.6960, grad_norm=0.976, lr=0.000010]Training Epoch 1/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.02it/s, loss=0.6960, grad_norm=0.976, lr=0.000010]Training Epoch 1/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.02it/s, loss=0.6812, grad_norm=1.224, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.58it/s, loss=0.6812, grad_norm=1.224, lr=0.000010]Training Epoch 1/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.58it/s, loss=0.7128, grad_norm=1.124, lr=0.000010]Training Epoch 1/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.25it/s, loss=0.7128, grad_norm=1.124, lr=0.000010]Training Epoch 1/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.25it/s, loss=0.6723, grad_norm=1.010, lr=0.000010]Training Epoch 1/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.03it/s, loss=0.6723, grad_norm=1.010, lr=0.000010]Training Epoch 1/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.03it/s, loss=0.6944, grad_norm=0.997, lr=0.000010]Training Epoch 1/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.90it/s, loss=0.6944, grad_norm=0.997, lr=0.000010]Training Epoch 1/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.90it/s, loss=0.6922, grad_norm=0.888, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.80it/s, loss=0.6922, grad_norm=0.888, lr=0.000010]Training Epoch 1/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.80it/s, loss=0.6915, grad_norm=0.979, lr=0.000010]Training Epoch 1/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.69it/s, loss=0.6915, grad_norm=0.979, lr=0.000010]Training Epoch 1/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.69it/s, loss=0.6756, grad_norm=1.123, lr=0.000010]Training Epoch 1/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.52it/s, loss=0.6756, grad_norm=1.123, lr=0.000010]Training Epoch 1/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.52it/s, loss=0.6755, grad_norm=0.908, lr=0.000010]Training Epoch 1/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  7.23it/s, loss=0.6755, grad_norm=0.908, lr=0.000010]Training Epoch 1/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  7.23it/s, loss=0.6769, grad_norm=0.934, lr=0.000010]Training Epoch 1/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.77it/s, loss=0.6769, grad_norm=0.934, lr=0.000010]Training Epoch 1/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.77it/s, loss=0.6704, grad_norm=0.972, lr=0.000010]Training Epoch 1/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  8.18it/s, loss=0.6704, grad_norm=0.972, lr=0.000010]Training Epoch 1/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  8.18it/s, loss=0.6710, grad_norm=1.123, lr=0.000010]Training Epoch 1/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.54it/s, loss=0.6710, grad_norm=1.123, lr=0.000010]Training Epoch 1/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.54it/s, loss=0.6669, grad_norm=1.069, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.78it/s, loss=0.6669, grad_norm=1.069, lr=0.000010]Training Epoch 1/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.78it/s, loss=0.6770, grad_norm=1.745, lr=0.000010]Training Epoch 1/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.61it/s, loss=0.6770, grad_norm=1.745, lr=0.000010]

Epoch 1/5 Complete (6.5s) [LR: 0.000010]
Train - Loss: 0.6845, Acc: 0.5935, Precision: 0.5615, Recall: 0.8537, F1: 0.6774, AUC: 0.6502
------------------------------------------------------------
Training Epoch 2/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 2/5:   0%|                                                                                                                                                                                       | 0/16 [00:03<?, ?it/s, loss=0.6525, grad_norm=1.060, lr=0.000010]Training Epoch 2/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:03<00:58,  3.90s/it, loss=0.6525, grad_norm=1.060, lr=0.000010]Training Epoch 2/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<00:58,  3.90s/it, loss=0.6691, grad_norm=1.028, lr=0.000010]Training Epoch 2/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.67s/it, loss=0.6691, grad_norm=1.028, lr=0.000010]Training Epoch 2/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.67s/it, loss=0.6642, grad_norm=1.025, lr=0.000010]Training Epoch 2/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.05it/s, loss=0.6642, grad_norm=1.025, lr=0.000010]Training Epoch 2/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.05it/s, loss=0.6902, grad_norm=1.247, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.61it/s, loss=0.6902, grad_norm=1.247, lr=0.000010]Training Epoch 2/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.61it/s, loss=0.6759, grad_norm=1.241, lr=0.000010]Training Epoch 2/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.30it/s, loss=0.6759, grad_norm=1.241, lr=0.000010]Training Epoch 2/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.30it/s, loss=0.6486, grad_norm=0.988, lr=0.000010]Training Epoch 2/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.09it/s, loss=0.6486, grad_norm=0.988, lr=0.000010]Training Epoch 2/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.09it/s, loss=0.6350, grad_norm=1.091, lr=0.000010]Training Epoch 2/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.96it/s, loss=0.6350, grad_norm=1.091, lr=0.000010]Training Epoch 2/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.96it/s, loss=0.6447, grad_norm=1.170, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.86it/s, loss=0.6447, grad_norm=1.170, lr=0.000010]Training Epoch 2/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.86it/s, loss=0.6386, grad_norm=0.999, lr=0.000010]Training Epoch 2/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.72it/s, loss=0.6386, grad_norm=0.999, lr=0.000010]Training Epoch 2/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.72it/s, loss=0.5918, grad_norm=1.110, lr=0.000010]Training Epoch 2/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.53it/s, loss=0.5918, grad_norm=1.110, lr=0.000010]Training Epoch 2/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.53it/s, loss=0.6273, grad_norm=0.935, lr=0.000010]Training Epoch 2/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:04<00:00,  7.18it/s, loss=0.6273, grad_norm=0.935, lr=0.000010]Training Epoch 2/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  7.18it/s, loss=0.6501, grad_norm=1.167, lr=0.000010]Training Epoch 2/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.79it/s, loss=0.6501, grad_norm=1.167, lr=0.000010]Training Epoch 2/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.79it/s, loss=0.6408, grad_norm=0.983, lr=0.000010]Training Epoch 2/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  8.21it/s, loss=0.6408, grad_norm=0.983, lr=0.000010]Training Epoch 2/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  8.21it/s, loss=0.6423, grad_norm=1.047, lr=0.000010]Training Epoch 2/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.58it/s, loss=0.6423, grad_norm=1.047, lr=0.000010]Training Epoch 2/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.58it/s, loss=0.6118, grad_norm=0.982, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.82it/s, loss=0.6118, grad_norm=0.982, lr=0.000010]Training Epoch 2/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.82it/s, loss=0.5858, grad_norm=1.482, lr=0.000010]Training Epoch 2/5: 100%|##############################################################################################################################################################################| 16/16 [00:05<00:00,  2.67it/s, loss=0.5858, grad_norm=1.482, lr=0.000010]

Epoch 2/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.6418, Acc: 0.7602, Precision: 0.6839, Recall: 0.9675, F1: 0.8013, AUC: 0.8427
------------------------------------------------------------
Training Epoch 3/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 3/5:   0%|                                                                                                                                                                                       | 0/16 [00:03<?, ?it/s, loss=0.6018, grad_norm=0.961, lr=0.000010]Training Epoch 3/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:03<00:58,  3.90s/it, loss=0.6018, grad_norm=0.961, lr=0.000010]Training Epoch 3/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<00:58,  3.90s/it, loss=0.5762, grad_norm=0.995, lr=0.000010]Training Epoch 3/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.67s/it, loss=0.5762, grad_norm=0.995, lr=0.000010]Training Epoch 3/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.67s/it, loss=0.6380, grad_norm=1.022, lr=0.000010]Training Epoch 3/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.04it/s, loss=0.6380, grad_norm=1.022, lr=0.000010]Training Epoch 3/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.04it/s, loss=0.6176, grad_norm=1.148, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.61it/s, loss=0.6176, grad_norm=1.148, lr=0.000010]Training Epoch 3/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.61it/s, loss=0.5732, grad_norm=0.965, lr=0.000010]Training Epoch 3/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.29it/s, loss=0.5732, grad_norm=0.965, lr=0.000010]Training Epoch 3/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.29it/s, loss=0.6431, grad_norm=1.196, lr=0.000010]Training Epoch 3/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.08it/s, loss=0.6431, grad_norm=1.196, lr=0.000010]Training Epoch 3/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.08it/s, loss=0.5725, grad_norm=0.946, lr=0.000010]Training Epoch 3/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.93it/s, loss=0.5725, grad_norm=0.946, lr=0.000010]Training Epoch 3/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.93it/s, loss=0.5683, grad_norm=1.008, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.79it/s, loss=0.5683, grad_norm=1.008, lr=0.000010]Training Epoch 3/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.79it/s, loss=0.5642, grad_norm=1.035, lr=0.000010]Training Epoch 3/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.65it/s, loss=0.5642, grad_norm=1.035, lr=0.000010]Training Epoch 3/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.65it/s, loss=0.6458, grad_norm=1.102, lr=0.000010]Training Epoch 3/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.40it/s, loss=0.6458, grad_norm=1.102, lr=0.000010]Training Epoch 3/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.40it/s, loss=0.5163, grad_norm=1.186, lr=0.000010]Training Epoch 3/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:04<00:00,  7.06it/s, loss=0.5163, grad_norm=1.186, lr=0.000010]Training Epoch 3/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  7.06it/s, loss=0.5655, grad_norm=1.069, lr=0.000010]Training Epoch 3/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.57it/s, loss=0.5655, grad_norm=1.069, lr=0.000010]Training Epoch 3/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.57it/s, loss=0.5659, grad_norm=0.968, lr=0.000010]Training Epoch 3/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.99it/s, loss=0.5659, grad_norm=0.968, lr=0.000010]Training Epoch 3/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  7.99it/s, loss=0.5516, grad_norm=1.089, lr=0.000010]Training Epoch 3/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.30it/s, loss=0.5516, grad_norm=1.089, lr=0.000010]Training Epoch 3/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.30it/s, loss=0.5694, grad_norm=1.125, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.54it/s, loss=0.5694, grad_norm=1.125, lr=0.000010]Training Epoch 3/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.54it/s, loss=0.4728, grad_norm=1.353, lr=0.000010]Training Epoch 3/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.65it/s, loss=0.4728, grad_norm=1.353, lr=0.000010]

Epoch 3/5 Complete (6.4s) [LR: 0.000010]
Train - Loss: 0.5776, Acc: 0.7846, Precision: 0.7059, Recall: 0.9756, F1: 0.8191, AUC: 0.8813
------------------------------------------------------------
Training Epoch 4/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 4/5:   0%|                                                                                                                                                                                       | 0/16 [00:04<?, ?it/s, loss=0.5976, grad_norm=1.347, lr=0.000010]Training Epoch 4/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:00,  4.03s/it, loss=0.5976, grad_norm=1.347, lr=0.000010]Training Epoch 4/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<01:00,  4.03s/it, loss=0.5641, grad_norm=1.281, lr=0.000010]Training Epoch 4/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.73s/it, loss=0.5641, grad_norm=1.281, lr=0.000010]Training Epoch 4/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:24,  1.73s/it, loss=0.5502, grad_norm=1.370, lr=0.000010]Training Epoch 4/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.01it/s, loss=0.5502, grad_norm=1.370, lr=0.000010]Training Epoch 4/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.01it/s, loss=0.5516, grad_norm=1.319, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.56it/s, loss=0.5516, grad_norm=1.319, lr=0.000010]Training Epoch 4/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.56it/s, loss=0.5495, grad_norm=1.703, lr=0.000010]Training Epoch 4/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.22it/s, loss=0.5495, grad_norm=1.703, lr=0.000010]Training Epoch 4/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.22it/s, loss=0.4597, grad_norm=1.143, lr=0.000010]Training Epoch 4/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.00it/s, loss=0.4597, grad_norm=1.143, lr=0.000010]Training Epoch 4/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.00it/s, loss=0.4512, grad_norm=1.054, lr=0.000010]Training Epoch 4/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.86it/s, loss=0.4512, grad_norm=1.054, lr=0.000010]Training Epoch 4/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.86it/s, loss=0.4787, grad_norm=1.409, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.75it/s, loss=0.4787, grad_norm=1.409, lr=0.000010]Training Epoch 4/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.75it/s, loss=0.4489, grad_norm=1.311, lr=0.000010]Training Epoch 4/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.59it/s, loss=0.4489, grad_norm=1.311, lr=0.000010]Training Epoch 4/5:  56%|##################################################################################################4                                                                            | 9/16 [00:05<00:01,  5.59it/s, loss=0.4708, grad_norm=1.336, lr=0.000010]Training Epoch 4/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.35it/s, loss=0.4708, grad_norm=1.336, lr=0.000010]Training Epoch 4/5:  62%|############################################################################################################7                                                                 | 10/16 [00:05<00:00,  6.35it/s, loss=0.4994, grad_norm=1.414, lr=0.000010]Training Epoch 4/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  7.04it/s, loss=0.4994, grad_norm=1.414, lr=0.000010]Training Epoch 4/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  7.04it/s, loss=0.4642, grad_norm=1.279, lr=0.000010]Training Epoch 4/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.60it/s, loss=0.4642, grad_norm=1.279, lr=0.000010]Training Epoch 4/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.60it/s, loss=0.4985, grad_norm=1.692, lr=0.000010]Training Epoch 4/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  8.00it/s, loss=0.4985, grad_norm=1.692, lr=0.000010]Training Epoch 4/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  8.00it/s, loss=0.4285, grad_norm=1.713, lr=0.000010]Training Epoch 4/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.31it/s, loss=0.4285, grad_norm=1.713, lr=0.000010]Training Epoch 4/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.31it/s, loss=0.4052, grad_norm=1.819, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.58it/s, loss=0.4052, grad_norm=1.819, lr=0.000010]Training Epoch 4/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.58it/s, loss=0.9352, grad_norm=4.519, lr=0.000010]Training Epoch 4/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.59it/s, loss=0.9352, grad_norm=4.519, lr=0.000010]

Epoch 4/5 Complete (6.6s) [LR: 0.000010]
Train - Loss: 0.5221, Acc: 0.8211, Precision: 0.7548, Recall: 0.9512, F1: 0.8417, AUC: 0.8965
------------------------------------------------------------
Training Epoch 5/5:   0%|                                                                                                                                                                                                                                  | 0/16 [00:00<?, ?it/s]Training Epoch 5/5:   0%|                                                                                                                                                                                       | 0/16 [00:03<?, ?it/s, loss=0.4377, grad_norm=1.616, lr=0.000010]Training Epoch 5/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:03<00:58,  3.89s/it, loss=0.4377, grad_norm=1.616, lr=0.000010]Training Epoch 5/5:   6%|##########9                                                                                                                                                                    | 1/16 [00:04<00:58,  3.89s/it, loss=0.4211, grad_norm=1.807, lr=0.000010]Training Epoch 5/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.67s/it, loss=0.4211, grad_norm=1.807, lr=0.000010]Training Epoch 5/5:  12%|#####################8                                                                                                                                                         | 2/16 [00:04<00:23,  1.67s/it, loss=0.3911, grad_norm=1.184, lr=0.000010]Training Epoch 5/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.05it/s, loss=0.3911, grad_norm=1.184, lr=0.000010]Training Epoch 5/5:  19%|################################8                                                                                                                                              | 3/16 [00:04<00:12,  1.05it/s, loss=0.3845, grad_norm=1.804, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.61it/s, loss=0.3845, grad_norm=1.804, lr=0.000010]Training Epoch 5/5:  25%|###########################################7                                                                                                                                   | 4/16 [00:04<00:07,  1.61it/s, loss=0.3959, grad_norm=1.647, lr=0.000010]Training Epoch 5/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.29it/s, loss=0.3959, grad_norm=1.647, lr=0.000010]Training Epoch 5/5:  31%|######################################################6                                                                                                                        | 5/16 [00:04<00:04,  2.29it/s, loss=0.3484, grad_norm=1.465, lr=0.000010]Training Epoch 5/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.07it/s, loss=0.3484, grad_norm=1.465, lr=0.000010]Training Epoch 5/5:  38%|#################################################################6                                                                                                             | 6/16 [00:04<00:03,  3.07it/s, loss=0.4029, grad_norm=1.465, lr=0.000010]Training Epoch 5/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.93it/s, loss=0.4029, grad_norm=1.465, lr=0.000010]Training Epoch 5/5:  44%|############################################################################5                                                                                                  | 7/16 [00:04<00:02,  3.93it/s, loss=0.4108, grad_norm=2.662, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.80it/s, loss=0.4108, grad_norm=2.662, lr=0.000010]Training Epoch 5/5:  50%|#######################################################################################5                                                                                       | 8/16 [00:04<00:01,  4.80it/s, loss=0.2372, grad_norm=1.271, lr=0.000010]Training Epoch 5/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.64it/s, loss=0.2372, grad_norm=1.271, lr=0.000010]Training Epoch 5/5:  56%|##################################################################################################4                                                                            | 9/16 [00:04<00:01,  5.64it/s, loss=0.3524, grad_norm=1.911, lr=0.000010]Training Epoch 5/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.42it/s, loss=0.3524, grad_norm=1.911, lr=0.000010]Training Epoch 5/5:  62%|############################################################################################################7                                                                 | 10/16 [00:04<00:00,  6.42it/s, loss=0.4020, grad_norm=2.167, lr=0.000010]Training Epoch 5/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:04<00:00,  7.06it/s, loss=0.4020, grad_norm=2.167, lr=0.000010]Training Epoch 5/5:  69%|#######################################################################################################################6                                                      | 11/16 [00:05<00:00,  7.06it/s, loss=0.3763, grad_norm=1.969, lr=0.000010]Training Epoch 5/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.59it/s, loss=0.3763, grad_norm=1.969, lr=0.000010]Training Epoch 5/5:  75%|##################################################################################################################################5                                           | 12/16 [00:05<00:00,  7.59it/s, loss=0.3638, grad_norm=2.901, lr=0.000010]Training Epoch 5/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  8.05it/s, loss=0.3638, grad_norm=2.901, lr=0.000010]Training Epoch 5/5:  81%|#############################################################################################################################################3                                | 13/16 [00:05<00:00,  8.05it/s, loss=0.3518, grad_norm=2.894, lr=0.000010]Training Epoch 5/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.34it/s, loss=0.3518, grad_norm=2.894, lr=0.000010]Training Epoch 5/5:  88%|########################################################################################################################################################2                     | 14/16 [00:05<00:00,  8.34it/s, loss=0.3799, grad_norm=2.622, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.57it/s, loss=0.3799, grad_norm=2.622, lr=0.000010]Training Epoch 5/5:  94%|###################################################################################################################################################################1          | 15/16 [00:05<00:00,  8.57it/s, loss=0.3229, grad_norm=4.588, lr=0.000010]Training Epoch 5/5: 100%|##############################################################################################################################################################################| 16/16 [00:06<00:00,  2.65it/s, loss=0.3229, grad_norm=4.588, lr=0.000010]

Epoch 5/5 Complete (6.4s) [LR: 0.000005]
Train - Loss: 0.3737, Acc: 0.9024, Precision: 0.8462, Recall: 0.9837, F1: 0.9098, AUC: 0.9519
------------------------------------------------------------
Training curves saved to model\chb23_fold6\training_curves.png
============================================================
TRAINING COMPLETED!
Total training time: 0.5 minutes
Models saved in: model\chb23_fold6
============================================================
✅ Fold 6 training completed successfully!

============================================================
✅ BATCH TRAINING COMPLETED!
✅ Trained models for 7 folds for patient chb23
============================================================
============================================================
============================================================
BATCH EVALUATION: ALL FOLDS
BATCH EVALUATION: ALL FOLDS
Evaluating 7 folds for patient chb23
Evaluating 7 folds for patient chb23
============================================================
============================================================
Using CUDA: NVIDIA GeForce RTX 3090 Ti
Using CUDA: NVIDIA GeForce RTX 3090 Ti

============================================================
============================================================

EVALUATING FOLD 0/6
EVALUATING FOLD 0/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb23_fold0
Dataset prefix: chb23_fold0
Using test dataset: preprocessing\data\chb23_fold0\test_dataset.h5
Using test dataset: preprocessing\data\chb23_fold0\test_dataset.h5
Loading test dataset from preprocessing\data\chb23_fold0\test_dataset.h5...
Loading test dataset from preprocessing\data\chb23_fold0\test_dataset.h5...
  - Normalization: z-score, mean=0.1190, std=2.1417
  - Normalization: z-score, mean=0.1190, std=2.1417
Loaded test dataset: 42 samples
Loaded test dataset: 42 samples
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([42, 30, 18, 50, 10])
  - Value range: [-5.6585, 3.7905]
  - Value range: [-5.6585, 3.7905]
  - Class distribution: tensor([21, 21])
  - Class distribution: tensor([21, 21])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb23_fold0\epoch_005.pth...
Loading model checkpoint from model\chb23_fold0\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:  33%|############################################################################6                                                                                                                                                         | 1/3 [00:00<00:00,  4.01it/s]Testing:  33%|############################################################################6                                                                                                                                                         | 1/3 [00:00<00:00,  4.01it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00,  9.34it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00,  9.34it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.3778
Loss:      0.3778
Accuracy:  0.7143 (71.43%)
Accuracy:  0.7143 (71.43%)
Precision: 0.8462
Precision: 0.8462
Recall:    0.5238
Recall:    0.5238
F1 Score:  0.6471
F1 Score:  0.6471
AUC-ROC:   0.9297
AUC-ROC:   0.9297

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        19         2
Actual Interictal        19         2
       Preictal        10        11
       Preictal        10        11

Class Distribution:
Class Distribution:

True Interictal (0): 21 samples
True Interictal (0): 21 samples
True Preictal (1):   21 samples
True Preictal (1):   21 samples
Pred Interictal (0): 29 samples
Pred Interictal (0): 29 samples
Pred Preictal (1):   13 samples
Pred Preictal (1):   13 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     0.6552    0.9048    0.7600        21
    Preictal     0.8462    0.5238    0.6471        21

    accuracy                         0.7143        42
   macro avg     0.7507    0.7143    0.7035        42
weighted avg     0.7507    0.7143    0.7035        42
              precision    recall  f1-score   support

  Interictal     0.6552    0.9048    0.7600        21
    Preictal     0.8462    0.5238    0.6471        21

    accuracy                         0.7143        42
   macro avg     0.7507    0.7143    0.7035        42
weighted avg     0.7507    0.7143    0.7035        42



✅ Results saved to model\chb23_fold0\test_results.json
✅ Results saved to model\chb23_fold0\test_results.json


============================================================
============================================================

EVALUATING FOLD 1/6
EVALUATING FOLD 1/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb23_fold1
Dataset prefix: chb23_fold1
Using test dataset: preprocessing\data\chb23_fold1\test_dataset.h5
Using test dataset: preprocessing\data\chb23_fold1\test_dataset.h5
Loading test dataset from preprocessing\data\chb23_fold1\test_dataset.h5...
Loading test dataset from preprocessing\data\chb23_fold1\test_dataset.h5...
  - Normalization: z-score, mean=0.1367, std=2.1215
  - Normalization: z-score, mean=0.1367, std=2.1215
Loaded test dataset: 26 samples
Loaded test dataset: 26 samples
  - Spectrogram shape: torch.Size([26, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([26, 30, 18, 50, 10])
  - Value range: [-5.7086, 4.0777]
  - Value range: [-5.7086, 4.0777]
  - Class distribution: tensor([13, 13])
  - Class distribution: tensor([13, 13])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb23_fold1\epoch_005.pth...
Loading model checkpoint from model\chb23_fold1\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/2 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/2 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 2/2 [00:00<00:00, 32.21it/s]Testing: 100%|######################################################################################################################################################################################################################################| 2/2 [00:00<00:00, 32.21it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.3638
Loss:      0.3638
Accuracy:  0.9615 (96.15%)
Accuracy:  0.9615 (96.15%)
Precision: 0.9286
Precision: 0.9286
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9630
F1 Score:  0.9630
AUC-ROC:   0.9349
AUC-ROC:   0.9349

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        12         1
Actual Interictal        12         1
       Preictal         0        13
       Preictal         0        13

Class Distribution:
Class Distribution:

True Interictal (0): 13 samples
True Interictal (0): 13 samples
True Preictal (1):   13 samples
True Preictal (1):   13 samples
Pred Interictal (0): 12 samples
Pred Interictal (0): 12 samples
Pred Preictal (1):   14 samples
Pred Preictal (1):   14 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.9231    0.9600        13
    Preictal     0.9286    1.0000    0.9630        13

    accuracy                         0.9615        26
   macro avg     0.9643    0.9615    0.9615        26
weighted avg     0.9643    0.9615    0.9615        26
              precision    recall  f1-score   support

  Interictal     1.0000    0.9231    0.9600        13
    Preictal     0.9286    1.0000    0.9630        13

    accuracy                         0.9615        26
   macro avg     0.9643    0.9615    0.9615        26
weighted avg     0.9643    0.9615    0.9615        26



✅ Results saved to model\chb23_fold1\test_results.json
✅ Results saved to model\chb23_fold1\test_results.json


============================================================
============================================================

EVALUATING FOLD 2/6
EVALUATING FOLD 2/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb23_fold2
Dataset prefix: chb23_fold2
Using test dataset: preprocessing\data\chb23_fold2\test_dataset.h5
Using test dataset: preprocessing\data\chb23_fold2\test_dataset.h5
Loading test dataset from preprocessing\data\chb23_fold2\test_dataset.h5...
Loading test dataset from preprocessing\data\chb23_fold2\test_dataset.h5...
  - Normalization: z-score, mean=0.1484, std=2.1125
  - Normalization: z-score, mean=0.1484, std=2.1125
Loaded test dataset: 48 samples
Loaded test dataset: 48 samples
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([48, 30, 18, 50, 10])
  - Value range: [-5.7507, 3.9826]
  - Value range: [-5.7507, 3.9826]
  - Class distribution: tensor([24, 24])
  - Class distribution: tensor([24, 24])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb23_fold2\epoch_005.pth...
Loading model checkpoint from model\chb23_fold2\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.13it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.13it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.04it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.04it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.3135
Loss:      0.3135
Accuracy:  0.9167 (91.67%)
Accuracy:  0.9167 (91.67%)
Precision: 0.8571
Precision: 0.8571
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9231
F1 Score:  0.9231
AUC-ROC:   0.9618
AUC-ROC:   0.9618

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        20         4
Actual Interictal        20         4
       Preictal         0        24
       Preictal         0        24

Class Distribution:
Class Distribution:

True Interictal (0): 24 samples
True Interictal (0): 24 samples
True Preictal (1):   24 samples
True Preictal (1):   24 samples
Pred Interictal (0): 20 samples
Pred Interictal (0): 20 samples
Pred Preictal (1):   28 samples
Pred Preictal (1):   28 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.8333    0.9091        24
    Preictal     0.8571    1.0000    0.9231        24

    accuracy                         0.9167        48
   macro avg     0.9286    0.9167    0.9161        48
weighted avg     0.9286    0.9167    0.9161        48
              precision    recall  f1-score   support

  Interictal     1.0000    0.8333    0.9091        24
    Preictal     0.8571    1.0000    0.9231        24

    accuracy                         0.9167        48
   macro avg     0.9286    0.9167    0.9161        48
weighted avg     0.9286    0.9167    0.9161        48



✅ Results saved to model\chb23_fold2\test_results.json
✅ Results saved to model\chb23_fold2\test_results.json


============================================================
============================================================

EVALUATING FOLD 3/6
EVALUATING FOLD 3/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb23_fold3
Dataset prefix: chb23_fold3
Using test dataset: preprocessing\data\chb23_fold3\test_dataset.h5
Using test dataset: preprocessing\data\chb23_fold3\test_dataset.h5
Loading test dataset from preprocessing\data\chb23_fold3\test_dataset.h5...
Loading test dataset from preprocessing\data\chb23_fold3\test_dataset.h5...
  - Normalization: z-score, mean=0.0666, std=2.1405
  - Normalization: z-score, mean=0.0666, std=2.1405
Loaded test dataset: 40 samples
Loaded test dataset: 40 samples
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([40, 30, 18, 50, 10])
  - Value range: [-5.6373, 4.3631]
  - Value range: [-5.6373, 4.3631]
  - Class distribution: tensor([20, 20])
  - Class distribution: tensor([20, 20])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb23_fold3\epoch_005.pth...
Loading model checkpoint from model\chb23_fold3\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 31.63it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 31.63it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.1741
Loss:      0.1741
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        20         0
Actual Interictal        20         0
       Preictal         0        20
       Preictal         0        20

Class Distribution:
Class Distribution:

True Interictal (0): 20 samples
True Interictal (0): 20 samples
True Preictal (1):   20 samples
True Preictal (1):   20 samples
Pred Interictal (0): 20 samples
Pred Interictal (0): 20 samples
Pred Preictal (1):   20 samples
Pred Preictal (1):   20 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        20
    Preictal     1.0000    1.0000    1.0000        20

    accuracy                         1.0000        40
   macro avg     1.0000    1.0000    1.0000        40
weighted avg     1.0000    1.0000    1.0000        40
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        20
    Preictal     1.0000    1.0000    1.0000        20

    accuracy                         1.0000        40
   macro avg     1.0000    1.0000    1.0000        40
weighted avg     1.0000    1.0000    1.0000        40



✅ Results saved to model\chb23_fold3\test_results.json
✅ Results saved to model\chb23_fold3\test_results.json


============================================================
============================================================

EVALUATING FOLD 4/6
EVALUATING FOLD 4/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb23_fold4
Dataset prefix: chb23_fold4
Using test dataset: preprocessing\data\chb23_fold4\test_dataset.h5
Using test dataset: preprocessing\data\chb23_fold4\test_dataset.h5
Loading test dataset from preprocessing\data\chb23_fold4\test_dataset.h5...
Loading test dataset from preprocessing\data\chb23_fold4\test_dataset.h5...
  - Normalization: z-score, mean=0.1770, std=2.1185
  - Normalization: z-score, mean=0.1770, std=2.1185
Loaded test dataset: 44 samples
Loaded test dataset: 44 samples
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([44, 30, 18, 50, 10])
  - Value range: [-5.7478, 3.9061]
  - Value range: [-5.7478, 3.9061]
  - Class distribution: tensor([22, 22])
  - Class distribution: tensor([22, 22])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb23_fold4\epoch_005.pth...
Loading model checkpoint from model\chb23_fold4\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.85it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.85it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.75it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 29.75it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.3119
Loss:      0.3119
Accuracy:  0.9318 (93.18%)
Accuracy:  0.9318 (93.18%)
Precision: 0.8800
Precision: 0.8800
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.9362
F1 Score:  0.9362
AUC-ROC:   0.9298
AUC-ROC:   0.9298

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        19         3
Actual Interictal        19         3
       Preictal         0        22
       Preictal         0        22

Class Distribution:
Class Distribution:

True Interictal (0): 22 samples
True Interictal (0): 22 samples
True Preictal (1):   22 samples
True Preictal (1):   22 samples
Pred Interictal (0): 19 samples
Pred Interictal (0): 19 samples
Pred Preictal (1):   25 samples
Pred Preictal (1):   25 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.8636    0.9268        22
    Preictal     0.8800    1.0000    0.9362        22

    accuracy                         0.9318        44
   macro avg     0.9400    0.9318    0.9315        44
weighted avg     0.9400    0.9318    0.9315        44
              precision    recall  f1-score   support

  Interictal     1.0000    0.8636    0.9268        22
    Preictal     0.8800    1.0000    0.9362        22

    accuracy                         0.9318        44
   macro avg     0.9400    0.9318    0.9315        44
weighted avg     0.9400    0.9318    0.9315        44



✅ Results saved to model\chb23_fold4\test_results.json
✅ Results saved to model\chb23_fold4\test_results.json


============================================================
============================================================

EVALUATING FOLD 5/6
EVALUATING FOLD 5/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb23_fold5
Dataset prefix: chb23_fold5
Using test dataset: preprocessing\data\chb23_fold5\test_dataset.h5
Using test dataset: preprocessing\data\chb23_fold5\test_dataset.h5
Loading test dataset from preprocessing\data\chb23_fold5\test_dataset.h5...
Loading test dataset from preprocessing\data\chb23_fold5\test_dataset.h5...
  - Normalization: z-score, mean=0.0758, std=2.1329
  - Normalization: z-score, mean=0.0758, std=2.1329
Loaded test dataset: 46 samples
Loaded test dataset: 46 samples
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([46, 30, 18, 50, 10])
  - Value range: [-5.6617, 3.9795]
  - Value range: [-5.6617, 3.9795]
  - Class distribution: tensor([23, 23])
  - Class distribution: tensor([23, 23])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb23_fold5\epoch_005.pth...
Loading model checkpoint from model\chb23_fold5\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.51it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 30.51it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.2877
Loss:      0.2877
Accuracy:  1.0000 (100.00%)
Accuracy:  1.0000 (100.00%)
Precision: 1.0000
Precision: 1.0000
Recall:    1.0000
Recall:    1.0000
F1 Score:  1.0000
F1 Score:  1.0000
AUC-ROC:   1.0000
AUC-ROC:   1.0000

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        23         0
Actual Interictal        23         0
       Preictal         0        23
       Preictal         0        23

Class Distribution:
Class Distribution:

True Interictal (0): 23 samples
True Interictal (0): 23 samples
True Preictal (1):   23 samples
True Preictal (1):   23 samples
Pred Interictal (0): 23 samples
Pred Interictal (0): 23 samples
Pred Preictal (1):   23 samples
Pred Preictal (1):   23 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        23
    Preictal     1.0000    1.0000    1.0000        23

    accuracy                         1.0000        46
   macro avg     1.0000    1.0000    1.0000        46
weighted avg     1.0000    1.0000    1.0000        46
              precision    recall  f1-score   support

  Interictal     1.0000    1.0000    1.0000        23
    Preictal     1.0000    1.0000    1.0000        23

    accuracy                         1.0000        46
   macro avg     1.0000    1.0000    1.0000        46
weighted avg     1.0000    1.0000    1.0000        46



✅ Results saved to model\chb23_fold5\test_results.json
✅ Results saved to model\chb23_fold5\test_results.json


============================================================
============================================================

EVALUATING FOLD 6/6
EVALUATING FOLD 6/6
============================================================
============================================================
Evaluating model from epoch 5
Evaluating model from epoch 5
Dataset prefix: chb23_fold6
Dataset prefix: chb23_fold6
Using test dataset: preprocessing\data\chb23_fold6\test_dataset.h5
Using test dataset: preprocessing\data\chb23_fold6\test_dataset.h5
Loading test dataset from preprocessing\data\chb23_fold6\test_dataset.h5...
Loading test dataset from preprocessing\data\chb23_fold6\test_dataset.h5...
  - Normalization: z-score, mean=0.0803, std=2.1554
  - Normalization: z-score, mean=0.0803, std=2.1554
Loaded test dataset: 38 samples
Loaded test dataset: 38 samples
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Spectrogram shape: torch.Size([38, 30, 18, 50, 10])
  - Value range: [-5.6046, 3.8814]
  - Value range: [-5.6046, 3.8814]
  - Class distribution: tensor([19, 19])
  - Class distribution: tensor([19, 19])
Initializing Deep CNN-BiLSTM model...
Initializing Deep CNN-BiLSTM model...
Loading model checkpoint from model\chb23_fold6\epoch_005.pth...
Loading model checkpoint from model\chb23_fold6\epoch_005.pth...
Model loaded from epoch 4
Model loaded from epoch 4
Task mode: PREDICTION (preictal vs interictal)
Task mode: PREDICTION (preictal vs interictal)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Architecture: Deep CNN (16 layers, 512 features) + Bi-LSTM (3 layers, 512 hidden)
Total parameters: 41,286,914
Total parameters: 41,286,914

Evaluating on test set...
Evaluating on test set...

Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing:   0%|                                                                                                                                                                                                                                              | 0/3 [00:00<?, ?it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.33it/s]Testing: 100%|######################################################################################################################################################################################################################################| 3/3 [00:00<00:00, 34.33it/s]


============================================================
============================================================

FOLD TEST RESULTS
FOLD TEST RESULTS
============================================================
============================================================
Loss:      0.4191
Loss:      0.4191
Accuracy:  0.8421 (84.21%)
Accuracy:  0.8421 (84.21%)
Precision: 0.7600
Precision: 0.7600
Recall:    1.0000
Recall:    1.0000
F1 Score:  0.8636
F1 Score:  0.8636
AUC-ROC:   0.9889
AUC-ROC:   0.9889

Confusion Matrix:
Confusion Matrix:

                Predicted
                Predicted
                Interictal  Preictal
                Interictal  Preictal
Actual Interictal        13         6
Actual Interictal        13         6
       Preictal         0        19
       Preictal         0        19

Class Distribution:
Class Distribution:

True Interictal (0): 19 samples
True Interictal (0): 19 samples
True Preictal (1):   19 samples
True Preictal (1):   19 samples
Pred Interictal (0): 13 samples
Pred Interictal (0): 13 samples
Pred Preictal (1):   25 samples
Pred Preictal (1):   25 samples

Detailed Classification Report:
Detailed Classification Report:

              precision    recall  f1-score   support

  Interictal     1.0000    0.6842    0.8125        19
    Preictal     0.7600    1.0000    0.8636        19

    accuracy                         0.8421        38
   macro avg     0.8800    0.8421    0.8381        38
weighted avg     0.8800    0.8421    0.8381        38
              precision    recall  f1-score   support

  Interictal     1.0000    0.6842    0.8125        19
    Preictal     0.7600    1.0000    0.8636        19

    accuracy                         0.8421        38
   macro avg     0.8800    0.8421    0.8381        38
weighted avg     0.8800    0.8421    0.8381        38



✅ Results saved to model\chb23_fold6\test_results.json
✅ Results saved to model\chb23_fold6\test_results.json


============================================================
============================================================

BATCH EVALUATION SUMMARY
BATCH EVALUATION SUMMARY
============================================================
============================================================
Folds evaluated: 7/7
Folds evaluated: 7/7

Mean metrics (across folds):
Mean metrics (across folds):

  Accuracy:  0.9095 (±0.0943)
  Accuracy:  0.9095 (±0.0943)
  Precision: 0.8960 (±0.0806)
  Precision: 0.8960 (±0.0806)
  Recall:    0.9320 (±0.1666)
  Recall:    0.9320 (±0.1666)
  F1 Score:  0.9047 (±0.1140)
  F1 Score:  0.9047 (±0.1140)
  AUC-ROC:   0.9636 (±0.0303)
  AUC-ROC:   0.9636 (±0.0303)

✅ Batch results saved to model\batch_test_results.json
✅ Batch results saved to model\batch_test_results.json

============================================================
============================================================
